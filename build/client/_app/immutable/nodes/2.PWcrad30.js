import"../chunks/DsnmJJEf.js";import{h as wn,a as Dd,aX as Cd,aY as Td,aZ as Ed,b as Fd,c as Nd,d as $d,e as Pd,s as Ld,f as Md,U as Id,p as Rd,a0 as Od,a_ as jd,E as qd,a$ as zd,b0 as Gd,K as Vd,j as x,b1 as Bd,b2 as Wd,b3 as Hd,b4 as Ec,a8 as Ud,M as Yd,P as Si,aL as Ps,q as qa,ae as ut,_ as Xs,ad as Ya,T as v,t as _,z as o,A as i,B as u,l as e,w as q,C as w,x as m,y as za,v as Je,aV as Bt,aS as ye,ag as mt,aK as Hs,V as _o,ah as ea,i as Es,Q as O,b5 as Fs,b6 as _t,m as xs,b7 as Rs,b8 as ei,af as Xo,b9 as or,ai as Sa,aT as Zs,Z as fr,ba as xn,bb as Qd,aR as Kd,bc as Jd,aW as Xd,bd as Zd}from"../chunks/BrR45Eif.js";import{i as E,p as Ma,a as Ja,s as ks,b as Ws,d as Zo}from"../chunks/CsvhCkDi.js";import{k as eu,d as gs,l as jr,r as aa,s as _e,f as Ii,a as $t,c as oa,e as xt,i as Ua,t as Se,b as ns,m as us,n as ds,h as da,j as tu,o as au,T as su,p as ru,g as el}from"../chunks/x4FCHtqB.js";import{i as Ls}from"../chunks/DMNA4brR.js";const iu=!0;function Is(s,t,a){wn&&Dd();var r=s,n=Id,l,c,d=null,f=Cd()?Td:Ed;function p(){l&&Rd(l),d!==null&&(d.lastChild.remove(),r.before(d),d=null),l=c}Fd(()=>{if(f(n,n=t())){var h=r,g=Ld();g&&(d=document.createDocumentFragment(),d.append(h=Nd())),c=$d(()=>a(h)),g?Pd.add_callback(p):p()}}),wn&&(r=Md)}function Wa(s,t,a,r){var n=s.__style;if(wn||n!==t){var l=eu(t);(!wn||l!==s.getAttribute("style"))&&(l==null?s.removeAttribute("style"):s.style.cssText=l),s.__style=t}return r}const nu=()=>performance.now(),Tr={tick:s=>requestAnimationFrame(s),now:()=>nu(),tasks:new Set};function Fc(){const s=Tr.now();Tr.tasks.forEach(t=>{t.c(s)||(Tr.tasks.delete(t),t.f())}),Tr.tasks.size!==0&&Tr.tick(Fc)}function ou(s){let t;return Tr.tasks.size===0&&Tr.tick(Fc),{promise:new Promise(a=>{Tr.tasks.add(t={c:s,f:a})}),abort(){Tr.tasks.delete(t)}}}function rn(s,t){Ec(()=>{s.dispatchEvent(new CustomEvent(t))})}function lu(s){if(s==="float")return"cssFloat";if(s==="offset")return"cssOffset";if(s.startsWith("--"))return s;const t=s.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function tl(s){const t={},a=s.split(";");for(const r of a){const[n,l]=r.split(":");if(!n||l===void 0)break;const c=lu(n.trim());t[c]=l.trim()}return t}const cu=s=>s;function es(s,t,a,r){var n=(s&Wd)!==0,l=(s&Hd)!==0,c=n&&l,d=(s&Bd)!==0,f=c?"both":n?"in":"out",p,h=t.inert,g=t.style.overflow,b,y;function k(){return Ec(()=>p??=a()(t,r?.()??{},{direction:f}))}var A={is_global:d,in(){if(t.inert=h,!n){y?.abort(),y?.reset?.();return}l||b?.abort(),rn(t,"introstart"),b=uo(t,k(),y,1,()=>{rn(t,"introend"),b?.abort(),b=p=void 0,t.style.overflow=g})},out(S){if(!l){S?.(),p=void 0;return}t.inert=!0,rn(t,"outrostart"),y=uo(t,k(),b,0,()=>{rn(t,"outroend"),S?.()})},stop:()=>{b?.abort(),y?.abort()}},T=Od;if((T.transitions??=[]).push(A),n&&jd){var C=d;if(!C){for(var D=T.parent;D&&(D.f&qd)!==0;)for(;(D=D.parent)&&(D.f&zd)===0;);C=!D||(D.f&Gd)!==0}C&&Vd(()=>{x(()=>A.in())})}}function uo(s,t,a,r,n){var l=r===1;if(Ud(t)){var c,d=!1;return Yd(()=>{if(!d){var T=t({direction:l?"in":"out"});c=uo(s,T,a,r,n)}}),{abort:()=>{d=!0,c?.abort()},deactivate:()=>c.deactivate(),reset:()=>c.reset(),t:()=>c.t()}}if(a?.deactivate(),!t?.duration)return n(),{abort:Si,deactivate:Si,reset:Si,t:()=>r};const{delay:f=0,css:p,tick:h,easing:g=cu}=t;var b=[];if(l&&a===void 0&&(h&&h(0,1),p)){var y=tl(p(0,1));b.push(y,y)}var k=()=>1-r,A=s.animate(b,{duration:f,fill:"forwards"});return A.onfinish=()=>{A.cancel();var T=a?.t()??1-r;a?.abort();var C=r-T,D=t.duration*Math.abs(C),S=[];if(D>0){var L=!1;if(p)for(var F=Math.ceil(D/16.666666666666668),j=0;j<=F;j+=1){var P=T+C*g(j/F),Q=tl(p(P,1-P));S.push(Q),L||=Q.overflow==="hidden"}L&&(s.style.overflow="hidden"),k=()=>{var W=A.currentTime;return T+C*g(W/D)},h&&ou(()=>{if(A.playState!=="running")return!1;var W=k();return h(W,1-W),!0})}A=s.animate(S,{duration:D,fill:"forwards"}),A.onfinish=()=>{k=()=>r,h?.(r,1-r),n()}},{abort:()=>{A&&(A.cancel(),A.effect=null,A.onfinish=Si)},deactivate:()=>{n=Si},reset:()=>{r===0&&h?.(1,0)},t:()=>k()}}function vo(s){return function(...t){var a=t[0];return a.stopPropagation(),s?.apply(this,t)}}function tr(s){return function(...t){var a=t[0];return a.preventDefault(),s?.apply(this,t)}}const al=iu,Nc=s=>{const t=/^[A-Z]{3}-\d{4}-\d{4}$/;return s?t.test(s)?"":"Please enter a valid ID Number (e.g., STU-2025-0001)":"ID Number is required"},$c=s=>s?"":"Password is required",Pc=()=>document.documentElement.getAttribute("data-theme")||"light",du=s=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},uu=()=>{const t=Pc()==="dark"?"light":"dark";return du(t),t},vu=async({accountNumber:s,password:t})=>{try{const r=await(await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountNumber:s,password:t})})).json();if(r.success){const n={id:r.user.id,name:r.user.name,firstName:r.user.firstName,gender:r.user.gender,accountNumber:r.user.accountNumber,accountType:r.user.accountType,isAuthenticated:!0};return gs.login(n.accountType,n),jr(`Login successful! Welcome back, ${n.name}`),console.log("Login successful:",{accountNumber:s,userType:n.accountType}),n}else{const n=new Error(r.error||"Invalid credentials. Please try again.");throw n.attemptsLeft=r.attemptsLeft,n.isLocked=r.isLocked,n}}catch(a){if(a.message==="Failed to fetch"||a instanceof TypeError)throw new Error("Connection failed. Please check your internet connection and try again.");const r=new Error(a.message||"Network error. Please try again.");throw a.attemptsLeft!==void 0&&(r.attemptsLeft=a.attemptsLeft),a.isLocked!==void 0&&(r.isLocked=a.isLocked),r}};function fu(s,t){const a=uu();v(t,a==="dark")}const pu=(s,t,a)=>{v(t,s.target.value,!0),e(a).idNumber&&v(a,{...e(a),idNumber:Nc(e(t))},!0)},mu=(s,t,a)=>{v(t,s.target.value,!0),e(a).password&&v(a,{...e(a),password:$c(e(t))},!0)},sl=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),t(s))};async function hu(s,t,a,r,n){v(t,""),v(a,["","","","","",""],!0),v(r,5),await n({preventDefault:()=>{}})}var gu=_('<div class="error-text"> </div>'),_u=(s,t)=>{s.preventDefault(),s.stopPropagation(),v(t,!e(t))},bu=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),s.stopPropagation(),v(t,!e(t)))},yu=_('<div class="error-text"> </div>'),wu=_('<div class="error-message-item"> </div>'),xu=_('<div class="error-message-item"> </div>'),Su=_('<div class="error-message-item"> </div>'),ku=_('<div class="error-message-item" style="color: #ff9800; font-weight: 500;"> </div>'),Au=_('<div class="login-error-container"><span class="material-symbols-outlined">error</span> <div class="error-messages"><!> <!> <!> <!></div></div>'),Du=_('<div class="login-loading-spinner"></div>'),Cu=_("<span>Login Locked</span>"),Tu=_("<span>Login</span>"),Eu=_('<div class="login-header"><h1 class="login-title">Login</h1> <h2 class="login-subtitle">Enter your account details</h2></div> <form class="login-form" novalidate="" autocomplete="off"><div class="form-field"><div><span class="leading-icon material-symbols-outlined">badge</span> <input type="text" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="idnumber-input">ID Number</label></div> <!></div> <div class="form-field"><div><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="password-input">Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div> <!></div> <!> <button id="login-submit-btn" type="submit" class="custom-filled-button login-submit" aria-label="Sign in"><!></button> <button type="button" id="forgot-password-btn" class="custom-text-button forgot-password" aria-label="forgot-password">Forgot Password</button></form>',1),Fu=_('<div class="success-message-box"><span class="material-symbols-outlined">check_circle</span> <span> </span></div>'),Nu=_('<div class="error-message-box"><span class="material-symbols-outlined">error</span> <span> </span></div>'),$u=_('<div class="login-loading-spinner"></div>'),Pu=_('<span class="material-symbols-outlined">send</span> <span>Send Code</span>',1),Lu=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">email</span> <input id="forgot-password-email" type="email" autocomplete="email" class="text-input" placeholder=" " required/> <label for="forgot-password-email" class="text-label">Email Address</label></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),Mu=_('<input type="text" maxlength="1" inputmode="numeric" autocomplete="off" class="code-box" required/>'),Iu=_('<div class="info-text"> </div>'),Ru=_('<div class="verification-loading"><div class="login-loading-spinner"></div> <span>Verifying code...</span></div>'),Ou=_('<div class="login-loading-spinner"></div>'),ju=_('<span class="material-symbols-outlined">refresh</span> <span>Resend Code</span>',1),qu=_('<form class="login-form"><div class="form-field"><div class="code-boxes-container"></div> <!> <!></div> <button type="button" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),zu=(s,t)=>{s.preventDefault(),v(t,!e(t))},Gu=(s,t)=>{s.preventDefault(),v(t,!e(t))},Vu=_('<div class="login-loading-spinner"></div>'),Bu=_("<span>Reset Password</span>"),Wu=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock</span> <input id="reset-new-password" autocomplete="new-password" class="text-input" placeholder=" " required/> <label for="reset-new-password" class="text-label">New Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock_reset</span> <input id="reset-confirm-password" autocomplete="new-password" class="text-input" placeholder=" " required/> <label for="reset-confirm-password" class="text-label">Confirm Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),Hu=_('<div class="login-header"><h1 class="login-title"> </h1> <h2 class="login-subtitle"> </h2></div> <!> <!> <!> <!> <!>',1),Uu=_('<div class="login-container"><button class="theme-toggle-btn" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="left-side"><!></div> <div class="right-side"><div class="welcome-text"><h1 class="welcome-title"> </h1> <p class="welcome-subtitle"> </p></div></div></div>');function Yu(s,t){qa(t,!0);let a=ut(""),r=ut(""),n=ut(!1),l=ut(!1),c=ut(Xs({idNumber:"",password:"",general:""})),d=ut(null),f=ut(!1),p=ut(!1),h=ut(1),g=ut(""),b=ut(""),y=ut(""),k=ut(Xs(["","","","","",""])),A=ut(""),T=ut(""),C=ut(!1),D=ut(!1),S=ut(""),L=ut(5),F=ut(!1);Ya(()=>{const be=Pc();v(F,be==="dark")});const j=async be=>{be.preventDefault(),v(c,{idNumber:"",password:"",general:""},!0),v(d,null),v(f,!1);const ke=Nc(e(a)),Fe=$c(e(r));if(ke||Fe){v(c,{idNumber:ke,password:Fe,general:""},!0);return}v(n,!0);try{const Re=await vu({accountNumber:e(a),password:e(r)})}catch(Re){v(c,{...e(c),general:Re.message},!0),Re.attemptsLeft!==void 0&&v(d,Re.attemptsLeft,!0),Re.isLocked&&(v(f,!0),v(d,0))}finally{v(n,!1)}};function P(){v(p,!e(p)),e(p)||(v(h,1),v(g,""),v(b,""),v(y,""),v(k,["","","","","",""],!0),v(A,""),v(T,""),v(c,{idNumber:"",password:"",general:""},!0),v(S,""),v(L,5))}function Q(be,ke){const Re=ke.target.value.replace(/\D/g,"");if(Re.length>0)if(e(k)[be]=Re[Re.length-1],v(y,e(k).join(""),!0),be<5&&Re){const et=document.getElementById(`code-digit-${be+1}`);et&&et.focus()}else be===5&&e(k).every(et=>et!=="")&&re({preventDefault:()=>{}});else e(k)[be]="",v(y,e(k).join(""),!0)}function W(be,ke){if(ke.key==="Backspace"&&!e(k)[be]&&be>0){const Fe=document.getElementById(`code-digit-${be-1}`);Fe&&Fe.focus()}}function $(be){be.preventDefault();const ke=be.clipboardData.getData("text").replace(/\D/g,"").slice(0,6);if(ke.length>0){const Fe=ke.split("");v(k,[...Fe,...Array(6-Fe.length).fill("")],!0),v(y,e(k).join(""),!0);const Re=Math.min(Fe.length,5),et=document.getElementById(`code-digit-${Re}`);et&&et.focus(),ke.length===6&&re({preventDefault:()=>{}})}}function R(be){return be?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(be)?"":"Please enter a valid email address":"Email address is required"}function X(be){return be?/^\d{6}$/.test(be)?"":"Code must be 6 digits":"Verification code is required"}function se(be){return be?be.length<6?"Password must be at least 6 characters":"":"Password is required"}async function V(be){be.preventDefault(),v(c,{idNumber:"",password:"",general:""},!0),v(S,"");const ke=R(e(g));if(ke){v(c,{...e(c),general:ke},!0);return}v(n,!0);try{const Fe=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(g).toLowerCase().trim()})}),Re=await Fe.json();if(!Fe.ok)throw new Error(Re.error||"Failed to send reset code");v(b,Re.resetToken,!0),v(S,"A verification code has been sent to your email address."),v(h,2)}catch(Fe){v(c,{...e(c),general:Fe.message},!0)}finally{v(n,!1)}}async function re(be){be.preventDefault(),v(c,{idNumber:"",password:"",general:""},!0),v(S,"");const ke=X(e(y));if(ke){v(c,{...e(c),general:ke},!0);return}v(n,!0);try{const Fe=await fetch("/api/forgot-password/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(b),code:e(y)})}),Re=await Fe.json();if(!Fe.ok)throw Re.attemptsRemaining!==void 0&&v(L,Re.attemptsRemaining,!0),new Error(Re.error||"Invalid verification code");v(S,"Code verified! Please enter your new password."),v(h,3)}catch(Fe){v(c,{...e(c),general:Fe.message},!0)}finally{v(n,!1)}}async function me(be){be.preventDefault(),v(c,{idNumber:"",password:"",general:""},!0),v(S,"");const ke=se(e(A));if(ke){v(c,{...e(c),general:ke},!0);return}if(e(A)!==e(T)){v(c,{...e(c),general:"Passwords do not match"},!0);return}v(n,!0);try{const Fe=await fetch("/api/forgot-password/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(b),code:e(y),newPassword:e(A)})}),Re=await Fe.json();if(!Fe.ok)throw new Error(Re.error||"Failed to reset password");v(S,"Password reset successfully! Redirecting to login..."),setTimeout(()=>{P()},2e3)}catch(Fe){v(c,{...e(c),general:Fe.message},!0)}finally{v(n,!1)}}var je=Uu(),de=o(je);de.__click=[fu,F];var ie=o(de),Pe=o(ie,!0);i(ie),i(de);var Ve=u(de,2),Ze=o(Ve);{var ve=be=>{var ke=Eu(),Fe=u(Je(ke),2),Re=o(Fe),et=o(Re),$e=u(o(et),2);aa($e),$e.__input=[pu,a,c],$e.__keydown=[sl,j],Bt(2),i(et);var ot=u(et,2);{var Me=N=>{var M=gu(),H=o(M,!0);i(M),q(()=>w(H,e(c).idNumber)),m(N,M)};E(ot,N=>{e(c).idNumber&&N(Me)})}i(Re);var it=u(Re,2),ft=o(it),Ye=u(o(ft),2);aa(Ye),Ye.__input=[mu,r,c],Ye.__keydown=[sl,j];var Y=u(Ye,4);Y.__click=[_u,l],Y.__keydown=[bu,l];var ce=o(Y),De=o(ce,!0);i(ce),i(Y),i(ft);var U=u(ft,2);{var ne=N=>{var M=yu(),H=o(M,!0);i(M),q(()=>w(H,e(c).password)),m(N,M)};E(U,N=>{e(c).password&&N(ne)})}i(it);var fe=u(it,2);{var z=N=>{var M=Au(),H=u(o(M),2),pe=o(H);{var ee=bt=>{var pt=wu(),vt=o(pt,!0);i(pt),q(()=>w(vt,e(c).idNumber)),m(bt,pt)};E(pe,bt=>{e(c).idNumber&&bt(ee)})}var Ae=u(pe,2);{var Ue=bt=>{var pt=xu(),vt=o(pt,!0);i(pt),q(()=>w(vt,e(c).password)),m(bt,pt)};E(Ae,bt=>{e(c).password&&bt(Ue)})}var Le=u(Ae,2);{var He=bt=>{var pt=Su(),vt=o(pt,!0);i(pt),q(()=>w(vt,e(c).general)),m(bt,pt)};E(Le,bt=>{e(c).general&&bt(He)})}var Ie=u(Le,2);{var nt=bt=>{var pt=ku(),vt=o(pt);i(pt),q(()=>w(vt,`${e(d)??""} attempt${e(d)!==1?"s":""} remaining before login lockout`)),m(bt,pt)};E(Ie,bt=>{e(d)!==null&&e(d)>0&&!e(f)&&bt(nt)})}i(H),i(M),m(N,M)};E(fe,N=>{(e(c).idNumber||e(c).password||e(c).general)&&N(z)})}var B=u(fe,2),I=o(B);{var G=N=>{var M=Du();m(N,M)},Z=N=>{var M=mt(),H=Je(M);{var pe=Ae=>{var Ue=Cu();m(Ae,Ue)},ee=Ae=>{var Ue=Tu();m(Ae,Ue)};E(H,Ae=>{e(f)?Ae(pe):Ae(ee,!1)},!0)}m(N,M)};E(I,N=>{e(n)?N(G):N(Z,!1)})}i(B);var le=u(B,2);le.__click=P,i(Fe),q(()=>{_e(et,1,`custom-text-field ${e(c).idNumber?"error":""}`),Ii($e,e(a)),_e(ft,1,`custom-text-field ${e(c).password?"error":""}`),$t(Ye,"type",e(l)?"text":"password"),Ii(Ye,e(r)),$t(Y,"aria-label",e(l)?"Hide password":"Show password"),w(De,e(l)?"visibility":"visibility_off"),B.disabled=e(n)||e(f)}),ye("submit",Fe,j),m(be,ke)},Ce=be=>{var ke=Hu(),Fe=Je(ke),Re=o(Fe),et=o(Re,!0);i(Re);var $e=u(Re,2),ot=o($e,!0);i($e),i(Fe);var Me=u(Fe,2);{var it=z=>{var B=Fu(),I=u(o(B),2),G=o(I,!0);i(I),i(B),q(()=>w(G,e(S))),m(z,B)};E(Me,z=>{e(S)&&z(it)})}var ft=u(Me,2);{var Ye=z=>{var B=Nu(),I=u(o(B),2),G=o(I,!0);i(I),i(B),q(()=>w(G,e(c).general)),m(z,B)};E(ft,z=>{e(c).general&&z(Ye)})}var Y=u(ft,2);{var ce=z=>{var B=Lu(),I=o(B),G=o(I),Z=u(o(G),2);aa(Z),Bt(2),i(G),i(I);var le=u(I,2),N=o(le);{var M=ee=>{var Ae=$u();m(ee,Ae)},H=ee=>{var Ae=Pu();Bt(2),m(ee,Ae)};E(N,ee=>{e(n)?ee(M):ee(H,!1)})}i(le);var pe=u(le,2);pe.__click=P,i(B),q(()=>le.disabled=e(n)),ye("submit",B,V),oa(Z,()=>e(g),ee=>v(g,ee)),m(z,B)};E(Y,z=>{e(h)===1&&z(ce)})}var De=u(Y,2);{var U=z=>{var B=qu(),I=o(B),G=o(I);xt(G,21,()=>e(k),Ua,(Le,He,Ie)=>{var nt=Mu();aa(nt),$t(nt,"id",`code-digit-${Ie}`),nt.__input=bt=>Q(Ie,bt),nt.__keydown=bt=>W(Ie,bt),q(()=>{Ii(nt,e(He)),nt.disabled=e(n)}),ye("paste",nt,function(...bt){(Ie===0?$:null)?.apply(this,bt)}),m(Le,nt)}),i(G);var Z=u(G,2);{var le=Le=>{var He=Iu(),Ie=o(He);i(He),q(()=>w(Ie,`Attempts remaining: ${e(L)??""}`)),m(Le,He)};E(Z,Le=>{e(L)<5&&Le(le)})}var N=u(Z,2);{var M=Le=>{var He=Ru();m(Le,He)};E(N,Le=>{e(n)&&Le(M)})}i(I);var H=u(I,2);H.__click=[hu,y,k,L,V];var pe=o(H);{var ee=Le=>{var He=Ou();m(Le,He)},Ae=Le=>{var He=ju();Bt(2),m(Le,He)};E(pe,Le=>{e(n)?Le(ee):Le(Ae,!1)})}i(H);var Ue=u(H,2);Ue.__click=P,i(B),q(()=>H.disabled=e(n)),ye("submit",B,Le=>{Le.preventDefault()}),m(z,B)};E(De,z=>{e(h)===2&&z(U)})}var ne=u(De,2);{var fe=z=>{var B=Wu(),I=o(B),G=o(I),Z=u(o(G),2);aa(Z);var le=u(Z,4);le.__click=[zu,C];var N=o(le),M=o(N,!0);i(N),i(le),i(G),i(I);var H=u(I,2),pe=o(H),ee=u(o(pe),2);aa(ee);var Ae=u(ee,4);Ae.__click=[Gu,D];var Ue=o(Ae),Le=o(Ue,!0);i(Ue),i(Ae),i(pe),i(H);var He=u(H,2),Ie=o(He);{var nt=vt=>{var Tt=Vu();m(vt,Tt)},bt=vt=>{var Tt=Bu();m(vt,Tt)};E(Ie,vt=>{e(n)?vt(nt):vt(bt,!1)})}i(He);var pt=u(He,2);pt.__click=P,i(B),q(()=>{$t(Z,"type",e(C)?"text":"password"),$t(le,"aria-label",e(C)?"Hide password":"Show password"),w(M,e(C)?"visibility":"visibility_off"),$t(ee,"type",e(D)?"text":"password"),$t(Ae,"aria-label",e(D)?"Hide password":"Show password"),w(Le,e(D)?"visibility":"visibility_off"),He.disabled=e(n)}),ye("submit",B,me),oa(Z,()=>e(A),vt=>v(A,vt)),oa(ee,()=>e(T),vt=>v(T,vt)),m(z,B)};E(ne,z=>{e(h)===3&&z(fe)})}q(()=>{w(et,e(h)===1?"Forgot Password?":e(h)===2?"Verify Code":"Reset Password"),w(ot,e(h)===1?"Enter your email to receive a verification code":e(h)===2?"Enter the 6-digit code sent to your email":"Create a new password for your account")}),m(be,ke)};E(Ze,be=>{e(p)?be(Ce,!1):be(ve)})}i(Ve);var Qe=u(Ve,2),Xe=o(Qe),ze=o(Xe),We=o(ze,!0);i(ze);var Te=u(ze,2),ue=o(Te,!0);i(Te),i(Xe),i(Qe),i(je),q(()=>{w(Pe,e(F)?"light_mode":"dark_mode"),w(We,e(p)?"Password Reset":"Welcome"),w(ue,e(p)?"Recover your account securely":"Login to access your account")}),m(s,je),za()}Ps(["click","input","keydown"]);const Qu=300*1e3,rl="student_notifications_";function Ku(){const s={notifications:[],unreadCount:0,totalCount:0,currentFilter:"all",isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Hs(s);function n(){const j=_o(gs);if(!j?.isAuthenticated||!j.userData)return{};const P={id:j.userData.id,name:j.userData.name,account_number:j.userData.accountNumber,account_type:j.userData.account_type||j.userData.accountType};return{"x-user-info":JSON.stringify(P)}}function l(j,P){return`${rl}${j}_${P}`}function c(j){return!j||!j.timestamp?!1:Date.now()-j.timestamp<Qu}function d(j,P){try{const Q=l(j,P),W=localStorage.getItem(Q);if(W)return JSON.parse(W).data}catch(Q){console.warn("Failed to retrieve cached student notifications data:",Q)}return null}function f(j,P){try{const Q=l(j,P),W=localStorage.getItem(Q);if(W){const $=JSON.parse(W);if(c($))return $.data}}catch(Q){console.warn("Failed to retrieve cached student notifications data:",Q)}return null}function p(j,P,Q){try{const W=l(j,P),$={data:Q,timestamp:Date.now()};localStorage.setItem(W,JSON.stringify($))}catch(W){console.warn("Failed to cache student notifications data:",W)}}function h(j){return Array.isArray(j)?j.map(P=>({id:P.id,title:P.title,message:P.message,type:P.type,timestamp:P.created_at||P.timestamp,isRead:P.is_read||P.isRead||!1,adminNote:P.admin_note||P.adminNote||null,rejectionReason:P.rejection_reason||P.rejectionReason||null,metadata:P.metadata||{}})):[]}function g(j){const P=j.filter(W=>!W.isRead).length,Q=j.length;return{unreadCount:P,totalCount:Q}}async function b(j,P="all",Q=!1){try{r(re=>({...re,isLoading:!Q,isRefreshing:Q,error:null,currentStudentId:j,currentFilter:P}));const W=new URLSearchParams({studentId:j,filter:P}),R=await(await fetch(`/api/student-notifications?${W.toString()}`,{headers:n()})).json();if(!R.success)throw new Error(R.error||"Failed to fetch notifications");const X=h(R.data||[]),se=g(X),V={notifications:X,unreadCount:se.unreadCount,totalCount:se.totalCount,currentFilter:P,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString(),currentStudentId:j};r(re=>({...re,...V})),p(j,P,{notifications:X,unreadCount:se.unreadCount,totalCount:se.totalCount,lastUpdated:V.lastUpdated})}catch(W){console.error("Error loading student notifications:",W);const $=d(j,P);$?(r(R=>({...R,notifications:$.notifications||[],unreadCount:$.unreadCount||0,totalCount:$.totalCount||0,lastUpdated:$.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Se.error("No internet connection. Showing offline data.")):r(R=>({...R,isLoading:!1,isRefreshing:!1,error:W.message,notifications:[],unreadCount:0,totalCount:0}))}}async function y(j,P,Q){try{const $=await(await fetch("/api/student-notifications",{method:"PATCH",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({studentId:j,notificationId:P,isRead:Q})})).json();if(!$.success)throw new Error($.error||"Failed to update notification status");r(R=>{const X=R.notifications.map(V=>V.id===P?{...V,isRead:Q}:V),se=g(X);return p(j,R.currentFilter,{notifications:X,unreadCount:se.unreadCount,totalCount:se.totalCount,lastUpdated:new Date().toISOString()}),{...R,notifications:X,unreadCount:se.unreadCount}})}catch(W){console.error("Error updating notification status:",W),Se.error("Failed to update notification status")}}async function k(j,P){try{const W=await(await fetch("/api/student-notifications",{method:"DELETE",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({studentId:j,notificationId:P})})).json();if(!W.success)throw new Error(W.error||"Failed to delete notification");r($=>{const R=$.notifications.filter(se=>se.id!==P),X=g(R);return p(j,$.currentFilter,{notifications:R,unreadCount:X.unreadCount,totalCount:X.totalCount,lastUpdated:new Date().toISOString()}),{...$,notifications:R,unreadCount:X.unreadCount,totalCount:X.totalCount}})}catch(Q){throw console.error("Error deleting notification:",Q),Se.error("Failed to delete notification"),Q}}async function A(j){try{const Q=await(await fetch("/api/student-notifications",{method:"PATCH",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({studentId:j,markAllAsRead:!0})})).json();if(!Q.success)throw new Error(Q.error||"Failed to mark all as read");r(W=>{const $=W.notifications.map(R=>({...R,isRead:!0}));return p(j,W.currentFilter,{notifications:$,unreadCount:0,totalCount:W.totalCount,lastUpdated:new Date().toISOString()}),{...W,notifications:$,unreadCount:0}}),Se.success("All notifications marked as read")}catch(P){console.error("Error marking all as read:",P),Se.error("Failed to mark all as read")}}async function T(j){try{const Q=await(await fetch("/api/student-notifications",{method:"DELETE",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({studentId:j,clearAllRead:!0})})).json();if(!Q.success)throw new Error(Q.error||"Failed to clear read notifications");r(W=>{const $=W.notifications.filter(X=>!X.isRead),R=g($);return p(j,W.currentFilter,{notifications:$,unreadCount:R.unreadCount,totalCount:R.totalCount,lastUpdated:new Date().toISOString()}),{...W,notifications:$,totalCount:R.totalCount}})}catch(P){throw console.error("Error clearing read notifications:",P),Se.error("Failed to clear read notifications"),P}}function C(j){r(P=>({...P,currentFilter:j}))}function D(j,P="all"){const Q=f(j,P);return Q?(r(W=>({...W,...Q,currentStudentId:j,currentFilter:P,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(W=>({...W,currentStudentId:j,currentFilter:P,isLoading:!0,isRefreshing:!1,error:null})),!1)}function S(j,P="all"){try{const Q=l(j,P);localStorage.removeItem(Q)}catch(Q){console.warn("Failed to clear student notifications cache:",Q)}return r(Q=>({...s,currentStudentId:j,currentFilter:P,isLoading:!0})),F.loadNotifications(j,P,!1)}function L(j){try{const P=Object.keys(localStorage),Q=`${rl}${j}_`;P.forEach(W=>{W.startsWith(Q)&&localStorage.removeItem(W)})}catch(P){console.warn("Failed to clear all notification cache:",P)}}const F={subscribe:t,init:D,setFilter:C,loadNotifications:b,updateNotificationStatus:y,deleteNotification:k,markAllAsRead:A,clearAllRead:T,forceRefresh:S,clearAllCache:L,getCachedData:(j,P)=>d(j,P)};return F}const wr=Ku();function Ju(s,t){v(t,!e(t))}function Xu(s,t,a){v(t,!e(t)),a()}var Zu=(s,t)=>t.onnavigate("notifications"),ev=_('<span class="navbar-notification-badge"> </span>'),tv=_('<img alt="Profile" class="avatar-image"/>'),av=_('<div class="avatar-placeholder"> </div>'),sv=(s,t,a)=>{t(),a.onnavigate("profile")},rv=async(s,t,a)=>{t(),await a.onlogout(),jr("Logged out successfully. See you next time!")},iv=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),nv=_('<nav class="student-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">school</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <button class="icon-button notifications-button" aria-label="Notifications"><span class="material-symbols-outlined">notifications</span> <!></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function ov(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(wr,"$studentNotificationStore",a),l=()=>Ja(gs,"$authStore",a);let c=Ma(t,"studentName",3,"John Does"),d=Ma(t,"firstName",3,"John"),f=Ma(t,"gender",3,"male"),p=Ma(t,"accountNumber",3,"STU-2025-0001"),h=Ma(t,"profileImage",3,null),g=ea(()=>n().unreadCount);function b(ke){return ke==="female"?"Ms.":"Mr."}let y=ea(()=>`${b(f())} ${d()}`),k=ut(!0),A=ut(!1);function T(){v(A,!1)}function C(ke){e(A)&&!ke.target.closest(".user-profile-container")&&T()}async function D(){const ke=l();if(!(!ke.isAuthenticated||!ke.userData?.id))try{await wr.loadNotifications(ke.userData.id,"all",!0)}catch(Fe){console.error("Error fetching notification count:",Fe)}}Ya(()=>{const ke=localStorage.getItem("theme");v(k,ke!=="light"),S(),document.addEventListener("click",C);let Fe;Fe=gs.subscribe(et=>{et.isAuthenticated&&(D(),Fe&&Fe())});const Re=setInterval(()=>{l().isAuthenticated&&D()},1e4);return()=>{document.removeEventListener("click",C),clearInterval(Re),Fe&&Fe()}});function S(){e(k)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function L(ke){return ke.split(" ").map(Fe=>Fe.charAt(0)).join("").toUpperCase().slice(0,2)}var F=nv(),j=o(F),P=o(j),Q=o(P);Q.__click=function(...ke){t.onToggleNavRail?.apply(this,ke)};var W=u(Q,2),$=u(o(W),2),R=o($);i($),i(W),i(P);var X=u(P,2),se=o(X);se.__click=[Xu,k,S];var V=o(se),re=o(V,!0);i(V),i(se);var me=u(se,2);me.__click=[Zu,t];var je=u(o(me),2);{var de=ke=>{var Fe=ev(),Re=o(Fe,!0);i(Fe),q(()=>w(Re,e(g)>99?"99+":e(g))),m(ke,Fe)};E(je,ke=>{e(g)>0&&ke(de)})}i(me);var ie=u(me,2),Pe=o(ie);Pe.__click=[Ju,A];var Ve=o(Pe),Ze=o(Ve),ve=o(Ze,!0);i(Ze);var Ce=u(Ze,2),Qe=o(Ce);i(Ce),i(Ve);var Xe=u(Ve,2),ze=o(Xe);{var We=ke=>{var Fe=tv();q(()=>$t(Fe,"src",h())),m(ke,Fe)},Te=ke=>{var Fe=av(),Re=o(Fe,!0);i(Fe),q(et=>w(Re,et),[()=>L(d())]),m(ke,Fe)};E(ze,ke=>{h()?ke(We):ke(Te,!1)})}i(Xe),i(Pe);var ue=u(Pe,2);{var be=ke=>{var Fe=iv(),Re=o(Fe);Re.__click=[sv,T,t];var et=u(Re,2);et.__click=[rv,T,t],i(Fe),m(ke,Fe)};E(ue,ke=>{e(A)&&ke(be)})}i(ie),i(X),i(j),i(F),q(()=>{w(R,`Welcome, ${e(y)??""}`),w(re,e(k)?"light_mode":"dark_mode"),w(ve,c()),w(Qe,`Account: ${p()??""}`)}),m(s,F),za(),r()}Ps(["click"]);var lv=(s,t,a)=>t(e(a).id),cv=_('<button><div class="rail-icon-container"><span class="material-symbols-outlined rail-icon"> </span></div> <span class="rail-label"> </span></button>'),dv=(s,t,a)=>t(e(a).id),uv=_('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span></div></button>'),vv=_('<nav aria-label="Student portal navigation"><div class="rail-container"></div></nav> <nav class="bottom-navigation" aria-label="Student portal navigation"><div class="nav-container"></div></nav>',1);function fv(s,t){qa(t,!0);let a=Ma(t,"activeSection",15,"grades"),r=Ma(t,"isNavRailVisible",3,!0);const n=[{id:"grades",label:"My Grades",icon:"grade"},{id:"ranking",label:"Class Ranking",icon:"leaderboard"},{id:"schedule",label:"Schedule",icon:"schedule"},{id:"documents",label:"Documents",icon:"description"},{id:"todo",label:"Todo List",icon:"checklist"}];function l(b){a(b),t.onnavigate&&t.onnavigate({detail:{section:b}})}var c=vv(),d=Je(c);let f;var p=o(d);xt(p,21,()=>n,b=>b.id,(b,y)=>{var k=cv();let A;k.__click=[lv,l,y];var T=o(k),C=o(T),D=o(C,!0);i(C),i(T);var S=u(T,2),L=o(S,!0);i(S),i(k),q(F=>{A=_e(k,1,"rail-item",null,A,F),$t(k,"aria-label",e(y).label),$t(k,"aria-current",e(y).id===a()?"page":void 0),w(D,e(y).icon),w(L,e(y).label)},[()=>({active:e(y).id===a()})]),m(b,k)}),i(p),i(d);var h=u(d,2),g=o(h);xt(g,21,()=>n,b=>b.id,(b,y)=>{var k=uv();let A;k.__click=[dv,l,y];var T=o(k),C=o(T),D=o(C,!0);i(C),i(T),i(k),q(S=>{A=_e(k,1,"nav-item",null,A,S),$t(k,"aria-label",e(y).label),$t(k,"aria-current",e(y).id===a()?"page":void 0),w(D,e(y).icon)},[()=>({active:e(y).id===a()})]),m(b,k)}),i(g),i(h),q(b=>f=_e(d,1,"navigation-rail",null,f,b),[()=>({collapsed:!r()})]),m(s,c),za()}Ps(["click"]);const pv=300*1e3,mv="student_profile_";function hv(){const s={studentData:null,studentProfileData:null,studentSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Hs(s);function n(k){return`${mv}${k}`}function l(k){return!k||!k.timestamp?!1:Date.now()-k.timestamp<pv}function c(k){try{const A=n(k),T=localStorage.getItem(A);if(T)return JSON.parse(T).data}catch(A){console.warn("Failed to retrieve cached student profile data:",A)}return null}function d(k){try{const A=n(k),T=localStorage.getItem(A);if(T){const C=JSON.parse(T);if(l(C))return C.data}}catch(A){console.warn("Failed to retrieve cached student profile data:",A)}return null}function f(k,A){try{const T=n(k),C={data:A,timestamp:Date.now()};localStorage.setItem(T,JSON.stringify(C))}catch(T){console.warn("Failed to cache student profile data:",T)}}async function p(k,A=!1){try{r(j=>({...j,isLoading:!A,isRefreshing:A,error:null,currentStudentId:k}));const T=await ns(`/api/student-profile?studentId=${k}`);if(!T.ok)throw new Error("Failed to fetch student profile data");const C=await T.json();if(!C.success)throw new Error(C.error||"Failed to fetch student profile data");const D=C.data;let S=null;try{const j=await ns(`/api/users?id=${k}`);if(j.ok){const P=await j.json();P.success&&P.user&&(S={id:P.user.id||k,number:P.user.account_number,name:P.user.full_name,firstName:P.user.first_name,lastName:P.user.last_name,middleInitial:P.user.middle_initial||"",email:P.user.email,contactNumber:P.user.contact_number,address:P.user.address,birthdate:P.user.birth_date,age:P.user.age,guardian:P.user.guardian,gender:P.user.gender,gradeLevel:D?.section?.gradeLevel||P.user.grade_level})}}catch(j){console.warn("Failed to fetch basic student data:",j)}if(S||(S={id:k,number:k,name:"Student",gradeLevel:D?.section?.gradeLevel||"Not assigned"}),!D?.subjects||D.subjects.length===0)try{const P=await(await ns("/api/current-quarter")).json(),Q=P.data?.currentQuarter||2,W=P.data?.currentSchoolYear||"2025-2026",$=await ns(`/api/student-grades?student_id=${k}&quarter=${Q}&school_year=${W}`);if($.ok){const R=await $.json();if(R.success&&R.data.grades){const X=R.data.grades.map(se=>({id:se.subject_id,name:se.name,code:se.code||"",teacher:se.teacher,color:h(se.name)}));D?D.subjects=X:D={section:{id:null,name:"No section assigned",gradeLevel:S.grade_level||"Not assigned",adviser:"No adviser"},subjects:X,academicSummary:{generalAverage:R.data.statistics.overallAverage||"Not available",classRank:"Not available",totalStudentsInSection:0,totalSubjectsEnrolled:X.length,totalSubjectsWithGrades:R.data.statistics.countedSubjects||0}}}}}catch(j){console.warn("Failed to fetch subjects from grades API:",j)}let L=[];try{const Q=(await(await ns("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",W=await ns(`/api/student-sections?studentId=${k}&schoolYear=${Q}`);if(W.ok){const $=await W.json();$.success&&(L=$.data.classData||[])}}catch(j){console.warn("Failed to fetch student sections:",j)}const F={studentData:S,studentProfileData:D,studentSections:L,lastUpdated:new Date().toISOString()};r(j=>({...j,...F,isLoading:!1,isRefreshing:!1,error:null})),f(k,F)}catch(T){console.error("Error loading student profile:",T);const C=c(k);C?(r(D=>({...D,studentData:C.studentData,studentProfileData:C.studentProfileData,studentSections:C.studentSections||[],lastUpdated:C.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Se.error("No internet connection. Showing offline data.")):r(D=>({...D,isLoading:!1,isRefreshing:!1,error:T.message}))}}function h(k){const A={Mathematics:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Math:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Science:["#059669","#10B981","#34D399","#047857"],English:["#DC2626","#EF4444","#F87171","#B91C1C"],"Physical Education":["#EA580C","#F97316","#FB923C","#C2410C"],MAPEH:["#EA580C","#F97316","#FB923C","#C2410C"],PE:["#EA580C","#F97316","#FB923C","#C2410C"],Filipino:["#7C2D12","#A16207","#D97706","#92400E"],"Araling Panlipunan":["#B45309","#D97706","#F59E0B","#A16207"],History:["#B45309","#D97706","#F59E0B","#A16207"],Computer:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Technology:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Arts:["#C026D3","#D946EF","#E879F9","#A21CAF"],Music:["#EC4899","#F472B6","#F9A8D4","#DB2777"],Health:["#16A34A","#22C55E","#4ADE80","#15803D"],Values:["#0891B2","#06B6D4","#22D3EE","#0E7490"],Research:["#7C2D12","#A16207","#D97706","#92400E"],TLE:["#9333EA","#A855F7","#C084FC","#7E22CE"],ESP:["#0891B2","#06B6D4","#22D3EE","#0E7490"]},T=["#EF4444","#F97316","#F59E0B","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899","#F43F5E","#E11D48","#BE123C","#9F1239","#881337"];function C(F){let j=0;for(let P=0;P<F.length;P++){const Q=F.charCodeAt(P);j=(j<<5)-j+Q,j=j&j}return Math.abs(j)}const D=k.toLowerCase().trim();for(const[F,j]of Object.entries(A))if(D.includes(F.toLowerCase())){const Q=C(k)%j.length;return j[Q]}const L=C(k)%T.length;return T[L]}function g(k){const A=d(k);return A?(r(T=>({...T,...A,currentStudentId:k,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(T=>({...T,currentStudentId:k,isLoading:!0,isRefreshing:!1,error:null})),!1)}function b(k){try{const A=n(k);localStorage.removeItem(A)}catch(A){console.warn("Failed to clear student profile cache:",A)}return r(A=>({...s,currentStudentId:k,isLoading:!0})),y.loadProfile(k,!1)}const y={subscribe:t,init:g,loadProfile:p,forceRefresh:b,getCachedData:k=>c(k)};return y}const ki=hv();function gv(s,t){v(t,!e(t))}function _v(s,t){v(t,!e(t))}function bv(s,t){v(t,!e(t))}function yv(s,t){us.confirm("Change Password",`
			<div class="student-profile-password-form">
				<div class="student-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var wv=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),xv=_('<div class="silent-refresh-indicator"><span class="refresh-spinner"></span></div>'),Sv=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading student information...</p></div>'),kv=_('<div class="info-row row-five"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="info-content"><div class="info-label">Student ID</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person</span></div> <div class="info-content"><div class="info-label">Full Name</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">school</span></div> <div class="info-content"><div class="info-label">Year Level</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">group</span></div> <div class="info-content"><div class="info-label">Section</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="info-content"><div class="info-label">Total Subjects</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">email</span></div> <div class="info-content"><div class="info-label">Email</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">phone</span></div> <div class="info-content"><div class="info-label">Contact Number</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">family_restroom</span></div> <div class="info-content"><div class="info-label">Guardian</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-one"><div class="info-card address-card"><div class="info-icon"><span class="material-symbols-outlined">home</span></div> <div class="info-content"><div class="info-label">Address</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-two"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">cake</span></div> <div class="info-content"><div class="info-label">Birth Date</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Age</div> <div class="info-value"> </div></div></div></div>',1),Av=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading academic performance...</p></div>'),Dv=_('<div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Adviser</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">grade</span></div> <div class="info-content"><div class="info-label">General Average</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">leaderboard</span></div> <div class="info-content"><div class="info-label">Class Rank</div> <div class="info-value"> </div></div></div></div>'),Cv=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading enrolled subjects...</p></div>'),Tv=_('<div class="subject-card"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p class="teacher-name"> </p></div></div>'),Ev=_('<div class="subjects-grid"></div>'),Fv=_('<div class="subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects enrolled yet</p></div>'),Nv=_('<div class="profile-header"><div class="header-content"><h1 class="page-title">Student Profile</h1> <p class="page-subtitle">Personal Information & Academic Details</p></div> <div class="header-actions"><!> <button class="student-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="profile-info-section"><h2 class="section-title section-title-desktop">Student Information</h2> <button class="section-header-mobile" aria-label="Toggle student information"><h2 class="section-title">Student Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-academic-section"><h2 class="section-title section-title-desktop">Academic Performance</h2> <button class="section-header-mobile" aria-label="Toggle academic performance"><h2 class="section-title">Academic Performance</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-subjects-section"><h2 class="section-title section-title-desktop">Enrolled Subjects</h2> <button class="section-header-mobile" aria-label="Toggle enrolled subjects"><h2 class="section-title">Enrolled Subjects</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-security-section"><h2 class="section-title section-title-desktop">Account Security</h2> <div class="section-content"><div class="info-row row-one"><div class="info-card security-card"><div class="info-content-container"><div class="info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="info-content"><div class="info-label">Password</div> <div class="info-value">Change your account password for security</div></div></div> <div class="security-actions"><button class="security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),$v=_('<div class="profile-container"><!></div>');function Pv(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(ki,"$studentProfileStore",a);let l=ut(void 0);Es(()=>gs.subscribe($=>{v(l,$,!0)}));let c=ea(n),d=ea(()=>e(c).studentData),f=ea(()=>e(c).studentProfileData),p=ea(()=>e(c).isLoading),h=ea(()=>e(c).isRefreshing),g=ea(()=>e(c).error);function b(){e(l)?.userData?.id&&ki.forceRefresh(e(l).userData.id)}Es(()=>{e(l)?.userData?.id&&(ki.init(e(l).userData.id)||ki.loadProfile(e(l).userData.id,!1))}),Ya(()=>{const W=setInterval(()=>{e(l)?.userData?.id&&ki.loadProfile(e(l).userData.id,!0)},3e5);return()=>clearInterval(W)});let y=ea(()=>({id:e(d)?.number||e(l)?.userData?.accountNumber||"N/A",name:e(d)?.name||e(l)?.userData?.name||"Student Name",firstName:e(d)?.firstName||e(l)?.userData?.firstName||"",lastName:e(d)?.lastName||"",middleInitial:e(d)?.middleInitial||"",yearLevel:e(d)?.gradeLevel?`Grade ${e(d).gradeLevel}`:"Not assigned",section:e(f)?.section?.name||"Not assigned",email:e(d)?.email||"Not available",phone:e(d)?.contactNumber||"Not available",address:e(d)?.address||"Not available",birthDate:e(d)?.birthdate?new Date(e(d).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(d)?.age||"Not available",guardian:e(d)?.guardian||"Not available",gender:e(d)?.gender||e(l)?.userData?.gender||"male",academicSummary:{adviser:e(f)?.section?.adviser||"Not available",gpa:e(f)?.academicSummary?.generalAverage||"Not available",rank:e(f)?.academicSummary?.classRank||"Not available",totalStudents:e(f)?.academicSummary?.totalStudentsInSection||"Not available"},subjects:e(f)?.subjects||[]})),k=ea(()=>e(y).subjects.length||"Not available"),A=ut(!0),T=ut(!1),C=ut(!0),D=ut(!1);function S(W){const $=document.getElementById(W),X=$.nextElementSibling.querySelector(".password-eye-icon");$.type==="password"?($.type="text",X.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):($.type="password",X.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=S);async function L(){const W=document.getElementById("current-password"),$=document.getElementById("new-password"),R=document.getElementById("confirm-password");if(!W||!$||!R){ds("Password form inputs not found");return}const X=W.value,se=$.value,V=R.value;if(!X){ds("Current password is required");return}if(!se){ds("New password is required");return}if(se!==V){ds("New passwords do not match");return}if(se.length<8){ds("Password must be at least 8 characters long");return}if(X===se){ds("New password must be different from current password");return}try{v(D,!0);const re=await api.post("/api/change-password",{currentPassword:X,newPassword:se});re.success?(W.value="",$.value="",R.value="",jr("Password changed successfully!"),us.close()):ds(re.error||"Failed to change password")}catch(re){console.error("Password change error:",re),ds(re.message||"Failed to change password")}finally{v(D,!1)}}var F=$v(),j=o(F);{var P=W=>{var $=wv(),R=u(o($),2),X=o(R);i(R);var se=u(R,2);se.__click=b,i($),q(()=>w(X,`Failed to load profile data: ${e(g)??""}`)),m(W,$)},Q=W=>{var $=Nv(),R=Je($),X=u(o(R),2),se=o(X);{var V=B=>{var I=xv();m(B,I)};E(se,B=>{e(h)&&B(V)})}var re=u(se,2);re.__click=b,i(X),i(R);var me=u(R,2),je=u(o(me),2);je.__click=[gv,A];var de=u(o(je),2);let ie;i(je);var Pe=u(je,2);let Ve;var Ze=o(Pe);{var ve=B=>{var I=Sv();m(B,I)},Ce=B=>{var I=kv(),G=Je(I),Z=o(G),le=u(o(Z),2),N=u(o(le),2),M=o(N,!0);i(N),i(le),i(Z);var H=u(Z,2),pe=u(o(H),2),ee=u(o(pe),2),Ae=o(ee,!0);i(ee),i(pe),i(H);var Ue=u(H,2),Le=u(o(Ue),2),He=u(o(Le),2),Ie=o(He,!0);i(He),i(Le),i(Ue);var nt=u(Ue,2),bt=u(o(nt),2),pt=u(o(bt),2),vt=o(pt,!0);i(pt),i(bt),i(nt);var Tt=u(nt,2),Ot=u(o(Tt),2),la=u(o(Ot),2),sa=o(la,!0);i(la),i(Ot),i(Tt),i(G);var zt=u(G,2),qt=o(zt),Pt=u(o(qt),2),Yt=u(o(Pt),2),Ut=o(Yt,!0);i(Yt),i(Pt),i(qt);var Et=u(qt,2),ta=u(o(Et),2),fa=u(o(ta),2),oe=o(fa,!0);i(fa),i(ta),i(Et);var Ee=u(Et,2),dt=u(o(Ee),2),we=u(o(dt),2),Oe=o(we,!0);i(we),i(dt),i(Ee),i(zt);var lt=u(zt,2),Rt=o(lt),Ht=u(o(Rt),2),rt=u(o(Ht),2),ka=o(rt,!0);i(rt),i(Ht),i(Rt),i(lt);var Zt=u(lt,2),tt=o(Zt),wt=u(o(tt),2),ge=u(o(wt),2),te=o(ge,!0);i(ge),i(wt),i(tt);var J=u(tt,2),Be=u(o(J),2),Ge=u(o(Be),2),at=o(Ge,!0);i(Ge),i(Be),i(J),i(Zt),q(()=>{w(M,e(y).id),w(Ae,e(y).name),w(Ie,e(y).yearLevel),w(vt,e(y).section),w(sa,e(k)),w(Ut,e(y).email||"Not provided"),w(oe,e(y).phone||"Not provided"),w(Oe,e(y).guardian||"Not provided"),w(ka,e(y).address||"Not provided"),w(te,e(y).birthDate||"Not provided"),w(at,e(y).age?`${e(y).age} years old`:"Not available")}),m(B,I)};E(Ze,B=>{e(p)?B(ve):B(Ce,!1)})}i(Pe),i(me);var Qe=u(me,2),Xe=u(o(Qe),2);Xe.__click=[_v,T];var ze=u(o(Xe),2);let We;i(Xe);var Te=u(Xe,2);let ue;var be=o(Te);{var ke=B=>{var I=Av();m(B,I)},Fe=B=>{var I=Dv(),G=o(I),Z=u(o(G),2),le=u(o(Z),2),N=o(le,!0);i(le),i(Z),i(G);var M=u(G,2),H=u(o(M),2),pe=u(o(H),2),ee=o(pe,!0);i(pe),i(H),i(M);var Ae=u(M,2),Ue=u(o(Ae),2),Le=u(o(Ue),2),He=o(Le,!0);i(Le),i(Ue),i(Ae),i(I),q(()=>{w(N,e(y).academicSummary.adviser),w(ee,e(y).academicSummary.gpa!=="Not available"?`${e(y).academicSummary.gpa}`:"Not available"),w(He,e(y).academicSummary.rank!=="Not available"&&e(y).academicSummary.totalStudents!=="Not available"?`${e(y).academicSummary.rank} of ${e(y).academicSummary.totalStudents}`:"Not available")}),m(B,I)};E(be,B=>{e(p)?B(ke):B(Fe,!1)})}i(Te),i(Qe);var Re=u(Qe,2),et=u(o(Re),2);et.__click=[bv,C];var $e=u(o(et),2);let ot;i(et);var Me=u(et,2);let it;var ft=o(Me);{var Ye=B=>{var I=Cv();m(B,I)},Y=B=>{var I=mt(),G=Je(I);{var Z=N=>{var M=Ev();xt(M,21,()=>e(y).subjects,H=>H.id,(H,pe)=>{var ee=Tv(),Ae=o(ee),Ue=o(Ae);i(Ae);var Le=u(Ae,2),He=o(Le),Ie=o(He,!0);i(He);var nt=u(He,2),bt=o(nt,!0);i(nt),i(Le),i(ee),q(()=>{Wa(ee,`border-color: ${e(pe).color??""};`),Wa(Ue,`background-color: ${e(pe).color??""}20; color: ${e(pe).color??""}`),w(Ie,e(pe).name),w(bt,e(pe).teacher)}),m(H,ee)}),i(M),m(N,M)},le=N=>{var M=Fv();m(N,M)};E(G,N=>{e(y).subjects.length>0?N(Z):N(le,!1)},!0)}m(B,I)};E(ft,B=>{e(p)?B(Ye):B(Y,!1)})}i(Me),i(Re);var ce=u(Re,2),De=u(o(ce),2),U=o(De),ne=o(U),fe=u(o(ne),2),z=o(fe);z.__click=[yv,L],i(fe),i(ne),i(U),i(De),i(ce),q((B,I,G,Z,le,N)=>{re.disabled=e(p),ie=_e(de,1,"material-symbols-outlined collapse-icon",null,ie,B),Ve=_e(Pe,1,"section-content",null,Ve,I),We=_e(ze,1,"material-symbols-outlined collapse-icon",null,We,G),ue=_e(Te,1,"section-content",null,ue,Z),ot=_e($e,1,"material-symbols-outlined collapse-icon",null,ot,le),it=_e(Me,1,"section-content",null,it,N)},[()=>({rotated:e(A)}),()=>({collapsed:e(A)}),()=>({rotated:e(T)}),()=>({collapsed:e(T)}),()=>({rotated:e(C)}),()=>({collapsed:e(C)})]),m(W,$)};E(j,W=>{e(g)?W(P):W(Q,!1)})}i(F),m(s,F),za(),r()}Ps(["click"]);var Sn=function(){return Sn=Object.assign||function(s){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n]);return s},Sn.apply(this,arguments)},Lv=(function(){function s(t,a,r){var n=this;this.endVal=a,this.options=r,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(l){n.startTime||(n.startTime=l);var c=l-n.startTime;n.remaining=n.duration-c,n.useEasing?n.countDown?n.frameVal=n.startVal-n.easingFn(c,0,n.startVal-n.endVal,n.duration):n.frameVal=n.easingFn(c,n.startVal,n.endVal-n.startVal,n.duration):n.frameVal=n.startVal+(n.endVal-n.startVal)*(c/n.duration);var d=n.countDown?n.frameVal<n.endVal:n.frameVal>n.endVal;n.frameVal=d?n.endVal:n.frameVal,n.frameVal=Number(n.frameVal.toFixed(n.options.decimalPlaces)),n.printValue(n.frameVal),c<n.duration?n.rAF=requestAnimationFrame(n.count):n.finalEndVal!==null?n.update(n.finalEndVal):n.options.onCompleteCallback&&n.options.onCompleteCallback()},this.formatNumber=function(l){var c,d,f,p,h=l<0?"-":"";c=Math.abs(l).toFixed(n.options.decimalPlaces);var g=(c+="").split(".");if(d=g[0],f=g.length>1?n.options.decimal+g[1]:"",n.options.useGrouping){p="";for(var b=3,y=0,k=0,A=d.length;k<A;++k)n.options.useIndianSeparators&&k===4&&(b=2,y=1),k!==0&&y%b==0&&(p=n.options.separator+p),y++,p=d[A-k-1]+p;d=p}return n.options.numerals&&n.options.numerals.length&&(d=d.replace(/[0-9]/g,(function(T){return n.options.numerals[+T]})),f=f.replace(/[0-9]/g,(function(T){return n.options.numerals[+T]}))),h+n.options.prefix+d+f+n.options.suffix},this.easeOutExpo=function(l,c,d,f){return d*(1-Math.pow(2,-10*l/f))*1024/1023+c},this.options=Sn(Sn({},this.defaults),r),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof t=="string"?document.getElementById(t):t,a=a??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(a),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,t):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return n.handleScroll(n)})),window.onscroll=function(){window.onScrollFns.forEach((function(l){return l()}))},this.handleScroll(this)))}return s.prototype.handleScroll=function(t){if(t&&window&&!t.once){var a=window.innerHeight+window.scrollY,r=t.el.getBoundingClientRect(),n=r.top+window.pageYOffset,l=r.top+r.height+window.pageYOffset;l<a&&l>window.scrollY&&t.paused?(t.paused=!1,setTimeout((function(){return t.start()}),t.options.scrollSpyDelay),t.options.scrollSpyOnce&&(t.once=!0)):(window.scrollY>l||n>a)&&!t.paused&&t.reset()}},s.prototype.determineDirectionAndSmartEasing=function(){var t=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>t;var a=t-this.startVal;if(Math.abs(a)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=t;var r=this.countDown?1:-1;this.endVal=t+r*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=t,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},s.prototype.start=function(t){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),t&&(this.options.onCompleteCallback=t),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},s.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},s.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},s.prototype.update=function(t){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(t),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},s.prototype.printValue=function(t){var a;if(this.el){var r=this.formattingFn(t);!((a=this.options.plugin)===null||a===void 0)&&a.render?this.options.plugin.render(this.el,r):this.el.tagName==="INPUT"?this.el.value=r:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=r:this.el.innerHTML=r}},s.prototype.ensureNumber=function(t){return typeof t=="number"&&!isNaN(t)},s.prototype.validateValue=function(t){var a=Number(t);return this.ensureNumber(a)?a:(this.error="[CountUp] invalid start or end value: ".concat(t),null)},s.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},s.prototype.parse=function(t){var a=function(c){return c.replace(/([.,' ])/g,"\\$1")},r=a(this.options.separator),n=a(this.options.decimal),l=t.replace(new RegExp(r,"g"),"").replace(new RegExp(n,"g"),".");return parseFloat(l)},s})(),Mv=_('<span class="countup-container svelte-185m73z"><!></span>');function Qr(s,t){qa(t,!1);let a=Ma(t,"value",8,0),r=Ma(t,"decimals",8,1),n=Ma(t,"duration",8,2),l=Ma(t,"useEasing",8,!0),c=Ma(t,"useGrouping",8,!0),d=Ma(t,"separator",8,","),f=Ma(t,"decimal",8,"."),p=Ma(t,"prefix",8,""),h=Ma(t,"suffix",8,""),g=Ma(t,"startVal",8,0),b=Ma(t,"colorTransition",8,!1),y=Ma(t,"getGradeColor",8,null),k=O(),A=O(),T=O(!1),C=O(!1),D=O(""),S=null;function L(W,$){return W.toFixed($).replace(/\.0+$/,"")}Ya(()=>(e(k)&&(Fs(k,e(k).textContent=`${p()}${L(g(),r())}${h()}`),b()&&y()&&v(D,y()(65)),v(T,!0),a()!==g()&&a()>0&&j()),()=>{S&&cancelAnimationFrame(S)}));function F(W){if(!b()||!y()||!al)return;const R=Date.now()-W,X=Math.min(R/(n()*1e3),1);let se=0;a()>=85?se=3:a()>=80?se=2:a()>=75?se=1:se=0;const V=Math.min(X*1.6,1),re=Math.min(Math.floor(V*(se+1)),se),je=[65,75,80,85][re];v(D,y()(je)),X<1?S=requestAnimationFrame(()=>F(W)):v(D,y()(a()))}function j(){if(!(!e(k)||!e(T)||e(C)))try{v(A,new Lv(e(k),a(),{startVal:g(),decimalPlaces:r(),duration:n(),useEasing:l(),useGrouping:c(),separator:d(),decimal:f(),prefix:p(),suffix:h(),formattingFn:W=>W.toFixed(r()).replace(/\.0+$/,"")})),e(A).error?(console.error("CountUp error:",e(A).error),Fs(k,e(k).textContent=`${p()}${L(a(),r())}${h()}`),b()&&y()&&v(D,y()(a()))):(e(A).start(),v(C,!0),b()&&y()&&F(Date.now()))}catch(W){console.error("Failed to initialize CountUp:",W),Fs(k,e(k).textContent=`${p()}${L(a(),r())}${h()}`),b()&&y()&&v(D,y()(a()))}}_t(()=>(e(T),xs(a()),xs(g()),e(C)),()=>{e(T)&&a()!==g()&&a()>0&&!e(C)&&j()}),_t(()=>(e(A),e(C),xs(a()),xs(g()),xs(p()),xs(r()),xs(h())),()=>{if(e(A)&&al&&e(C)&&a()!==g())try{e(A).update(a())}catch(W){console.error("CountUp update error:",W),Fs(k,e(k).textContent=`${p()}${L(a(),r())}${h()}`)}}),Rs(),Ls();var P=Mv(),Q=o(P);E(Q,W=>{}),i(P),Ws(P,W=>v(k,W),()=>e(k)),q(()=>Wa(P,b()&&e(D)?`color: ${e(D)}`:"")),m(s,P),za()}const Iv=s=>s;function Rv(s){const t=s-1;return t*t*t+1}function il(s){const t=typeof s=="string"&&s.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[s,"px"]}function Gs(s,{delay:t=0,duration:a=400,easing:r=Iv}={}){const n=+getComputedStyle(s).opacity;return{delay:t,duration:a,easing:r,css:l=>`opacity: ${l*n}`}}function Vs(s,{delay:t=0,duration:a=400,easing:r=Rv,x:n=0,y:l=0,opacity:c=0}={}){const d=getComputedStyle(s),f=+d.opacity,p=d.transform==="none"?"":d.transform,h=f*(1-c),[g,b]=il(n),[y,k]=il(l);return{delay:t,duration:a,easing:r,css:(A,T)=>`
			transform: ${p} translate(${(1-A)*g}${b}, ${(1-A)*y}${k});
			opacity: ${f-h*T}`}}function Bs(s){return--s*s*s*s*s+1}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Wi(s){return s+.5|0}const Lr=(s,t,a)=>Math.max(Math.min(s,a),t);function Pi(s){return Lr(Wi(s*2.55),0,255)}function Rr(s){return Lr(Wi(s*255),0,255)}function Cr(s){return Lr(Wi(s/2.55)/100,0,1)}function nl(s){return Lr(Wi(s*100),0,100)}const ir={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},fo=[..."0123456789ABCDEF"],Ov=s=>fo[s&15],jv=s=>fo[(s&240)>>4]+fo[s&15],nn=s=>(s&240)>>4===(s&15),qv=s=>nn(s.r)&&nn(s.g)&&nn(s.b)&&nn(s.a);function zv(s){var t=s.length,a;return s[0]==="#"&&(t===4||t===5?a={r:255&ir[s[1]]*17,g:255&ir[s[2]]*17,b:255&ir[s[3]]*17,a:t===5?ir[s[4]]*17:255}:(t===7||t===9)&&(a={r:ir[s[1]]<<4|ir[s[2]],g:ir[s[3]]<<4|ir[s[4]],b:ir[s[5]]<<4|ir[s[6]],a:t===9?ir[s[7]]<<4|ir[s[8]]:255})),a}const Gv=(s,t)=>s<255?t(s):"";function Vv(s){var t=qv(s)?Ov:jv;return s?"#"+t(s.r)+t(s.g)+t(s.b)+Gv(s.a,t):void 0}const Bv=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Lc(s,t,a){const r=t*Math.min(a,1-a),n=(l,c=(l+s/30)%12)=>a-r*Math.max(Math.min(c-3,9-c,1),-1);return[n(0),n(8),n(4)]}function Wv(s,t,a){const r=(n,l=(n+s/60)%6)=>a-a*t*Math.max(Math.min(l,4-l,1),0);return[r(5),r(3),r(1)]}function Hv(s,t,a){const r=Lc(s,1,.5);let n;for(t+a>1&&(n=1/(t+a),t*=n,a*=n),n=0;n<3;n++)r[n]*=1-t-a,r[n]+=t;return r}function Uv(s,t,a,r,n){return s===n?(t-a)/r+(t<a?6:0):t===n?(a-s)/r+2:(s-t)/r+4}function bo(s){const a=s.r/255,r=s.g/255,n=s.b/255,l=Math.max(a,r,n),c=Math.min(a,r,n),d=(l+c)/2;let f,p,h;return l!==c&&(h=l-c,p=d>.5?h/(2-l-c):h/(l+c),f=Uv(a,r,n,h,l),f=f*60+.5),[f|0,p||0,d]}function yo(s,t,a,r){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,a,r)).map(Rr)}function wo(s,t,a){return yo(Lc,s,t,a)}function Yv(s,t,a){return yo(Hv,s,t,a)}function Qv(s,t,a){return yo(Wv,s,t,a)}function Mc(s){return(s%360+360)%360}function Kv(s){const t=Bv.exec(s);let a=255,r;if(!t)return;t[5]!==r&&(a=t[6]?Pi(+t[5]):Rr(+t[5]));const n=Mc(+t[2]),l=+t[3]/100,c=+t[4]/100;return t[1]==="hwb"?r=Yv(n,l,c):t[1]==="hsv"?r=Qv(n,l,c):r=wo(n,l,c),{r:r[0],g:r[1],b:r[2],a}}function Jv(s,t){var a=bo(s);a[0]=Mc(a[0]+t),a=wo(a),s.r=a[0],s.g=a[1],s.b=a[2]}function Xv(s){if(!s)return;const t=bo(s),a=t[0],r=nl(t[1]),n=nl(t[2]);return s.a<255?`hsla(${a}, ${r}%, ${n}%, ${Cr(s.a)})`:`hsl(${a}, ${r}%, ${n}%)`}const ol={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ll={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Zv(){const s={},t=Object.keys(ll),a=Object.keys(ol);let r,n,l,c,d;for(r=0;r<t.length;r++){for(c=d=t[r],n=0;n<a.length;n++)l=a[n],d=d.replace(l,ol[l]);l=parseInt(ll[c],16),s[d]=[l>>16&255,l>>8&255,l&255]}return s}let on;function ef(s){on||(on=Zv(),on.transparent=[0,0,0,0]);const t=on[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const tf=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function af(s){const t=tf.exec(s);let a=255,r,n,l;if(t){if(t[7]!==r){const c=+t[7];a=t[8]?Pi(c):Lr(c*255,0,255)}return r=+t[1],n=+t[3],l=+t[5],r=255&(t[2]?Pi(r):Lr(r,0,255)),n=255&(t[4]?Pi(n):Lr(n,0,255)),l=255&(t[6]?Pi(l):Lr(l,0,255)),{r,g:n,b:l,a}}}function sf(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${Cr(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const Jn=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,oi=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function rf(s,t,a){const r=oi(Cr(s.r)),n=oi(Cr(s.g)),l=oi(Cr(s.b));return{r:Rr(Jn(r+a*(oi(Cr(t.r))-r))),g:Rr(Jn(n+a*(oi(Cr(t.g))-n))),b:Rr(Jn(l+a*(oi(Cr(t.b))-l))),a:s.a+a*(t.a-s.a)}}function ln(s,t,a){if(s){let r=bo(s);r[t]=Math.max(0,Math.min(r[t]+r[t]*a,t===0?360:1)),r=wo(r),s.r=r[0],s.g=r[1],s.b=r[2]}}function Ic(s,t){return s&&Object.assign(t||{},s)}function cl(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=Rr(s[3]))):(t=Ic(s,{r:0,g:0,b:0,a:1}),t.a=Rr(t.a)),t}function nf(s){return s.charAt(0)==="r"?af(s):Kv(s)}class qi{constructor(t){if(t instanceof qi)return t;const a=typeof t;let r;a==="object"?r=cl(t):a==="string"&&(r=zv(t)||ef(t)||nf(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=Ic(this._rgb);return t&&(t.a=Cr(t.a)),t}set rgb(t){this._rgb=cl(t)}rgbString(){return this._valid?sf(this._rgb):void 0}hexString(){return this._valid?Vv(this._rgb):void 0}hslString(){return this._valid?Xv(this._rgb):void 0}mix(t,a){if(t){const r=this.rgb,n=t.rgb;let l;const c=a===l?.5:a,d=2*c-1,f=r.a-n.a,p=((d*f===-1?d:(d+f)/(1+d*f))+1)/2;l=1-p,r.r=255&p*r.r+l*n.r+.5,r.g=255&p*r.g+l*n.g+.5,r.b=255&p*r.b+l*n.b+.5,r.a=c*r.a+(1-c)*n.a,this.rgb=r}return this}interpolate(t,a){return t&&(this._rgb=rf(this._rgb,t._rgb,a)),this}clone(){return new qi(this.rgb)}alpha(t){return this._rgb.a=Rr(t),this}clearer(t){const a=this._rgb;return a.a*=1-t,this}greyscale(){const t=this._rgb,a=Wi(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=a,this}opaquer(t){const a=this._rgb;return a.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return ln(this._rgb,2,t),this}darken(t){return ln(this._rgb,2,-t),this}saturate(t){return ln(this._rgb,1,t),this}desaturate(t){return ln(this._rgb,1,-t),this}rotate(t){return Jv(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function kr(){}const of=(()=>{let s=0;return()=>s++})();function ls(s){return s==null}function Ns(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ka(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function dr(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function hr(s,t){return dr(s)?s:t}function Qa(s,t){return typeof s>"u"?t:s}const lf=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/t,Rc=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function ps(s,t,a){if(s&&typeof s.call=="function")return s.apply(a,t)}function as(s,t,a,r){let n,l,c;if(Ns(s))for(l=s.length,n=0;n<l;n++)t.call(a,s[n],n);else if(Ka(s))for(c=Object.keys(s),l=c.length,n=0;n<l;n++)t.call(a,s[c[n]],c[n])}function kn(s,t){let a,r,n,l;if(!s||!t||s.length!==t.length)return!1;for(a=0,r=s.length;a<r;++a)if(n=s[a],l=t[a],n.datasetIndex!==l.datasetIndex||n.index!==l.index)return!1;return!0}function An(s){if(Ns(s))return s.map(An);if(Ka(s)){const t=Object.create(null),a=Object.keys(s),r=a.length;let n=0;for(;n<r;++n)t[a[n]]=An(s[a[n]]);return t}return s}function Oc(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function cf(s,t,a,r){if(!Oc(s))return;const n=t[s],l=a[s];Ka(n)&&Ka(l)?zi(n,l,r):t[s]=An(l)}function zi(s,t,a){const r=Ns(t)?t:[t],n=r.length;if(!Ka(s))return s;a=a||{};const l=a.merger||cf;let c;for(let d=0;d<n;++d){if(c=r[d],!Ka(c))continue;const f=Object.keys(c);for(let p=0,h=f.length;p<h;++p)l(f[p],s,c,a)}return s}function Ri(s,t){return zi(s,t,{merger:df})}function df(s,t,a){if(!Oc(s))return;const r=t[s],n=a[s];Ka(r)&&Ka(n)?Ri(r,n):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=An(n))}const dl={"":s=>s,x:s=>s.x,y:s=>s.y};function uf(s){const t=s.split("."),a=[];let r="";for(const n of t)r+=n,r.endsWith("\\")?r=r.slice(0,-1)+".":(a.push(r),r="");return a}function vf(s){const t=uf(s);return a=>{for(const r of t){if(r==="")break;a=a&&a[r]}return a}}function Xr(s,t){return(dl[t]||(dl[t]=vf(t)))(s)}function xo(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Gi=s=>typeof s<"u",qr=s=>typeof s=="function",ul=(s,t)=>{if(s.size!==t.size)return!1;for(const a of s)if(!t.has(a))return!1;return!0};function ff(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const os=Math.PI,Ts=2*os,Dn=Number.POSITIVE_INFINITY,pf=os/180,$s=os/2,Br=os/4,vl=os*2/3,jc=Math.log10,Or=Math.sign;function _n(s,t,a){return Math.abs(s-t)<a}function fl(s){const t=Math.round(s);s=_n(s,t,s/1e3)?t:s;const a=Math.pow(10,Math.floor(jc(s))),r=s/a;return(r<=1?1:r<=2?2:r<=5?5:10)*a}function mf(s){const t=[],a=Math.sqrt(s);let r;for(r=1;r<a;r++)s%r===0&&(t.push(r),t.push(s/r));return a===(a|0)&&t.push(a),t.sort((n,l)=>n-l).pop(),t}function hf(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function Cn(s){return!hf(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function gf(s,t){const a=Math.round(s);return a-t<=s&&a+t>=s}function _f(s,t,a){let r,n,l;for(r=0,n=s.length;r<n;r++)l=s[r][a],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function Er(s){return s*(os/180)}function bf(s){return s*(180/os)}function pl(s){if(!dr(s))return;let t=1,a=0;for(;Math.round(s*t)/t!==s;)t*=10,a++;return a}function qc(s,t){const a=t.x-s.x,r=t.y-s.y,n=Math.sqrt(a*a+r*r);let l=Math.atan2(r,a);return l<-.5*os&&(l+=Ts),{angle:l,distance:n}}function yf(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function Sr(s){return(s%Ts+Ts)%Ts}function Tn(s,t,a,r){const n=Sr(s),l=Sr(t),c=Sr(a),d=Sr(l-n),f=Sr(c-n),p=Sr(n-l),h=Sr(n-c);return n===l||n===c||r&&l===c||d>f&&p<h}function Js(s,t,a){return Math.max(t,Math.min(a,s))}function wf(s){return Js(s,-32768,32767)}function Kr(s,t,a,r=1e-6){return s>=Math.min(t,a)-r&&s<=Math.max(t,a)+r}function So(s,t,a){a=a||(c=>s[c]<t);let r=s.length-1,n=0,l;for(;r-n>1;)l=n+r>>1,a(l)?n=l:r=l;return{lo:n,hi:r}}const po=(s,t,a,r)=>So(s,a,r?n=>{const l=s[n][t];return l<a||l===a&&s[n+1][t]===a}:n=>s[n][t]<a),xf=(s,t,a)=>So(s,a,r=>s[r][t]>=a);function Sf(s,t,a){let r=0,n=s.length;for(;r<n&&s[r]<t;)r++;for(;n>r&&s[n-1]>a;)n--;return r>0||n<s.length?s.slice(r,n):s}const zc=["push","pop","shift","splice","unshift"];function kf(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),zc.forEach(a=>{const r="_onData"+xo(a),n=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!1,value(...l){const c=n.apply(this,l);return s._chartjs.listeners.forEach(d=>{typeof d[r]=="function"&&d[r](...l)}),c}})})}function ml(s,t){const a=s._chartjs;if(!a)return;const r=a.listeners,n=r.indexOf(t);n!==-1&&r.splice(n,1),!(r.length>0)&&(zc.forEach(l=>{delete s[l]}),delete s._chartjs)}function Gc(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const Vc=(function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame})();function Bc(s,t){let a=[],r=!1;return function(...n){a=n,r||(r=!0,Vc.call(window,()=>{r=!1,s.apply(t,a)}))}}function Af(s,t){let a;return function(...r){return t?(clearTimeout(a),a=setTimeout(s,t,r)):s.apply(this,r),t}}const ko=s=>s==="start"?"left":s==="end"?"right":"center",qs=(s,t,a)=>s==="start"?t:s==="end"?a:(t+a)/2,Df=(s,t,a,r)=>s===(r?"left":"right")?a:s==="center"?(t+a)/2:t,cn=s=>s===0||s===1,hl=(s,t,a)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*Ts/a)),gl=(s,t,a)=>Math.pow(2,-10*s)*Math.sin((s-t)*Ts/a)+1,Oi={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*$s)+1,easeOutSine:s=>Math.sin(s*$s),easeInOutSine:s=>-.5*(Math.cos(os*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>cn(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>cn(s)?s:hl(s,.075,.3),easeOutElastic:s=>cn(s)?s:gl(s,.075,.3),easeInOutElastic(s){return cn(s)?s:s<.5?.5*hl(s*2,.1125,.45):.5+.5*gl(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-Oi.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?Oi.easeInBounce(s*2)*.5:Oi.easeOutBounce(s*2-1)*.5+.5};function Wc(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function _l(s){return Wc(s)?s:new qi(s)}function Xn(s){return Wc(s)?s:new qi(s).saturate(.5).darken(.1).hexString()}const Cf=["x","y","borderWidth","radius","tension"],Tf=["color","borderColor","backgroundColor"];function Ef(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:Tf},numbers:{type:"number",properties:Cf}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Ff(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const bl=new Map;function Nf(s,t){t=t||{};const a=s+JSON.stringify(t);let r=bl.get(a);return r||(r=new Intl.NumberFormat(s,t),bl.set(a,r)),r}function Ao(s,t,a){return Nf(t,a).format(s)}const $f={values(s){return Ns(s)?s:""+s},numeric(s,t,a){if(s===0)return"0";const r=this.chart.options.locale;let n,l=s;if(a.length>1){const p=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(p<1e-4||p>1e15)&&(n="scientific"),l=Pf(s,a)}const c=jc(Math.abs(l)),d=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:n,minimumFractionDigits:d,maximumFractionDigits:d};return Object.assign(f,this.options.ticks.format),Ao(s,r,f)}};function Pf(s,t){let a=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(a)>=1&&s!==Math.floor(s)&&(a=s-Math.floor(s)),a}var Hc={formatters:$f};function Lf(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,a)=>a.lineWidth,tickColor:(t,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Hc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Zr=Object.create(null),mo=Object.create(null);function ji(s,t){if(!t)return s;const a=t.split(".");for(let r=0,n=a.length;r<n;++r){const l=a[r];s=s[l]||(s[l]=Object.create(null))}return s}function Zn(s,t,a){return typeof t=="string"?zi(ji(s,t),a):zi(ji(s,""),t)}class Mf{constructor(t,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,n)=>Xn(n.backgroundColor),this.hoverBorderColor=(r,n)=>Xn(n.borderColor),this.hoverColor=(r,n)=>Xn(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(a)}set(t,a){return Zn(this,t,a)}get(t){return ji(this,t)}describe(t,a){return Zn(mo,t,a)}override(t,a){return Zn(Zr,t,a)}route(t,a,r,n){const l=ji(this,t),c=ji(this,r),d="_"+a;Object.defineProperties(l,{[d]:{value:l[a],writable:!0},[a]:{enumerable:!0,get(){const f=this[d],p=c[n];return Ka(f)?Object.assign({},p,f):Qa(f,p)},set(f){this[d]=f}}})}apply(t){t.forEach(a=>a(this))}}var Ss=new Mf({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ef,Ff,Lf]);function If(s){return!s||ls(s.size)||ls(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function yl(s,t,a,r,n){let l=t[n];return l||(l=t[n]=s.measureText(n).width,a.push(n)),l>r&&(r=l),r}function Wr(s,t,a){const r=s.currentDevicePixelRatio,n=a!==0?Math.max(a/2,.5):0;return Math.round((t-n)*r)/r+n}function wl(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function xl(s,t,a,r){Uc(s,t,a,r,null)}function Uc(s,t,a,r,n){let l,c,d,f,p,h,g,b;const y=t.pointStyle,k=t.rotation,A=t.radius;let T=(k||0)*pf;if(y&&typeof y=="object"&&(l=y.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){s.save(),s.translate(a,r),s.rotate(T),s.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),s.restore();return}if(!(isNaN(A)||A<=0)){switch(s.beginPath(),y){default:n?s.ellipse(a,r,n/2,A,0,0,Ts):s.arc(a,r,A,0,Ts),s.closePath();break;case"triangle":h=n?n/2:A,s.moveTo(a+Math.sin(T)*h,r-Math.cos(T)*A),T+=vl,s.lineTo(a+Math.sin(T)*h,r-Math.cos(T)*A),T+=vl,s.lineTo(a+Math.sin(T)*h,r-Math.cos(T)*A),s.closePath();break;case"rectRounded":p=A*.516,f=A-p,c=Math.cos(T+Br)*f,g=Math.cos(T+Br)*(n?n/2-p:f),d=Math.sin(T+Br)*f,b=Math.sin(T+Br)*(n?n/2-p:f),s.arc(a-g,r-d,p,T-os,T-$s),s.arc(a+b,r-c,p,T-$s,T),s.arc(a+g,r+d,p,T,T+$s),s.arc(a-b,r+c,p,T+$s,T+os),s.closePath();break;case"rect":if(!k){f=Math.SQRT1_2*A,h=n?n/2:f,s.rect(a-h,r-f,2*h,2*f);break}T+=Br;case"rectRot":g=Math.cos(T)*(n?n/2:A),c=Math.cos(T)*A,d=Math.sin(T)*A,b=Math.sin(T)*(n?n/2:A),s.moveTo(a-g,r-d),s.lineTo(a+b,r-c),s.lineTo(a+g,r+d),s.lineTo(a-b,r+c),s.closePath();break;case"crossRot":T+=Br;case"cross":g=Math.cos(T)*(n?n/2:A),c=Math.cos(T)*A,d=Math.sin(T)*A,b=Math.sin(T)*(n?n/2:A),s.moveTo(a-g,r-d),s.lineTo(a+g,r+d),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c);break;case"star":g=Math.cos(T)*(n?n/2:A),c=Math.cos(T)*A,d=Math.sin(T)*A,b=Math.sin(T)*(n?n/2:A),s.moveTo(a-g,r-d),s.lineTo(a+g,r+d),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c),T+=Br,g=Math.cos(T)*(n?n/2:A),c=Math.cos(T)*A,d=Math.sin(T)*A,b=Math.sin(T)*(n?n/2:A),s.moveTo(a-g,r-d),s.lineTo(a+g,r+d),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c);break;case"line":c=n?n/2:Math.cos(T)*A,d=Math.sin(T)*A,s.moveTo(a-c,r-d),s.lineTo(a+c,r+d);break;case"dash":s.moveTo(a,r),s.lineTo(a+Math.cos(T)*(n?n/2:A),r+Math.sin(T)*A);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function Yc(s,t,a){return a=a||.5,!t||s&&s.x>t.left-a&&s.x<t.right+a&&s.y>t.top-a&&s.y<t.bottom+a}function Do(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function Co(s){s.restore()}function Rf(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),ls(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function Of(s,t,a,r,n){if(n.strikethrough||n.underline){const l=s.measureText(r),c=t-l.actualBoundingBoxLeft,d=t+l.actualBoundingBoxRight,f=a-l.actualBoundingBoxAscent,p=a+l.actualBoundingBoxDescent,h=n.strikethrough?(f+p)/2:p;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=n.decorationWidth||2,s.moveTo(c,h),s.lineTo(d,h),s.stroke()}}function jf(s,t){const a=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=a}function Vi(s,t,a,r,n,l={}){const c=Ns(t)?t:[t],d=l.strokeWidth>0&&l.strokeColor!=="";let f,p;for(s.save(),s.font=n.string,Rf(s,l),f=0;f<c.length;++f)p=c[f],l.backdrop&&jf(s,l.backdrop),d&&(l.strokeColor&&(s.strokeStyle=l.strokeColor),ls(l.strokeWidth)||(s.lineWidth=l.strokeWidth),s.strokeText(p,a,r,l.maxWidth)),s.fillText(p,a,r,l.maxWidth),Of(s,a,r,p,l),r+=Number(n.lineHeight);s.restore()}function En(s,t){const{x:a,y:r,w:n,h:l,radius:c}=t;s.arc(a+c.topLeft,r+c.topLeft,c.topLeft,1.5*os,os,!0),s.lineTo(a,r+l-c.bottomLeft),s.arc(a+c.bottomLeft,r+l-c.bottomLeft,c.bottomLeft,os,$s,!0),s.lineTo(a+n-c.bottomRight,r+l),s.arc(a+n-c.bottomRight,r+l-c.bottomRight,c.bottomRight,$s,0,!0),s.lineTo(a+n,r+c.topRight),s.arc(a+n-c.topRight,r+c.topRight,c.topRight,0,-$s,!0),s.lineTo(a+c.topLeft,r)}const qf=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,zf=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Gf(s,t){const a=(""+s).match(qf);if(!a||a[1]==="normal")return t*1.2;switch(s=+a[2],a[3]){case"px":return s;case"%":s/=100;break}return t*s}const Vf=s=>+s||0;function To(s,t){const a={},r=Ka(t),n=r?Object.keys(t):t,l=Ka(s)?r?c=>Qa(s[c],s[t[c]]):c=>s[c]:()=>s;for(const c of n)a[c]=Vf(l(c));return a}function Qc(s){return To(s,{top:"y",right:"x",bottom:"y",left:"x"})}function ui(s){return To(s,["topLeft","topRight","bottomLeft","bottomRight"])}function ur(s){const t=Qc(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function zs(s,t){s=s||{},t=t||Ss.font;let a=Qa(s.size,t.size);typeof a=="string"&&(a=parseInt(a,10));let r=Qa(s.style,t.style);r&&!(""+r).match(zf)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const n={family:Qa(s.family,t.family),lineHeight:Gf(Qa(s.lineHeight,t.lineHeight),a),size:a,style:r,weight:Qa(s.weight,t.weight),string:""};return n.string=If(n),n}function dn(s,t,a,r){let n,l,c;for(n=0,l=s.length;n<l;++n)if(c=s[n],c!==void 0&&c!==void 0)return c}function Bf(s,t,a){const{min:r,max:n}=s,l=Rc(t,(n-r)/2),c=(d,f)=>a&&d===0?0:d+f;return{min:c(r,-Math.abs(l)),max:c(n,l)}}function pi(s,t){return Object.assign(Object.create(s),t)}function Eo(s,t=[""],a,r,n=()=>s[0]){const l=a||s;typeof r>"u"&&(r=Zc("_fallback",s));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:l,_fallback:r,_getTarget:n,override:d=>Eo([d,...s],t,l,r)};return new Proxy(c,{deleteProperty(d,f){return delete d[f],delete d._keys,delete s[0][f],!0},get(d,f){return Jc(d,f,()=>Xf(f,t,s,d))},getOwnPropertyDescriptor(d,f){return Reflect.getOwnPropertyDescriptor(d._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(d,f){return kl(d).includes(f)},ownKeys(d){return kl(d)},set(d,f,p){const h=d._storage||(d._storage=n());return d[f]=h[f]=p,delete d._keys,!0}})}function fi(s,t,a,r){const n={_cacheable:!1,_proxy:s,_context:t,_subProxy:a,_stack:new Set,_descriptors:Kc(s,r),setContext:l=>fi(s,l,a,r),override:l=>fi(s.override(l),t,a,r)};return new Proxy(n,{deleteProperty(l,c){return delete l[c],delete s[c],!0},get(l,c,d){return Jc(l,c,()=>Hf(l,c,d))},getOwnPropertyDescriptor(l,c){return l._descriptors.allKeys?Reflect.has(s,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,c)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(l,c){return Reflect.has(s,c)},ownKeys(){return Reflect.ownKeys(s)},set(l,c,d){return s[c]=d,delete l[c],!0}})}function Kc(s,t={scriptable:!0,indexable:!0}){const{_scriptable:a=t.scriptable,_indexable:r=t.indexable,_allKeys:n=t.allKeys}=s;return{allKeys:n,scriptable:a,indexable:r,isScriptable:qr(a)?a:()=>a,isIndexable:qr(r)?r:()=>r}}const Wf=(s,t)=>s?s+xo(t):t,Fo=(s,t)=>Ka(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Jc(s,t,a){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const r=a();return s[t]=r,r}function Hf(s,t,a){const{_proxy:r,_context:n,_subProxy:l,_descriptors:c}=s;let d=r[t];return qr(d)&&c.isScriptable(t)&&(d=Uf(t,d,s,a)),Ns(d)&&d.length&&(d=Yf(t,d,s,c.isIndexable)),Fo(t,d)&&(d=fi(d,n,l&&l[t],c)),d}function Uf(s,t,a,r){const{_proxy:n,_context:l,_subProxy:c,_stack:d}=a;if(d.has(s))throw new Error("Recursion detected: "+Array.from(d).join("->")+"->"+s);d.add(s);let f=t(l,c||r);return d.delete(s),Fo(s,f)&&(f=No(n._scopes,n,s,f)),f}function Yf(s,t,a,r){const{_proxy:n,_context:l,_subProxy:c,_descriptors:d}=a;if(typeof l.index<"u"&&r(s))return t[l.index%t.length];if(Ka(t[0])){const f=t,p=n._scopes.filter(h=>h!==f);t=[];for(const h of f){const g=No(p,n,s,h);t.push(fi(g,l,c&&c[s],d))}}return t}function Xc(s,t,a){return qr(s)?s(t,a):s}const Qf=(s,t)=>s===!0?t:typeof s=="string"?Xr(t,s):void 0;function Kf(s,t,a,r,n){for(const l of t){const c=Qf(a,l);if(c){s.add(c);const d=Xc(c._fallback,a,n);if(typeof d<"u"&&d!==a&&d!==r)return d}else if(c===!1&&typeof r<"u"&&a!==r)return null}return!1}function No(s,t,a,r){const n=t._rootScopes,l=Xc(t._fallback,a,r),c=[...s,...n],d=new Set;d.add(r);let f=Sl(d,c,a,l||a,r);return f===null||typeof l<"u"&&l!==a&&(f=Sl(d,c,l,f,r),f===null)?!1:Eo(Array.from(d),[""],n,l,()=>Jf(t,a,r))}function Sl(s,t,a,r,n){for(;a;)a=Kf(s,t,a,r,n);return a}function Jf(s,t,a){const r=s._getTarget();t in r||(r[t]={});const n=r[t];return Ns(n)&&Ka(a)?a:n||{}}function Xf(s,t,a,r){let n;for(const l of t)if(n=Zc(Wf(l,s),a),typeof n<"u")return Fo(s,n)?No(a,r,s,n):n}function Zc(s,t){for(const a of t){if(!a)continue;const r=a[s];if(typeof r<"u")return r}}function kl(s){let t=s._keys;return t||(t=s._keys=Zf(s._scopes)),t}function Zf(s){const t=new Set;for(const a of s)for(const r of Object.keys(a).filter(n=>!n.startsWith("_")))t.add(r);return Array.from(t)}function $o(){return typeof window<"u"&&typeof document<"u"}function Po(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Fn(s,t,a){let r;return typeof s=="string"?(r=parseInt(s,10),s.indexOf("%")!==-1&&(r=r/100*t.parentNode[a])):r=s,r}const Ln=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function ep(s,t){return Ln(s).getPropertyValue(t)}const tp=["top","right","bottom","left"];function Jr(s,t,a){const r={};a=a?"-"+a:"";for(let n=0;n<4;n++){const l=tp[n];r[l]=parseFloat(s[t+"-"+l+a])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const ap=(s,t,a)=>(s>0||t>0)&&(!a||!a.shadowRoot);function sp(s,t){const a=s.touches,r=a&&a.length?a[0]:s,{offsetX:n,offsetY:l}=r;let c=!1,d,f;if(ap(n,l,s.target))d=n,f=l;else{const p=t.getBoundingClientRect();d=r.clientX-p.left,f=r.clientY-p.top,c=!0}return{x:d,y:f,box:c}}function Yr(s,t){if("native"in s)return s;const{canvas:a,currentDevicePixelRatio:r}=t,n=Ln(a),l=n.boxSizing==="border-box",c=Jr(n,"padding"),d=Jr(n,"border","width"),{x:f,y:p,box:h}=sp(s,a),g=c.left+(h&&d.left),b=c.top+(h&&d.top);let{width:y,height:k}=t;return l&&(y-=c.width+d.width,k-=c.height+d.height),{x:Math.round((f-g)/y*a.width/r),y:Math.round((p-b)/k*a.height/r)}}function rp(s,t,a){let r,n;if(t===void 0||a===void 0){const l=s&&Po(s);if(!l)t=s.clientWidth,a=s.clientHeight;else{const c=l.getBoundingClientRect(),d=Ln(l),f=Jr(d,"border","width"),p=Jr(d,"padding");t=c.width-p.width-f.width,a=c.height-p.height-f.height,r=Fn(d.maxWidth,l,"clientWidth"),n=Fn(d.maxHeight,l,"clientHeight")}}return{width:t,height:a,maxWidth:r||Dn,maxHeight:n||Dn}}const Mr=s=>Math.round(s*10)/10;function ip(s,t,a,r){const n=Ln(s),l=Jr(n,"margin"),c=Fn(n.maxWidth,s,"clientWidth")||Dn,d=Fn(n.maxHeight,s,"clientHeight")||Dn,f=rp(s,t,a);let{width:p,height:h}=f;if(n.boxSizing==="content-box"){const b=Jr(n,"border","width"),y=Jr(n,"padding");p-=y.width+b.width,h-=y.height+b.height}return p=Math.max(0,p-l.width),h=Math.max(0,r?p/r:h-l.height),p=Mr(Math.min(p,c,f.maxWidth)),h=Mr(Math.min(h,d,f.maxHeight)),p&&!h&&(h=Mr(p/2)),(t!==void 0||a!==void 0)&&r&&f.height&&h>f.height&&(h=f.height,p=Mr(Math.floor(h*r))),{width:p,height:h}}function Al(s,t,a){const r=t||1,n=Mr(s.height*r),l=Mr(s.width*r);s.height=Mr(s.height),s.width=Mr(s.width);const c=s.canvas;return c.style&&(a||!c.style.height&&!c.style.width)&&(c.style.height=`${s.height}px`,c.style.width=`${s.width}px`),s.currentDevicePixelRatio!==r||c.height!==n||c.width!==l?(s.currentDevicePixelRatio=r,c.height=n,c.width=l,s.ctx.setTransform(r,0,0,r,0,0),!0):!1}const np=(function(){let s=!1;try{const t={get passive(){return s=!0,!1}};$o()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s})();function Dl(s,t){const a=ep(s,t),r=a&&a.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const op=function(s,t){return{x(a){return s+s+t-a},setWidth(a){t=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,r){return a-r},leftForLtr(a,r){return a-r}}},lp=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function vi(s,t,a){return s?op(t,a):lp()}function ed(s,t){let a,r;(t==="ltr"||t==="rtl")&&(a=s.canvas.style,r=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",t,"important"),s.prevTextDirection=r)}function td(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function un(s,t,a){return s.options.clip?s[a]:t[a]}function cp(s,t){const{xScale:a,yScale:r}=s;return a&&r?{left:un(a,t,"left"),right:un(a,t,"right"),top:un(r,t,"top"),bottom:un(r,t,"bottom")}:t}function dp(s,t){const a=t._clip;if(a.disabled)return!1;const r=cp(t,s.chartArea);return{left:a.left===!1?0:r.left-(a.left===!0?0:a.left),right:a.right===!1?s.width:r.right+(a.right===!0?0:a.right),top:a.top===!1?0:r.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?s.height:r.bottom+(a.bottom===!0?0:a.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class up{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,a,r,n){const l=a.listeners[n],c=a.duration;l.forEach(d=>d({chart:t,initial:a.initial,numSteps:c,currentStep:Math.min(r-a.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=Vc.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let a=0;this._charts.forEach((r,n)=>{if(!r.running||!r.items.length)return;const l=r.items;let c=l.length-1,d=!1,f;for(;c>=0;--c)f=l[c],f._active?(f._total>r.duration&&(r.duration=f._total),f.tick(t),d=!0):(l[c]=l[l.length-1],l.pop());d&&(n.draw(),this._notify(n,r,t,"progress")),l.length||(r.running=!1,this._notify(n,r,t,"complete"),r.initial=!1),a+=l.length}),this._lastDate=t,a===0&&(this._running=!1)}_getAnims(t){const a=this._charts;let r=a.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(t,r)),r}listen(t,a,r){this._getAnims(t).listeners[a].push(r)}add(t,a){!a||!a.length||this._getAnims(t).items.push(...a)}has(t){return this._getAnims(t).items.length>0}start(t){const a=this._charts.get(t);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((r,n)=>Math.max(r,n._duration),0),this._refresh())}running(t){if(!this._running)return!1;const a=this._charts.get(t);return!(!a||!a.running||!a.items.length)}stop(t){const a=this._charts.get(t);if(!a||!a.items.length)return;const r=a.items;let n=r.length-1;for(;n>=0;--n)r[n].cancel();a.items=[],this._notify(t,a,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Ar=new up;const Cl="transparent",vp={boolean(s,t,a){return a>.5?t:s},color(s,t,a){const r=_l(s||Cl),n=r.valid&&_l(t||Cl);return n&&n.valid?n.mix(r,a).hexString():t},number(s,t,a){return s+(t-s)*a}};class fp{constructor(t,a,r,n){const l=a[r];n=dn([t.to,n,l,t.from]);const c=dn([t.from,l,n]);this._active=!0,this._fn=t.fn||vp[t.type||typeof c],this._easing=Oi[t.easing]||Oi.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=a,this._prop=r,this._from=c,this._to=n,this._promises=void 0}active(){return this._active}update(t,a,r){if(this._active){this._notify(!1);const n=this._target[this._prop],l=r-this._start,c=this._duration-l;this._start=r,this._duration=Math.floor(Math.max(c,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=dn([t.to,a,n,t.from]),this._from=dn([t.from,n,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const a=t-this._start,r=this._duration,n=this._prop,l=this._from,c=this._loop,d=this._to;let f;if(this._active=l!==d&&(c||a<r),!this._active){this._target[n]=d,this._notify(!0);return}if(a<0){this._target[n]=l;return}f=a/r%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[n]=this._fn(l,d,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((a,r)=>{t.push({res:a,rej:r})})}_notify(t){const a=t?"res":"rej",r=this._promises||[];for(let n=0;n<r.length;n++)r[n][a]()}}class ad{constructor(t,a){this._chart=t,this._properties=new Map,this.configure(a)}configure(t){if(!Ka(t))return;const a=Object.keys(Ss.animation),r=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{const l=t[n];if(!Ka(l))return;const c={};for(const d of a)c[d]=l[d];(Ns(l.properties)&&l.properties||[n]).forEach(d=>{(d===n||!r.has(d))&&r.set(d,c)})})}_animateOptions(t,a){const r=a.options,n=mp(t,r);if(!n)return[];const l=this._createAnimations(n,r);return r.$shared&&pp(t.options.$animations,r).then(()=>{t.options=r},()=>{}),l}_createAnimations(t,a){const r=this._properties,n=[],l=t.$animations||(t.$animations={}),c=Object.keys(a),d=Date.now();let f;for(f=c.length-1;f>=0;--f){const p=c[f];if(p.charAt(0)==="$")continue;if(p==="options"){n.push(...this._animateOptions(t,a));continue}const h=a[p];let g=l[p];const b=r.get(p);if(g)if(b&&g.active()){g.update(b,h,d);continue}else g.cancel();if(!b||!b.duration){t[p]=h;continue}l[p]=g=new fp(b,t,p,h),n.push(g)}return n}update(t,a){if(this._properties.size===0){Object.assign(t,a);return}const r=this._createAnimations(t,a);if(r.length)return Ar.add(this._chart,r),!0}}function pp(s,t){const a=[],r=Object.keys(t);for(let n=0;n<r.length;n++){const l=s[r[n]];l&&l.active()&&a.push(l.wait())}return Promise.all(a)}function mp(s,t){if(!t)return;let a=s.options;if(!a){s.options=t;return}return a.$shared&&(s.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function Tl(s,t){const a=s&&s.options||{},r=a.reverse,n=a.min===void 0?t:0,l=a.max===void 0?t:0;return{start:r?l:n,end:r?n:l}}function hp(s,t,a){if(a===!1)return!1;const r=Tl(s,a),n=Tl(t,a);return{top:n.end,right:r.end,bottom:n.start,left:r.start}}function gp(s){let t,a,r,n;return Ka(s)?(t=s.top,a=s.right,r=s.bottom,n=s.left):t=a=r=n=s,{top:t,right:a,bottom:r,left:n,disabled:s===!1}}function sd(s,t){const a=[],r=s._getSortedDatasetMetas(t);let n,l;for(n=0,l=r.length;n<l;++n)a.push(r[n].index);return a}function El(s,t,a,r={}){const n=s.keys,l=r.mode==="single";let c,d,f,p;if(t===null)return;let h=!1;for(c=0,d=n.length;c<d;++c){if(f=+n[c],f===a){if(h=!0,r.all)continue;break}p=s.values[f],dr(p)&&(l||t===0||Or(t)===Or(p))&&(t+=p)}return!h&&!r.all?0:t}function _p(s,t){const{iScale:a,vScale:r}=t,n=a.axis==="x"?"x":"y",l=r.axis==="x"?"x":"y",c=Object.keys(s),d=new Array(c.length);let f,p,h;for(f=0,p=c.length;f<p;++f)h=c[f],d[f]={[n]:h,[l]:s[h]};return d}function eo(s,t){const a=s&&s.options.stacked;return a||a===void 0&&t.stack!==void 0}function bp(s,t,a){return`${s.id}.${t.id}.${a.stack||a.type}`}function yp(s){const{min:t,max:a,minDefined:r,maxDefined:n}=s.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:n?a:Number.POSITIVE_INFINITY}}function wp(s,t,a){const r=s[t]||(s[t]={});return r[a]||(r[a]={})}function Fl(s,t,a,r){for(const n of t.getMatchingVisibleMetas(r).reverse()){const l=s[n.index];if(a&&l>0||!a&&l<0)return n.index}return null}function Nl(s,t){const{chart:a,_cachedMeta:r}=s,n=a._stacks||(a._stacks={}),{iScale:l,vScale:c,index:d}=r,f=l.axis,p=c.axis,h=bp(l,c,r),g=t.length;let b;for(let y=0;y<g;++y){const k=t[y],{[f]:A,[p]:T}=k,C=k._stacks||(k._stacks={});b=C[p]=wp(n,h,A),b[d]=T,b._top=Fl(b,c,!0,r.type),b._bottom=Fl(b,c,!1,r.type);const D=b._visualValues||(b._visualValues={});D[d]=T}}function to(s,t){const a=s.scales;return Object.keys(a).filter(r=>a[r].axis===t).shift()}function xp(s,t){return pi(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Sp(s,t,a){return pi(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:a,index:t,mode:"default",type:"data"})}function Ai(s,t){const a=s.controller.index,r=s.vScale&&s.vScale.axis;if(r){t=t||s._parsed;for(const n of t){const l=n._stacks;if(!l||l[r]===void 0||l[r][a]===void 0)return;delete l[r][a],l[r]._visualValues!==void 0&&l[r]._visualValues[a]!==void 0&&delete l[r]._visualValues[a]}}}const ao=s=>s==="reset"||s==="none",$l=(s,t)=>t?s:Object.assign({},s),kp=(s,t,a)=>s&&!t.hidden&&t._stacked&&{keys:sd(a,!0),values:null};class Lo{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,a){this.chart=t,this._ctx=t.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=eo(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ai(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,a=this._cachedMeta,r=this.getDataset(),n=(g,b,y,k)=>g==="x"?b:g==="r"?k:y,l=a.xAxisID=Qa(r.xAxisID,to(t,"x")),c=a.yAxisID=Qa(r.yAxisID,to(t,"y")),d=a.rAxisID=Qa(r.rAxisID,to(t,"r")),f=a.indexAxis,p=a.iAxisID=n(f,l,c,d),h=a.vAxisID=n(f,c,l,d);a.xScale=this.getScaleForId(l),a.yScale=this.getScaleForId(c),a.rScale=this.getScaleForId(d),a.iScale=this.getScaleForId(p),a.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const a=this._cachedMeta;return t===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&ml(this._data,this),t._stacked&&Ai(t)}_dataCheck(){const t=this.getDataset(),a=t.data||(t.data=[]),r=this._data;if(Ka(a)){const n=this._cachedMeta;this._data=_p(a,n)}else if(r!==a){if(r){ml(r,this);const n=this._cachedMeta;Ai(n),n._parsed=[]}a&&Object.isExtensible(a)&&kf(a,this),this._syncList=[],this._data=a}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const a=this._cachedMeta,r=this.getDataset();let n=!1;this._dataCheck();const l=a._stacked;a._stacked=eo(a.vScale,a),a.stack!==r.stack&&(n=!0,Ai(a),a.stack=r.stack),this._resyncElements(t),(n||l!==a._stacked)&&(Nl(this,a._parsed),a._stacked=eo(a.vScale,a))}configure(){const t=this.chart.config,a=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),a,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,a){const{_cachedMeta:r,_data:n}=this,{iScale:l,_stacked:c}=r,d=l.axis;let f=t===0&&a===n.length?!0:r._sorted,p=t>0&&r._parsed[t-1],h,g,b;if(this._parsing===!1)r._parsed=n,r._sorted=!0,b=n;else{Ns(n[t])?b=this.parseArrayData(r,n,t,a):Ka(n[t])?b=this.parseObjectData(r,n,t,a):b=this.parsePrimitiveData(r,n,t,a);const y=()=>g[d]===null||p&&g[d]<p[d];for(h=0;h<a;++h)r._parsed[h+t]=g=b[h],f&&(y()&&(f=!1),p=g);r._sorted=f}c&&Nl(this,b)}parsePrimitiveData(t,a,r,n){const{iScale:l,vScale:c}=t,d=l.axis,f=c.axis,p=l.getLabels(),h=l===c,g=new Array(n);let b,y,k;for(b=0,y=n;b<y;++b)k=b+r,g[b]={[d]:h||l.parse(p[k],k),[f]:c.parse(a[k],k)};return g}parseArrayData(t,a,r,n){const{xScale:l,yScale:c}=t,d=new Array(n);let f,p,h,g;for(f=0,p=n;f<p;++f)h=f+r,g=a[h],d[f]={x:l.parse(g[0],h),y:c.parse(g[1],h)};return d}parseObjectData(t,a,r,n){const{xScale:l,yScale:c}=t,{xAxisKey:d="x",yAxisKey:f="y"}=this._parsing,p=new Array(n);let h,g,b,y;for(h=0,g=n;h<g;++h)b=h+r,y=a[b],p[h]={x:l.parse(Xr(y,d),b),y:c.parse(Xr(y,f),b)};return p}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,a,r){const n=this.chart,l=this._cachedMeta,c=a[t.axis],d={keys:sd(n,!0),values:a._stacks[t.axis]._visualValues};return El(d,c,l.index,{mode:r})}updateRangeFromParsed(t,a,r,n){const l=r[a.axis];let c=l===null?NaN:l;const d=n&&r._stacks[a.axis];n&&d&&(n.values=d,c=El(n,l,this._cachedMeta.index)),t.min=Math.min(t.min,c),t.max=Math.max(t.max,c)}getMinMax(t,a){const r=this._cachedMeta,n=r._parsed,l=r._sorted&&t===r.iScale,c=n.length,d=this._getOtherScale(t),f=kp(a,r,this.chart),p={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:g}=yp(d);let b,y;function k(){y=n[b];const A=y[d.axis];return!dr(y[t.axis])||h>A||g<A}for(b=0;b<c&&!(!k()&&(this.updateRangeFromParsed(p,t,y,f),l));++b);if(l){for(b=c-1;b>=0;--b)if(!k()){this.updateRangeFromParsed(p,t,y,f);break}}return p}getAllParsedValues(t){const a=this._cachedMeta._parsed,r=[];let n,l,c;for(n=0,l=a.length;n<l;++n)c=a[n][t.axis],dr(c)&&r.push(c);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const a=this._cachedMeta,r=a.iScale,n=a.vScale,l=this.getParsed(t);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:n?""+n.getLabelForValue(l[n.axis]):""}}_update(t){const a=this._cachedMeta;this.update(t||"default"),a._clip=gp(Qa(this.options.clip,hp(a.xScale,a.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,a=this.chart,r=this._cachedMeta,n=r.data||[],l=a.chartArea,c=[],d=this._drawStart||0,f=this._drawCount||n.length-d,p=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(t,l,d,f),h=d;h<d+f;++h){const g=n[h];g.hidden||(g.active&&p?c.push(g):g.draw(t,l))}for(h=0;h<c.length;++h)c[h].draw(t,l)}getStyle(t,a){const r=a?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,a,r){const n=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const c=this._cachedMeta.data[t];l=c.$context||(c.$context=Sp(this.getContext(),t,c)),l.parsed=this.getParsed(t),l.raw=n.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=xp(this.chart.getContext(),this.index)),l.dataset=n,l.index=l.datasetIndex=this.index;return l.active=!!a,l.mode=r,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,a){return this._resolveElementOptions(this.dataElementType.id,a,t)}_resolveElementOptions(t,a="default",r){const n=a==="active",l=this._cachedDataOpts,c=t+"-"+a,d=l[c],f=this.enableOptionSharing&&Gi(r);if(d)return $l(d,f);const p=this.chart.config,h=p.datasetElementScopeKeys(this._type,t),g=n?[`${t}Hover`,"hover",t,""]:[t,""],b=p.getOptionScopes(this.getDataset(),h),y=Object.keys(Ss.elements[t]),k=()=>this.getContext(r,n,a),A=p.resolveNamedOptions(b,y,k,g);return A.$shared&&(A.$shared=f,l[c]=Object.freeze($l(A,f))),A}_resolveAnimations(t,a,r){const n=this.chart,l=this._cachedDataOpts,c=`animation-${a}`,d=l[c];if(d)return d;let f;if(n.options.animation!==!1){const h=this.chart.config,g=h.datasetAnimationScopeKeys(this._type,a),b=h.getOptionScopes(this.getDataset(),g);f=h.createResolver(b,this.getContext(t,r,a))}const p=new ad(n,f&&f.animations);return f&&f._cacheable&&(l[c]=Object.freeze(p)),p}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,a){return!a||ao(t)||this.chart._animationsDisabled}_getSharedOptions(t,a){const r=this.resolveDataElementOptions(t,a),n=this._sharedOptions,l=this.getSharedOptions(r),c=this.includeOptions(a,l)||l!==n;return this.updateSharedOptions(l,a,r),{sharedOptions:l,includeOptions:c}}updateElement(t,a,r,n){ao(n)?Object.assign(t,r):this._resolveAnimations(a,n).update(t,r)}updateSharedOptions(t,a,r){t&&!ao(a)&&this._resolveAnimations(void 0,a).update(t,r)}_setStyle(t,a,r,n){t.active=n;const l=this.getStyle(a,n);this._resolveAnimations(a,r,n).update(t,{options:!n&&this.getSharedOptions(l)||l})}removeHoverStyle(t,a,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,a,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const a=this._data,r=this._cachedMeta.data;for(const[d,f,p]of this._syncList)this[d](f,p);this._syncList=[];const n=r.length,l=a.length,c=Math.min(l,n);c&&this.parse(0,c),l>n?this._insertElements(n,l-n,t):l<n&&this._removeElements(l,n-l)}_insertElements(t,a,r=!0){const n=this._cachedMeta,l=n.data,c=t+a;let d;const f=p=>{for(p.length+=a,d=p.length-1;d>=c;d--)p[d]=p[d-a]};for(f(l),d=t;d<c;++d)l[d]=new this.dataElementType;this._parsing&&f(n._parsed),this.parse(t,a),r&&this.updateElements(l,t,a,"reset")}updateElements(t,a,r,n){}_removeElements(t,a){const r=this._cachedMeta;if(this._parsing){const n=r._parsed.splice(t,a);r._stacked&&Ai(r,n)}r.data.splice(t,a)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[a,r,n]=t;this[a](r,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,a){a&&this._sync(["_removeElements",t,a]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Ap(s,t){if(!s._cache.$bar){const a=s.getMatchingVisibleMetas(t);let r=[];for(let n=0,l=a.length;n<l;n++)r=r.concat(a[n].controller.getAllParsedValues(s));s._cache.$bar=Gc(r.sort((n,l)=>n-l))}return s._cache.$bar}function Dp(s){const t=s.iScale,a=Ap(t,s.type);let r=t._length,n,l,c,d;const f=()=>{c===32767||c===-32768||(Gi(d)&&(r=Math.min(r,Math.abs(c-d)||r)),d=c)};for(n=0,l=a.length;n<l;++n)c=t.getPixelForValue(a[n]),f();for(d=void 0,n=0,l=t.ticks.length;n<l;++n)c=t.getPixelForTick(n),f();return r}function Cp(s,t,a,r){const n=a.barThickness;let l,c;return ls(n)?(l=t.min*a.categoryPercentage,c=a.barPercentage):(l=n*r,c=1),{chunk:l/r,ratio:c,start:t.pixels[s]-l/2}}function Tp(s,t,a,r){const n=t.pixels,l=n[s];let c=s>0?n[s-1]:null,d=s<n.length-1?n[s+1]:null;const f=a.categoryPercentage;c===null&&(c=l-(d===null?t.end-t.start:d-l)),d===null&&(d=l+l-c);const p=l-(l-Math.min(c,d))/2*f;return{chunk:Math.abs(d-c)/2*f/r,ratio:a.barPercentage,start:p}}function Ep(s,t,a,r){const n=a.parse(s[0],r),l=a.parse(s[1],r),c=Math.min(n,l),d=Math.max(n,l);let f=c,p=d;Math.abs(c)>Math.abs(d)&&(f=d,p=c),t[a.axis]=p,t._custom={barStart:f,barEnd:p,start:n,end:l,min:c,max:d}}function rd(s,t,a,r){return Ns(s)?Ep(s,t,a,r):t[a.axis]=a.parse(s,r),t}function Pl(s,t,a,r){const n=s.iScale,l=s.vScale,c=n.getLabels(),d=n===l,f=[];let p,h,g,b;for(p=a,h=a+r;p<h;++p)b=t[p],g={},g[n.axis]=d||n.parse(c[p],p),f.push(rd(b,g,l,p));return f}function so(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function Fp(s,t,a){return s!==0?Or(s):(t.isHorizontal()?1:-1)*(t.min>=a?1:-1)}function Np(s){let t,a,r,n,l;return s.horizontal?(t=s.base>s.x,a="left",r="right"):(t=s.base<s.y,a="bottom",r="top"),t?(n="end",l="start"):(n="start",l="end"),{start:a,end:r,reverse:t,top:n,bottom:l}}function $p(s,t,a,r){let n=t.borderSkipped;const l={};if(!n){s.borderSkipped=l;return}if(n===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:d,reverse:f,top:p,bottom:h}=Np(s);n==="middle"&&a&&(s.enableBorderRadius=!0,(a._top||0)===r?n=p:(a._bottom||0)===r?n=h:(l[Ll(h,c,d,f)]=!0,n=p)),l[Ll(n,c,d,f)]=!0,s.borderSkipped=l}function Ll(s,t,a,r){return r?(s=Pp(s,t,a),s=Ml(s,a,t)):s=Ml(s,t,a),s}function Pp(s,t,a){return s===t?a:s===a?t:s}function Ml(s,t,a){return s==="start"?t:s==="end"?a:s}function Lp(s,{inflateAmount:t},a){s.inflateAmount=t==="auto"?a===1?.33:0:t}class Mn extends Lo{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,a,r,n){return Pl(t,a,r,n)}parseArrayData(t,a,r,n){return Pl(t,a,r,n)}parseObjectData(t,a,r,n){const{iScale:l,vScale:c}=t,{xAxisKey:d="x",yAxisKey:f="y"}=this._parsing,p=l.axis==="x"?d:f,h=c.axis==="x"?d:f,g=[];let b,y,k,A;for(b=r,y=r+n;b<y;++b)A=a[b],k={},k[l.axis]=l.parse(Xr(A,p),b),g.push(rd(Xr(A,h),k,c,b));return g}updateRangeFromParsed(t,a,r,n){super.updateRangeFromParsed(t,a,r,n);const l=r._custom;l&&a===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const a=this._cachedMeta,{iScale:r,vScale:n}=a,l=this.getParsed(t),c=l._custom,d=so(c)?"["+c.start+", "+c.end+"]":""+n.getLabelForValue(l[n.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:d}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,t)}updateElements(t,a,r,n){const l=n==="reset",{index:c,_cachedMeta:{vScale:d}}=this,f=d.getBasePixel(),p=d.isHorizontal(),h=this._getRuler(),{sharedOptions:g,includeOptions:b}=this._getSharedOptions(a,n);for(let y=a;y<a+r;y++){const k=this.getParsed(y),A=l||ls(k[d.axis])?{base:f,head:f}:this._calculateBarValuePixels(y),T=this._calculateBarIndexPixels(y,h),C=(k._stacks||{})[d.axis],D={horizontal:p,base:A.base,enableBorderRadius:!C||so(k._custom)||c===C._top||c===C._bottom,x:p?A.head:T.center,y:p?T.center:A.head,height:p?T.size:Math.abs(A.size),width:p?Math.abs(A.size):T.size};b&&(D.options=g||this.resolveDataElementOptions(y,t[y].active?"active":n));const S=D.options||t[y].options;$p(D,S,C,c),Lp(D,S,h.ratio),this.updateElement(t[y],y,D,n)}}_getStacks(t,a){const{iScale:r}=this._cachedMeta,n=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),l=r.options.stacked,c=[],d=this._cachedMeta.controller.getParsed(a),f=d&&d[r.axis],p=h=>{const g=h._parsed.find(y=>y[r.axis]===f),b=g&&g[h.vScale.axis];if(ls(b)||isNaN(b))return!0};for(const h of n)if(!(a!==void 0&&p(h))&&((l===!1||c.indexOf(h.stack)===-1||l===void 0&&h.stack===void 0)&&c.push(h.stack),h.index===t))break;return c.length||c.push(void 0),c}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(t).filter(r=>t[r].axis===a).shift()}_getAxis(){const t={},a=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)t[Qa(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,a)]=!0;return Object.keys(t)}_getStackIndex(t,a,r){const n=this._getStacks(t,r),l=a!==void 0?n.indexOf(a):-1;return l===-1?n.length-1:l}_getRuler(){const t=this.options,a=this._cachedMeta,r=a.iScale,n=[];let l,c;for(l=0,c=a.data.length;l<c;++l)n.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const d=t.barThickness;return{min:d||Dp(a),pixels:n,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:t.grouped,ratio:d?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:a,_stacked:r,index:n},options:{base:l,minBarLength:c}}=this,d=l||0,f=this.getParsed(t),p=f._custom,h=so(p);let g=f[a.axis],b=0,y=r?this.applyStack(a,f,r):g,k,A;y!==g&&(b=y-g,y=g),h&&(g=p.barStart,y=p.barEnd-p.barStart,g!==0&&Or(g)!==Or(p.barEnd)&&(b=0),b+=g);const T=!ls(l)&&!h?l:b;let C=a.getPixelForValue(T);if(this.chart.getDataVisibility(t)?k=a.getPixelForValue(b+y):k=C,A=k-C,Math.abs(A)<c){A=Fp(A,a,d)*c,g===d&&(C-=A/2);const D=a.getPixelForDecimal(0),S=a.getPixelForDecimal(1),L=Math.min(D,S),F=Math.max(D,S);C=Math.max(Math.min(C,F),L),k=C+A,r&&!h&&(f._stacks[a.axis]._visualValues[n]=a.getValueForPixel(k)-a.getValueForPixel(C))}if(C===a.getPixelForValue(d)){const D=Or(A)*a.getLineWidthForValue(d)/2;C+=D,A-=D}return{size:A,base:C,head:k,center:k+A/2}}_calculateBarIndexPixels(t,a){const r=a.scale,n=this.options,l=n.skipNull,c=Qa(n.maxBarThickness,1/0);let d,f;const p=this._getAxisCount();if(a.grouped){const h=l?this._getStackCount(t):a.stackCount,g=n.barThickness==="flex"?Tp(t,a,n,h*p):Cp(t,a,n,h*p),b=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,y=this._getAxis().indexOf(Qa(b,this.getFirstScaleIdForIndexAxis())),k=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0)+y;d=g.start+g.chunk*k+g.chunk/2,f=Math.min(c,g.chunk*g.ratio)}else d=r.getPixelForValue(this.getParsed(t)[r.axis],t),f=Math.min(c,a.min*a.ratio);return{base:d-f/2,head:d+f/2,center:d,size:f}}draw(){const t=this._cachedMeta,a=t.vScale,r=t.data,n=r.length;let l=0;for(;l<n;++l)this.getParsed(l)[a.axis]!==null&&!r[l].hidden&&r[l].draw(this._ctx)}}function Mp(s,t,a){let r=1,n=1,l=0,c=0;if(t<Ts){const d=s,f=d+t,p=Math.cos(d),h=Math.sin(d),g=Math.cos(f),b=Math.sin(f),y=(S,L,F)=>Tn(S,d,f,!0)?1:Math.max(L,L*a,F,F*a),k=(S,L,F)=>Tn(S,d,f,!0)?-1:Math.min(L,L*a,F,F*a),A=y(0,p,g),T=y($s,h,b),C=k(os,p,g),D=k(os+$s,h,b);r=(A-C)/2,n=(T-D)/2,l=-(A+C)/2,c=-(T+D)/2}return{ratioX:r,ratioY:n,offsetX:l,offsetY:c}}class Ip extends Lo{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const a=t.data,{labels:{pointStyle:r,textAlign:n,color:l,useBorderRadius:c,borderRadius:d}}=t.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((f,p)=>{const g=t.getDatasetMeta(0).controller.getStyle(p);return{text:f,fillStyle:g.backgroundColor,fontColor:l,hidden:!t.getDataVisibility(p),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:n,pointStyle:r,borderRadius:c&&(d||g.borderRadius),index:p}}):[]}},onClick(t,a,r){r.chart.toggleDataVisibility(a.index),r.chart.update()}}}};constructor(t,a){super(t,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,a){const r=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=r;else{let l=f=>+r[f];if(Ka(r[t])){const{key:f="value"}=this._parsing;l=p=>+Xr(r[p],f)}let c,d;for(c=t,d=t+a;c<d;++c)n._parsed[c]=l(c)}}_getRotation(){return Er(this.options.rotation-90)}_getCircumference(){return Er(this.options.circumference)}_getRotationExtents(){let t=Ts,a=-Ts;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const n=this.chart.getDatasetMeta(r).controller,l=n._getRotation(),c=n._getCircumference();t=Math.min(t,l),a=Math.max(a,l+c)}return{rotation:t,circumference:a-t}}update(t){const a=this.chart,{chartArea:r}=a,n=this._cachedMeta,l=n.data,c=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,d=Math.max((Math.min(r.width,r.height)-c)/2,0),f=Math.min(lf(this.options.cutout,d),1),p=this._getRingWeight(this.index),{circumference:h,rotation:g}=this._getRotationExtents(),{ratioX:b,ratioY:y,offsetX:k,offsetY:A}=Mp(g,h,f),T=(r.width-c)/b,C=(r.height-c)/y,D=Math.max(Math.min(T,C)/2,0),S=Rc(this.options.radius,D),L=Math.max(S*f,0),F=(S-L)/this._getVisibleDatasetWeightTotal();this.offsetX=k*S,this.offsetY=A*S,n.total=this.calculateTotal(),this.outerRadius=S-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*p,0),this.updateElements(l,0,l.length,t)}_circumference(t,a){const r=this.options,n=this._cachedMeta,l=this._getCircumference();return a&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||n._parsed[t]===null||n.data[t].hidden?0:this.calculateCircumference(n._parsed[t]*l/Ts)}updateElements(t,a,r,n){const l=n==="reset",c=this.chart,d=c.chartArea,p=c.options.animation,h=(d.left+d.right)/2,g=(d.top+d.bottom)/2,b=l&&p.animateScale,y=b?0:this.innerRadius,k=b?0:this.outerRadius,{sharedOptions:A,includeOptions:T}=this._getSharedOptions(a,n);let C=this._getRotation(),D;for(D=0;D<a;++D)C+=this._circumference(D,l);for(D=a;D<a+r;++D){const S=this._circumference(D,l),L=t[D],F={x:h+this.offsetX,y:g+this.offsetY,startAngle:C,endAngle:C+S,circumference:S,outerRadius:k,innerRadius:y};T&&(F.options=A||this.resolveDataElementOptions(D,L.active?"active":n)),C+=S,this.updateElement(L,D,F,n)}}calculateTotal(){const t=this._cachedMeta,a=t.data;let r=0,n;for(n=0;n<a.length;n++){const l=t._parsed[n];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(n)&&!a[n].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(t){const a=this._cachedMeta.total;return a>0&&!isNaN(t)?Ts*(Math.abs(t)/a):0}getLabelAndValue(t){const a=this._cachedMeta,r=this.chart,n=r.data.labels||[],l=Ao(a._parsed[t],r.options.locale);return{label:n[t]||"",value:l}}getMaxBorderWidth(t){let a=0;const r=this.chart;let n,l,c,d,f;if(!t){for(n=0,l=r.data.datasets.length;n<l;++n)if(r.isDatasetVisible(n)){c=r.getDatasetMeta(n),t=c.data,d=c.controller;break}}if(!t)return 0;for(n=0,l=t.length;n<l;++n)f=d.resolveDataElementOptions(n),f.borderAlign!=="inner"&&(a=Math.max(a,f.borderWidth||0,f.hoverBorderWidth||0));return a}getMaxOffset(t){let a=0;for(let r=0,n=t.length;r<n;++r){const l=this.resolveDataElementOptions(r);a=Math.max(a,l.offset||0,l.hoverOffset||0)}return a}_getRingWeightOffset(t){let a=0;for(let r=0;r<t;++r)this.chart.isDatasetVisible(r)&&(a+=this._getRingWeight(r));return a}_getRingWeight(t){return Math.max(Qa(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}function Hr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Mo{static override(t){Object.assign(Mo.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Hr()}parse(){return Hr()}format(){return Hr()}add(){return Hr()}diff(){return Hr()}startOf(){return Hr()}endOf(){return Hr()}}var Rp={_date:Mo};function Op(s,t,a,r){const{controller:n,data:l,_sorted:c}=s,d=n._cachedMeta.iScale,f=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(d&&t===d.axis&&t!=="r"&&c&&l.length){const p=d._reversePixels?xf:po;if(r){if(n._sharedOptions){const h=l[0],g=typeof h.getRange=="function"&&h.getRange(t);if(g){const b=p(l,t,a-g),y=p(l,t,a+g);return{lo:b.lo,hi:y.hi}}}}else{const h=p(l,t,a);if(f){const{vScale:g}=n._cachedMeta,{_parsed:b}=s,y=b.slice(0,h.lo+1).reverse().findIndex(A=>!ls(A[g.axis]));h.lo-=Math.max(0,y);const k=b.slice(h.hi).findIndex(A=>!ls(A[g.axis]));h.hi+=Math.max(0,k)}return h}}return{lo:0,hi:l.length-1}}function In(s,t,a,r,n){const l=s.getSortedVisibleDatasetMetas(),c=a[t];for(let d=0,f=l.length;d<f;++d){const{index:p,data:h}=l[d],{lo:g,hi:b}=Op(l[d],t,c,n);for(let y=g;y<=b;++y){const k=h[y];k.skip||r(k,p,y)}}}function jp(s){const t=s.indexOf("x")!==-1,a=s.indexOf("y")!==-1;return function(r,n){const l=t?Math.abs(r.x-n.x):0,c=a?Math.abs(r.y-n.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(c,2))}}function ro(s,t,a,r,n){const l=[];return!n&&!s.isPointInArea(t)||In(s,a,t,function(d,f,p){!n&&!Yc(d,s.chartArea,0)||d.inRange(t.x,t.y,r)&&l.push({element:d,datasetIndex:f,index:p})},!0),l}function qp(s,t,a,r){let n=[];function l(c,d,f){const{startAngle:p,endAngle:h}=c.getProps(["startAngle","endAngle"],r),{angle:g}=qc(c,{x:t.x,y:t.y});Tn(g,p,h)&&n.push({element:c,datasetIndex:d,index:f})}return In(s,a,t,l),n}function zp(s,t,a,r,n,l){let c=[];const d=jp(a);let f=Number.POSITIVE_INFINITY;function p(h,g,b){const y=h.inRange(t.x,t.y,n);if(r&&!y)return;const k=h.getCenterPoint(n);if(!(!!l||s.isPointInArea(k))&&!y)return;const T=d(t,k);T<f?(c=[{element:h,datasetIndex:g,index:b}],f=T):T===f&&c.push({element:h,datasetIndex:g,index:b})}return In(s,a,t,p),c}function io(s,t,a,r,n,l){return!l&&!s.isPointInArea(t)?[]:a==="r"&&!r?qp(s,t,a,n):zp(s,t,a,r,n,l)}function Il(s,t,a,r,n){const l=[],c=a==="x"?"inXRange":"inYRange";let d=!1;return In(s,a,t,(f,p,h)=>{f[c]&&f[c](t[a],n)&&(l.push({element:f,datasetIndex:p,index:h}),d=d||f.inRange(t.x,t.y,n))}),r&&!d?[]:l}var Gp={modes:{index(s,t,a,r){const n=Yr(t,s),l=a.axis||"x",c=a.includeInvisible||!1,d=a.intersect?ro(s,n,l,r,c):io(s,n,l,!1,r,c),f=[];return d.length?(s.getSortedVisibleDatasetMetas().forEach(p=>{const h=d[0].index,g=p.data[h];g&&!g.skip&&f.push({element:g,datasetIndex:p.index,index:h})}),f):[]},dataset(s,t,a,r){const n=Yr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;let d=a.intersect?ro(s,n,l,r,c):io(s,n,l,!1,r,c);if(d.length>0){const f=d[0].datasetIndex,p=s.getDatasetMeta(f).data;d=[];for(let h=0;h<p.length;++h)d.push({element:p[h],datasetIndex:f,index:h})}return d},point(s,t,a,r){const n=Yr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return ro(s,n,l,r,c)},nearest(s,t,a,r){const n=Yr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return io(s,n,l,a.intersect,r,c)},x(s,t,a,r){const n=Yr(t,s);return Il(s,n,"x",a.intersect,r)},y(s,t,a,r){const n=Yr(t,s);return Il(s,n,"y",a.intersect,r)}}};const id=["left","top","right","bottom"];function Di(s,t){return s.filter(a=>a.pos===t)}function Rl(s,t){return s.filter(a=>id.indexOf(a.pos)===-1&&a.box.axis===t)}function Ci(s,t){return s.sort((a,r)=>{const n=t?r:a,l=t?a:r;return n.weight===l.weight?n.index-l.index:n.weight-l.weight})}function Vp(s){const t=[];let a,r,n,l,c,d;for(a=0,r=(s||[]).length;a<r;++a)n=s[a],{position:l,options:{stack:c,stackWeight:d=1}}=n,t.push({index:a,box:n,pos:l,horizontal:n.isHorizontal(),weight:n.weight,stack:c&&l+c,stackWeight:d});return t}function Bp(s){const t={};for(const a of s){const{stack:r,pos:n,stackWeight:l}=a;if(!r||!id.includes(n))continue;const c=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=l}return t}function Wp(s,t){const a=Bp(s),{vBoxMaxWidth:r,hBoxMaxHeight:n}=t;let l,c,d;for(l=0,c=s.length;l<c;++l){d=s[l];const{fullSize:f}=d.box,p=a[d.stack],h=p&&d.stackWeight/p.weight;d.horizontal?(d.width=h?h*r:f&&t.availableWidth,d.height=n):(d.width=r,d.height=h?h*n:f&&t.availableHeight)}return a}function Hp(s){const t=Vp(s),a=Ci(t.filter(p=>p.box.fullSize),!0),r=Ci(Di(t,"left"),!0),n=Ci(Di(t,"right")),l=Ci(Di(t,"top"),!0),c=Ci(Di(t,"bottom")),d=Rl(t,"x"),f=Rl(t,"y");return{fullSize:a,leftAndTop:r.concat(l),rightAndBottom:n.concat(f).concat(c).concat(d),chartArea:Di(t,"chartArea"),vertical:r.concat(n).concat(f),horizontal:l.concat(c).concat(d)}}function Ol(s,t,a,r){return Math.max(s[a],t[a])+Math.max(s[r],t[r])}function nd(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function Up(s,t,a,r){const{pos:n,box:l}=a,c=s.maxPadding;if(!Ka(n)){a.size&&(s[n]-=a.size);const g=r[a.stack]||{size:0,count:1};g.size=Math.max(g.size,a.horizontal?l.height:l.width),a.size=g.size/g.count,s[n]+=a.size}l.getPadding&&nd(c,l.getPadding());const d=Math.max(0,t.outerWidth-Ol(c,s,"left","right")),f=Math.max(0,t.outerHeight-Ol(c,s,"top","bottom")),p=d!==s.w,h=f!==s.h;return s.w=d,s.h=f,a.horizontal?{same:p,other:h}:{same:h,other:p}}function Yp(s){const t=s.maxPadding;function a(r){const n=Math.max(t[r]-s[r],0);return s[r]+=n,n}s.y+=a("top"),s.x+=a("left"),a("right"),a("bottom")}function Qp(s,t){const a=t.maxPadding;function r(n){const l={left:0,top:0,right:0,bottom:0};return n.forEach(c=>{l[c]=Math.max(t[c],a[c])}),l}return r(s?["left","right"]:["top","bottom"])}function Li(s,t,a,r){const n=[];let l,c,d,f,p,h;for(l=0,c=s.length,p=0;l<c;++l){d=s[l],f=d.box,f.update(d.width||t.w,d.height||t.h,Qp(d.horizontal,t));const{same:g,other:b}=Up(t,a,d,r);p|=g&&n.length,h=h||b,f.fullSize||n.push(d)}return p&&Li(n,t,a,r)||h}function vn(s,t,a,r,n){s.top=a,s.left=t,s.right=t+r,s.bottom=a+n,s.width=r,s.height=n}function jl(s,t,a,r){const n=a.padding;let{x:l,y:c}=t;for(const d of s){const f=d.box,p=r[d.stack]||{placed:0,weight:1},h=d.stackWeight/p.weight||1;if(d.horizontal){const g=t.w*h,b=p.size||f.height;Gi(p.start)&&(c=p.start),f.fullSize?vn(f,n.left,c,a.outerWidth-n.right-n.left,b):vn(f,t.left+p.placed,c,g,b),p.start=c,p.placed+=g,c=f.bottom}else{const g=t.h*h,b=p.size||f.width;Gi(p.start)&&(l=p.start),f.fullSize?vn(f,l,n.top,b,a.outerHeight-n.bottom-n.top):vn(f,l,t.top+p.placed,b,g),p.start=l,p.placed+=g,l=f.right}}t.x=l,t.y=c}var lr={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(a){t.draw(a)}}]},s.boxes.push(t)},removeBox(s,t){const a=s.boxes?s.boxes.indexOf(t):-1;a!==-1&&s.boxes.splice(a,1)},configure(s,t,a){t.fullSize=a.fullSize,t.position=a.position,t.weight=a.weight},update(s,t,a,r){if(!s)return;const n=ur(s.options.layout.padding),l=Math.max(t-n.width,0),c=Math.max(a-n.height,0),d=Hp(s.boxes),f=d.vertical,p=d.horizontal;as(s.boxes,A=>{typeof A.beforeLayout=="function"&&A.beforeLayout()});const h=f.reduce((A,T)=>T.box.options&&T.box.options.display===!1?A:A+1,0)||1,g=Object.freeze({outerWidth:t,outerHeight:a,padding:n,availableWidth:l,availableHeight:c,vBoxMaxWidth:l/2/h,hBoxMaxHeight:c/2}),b=Object.assign({},n);nd(b,ur(r));const y=Object.assign({maxPadding:b,w:l,h:c,x:n.left,y:n.top},n),k=Wp(f.concat(p),g);Li(d.fullSize,y,g,k),Li(f,y,g,k),Li(p,y,g,k)&&Li(f,y,g,k),Yp(y),jl(d.leftAndTop,y,g,k),y.x+=y.w,y.y+=y.h,jl(d.rightAndBottom,y,g,k),s.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},as(d.chartArea,A=>{const T=A.box;Object.assign(T,s.chartArea),T.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class od{acquireContext(t,a){}releaseContext(t){return!1}addEventListener(t,a,r){}removeEventListener(t,a,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,a,r,n){return a=Math.max(0,a||t.width),r=r||t.height,{width:a,height:Math.max(0,n?Math.floor(a/n):r)}}isAttached(t){return!0}updateConfig(t){}}class Kp extends od{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const bn="$chartjs",Jp={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ql=s=>s===null||s==="";function Xp(s,t){const a=s.style,r=s.getAttribute("height"),n=s.getAttribute("width");if(s[bn]={initial:{height:r,width:n,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",ql(n)){const l=Dl(s,"width");l!==void 0&&(s.width=l)}if(ql(r))if(s.style.height==="")s.height=s.width/(t||2);else{const l=Dl(s,"height");l!==void 0&&(s.height=l)}return s}const ld=np?{passive:!0}:!1;function Zp(s,t,a){s&&s.addEventListener(t,a,ld)}function em(s,t,a){s&&s.canvas&&s.canvas.removeEventListener(t,a,ld)}function tm(s,t){const a=Jp[s.type]||s.type,{x:r,y:n}=Yr(s,t);return{type:a,chart:t,native:s,x:r!==void 0?r:null,y:n!==void 0?n:null}}function Nn(s,t){for(const a of s)if(a===t||a.contains(t))return!0}function am(s,t,a){const r=s.canvas,n=new MutationObserver(l=>{let c=!1;for(const d of l)c=c||Nn(d.addedNodes,r),c=c&&!Nn(d.removedNodes,r);c&&a()});return n.observe(document,{childList:!0,subtree:!0}),n}function sm(s,t,a){const r=s.canvas,n=new MutationObserver(l=>{let c=!1;for(const d of l)c=c||Nn(d.removedNodes,r),c=c&&!Nn(d.addedNodes,r);c&&a()});return n.observe(document,{childList:!0,subtree:!0}),n}const Bi=new Map;let zl=0;function cd(){const s=window.devicePixelRatio;s!==zl&&(zl=s,Bi.forEach((t,a)=>{a.currentDevicePixelRatio!==s&&t()}))}function rm(s,t){Bi.size||window.addEventListener("resize",cd),Bi.set(s,t)}function im(s){Bi.delete(s),Bi.size||window.removeEventListener("resize",cd)}function nm(s,t,a){const r=s.canvas,n=r&&Po(r);if(!n)return;const l=Bc((d,f)=>{const p=n.clientWidth;a(d,f),p<n.clientWidth&&a()},window),c=new ResizeObserver(d=>{const f=d[0],p=f.contentRect.width,h=f.contentRect.height;p===0&&h===0||l(p,h)});return c.observe(n),rm(s,l),c}function no(s,t,a){a&&a.disconnect(),t==="resize"&&im(s)}function om(s,t,a){const r=s.canvas,n=Bc(l=>{s.ctx!==null&&a(tm(l,s))},s);return Zp(r,t,n),n}class lm extends od{acquireContext(t,a){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(Xp(t,a),r):null}releaseContext(t){const a=t.canvas;if(!a[bn])return!1;const r=a[bn].initial;["height","width"].forEach(l=>{const c=r[l];ls(c)?a.removeAttribute(l):a.setAttribute(l,c)});const n=r.style||{};return Object.keys(n).forEach(l=>{a.style[l]=n[l]}),a.width=a.width,delete a[bn],!0}addEventListener(t,a,r){this.removeEventListener(t,a);const n=t.$proxies||(t.$proxies={}),c={attach:am,detach:sm,resize:nm}[a]||om;n[a]=c(t,a,r)}removeEventListener(t,a){const r=t.$proxies||(t.$proxies={}),n=r[a];if(!n)return;({attach:no,detach:no,resize:no}[a]||em)(t,a,n),r[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,a,r,n){return ip(t,a,r,n)}isAttached(t){const a=t&&Po(t);return!!(a&&a.isConnected)}}function cm(s){return!$o()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?Kp:lm}class ti{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:a,y:r}=this.getProps(["x","y"],t);return{x:a,y:r}}hasValue(){return Cn(this.x)&&Cn(this.y)}getProps(t,a){const r=this.$animations;if(!a||!r)return this;const n={};return t.forEach(l=>{n[l]=r[l]&&r[l].active()?r[l]._to:this[l]}),n}}function dm(s,t){const a=s.options.ticks,r=um(s),n=Math.min(a.maxTicksLimit||r,r),l=a.major.enabled?fm(t):[],c=l.length,d=l[0],f=l[c-1],p=[];if(c>n)return pm(t,p,l,c/n),p;const h=vm(l,t,n);if(c>0){let g,b;const y=c>1?Math.round((f-d)/(c-1)):null;for(fn(t,p,h,ls(y)?0:d-y,d),g=0,b=c-1;g<b;g++)fn(t,p,h,l[g],l[g+1]);return fn(t,p,h,f,ls(y)?t.length:f+y),p}return fn(t,p,h),p}function um(s){const t=s.options.offset,a=s._tickSize(),r=s._length/a+(t?0:1),n=s._maxLength/a;return Math.floor(Math.min(r,n))}function vm(s,t,a){const r=mm(s),n=t.length/a;if(!r)return Math.max(n,1);const l=mf(r);for(let c=0,d=l.length-1;c<d;c++){const f=l[c];if(f>n)return f}return Math.max(n,1)}function fm(s){const t=[];let a,r;for(a=0,r=s.length;a<r;a++)s[a].major&&t.push(a);return t}function pm(s,t,a,r){let n=0,l=a[0],c;for(r=Math.ceil(r),c=0;c<s.length;c++)c===l&&(t.push(s[c]),n++,l=a[n*r])}function fn(s,t,a,r,n){const l=Qa(r,0),c=Math.min(Qa(n,s.length),s.length);let d=0,f,p,h;for(a=Math.ceil(a),n&&(f=n-r,a=f/Math.floor(f/a)),h=l;h<0;)d++,h=Math.round(l+d*a);for(p=Math.max(l,0);p<c;p++)p===h&&(t.push(s[p]),d++,h=Math.round(l+d*a))}function mm(s){const t=s.length;let a,r;if(t<2)return!1;for(r=s[0],a=1;a<t;++a)if(s[a]-s[a-1]!==r)return!1;return r}const hm=s=>s==="left"?"right":s==="right"?"left":s,Gl=(s,t,a)=>t==="top"||t==="left"?s[t]+a:s[t]-a,Vl=(s,t)=>Math.min(t||s,s);function Bl(s,t){const a=[],r=s.length/t,n=s.length;let l=0;for(;l<n;l+=r)a.push(s[Math.floor(l)]);return a}function gm(s,t,a){const r=s.ticks.length,n=Math.min(t,r-1),l=s._startPixel,c=s._endPixel,d=1e-6;let f=s.getPixelForTick(n),p;if(!(a&&(r===1?p=Math.max(f-l,c-f):t===0?p=(s.getPixelForTick(1)-f)/2:p=(f-s.getPixelForTick(n-1))/2,f+=n<t?p:-p,f<l-d||f>c+d)))return f}function _m(s,t){as(s,a=>{const r=a.gc,n=r.length/2;let l;if(n>t){for(l=0;l<n;++l)delete a.data[r[l]];r.splice(0,n)}})}function Ti(s){return s.drawTicks?s.tickLength:0}function Wl(s,t){if(!s.display)return 0;const a=zs(s.font,t),r=ur(s.padding);return(Ns(s.text)?s.text.length:1)*a.lineHeight+r.height}function bm(s,t){return pi(s,{scale:t,type:"scale"})}function ym(s,t,a){return pi(s,{tick:a,index:t,type:"tick"})}function wm(s,t,a){let r=ko(s);return(a&&t!=="right"||!a&&t==="right")&&(r=hm(r)),r}function xm(s,t,a,r){const{top:n,left:l,bottom:c,right:d,chart:f}=s,{chartArea:p,scales:h}=f;let g=0,b,y,k;const A=c-n,T=d-l;if(s.isHorizontal()){if(y=qs(r,l,d),Ka(a)){const C=Object.keys(a)[0],D=a[C];k=h[C].getPixelForValue(D)+A-t}else a==="center"?k=(p.bottom+p.top)/2+A-t:k=Gl(s,a,t);b=d-l}else{if(Ka(a)){const C=Object.keys(a)[0],D=a[C];y=h[C].getPixelForValue(D)-T+t}else a==="center"?y=(p.left+p.right)/2-T+t:y=Gl(s,a,t);k=qs(r,c,n),g=a==="left"?-$s:$s}return{titleX:y,titleY:k,maxWidth:b,rotation:g}}class mi extends ti{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,a){return t}getUserBounds(){let{_userMin:t,_userMax:a,_suggestedMin:r,_suggestedMax:n}=this;return t=hr(t,Number.POSITIVE_INFINITY),a=hr(a,Number.NEGATIVE_INFINITY),r=hr(r,Number.POSITIVE_INFINITY),n=hr(n,Number.NEGATIVE_INFINITY),{min:hr(t,r),max:hr(a,n),minDefined:dr(t),maxDefined:dr(a)}}getMinMax(t){let{min:a,max:r,minDefined:n,maxDefined:l}=this.getUserBounds(),c;if(n&&l)return{min:a,max:r};const d=this.getMatchingVisibleMetas();for(let f=0,p=d.length;f<p;++f)c=d[f].controller.getMinMax(this,t),n||(a=Math.min(a,c.min)),l||(r=Math.max(r,c.max));return a=l&&a>r?r:a,r=n&&a>r?a:r,{min:hr(a,hr(r,a)),max:hr(r,hr(a,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ps(this.options.beforeUpdate,[this])}update(t,a,r){const{beginAtZero:n,grace:l,ticks:c}=this.options,d=c.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=a,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Bf(this,l,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=d<this.ticks.length;this._convertTicksToLabels(f?Bl(this.ticks,d):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=dm(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,a,r;this.isHorizontal()?(a=this.left,r=this.right):(a=this.top,r=this.bottom,t=!t),this._startPixel=a,this._endPixel=r,this._reversePixels=t,this._length=r-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ps(this.options.afterUpdate,[this])}beforeSetDimensions(){ps(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ps(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ps(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ps(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const a=this.options.ticks;let r,n,l;for(r=0,n=t.length;r<n;r++)l=t[r],l.label=ps(a.callback,[l.value,r,t],this)}afterTickToLabelConversion(){ps(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ps(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,a=t.ticks,r=Vl(this.ticks.length,t.ticks.maxTicksLimit),n=a.minRotation||0,l=a.maxRotation;let c=n,d,f,p;if(!this._isVisible()||!a.display||n>=l||r<=1||!this.isHorizontal()){this.labelRotation=n;return}const h=this._getLabelSizes(),g=h.widest.width,b=h.highest.height,y=Js(this.chart.width-g,0,this.maxWidth);d=t.offset?this.maxWidth/r:y/(r-1),g+6>d&&(d=y/(r-(t.offset?.5:1)),f=this.maxHeight-Ti(t.grid)-a.padding-Wl(t.title,this.chart.options.font),p=Math.sqrt(g*g+b*b),c=bf(Math.min(Math.asin(Js((h.highest.height+6)/d,-1,1)),Math.asin(Js(f/p,-1,1))-Math.asin(Js(b/p,-1,1)))),c=Math.max(n,Math.min(l,c))),this.labelRotation=c}afterCalculateLabelRotation(){ps(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ps(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:a,options:{ticks:r,title:n,grid:l}}=this,c=this._isVisible(),d=this.isHorizontal();if(c){const f=Wl(n,a.options.font);if(d?(t.width=this.maxWidth,t.height=Ti(l)+f):(t.height=this.maxHeight,t.width=Ti(l)+f),r.display&&this.ticks.length){const{first:p,last:h,widest:g,highest:b}=this._getLabelSizes(),y=r.padding*2,k=Er(this.labelRotation),A=Math.cos(k),T=Math.sin(k);if(d){const C=r.mirror?0:T*g.width+A*b.height;t.height=Math.min(this.maxHeight,t.height+C+y)}else{const C=r.mirror?0:A*g.width+T*b.height;t.width=Math.min(this.maxWidth,t.width+C+y)}this._calculatePadding(p,h,T,A)}}this._handleMargins(),d?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,a,r,n){const{ticks:{align:l,padding:c},position:d}=this.options,f=this.labelRotation!==0,p=d!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let b=0,y=0;f?p?(b=n*t.width,y=r*a.height):(b=r*t.height,y=n*a.width):l==="start"?y=a.width:l==="end"?b=t.width:l!=="inner"&&(b=t.width/2,y=a.width/2),this.paddingLeft=Math.max((b-h+c)*this.width/(this.width-h),0),this.paddingRight=Math.max((y-g+c)*this.width/(this.width-g),0)}else{let h=a.height/2,g=t.height/2;l==="start"?(h=0,g=t.height):l==="end"&&(h=a.height,g=0),this.paddingTop=h+c,this.paddingBottom=g+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ps(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:a}=this.options;return a==="top"||a==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let a,r;for(a=0,r=t.length;a<r;a++)ls(t[a].label)&&(t.splice(a,1),r--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const a=this.options.ticks.sampleSize;let r=this.ticks;a<r.length&&(r=Bl(r,a)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,a,r){const{ctx:n,_longestTextCache:l}=this,c=[],d=[],f=Math.floor(a/Vl(a,r));let p=0,h=0,g,b,y,k,A,T,C,D,S,L,F;for(g=0;g<a;g+=f){if(k=t[g].label,A=this._resolveTickFontOptions(g),n.font=T=A.string,C=l[T]=l[T]||{data:{},gc:[]},D=A.lineHeight,S=L=0,!ls(k)&&!Ns(k))S=yl(n,C.data,C.gc,S,k),L=D;else if(Ns(k))for(b=0,y=k.length;b<y;++b)F=k[b],!ls(F)&&!Ns(F)&&(S=yl(n,C.data,C.gc,S,F),L+=D);c.push(S),d.push(L),p=Math.max(S,p),h=Math.max(L,h)}_m(l,a);const j=c.indexOf(p),P=d.indexOf(h),Q=W=>({width:c[W]||0,height:d[W]||0});return{first:Q(0),last:Q(a-1),widest:Q(j),highest:Q(P),widths:c,heights:d}}getLabelForValue(t){return t}getPixelForValue(t,a){return NaN}getValueForPixel(t){}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const a=this._startPixel+t*this._length;return wf(this._alignToPixels?Wr(this.chart,a,0):a)}getDecimalForPixel(t){const a=(t-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:a}=this;return t<0&&a<0?a:t>0&&a>0?t:0}getContext(t){const a=this.ticks||[];if(t>=0&&t<a.length){const r=a[t];return r.$context||(r.$context=ym(this.getContext(),t,r))}return this.$context||(this.$context=bm(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,a=Er(this.labelRotation),r=Math.abs(Math.cos(a)),n=Math.abs(Math.sin(a)),l=this._getLabelSizes(),c=t.autoSkipPadding||0,d=l?l.widest.width+c:0,f=l?l.highest.height+c:0;return this.isHorizontal()?f*r>d*n?d/r:f/n:f*n<d*r?f/r:d/n}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const a=this.axis,r=this.chart,n=this.options,{grid:l,position:c,border:d}=n,f=l.offset,p=this.isHorizontal(),g=this.ticks.length+(f?1:0),b=Ti(l),y=[],k=d.setContext(this.getContext()),A=k.display?k.width:0,T=A/2,C=function(me){return Wr(r,me,A)};let D,S,L,F,j,P,Q,W,$,R,X,se;if(c==="top")D=C(this.bottom),P=this.bottom-b,W=D-T,R=C(t.top)+T,se=t.bottom;else if(c==="bottom")D=C(this.top),R=t.top,se=C(t.bottom)-T,P=D+T,W=this.top+b;else if(c==="left")D=C(this.right),j=this.right-b,Q=D-T,$=C(t.left)+T,X=t.right;else if(c==="right")D=C(this.left),$=t.left,X=C(t.right)-T,j=D+T,Q=this.left+b;else if(a==="x"){if(c==="center")D=C((t.top+t.bottom)/2+.5);else if(Ka(c)){const me=Object.keys(c)[0],je=c[me];D=C(this.chart.scales[me].getPixelForValue(je))}R=t.top,se=t.bottom,P=D+T,W=P+b}else if(a==="y"){if(c==="center")D=C((t.left+t.right)/2);else if(Ka(c)){const me=Object.keys(c)[0],je=c[me];D=C(this.chart.scales[me].getPixelForValue(je))}j=D-T,Q=j-b,$=t.left,X=t.right}const V=Qa(n.ticks.maxTicksLimit,g),re=Math.max(1,Math.ceil(g/V));for(S=0;S<g;S+=re){const me=this.getContext(S),je=l.setContext(me),de=d.setContext(me),ie=je.lineWidth,Pe=je.color,Ve=de.dash||[],Ze=de.dashOffset,ve=je.tickWidth,Ce=je.tickColor,Qe=je.tickBorderDash||[],Xe=je.tickBorderDashOffset;L=gm(this,S,f),L!==void 0&&(F=Wr(r,L,ie),p?j=Q=$=X=F:P=W=R=se=F,y.push({tx1:j,ty1:P,tx2:Q,ty2:W,x1:$,y1:R,x2:X,y2:se,width:ie,color:Pe,borderDash:Ve,borderDashOffset:Ze,tickWidth:ve,tickColor:Ce,tickBorderDash:Qe,tickBorderDashOffset:Xe}))}return this._ticksLength=g,this._borderValue=D,y}_computeLabelItems(t){const a=this.axis,r=this.options,{position:n,ticks:l}=r,c=this.isHorizontal(),d=this.ticks,{align:f,crossAlign:p,padding:h,mirror:g}=l,b=Ti(r.grid),y=b+h,k=g?-h:y,A=-Er(this.labelRotation),T=[];let C,D,S,L,F,j,P,Q,W,$,R,X,se="middle";if(n==="top")j=this.bottom-k,P=this._getXAxisLabelAlignment();else if(n==="bottom")j=this.top+k,P=this._getXAxisLabelAlignment();else if(n==="left"){const re=this._getYAxisLabelAlignment(b);P=re.textAlign,F=re.x}else if(n==="right"){const re=this._getYAxisLabelAlignment(b);P=re.textAlign,F=re.x}else if(a==="x"){if(n==="center")j=(t.top+t.bottom)/2+y;else if(Ka(n)){const re=Object.keys(n)[0],me=n[re];j=this.chart.scales[re].getPixelForValue(me)+y}P=this._getXAxisLabelAlignment()}else if(a==="y"){if(n==="center")F=(t.left+t.right)/2-y;else if(Ka(n)){const re=Object.keys(n)[0],me=n[re];F=this.chart.scales[re].getPixelForValue(me)}P=this._getYAxisLabelAlignment(b).textAlign}a==="y"&&(f==="start"?se="top":f==="end"&&(se="bottom"));const V=this._getLabelSizes();for(C=0,D=d.length;C<D;++C){S=d[C],L=S.label;const re=l.setContext(this.getContext(C));Q=this.getPixelForTick(C)+l.labelOffset,W=this._resolveTickFontOptions(C),$=W.lineHeight,R=Ns(L)?L.length:1;const me=R/2,je=re.color,de=re.textStrokeColor,ie=re.textStrokeWidth;let Pe=P;c?(F=Q,P==="inner"&&(C===D-1?Pe=this.options.reverse?"left":"right":C===0?Pe=this.options.reverse?"right":"left":Pe="center"),n==="top"?p==="near"||A!==0?X=-R*$+$/2:p==="center"?X=-V.highest.height/2-me*$+$:X=-V.highest.height+$/2:p==="near"||A!==0?X=$/2:p==="center"?X=V.highest.height/2-me*$:X=V.highest.height-R*$,g&&(X*=-1),A!==0&&!re.showLabelBackdrop&&(F+=$/2*Math.sin(A))):(j=Q,X=(1-R)*$/2);let Ve;if(re.showLabelBackdrop){const Ze=ur(re.backdropPadding),ve=V.heights[C],Ce=V.widths[C];let Qe=X-Ze.top,Xe=0-Ze.left;switch(se){case"middle":Qe-=ve/2;break;case"bottom":Qe-=ve;break}switch(P){case"center":Xe-=Ce/2;break;case"right":Xe-=Ce;break;case"inner":C===D-1?Xe-=Ce:C>0&&(Xe-=Ce/2);break}Ve={left:Xe,top:Qe,width:Ce+Ze.width,height:ve+Ze.height,color:re.backdropColor}}T.push({label:L,font:W,textOffset:X,options:{rotation:A,color:je,strokeColor:de,strokeWidth:ie,textAlign:Pe,textBaseline:se,translation:[F,j],backdrop:Ve}})}return T}_getXAxisLabelAlignment(){const{position:t,ticks:a}=this.options;if(-Er(this.labelRotation))return t==="top"?"left":"right";let n="center";return a.align==="start"?n="left":a.align==="end"?n="right":a.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:a,ticks:{crossAlign:r,mirror:n,padding:l}}=this.options,c=this._getLabelSizes(),d=t+l,f=c.widest.width;let p,h;return a==="left"?n?(h=this.right+l,r==="near"?p="left":r==="center"?(p="center",h+=f/2):(p="right",h+=f)):(h=this.right-d,r==="near"?p="right":r==="center"?(p="center",h-=f/2):(p="left",h=this.left)):a==="right"?n?(h=this.left+l,r==="near"?p="right":r==="center"?(p="center",h-=f/2):(p="left",h-=f)):(h=this.left+d,r==="near"?p="left":r==="center"?(p="center",h+=f/2):(p="right",h=this.right)):p="right",{textAlign:p,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:a},left:r,top:n,width:l,height:c}=this;a&&(t.save(),t.fillStyle=a,t.fillRect(r,n,l,c),t.restore())}getLineWidthForValue(t){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const n=this.ticks.findIndex(l=>l.value===t);return n>=0?a.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const a=this.options.grid,r=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,c;const d=(f,p,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(f.x,f.y),r.lineTo(p.x,p.y),r.stroke(),r.restore())};if(a.display)for(l=0,c=n.length;l<c;++l){const f=n[l];a.drawOnChartArea&&d({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),a.drawTicks&&d({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:a,options:{border:r,grid:n}}=this,l=r.setContext(this.getContext()),c=r.display?l.width:0;if(!c)return;const d=n.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let p,h,g,b;this.isHorizontal()?(p=Wr(t,this.left,c)-c/2,h=Wr(t,this.right,d)+d/2,g=b=f):(g=Wr(t,this.top,c)-c/2,b=Wr(t,this.bottom,d)+d/2,p=h=f),a.save(),a.lineWidth=l.width,a.strokeStyle=l.color,a.beginPath(),a.moveTo(p,g),a.lineTo(h,b),a.stroke(),a.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,n=this._computeLabelArea();n&&Do(r,n);const l=this.getLabelItems(t);for(const c of l){const d=c.options,f=c.font,p=c.label,h=c.textOffset;Vi(r,p,0,h,f,d)}n&&Co(r)}drawTitle(){const{ctx:t,options:{position:a,title:r,reverse:n}}=this;if(!r.display)return;const l=zs(r.font),c=ur(r.padding),d=r.align;let f=l.lineHeight/2;a==="bottom"||a==="center"||Ka(a)?(f+=c.bottom,Ns(r.text)&&(f+=l.lineHeight*(r.text.length-1))):f+=c.top;const{titleX:p,titleY:h,maxWidth:g,rotation:b}=xm(this,f,a,d);Vi(t,r.text,0,0,l,{color:r.color,maxWidth:g,rotation:b,textAlign:wm(d,a,n),textBaseline:"middle",translation:[p,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,a=t.ticks&&t.ticks.z||0,r=Qa(t.grid&&t.grid.z,-1),n=Qa(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==mi.prototype.draw?[{z:a,draw:l=>{this.draw(l)}}]:[{z:r,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:a,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const a=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",n=[];let l,c;for(l=0,c=a.length;l<c;++l){const d=a[l];d[r]===this.id&&(!t||d.type===t)&&n.push(d)}return n}_resolveTickFontOptions(t){const a=this.options.ticks.setContext(this.getContext(t));return zs(a.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class pn{constructor(t,a,r){this.type=t,this.scope=a,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const a=Object.getPrototypeOf(t);let r;Am(a)&&(r=this.register(a));const n=this.items,l=t.id,c=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in n||(n[l]=t,Sm(t,c,r),this.override&&Ss.override(t.id,t.overrides)),c}get(t){return this.items[t]}unregister(t){const a=this.items,r=t.id,n=this.scope;r in a&&delete a[r],n&&r in Ss[n]&&(delete Ss[n][r],this.override&&delete Zr[r])}}function Sm(s,t,a){const r=zi(Object.create(null),[a?Ss.get(a):{},Ss.get(t),s.defaults]);Ss.set(t,r),s.defaultRoutes&&km(t,s.defaultRoutes),s.descriptors&&Ss.describe(t,s.descriptors)}function km(s,t){Object.keys(t).forEach(a=>{const r=a.split("."),n=r.pop(),l=[s].concat(r).join("."),c=t[a].split("."),d=c.pop(),f=c.join(".");Ss.route(l,n,f,d)})}function Am(s){return"id"in s&&"defaults"in s}class Dm{constructor(){this.controllers=new pn(Lo,"datasets",!0),this.elements=new pn(ti,"elements"),this.plugins=new pn(Object,"plugins"),this.scales=new pn(mi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,a,r){[...a].forEach(n=>{const l=r||this._getRegistryForType(n);r||l.isForType(n)||l===this.plugins&&n.id?this._exec(t,l,n):as(n,c=>{const d=r||this._getRegistryForType(c);this._exec(t,d,c)})})}_exec(t,a,r){const n=xo(t);ps(r["before"+n],[],r),a[t](r),ps(r["after"+n],[],r)}_getRegistryForType(t){for(let a=0;a<this._typedRegistries.length;a++){const r=this._typedRegistries[a];if(r.isForType(t))return r}return this.plugins}_get(t,a,r){const n=a.get(t);if(n===void 0)throw new Error('"'+t+'" is not a registered '+r+".");return n}}var xr=new Dm;class Cm{constructor(){this._init=void 0}notify(t,a,r,n){if(a==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const l=n?this._descriptors(t).filter(n):this._descriptors(t),c=this._notify(l,t,a,r);return a==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),c}_notify(t,a,r,n){n=n||{};for(const l of t){const c=l.plugin,d=c[r],f=[a,n,l.options];if(ps(d,f,c)===!1&&n.cancelable)return!1}return!0}invalidate(){ls(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),a}_createDescriptors(t,a){const r=t&&t.config,n=Qa(r.options&&r.options.plugins,{}),l=Tm(r);return n===!1&&!a?[]:Fm(t,l,n,a)}_notifyStateChanges(t){const a=this._oldCache||[],r=this._cache,n=(l,c)=>l.filter(d=>!c.some(f=>d.plugin.id===f.plugin.id));this._notify(n(a,r),t,"stop"),this._notify(n(r,a),t,"start")}}function Tm(s){const t={},a=[],r=Object.keys(xr.plugins.items);for(let l=0;l<r.length;l++)a.push(xr.getPlugin(r[l]));const n=s.plugins||[];for(let l=0;l<n.length;l++){const c=n[l];a.indexOf(c)===-1&&(a.push(c),t[c.id]=!0)}return{plugins:a,localIds:t}}function Em(s,t){return!t&&s===!1?null:s===!0?{}:s}function Fm(s,{plugins:t,localIds:a},r,n){const l=[],c=s.getContext();for(const d of t){const f=d.id,p=Em(r[f],n);p!==null&&l.push({plugin:d,options:Nm(s.config,{plugin:d,local:a[f]},p,c)})}return l}function Nm(s,{plugin:t,local:a},r,n){const l=s.pluginScopeKeys(t),c=s.getOptionScopes(r,l);return a&&t.defaults&&c.push(t.defaults),s.createResolver(c,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ho(s,t){const a=Ss.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||a.indexAxis||"x"}function $m(s,t){let a=s;return s==="_index_"?a=t:s==="_value_"&&(a=t==="x"?"y":"x"),a}function Pm(s,t){return s===t?"_index_":"_value_"}function Hl(s){if(s==="x"||s==="y"||s==="r")return s}function Lm(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function go(s,...t){if(Hl(s))return s;for(const a of t){const r=a.axis||Lm(a.position)||s.length>1&&Hl(s[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function Ul(s,t,a){if(a[t+"AxisID"]===s)return{axis:t}}function Mm(s,t){if(t.data&&t.data.datasets){const a=t.data.datasets.filter(r=>r.xAxisID===s||r.yAxisID===s);if(a.length)return Ul(s,"x",a[0])||Ul(s,"y",a[0])}return{}}function Im(s,t){const a=Zr[s.type]||{scales:{}},r=t.scales||{},n=ho(s.type,t),l=Object.create(null);return Object.keys(r).forEach(c=>{const d=r[c];if(!Ka(d))return console.error(`Invalid scale configuration for scale: ${c}`);if(d._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=go(c,d,Mm(c,s),Ss.scales[d.type]),p=Pm(f,n),h=a.scales||{};l[c]=Ri(Object.create(null),[{axis:f},d,h[f],h[p]])}),s.data.datasets.forEach(c=>{const d=c.type||s.type,f=c.indexAxis||ho(d,t),h=(Zr[d]||{}).scales||{};Object.keys(h).forEach(g=>{const b=$m(g,f),y=c[b+"AxisID"]||b;l[y]=l[y]||Object.create(null),Ri(l[y],[{axis:b},r[y],h[g]])})}),Object.keys(l).forEach(c=>{const d=l[c];Ri(d,[Ss.scales[d.type],Ss.scale])}),l}function dd(s){const t=s.options||(s.options={});t.plugins=Qa(t.plugins,{}),t.scales=Im(s,t)}function ud(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function Rm(s){return s=s||{},s.data=ud(s.data),dd(s),s}const Yl=new Map,vd=new Set;function mn(s,t){let a=Yl.get(s);return a||(a=t(),Yl.set(s,a),vd.add(a)),a}const Ei=(s,t,a)=>{const r=Xr(t,a);r!==void 0&&s.add(r)};class Om{constructor(t){this._config=Rm(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=ud(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),dd(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return mn(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,a){return mn(`${t}.transition.${a}`,()=>[[`datasets.${t}.transitions.${a}`,`transitions.${a}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,a){return mn(`${t}-${a}`,()=>[[`datasets.${t}.elements.${a}`,`datasets.${t}`,`elements.${a}`,""]])}pluginScopeKeys(t){const a=t.id,r=this.type;return mn(`${r}-plugin-${a}`,()=>[[`plugins.${a}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,a){const r=this._scopeCache;let n=r.get(t);return(!n||a)&&(n=new Map,r.set(t,n)),n}getOptionScopes(t,a,r){const{options:n,type:l}=this,c=this._cachedScopes(t,r),d=c.get(a);if(d)return d;const f=new Set;a.forEach(h=>{t&&(f.add(t),h.forEach(g=>Ei(f,t,g))),h.forEach(g=>Ei(f,n,g)),h.forEach(g=>Ei(f,Zr[l]||{},g)),h.forEach(g=>Ei(f,Ss,g)),h.forEach(g=>Ei(f,mo,g))});const p=Array.from(f);return p.length===0&&p.push(Object.create(null)),vd.has(a)&&c.set(a,p),p}chartOptionScopes(){const{options:t,type:a}=this;return[t,Zr[a]||{},Ss.datasets[a]||{},{type:a},Ss,mo]}resolveNamedOptions(t,a,r,n=[""]){const l={$shared:!0},{resolver:c,subPrefixes:d}=Ql(this._resolverCache,t,n);let f=c;if(qm(c,a)){l.$shared=!1,r=qr(r)?r():r;const p=this.createResolver(t,r,d);f=fi(c,r,p)}for(const p of a)l[p]=f[p];return l}createResolver(t,a,r=[""],n){const{resolver:l}=Ql(this._resolverCache,t,r);return Ka(a)?fi(l,a,void 0,n):l}}function Ql(s,t,a){let r=s.get(t);r||(r=new Map,s.set(t,r));const n=a.join();let l=r.get(n);return l||(l={resolver:Eo(t,a),subPrefixes:a.filter(d=>!d.toLowerCase().includes("hover"))},r.set(n,l)),l}const jm=s=>Ka(s)&&Object.getOwnPropertyNames(s).some(t=>qr(s[t]));function qm(s,t){const{isScriptable:a,isIndexable:r}=Kc(s);for(const n of t){const l=a(n),c=r(n),d=(c||l)&&s[n];if(l&&(qr(d)||jm(d))||c&&Ns(d))return!0}return!1}var zm="4.5.1";const Gm=["top","bottom","left","right","chartArea"];function Kl(s,t){return s==="top"||s==="bottom"||Gm.indexOf(s)===-1&&t==="x"}function Jl(s,t){return function(a,r){return a[s]===r[s]?a[t]-r[t]:a[s]-r[s]}}function Xl(s){const t=s.chart,a=t.options.animation;t.notifyPlugins("afterRender"),ps(a&&a.onComplete,[s],t)}function Vm(s){const t=s.chart,a=t.options.animation;ps(a&&a.onProgress,[s],t)}function fd(s){return $o()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const yn={},Zl=s=>{const t=fd(s);return Object.values(yn).filter(a=>a.canvas===t).pop()};function Bm(s,t,a){const r=Object.keys(s);for(const n of r){const l=+n;if(l>=t){const c=s[n];delete s[n],(a>0||l>t)&&(s[l+a]=c)}}}function Wm(s,t,a,r){return!a||s.type==="mouseout"?null:r?t:s}class cr{static defaults=Ss;static instances=yn;static overrides=Zr;static registry=xr;static version=zm;static getChart=Zl;static register(...t){xr.add(...t),ec()}static unregister(...t){xr.remove(...t),ec()}constructor(t,a){const r=this.config=new Om(a),n=fd(t),l=Zl(n);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const c=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||cm(n)),this.platform.updateConfig(r);const d=this.platform.acquireContext(n,c.aspectRatio),f=d&&d.canvas,p=f&&f.height,h=f&&f.width;if(this.id=of(),this.ctx=d,this.canvas=f,this.width=h,this.height=p,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Cm,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Af(g=>this.update(g),c.resizeDelay||0),this._dataChanges=[],yn[this.id]=this,!d||!f){console.error("Failed to create chart: can't acquire context from the given item");return}Ar.listen(this,"complete",Xl),Ar.listen(this,"progress",Vm),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:a},width:r,height:n,_aspectRatio:l}=this;return ls(t)?a&&l?l:n?r/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return xr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Al(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return wl(this.canvas,this.ctx),this}stop(){return Ar.stop(this),this}resize(t,a){Ar.running(this)?this._resizeBeforeDraw={width:t,height:a}:this._resize(t,a)}_resize(t,a){const r=this.options,n=this.canvas,l=r.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(n,t,a,l),d=r.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,Al(this,d,!0)&&(this.notifyPlugins("resize",{size:c}),ps(r.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};as(a,(r,n)=>{r.id=n})}buildOrUpdateScales(){const t=this.options,a=t.scales,r=this.scales,n=Object.keys(r).reduce((c,d)=>(c[d]=!1,c),{});let l=[];a&&(l=l.concat(Object.keys(a).map(c=>{const d=a[c],f=go(c,d),p=f==="r",h=f==="x";return{options:d,dposition:p?"chartArea":h?"bottom":"left",dtype:p?"radialLinear":h?"category":"linear"}}))),as(l,c=>{const d=c.options,f=d.id,p=go(f,d),h=Qa(d.type,c.dtype);(d.position===void 0||Kl(d.position,p)!==Kl(c.dposition))&&(d.position=c.dposition),n[f]=!0;let g=null;if(f in r&&r[f].type===h)g=r[f];else{const b=xr.getScale(h);g=new b({id:f,type:h,ctx:this.ctx,chart:this}),r[g.id]=g}g.init(d,t)}),as(n,(c,d)=>{c||delete r[d]}),as(r,c=>{lr.configure(this,c,c.options),lr.addBox(this,c)})}_updateMetasets(){const t=this._metasets,a=this.data.datasets.length,r=t.length;if(t.sort((n,l)=>n.index-l.index),r>a){for(let n=a;n<r;++n)this._destroyDatasetMeta(n);t.splice(a,r-a)}this._sortedMetasets=t.slice(0).sort(Jl("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:a}}=this;t.length>a.length&&delete this._stacks,t.forEach((r,n)=>{a.filter(l=>l===r._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const t=[],a=this.data.datasets;let r,n;for(this._removeUnreferencedMetasets(),r=0,n=a.length;r<n;r++){const l=a[r];let c=this.getDatasetMeta(r);const d=l.type||this.config.type;if(c.type&&c.type!==d&&(this._destroyDatasetMeta(r),c=this.getDatasetMeta(r)),c.type=d,c.indexAxis=l.indexAxis||ho(d,this.options),c.order=l.order||0,c.index=r,c.label=""+l.label,c.visible=this.isDatasetVisible(r),c.controller)c.controller.updateIndex(r),c.controller.linkScales();else{const f=xr.getController(d),{datasetElementType:p,dataElementType:h}=Ss.datasets[d];Object.assign(f,{dataElementType:xr.getElement(h),datasetElementType:p&&xr.getElement(p)}),c.controller=new f(this,r),t.push(c.controller)}}return this._updateMetasets(),t}_resetElements(){as(this.data.datasets,(t,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const a=this.config;a.update();const r=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let p=0,h=this.data.datasets.length;p<h;p++){const{controller:g}=this.getDatasetMeta(p),b=!n&&l.indexOf(g)===-1;g.buildOrUpdateElements(b),c=Math.max(+g.getMaxOverflow(),c)}c=this._minPadding=r.layout.autoPadding?c:0,this._updateLayout(c),n||as(l,p=>{p.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Jl("z","_idx"));const{_active:d,_lastEvent:f}=this;f?this._eventHandler(f,!0):d.length&&this._updateHoverStyles(d,d,!0),this.render()}_updateScales(){as(this.scales,t=>{lr.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,a=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!ul(a,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,a=this._getUniformDataChanges()||[];for(const{method:r,start:n,count:l}of a){const c=r==="_removeElements"?-l:l;Bm(t,n,c)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const a=this.data.datasets.length,r=l=>new Set(t.filter(c=>c[0]===l).map((c,d)=>d+","+c.splice(1).join(","))),n=r(0);for(let l=1;l<a;l++)if(!ul(n,r(l)))return;return Array.from(n).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;lr.update(this,this.width,this.height,t);const a=this.chartArea,r=a.width<=0||a.height<=0;this._layers=[],as(this.boxes,n=>{r&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,l)=>{n._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let a=0,r=this.data.datasets.length;a<r;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,r=this.data.datasets.length;a<r;++a)this._updateDataset(a,qr(t)?t({datasetIndex:a}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,a){const r=this.getDatasetMeta(t),n={meta:r,index:t,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(r.controller._update(a),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ar.has(this)?this.attached&&!Ar.running(this)&&Ar.start(this):(this.draw(),Xl({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:r,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(t=0;t<a.length&&a[t].z<=0;++t)a[t].draw(this.chartArea);for(this._drawDatasets();t<a.length;++t)a[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const a=this._sortedMetasets,r=[];let n,l;for(n=0,l=a.length;n<l;++n){const c=a[n];(!t||c.visible)&&r.push(c)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let a=t.length-1;a>=0;--a)this._drawDataset(t[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const a=this.ctx,r={meta:t,index:t.index,cancelable:!0},n=dp(this,t);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(n&&Do(a,n),t.controller.draw(),n&&Co(a),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return Yc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,a,r,n){const l=Gp.modes[a];return typeof l=="function"?l(this,t,r,n):[]}getDatasetMeta(t){const a=this.data.datasets[t],r=this._metasets;let n=r.filter(l=>l&&l._dataset===a).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:t,_dataset:a,_parsed:[],_sorted:!1},r.push(n)),n}getContext(){return this.$context||(this.$context=pi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const a=this.data.datasets[t];if(!a)return!1;const r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!a.hidden}setDatasetVisibility(t,a){const r=this.getDatasetMeta(t);r.hidden=!a}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,a,r){const n=r?"show":"hide",l=this.getDatasetMeta(t),c=l.controller._resolveAnimations(void 0,n);Gi(a)?(l.data[a].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),c.update(l,{visible:r}),this.update(d=>d.datasetIndex===t?n:void 0))}hide(t,a){this._updateVisibility(t,a,!1)}show(t,a){this._updateVisibility(t,a,!0)}_destroyDatasetMeta(t){const a=this._metasets[t];a&&a.controller&&a.controller._destroy(),delete this._metasets[t]}_stop(){let t,a;for(this.stop(),Ar.remove(this),t=0,a=this.data.datasets.length;t<a;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:a}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),wl(t,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete yn[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,a=this.platform,r=(l,c)=>{a.addEventListener(this,l,c),t[l]=c},n=(l,c,d)=>{l.offsetX=c,l.offsetY=d,this._eventHandler(l)};as(this.options.events,l=>r(l,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,a=this.platform,r=(f,p)=>{a.addEventListener(this,f,p),t[f]=p},n=(f,p)=>{t[f]&&(a.removeEventListener(this,f,p),delete t[f])},l=(f,p)=>{this.canvas&&this.resize(f,p)};let c;const d=()=>{n("attach",d),this.attached=!0,this.resize(),r("resize",l),r("detach",c)};c=()=>{this.attached=!1,n("resize",l),this._stop(),this._resize(0,0),r("attach",d)},a.isAttached(this.canvas)?d():c()}unbindEvents(){as(this._listeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._listeners={},as(this._responsiveListeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,a,r){const n=r?"set":"remove";let l,c,d,f;for(a==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+n+"DatasetHoverStyle"]()),d=0,f=t.length;d<f;++d){c=t[d];const p=c&&this.getDatasetMeta(c.datasetIndex).controller;p&&p[n+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const a=this._active||[],r=t.map(({datasetIndex:l,index:c})=>{const d=this.getDatasetMeta(l);if(!d)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:d.data[c],index:c}});!kn(r,a)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,a))}notifyPlugins(t,a,r){return this._plugins.notify(this,t,a,r)}isPluginEnabled(t){return this._plugins._cache.filter(a=>a.plugin.id===t).length===1}_updateHoverStyles(t,a,r){const n=this.options.hover,l=(f,p)=>f.filter(h=>!p.some(g=>h.datasetIndex===g.datasetIndex&&h.index===g.index)),c=l(a,t),d=r?t:l(t,a);c.length&&this.updateHoverStyle(c,n.mode,!1),d.length&&n.mode&&this.updateHoverStyle(d,n.mode,!0)}_eventHandler(t,a){const r={event:t,replay:a,cancelable:!0,inChartArea:this.isPointInArea(t)},n=c=>(c.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,n)===!1)return;const l=this._handleEvent(t,a,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,n),(l||r.changed)&&this.render(),this}_handleEvent(t,a,r){const{_active:n=[],options:l}=this,c=a,d=this._getActiveElements(t,n,r,c),f=ff(t),p=Wm(t,this._lastEvent,r,f);r&&(this._lastEvent=null,ps(l.onHover,[t,d,this],this),f&&ps(l.onClick,[t,d,this],this));const h=!kn(d,n);return(h||a)&&(this._active=d,this._updateHoverStyles(d,n,a)),this._lastEvent=p,h}_getActiveElements(t,a,r,n){if(t.type==="mouseout")return[];if(!r)return a;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,n)}}function ec(){return as(cr.instances,s=>s._plugins.invalidate())}function Hm(s,t,a){const{startAngle:r,x:n,y:l,outerRadius:c,innerRadius:d,options:f}=t,{borderWidth:p,borderJoinStyle:h}=f,g=Math.min(p/c,Sr(r-a));if(s.beginPath(),s.arc(n,l,c-p/2,r+g/2,a-g/2),d>0){const b=Math.min(p/d,Sr(r-a));s.arc(n,l,d+p/2,a-b/2,r+b/2,!0)}else{const b=Math.min(p/2,c*Sr(r-a));if(h==="round")s.arc(n,l,b,a-os/2,r+os/2,!0);else if(h==="bevel"){const y=2*b*b,k=-y*Math.cos(a+os/2)+n,A=-y*Math.sin(a+os/2)+l,T=y*Math.cos(r+os/2)+n,C=y*Math.sin(r+os/2)+l;s.lineTo(k,A),s.lineTo(T,C)}}s.closePath(),s.moveTo(0,0),s.rect(0,0,s.canvas.width,s.canvas.height),s.clip("evenodd")}function Um(s,t,a){const{startAngle:r,pixelMargin:n,x:l,y:c,outerRadius:d,innerRadius:f}=t;let p=n/d;s.beginPath(),s.arc(l,c,d,r-p,a+p),f>n?(p=n/f,s.arc(l,c,f,a+p,r-p,!0)):s.arc(l,c,n,a+$s,r-$s),s.closePath(),s.clip()}function Ym(s){return To(s,["outerStart","outerEnd","innerStart","innerEnd"])}function Qm(s,t,a,r){const n=Ym(s.options.borderRadius),l=(a-t)/2,c=Math.min(l,r*t/2),d=f=>{const p=(a-Math.min(l,f))*r/2;return Js(f,0,Math.min(l,p))};return{outerStart:d(n.outerStart),outerEnd:d(n.outerEnd),innerStart:Js(n.innerStart,0,c),innerEnd:Js(n.innerEnd,0,c)}}function li(s,t,a,r){return{x:a+s*Math.cos(t),y:r+s*Math.sin(t)}}function $n(s,t,a,r,n,l){const{x:c,y:d,startAngle:f,pixelMargin:p,innerRadius:h}=t,g=Math.max(t.outerRadius+r+a-p,0),b=h>0?h+r+a+p:0;let y=0;const k=n-f;if(r){const re=h>0?h-r:0,me=g>0?g-r:0,je=(re+me)/2,de=je!==0?k*je/(je+r):k;y=(k-de)/2}const A=Math.max(.001,k*g-a/os)/g,T=(k-A)/2,C=f+T+y,D=n-T-y,{outerStart:S,outerEnd:L,innerStart:F,innerEnd:j}=Qm(t,b,g,D-C),P=g-S,Q=g-L,W=C+S/P,$=D-L/Q,R=b+F,X=b+j,se=C+F/R,V=D-j/X;if(s.beginPath(),l){const re=(W+$)/2;if(s.arc(c,d,g,W,re),s.arc(c,d,g,re,$),L>0){const ie=li(Q,$,c,d);s.arc(ie.x,ie.y,L,$,D+$s)}const me=li(X,D,c,d);if(s.lineTo(me.x,me.y),j>0){const ie=li(X,V,c,d);s.arc(ie.x,ie.y,j,D+$s,V+Math.PI)}const je=(D-j/b+(C+F/b))/2;if(s.arc(c,d,b,D-j/b,je,!0),s.arc(c,d,b,je,C+F/b,!0),F>0){const ie=li(R,se,c,d);s.arc(ie.x,ie.y,F,se+Math.PI,C-$s)}const de=li(P,C,c,d);if(s.lineTo(de.x,de.y),S>0){const ie=li(P,W,c,d);s.arc(ie.x,ie.y,S,C-$s,W)}}else{s.moveTo(c,d);const re=Math.cos(W)*g+c,me=Math.sin(W)*g+d;s.lineTo(re,me);const je=Math.cos($)*g+c,de=Math.sin($)*g+d;s.lineTo(je,de)}s.closePath()}function Km(s,t,a,r,n){const{fullCircles:l,startAngle:c,circumference:d}=t;let f=t.endAngle;if(l){$n(s,t,a,r,f,n);for(let p=0;p<l;++p)s.fill();isNaN(d)||(f=c+(d%Ts||Ts))}return $n(s,t,a,r,f,n),s.fill(),f}function Jm(s,t,a,r,n){const{fullCircles:l,startAngle:c,circumference:d,options:f}=t,{borderWidth:p,borderJoinStyle:h,borderDash:g,borderDashOffset:b,borderRadius:y}=f,k=f.borderAlign==="inner";if(!p)return;s.setLineDash(g||[]),s.lineDashOffset=b,k?(s.lineWidth=p*2,s.lineJoin=h||"round"):(s.lineWidth=p,s.lineJoin=h||"bevel");let A=t.endAngle;if(l){$n(s,t,a,r,A,n);for(let T=0;T<l;++T)s.stroke();isNaN(d)||(A=c+(d%Ts||Ts))}k&&Um(s,t,A),f.selfJoin&&A-c>=os&&y===0&&h!=="miter"&&Hm(s,t,A),l||($n(s,t,a,r,A,n),s.stroke())}class Xm extends ti{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,a,r){const n=this.getProps(["x","y"],r),{angle:l,distance:c}=qc(n,{x:t,y:a}),{startAngle:d,endAngle:f,innerRadius:p,outerRadius:h,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),b=(this.options.spacing+this.options.borderWidth)/2,y=Qa(g,f-d),k=Tn(l,d,f)&&d!==f,A=y>=Ts||k,T=Kr(c,p+b,h+b);return A&&T}getCenterPoint(t){const{x:a,y:r,startAngle:n,endAngle:l,innerRadius:c,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:p}=this.options,h=(n+l)/2,g=(c+d+p+f)/2;return{x:a+Math.cos(h)*g,y:r+Math.sin(h)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:a,circumference:r}=this,n=(a.offset||0)/4,l=(a.spacing||0)/2,c=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=r>Ts?Math.floor(r/Ts):0,r===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const d=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(d)*n,Math.sin(d)*n);const f=1-Math.sin(Math.min(os,r||0)),p=n*f;t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,Km(t,this,p,l,c),Jm(t,this,p,l,c),t.restore()}}function pd(s,t){const{x:a,y:r,base:n,width:l,height:c}=s.getProps(["x","y","base","width","height"],t);let d,f,p,h,g;return s.horizontal?(g=c/2,d=Math.min(a,n),f=Math.max(a,n),p=r-g,h=r+g):(g=l/2,d=a-g,f=a+g,p=Math.min(r,n),h=Math.max(r,n)),{left:d,top:p,right:f,bottom:h}}function Ir(s,t,a,r){return s?0:Js(t,a,r)}function Zm(s,t,a){const r=s.options.borderWidth,n=s.borderSkipped,l=Qc(r);return{t:Ir(n.top,l.top,0,a),r:Ir(n.right,l.right,0,t),b:Ir(n.bottom,l.bottom,0,a),l:Ir(n.left,l.left,0,t)}}function eh(s,t,a){const{enableBorderRadius:r}=s.getProps(["enableBorderRadius"]),n=s.options.borderRadius,l=ui(n),c=Math.min(t,a),d=s.borderSkipped,f=r||Ka(n);return{topLeft:Ir(!f||d.top||d.left,l.topLeft,0,c),topRight:Ir(!f||d.top||d.right,l.topRight,0,c),bottomLeft:Ir(!f||d.bottom||d.left,l.bottomLeft,0,c),bottomRight:Ir(!f||d.bottom||d.right,l.bottomRight,0,c)}}function th(s){const t=pd(s),a=t.right-t.left,r=t.bottom-t.top,n=Zm(s,a/2,r/2),l=eh(s,a/2,r/2);return{outer:{x:t.left,y:t.top,w:a,h:r,radius:l},inner:{x:t.left+n.l,y:t.top+n.t,w:a-n.l-n.r,h:r-n.t-n.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,l.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(n.b,n.r))}}}}function oo(s,t,a,r){const n=t===null,l=a===null,d=s&&!(n&&l)&&pd(s,r);return d&&(n||Kr(t,d.left,d.right))&&(l||Kr(a,d.top,d.bottom))}function ah(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function sh(s,t){s.rect(t.x,t.y,t.w,t.h)}function lo(s,t,a={}){const r=s.x!==a.x?-t:0,n=s.y!==a.y?-t:0,l=(s.x+s.w!==a.x+a.w?t:0)-r,c=(s.y+s.h!==a.y+a.h?t:0)-n;return{x:s.x+r,y:s.y+n,w:s.w+l,h:s.h+c,radius:s.radius}}class Rn extends ti{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:a,options:{borderColor:r,backgroundColor:n}}=this,{inner:l,outer:c}=th(this),d=ah(c.radius)?En:sh;t.save(),(c.w!==l.w||c.h!==l.h)&&(t.beginPath(),d(t,lo(c,a,l)),t.clip(),d(t,lo(l,-a,c)),t.fillStyle=r,t.fill("evenodd")),t.beginPath(),d(t,lo(l,a)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,a,r){return oo(this,t,a,r)}inXRange(t,a){return oo(this,t,null,a)}inYRange(t,a){return oo(this,null,t,a)}getCenterPoint(t){const{x:a,y:r,base:n,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(a+n)/2:a,y:l?r:(r+n)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}const tc=(s,t)=>{let{boxHeight:a=t,boxWidth:r=t}=s;return s.usePointStyle&&(a=Math.min(a,t),r=s.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:a,itemHeight:Math.max(t,a)}},rh=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class ac extends ti{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a,r){this.maxWidth=t,this.maxHeight=a,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let a=ps(t.generateLabels,[this.chart],this)||[];t.filter&&(a=a.filter(r=>t.filter(r,this.chart.data))),t.sort&&(a=a.sort((r,n)=>t.sort(r,n,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:t,ctx:a}=this;if(!t.display){this.width=this.height=0;return}const r=t.labels,n=zs(r.font),l=n.size,c=this._computeTitleHeight(),{boxWidth:d,itemHeight:f}=tc(r,l);let p,h;a.font=n.string,this.isHorizontal()?(p=this.maxWidth,h=this._fitRows(c,l,d,f)+10):(h=this.maxHeight,p=this._fitCols(c,n,d,f)+10),this.width=Math.min(p,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,a,r,n){const{ctx:l,maxWidth:c,options:{labels:{padding:d}}}=this,f=this.legendHitBoxes=[],p=this.lineWidths=[0],h=n+d;let g=t;l.textAlign="left",l.textBaseline="middle";let b=-1,y=-h;return this.legendItems.forEach((k,A)=>{const T=r+a/2+l.measureText(k.text).width;(A===0||p[p.length-1]+T+2*d>c)&&(g+=h,p[p.length-(A>0?0:1)]=0,y+=h,b++),f[A]={left:0,top:y,row:b,width:T,height:n},p[p.length-1]+=T+d}),g}_fitCols(t,a,r,n){const{ctx:l,maxHeight:c,options:{labels:{padding:d}}}=this,f=this.legendHitBoxes=[],p=this.columnSizes=[],h=c-t;let g=d,b=0,y=0,k=0,A=0;return this.legendItems.forEach((T,C)=>{const{itemWidth:D,itemHeight:S}=ih(r,a,l,T,n);C>0&&y+S+2*d>h&&(g+=b+d,p.push({width:b,height:y}),k+=b+d,A++,b=y=0),f[C]={left:k,top:y,col:A,width:D,height:S},b=Math.max(b,D),y+=S+d}),g+=b,p.push({width:b,height:y}),g}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:r,labels:{padding:n},rtl:l}}=this,c=vi(l,this.left,this.width);if(this.isHorizontal()){let d=0,f=qs(r,this.left+n,this.right-this.lineWidths[d]);for(const p of a)d!==p.row&&(d=p.row,f=qs(r,this.left+n,this.right-this.lineWidths[d])),p.top+=this.top+t+n,p.left=c.leftForLtr(c.x(f),p.width),f+=p.width+n}else{let d=0,f=qs(r,this.top+t+n,this.bottom-this.columnSizes[d].height);for(const p of a)p.col!==d&&(d=p.col,f=qs(r,this.top+t+n,this.bottom-this.columnSizes[d].height)),p.top=f,p.left+=this.left+n,p.left=c.leftForLtr(c.x(p.left),p.width),f+=p.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Do(t,this),this._draw(),Co(t)}}_draw(){const{options:t,columnSizes:a,lineWidths:r,ctx:n}=this,{align:l,labels:c}=t,d=Ss.color,f=vi(t.rtl,this.left,this.width),p=zs(c.font),{padding:h}=c,g=p.size,b=g/2;let y;this.drawTitle(),n.textAlign=f.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=p.string;const{boxWidth:k,boxHeight:A,itemHeight:T}=tc(c,g),C=function(j,P,Q){if(isNaN(k)||k<=0||isNaN(A)||A<0)return;n.save();const W=Qa(Q.lineWidth,1);if(n.fillStyle=Qa(Q.fillStyle,d),n.lineCap=Qa(Q.lineCap,"butt"),n.lineDashOffset=Qa(Q.lineDashOffset,0),n.lineJoin=Qa(Q.lineJoin,"miter"),n.lineWidth=W,n.strokeStyle=Qa(Q.strokeStyle,d),n.setLineDash(Qa(Q.lineDash,[])),c.usePointStyle){const $={radius:A*Math.SQRT2/2,pointStyle:Q.pointStyle,rotation:Q.rotation,borderWidth:W},R=f.xPlus(j,k/2),X=P+b;Uc(n,$,R,X,c.pointStyleWidth&&k)}else{const $=P+Math.max((g-A)/2,0),R=f.leftForLtr(j,k),X=ui(Q.borderRadius);n.beginPath(),Object.values(X).some(se=>se!==0)?En(n,{x:R,y:$,w:k,h:A,radius:X}):n.rect(R,$,k,A),n.fill(),W!==0&&n.stroke()}n.restore()},D=function(j,P,Q){Vi(n,Q.text,j,P+T/2,p,{strikethrough:Q.hidden,textAlign:f.textAlign(Q.textAlign)})},S=this.isHorizontal(),L=this._computeTitleHeight();S?y={x:qs(l,this.left+h,this.right-r[0]),y:this.top+h+L,line:0}:y={x:this.left+h,y:qs(l,this.top+L+h,this.bottom-a[0].height),line:0},ed(this.ctx,t.textDirection);const F=T+h;this.legendItems.forEach((j,P)=>{n.strokeStyle=j.fontColor,n.fillStyle=j.fontColor;const Q=n.measureText(j.text).width,W=f.textAlign(j.textAlign||(j.textAlign=c.textAlign)),$=k+b+Q;let R=y.x,X=y.y;f.setWidth(this.width),S?P>0&&R+$+h>this.right&&(X=y.y+=F,y.line++,R=y.x=qs(l,this.left+h,this.right-r[y.line])):P>0&&X+F>this.bottom&&(R=y.x=R+a[y.line].width+h,y.line++,X=y.y=qs(l,this.top+L+h,this.bottom-a[y.line].height));const se=f.x(R);if(C(se,X,j),R=Df(W,R+k+b,S?R+$:this.right,t.rtl),D(f.x(R),X,j),S)y.x+=$+h;else if(typeof j.text!="string"){const V=p.lineHeight;y.y+=md(j,V)+h}else y.y+=F}),td(this.ctx,t.textDirection)}drawTitle(){const t=this.options,a=t.title,r=zs(a.font),n=ur(a.padding);if(!a.display)return;const l=vi(t.rtl,this.left,this.width),c=this.ctx,d=a.position,f=r.size/2,p=n.top+f;let h,g=this.left,b=this.width;if(this.isHorizontal())b=Math.max(...this.lineWidths),h=this.top+p,g=qs(t.align,g,this.right-b);else{const k=this.columnSizes.reduce((A,T)=>Math.max(A,T.height),0);h=p+qs(t.align,this.top,this.bottom-k-t.labels.padding-this._computeTitleHeight())}const y=qs(d,g,g+b);c.textAlign=l.textAlign(ko(d)),c.textBaseline="middle",c.strokeStyle=a.color,c.fillStyle=a.color,c.font=r.string,Vi(c,a.text,y,h,r)}_computeTitleHeight(){const t=this.options.title,a=zs(t.font),r=ur(t.padding);return t.display?a.lineHeight+r.height:0}_getLegendItemAt(t,a){let r,n,l;if(Kr(t,this.left,this.right)&&Kr(a,this.top,this.bottom)){for(l=this.legendHitBoxes,r=0;r<l.length;++r)if(n=l[r],Kr(t,n.left,n.left+n.width)&&Kr(a,n.top,n.top+n.height))return this.legendItems[r]}return null}handleEvent(t){const a=this.options;if(!lh(t.type,a))return;const r=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const n=this._hoveredItem,l=rh(n,r);n&&!l&&ps(a.onLeave,[t,n,this],this),this._hoveredItem=r,r&&!l&&ps(a.onHover,[t,r,this],this)}else r&&ps(a.onClick,[t,r,this],this)}}function ih(s,t,a,r,n){const l=nh(r,s,t,a),c=oh(n,r,t.lineHeight);return{itemWidth:l,itemHeight:c}}function nh(s,t,a,r){let n=s.text;return n&&typeof n!="string"&&(n=n.reduce((l,c)=>l.length>c.length?l:c)),t+a.size/2+r.measureText(n).width}function oh(s,t,a){let r=s;return typeof t.text!="string"&&(r=md(t,a)),r}function md(s,t){const a=s.text?s.text.length:0;return t*a}function lh(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var Hi={id:"legend",_element:ac,start(s,t,a){const r=s.legend=new ac({ctx:s.ctx,options:a,chart:s});lr.configure(s,r,a),lr.addBox(s,r)},stop(s){lr.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,a){const r=s.legend;lr.configure(s,r,a),r.options=a},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,a){const r=t.datasetIndex,n=a.chart;n.isDatasetVisible(r)?(n.hide(r),t.hidden=!0):(n.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:a,pointStyle:r,textAlign:n,color:l,useBorderRadius:c,borderRadius:d}}=s.legend.options;return s._getSortedDatasetMetas().map(f=>{const p=f.controller.getStyle(a?0:void 0),h=ur(p.borderWidth);return{text:t[f.index].label,fillStyle:p.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:p.borderCapStyle,lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:p.borderColor,pointStyle:r||p.pointStyle,rotation:p.rotation,textAlign:n||p.textAlign,borderRadius:c&&(d||p.borderRadius),datasetIndex:f.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class hd extends ti{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=a;const n=Ns(r.text)?r.text.length:1;this._padding=ur(r.padding);const l=n*zs(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:a,left:r,bottom:n,right:l,options:c}=this,d=c.align;let f=0,p,h,g;return this.isHorizontal()?(h=qs(d,r,l),g=a+t,p=l-r):(c.position==="left"?(h=r+t,g=qs(d,n,a),f=os*-.5):(h=l-t,g=qs(d,a,n),f=os*.5),p=n-a),{titleX:h,titleY:g,maxWidth:p,rotation:f}}draw(){const t=this.ctx,a=this.options;if(!a.display)return;const r=zs(a.font),l=r.lineHeight/2+this._padding.top,{titleX:c,titleY:d,maxWidth:f,rotation:p}=this._drawArgs(l);Vi(t,a.text,0,0,r,{color:a.color,maxWidth:f,rotation:p,textAlign:ko(a.align),textBaseline:"middle",translation:[c,d]})}}function ch(s,t){const a=new hd({ctx:s.ctx,options:t,chart:s});lr.configure(s,a,t),lr.addBox(s,a),s.titleBlock=a}var Ui={id:"title",_element:hd,start(s,t,a){ch(s,a)},stop(s){const t=s.titleBlock;lr.removeBox(s,t),delete s.titleBlock},beforeUpdate(s,t,a){const r=s.titleBlock;lr.configure(s,r,a),r.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Mi={average(s){if(!s.length)return!1;let t,a,r=new Set,n=0,l=0;for(t=0,a=s.length;t<a;++t){const d=s[t].element;if(d&&d.hasValue()){const f=d.tooltipPosition();r.add(f.x),n+=f.y,++l}}return l===0||r.size===0?!1:{x:[...r].reduce((d,f)=>d+f)/r.size,y:n/l}},nearest(s,t){if(!s.length)return!1;let a=t.x,r=t.y,n=Number.POSITIVE_INFINITY,l,c,d;for(l=0,c=s.length;l<c;++l){const f=s[l].element;if(f&&f.hasValue()){const p=f.getCenterPoint(),h=yf(t,p);h<n&&(n=h,d=f)}}if(d){const f=d.tooltipPosition();a=f.x,r=f.y}return{x:a,y:r}}};function br(s,t){return t&&(Ns(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function Dr(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function dh(s,t){const{element:a,datasetIndex:r,index:n}=t,l=s.getDatasetMeta(r).controller,{label:c,value:d}=l.getLabelAndValue(n);return{chart:s,label:c,parsed:l.getParsed(n),raw:s.data.datasets[r].data[n],formattedValue:d,dataset:l.getDataset(),dataIndex:n,datasetIndex:r,element:a}}function sc(s,t){const a=s.chart.ctx,{body:r,footer:n,title:l}=s,{boxWidth:c,boxHeight:d}=t,f=zs(t.bodyFont),p=zs(t.titleFont),h=zs(t.footerFont),g=l.length,b=n.length,y=r.length,k=ur(t.padding);let A=k.height,T=0,C=r.reduce((L,F)=>L+F.before.length+F.lines.length+F.after.length,0);if(C+=s.beforeBody.length+s.afterBody.length,g&&(A+=g*p.lineHeight+(g-1)*t.titleSpacing+t.titleMarginBottom),C){const L=t.displayColors?Math.max(d,f.lineHeight):f.lineHeight;A+=y*L+(C-y)*f.lineHeight+(C-1)*t.bodySpacing}b&&(A+=t.footerMarginTop+b*h.lineHeight+(b-1)*t.footerSpacing);let D=0;const S=function(L){T=Math.max(T,a.measureText(L).width+D)};return a.save(),a.font=p.string,as(s.title,S),a.font=f.string,as(s.beforeBody.concat(s.afterBody),S),D=t.displayColors?c+2+t.boxPadding:0,as(r,L=>{as(L.before,S),as(L.lines,S),as(L.after,S)}),D=0,a.font=h.string,as(s.footer,S),a.restore(),T+=k.width,{width:T,height:A}}function uh(s,t){const{y:a,height:r}=t;return a<r/2?"top":a>s.height-r/2?"bottom":"center"}function vh(s,t,a,r){const{x:n,width:l}=r,c=a.caretSize+a.caretPadding;if(s==="left"&&n+l+c>t.width||s==="right"&&n-l-c<0)return!0}function fh(s,t,a,r){const{x:n,width:l}=a,{width:c,chartArea:{left:d,right:f}}=s;let p="center";return r==="center"?p=n<=(d+f)/2?"left":"right":n<=l/2?p="left":n>=c-l/2&&(p="right"),vh(p,s,t,a)&&(p="center"),p}function rc(s,t,a){const r=a.yAlign||t.yAlign||uh(s,a);return{xAlign:a.xAlign||t.xAlign||fh(s,t,a,r),yAlign:r}}function ph(s,t){let{x:a,width:r}=s;return t==="right"?a-=r:t==="center"&&(a-=r/2),a}function mh(s,t,a){let{y:r,height:n}=s;return t==="top"?r+=a:t==="bottom"?r-=n+a:r-=n/2,r}function ic(s,t,a,r){const{caretSize:n,caretPadding:l,cornerRadius:c}=s,{xAlign:d,yAlign:f}=a,p=n+l,{topLeft:h,topRight:g,bottomLeft:b,bottomRight:y}=ui(c);let k=ph(t,d);const A=mh(t,f,p);return f==="center"?d==="left"?k+=p:d==="right"&&(k-=p):d==="left"?k-=Math.max(h,b)+n:d==="right"&&(k+=Math.max(g,y)+n),{x:Js(k,0,r.width-t.width),y:Js(A,0,r.height-t.height)}}function hn(s,t,a){const r=ur(a.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-r.right:s.x+r.left}function nc(s){return br([],Dr(s))}function hh(s,t,a){return pi(s,{tooltip:t,tooltipItems:a,type:"tooltip"})}function oc(s,t){const a=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return a?s.override(a):s}const gd={beforeTitle:kr,title(s){if(s.length>0){const t=s[0],a=t.chart.data.labels,r=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return a[t.dataIndex]}return""},afterTitle:kr,beforeBody:kr,beforeLabel:kr,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const a=s.formattedValue;return ls(a)||(t+=a),t},labelColor(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:kr,afterBody:kr,beforeFooter:kr,footer:kr,afterFooter:kr};function Qs(s,t,a,r){const n=s[t].call(a,r);return typeof n>"u"?gd[t].call(a,r):n}class lc extends ti{static positioners=Mi;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const a=this.chart,r=this.options.setContext(this.getContext()),n=r.enabled&&a.options.animation&&r.animations,l=new ad(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=hh(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,a){const{callbacks:r}=a,n=Qs(r,"beforeTitle",this,t),l=Qs(r,"title",this,t),c=Qs(r,"afterTitle",this,t);let d=[];return d=br(d,Dr(n)),d=br(d,Dr(l)),d=br(d,Dr(c)),d}getBeforeBody(t,a){return nc(Qs(a.callbacks,"beforeBody",this,t))}getBody(t,a){const{callbacks:r}=a,n=[];return as(t,l=>{const c={before:[],lines:[],after:[]},d=oc(r,l);br(c.before,Dr(Qs(d,"beforeLabel",this,l))),br(c.lines,Qs(d,"label",this,l)),br(c.after,Dr(Qs(d,"afterLabel",this,l))),n.push(c)}),n}getAfterBody(t,a){return nc(Qs(a.callbacks,"afterBody",this,t))}getFooter(t,a){const{callbacks:r}=a,n=Qs(r,"beforeFooter",this,t),l=Qs(r,"footer",this,t),c=Qs(r,"afterFooter",this,t);let d=[];return d=br(d,Dr(n)),d=br(d,Dr(l)),d=br(d,Dr(c)),d}_createItems(t){const a=this._active,r=this.chart.data,n=[],l=[],c=[];let d=[],f,p;for(f=0,p=a.length;f<p;++f)d.push(dh(this.chart,a[f]));return t.filter&&(d=d.filter((h,g,b)=>t.filter(h,g,b,r))),t.itemSort&&(d=d.sort((h,g)=>t.itemSort(h,g,r))),as(d,h=>{const g=oc(t.callbacks,h);n.push(Qs(g,"labelColor",this,h)),l.push(Qs(g,"labelPointStyle",this,h)),c.push(Qs(g,"labelTextColor",this,h))}),this.labelColors=n,this.labelPointStyles=l,this.labelTextColors=c,this.dataPoints=d,d}update(t,a){const r=this.options.setContext(this.getContext()),n=this._active;let l,c=[];if(!n.length)this.opacity!==0&&(l={opacity:0});else{const d=Mi[r.position].call(this,n,this._eventPosition);c=this._createItems(r),this.title=this.getTitle(c,r),this.beforeBody=this.getBeforeBody(c,r),this.body=this.getBody(c,r),this.afterBody=this.getAfterBody(c,r),this.footer=this.getFooter(c,r);const f=this._size=sc(this,r),p=Object.assign({},d,f),h=rc(this.chart,r,p),g=ic(r,p,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,l={opacity:1,x:g.x,y:g.y,width:f.width,height:f.height,caretX:d.x,caretY:d.y}}this._tooltipItems=c,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(t,a,r,n){const l=this.getCaretPosition(t,r,n);a.lineTo(l.x1,l.y1),a.lineTo(l.x2,l.y2),a.lineTo(l.x3,l.y3)}getCaretPosition(t,a,r){const{xAlign:n,yAlign:l}=this,{caretSize:c,cornerRadius:d}=r,{topLeft:f,topRight:p,bottomLeft:h,bottomRight:g}=ui(d),{x:b,y}=t,{width:k,height:A}=a;let T,C,D,S,L,F;return l==="center"?(L=y+A/2,n==="left"?(T=b,C=T-c,S=L+c,F=L-c):(T=b+k,C=T+c,S=L-c,F=L+c),D=T):(n==="left"?C=b+Math.max(f,h)+c:n==="right"?C=b+k-Math.max(p,g)-c:C=this.caretX,l==="top"?(S=y,L=S-c,T=C-c,D=C+c):(S=y+A,L=S+c,T=C+c,D=C-c),F=S),{x1:T,x2:C,x3:D,y1:S,y2:L,y3:F}}drawTitle(t,a,r){const n=this.title,l=n.length;let c,d,f;if(l){const p=vi(r.rtl,this.x,this.width);for(t.x=hn(this,r.titleAlign,r),a.textAlign=p.textAlign(r.titleAlign),a.textBaseline="middle",c=zs(r.titleFont),d=r.titleSpacing,a.fillStyle=r.titleColor,a.font=c.string,f=0;f<l;++f)a.fillText(n[f],p.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+d,f+1===l&&(t.y+=r.titleMarginBottom-d)}}_drawColorBox(t,a,r,n,l){const c=this.labelColors[r],d=this.labelPointStyles[r],{boxHeight:f,boxWidth:p}=l,h=zs(l.bodyFont),g=hn(this,"left",l),b=n.x(g),y=f<h.lineHeight?(h.lineHeight-f)/2:0,k=a.y+y;if(l.usePointStyle){const A={radius:Math.min(p,f)/2,pointStyle:d.pointStyle,rotation:d.rotation,borderWidth:1},T=n.leftForLtr(b,p)+p/2,C=k+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,xl(t,A,T,C),t.strokeStyle=c.borderColor,t.fillStyle=c.backgroundColor,xl(t,A,T,C)}else{t.lineWidth=Ka(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,t.strokeStyle=c.borderColor,t.setLineDash(c.borderDash||[]),t.lineDashOffset=c.borderDashOffset||0;const A=n.leftForLtr(b,p),T=n.leftForLtr(n.xPlus(b,1),p-2),C=ui(c.borderRadius);Object.values(C).some(D=>D!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,En(t,{x:A,y:k,w:p,h:f,radius:C}),t.fill(),t.stroke(),t.fillStyle=c.backgroundColor,t.beginPath(),En(t,{x:T,y:k+1,w:p-2,h:f-2,radius:C}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(A,k,p,f),t.strokeRect(A,k,p,f),t.fillStyle=c.backgroundColor,t.fillRect(T,k+1,p-2,f-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,a,r){const{body:n}=this,{bodySpacing:l,bodyAlign:c,displayColors:d,boxHeight:f,boxWidth:p,boxPadding:h}=r,g=zs(r.bodyFont);let b=g.lineHeight,y=0;const k=vi(r.rtl,this.x,this.width),A=function(Q){a.fillText(Q,k.x(t.x+y),t.y+b/2),t.y+=b+l},T=k.textAlign(c);let C,D,S,L,F,j,P;for(a.textAlign=c,a.textBaseline="middle",a.font=g.string,t.x=hn(this,T,r),a.fillStyle=r.bodyColor,as(this.beforeBody,A),y=d&&T!=="right"?c==="center"?p/2+h:p+2+h:0,L=0,j=n.length;L<j;++L){for(C=n[L],D=this.labelTextColors[L],a.fillStyle=D,as(C.before,A),S=C.lines,d&&S.length&&(this._drawColorBox(a,t,L,k,r),b=Math.max(g.lineHeight,f)),F=0,P=S.length;F<P;++F)A(S[F]),b=g.lineHeight;as(C.after,A)}y=0,b=g.lineHeight,as(this.afterBody,A),t.y-=l}drawFooter(t,a,r){const n=this.footer,l=n.length;let c,d;if(l){const f=vi(r.rtl,this.x,this.width);for(t.x=hn(this,r.footerAlign,r),t.y+=r.footerMarginTop,a.textAlign=f.textAlign(r.footerAlign),a.textBaseline="middle",c=zs(r.footerFont),a.fillStyle=r.footerColor,a.font=c.string,d=0;d<l;++d)a.fillText(n[d],f.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+r.footerSpacing}}drawBackground(t,a,r,n){const{xAlign:l,yAlign:c}=this,{x:d,y:f}=t,{width:p,height:h}=r,{topLeft:g,topRight:b,bottomLeft:y,bottomRight:k}=ui(n.cornerRadius);a.fillStyle=n.backgroundColor,a.strokeStyle=n.borderColor,a.lineWidth=n.borderWidth,a.beginPath(),a.moveTo(d+g,f),c==="top"&&this.drawCaret(t,a,r,n),a.lineTo(d+p-b,f),a.quadraticCurveTo(d+p,f,d+p,f+b),c==="center"&&l==="right"&&this.drawCaret(t,a,r,n),a.lineTo(d+p,f+h-k),a.quadraticCurveTo(d+p,f+h,d+p-k,f+h),c==="bottom"&&this.drawCaret(t,a,r,n),a.lineTo(d+y,f+h),a.quadraticCurveTo(d,f+h,d,f+h-y),c==="center"&&l==="left"&&this.drawCaret(t,a,r,n),a.lineTo(d,f+g),a.quadraticCurveTo(d,f,d+g,f),a.closePath(),a.fill(),n.borderWidth>0&&a.stroke()}_updateAnimationTarget(t){const a=this.chart,r=this.$animations,n=r&&r.x,l=r&&r.y;if(n||l){const c=Mi[t.position].call(this,this._active,this._eventPosition);if(!c)return;const d=this._size=sc(this,t),f=Object.assign({},c,this._size),p=rc(a,t,f),h=ic(t,f,p,a);(n._to!==h.x||l._to!==h.y)&&(this.xAlign=p.xAlign,this.yAlign=p.yAlign,this.width=d.width,this.height=d.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const a=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(a);const n={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const c=ur(a.padding),d=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&d&&(t.save(),t.globalAlpha=r,this.drawBackground(l,t,n,a),ed(t,a.textDirection),l.y+=c.top,this.drawTitle(l,t,a),this.drawBody(l,t,a),this.drawFooter(l,t,a),td(t,a.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,a){const r=this._active,n=t.map(({datasetIndex:d,index:f})=>{const p=this.chart.getDatasetMeta(d);if(!p)throw new Error("Cannot find a dataset at index "+d);return{datasetIndex:d,element:p.data[f],index:f}}),l=!kn(r,n),c=this._positionChanged(n,a);(l||c)&&(this._active=n,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,a,r=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,l=this._active||[],c=this._getActiveElements(t,l,a,r),d=this._positionChanged(c,t),f=a||!kn(c,l)||d;return f&&(this._active=c,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,a))),f}_getActiveElements(t,a,r,n){const l=this.options;if(t.type==="mouseout")return[];if(!n)return a.filter(d=>this.chart.data.datasets[d.datasetIndex]&&this.chart.getDatasetMeta(d.datasetIndex).controller.getParsed(d.index)!==void 0);const c=this.chart.getElementsAtEventForMode(t,l.mode,l,r);return l.reverse&&c.reverse(),c}_positionChanged(t,a){const{caretX:r,caretY:n,options:l}=this,c=Mi[l.position].call(this,t,a);return c!==!1&&(r!==c.x||n!==c.y)}}var Yi={id:"tooltip",_element:lc,positioners:Mi,afterInit(s,t,a){a&&(s.tooltip=new lc({chart:s,options:a}))},beforeUpdate(s,t,a){s.tooltip&&s.tooltip.initialize(a)},reset(s,t,a){s.tooltip&&s.tooltip.initialize(a)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const a={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",a)}},afterEvent(s,t){if(s.tooltip){const a=t.replay;s.tooltip.handleEvent(t.event,a,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:gd},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const gh=(s,t,a,r)=>(typeof t=="string"?(a=s.push(t)-1,r.unshift({index:a,label:t})):isNaN(t)&&(a=null),a);function _h(s,t,a,r){const n=s.indexOf(t);if(n===-1)return gh(s,t,a,r);const l=s.lastIndexOf(t);return n!==l?a:n}const bh=(s,t)=>s===null?null:Js(Math.round(s),0,t);function cc(s){const t=this.getLabels();return s>=0&&s<t.length?t[s]:s}class On extends mi{static id="category";static defaults={ticks:{callback:cc}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const a=this._addedLabels;if(a.length){const r=this.getLabels();for(const{index:n,label:l}of a)r[n]===l&&r.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,a){if(ls(t))return null;const r=this.getLabels();return a=isFinite(a)&&r[a]===t?a:_h(r,t,Qa(a,t),this._addedLabels),bh(a,r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:a}=this.getUserBounds();let{min:r,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),a||(n=this.getLabels().length-1)),this.min=r,this.max=n}buildTicks(){const t=this.min,a=this.max,r=this.options.offset,n=[];let l=this.getLabels();l=t===0&&a===l.length-1?l:l.slice(t,a+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let c=t;c<=a;c++)n.push({value:c});return n}getLabelForValue(t){return cc.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function yh(s,t){const a=[],{bounds:n,step:l,min:c,max:d,precision:f,count:p,maxTicks:h,maxDigits:g,includeBounds:b}=s,y=l||1,k=h-1,{min:A,max:T}=t,C=!ls(c),D=!ls(d),S=!ls(p),L=(T-A)/(g+1);let F=fl((T-A)/k/y)*y,j,P,Q,W;if(F<1e-14&&!C&&!D)return[{value:A},{value:T}];W=Math.ceil(T/F)-Math.floor(A/F),W>k&&(F=fl(W*F/k/y)*y),ls(f)||(j=Math.pow(10,f),F=Math.ceil(F*j)/j),n==="ticks"?(P=Math.floor(A/F)*F,Q=Math.ceil(T/F)*F):(P=A,Q=T),C&&D&&l&&gf((d-c)/l,F/1e3)?(W=Math.round(Math.min((d-c)/F,h)),F=(d-c)/W,P=c,Q=d):S?(P=C?c:P,Q=D?d:Q,W=p-1,F=(Q-P)/W):(W=(Q-P)/F,_n(W,Math.round(W),F/1e3)?W=Math.round(W):W=Math.ceil(W));const $=Math.max(pl(F),pl(P));j=Math.pow(10,ls(f)?$:f),P=Math.round(P*j)/j,Q=Math.round(Q*j)/j;let R=0;for(C&&(b&&P!==c?(a.push({value:c}),P<c&&R++,_n(Math.round((P+R*F)*j)/j,c,dc(c,L,s))&&R++):P<c&&R++);R<W;++R){const X=Math.round((P+R*F)*j)/j;if(D&&X>d)break;a.push({value:X})}return D&&b&&Q!==d?a.length&&_n(a[a.length-1].value,d,dc(d,L,s))?a[a.length-1].value=d:a.push({value:d}):(!D||Q===d)&&a.push({value:Q}),a}function dc(s,t,{horizontal:a,minRotation:r}){const n=Er(r),l=(a?Math.sin(n):Math.cos(n))||.001,c=.75*t*(""+s).length;return Math.min(t/l,c)}class wh extends mi{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,a){return ls(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:a,maxDefined:r}=this.getUserBounds();let{min:n,max:l}=this;const c=f=>n=a?n:f,d=f=>l=r?l:f;if(t){const f=Or(n),p=Or(l);f<0&&p<0?d(0):f>0&&p>0&&c(0)}if(n===l){let f=l===0?1:Math.abs(l*.05);d(l+f),t||c(n-f)}this.min=n,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:a,stepSize:r}=t,n;return r?(n=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),a=a||11),a&&(n=Math.min(a,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,a=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const n={maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},l=this._range||this,c=yh(n,l);return t.bounds==="ticks"&&_f(c,this,"value"),t.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const t=this.ticks;let a=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const n=(r-a)/Math.max(t.length-1,1)/2;a-=n,r+=n}this._startValue=a,this._endValue=r,this._valueRange=r-a}getLabelForValue(t){return Ao(t,this.chart.options.locale,this.options.ticks.format)}}class jn extends wh{static id="linear";static defaults={ticks:{callback:Hc.formatters.numeric}};determineDataLimits(){const{min:t,max:a}=this.getMinMax(!0);this.min=dr(t)?t:0,this.max=dr(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),a=t?this.width:this.height,r=Er(this.options.ticks.minRotation),n=(t?Math.sin(r):Math.cos(r))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,l.lineHeight/n))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const qn={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ks=Object.keys(qn);function uc(s,t){return s-t}function vc(s,t){if(ls(t))return null;const a=s._adapter,{parser:r,round:n,isoWeekday:l}=s._parseOpts;let c=t;return typeof r=="function"&&(c=r(c)),dr(c)||(c=typeof r=="string"?a.parse(c,r):a.parse(c)),c===null?null:(n&&(c=n==="week"&&(Cn(l)||l===!0)?a.startOf(c,"isoWeek",l):a.startOf(c,n)),+c)}function fc(s,t,a,r){const n=Ks.length;for(let l=Ks.indexOf(s);l<n-1;++l){const c=qn[Ks[l]],d=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((a-t)/(d*c.size))<=r)return Ks[l]}return Ks[n-1]}function xh(s,t,a,r,n){for(let l=Ks.length-1;l>=Ks.indexOf(a);l--){const c=Ks[l];if(qn[c].common&&s._adapter.diff(n,r,c)>=t-1)return c}return Ks[a?Ks.indexOf(a):0]}function Sh(s){for(let t=Ks.indexOf(s)+1,a=Ks.length;t<a;++t)if(qn[Ks[t]].common)return Ks[t]}function pc(s,t,a){if(!a)s[t]=!0;else if(a.length){const{lo:r,hi:n}=So(a,t),l=a[r]>=t?a[r]:a[n];s[l]=!0}}function kh(s,t,a,r){const n=s._adapter,l=+n.startOf(t[0].value,r),c=t[t.length-1].value;let d,f;for(d=l;d<=c;d=+n.add(d,1,r))f=a[d],f>=0&&(t[f].major=!0);return t}function mc(s,t,a){const r=[],n={},l=t.length;let c,d;for(c=0;c<l;++c)d=t[c],n[d]=c,r.push({value:d,major:!1});return l===0||!a?r:kh(s,r,n,a)}class hc extends mi{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,a={}){const r=t.time||(t.time={}),n=this._adapter=new Rp._date(t.adapters.date);n.init(a),Ri(r.displayFormats,n.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=a.normalized}parse(t,a){return t===void 0?null:vc(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,a=this._adapter,r=t.time.unit||"day";let{min:n,max:l,minDefined:c,maxDefined:d}=this.getUserBounds();function f(p){!c&&!isNaN(p.min)&&(n=Math.min(n,p.min)),!d&&!isNaN(p.max)&&(l=Math.max(l,p.max))}(!c||!d)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),n=dr(n)&&!isNaN(n)?n:+a.startOf(Date.now(),r),l=dr(l)&&!isNaN(l)?l:+a.endOf(Date.now(),r)+1,this.min=Math.min(n,l-1),this.max=Math.max(n+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(a=t[0],r=t[t.length-1]),{min:a,max:r}}buildTicks(){const t=this.options,a=t.time,r=t.ticks,n=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const l=this.min,c=this.max,d=Sf(n,l,c);return this._unit=a.unit||(r.autoSkip?fc(a.minUnit,this.min,this.max,this._getLabelCapacity(l)):xh(this,d.length,a.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Sh(this._unit),this.initOffsets(n),t.reverse&&d.reverse(),mc(this,d,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let a=0,r=0,n,l;this.options.offset&&t.length&&(n=this.getDecimalForValue(t[0]),t.length===1?a=1-n:a=(this.getDecimalForValue(t[1])-n)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?r=l:r=(l-this.getDecimalForValue(t[t.length-2]))/2);const c=t.length<3?.5:.25;a=Js(a,0,c),r=Js(r,0,c),this._offsets={start:a,end:r,factor:1/(a+1+r)}}_generate(){const t=this._adapter,a=this.min,r=this.max,n=this.options,l=n.time,c=l.unit||fc(l.minUnit,a,r,this._getLabelCapacity(a)),d=Qa(n.ticks.stepSize,1),f=c==="week"?l.isoWeekday:!1,p=Cn(f)||f===!0,h={};let g=a,b,y;if(p&&(g=+t.startOf(g,"isoWeek",f)),g=+t.startOf(g,p?"day":c),t.diff(r,a,c)>1e5*d)throw new Error(a+" and "+r+" are too far apart with stepSize of "+d+" "+c);const k=n.ticks.source==="data"&&this.getDataTimestamps();for(b=g,y=0;b<r;b=+t.add(b,d,c),y++)pc(h,b,k);return(b===r||n.bounds==="ticks"||y===1)&&pc(h,b,k),Object.keys(h).sort(uc).map(A=>+A)}getLabelForValue(t){const a=this._adapter,r=this.options.time;return r.tooltipFormat?a.format(t,r.tooltipFormat):a.format(t,r.displayFormats.datetime)}format(t,a){const n=this.options.time.displayFormats,l=this._unit,c=a||n[l];return this._adapter.format(t,c)}_tickFormatFunction(t,a,r,n){const l=this.options,c=l.ticks.callback;if(c)return ps(c,[t,a,r],this);const d=l.time.displayFormats,f=this._unit,p=this._majorUnit,h=f&&d[f],g=p&&d[p],b=r[a],y=p&&g&&b&&b.major;return this._adapter.format(t,n||(y?g:h))}generateTickLabels(t){let a,r,n;for(a=0,r=t.length;a<r;++a)n=t[a],n.label=this._tickFormatFunction(n.value,a,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const a=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((a.start+r)*a.factor)}getValueForPixel(t){const a=this._offsets,r=this.getDecimalForPixel(t)/a.factor-a.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const a=this.options.ticks,r=this.ctx.measureText(t).width,n=Er(this.isHorizontal()?a.maxRotation:a.minRotation),l=Math.cos(n),c=Math.sin(n),d=this._resolveTickFontOptions(0).size;return{w:r*l+d*c,h:r*c+d*l}}_getLabelCapacity(t){const a=this.options.time,r=a.displayFormats,n=r[a.unit]||r.millisecond,l=this._tickFormatFunction(t,0,mc(this,[t],this._majorUnit),n),c=this._getLabelSize(l),d=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return d>0?d:1}getDataTimestamps(){let t=this._cache.data||[],a,r;if(t.length)return t;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(a=0,r=n.length;a<r;++a)t=t.concat(n[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let a,r;if(t.length)return t;const n=this.getLabels();for(a=0,r=n.length;a<r;++a)t.push(vc(this,n[a]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Gc(t.sort(uc))}}function gn(s,t,a){let r=0,n=s.length-1,l,c,d,f;a?(t>=s[r].pos&&t<=s[n].pos&&({lo:r,hi:n}=po(s,"pos",t)),{pos:l,time:d}=s[r],{pos:c,time:f}=s[n]):(t>=s[r].time&&t<=s[n].time&&({lo:r,hi:n}=po(s,"time",t)),{time:l,pos:d}=s[r],{time:c,pos:f}=s[n]);const p=c-l;return p?d+(f-d)*(t-l)/p:d}class sD extends hc{static id="timeseries";static defaults=hc.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(t);this._minPos=gn(a,this.min),this._tableRange=gn(a,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:a,max:r}=this,n=[],l=[];let c,d,f,p,h;for(c=0,d=t.length;c<d;++c)p=t[c],p>=a&&p<=r&&n.push(p);if(n.length<2)return[{time:a,pos:0},{time:r,pos:1}];for(c=0,d=n.length;c<d;++c)h=n[c+1],f=n[c-1],p=n[c],Math.round((h+f)/2)!==p&&l.push({time:p,pos:c/(d-1)});return l}_generate(){const t=this.min,a=this.max;let r=super.getDataTimestamps();return(!r.includes(t)||!r.length)&&r.splice(0,0,t),(!r.includes(a)||r.length===1)&&r.push(a),r.sort((n,l)=>n-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const a=this.getDataTimestamps(),r=this.getLabelTimestamps();return a.length&&r.length?t=this.normalize(a.concat(r)):t=a.length?a:r,t=this._cache.all=t,t}getDecimalForValue(t){return(gn(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const a=this._offsets,r=this.getDecimalForPixel(t)/a.factor-a.end;return gn(this._table,r*this._tableRange+this._minPos,!0)}}var Ah=_('<div class="chart-empty svelte-nvktxc"><span class="material-symbols-outlined svelte-nvktxc">show_chart</span> <p class="svelte-nvktxc">No assessment data available</p></div>'),Dh=_('<canvas class="svelte-nvktxc"></canvas>'),Ch=_('<div class="chart-container svelte-nvktxc"><!></div>');function Th(s,t){qa(t,!0),cr.register(Mn,Rn,On,jn,Yi,Hi,Ui);let a=Ma(t,"subjects",19,()=>[]),r=ut(void 0),n;function l(){if(!e(r)||!a()||a().length===0)return;n&&n.destroy();const g=a().filter(C=>C.numericGrade>0&&C.verified);if(g.length===0)return;const b=g.map(C=>C.name),y=g.map(C=>C.writtenWork||0),k=g.map(C=>C.performanceTasks||0),A=g.map(C=>C.quarterlyAssessment||0),T=e(r).getContext("2d");n=new cr(T,{type:"bar",data:{labels:b,datasets:[{label:"Written Work",data:y,backgroundColor:"rgba(33, 150, 243, 1.0)",borderColor:"rgb(33, 150, 243)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9},{label:"Performance Tasks",data:k,backgroundColor:"rgba(156, 39, 176, 1.0)",borderColor:"rgb(156, 39, 176)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9},{label:"Quarterly Assessment",data:A,backgroundColor:"rgba(255, 152, 0, 1.0)",borderColor:"rgb(255, 152, 0)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"top",labels:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:15,font:{size:13,weight:"600"},usePointStyle:!0,pointStyle:"circle",boxWidth:10,boxHeight:10}},title:{display:!0,text:"Assessment Type Performance Comparison",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{backgroundColor:"rgba(30, 30, 30, 0.95)",padding:16,cornerRadius:12,titleFont:{size:15,weight:"600",family:"'Inter', 'Segoe UI', sans-serif"},bodyFont:{size:14,weight:"500",family:"'Inter', 'Segoe UI', sans-serif"},titleColor:"#ffffff",bodyColor:"#e0e0e0",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!0,usePointStyle:!0,pointStyle:"circle",boxWidth:8,boxHeight:8,boxPadding:6,titleMarginBottom:10,bodySpacing:8,multiKeyBackground:"transparent",callbacks:{label(C){const D=C.dataset.label||"",S=C.parsed.y;let L="",F="";return S>=85?(L="Excellent",F=""):S>=80?(L="Good",F=""):S>=75?(L="Satisfactory",F=""):S>0&&(L="Needs Improvement",F=""),L?`${D}: ${S.toFixed(1)}% ${F} ${L}`:`${D}: ${S.toFixed(1)}%`}}}},scales:{y:{beginAtZero:!0,max:100,grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim(),lineWidth:1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:8,callback(C){return C+"%"}},title:{display:!0,text:"Grade (%)",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"600"}}},x:{grid:{display:!1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},maxRotation:0,minRotation:0,autoSkip:!1}}}}})}function c(){n&&l()}Ya(()=>{a()&&a().length>0&&l();const g=new MutationObserver(b=>{b.forEach(y=>{y.type==="attributes"&&y.attributeName==="data-theme"&&c()})});return g.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{g.disconnect()}}),ei(()=>{n&&n.destroy()}),Es(()=>{a()&&e(r)&&l()});var d=Ch(),f=o(d);{var p=g=>{var b=Ah();m(g,b)},h=g=>{var b=Dh();Ws(b,y=>v(r,y),()=>e(r)),m(g,b)};E(f,g=>{a().filter(b=>b.numericGrade>0&&b.verified).length===0?g(p):g(h,!1)})}i(d),m(s,d),za()}var Eh=_('<div class="chart-empty svelte-nvktxc"><span class="material-symbols-outlined svelte-nvktxc">analytics</span> <p class="svelte-nvktxc">No grade data available</p></div>'),Fh=_('<canvas class="svelte-nvktxc"></canvas>'),Nh=_('<div class="chart-container svelte-nvktxc"><!></div>');function $h(s,t){qa(t,!0),cr.register(Mn,Rn,On,jn,Yi,Hi,Ui);let a=Ma(t,"subjects",19,()=>[]),r=ut(void 0),n;function l(){if(!e(r)||!a()||a().length===0)return;n&&n.destroy();const g=a().filter(F=>F.numericGrade>0&&F.verified);if(g.length===0)return;const b=g.map(F=>F.name),y=g.map(F=>F.numericGrade),k=y.map(F=>F>=85?"rgba(76, 175, 80, 1.0)":F>=80?"rgba(33, 150, 243, 1.0)":F>=75?"rgba(255, 152, 0, 1.0)":"rgba(244, 67, 54, 1.0)"),A=y.map(F=>F>=85?"rgb(76, 175, 80)":F>=80?"rgb(33, 150, 243)":F>=75?"rgb(255, 152, 0)":"rgb(244, 67, 54)"),T=g.length;let C,D,S;T<=3?(C=50,D=.6,S=.7):T<=6?(C=40,D=.7,S=.75):T<=10?(C=30,D=.8,S=.85):(C=20,D=.9,S=.9);const L=e(r).getContext("2d");n=new cr(L,{type:"bar",data:{labels:b,datasets:[{label:"Grade",data:y,backgroundColor:k,borderColor:A,borderWidth:2,borderRadius:8,maxBarThickness:C,categoryPercentage:D,barPercentage:S}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Subject Performance Overview",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{backgroundColor:"rgba(30, 30, 30, 0.95)",padding:16,cornerRadius:12,titleFont:{size:15,weight:"600",family:"'Inter', 'Segoe UI', sans-serif"},bodyFont:{size:14,weight:"500",family:"'Inter', 'Segoe UI', sans-serif"},titleColor:"#ffffff",bodyColor:"#e0e0e0",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!1,titleMarginBottom:8,bodySpacing:6,callbacks:{label(F){const j=F.parsed.x;let P="",Q="";return j>=85?(P="Excellent",Q=""):j>=80?(P="Good",Q=""):j>=75?(P="Satisfactory",Q=""):(P="Needs Improvement",Q=""),`${Q} ${j.toFixed(1)}% - ${P}`}}}},scales:{x:{beginAtZero:!0,max:100,grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim(),lineWidth:1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:8,callback(F){return F+"%"}},title:{display:!0,text:"Grade (%)",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"600"}}},y:{grid:{display:!1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:10}}}}})}function c(){n&&l()}Ya(()=>{a()&&a().length>0&&l();const g=new MutationObserver(b=>{b.forEach(y=>{y.type==="attributes"&&y.attributeName==="data-theme"&&c()})});return g.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{g.disconnect()}}),ei(()=>{n&&n.destroy()}),Es(()=>{a()&&e(r)&&l()});var d=Nh(),f=o(d);{var p=g=>{var b=Eh();m(g,b)},h=g=>{var b=Fh();Ws(b,y=>v(r,y),()=>e(r)),m(g,b)};E(f,g=>{a().filter(b=>b.numericGrade>0&&b.verified).length===0?g(p):g(h,!1)})}i(d),m(s,d),za()}function Ph(s,t){or(t)}function Lh(s,t){e(t)>1&&or(t,-1)}var Mh=_('<div class="analysis-loading svelte-zopb0m"><div class="system-loader"></div> <p>Generating your personalized analysis...</p></div>'),Ih=_('<div class="analysis-error svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">error</span> <div class="error-content svelte-zopb0m"><h4 class="svelte-zopb0m">Unable to Generate Analysis</h4> <p class="svelte-zopb0m"> </p></div></div>'),Rh=_('<div class="analysis-section svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">psychology</span> <span>Overview</span></div> <p class="section-text svelte-zopb0m"> </p></div>'),Oh=_('<div class="change-item svelte-zopb0m"><div class="change-header svelte-zopb0m"><span class="change-subject svelte-zopb0m"> </span> <span> </span></div> <p class="change-observation svelte-zopb0m"> </p></div>'),jh=_('<div class="notable-changes svelte-zopb0m"><h4 class="subsection-title svelte-zopb0m">Notable Changes:</h4> <!></div>'),qh=_('<div class="analysis-section quarter-comparison svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m"><!></span> <span>Progress from Last Quarter</span> <span> </span></div> <p class="section-text svelte-zopb0m"> </p> <!></div>'),zh=_('<div class="item-row svelte-zopb0m"><div class="item-top svelte-zopb0m"><span class="item-name svelte-zopb0m"> </span> <span class="item-value svelte-zopb0m"> </span></div> <p class="item-text svelte-zopb0m"> </p></div>'),Gh=_('<div class="analysis-section svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">emoji_events</span> <span>Strengths</span></div> <!></div>'),Vh=_('<div class="item-row svelte-zopb0m"><div class="item-top svelte-zopb0m"><span class="item-name svelte-zopb0m"> </span> <span class="item-value svelte-zopb0m"> </span></div> <p class="item-text svelte-zopb0m"> </p> <p class="item-note svelte-zopb0m"> </p></div>'),Bh=_('<div class="analysis-section svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">trending_up</span> <span>Areas for Growth</span></div> <!></div>'),Wh=_('<div class="assessment-item svelte-zopb0m"><div class="assessment-top svelte-zopb0m"><span class="assessment-name svelte-zopb0m">Written Work</span> <span class="assessment-value svelte-zopb0m"> </span></div> <p class="assessment-text svelte-zopb0m"> </p></div>'),Hh=_('<div class="assessment-item svelte-zopb0m"><div class="assessment-top svelte-zopb0m"><span class="assessment-name svelte-zopb0m">Performance Tasks</span> <span class="assessment-value svelte-zopb0m"> </span></div> <p class="assessment-text svelte-zopb0m"> </p></div>'),Uh=_('<div class="assessment-item svelte-zopb0m"><div class="assessment-top svelte-zopb0m"><span class="assessment-name svelte-zopb0m">Quarterly Assessment</span> <span class="assessment-value svelte-zopb0m"> </span></div> <p class="assessment-text svelte-zopb0m"> </p></div>'),Yh=_('<div class="analysis-section svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">analytics</span> <span>Assessment Breakdown</span></div> <div class="assessment-row svelte-zopb0m"><!> <!> <!></div> <div class="charts-section svelte-zopb0m"><!> <!></div></div>'),Qh=_('<div class="item-row action-row svelte-zopb0m"><h4 class="action-name svelte-zopb0m"> </h4> <p class="item-text svelte-zopb0m"> </p> <p class="item-note svelte-zopb0m"> </p></div>'),Kh=_('<div class="analysis-section svelte-zopb0m"><div class="section-title svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">checklist</span> <span>Action Plan</span></div> <!></div>'),Jh=_('<button class="show-more-btn svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">expand_more</span> <span>Show More</span></button>'),Xh=_('<button class="show-more-btn svelte-zopb0m"><span class="material-symbols-outlined svelte-zopb0m">expand_less</span> <span>Show Less</span></button>'),Zh=_('<!> <!> <!> <!>  <!> <!> <div class="ai-action-buttons svelte-zopb0m"><!> <!></div>',1),eg=_('<div class="ai-analysis-display svelte-zopb0m"><!></div>');function tg(s,t){qa(t,!0);let a=Ma(t,"analysisData",3,null),r=Ma(t,"isLoading",3,!1),n=Ma(t,"error",3,null),l=Ma(t,"subjects",19,()=>[]),c=ut(0),d=Xs([]),f=ut(0);Es(()=>{r()&&v(c,0)}),Es(()=>{a()&&!r()&&e(c)===0&&Xo().then(()=>{setTimeout(()=>{v(c,1)},50)})}),Es(()=>{e(c)>e(f)&&e(c)>1&&Xo().then(()=>{setTimeout(()=>{const A=e(c)-1,T=d[A];T&&T.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}),v(f,e(c),!0)});let p=ea(()=>a()?1+(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+(a().actionPlan&&a().actionPlan.length>0?1:0):0),h=ea(()=>e(c)>=e(p));var g=eg(),b=o(g);{var y=A=>{var T=Mh();m(A,T)},k=A=>{var T=mt(),C=Je(T);{var D=L=>{var F=Ih(),j=u(o(F),2),P=u(o(j),2),Q=o(P,!0);i(P),i(j),i(F),q(()=>w(Q,n())),m(L,F)},S=L=>{var F=mt(),j=Je(F);{var P=Q=>{const W=ea(()=>(a().quarterComparison?1:0)+2+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1),$=ea(()=>(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1);var R=Zh(),X=Je(R);{var se=Te=>{var ue=Rh(),be=u(o(ue),2),ke=o(be,!0);i(be),i(ue),Ws(ue,Fe=>d[0]=Fe,()=>d?.[0]),q(()=>w(ke,a().overallInsight)),es(1,ue,()=>Vs,()=>({y:-20,duration:400,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(X,Te=>{e(c)>=1&&Te(se)})}var V=u(X,2);{var re=Te=>{var ue=qh(),be=o(ue),ke=o(be),Fe=o(ke);{var Re=Y=>{var ce=Sa("trending_up");m(Y,ce)},et=Y=>{var ce=mt(),De=Je(ce);{var U=fe=>{var z=Sa("trending_down");m(fe,z)},ne=fe=>{var z=Sa("trending_flat");m(fe,z)};E(De,fe=>{a().quarterComparison.overallTrend==="declined"?fe(U):fe(ne,!1)},!0)}m(Y,ce)};E(Fe,Y=>{a().quarterComparison.overallTrend==="improved"?Y(Re):Y(et,!1)})}i(ke);var $e=u(ke,4),ot=o($e);i($e),i(be);var Me=u(be,2),it=o(Me,!0);i(Me);var ft=u(Me,2);{var Ye=Y=>{var ce=jh(),De=u(o(ce),2);xt(De,17,()=>a().quarterComparison.notableChanges,Ua,(U,ne,fe)=>{var z=Oh(),B=o(z),I=o(B),G=o(I,!0);i(I);var Z=u(I,2),le=o(Z);i(Z),i(B);var N=u(B,2),M=o(N,!0);i(N),i(z),q(()=>{w(G,e(ne).subject),_e(Z,1,`change-value ${e(ne).change>0?"positive":e(ne).change<0?"negative":"neutral"}`,"svelte-zopb0m"),w(le,`${e(ne).change>0?"+":""}${e(ne).change??""}`),w(M,e(ne).observation)}),es(1,z,()=>Vs,()=>({y:-10,duration:350,delay:100+fe*60,easing:Bs})),es(2,z,()=>Gs,()=>({duration:200})),m(U,z)}),i(ce),m(Y,ce)};E(ft,Y=>{a().quarterComparison.notableChanges&&a().quarterComparison.notableChanges.length>0&&Y(Ye)})}i(ue),Ws(ue,Y=>d[1]=Y,()=>d?.[1]),q(()=>{_e($e,1,`trend-badge ${a().quarterComparison.overallTrend??""}`,"svelte-zopb0m"),w(ot,`${a().quarterComparison.changeAmount>0?"+":""}${a().quarterComparison.changeAmount??""}`),w(it,a().quarterComparison.insight)}),es(1,ue,()=>Vs,()=>({y:-20,duration:400,delay:50,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(V,Te=>{a().quarterComparison&&e(c)>=2&&Te(re)})}var me=u(V,2);{var je=Te=>{var ue=Gh(),be=u(o(ue),2);xt(be,17,()=>a().strengths,Ua,(ke,Fe,Re)=>{var et=zh(),$e=o(et),ot=o($e),Me=o(ot,!0);i(ot);var it=u(ot,2),ft=o(it,!0);i(it),i($e);var Ye=u($e,2),Y=o(Ye,!0);i(Ye),i(et),q(ce=>{w(Me,e(Fe).subject),w(ft,ce),w(Y,e(Fe).reason)},[()=>e(Fe).score.toFixed(1)]),es(1,et,()=>Vs,()=>({y:-10,duration:350,delay:100+Re*80,easing:Bs})),es(2,et,()=>Gs,()=>({duration:200})),m(ke,et)}),i(ue),Ws(ue,ke=>d[a().quarterComparison?2:1]=ke,()=>d?.[a().quarterComparison?2:1]),es(1,ue,()=>Vs,()=>({y:-20,duration:400,delay:50,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(me,Te=>{e(c)>=(a().quarterComparison?3:2)&&Te(je)})}var de=u(me,2);{var ie=Te=>{const ue=ea(()=>a().quarterComparison?4:3),be=ea(()=>a().quarterComparison?3:2);var ke=mt(),Fe=Je(ke);{var Re=et=>{var $e=Bh(),ot=u(o($e),2);xt(ot,17,()=>a().areasForGrowth,Ua,(Me,it,ft)=>{var Ye=Vh(),Y=o(Ye),ce=o(Y),De=o(ce,!0);i(ce);var U=u(ce,2),ne=o(U,!0);i(U),i(Y);var fe=u(Y,2),z=o(fe,!0);i(fe);var B=u(fe,2),I=o(B,!0);i(B),i(Ye),q(G=>{w(De,e(it).subject),w(ne,G),w(z,e(it).currentGap),w(I,e(it).potential)},[()=>e(it).score.toFixed(1)]),es(1,Ye,()=>Vs,()=>({y:-10,duration:350,delay:100+ft*80,easing:Bs})),es(2,Ye,()=>Gs,()=>({duration:200})),m(Me,Ye)}),i($e),Ws($e,Me=>d[e(be)]=Me,()=>d?.[e(be)]),es(1,$e,()=>Vs,()=>({y:-20,duration:400,delay:100,easing:Bs})),es(2,$e,()=>Gs,()=>({duration:200})),m(et,$e)};E(Fe,et=>{e(c)>=e(ue)&&et(Re)})}m(Te,ke)};E(de,Te=>{a().areasForGrowth&&a().areasForGrowth.length>0&&Te(ie)})}var Pe=u(de,2);{var Ve=Te=>{var ue=Yh(),be=u(o(ue),2),ke=o(be);{var Fe=Ye=>{var Y=Wh(),ce=o(Y),De=u(o(ce),2),U=o(De);i(De),i(ce);var ne=u(ce,2),fe=o(ne,!0);i(ne),i(Y),q(z=>{w(U,`${z??""}%`),w(fe,a().assessmentInsights.writtenWork.insight)},[()=>a().assessmentInsights.writtenWork.average.toFixed(1)]),es(1,Y,()=>Vs,()=>({y:-10,duration:350,delay:100,easing:Bs})),es(2,Y,()=>Gs,()=>({duration:200})),m(Ye,Y)};E(ke,Ye=>{a().assessmentInsights.writtenWork&&Ye(Fe)})}var Re=u(ke,2);{var et=Ye=>{var Y=Hh(),ce=o(Y),De=u(o(ce),2),U=o(De);i(De),i(ce);var ne=u(ce,2),fe=o(ne,!0);i(ne),i(Y),q(z=>{w(U,`${z??""}%`),w(fe,a().assessmentInsights.performanceTasks.insight)},[()=>a().assessmentInsights.performanceTasks.average.toFixed(1)]),es(1,Y,()=>Vs,()=>({y:-10,duration:350,delay:180,easing:Bs})),es(2,Y,()=>Gs,()=>({duration:200})),m(Ye,Y)};E(Re,Ye=>{a().assessmentInsights.performanceTasks&&Ye(et)})}var $e=u(Re,2);{var ot=Ye=>{var Y=Uh(),ce=o(Y),De=u(o(ce),2),U=o(De);i(De),i(ce);var ne=u(ce,2),fe=o(ne,!0);i(ne),i(Y),q(z=>{w(U,`${z??""}%`),w(fe,a().assessmentInsights.quarterlyAssessment.insight)},[()=>a().assessmentInsights.quarterlyAssessment.average.toFixed(1)]),es(1,Y,()=>Vs,()=>({y:-10,duration:350,delay:260,easing:Bs})),es(2,Y,()=>Gs,()=>({duration:200})),m(Ye,Y)};E($e,Ye=>{a().assessmentInsights.quarterlyAssessment&&Ye(ot)})}i(be);var Me=u(be,2),it=o(Me);Th(it,{get subjects(){return l()}});var ft=u(it,2);$h(ft,{get subjects(){return l()}}),i(Me),i(ue),Ws(ue,Ye=>d[e($)]=Ye,()=>d?.[e($)]),es(1,ue,()=>Vs,()=>({y:-20,duration:400,delay:150,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(Pe,Te=>{e(c)>=e(W)&&Te(Ve)})}var Ze=u(Pe,2);{var ve=Te=>{const ue=ea(()=>(a().quarterComparison?1:0)+2+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+1),be=ea(()=>(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+1);var ke=mt(),Fe=Je(ke);{var Re=et=>{var $e=Kh(),ot=u(o($e),2);xt(ot,17,()=>a().actionPlan,Ua,(Me,it,ft)=>{var Ye=Qh();Wa(Ye,`--action-index: ${ft};`);var Y=o(Ye),ce=o(Y,!0);i(Y);var De=u(Y,2),U=o(De,!0);i(De);var ne=u(De,2),fe=o(ne,!0);i(ne),i(Ye),q(()=>{w(ce,e(it).title),w(U,e(it).description),w(fe,e(it).expectedImpact)}),es(1,Ye,()=>Vs,()=>({y:-10,duration:350,delay:100+ft*80,easing:Bs})),es(2,Ye,()=>Gs,()=>({duration:200})),m(Me,Ye)}),i($e),Ws($e,Me=>d[e(be)]=Me,()=>d?.[e(be)]),es(1,$e,()=>Vs,()=>({y:-20,duration:400,delay:200,easing:Bs})),es(2,$e,()=>Gs,()=>({duration:200})),m(et,$e)};E(Fe,et=>{e(c)>=e(ue)&&et(Re)})}m(Te,ke)};E(Ze,Te=>{a().actionPlan&&a().actionPlan.length>0&&Te(ve)})}var Ce=u(Ze,2),Qe=o(Ce);{var Xe=Te=>{var ue=Jh();ue.__click=[Ph,c],es(1,ue,()=>Vs,()=>({y:20,duration:400,delay:100,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(Qe,Te=>{e(h)||Te(Xe)})}var ze=u(Qe,2);{var We=Te=>{var ue=Xh();ue.__click=[Lh,c],es(1,ue,()=>Vs,()=>({y:20,duration:400,delay:100,easing:Bs})),es(2,ue,()=>Gs,()=>({duration:200})),m(Te,ue)};E(ze,Te=>{e(c)>1&&Te(We)})}i(Ce),m(Q,R)};E(j,Q=>{a()&&Q(P)},!0)}m(L,F)};E(C,L=>{n()?L(D):L(S,!1)},!0)}m(A,T)};E(b,A=>{r()?A(y):A(k,!1)})}i(g),m(s,g),za()}Ps(["click"]);const ag=300*1e3,gc="student_grades_",_c="student_ai_analysis_",sg=10080*60*1e3;function rg(){const s={grades:[],statistics:{overallAverage:0,totalSubjects:0},sectionInfo:null,classRank:null,totalStudentsInSection:0,currentQuarter:2,currentQuarterName:"2nd Quarter",currentSchoolYear:"2025-2026",isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null,previousQuarterAverage:null,averageChange:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null},{subscribe:t,set:a,update:r}=Hs(s);function n(){const $=_o(gs);if(!$?.isAuthenticated||!$.userData)return{};const R={id:$.userData.id,name:$.userData.name,account_number:$.userData.accountNumber,account_type:$.userData.account_type||$.userData.accountType};return{"x-user-info":JSON.stringify(R)}}function l($,R,X){return`${gc}${$}_${R}_${X}`}function c($){return!$||!$.timestamp?!1:Date.now()-$.timestamp<ag}function d($,R,X){try{const se=l($,R,X),V=localStorage.getItem(se);if(V)return JSON.parse(V).data}catch(se){console.warn("Failed to retrieve cached student grades data:",se)}return null}function f($,R,X){try{const se=l($,R,X),V=localStorage.getItem(se);if(V){const re=JSON.parse(V);if(c(re))return re.data}}catch(se){console.warn("Failed to retrieve cached student grades data:",se)}return null}function p($,R,X,se){try{const V=l($,R,X),re={data:se,timestamp:Date.now()};localStorage.setItem(V,JSON.stringify(re))}catch(V){console.warn("Failed to cache student grades data:",V)}}async function h(){try{const R=await(await fetch("/api/current-quarter",{headers:n()})).json();if(R.success&&R.data)return{currentQuarter:R.data.currentQuarter,currentQuarterName:R.data.quarterName,currentSchoolYear:R.data.currentSchoolYear}}catch($){console.error("Error fetching current quarter/school year:",$)}return{currentQuarter:2,currentQuarterName:"2nd Quarter",currentSchoolYear:"2025-2026"}}async function g($){try{const X=await(await fetch(`/api/student-profile?studentId=${$}`,{headers:n()})).json();if(X.success){const{section:se}=X.data;return{sectionInfo:se}}}catch(R){console.error("Error fetching student profile:",R)}return{sectionInfo:null}}async function b($,R,X){try{const V=await(await fetch(`/api/class-rankings?studentId=${$}&quarter=${R}&schoolYear=${X}`,{headers:n()})).json();if(V.success)return{classRank:V.myRank,totalStudentsInSection:V.totalStudents}}catch(se){console.error("Error fetching class rank:",se)}return{classRank:null,totalStudentsInSection:0}}async function y($,R,X){try{let se=R-1,V=X;if(se<1){se=4;const[je,de]=X.split("-").map(ie=>parseInt(ie));V=`${je-1}-${de-1}`}const me=await(await fetch(`/api/student-grades?student_id=${$}&quarter=${se}&school_year=${V}`,{headers:n()})).json();if(me.success&&me.data.statistics)return me.data.statistics.overallAverage||null}catch(se){console.error("Error fetching previous quarter average:",se)}return null}async function k($,R=null,X=null,se=!1){try{r(Ze=>({...Ze,isLoading:!se,isRefreshing:se,error:null,currentStudentId:$}));let V;!R||!X?(V=await h(),R=R||V.currentQuarter,X=X||V.currentSchoolYear):V={currentQuarter:R,currentQuarterName:`${R}${R===1?"st":R===2?"nd":R===3?"rd":"th"} Quarter`,currentSchoolYear:X};const[re,me,je,de]=await Promise.all([fetch(`/api/student-grades?student_id=${$}&quarter=${R}&school_year=${X}`,{headers:n()}).then(Ze=>Ze.json()),g($),b($,R,X),y($,R,X)]);if(!re.success)throw new Error(re.error||"Failed to fetch grades data");const ie=re.data.statistics?.overallAverage||0;let Pe=null;de!==null&&ie>0&&(Pe=ie-de);const Ve={grades:re.data.grades||[],statistics:re.data.statistics||{overallAverage:0,totalSubjects:0},sectionInfo:me.sectionInfo,classRank:je.classRank,totalStudentsInSection:je.totalStudentsInSection,currentQuarter:R,currentQuarterName:V.currentQuarterName,currentSchoolYear:X,previousQuarterAverage:de,averageChange:Pe,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString(),currentStudentId:$};r(Ze=>({...Ze,...Ve})),p($,R,X,{grades:Ve.grades,statistics:Ve.statistics,sectionInfo:Ve.sectionInfo,classRank:Ve.classRank,totalStudentsInSection:Ve.totalStudentsInSection,currentQuarter:R,currentQuarterName:V.currentQuarterName,currentSchoolYear:X,previousQuarterAverage:Ve.previousQuarterAverage,averageChange:Ve.averageChange,lastUpdated:Ve.lastUpdated})}catch(V){console.error("Error loading student grades:",V);const re=d($,R,X);re?(r(me=>({...me,grades:re.grades||[],statistics:re.statistics||{overallAverage:0,totalSubjects:0},sectionInfo:re.sectionInfo,classRank:re.classRank,totalStudentsInSection:re.totalStudentsInSection,currentQuarter:re.currentQuarter,currentQuarterName:re.currentQuarterName,currentSchoolYear:re.currentSchoolYear,previousQuarterAverage:re.previousQuarterAverage,averageChange:re.averageChange,lastUpdated:re.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Se.error("No internet connection. Showing offline data.")):r(me=>({...me,isLoading:!1,isRefreshing:!1,error:V.message,grades:[],statistics:{overallAverage:0,totalSubjects:0},previousQuarterAverage:null,averageChange:null}))}}function A($,R=null,X=null){let se;if(t(re=>{se=re.currentStudentId})(),se&&se!==$&&r(re=>({...re,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!R||!X)return h().then(re=>{const me=f($,re.currentQuarter,re.currentSchoolYear);r(me?je=>({...je,...me,currentStudentId:$,isLoading:!1,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}):je=>({...je,currentStudentId:$,currentQuarter:re.currentQuarter,currentQuarterName:re.currentQuarterName,currentSchoolYear:re.currentSchoolYear,isLoading:!0,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}))}),!1;const V=f($,R,X);return V?(r(re=>({...re,...V,currentStudentId:$,isLoading:!1,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!0):(r(re=>({...re,currentStudentId:$,currentQuarter:R,currentSchoolYear:X,isLoading:!0,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!1)}async function T($,R,X){const se=f($,R,X);se&&r(V=>({...V,...se,currentStudentId:$,isLoading:!1,isRefreshing:!1,error:null})),await k($,R,X,!!se)}function C($,R,X){try{const se=l($,R,X);localStorage.removeItem(se)}catch(se){console.warn("Failed to clear student grades cache:",se)}return r(se=>({...s,currentStudentId:$,currentQuarter:R,currentSchoolYear:X,isLoading:!0})),W.loadGrades($,R,X,!1)}function D($){try{const R=Object.keys(localStorage),X=`${gc}${$}_`,se=`${_c}${$}_`;R.forEach(V=>{(V.startsWith(X)||V.startsWith(se))&&localStorage.removeItem(V)})}catch(R){console.warn("Failed to clear all cache:",R)}}function S($,R,X){return`${_c}${$}_${R}_${X}`}function L($,R,X){try{const se=S($,R,X),V=localStorage.getItem(se);if(V){const re=JSON.parse(V);if(Date.now()-re.timestamp<sg)return re.data}}catch(se){console.warn("Failed to retrieve cached AI analysis:",se)}return null}function F($,R,X,se){try{const V=S($,R,X),re={data:se,timestamp:Date.now()};localStorage.setItem(V,JSON.stringify(re))}catch(V){console.warn("Failed to cache AI analysis:",V)}}async function j($,R,X,se=!1){try{r(ie=>({...ie,aiAnalysisLoading:!0,aiAnalysisError:null}));let V=null,re=R-1,me=X;if(re<1){re=4;const[ie,Pe]=X.split("-").map(Ve=>parseInt(Ve));me=`${ie-1}-${Pe-1}`}if(V={quarter:re,schoolYear:me},!se){const ie=L($,R,X);if(ie)return console.log("AI Analysis: Using localStorage cache"),r(Pe=>({...Pe,aiAnalysis:ie,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),ie}const je=new AbortController,de=setTimeout(()=>je.abort(),9e4);try{const ie=await fetch("/api/ai-grade-analysis",{method:"POST",headers:{"Content-Type":"application/json",...n()},body:JSON.stringify({studentId:$,quarter:R,schoolYear:X,forceRefresh:se,previousQuarterInfo:V}),signal:je.signal});if(clearTimeout(de),!ie.ok)throw new Error("Failed to fetch AI analysis");const Pe=ie.body.getReader(),Ve=new TextDecoder;let Ze="";for(;;){const{value:Ce,done:Qe}=await Pe.read();if(Qe)break;Ze+=Ve.decode(Ce,{stream:!0})}const ve=JSON.parse(Ze);if(!ve||!ve.overallInsight)throw new Error("Invalid analysis data structure");return F($,R,X,ve),console.log("AI Analysis: Cached to localStorage and database"),r(Ce=>({...Ce,aiAnalysis:ve,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),ve}catch(ie){throw clearTimeout(de),ie.name==="AbortError"?new Error("AI analysis is taking longer than expected. Please try again."):ie}}catch(V){console.error("Error loading AI analysis:",V);const re=L($,R,X);if(re)return r(me=>({...me,aiAnalysis:re,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),re;throw r(me=>({...me,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:V.message,aiAnalysisTimestamp:null})),V}}function P(){r($=>({...$,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}))}function Q($,R,X){const se=L($,R,X);return se?(r(V=>({...V,aiAnalysis:se,aiAnalysisTimestamp:Date.now()})),!0):!1}const W={subscribe:t,init:A,loadGrades:k,changeQuarter:T,forceRefresh:C,clearAllCache:D,getCachedData:($,R,X)=>d($,R,X),loadAiAnalysis:j,clearAiAnalysis:P,initAiAnalysis:Q,getCachedAiAnalysis:($,R,X)=>L($,R,X)};return W}const yr=rg();var ig=_("<button> </button>"),ng=_('<div class="dropdown-menu-quarter"></div>'),og=_('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),lg=_('<div class="performance-subtitle"> </div>'),cg=_('<div class="grade-comparison no-grades"><span class="material-symbols-outlined comparison-icon">pending</span> <span class="comparison-text">No Grades Yet</span></div>'),dg=_('<div><span class="material-symbols-outlined comparison-icon"><!></span> <span class="comparison-text"><!> from last quarter</span></div>'),ug=_('<div class="grade-comparison first-quarter"><span class="material-symbols-outlined comparison-icon">rocket_launch</span> <span class="comparison-text"> </span></div>'),vg=_('<span class="badge-text"> </span>'),fg=_('<span class="badge-text"> </span>'),pg=_('<div class="performance-stats"><div class="grade-stat-item primary" style="--stat-index: 0;"><div class="stat-header"><div class="stat-label">Quarter Average</div> <div class="stat-icon"><span class="material-symbols-outlined">star</span></div></div> <div class="grade-stat-value"><!></div> <!></div> <div class="grade-stat-item secondary" style="--stat-index: 1;"><div class="stat-header"><div class="stat-label">Total Subjects</div> <div class="stat-icon"><span class="material-symbols-outlined">school</span></div></div> <div class="grade-stat-value"><!></div> <div class="grade-info-badge"><span class="material-symbols-outlined badge-icon">verified</span> <!></div></div> <div class="grade-stat-item tertiary" style="--stat-index: 2;"><div class="stat-header"><div class="stat-label">Class Rank</div> <div class="stat-icon"><span class="material-symbols-outlined">crown</span></div></div> <div class="grade-stat-value">Rank <!></div> <div class="grade-info-badge"><span class="material-symbols-outlined badge-icon">groups</span> <!></div></div></div>'),mg=_('<button class="ai-refresh-btn" title="Refresh analysis"><span class="material-symbols-outlined">refresh</span></button>'),hg=_('<span class="material-symbols-outlined">expand_less</span> <span>Hide Analysis</span>',1),gg=_('<span class="material-symbols-outlined">auto_awesome</span> <span>Get AI Analysis</span>',1),_g=_('<div class="analysis-display-container"><!></div>'),bg=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your grades...</p></div>'),yg=_('<div class="no-subjects"><span class="material-symbols-outlined">school</span> <p> </p> <small>Grades will appear here once they are verified by your teachers</small></div>'),wg=_('<div class="progress-fill progress-fill-animated"></div>'),xg=_("<span> </span>"),Sg=_('<span class="unverified-indicator" title="Grade not yet verified">*</span>'),kg=_("<!> <!>",1),Ag=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Dg=_('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">edit</span> <span>Written Work</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Cg=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Tg=_('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">assignment</span> <span>Performance Tasks</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Eg=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Fg=_('<div class="breakdown-category quarterly-assessment-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">quiz</span> <span>Quarterly Assessment</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Ng=_('<div class="grade-breakdown-section"><div class="breakdown-container"><!> <!> <!></div></div>'),$g=_('<div class="subject-accordion"><div><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p> </p> <div class="progress-bar"><!></div></div> <div class="grade-column"><div class="grade-large"><!></div> <div> </div></div></div> <!></div>'),Pg=_('<div class="subjects-grid"></div>'),Lg=_('<div class="performance-card"><div class="performance-header"><div class="performance-title-section"><div class="performance-title-content"><h2 class="performance-title">Academic Performance</h2> <!></div> <button class="refresh-data-btn" title="Refresh data from database"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div> <div class="ai-analysis-section"><div class="analysis-section-header"><div class="analysis-title-group"><span class="material-symbols-outlined">psychology</span> <h2 class="section-title">AI Performance Insights</h2></div> <div class="analysis-controls"><!> <button><!></button></div></div> <!></div> <div class="subjects-section"><h2 class="section-title">Subject Performance</h2> <!></div>',1),Mg=_('<div class="grades-container"><div class="grades-header"><div class="header-content"><h1 class="page-title">My Grades</h1> <p class="page-subtitle">Academic Performance Overview</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function Ig(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(yr,"$studentGradeStore",a),l=()=>Ja(gs,"$authStore",a),c=O(),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=O(),k=O(),A=O(),T=O(),C=O(),D=O(),S=O(),L=O(),F=O(),j=O(),P=O(),Q=O();let W=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],$=O(!1),R=O(new Set),X=O(!1),se=O(null),V=O({}),re={};const me={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};function je(){v($,!e($))}async function de(G){v($,!1),yr.clearAiAnalysis(),v(X,!1),Object.values(re).forEach(le=>{le&&cancelAnimationFrame(le)}),re={},v(V,{});const Z=me[G];l().userData?.id&&await yr.changeQuarter(l().userData.id,Z,e(S))}function ie(G){e($)&&!G.target.closest(".custom-dropdown")&&v($,!1)}function Pe(G){return G===0||G===null||G===void 0?"var(--grade-no-grade)":G>=85?"var(--grade-excellent)":G>=80?"var(--grade-good)":G>=75?"var(--grade-satisfactory)":(G>=65||G<65,"var(--grade-needs-improvement)")}function Ve(G,Z,le=2500){re[G]&&cancelAnimationFrame(re[G]);const N=Date.now();function M(){const pe=Date.now()-N,ee=Math.min(pe/le,1);let Ae=0;Z>=85?Ae=3:Z>=80?Ae=2:Z>=75?Ae=1:Ae=0;const Ue=Math.min(ee*1.6,1),Le=Math.min(Math.floor(Ue*(Ae+1)),Ae),Ie=[65,75,80,85][Le];Fs(V,e(V)[G]=Pe(Ie)),v(V,{...e(V)}),ee<1?re[G]=requestAnimationFrame(M):(Fs(V,e(V)[G]=Pe(Z)),v(V,{...e(V)}),delete re[G])}M()}function Ze(G,Z,le,N){return!Z||!le||!N?"N/A":G>0?ve(G):"N/A"}function ve(G){return G==null||G===0?"N/A":G%1===0?G.toString():G.toFixed(1)}function Ce(G,Z,le,N){return!Z||!le||!N||G===0?0:Math.min(G/100*100,100)}function Qe(G){const Z=["blue","green","purple","yellow","orange","red","teal","indigo","pink","cyan","lime","amber","deeporange"];return Z[G%Z.length]}function Xe(G){const Z=Qe(G);return{border:`var(--subject-card-${Z}-border)`,text:`var(--subject-card-${Z}-text)`,icon:`var(--subject-card-${Z}-icon)`}}function ze(G){return G>=85?"Excellent":G>=80?"Good":G>=75?"Satisfactory":G>=65?"Needs Improvement":"No Grade"}function We(G){return G>=90?"Keep it up!":G>=85?"Maintain the momentum!":G>=80?"Push for higher!":G>=75?"Aim higher next quarter!":"Work harder next quarter!"}function Te(G){return!G||G.length===0?{verified:0,total:0}:{verified:G.filter(le=>le.verified&&le.numericGrade>0&&le.teacher!=="No teacher").length,total:G.length}}let ue=O(0);function be(G){e(R).has(G)?e(R).delete(G):e(R).add(G),v(R,new Set(e(R)))}function ke(G){return G.verified&&(G.writtenWorkScores&&G.writtenWorkScores.length>0||G.performanceTasksScores&&G.performanceTasksScores.length>0||G.quarterlyAssessmentScores&&G.quarterlyAssessmentScores.length>0)}function Fe(G,Z){return`${{written:"Quiz",performance:"Project",quarterly:"Exam"}[Z]||"Task"} ${G+1}`}async function Re(G=!1){if(!(e(d)||!e(h).length||!l().userData?.id)){v(X,!0);try{const Z=me[e(D)];await yr.loadAiAnalysis(l().userData.id,Z,e(S),G),G||Se.success("AI Analysis generated successfully")}catch(Z){console.error("AI Analysis Error:",Z),Se.error("Failed to generate AI analysis")}}}async function et(){try{await Re(!0),Se.success("Analysis refreshed successfully")}catch(G){console.error("Error refreshing analysis:",G)}}function $e(){if(!e(X)&&!e(c)){const G=l().userData?.id,Z=me[e(D)];G&&(yr.initAiAnalysis(G,Z,e(S))?v(X,!0):Re())}else v(X,!e(X))}Ya(async()=>{if(l().userData?.id){const G=yr.init(l().userData.id);await yr.loadGrades(l().userData.id,null,null,G)}return()=>{Object.values(re).forEach(G=>{G&&cancelAnimationFrame(G)})}}),_t(()=>n(),()=>{v(c,n().aiAnalysis)}),_t(()=>n(),()=>{v(d,n().aiAnalysisLoading)}),_t(()=>n(),()=>{v(f,n().aiAnalysisError)}),_t(()=>l(),()=>{l().userData?.id&&v(se,l().userData.id)}),_t(()=>(l(),e(se)),()=>{l().userData?.id&&e(se)&&e(se)!==l().userData.id&&v(X,!1)}),_t(()=>n(),()=>{v(p,n().grades)}),_t(()=>e(p),()=>{v(h,e(p))}),_t(()=>n(),()=>{v(g,n().statistics)}),_t(()=>e(g),()=>{v(b,e(g).overallAverage)}),_t(()=>e(g),()=>{v(y,e(g).totalSubjects)}),_t(()=>n(),()=>{v(k,n().sectionInfo)}),_t(()=>n(),()=>{v(A,n().classRank)}),_t(()=>n(),()=>{v(T,n().totalStudentsInSection)}),_t(()=>n(),()=>{v(C,n().currentQuarter)}),_t(()=>n(),()=>{v(D,n().currentQuarterName)}),_t(()=>n(),()=>{v(S,n().currentSchoolYear)}),_t(()=>n(),()=>{v(L,n().isLoading)}),_t(()=>n(),()=>{v(F,n().error)}),_t(()=>n(),()=>{v(j,n().previousQuarterAverage)}),_t(()=>n(),()=>{v(P,n().averageChange)}),_t(()=>(e(p),e(V)),()=>{e(p)&&e(p).length>0&&e(p).some(Z=>Z.numericGrade>0&&Z.teacher!=="No teacher"&&Z.verified&&!e(V)[Z.id])&&(e(p).forEach(Z=>{Z.numericGrade>0&&Z.teacher!=="No teacher"&&Z.verified&&(e(V)[Z.id]||Fs(V,e(V)[Z.id]=Pe(65)))}),v(V,{...e(V)}),setTimeout(()=>{e(p).forEach(Z=>{Z.numericGrade>0&&Z.teacher!=="No teacher"&&Z.verified&&Ve(Z.id,Z.numericGrade)})},100))}),_t(()=>e(p),()=>{v(Q,Te(e(p)))}),_t(()=>(e(C),e(p)),()=>{e(C)&&v(Q,Te(e(p)))}),_t(()=>(e(C),e(ue)),()=>{e(C),or(ue)}),Rs(),Ls();var ot=Mg();ye("click",Zs,ie);var Me=o(ot),it=u(o(Me),2),ft=o(it),Ye=o(ft),Y=u(o(Ye),2),ce=o(Y,!0);i(Y);var De=u(Y,2);let U;i(Ye);var ne=u(Ye,2);{var fe=G=>{var Z=ng();xt(Z,5,()=>W,Ua,(le,N)=>{var M=ig();let H;var pe=o(M,!0);i(M),q(ee=>{H=_e(M,1,"dropdown-item-quarter",null,H,ee),w(pe,e(N))},[()=>({active:e(N)===e(D)})]),ye("click",M,()=>de(e(N))),m(le,M)}),i(Z),m(G,Z)};E(ne,G=>{e($)&&G(fe)})}i(ft),i(it),i(Me);var z=u(Me,2);{var B=G=>{var Z=og(),le=u(o(Z),2),N=o(le);i(le);var M=u(le,2);i(Z),q(()=>w(N,`Error: ${e(F)??""}`)),ye("click",M,()=>yr.loadGrades(l().userData.id)),m(G,Z)},I=G=>{var Z=Lg(),le=Je(Z),N=o(le),M=o(N),H=o(M),pe=u(o(H),2);{var ee=Et=>{var ta=lg(),fa=o(ta);i(ta),q(()=>w(fa,`Grade ${e(k),x(()=>e(k).gradeLevel)??""}  ${e(k),x(()=>e(k).name)??""}`)),m(Et,ta)};E(pe,Et=>{e(k)&&Et(ee)})}i(H);var Ae=u(H,2);i(M),i(N);var Ue=u(N,2);Is(Ue,()=>`stats-${e(C)}-${e(S)}`,Et=>{var ta=pg(),fa=o(ta),oe=u(o(fa),2),Ee=o(oe);Is(Ee,()=>`${e(C)}-${e(S)}`,ge=>{Qr(ge,{get value(){return e(b)},decimals:1,duration:2.5,colorTransition:!0,getGradeColor:Pe})}),i(oe);var dt=u(oe,2);Is(dt,()=>`${e(C)}-${e(S)}`,ge=>{var te=mt(),J=Je(te);{var Be=at=>{var gt=cg();m(at,gt)},Ge=at=>{var gt=mt(),Gt=Je(gt);{var _a=Ne=>{var ct=dg();let Ft;var Mt=o(ct),It=o(Mt);{var ra=ua=>{var ba=Sa("trending_up");m(ua,ba)},ha=ua=>{var ba=mt(),Ta=Je(ba);{var Pa=K=>{var xe=Sa("trending_down");m(K,xe)},Ea=K=>{var xe=Sa("trending_flat");m(K,xe)};E(Ta,K=>{e(P)<0?K(Pa):K(Ea,!1)},!0)}m(ua,ba)};E(It,ua=>{e(P)>0?ua(ra):ua(ha,!1)})}i(Mt);var ca=u(Mt,2),Qt=o(ca);{var va=ua=>{var ba=Sa();q(Ta=>w(ba,`+${Ta??""}`),[()=>(e(P),x(()=>e(P).toFixed(1)))]),m(ua,ba)},pa=ua=>{var ba=mt(),Ta=Je(ba);{var Pa=K=>{var xe=Sa();q(Ke=>w(xe,Ke),[()=>(e(P),x(()=>e(P).toFixed(1)))]),m(K,xe)},Ea=K=>{var xe=Sa("No change");m(K,xe)};E(Ta,K=>{e(P)<0?K(Pa):K(Ea,!1)},!0)}m(ua,ba)};E(Qt,ua=>{e(P)>0?ua(va):ua(pa,!1)})}Bt(),i(ca),i(ct),q(ua=>Ft=_e(ct,1,"grade-comparison",null,Ft,ua),[()=>({positive:e(P)>0,negative:e(P)<0,neutral:e(P)===0})]),m(Ne,ct)},ht=Ne=>{var ct=mt(),Ft=Je(ct);{var Mt=It=>{var ra=ug(),ha=u(o(ra),2),ca=o(ha,!0);i(ha),i(ra),q(Qt=>w(ca,Qt),[()=>(e(b),x(()=>We(e(b))))]),m(It,ra)};E(Ft,It=>{e(C)===1&&e(b)>0&&It(Mt)},!0)}m(Ne,ct)};E(Gt,Ne=>{e(P)!==null?Ne(_a):Ne(ht,!1)},!0)}m(at,gt)};E(J,at=>{e(b)===0?at(Be):at(Ge,!1)})}m(ge,te)}),i(fa);var we=u(fa,2),Oe=u(o(we),2),lt=o(Oe);Is(lt,()=>`${e(C)}-${e(S)}`,ge=>{Qr(ge,{get value(){return e(y)},decimals:0,duration:2})}),i(Oe);var Rt=u(Oe,2),Ht=u(o(Rt),2);Is(Ht,()=>`${e(C)}-${e(S)}`,ge=>{var te=vg(),J=o(te);i(te),q(()=>w(J,`${e(Q),x(()=>e(Q).verified)??""}/${e(Q),x(()=>e(Q).total)??""} Verified Grades`)),m(ge,te)}),i(Rt),i(we);var rt=u(we,2),ka=u(o(rt),2),Zt=u(o(ka));Is(Zt,()=>`${e(C)}-${e(S)}`,ge=>{Qr(ge,{get value(){return e(A)},decimals:0,duration:2})}),i(ka);var tt=u(ka,2),wt=u(o(tt),2);Is(wt,()=>`${e(C)}-${e(S)}`,ge=>{var te=fg(),J=o(te);i(te),q(()=>w(J,`Out of ${e(T)??""} Students`)),m(ge,te)}),i(tt),i(rt),i(ta),m(Et,ta)}),i(le);var Le=u(le,2),He=o(Le),Ie=u(o(He),2),nt=o(Ie);{var bt=Et=>{var ta=mg();ye("click",ta,et),m(Et,ta)};E(nt,Et=>{e(c)&&!e(d)&&Et(bt)})}var pt=u(nt,2);let vt;var Tt=o(pt);{var Ot=Et=>{var ta=hg();Bt(2),m(Et,ta)},la=Et=>{var ta=gg();Bt(2),m(Et,ta)};E(Tt,Et=>{e(X)?Et(Ot):Et(la,!1)})}i(pt),i(Ie),i(He);var sa=u(He,2);{var zt=Et=>{var ta=_g(),fa=o(ta);tg(fa,{get analysisData(){return e(c)},get isLoading(){return e(d)},get error(){return e(f)},get subjects(){return e(p)}}),i(ta),m(Et,ta)};E(sa,Et=>{e(X)&&Et(zt)})}i(Le);var qt=u(Le,2),Pt=u(o(qt),2);{var Yt=Et=>{var ta=bg();m(Et,ta)},Ut=Et=>{var ta=mt(),fa=Je(ta);{var oe=dt=>{var we=yg(),Oe=u(o(we),2),lt=o(Oe);i(Oe),Bt(2),i(we),q(()=>w(lt,`No subjects found for ${e(D)??""}`)),m(dt,we)},Ee=dt=>{var we=mt(),Oe=Je(we);Is(Oe,()=>e(ue),lt=>{var Rt=Pg();xt(Rt,7,()=>e(h),Ht=>Ht.subject_id||Ht.id,(Ht,rt,ka)=>{const Zt=fr(()=>(xs(e(ka)),x(()=>Xe(e(ka))))),tt=fr(()=>(e(rt),x(()=>ke(e(rt)))));var wt=$g(),ge=o(wt);let te;var J=o(ge),Be=o(J);i(J);var Ge=u(J,2),at=o(Ge),gt=o(at,!0);i(at);var Gt=u(at,2);let _a;var ht=o(Gt,!0);i(Gt);var Ne=u(Gt,2),ct=o(Ne);Is(ct,()=>(e(rt),e(C),e(S),x(()=>`${e(rt).id}-${e(C)}-${e(S)}`)),va=>{var pa=mt(),ua=Je(pa);{var ba=Ta=>{var Pa=wg();q((Ea,K)=>Wa(Pa,`width: ${Ea??""}%; background-color: ${K??""}`),[()=>(e(rt),x(()=>Ce(e(rt).numericGrade,e(rt).teacher!=="No teacher",e(rt).numericGrade>0,e(rt).verified))),()=>(e(V),e(rt),x(()=>e(V)[e(rt).id]||Pe(e(rt).numericGrade)))]),m(Ta,Pa)};E(ua,Ta=>{e(rt),x(()=>Ce(e(rt).numericGrade,e(rt).teacher!=="No teacher",e(rt).numericGrade>0,e(rt).verified)>0)&&Ta(ba)})}m(va,pa)}),i(Ne),i(Ge);var Ft=u(Ge,2),Mt=o(Ft),It=o(Mt);Is(It,()=>(e(rt),e(C),x(()=>`${e(rt).id}-${e(C)}`)),va=>{var pa=kg(),ua=Je(pa);{var ba=K=>{Qr(K,{get value(){return e(rt),x(()=>e(rt).numericGrade)},decimals:1,duration:2.5,colorTransition:!0,getGradeColor:Pe})},Ta=K=>{var xe=xg(),Ke=o(xe,!0);i(xe),q((Dt,Wt)=>{Wa(xe,`color: ${Dt??""}`),w(Ke,Wt)},[()=>(e(rt),x(()=>Pe(e(rt).numericGrade))),()=>(e(rt),x(()=>Ze(e(rt).numericGrade,e(rt).teacher!=="No teacher",e(rt).numericGrade>0,e(rt).verified)))]),m(K,xe)};E(ua,K=>{e(rt),x(()=>e(rt).numericGrade>0&&e(rt).teacher!=="No teacher"&&e(rt).verified)?K(ba):K(Ta,!1)})}var Pa=u(ua,2);{var Ea=K=>{var xe=Sg();m(K,xe)};E(Pa,K=>{e(rt),x(()=>e(rt).numericGrade>0&&!e(rt).verified)&&K(Ea)})}m(va,pa)}),i(Mt);var ra=u(Mt,2),ha=o(ra,!0);i(ra),i(Ft),i(ge);var ca=u(ge,2);{var Qt=va=>{var pa=Ng(),ua=o(pa),ba=o(ua);{var Ta=Ke=>{var Dt=Dg(),Wt=o(Dt),Nt=u(o(Wt),2),St=o(Nt,!0);i(Nt),i(Wt);var Na=u(Wt,2);xt(Na,5,()=>(e(rt),x(()=>e(rt).writtenWorkScores)),Ua,(Aa,ga,Da)=>{var Vt=Ag(),Kt=o(Vt),xa=o(Kt,!0);i(Kt);var ya=u(Kt,2),Fa=o(ya,!0);i(ya),i(Vt),q((ma,wa)=>{w(xa,ma),Wa(ya,`color: ${wa??""}`),w(Fa,e(ga))},[()=>x(()=>Fe(Da,"written")),()=>(e(ga),x(()=>Pe(e(ga))))]),m(Aa,Vt)}),i(Na),i(Dt),q((Aa,ga)=>{Wa(Nt,`color: ${Aa??""}`),w(St,ga)},[()=>(e(rt),x(()=>Pe(e(rt).writtenWork))),()=>(e(rt),x(()=>ve(e(rt).writtenWork)))]),m(Ke,Dt)};E(ba,Ke=>{e(rt),x(()=>e(rt).writtenWorkScores&&e(rt).writtenWorkScores.length>0)&&Ke(Ta)})}var Pa=u(ba,2);{var Ea=Ke=>{var Dt=Tg(),Wt=o(Dt),Nt=u(o(Wt),2),St=o(Nt,!0);i(Nt),i(Wt);var Na=u(Wt,2);xt(Na,5,()=>(e(rt),x(()=>e(rt).performanceTasksScores)),Ua,(Aa,ga,Da)=>{var Vt=Cg(),Kt=o(Vt),xa=o(Kt,!0);i(Kt);var ya=u(Kt,2),Fa=o(ya,!0);i(ya),i(Vt),q((ma,wa)=>{w(xa,ma),Wa(ya,`color: ${wa??""}`),w(Fa,e(ga))},[()=>x(()=>Fe(Da,"performance")),()=>(e(ga),x(()=>Pe(e(ga))))]),m(Aa,Vt)}),i(Na),i(Dt),q((Aa,ga)=>{Wa(Nt,`color: ${Aa??""}`),w(St,ga)},[()=>(e(rt),x(()=>Pe(e(rt).performanceTasks))),()=>(e(rt),x(()=>ve(e(rt).performanceTasks)))]),m(Ke,Dt)};E(Pa,Ke=>{e(rt),x(()=>e(rt).performanceTasksScores&&e(rt).performanceTasksScores.length>0)&&Ke(Ea)})}var K=u(Pa,2);{var xe=Ke=>{var Dt=Fg(),Wt=o(Dt),Nt=u(o(Wt),2),St=o(Nt,!0);i(Nt),i(Wt);var Na=u(Wt,2);xt(Na,5,()=>(e(rt),x(()=>e(rt).quarterlyAssessmentScores)),Ua,(Aa,ga,Da)=>{var Vt=Eg(),Kt=o(Vt),xa=o(Kt,!0);i(Kt);var ya=u(Kt,2),Fa=o(ya,!0);i(ya),i(Vt),q((ma,wa)=>{w(xa,ma),Wa(ya,`color: ${wa??""}`),w(Fa,e(ga))},[()=>x(()=>Fe(Da,"quarterly")),()=>(e(ga),x(()=>Pe(e(ga))))]),m(Aa,Vt)}),i(Na),i(Dt),q((Aa,ga)=>{Wa(Nt,`color: ${Aa??""}`),w(St,ga)},[()=>(e(rt),x(()=>Pe(e(rt).quarterlyAssessment))),()=>(e(rt),x(()=>ve(e(rt).quarterlyAssessment)))]),m(Ke,Dt)};E(K,Ke=>{e(rt),x(()=>e(rt).quarterlyAssessmentScores&&e(rt).quarterlyAssessmentScores.length>0)&&Ke(xe)})}i(ua),i(pa),m(va,pa)};E(ca,va=>{e(R),e(rt),x(()=>e(R).has(e(rt).id))&&va(Qt)})}i(wt),q((va,pa,ua,ba)=>{Wa(wt,`--card-index: ${e(ka)??""};`),te=_e(ge,1,"subject-card",null,te,va),Wa(ge,`border: 2px solid ${xs(e(Zt)),x(()=>e(Zt).border)??""};`),$t(ge,"role",e(tt)?"button":void 0),Wa(Be,`color: ${xs(e(Zt)),x(()=>e(Zt).icon)??""};`),Wa(at,`color: ${xs(e(Zt)),x(()=>e(Zt).text)??""};`),w(gt,(e(rt),x(()=>e(rt).name))),_a=_e(Gt,1,"teacher-name",null,_a,pa),w(ht,(e(rt),x(()=>e(rt).teacher))),_e(ra,1,`grade-indicator ${ua??""}`),w(ha,ba)},[()=>({clickable:e(tt)}),()=>({"no-teacher":e(rt).teacher==="No teacher"}),()=>(e(rt),x(()=>ze(e(rt).numericGrade).color)),()=>(e(rt),x(()=>ze(e(rt).numericGrade).text))]),ye("click",ge,function(...va){(e(tt)?()=>be(e(rt).id):void 0)?.apply(this,va)}),ye("keydown",ge,function(...va){(e(tt)?pa=>pa.key==="Enter"&&be(e(rt).id):void 0)?.apply(this,va)}),m(Ht,wt)}),i(Rt),m(lt,Rt)}),m(dt,we)};E(fa,dt=>{e(h),x(()=>e(h).length===0)?dt(oe):dt(Ee,!1)},!0)}m(Et,ta)};E(Pt,Et=>{e(L)?Et(Yt):Et(Ut,!1)})}i(qt),q(Et=>{Ae.disabled=e(L),vt=_e(pt,1,"toggle-analysis-btn",null,vt,Et),$t(pt,"title",e(X)?"Hide Analysis":"Get AI Analysis")},[()=>({active:e(X)})]),ye("click",Ae,()=>yr.forceRefresh(l().userData.id,e(C),e(S))),ye("click",pt,$e),m(G,Z)};E(z,G=>{e(F)?G(B):G(I,!1)})}i(ot),q(G=>{w(ce,e(D)),U=_e(De,1,"material-symbols-outlined dropdown-arrow",null,U,G)},[()=>({rotated:e($)})]),ye("click",Ye,je),m(s,ot),za(),r()}const Rg=300*1e3,bc="student_class_ranking_";function Og(){const s={myRank:0,totalStudents:0,myAverage:0,sectionInfo:null,rankingsList:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null,currentQuarter:null,currentSchoolYear:null},{subscribe:t,set:a,update:r}=Hs(s);function n(){const g=_o(gs);if(!g?.isAuthenticated||!g.userData)return{};const b={id:g.userData.id,name:g.userData.name,account_number:g.userData.accountNumber,account_type:g.userData.account_type||g.userData.accountType};return{"x-user-info":JSON.stringify(b)}}function l(g,b,y){return`${bc}${g}_${b}_${y}`}function c(g){return!g||!g.timestamp?!1:Date.now()-g.timestamp<Rg}function d(g,b,y){try{const k=l(g,b,y),A=localStorage.getItem(k);if(A)return JSON.parse(A).data}catch(k){console.warn("Failed to retrieve cached class ranking data:",k)}return null}function f(g,b,y){try{const k=l(g,b,y),A=localStorage.getItem(k);if(A){const T=JSON.parse(A);if(c(T))return T.data}}catch(k){console.warn("Failed to retrieve cached class ranking data:",k)}return null}function p(g,b,y,k){try{const A=l(g,b,y),T={data:k,timestamp:Date.now()};localStorage.setItem(A,JSON.stringify(T))}catch(A){console.warn("Failed to cache class ranking data:",A)}}async function h(g,b,y){const k=await fetch(`/api/class-rankings?studentId=${g}&quarter=${b}&schoolYear=${y}`,{headers:n()});if(!k.ok)throw new Error("Failed to load class rankings");return await k.json()}return{subscribe:t,init(g,b,y){const k=f(g,b,y);return k?(r(A=>({...A,...k,currentStudentId:g,currentQuarter:b,currentSchoolYear:y,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(A=>({...A,currentStudentId:g,currentQuarter:b,currentSchoolYear:y,isLoading:!0,isRefreshing:!1,error:null})),!1)},async loadRankings(g,b,y,k=!1){if(!g){console.warn("Student ID is required to load rankings");return}r(A=>({...A,isLoading:A.rankingsList.length===0&&!k,isRefreshing:A.rankingsList.length>0||k,error:null,currentStudentId:g,currentQuarter:b,currentSchoolYear:y}));try{const A=await h(g,b,y),T={myRank:A.myRank||0,totalStudents:A.totalStudents||0,myAverage:A.myAverage||0,sectionInfo:A.sectionInfo||null,rankingsList:A.rankings||[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),currentStudentId:g,currentQuarter:b,currentSchoolYear:y};p(g,b,y,{myRank:T.myRank,totalStudents:T.totalStudents,myAverage:T.myAverage,sectionInfo:T.sectionInfo,rankingsList:T.rankingsList,lastUpdated:T.lastUpdated}),a(T)}catch(A){console.error("Error loading class rankings:",A);const T=d(g,b,y);console.log("Rankings fetch failed, checking cache:",{hasCachedData:!!T,studentId:g,quarter:b,schoolYear:y}),T?(console.log("Using cached rankings data and showing toast"),r(C=>({...C,myRank:T.myRank||0,totalStudents:T.totalStudents||0,myAverage:T.myAverage||0,sectionInfo:T.sectionInfo||null,rankingsList:T.rankingsList||[],lastUpdated:T.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),setTimeout(()=>{Se.error("No internet connection. Showing offline data.")},100)):(console.log("No cached data available, showing error container"),r(C=>({...C,isLoading:!1,isRefreshing:!1,error:A.message||"Failed to load rankings"})))}},async refresh(){let g;t(y=>{g=y})(),g.currentStudentId&&g.currentQuarter&&g.currentSchoolYear&&await this.loadRankings(g.currentStudentId,g.currentQuarter,g.currentSchoolYear,!0)},reset(){a(s)},clearCache(g,b,y){try{const k=l(g,b,y);localStorage.removeItem(k)}catch(k){console.warn("Failed to clear cache:",k)}},clearAllCache(){try{Object.keys(localStorage).forEach(b=>{b.startsWith(bc)&&localStorage.removeItem(b)})}catch(g){console.warn("Failed to clear all caches:",g)}}}}const yc=Og();var jg=_("<button> </button>"),qg=_('<div class="dropdown-menu-quarter"></div>'),zg=_('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Gg=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading rankings...</p></div>'),Vg=_('<div class="no-rankings"><span class="material-symbols-outlined">leaderboard</span> <p> </p> <small>Rankings will appear here once grades are finalized</small></div>'),Bg=_(`<div class="message-text"><strong>Outstanding!</strong> You're the top student in your class!</div>`),Wg=_(`<div class="message-text"><strong>Excellent work!</strong> You're in 2nd place. Keep pushing for the top!</div>`),Hg=_(`<div class="message-text"><strong>Great job!</strong> You're in 3rd place and in the top tier!</div>`),Ug=_(`<div class="message-text"><strong>Fantastic!</strong> You're in the top 10% of your class!</div>`),Yg=_(`<div class="message-text"><strong>Well done!</strong> You're in the top 25% of your class!</div>`),Qg=_(`<div class="message-text"><strong>Good work!</strong> You're in the top half of your class!</div>`),Kg=_('<div class="message-text"><strong>Keep going!</strong> You have great potential to improve!</div>'),Jg=_('<div><div class="rank-banner-content"><div class="rank-display"><span> </span> <div class="rank-info"><span class="rank-banner-label">Your Rank</span> <div class="rank-banner-value"><span class="rank-number-display"><!></span> <span class="rank-total"> </span></div></div></div> <div class="rank-divider"></div> <div class="rank-message"><!></div></div></div>'),Xg=_('<div><div class="rank-position"><span class="material-symbols-outlined rank-icon"> </span> <span class="rank-number"> </span></div> <div class="student-info"><h3 class="student-name"> </h3> <p class="student-id"> </p></div> <div class="student-average"><span class="average-label">Average</span> <span class="average-value"> </span></div></div>'),Zg=_('<div class="rankings-list"></div>'),e_=_("<!> <!>",1),t_=_('<div class="rankings-section"><!></div>'),a_=_('<div class="rankings-container"><div class="rankings-header"><div class="header-content"><h1 class="page-title">Class Rankings</h1> <p class="page-subtitle">Academic Performance Standings</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function s_(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(yr,"$studentGradeStore",a),l=()=>Ja(yc,"$studentClassRankingStore",a),c=()=>Ja(gs,"$authStore",a),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=O(),k=O(),A=O();let T=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],C=O(!1);const D={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};let S=O(0),L=O(!1),F=O(null);function j(){v(C,!e(C))}function P(ze){v(C,!1),v(d,ze)}function Q(ze){e(C)&&!ze.target.closest(".custom-dropdown")&&v(C,!1)}function W(ze){return ze===1?"var(--rank-gold)":ze===2?"var(--rank-silver)":ze===3?"var(--rank-bronze)":"var(--md-sys-color-on-surface)"}function $(ze){return ze<=3?"trophy":"military_tech"}function R(ze){return ze===0||ze===null||ze===void 0?"var(--grade-no-grade)":ze>=85?"var(--grade-excellent)":ze>=80?"var(--grade-good)":ze>=75?"var(--grade-satisfactory)":(ze>=65,"var(--grade-needs-improvement)")}async function X(){if(!c().userData?.id)return;const ze=D[e(d)];await yc.loadRankings(c().userData.id,ze,e(f))}_t(()=>n(),()=>{v(d,n().currentQuarterName||"1st Quarter")}),_t(()=>n(),()=>{v(f,n().currentSchoolYear||"2025-2026")}),_t(()=>l(),()=>{v(p,l().myRank)}),_t(()=>l(),()=>{v(h,l().totalStudents)}),_t(()=>l(),()=>{v(g,l().myAverage)}),_t(()=>l(),()=>{v(b,l().sectionInfo)}),_t(()=>l(),()=>{v(y,l().rankingsList)}),_t(()=>l(),()=>{v(k,l().isLoading||l().isRefreshing)}),_t(()=>l(),()=>{v(A,l().error)}),_t(()=>(e(S),e(p)),()=>{or(S),v(L,!1),e(p)>0&&setTimeout(()=>{v(L,!0)},700)}),_t(()=>(e(d),c(),e(F)),()=>{e(d)&&c().userData?.id&&(e(F)===null||e(d)!==e(F))&&(v(F,e(d)),X())}),Rs(),Ls();var se=a_();ye("click",Zs,Q);var V=o(se),re=u(o(V),2),me=o(re),je=o(me),de=u(o(je),2),ie=o(de,!0);i(de);var Pe=u(de,2);let Ve;i(je);var Ze=u(je,2);{var ve=ze=>{var We=qg();xt(We,5,()=>T,Ua,(Te,ue)=>{var be=jg();let ke;var Fe=o(be,!0);i(be),q(Re=>{ke=_e(be,1,"dropdown-item-quarter",null,ke,Re),w(Fe,e(ue))},[()=>({active:e(ue)===e(d)})]),ye("click",be,()=>P(e(ue))),m(Te,be)}),i(We),m(ze,We)};E(Ze,ze=>{e(C)&&ze(ve)})}i(me),i(re),i(V);var Ce=u(V,2);{var Qe=ze=>{var We=zg(),Te=u(o(We),2),ue=o(Te);i(Te);var be=u(Te,2);i(We),q(()=>w(ue,`Error: ${e(A)??""}`)),ye("click",be,X),m(ze,We)},Xe=ze=>{var We=mt(),Te=Je(We);{var ue=ke=>{var Fe=Gg();m(ke,Fe)},be=ke=>{var Fe=t_(),Re=o(Fe);{var et=ot=>{var Me=Vg(),it=u(o(Me),2),ft=o(it);i(it),Bt(2),i(Me),q(()=>w(ft,`No rankings available for ${e(d)??""}`)),m(ot,Me)},$e=ot=>{var Me=e_(),it=Je(Me);Is(it,()=>e(S),Ye=>{var Y=Jg();let ce;var De=o(Y),U=o(De),ne=o(U);let fe;var z=o(ne,!0);i(ne);var B=u(ne,2),I=u(o(B),2),G=o(I),Z=o(G);{var le=Le=>{var He=mt(),Ie=Je(He);Is(Ie,()=>e(p),nt=>{Qr(nt,{get value(){return e(p)},get startVal(){return e(h)},duration:1.6,decimals:0})}),m(Le,He)},N=Le=>{var He=Sa();q(()=>w(He,e(h))),m(Le,He)};E(Z,Le=>{e(L)?Le(le):Le(N,!1)})}i(G);var M=u(G,2),H=o(M);i(M),i(I),i(B),i(U);var pe=u(U,4),ee=o(pe);{var Ae=Le=>{var He=Bg();m(Le,He)},Ue=Le=>{var He=mt(),Ie=Je(He);{var nt=pt=>{var vt=Wg();m(pt,vt)},bt=pt=>{var vt=mt(),Tt=Je(vt);{var Ot=sa=>{var zt=Hg();m(sa,zt)},la=sa=>{var zt=mt(),qt=Je(zt);{var Pt=Ut=>{var Et=Ug();m(Ut,Et)},Yt=Ut=>{var Et=mt(),ta=Je(Et);{var fa=Ee=>{var dt=Yg();m(Ee,dt)},oe=Ee=>{var dt=mt(),we=Je(dt);{var Oe=Rt=>{var Ht=Qg();m(Rt,Ht)},lt=Rt=>{var Ht=Kg();m(Rt,Ht)};E(we,Rt=>{e(p)<=e(h)*.5?Rt(Oe):Rt(lt,!1)},!0)}m(Ee,dt)};E(ta,Ee=>{e(p)<=e(h)*.25?Ee(fa):Ee(oe,!1)},!0)}m(Ut,Et)};E(qt,Ut=>{e(p)<=e(h)*.1?Ut(Pt):Ut(Yt,!1)},!0)}m(sa,zt)};E(Tt,sa=>{e(p)===3?sa(Ot):sa(la,!1)},!0)}m(pt,vt)};E(Ie,pt=>{e(p)===2?pt(nt):pt(bt,!1)},!0)}m(Le,He)};E(ee,Le=>{e(p)===1?Le(Ae):Le(Ue,!1)})}i(pe),i(De),i(Y),q((Le,He,Ie,nt)=>{ce=_e(Y,1,"student-rank-banner",null,ce,Le),fe=_e(ne,1,"material-symbols-outlined rank-banner-icon",null,fe,He),Wa(ne,`color: ${Ie??""};`),w(z,nt),w(H,`/ ${e(h)??""}`)},[()=>({"top-rank":e(p)<=3}),()=>({"show-icon":e(L)}),()=>(e(p),x(()=>W(e(p)))),()=>(e(p),x(()=>$(e(p))))]),m(Ye,Y)});var ft=u(it,2);Is(ft,()=>e(S),Ye=>{var Y=Zg();xt(Y,7,()=>e(y),ce=>ce.studentId,(ce,De,U)=>{var ne=Xg();let fe;var z=o(ne),B=o(z),I=o(B,!0);i(B);var G=u(B,2),Z=o(G,!0);i(G),i(z);var le=u(z,2),N=o(le),M=o(N,!0);i(N);var H=u(N,2),pe=o(H);i(H),i(le);var ee=u(le,2),Ae=u(o(ee),2),Ue=o(Ae,!0);i(Ae),i(ee),i(ne),q((Le,He,Ie,nt,bt,pt)=>{fe=_e(ne,1,"ranking-card",null,fe,Le),Wa(ne,`--card-index: ${e(U)??""};`),Wa(B,`color: ${He??""};`),w(I,Ie),Wa(G,`color: ${nt??""};`),w(Z,(e(De),x(()=>e(De).rank))),w(M,(e(De),c(),x(()=>e(De).studentId===c().userData?.id?"You":e(De).name))),w(pe,`ID: ${e(De),x(()=>e(De).studentNumber)??""}`),Wa(Ae,`color: ${bt??""};`),w(Ue,pt)},[()=>({"my-rank":e(De).studentId===c().userData?.id}),()=>(e(De),x(()=>W(e(De).rank))),()=>(e(De),x(()=>$(e(De).rank))),()=>(e(De),x(()=>W(e(De).rank))),()=>(e(De),x(()=>R(e(De).average))),()=>(e(De),x(()=>e(De).average.toFixed(1)))]),m(ce,ne)}),i(Y),m(Ye,Y)}),m(ot,Me)};E(Re,ot=>{e(y),x(()=>e(y).length===0)?ot(et):ot($e,!1)})}i(Fe),m(ke,Fe)};E(Te,ke=>{e(k)?ke(ue):ke(be,!1)},!0)}m(ze,We)};E(Ce,ze=>{e(A)?ze(Qe):ze(Xe,!1)})}i(se),q(ze=>{w(ie,e(d)),Ve=_e(Pe,1,"material-symbols-outlined dropdown-arrow",null,Ve,ze)},[()=>({rotated:e(C)})]),ye("click",je,j),m(s,se),za(),r()}const r_=300*1e3,i_="student_schedule_";function wc(){let s;return gs.subscribe(t=>{s=t.userData})(),s?{"x-user-info":JSON.stringify({id:s.id,name:s.name,account_number:s.accountNumber,account_type:s.accountType})}:(console.warn("No user info available for authentication"),{})}function n_(){const s={scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Hs(s);function n(D){return`${i_}${D}`}function l(D){return!D||!D.timestamp?!1:Date.now()-D.timestamp<r_}function c(D){try{const S=n(D),L=localStorage.getItem(S);if(L)return JSON.parse(L).data}catch(S){console.warn("Failed to retrieve cached student schedule data:",S)}return null}function d(D){try{const S=n(D),L=localStorage.getItem(S);if(L){const F=JSON.parse(L);if(l(F))return F.data}}catch(S){console.warn("Failed to retrieve cached student schedule data:",S)}return null}function f(D,S){try{const L=n(D),F={data:S,timestamp:Date.now()};localStorage.setItem(L,JSON.stringify(F))}catch(L){console.warn("Failed to cache student schedule data:",L)}}const p={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},h=["blue","green","purple","yellow","orange"];function g(D){return h[D%h.length]}function b(D){const[S,L]=D.split(":"),F=parseInt(S),j=F>=12?"PM":"AM";return`${(F===0?12:F>12?F-12:F).toString().padStart(2,"0")}:${L} ${j}`}function y(D){const S={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},L={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return D.forEach(F=>{const j=p[F.day_of_week.toLowerCase()];if(j){const P=b(F.start_time),Q=b(F.end_time);let W,$;F.schedule_type==="subject"?(W=F.subject_name||"Unknown Subject",$=F.teacher_name||"No Teacher Assigned"):F.schedule_type==="activity"&&(W=F.activity_type_name||"Activity",$=F.teacher_name||"");const R={name:W,time:`${P} - ${Q}`,room:F.room_name||"TBA",teacher:$,scheduleType:F.schedule_type,color:g(L[j])};S[j].push(R),L[j]++}}),S}async function k(D,S=!1){try{r($=>({...$,isLoading:!S,isRefreshing:S,error:null,currentStudentId:D}));const j=(await(await fetch("/api/current-quarter",{headers:wc()})).json()).data?.currentSchoolYear||"2025-2026",Q=await(await fetch(`/api/schedules?action=student-schedules&studentId=${D}&schoolYear=${j}`,{headers:wc()})).json();if(!Q.success)throw new Error(Q.error||"Failed to fetch schedule data");const W=y(Q.data);r($=>({...$,scheduleData:W,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),f(D,{scheduleData:W,lastUpdated:new Date().toISOString()})}catch(L){console.error("Error loading student schedule:",L);const F=c(D);F?(r(j=>({...j,isLoading:!1,isRefreshing:!1,error:null,scheduleData:F.scheduleData||{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},lastUpdated:F.lastUpdated})),Se.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:L.message,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}}))}}function A(D){const S=d(D);return S?(r(L=>({...L,...S,currentStudentId:D,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(L=>({...L,currentStudentId:D,isLoading:!0,isRefreshing:!1,error:null})),!1)}function T(D){try{const S=n(D);localStorage.removeItem(S)}catch(S){console.warn("Failed to clear student schedule cache:",S)}return r(S=>({...s,currentStudentId:D,isLoading:!0})),C.loadSchedule(D,!1)}const C={subscribe:t,init:A,loadSchedule:k,forceRefresh:T,getCachedData:D=>c(D)};return C}const Fi=n_();var o_=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),l_=_("<button> </button>"),c_=_('<div class="schedule-dropdown-menu"></div>'),d_=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),u_=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p>Error Loading Schedule</p> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),v_=_('<div class="class-teacher"><span class="material-symbols-outlined">person_book</span> <span> </span></div>'),f_=_('<div><div class="class-header"><h3 class="class-name"> </h3> <span class="class-time"> </span></div> <div class="class-details"><div class="class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!></div></div>'),p_=_('<div class="classes-list"></div>'),m_=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),h_=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-header"><div class="schedule-header-content"><div class="schedule-header-text"><h1 class="page-title">Schedule</h1> <p class="page-subtitle">Your weekly class schedule</p></div></div></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="day-selector"></div> <div class="schedule-mobile-dropdown"><button class="schedule-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function g_(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(Fi,"$studentScheduleStore",a),l=()=>Ja(gs,"$authStore",a),c=O(),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=new Date,k=["January","February","March","April","May","June","July","August","September","October","November","December"],A=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=k[y.getMonth()],C=y.getDate(),D=A[y.getDay()],S={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},L=y.getDay();let F=O(S[L]||"Mon");async function j(){const $e=l();$e.isAuthenticated&&$e.userData?.id&&await Fi.forceRefresh($e.userData.id)}Ya(()=>{const $e=l();if($e.isAuthenticated&&$e.userData?.id){const ot=Fi.init($e.userData.id);Fi.loadSchedule($e.userData.id,ot);const Me=setInterval(()=>{const it=l();it.isAuthenticated&&it.userData?.id&&Fi.loadSchedule(it.userData.id,!0)},300*1e3);return()=>{clearInterval(Me)}}});const P=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}],Q={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"};let W=O(0),$=O(!1);function R($e){$e.target.closest(".schedule-mobile-dropdown")||v($,!1)}function X(){v($,!e($))}function se($e){v(F,$e),v($,!1)}_t(()=>(e(c),e(d),e(f),e(p),e(h),n()),()=>{($e=>{v(c,$e.scheduleData),v(d,$e.isLoading),v(f,$e.isRefreshing),v(p,$e.error),v(h,$e.lastUpdated)})(n())}),_t(()=>(e(c),e(F)),()=>{v(g,e(c)[e(F)]||[])}),_t(()=>e(F),()=>{v(b,Q[e(F)]||"Monday")}),_t(()=>(e(F),e(W)),()=>{e(F),or(W)}),Rs(),Ls();var V=h_(),re=u(o(V),2),me=o(re),je=o(me),de=o(je);i(je),i(me);var ie=u(me,2);xt(ie,5,()=>P,Ua,($e,ot)=>{let Me=()=>e(ot).day;var it=o_(),ft=o(it),Ye=o(ft,!0);i(ft);var Y=u(ft,2),ce=o(Y,!0);i(Y),i(it),q(()=>{_e(it,1,`day-btn ${Me()===e(F)?"active":""}`),w(Ye,Me()),w(ce,(Me(),x(()=>Q[Me()])))}),ye("click",it,()=>se(Me())),m($e,it)}),i(ie);var Pe=u(ie,2),Ve=o(Pe),Ze=o(Ve),ve=o(Ze,!0);i(Ze);var Ce=u(Ze,2);i(Ve);var Qe=u(Ve,2);{var Xe=$e=>{var ot=c_();xt(ot,5,()=>P,Ua,(Me,it)=>{let ft=()=>e(it).day;var Ye=l_(),Y=o(Ye,!0);i(Ye),q(()=>{_e(Ye,1,`schedule-dropdown-item ${ft()===e(F)?"selected":""}`),w(Y,(ft(),x(()=>Q[ft()])))}),ye("click",Ye,()=>se(ft())),m(Me,Ye)}),i(ot),m($e,ot)};E(Qe,$e=>{e($)&&$e(Xe)})}i(Pe),i(re);var ze=u(re,2),We=o(ze),Te=o(We),ue=o(Te);i(Te);var be=u(Te,2),ke=o(be);i(be),i(We);var Fe=u(We,2);{var Re=$e=>{var ot=d_();m($e,ot)},et=$e=>{var ot=mt(),Me=Je(ot);{var it=Ye=>{var Y=u_(),ce=u(o(Y),4),De=o(ce,!0);i(ce);var U=u(ce,2);i(Y),q(()=>w(De,e(p))),ye("click",U,j),m(Ye,Y)},ft=Ye=>{var Y=mt(),ce=Je(Y);{var De=ne=>{var fe=mt(),z=Je(fe);Is(z,()=>e(W),B=>{var I=p_();xt(I,5,()=>e(g),Ua,(G,Z,le)=>{var N=f_();Wa(N,`--card-index: ${le};`);var M=o(N),H=o(M),pe=o(H,!0);i(H);var ee=u(H,2),Ae=o(ee,!0);i(ee),i(M);var Ue=u(M,2),Le=o(Ue),He=u(o(Le),2),Ie=o(He,!0);i(He),i(Le);var nt=u(Le,2);{var bt=pt=>{var vt=v_(),Tt=u(o(vt),2),Ot=o(Tt,!0);i(Tt),i(vt),q(()=>w(Ot,(e(Z),x(()=>e(Z).teacher)))),m(pt,vt)};E(nt,pt=>{e(Z),x(()=>e(Z).teacher)&&pt(bt)})}i(Ue),i(N),q(()=>{_e(N,1,`class-card ${e(Z),x(()=>e(Z).color)??""}`),w(pe,(e(Z),x(()=>e(Z).name))),w(Ae,(e(Z),x(()=>e(Z).time))),w(Ie,(e(Z),x(()=>e(Z).scheduleType==="activity"?"No room":e(Z).room)))}),m(G,N)}),i(I),m(B,I)}),m(ne,fe)},U=ne=>{var fe=m_(),z=u(o(fe),4),B=o(z);i(z),i(fe),q(()=>w(B,`You don't have any classes scheduled for ${e(b)??""}. Enjoy your free day!`)),m(ne,fe)};E(ce,ne=>{e(g),x(()=>e(g).length>0)?ne(De):ne(U,!1)},!0)}m(Ye,Y)};E(Me,Ye=>{e(p)?Ye(it):Ye(ft,!1)},!0)}m($e,ot)};E(Fe,$e=>{e(d)?$e(Re):$e(et,!1)})}i(ze),i(V),q(()=>{w(de,`${D??""}, ${T??""} ${C??""}`),w(ve,(e(F),x(()=>Q[e(F)]||"Select Day"))),_e(Ce,1,`material-symbols-outlined schedule-dropdown-icon ${e($)?"open":""}`),w(ue,`${e(b)??""} Classes`),ke.disabled=e(d)}),ye("click",Ve,X),ye("click",ke,j),ye("click",V,R),ye("keydown",V,R),m(s,V),za(),r()}const __=300*1e3,b_="student_doc_requests_";function y_(){const s={requestHistory:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Hs(s);function n(D){return`${b_}${D}`}function l(D){return!D||!D.timestamp?!1:Date.now()-D.timestamp<__}function c(D){try{const S=n(D),L=localStorage.getItem(S);if(L)return JSON.parse(L).data}catch(S){console.warn("Failed to retrieve cached document request data:",S)}return null}function d(D){try{const S=n(D),L=localStorage.getItem(S);if(L){const F=JSON.parse(L);if(l(F))return F.data}}catch(S){console.warn("Failed to retrieve cached document request data:",S)}return null}function f(D,S){try{const L=n(D),F={data:S,timestamp:Date.now()};localStorage.setItem(L,JSON.stringify(F))}catch(L){console.warn("Failed to cache document request data:",L)}}function p(D){return D}async function h(D=!1){try{r(P=>({...P,isLoading:!D,isRefreshing:D,error:null}));const S=await da.get("/api/document-requests?action=student");if(!S.success)throw new Error(S.error||"Failed to load document requests");const L=S.data.map(P=>({id:P.id,requestId:P.requestId,type:P.documentType,purpose:P.purpose,status:P.status,requestedDate:P.submittedDate,completedDate:P.completedDate,cancelledDate:P.cancelledDate,tentativeDate:P.tentativeDate,payment:P.payment,paymentAmount:P.paymentAmount,paymentStatus:P.paymentStatus||"pending",processedBy:P.processedBy,adminName:P.processedBy,adminNote:P.adminNote,rejectionReason:P.rejectionReason,messages:P.messages||[],lastReadAt:P.lastReadAt||null}));r(P=>({...P,requestHistory:L,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()}));const F={requestHistory:L,lastUpdated:new Date().toISOString()};let j;r(P=>(j=P.currentStudentId,P)),j&&f(j,F)}catch(S){console.error("Error loading document requests:",S);let L;r(j=>(L=j.currentStudentId,j));const F=c(L);F?(r(j=>({...j,requestHistory:F.requestHistory||[],lastUpdated:F.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Se.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:S.message,requestHistory:[]}))}}function g(D){const S=d(D);return S?(r(L=>({...L,...S,currentStudentId:D,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(L=>({...L,currentStudentId:D,isLoading:!0,isRefreshing:!1,error:null})),!1)}async function b(D){try{const S=n(D);localStorage.removeItem(S)}catch(S){console.warn("Failed to clear document request cache:",S)}return r(S=>({...s,currentStudentId:D,isLoading:!0})),await C.loadDocumentRequests(!1)}async function y(D,S){try{const L=await da.post("/api/document-requests",{action:"create",documentType:D,purpose:S.trim(),paymentAmount:null,isUrgent:!1});if(!L.success)throw new Error(L.error||"Failed to submit request");return await C.loadDocumentRequests(!1),{success:!0}}catch(L){return console.error("Error submitting document request:",L),{success:!1,error:L.message}}}async function k(D){try{const S=await da.post("/api/document-requests",{action:"cancel",requestId:D});if(!S.success)throw new Error(S.error||"Failed to cancel request");return await C.loadDocumentRequests(!1),{success:!0}}catch(S){return console.error("Error cancelling document request:",S),{success:!1,error:S.message}}}async function A(D){try{const S=await da.post("/api/document-requests",{action:"markAsRead",requestId:D});return S.success&&r(L=>({...L,requestHistory:L.requestHistory.map(F=>F.requestId===D?{...F,lastReadAt:S.data.lastReadAt}:F)})),{success:S.success}}catch(S){return console.error("Error marking messages as read:",S),{success:!1,error:S.message}}}async function T(D){try{const S=await da.get(`/api/document-requests?action=single&requestId=${D}`);if(!S.success)throw new Error(S.error||"Failed to load request details");return{success:!0,data:{...S.data,type:S.data.documentType,requestedDate:S.data.submittedDate,paymentAmount:S.data.paymentAmount,paymentStatus:S.data.paymentStatus??"pending"}}}catch(S){return console.error("Error fetching request details:",S),{success:!1,error:S.message}}}const C={subscribe:t,init:g,loadDocumentRequests:h,forceRefresh:b,submitRequest:y,cancelRequest:k,markMessagesAsRead:A,getRequestDetails:T,getCachedData:D=>c(D)};return C}const gr=y_();function xc(s,t){s.target.closest(".custom-dropdown")||v(t,!1)}function w_(s,t){v(t,!e(t))}var x_=(s,t,a)=>t(e(a)),S_=_('<button><div class="doc-dropdown-item-content"><span class="doc-dropdown-item-name"> </span> <span class="doc-dropdown-item-desc"> </span></div></button>'),k_=_('<div class="dropdown-menu-document"></div>'),A_=_('<div class="request-form-section"><div class="form-container"><div class="form-header"><h2 class="form-title">New Document Request</h2> <p class="form-subtitle">Fill out the form below to request a document</p></div> <div class="form-content"><div class="form-group"><label class="form-label" for="document-type-dropdown"><span class="material-symbols-outlined form-icon">description</span> Document Type</label> <div class="custom-dropdown"><button id="document-type-dropdown" class="dropdown-toggle"><span><!></span> <span>expand_more</span></button> <!></div></div> <div class="form-group"><label class="form-label" for="description"><span class="material-symbols-outlined form-icon">edit_note</span> Purpose & Details</label> <textarea id="description" class="form-textarea enhanced" placeholder="Please describe the purpose of your request and any specific requirements..." rows="5" maxlength="200"></textarea> <div class="form-help"><span class="material-symbols-outlined help-icon">info</span> Be specific about your needs to help us process your request efficiently <span class="char-counter"> </span></div></div> <div class="document-form-actions"><button class="document-cancel-button">Cancel</button> <button class="submit-button"><!></button></div></div></div></div>'),D_=_('<div class="error-message" style="padding: 20px; background: #fee; border-radius: 8px; color: #c33; margin: 20px 0;"><strong>Error:</strong> </div>'),C_=_('<div class="loading-message"><div class="system-loader"></div> Loading your document requests...</div>'),T_=_('<div class="no-requests-message"><span class="material-symbols-outlined">description</span> <p>No document requests found</p> <p class="subtitle">Start by requesting your first document above</p></div>'),E_=(s,t,a)=>t(e(a)),F_=_('<span class="chat-badge"> </span>'),N_=_('<div class="request-footer completed-footer"><span class="footer-info"> </span></div>'),$_=_("<span> </span>"),P_=_('<div class="request-footer processing-footer"><span class="footer-info"><!> <!></span></div>'),L_=_('<div class="request-footer pending-footer"><span class="footer-info">Awaiting review</span></div>'),M_=_('<div class="request-footer cancelled-footer"><span class="footer-info"> </span></div>'),I_=_('<div class="request-footer rejected-footer"><span class="footer-info"> </span></div>'),R_=_('<div><div class="request-main-content"><div class="request-status-icon"><span class="material-symbols-outlined"> </span></div> <div class="request-content"><div class="request-header"><div class="request-info"><h3 class="request-title"> </h3> <p class="request-date"> </p></div> <div class="request-header-actions"><div> </div> <button class="chat-indicator-btn"><span class="material-symbols-outlined">chat_bubble</span> <!></button></div></div></div></div> <!></div>'),O_=_('<div class="request-history-grid"></div>'),j_=_('<div class="document-request-container"><div class="document-header"><div class="header-content"><h1 class="page-title">Document Requests</h1> <p class="page-subtitle">Request new documents or check existing requests</p></div></div> <div class="quick-actions-section"><div class="quick-actions-header"><h2 class="quick-actions-title">Request a Document</h2> <div style="display: flex; gap: 8px;"><button class="request-new-button"><span class="material-symbols-outlined"> </span> <span class="request-new-button-text"> </span></button></div></div></div> <!> <div class="request-history-section"><div class="request-history-header"><h2 class="section-title">Request History</h2> <button class="refresh-button" title="Refresh document requests"><span class="material-symbols-outlined">refresh</span></button></div> <!> <!></div></div>');function q_(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(gr,"$studentDocumentRequestStore",a),l=()=>Ja(gs,"$authStore",a);let c=Ma(t,"openRequestId",15,null),d=ut(!1),f=ut(""),p=ut(""),h=ut(!1),g=ut(!1),b,y=ea(()=>n().requestHistory),k=ea(()=>n().isLoading),A=ea(()=>n().error);function T(ue){v(f,ue.id,!0),v(g,!1)}const C=[{id:"Transcript of Records (TOR)",name:"Transcript of Records (TOR)",description:"Official academic record"},{id:"Enrollment Certificate",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"Grade Report",name:"Grade Report",description:"Semester grade report"},{id:"Diploma",name:"Diploma",description:"Official graduation certificate"},{id:"Certificate",name:"Certificate",description:"Academic achievement certificate"},{id:"Good Moral",name:"Good Moral",description:"Certificate of good moral character"},{id:"Grade Slip",name:"Grade Slip",description:"Grade slip for specific period"}];async function D(){const ue=l();ue.isAuthenticated&&ue.userData?.id&&await gr.forceRefresh(ue.userData.id)}Ya(()=>{const ue=l();if(ue.isAuthenticated&&ue.userData?.id){const be=gr.init(ue.userData.id);gr.loadDocumentRequests(be),b=setInterval(()=>{const ke=l();ke.isAuthenticated&&ke.userData?.id&&gr.loadDocumentRequests(!0)},30*1e3)}}),Es(()=>{if(c()&&e(y).length>0){const ue=e(y).find(be=>be.requestId===c());ue&&W(ue),c(null)}}),ei(()=>{b&&clearInterval(b)});function S(ue){return{on_hold:"On Hold",verifying:"Verifying",processing:"For Processing",for_pickup:"For Pick Up",released:"Released",rejected:"Rejected",cancelled:"Cancelled"}[ue]||ue}function L(ue){if(!ue)return"N/A";const be=new Date(ue),ke=String(be.getMonth()+1).padStart(2,"0"),Fe=String(be.getDate()).padStart(2,"0"),Re=be.getFullYear();return`${ke}/${Fe}/${Re}`}async function F(){if(!(!e(f)||!e(p).trim()))try{v(h,!0);const ue=C.find(ke=>ke.id===e(f))?.name,be=await gr.submitRequest(ue||e(f),e(p));be.success?(j(),Se.success("Document request submitted successfully")):Se.error(be.error||"Failed to submit request")}catch(ue){console.error("Error submitting request:",ue),Se.error("Failed to submit document request")}finally{v(h,!1)}}function j(){v(d,!e(d)),e(d)?setTimeout(()=>{const ue=document.querySelector(".request-form-section");ue&&ue.scrollIntoView({behavior:"smooth",block:"center"})},100):(v(f,""),v(p,""),v(g,!1))}function P(ue){switch(ue){case"on_hold":return"pause_circle";case"verifying":return"fact_check";case"processing":return"sync";case"for_pickup":return"hand_package";case"released":return"check_circle";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}function Q(ue){if(!ue.messages||ue.messages.length===0)return 0;if(!ue.lastReadAt)return ue.messages.length;const be=new Date(ue.lastReadAt).getTime();return ue.messages.filter(ke=>new Date(ke.created_at).getTime()>be).length}async function W(ue){try{const be=await gr.getRequestDetails(ue.requestId);be.success?(tu.open(be.data,$,()=>gr.loadDocumentRequests(!1)),await gr.markMessagesAsRead(ue.requestId)):(console.error("Failed to fetch request details:",be.error),Se.error("Failed to load request details. Please try again."))}catch(be){console.error("Error fetching request details:",be),Se.error("An error occurred while loading the request details.")}}async function $(ue){try{const be=await gr.cancelRequest(ue.requestId);be.success?Se.success("Document request cancelled successfully"):(console.error("Failed to cancel request:",be.error),Se.error(be.error||"Failed to cancel request"))}catch(be){console.error("Error cancelling request:",be),Se.error("Failed to cancel request")}}var R=j_();R.__click=[xc,g],R.__keydown=[xc,g];var X=u(o(R),2),se=o(X),V=u(o(se),2),re=o(V);re.__click=j;var me=o(re),je=o(me,!0);i(me);var de=u(me,2),ie=o(de,!0);i(de),i(re),i(V),i(se),i(X);var Pe=u(X,2);{var Ve=ue=>{var be=A_(),ke=o(be),Fe=u(o(ke),2),Re=o(Fe),et=u(o(Re),2),$e=o(et);$e.__click=[w_,g];var ot=o($e),Me=o(ot);{var it=M=>{var H=Sa();q(pe=>w(H,pe),[()=>C.find(pe=>pe.id===e(f))?.name||"Select Document Type"]),m(M,H)},ft=M=>{var H=Sa("Choose the document you need");m(M,H)};E(Me,M=>{e(f)?M(it):M(ft,!1)})}i(ot);var Ye=u(ot,2);i($e);var Y=u($e,2);{var ce=M=>{var H=k_();xt(H,21,()=>C,Ua,(pe,ee)=>{var Ae=S_();Ae.__click=[x_,T,ee];var Ue=o(Ae),Le=o(Ue),He=o(Le,!0);i(Le);var Ie=u(Le,2),nt=o(Ie,!0);i(Ie),i(Ue),i(Ae),q(()=>{_e(Ae,1,`doc-dropdown-item ${e(ee).id===e(f)?"selected":""}`),w(He,e(ee).name),w(nt,e(ee).description)}),m(pe,Ae)}),i(H),m(M,H)};E(Y,M=>{e(g)&&M(ce)})}i(et),i(Re);var De=u(Re,2),U=u(o(De),2);xn(U);var ne=u(U,2),fe=u(o(ne),2),z=o(fe);i(fe),i(ne),i(De);var B=u(De,2),I=o(B);I.__click=j;var G=u(I,2);G.__click=F;var Z=o(G);{var le=M=>{var H=Sa("Submitting...");m(M,H)},N=M=>{var H=Sa("Submit");m(M,H)};E(Z,M=>{e(h)?M(le):M(N,!1)})}i(G),i(B),i(Fe),i(ke),i(be),q(M=>{_e(Ye,1,`material-symbols-outlined dropdown-icon ${e(g)?"open":""}`),w(z,`${e(p).length??""}/200`),I.disabled=e(h),G.disabled=M},[()=>!e(f)||!e(p).trim()||e(h)]),oa(U,()=>e(p),M=>v(p,M)),m(ue,be)};E(Pe,ue=>{e(d)&&ue(Ve)})}var Ze=u(Pe,2),ve=o(Ze),Ce=u(o(ve),2);Ce.__click=D,i(ve);var Qe=u(ve,2);{var Xe=ue=>{var be=D_(),ke=u(o(be));i(be),q(()=>w(ke,` ${e(A)??""}`)),m(ue,be)};E(Qe,ue=>{e(A)&&ue(Xe)})}var ze=u(Qe,2);{var We=ue=>{var be=C_();m(ue,be)},Te=ue=>{var be=mt(),ke=Je(be);{var Fe=et=>{var $e=T_();m(et,$e)},Re=et=>{var $e=O_();xt($e,23,()=>e(y),ot=>ot.id,(ot,Me,it)=>{var ft=R_();ft.__click=[E_,W,Me];var Ye=o(ft),Y=o(Ye),ce=o(Y),De=o(ce,!0);i(ce),i(Y);var U=u(Y,2),ne=o(U),fe=o(ne),z=o(fe),B=o(z,!0);i(z);var I=u(z,2),G=o(I);i(I),i(fe);var Z=u(fe,2),le=o(Z),N=o(le,!0);i(le);var M=u(le,2),H=u(o(M),2);{var pe=Le=>{var He=F_(),Ie=o(He,!0);i(He),q(nt=>w(Ie,nt),[()=>Q(e(Me))]),m(Le,He)};E(H,Le=>{Q(e(Me))>0&&Le(pe)})}i(M),i(Z),i(ne),i(U),i(Ye);var ee=u(Ye,2);{var Ae=Le=>{var He=N_(),Ie=o(He),nt=o(Ie);i(Ie),i(He),q(()=>w(nt,`${e(Me).status==="released"?"Released":"Ready for pick up"}${e(Me).processedBy?` by ${e(Me).processedBy}`:""}`)),m(Le,He)},Ue=Le=>{var He=mt(),Ie=Je(He);{var nt=pt=>{var vt=P_(),Tt=o(vt),Ot=o(Tt);{var la=Pt=>{var Yt=Sa();q(()=>w(Yt,`Note${e(Me).processedBy?` by ${e(Me).processedBy}`:""}: ${e(Me).adminNote??""}`)),m(Pt,Yt)},sa=Pt=>{var Yt=Sa();q(()=>w(Yt,e(Me).processedBy?`Being ${e(Me).status==="verifying"?"verified":"processed"} by ${e(Me).processedBy}`:`${e(Me).status==="verifying"?"Verifying":"Processing"} your request`)),m(Pt,Yt)};E(Ot,Pt=>{e(Me).adminNote?Pt(la):Pt(sa,!1)})}var zt=u(Ot,2);{var qt=Pt=>{var Yt=$_(),Ut=o(Yt);i(Yt),q(()=>w(Ut,` Tentative: ${e(Me).tentativeDate??""}`)),m(Pt,Yt)};E(zt,Pt=>{e(Me).tentativeDate&&e(Me).status==="processing"&&Pt(qt)})}i(Tt),i(vt),m(pt,vt)},bt=pt=>{var vt=mt(),Tt=Je(vt);{var Ot=sa=>{var zt=L_();m(sa,zt)},la=sa=>{var zt=mt(),qt=Je(zt);{var Pt=Ut=>{var Et=M_(),ta=o(Et),fa=o(ta);i(ta),i(Et),q(oe=>w(fa,`Cancelled on ${oe??""}`),[()=>L(e(Me).cancelledDate||e(Me).submittedDate)]),m(Ut,Et)},Yt=Ut=>{var Et=mt(),ta=Je(Et);{var fa=oe=>{var Ee=I_(),dt=o(Ee),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Rejected${e(Me).processedBy?` by ${e(Me).processedBy}`:""}${e(Me).rejectionReason?`: ${e(Me).rejectionReason}`:""}`)),m(oe,Ee)};E(ta,oe=>{e(Me).status==="rejected"&&oe(fa)},!0)}m(Ut,Et)};E(qt,Ut=>{e(Me).status==="cancelled"?Ut(Pt):Ut(Yt,!1)},!0)}m(sa,zt)};E(Tt,sa=>{e(Me).status==="on_hold"?sa(Ot):sa(la,!1)},!0)}m(pt,vt)};E(Ie,pt=>{e(Me).status==="processing"||e(Me).status==="verifying"?pt(nt):pt(bt,!1)},!0)}m(Le,He)};E(ee,Le=>{e(Me).status==="released"||e(Me).status==="for_pickup"?Le(Ae):Le(Ue,!1)})}i(ft),q((Le,He,Ie)=>{_e(ft,1,`request-card ${e(Me).status??""}`),Wa(ft,`--card-index: ${e(it)??""};`),w(De,Le),w(B,e(Me).type),w(G,`Requested on ${e(Me).requestedDate??""}`),_e(le,1,`student-status-badge status-${e(Me).status??""}`),w(N,He),$t(M,"title",Ie)},[()=>P(e(Me).status),()=>S(e(Me).status),()=>Q(e(Me))>0?`${Q(e(Me))} unread message${Q(e(Me))!==1?"s":""}`:"View messages"]),m(ot,ft)}),i($e),m(et,$e)};E(ke,et=>{e(y).length===0?et(Fe):et(Re,!1)},!0)}m(ue,be)};E(ze,ue=>{e(k)?ue(We):ue(Te,!1)})}i(Ze),i(R),q(()=>{re.disabled=e(k),w(je,e(d)?"remove":"add"),w(ie,e(d)?"Cancel":"New Document"),Ce.disabled=e(k)}),m(s,R),za(),r()}Ps(["click","keydown"]);function z_(s,t){v(t,!e(t))}function G_(s,t){t()}function V_(s,t,a){const r=e(t).filter(n=>n.isRead).length;us.confirm("Clear All Read Notifications",`<p>Are you sure you want to delete all <strong>${r}</strong> read notification${r!==1?"s":""}?</p>
       <p style="margin-top: 8px; color: var(--md-sys-color-on-surface-variant); font-size: 0.9rem;">This action cannot be undone.</p>`,async()=>{await a(),Se.success(`${r} read notification${r!==1?"s":""} cleared successfully`)},()=>{},{size:"small"})}var B_=(s,t,a)=>t(e(a).value),W_=_('<span class="count-badge"> </span>'),H_=_('<button><span class="material-symbols-outlined"> </span> <span> </span> <!></button>'),U_=_('<div class="filter-dropdown-menu"></div>'),Y_=_('<button class="notifications-action-btn mark-all-read" title="Mark All Read"><span class="material-symbols-outlined">done_all</span></button>'),Q_=_('<button class="notifications-action-btn clear-read" title="Clear Read"><span class="material-symbols-outlined">clear_all</span></button>'),K_=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading notifications...</p></div>'),J_=_('<div class="error-state"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Notifications</h3> <p> </p> <button class="retry-btn">Reload</button></div>'),X_=(s,t,a)=>t(e(a)),Z_=(s,t,a)=>s.key==="Enter"&&t(e(a)),eb=_('<div class="admin-note"><span class="material-symbols-outlined">note</span> <div class="note-content"><span class="note-label">Admin Note:</span> <span class="note-text"> </span></div></div>'),tb=_('<div class="rejection-reason"><span class="material-symbols-outlined">error</span> <div class="reason-content"><span class="reason-label">Rejection Reason:</span> <span class="reason-text"> </span></div></div>'),ab=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},sb=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},rb=_('<div role="button" tabindex="0"><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p> <!> <!></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),ib=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},nb=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},ob=_('<div><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),lb=_('<div class="notifications-list"></div>'),cb=_('<div class="no-notifications"><div class="no-notifications-icon"><span class="material-symbols-outlined"> </span></div> <h3> </h3> <p> </p></div>'),db=_('<div class="notification-container"><div class="notification-header"><div class="header-content"><h1 class="page-title">Notifications</h1> <p class="page-subtitle">Stay updated with your academic activities <span class="notification-badge"> </span></p></div></div> <div class="filter-actions-section"><div class="filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="actions-section"><!> <!></div></div> <div class="notifications-section"><!></div></div>');function ub(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(wr,"$studentNotificationStore",a),l=()=>Ja(gs,"$authStore",a);let c=ea(()=>n().notifications),d=ea(()=>n().isLoading),f=ea(()=>n().error),p=ea(()=>n().unreadCount);const h=[{value:"all",label:"All Notifications",icon:"notifications"},{value:"unread",label:"Unread Only",icon:"mark_email_unread"},{value:"grade",label:"Grades",icon:"grade"},{value:"document",label:"Document Requests",icon:"description"}];let g=ut("all"),b=ut(!1);function y(Y){v(g,Y,!0),v(b,!1),wr.setFilter(Y),F()}function k(Y){Y.target.closest(".filter-dropdown")||v(b,!1)}function A(Y){const ce=e(c).find(De=>De.id===Y);ce?j(Y,!ce.isRead):console.warn("Notification not found for toggle:",Y)}function T(Y){const ce=e(c).find(U=>U.id===Y),De=ce?ce.title:"this notification";us.confirm("Delete Notification",`<p>Are you sure you want to delete <strong>"${De}"</strong>?</p>
       <p style="margin-top: 8px; color: var(--md-sys-color-on-surface-variant); font-size: 0.9rem;">This action cannot be undone.</p>`,async()=>{await P(Y),Se.success("Notification deleted successfully")},()=>{},{size:"small"})}function C(Y){if(Y.type==="document"||Y.type==="document_request"){const ce=Y.metadata?.relatedId;t.onnavigate&&t.onnavigate({detail:{section:"documents",requestId:ce}})}}function D(Y){const ce=new Date(Y),De=new Date,U=Math.floor((De-ce)/(1e3*60*60));if(U<1){const ne=Math.floor((De-ce)/6e4);return ne<=1?"Just now":`${ne} minutes ago`}else{if(U<24)return`${U} hour${U>1?"s":""} ago`;{const ne=Math.floor(U/24);return ne<7?`${ne} day${ne>1?"s":""} ago`:ce.toLocaleDateString("en-US",{month:"short",day:"numeric",year:ce.getFullYear()!==De.getFullYear()?"numeric":void 0})}}}function S(Y){const ce=h.find(De=>De.value===Y);return ce?ce.label:"All Notifications"}function L(Y){const ce=h.find(De=>De.value===Y);return ce?ce.icon:"notifications"}async function F(){const Y=l().userData;if(!Y?.id){v(f,"User not authenticated");return}await wr.loadNotifications(Y.id,e(g))}async function j(Y,ce){const De=l().userData;De?.id&&await wr.updateNotificationStatus(De.id,Y,ce)}async function P(Y){const ce=l().userData;ce?.id&&await wr.deleteNotification(ce.id,Y)}async function Q(){const Y=l().userData;Y?.id&&await wr.markAllAsRead(Y.id)}async function W(){const Y=l().userData;Y?.id&&await wr.clearAllRead(Y.id)}Ya(()=>{if(l().userData?.id){const Y=l().userData;wr.init(Y.id,e(g)),F()}});let $=ea(()=>Array.isArray(e(c))?e(g)==="all"?e(c):e(g)==="unread"?e(c).filter(Y=>!Y.isRead):e(c).filter(Y=>Y.type===e(g)):[]),R=ut(0),X=ut(0),se=ut("all");Es(()=>{(e(g)!==e(se)||e($).length!==e(X))&&(or(R),v(se,e(g),!0),v(X,e($).length,!0))});var V=db();ye("click",Zs,k);var re=o(V),me=o(re),je=u(o(me),2),de=u(o(je)),ie=o(de);i(de),i(je),i(me),i(re);var Pe=u(re,2),Ve=o(Pe),Ze=o(Ve),ve=o(Ze);ve.__click=[z_,b];var Ce=o(ve),Qe=o(Ce),Xe=o(Qe,!0);i(Qe);var ze=u(Qe,2),We=o(ze,!0);i(ze),i(Ce);var Te=u(Ce,2);let ue;i(ve);var be=u(ve,2);{var ke=Y=>{var ce=U_();xt(ce,21,()=>h,Ua,(De,U)=>{var ne=H_();let fe;ne.__click=[B_,y,U];var z=o(ne),B=o(z,!0);i(z);var I=u(z,2),G=o(I,!0);i(I);var Z=u(I,2);{var le=N=>{var M=W_(),H=o(M,!0);i(M),q(()=>w(H,e(p))),m(N,M)};E(Z,N=>{e(U).value==="unread"&&N(le)})}i(ne),q(N=>{fe=_e(ne,1,"filter-dropdown-item",null,fe,N),w(B,e(U).icon),w(G,e(U).label)},[()=>({active:e(U).value===e(g)})]),m(De,ne)}),i(ce),m(Y,ce)};E(be,Y=>{e(b)&&Y(ke)})}i(Ze),i(Ve);var Fe=u(Ve,2),Re=o(Fe);{var et=Y=>{var ce=Y_();ce.__click=[G_,Q],m(Y,ce)};E(Re,Y=>{e(p)>0&&Y(et)})}var $e=u(Re,2);{var ot=Y=>{var ce=Q_();ce.__click=[V_,c,W],m(Y,ce)};E($e,Y=>{e(c).some(ce=>ce.isRead)&&Y(ot)})}i(Fe),i(Pe);var Me=u(Pe,2),it=o(Me);{var ft=Y=>{var ce=K_();m(Y,ce)},Ye=Y=>{var ce=mt(),De=Je(ce);{var U=fe=>{var z=J_(),B=u(o(z),4),I=o(B,!0);i(B);var G=u(B,2);G.__click=F,i(z),q(()=>w(I,e(f))),m(fe,z)},ne=fe=>{var z=mt(),B=Je(z);{var I=Z=>{var le=mt(),N=Je(le);Is(N,()=>e(R),M=>{var H=lb();xt(H,23,()=>e($),pe=>pe.id,(pe,ee,Ae)=>{var Ue=mt(),Le=Je(Ue);{var He=nt=>{var bt=rb();bt.__click=[X_,C,ee],bt.__keydown=[Z_,C,ee];var pt=o(bt),vt=o(pt),Tt=o(vt,!0);i(vt);var Ot=u(vt,2),la=o(Ot,!0);i(Ot),i(pt);var sa=u(pt,2),zt=o(sa),qt=o(zt),Pt=o(qt,!0);i(qt);var Yt=u(qt,2);{var Ut=Oe=>{var lt=eb(),Rt=u(o(lt),2),Ht=u(o(Rt),2),rt=o(Ht,!0);i(Ht),i(Rt),i(lt),q(()=>w(rt,e(ee).adminNote)),m(Oe,lt)};E(Yt,Oe=>{e(ee).adminNote&&Oe(Ut)})}var Et=u(Yt,2);{var ta=Oe=>{var lt=tb(),Rt=u(o(lt),2),Ht=u(o(Rt),2),rt=o(Ht,!0);i(Ht),i(Rt),i(lt),q(()=>w(rt,e(ee).rejectionReason)),m(Oe,lt)};E(Et,Oe=>{e(ee).rejectionReason&&Oe(ta)})}i(zt);var fa=u(zt,2),oe=o(fa);oe.__click=[ab,A,ee];var Ee=o(oe),dt=o(Ee,!0);i(Ee),i(oe);var we=u(oe,2);we.__click=[sb,T,ee],i(fa),i(sa),i(bt),q(Oe=>{_e(bt,1,`notification-card ${e(ee).isRead?"read":"unread"} clickable`),Wa(bt,`--card-index: ${e(Ae)??""};`),w(Tt,e(ee).title),w(la,Oe),w(Pt,e(ee).message),$t(oe,"title",e(ee).isRead?"Mark as unread":"Mark as read"),w(dt,e(ee).isRead?"mark_email_unread":"mark_email_read")},[()=>D(e(ee).timestamp)]),m(nt,bt)},Ie=nt=>{var bt=ob(),pt=o(bt),vt=o(pt),Tt=o(vt,!0);i(vt);var Ot=u(vt,2),la=o(Ot,!0);i(Ot),i(pt);var sa=u(pt,2),zt=o(sa),qt=o(zt),Pt=o(qt,!0);i(qt),i(zt);var Yt=u(zt,2),Ut=o(Yt);Ut.__click=[ib,A,ee];var Et=o(Ut),ta=o(Et,!0);i(Et),i(Ut);var fa=u(Ut,2);fa.__click=[nb,T,ee],i(Yt),i(sa),i(bt),q(oe=>{_e(bt,1,`notification-card ${e(ee).isRead?"read":"unread"}`),Wa(bt,`--card-index: ${e(Ae)??""};`),w(Tt,e(ee).title),w(la,oe),w(Pt,e(ee).message),$t(Ut,"title",e(ee).isRead?"Mark as unread":"Mark as read"),w(ta,e(ee).isRead?"mark_email_unread":"mark_email_read")},[()=>D(e(ee).timestamp)]),m(nt,bt)};E(Le,nt=>{e(ee).type==="document"||e(ee).type==="document_request"?nt(He):nt(Ie,!1)})}m(pe,Ue)}),i(H),m(M,H)}),m(Z,le)},G=Z=>{var le=cb(),N=o(le),M=o(N),H=o(M,!0);i(M),i(N);var pe=u(N,2),ee=o(pe,!0);i(pe);var Ae=u(pe,2),Ue=o(Ae,!0);i(Ae),i(le),q(Le=>{w(H,e(g)==="unread"?"mark_email_read":"notifications_off"),w(ee,e(g)==="unread"?"All Caught Up!":"No Notifications"),w(Ue,Le)},[()=>e(g)==="unread"?"You have no unread notifications. Great job staying on top of things!":e(g)==="all"?"You don't have any notifications yet.":`No ${S(e(g)).toLowerCase()} notifications found.`]),m(Z,le)};E(B,Z=>{e($).length>0?Z(I):Z(G,!1)},!0)}m(fe,z)};E(De,fe=>{e(f)?fe(U):fe(ne,!1)},!0)}m(Y,ce)};E(it,Y=>{e(d)?Y(ft):Y(Ye,!1)})}i(Me),i(V),q((Y,ce,De)=>{w(ie,`${e(p)??""} unread`),w(Xe,Y),w(We,ce),ue=_e(Te,1,"material-symbols-outlined dropdown-arrow",null,ue,De)},[()=>L(e(g)),()=>S(e(g)),()=>({rotated:e(b)})]),m(s,V),za(),r()}Ps(["click","keydown"]);const vb=300*1e3,fb="student_todolist_";function pb(){const s={todos:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Hs(s);function n(C){return`${fb}${C}`}function l(C){return!C||!C.timestamp?!1:Date.now()-C.timestamp<vb}function c(C){try{const D=n(C),S=localStorage.getItem(D);if(S)return JSON.parse(S).data}catch(D){console.warn("Failed to retrieve cached student todolist data:",D)}return null}function d(C){try{const D=n(C),S=localStorage.getItem(D);if(S){const L=JSON.parse(S);if(l(L))return L.data}}catch(D){console.warn("Failed to retrieve cached student todolist data:",D)}return null}function f(C,D){try{const S=n(C),L={data:D,timestamp:Date.now()};localStorage.setItem(S,JSON.stringify(L))}catch(S){console.warn("Failed to cache student todolist data:",S)}}async function p(C,D=!1){try{r(F=>({...F,isLoading:!D,isRefreshing:D,error:null,currentStudentId:C}));const S=await da.get(`/api/student-todos?studentId=${C}`);if(!S.success)throw new Error(S.error||"Failed to fetch todos");const L=S.data||[];r(F=>({...F,todos:L,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),f(C,{todos:L,lastUpdated:new Date().toISOString()})}catch(S){console.error("Error loading student todos:",S);let L;r(j=>(L=j.currentStudentId,j));const F=c(L);F?(r(j=>({...j,isLoading:!1,isRefreshing:!1,error:null,todos:F.todos||[],lastUpdated:F.lastUpdated})),Se.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:S.message,todos:[]}))}}async function h(C,D){try{const S=await da.post("/api/student-todos",{studentId:C,...D});if(!S.success)throw new Error(S.error||"Failed to add todo");return r(L=>{const F=[S.data,...L.todos];return f(C,{todos:F,lastUpdated:new Date().toISOString()}),{...L,todos:F,lastUpdated:new Date().toISOString()}}),{success:!0,data:S.data}}catch(S){return console.error("Error adding todo:",S),{success:!1,error:S.message}}}async function g(C,D,S){try{const L=await da.put("/api/student-todos",{id:D,studentId:C,action:"update",...S});if(!L.success)throw new Error(L.error||"Failed to update todo");return r(F=>{const j=F.todos.map(P=>P.id===D?L.data:P);return f(C,{todos:j,lastUpdated:new Date().toISOString()}),{...F,todos:j,lastUpdated:new Date().toISOString()}}),{success:!0,data:L.data}}catch(L){return console.error("Error updating todo:",L),{success:!1,error:L.message}}}async function b(C,D){try{const S=await da.put("/api/student-todos",{id:D,studentId:C,action:"toggle"});if(!S.success)throw new Error(S.error||"Failed to toggle todo");return r(L=>{const F=L.todos.map(j=>j.id===D?S.data:j);return f(C,{todos:F,lastUpdated:new Date().toISOString()}),{...L,todos:F,lastUpdated:new Date().toISOString()}}),{success:!0,data:S.data}}catch(S){return console.error("Error toggling todo:",S),{success:!1,error:S.message}}}async function y(C,D){try{const S=await da.delete("/api/student-todos",{id:D,studentId:C});if(!S.success)throw new Error(S.error||"Failed to delete todo");return r(L=>{const F=L.todos.filter(j=>j.id!==D);return f(C,{todos:F,lastUpdated:new Date().toISOString()}),{...L,todos:F,lastUpdated:new Date().toISOString()}}),{success:!0}}catch(S){return console.error("Error deleting todo:",S),{success:!1,error:S.message}}}function k(C){const D=d(C);return D?(r(S=>({...S,...D,currentStudentId:C,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(S=>({...S,currentStudentId:C,isLoading:!0,isRefreshing:!1,error:null})),!1)}function A(C){try{const D=n(C);localStorage.removeItem(D)}catch(D){console.warn("Failed to clear student todolist cache:",D)}return r(D=>({...s,currentStudentId:C,isLoading:!0})),T.loadTodos(C,!1)}const T={subscribe:t,init:k,loadTodos:p,addTodo:h,updateTodo:g,toggleTodo:b,deleteTodo:y,forceRefresh:A,getCachedData:C=>c(C)};return T}const $r=pb();var mb=_('<button type="button"><span class="material-symbols-outlined"> </span> <span> </span></button>'),hb=_('<div class="dropdown-menu-category"></div>'),gb=_('<button class="clear-date-btn" type="button" title="Clear date"><span class="material-symbols-outlined">close</span></button>'),_b=_('<div class="day-header"> </div>'),bb=_('<div class="empty-day"></div>'),yb=_('<button type="button"> </button>'),wb=_('<div class="date-picker-dropdown"><div class="date-picker-header"><button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_left</span></button> <div class="month-year-display"><span class="month-name"> </span> <span class="year-name"> </span></div> <button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_right</span></button></div> <div class="calendar-grid"><!> <!> <!></div></div>'),xb=_('<div class="add-todo-section"><h2 class="section-title">Add New Task</h2> <div class="add-todo-form"><input type="text" placeholder="Enter task title..." class="todo-input"/> <textarea placeholder="Enter description (optional)..." class="todo-input todo-textarea" rows="3"></textarea> <div class="form-row"><div class="form-field"><label class="form-label" for="category-dropdown">Category</label> <div class="custom-dropdown"><button class="dropdown-toggle" id="category-dropdown" type="button"><div class="dropdown-toggle-content"><span class="material-symbols-outlined dropdown-icon-left"> </span> <span class="dropdown-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="form-field"><label class="form-label" for="due-date-picker">Due Date (optional)</label> <div class="custom-date-picker"><div class="date-picker-toggle-wrapper"><button class="date-picker-toggle" id="due-date-picker" type="button"><div class="date-picker-toggle-content"><span class="material-symbols-outlined date-picker-icon-left">calendar_today</span> <span class="date-picker-label"> </span></div> <div class="date-picker-actions"><!> <span>expand_more</span></div></button></div> <!></div></div></div> <button class="add-todo-btn"> </button></div></div>'),Sb=_('<button class="clear-search-btn"><span class="material-symbols-outlined">close</span></button>'),kb=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Ab=_('<div class="filter-dropdown-menu"></div>'),Db=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Cb=_('<div class="filter-dropdown-menu"></div>'),Tb=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading todos...</p></div>'),Eb=_('<div class="error-state"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-btn">Retry</button></div>'),Fb=_('<p class="todo-description"> </p>'),Nb=_('<div><div class="todo-checkbox"><input type="checkbox"/> <label class="checkbox-label"></label></div> <div class="todo-content"><h3> </h3> <!> <div class="todo-meta"><span class="todo-category"> </span> <span class="todo-due-date"> </span></div></div> <div class="todo-actions"><button class="action-btn todo-delete-btn" title="Delete task"><span class="material-symbols-outlined">delete</span></button></div></div>'),$b=_('<div class="todos-list"></div>'),Pb=_('<div class="no-filtered-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">search_off</span></div> <h3>No Matching Tasks</h3> <p>No tasks match your current search or filter criteria.</p> <button class="clear-filters-btn">Clear all filters</button></div>'),Lb=_(`<div class="no-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">check_circle</span></div> <h3>No Tasks</h3> <p>You don't have any tasks yet. Add one above to get started!</p></div>`),Mb=_('<div class="todo-container"><div class="todo-header"><div class="header-content"><div class="header-text-content"><h1 class="page-title">Todo List</h1> <p class="page-subtitle">Keep track of your tasks and assignments <span class="progress-badge"> </span></p></div> <div class="header-actions"></div></div></div> <div class="add-todo-button-section"><button class="add-todo-toggle-btn"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="search-filter-section"><div class="search-filter-row"><div class="todo-search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="todo-search-input" placeholder="Search todos by title or description..."/> <!></div> <div class="todo-filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <button class="todo-refresh-button" title="Refresh todos"><span class="material-symbols-outlined">refresh</span></button></div></div></div> <div class="todos-section"><!></div></div>');function Ib(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja($r,"$studentTodolistStore",a),l=()=>Ja(gs,"$authStore",a),c=O(),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=O(),k=O(),A=O(),T=O();let C=O(!1),D=O(""),S=O("all"),L=O("all"),F=O(!1),j=O(!1),P=O(""),Q=O(""),W=O("personal"),$=O(""),R=O(!1);const X=[{value:"all",label:"All Categories",icon:"category"},{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}],se=[{value:"all",label:"All Status",icon:"list"},{value:"pending",label:"Pending",icon:"pending"},{value:"completed",label:"Completed",icon:"check_circle"}],V=[{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}];let re=O(!1),me=O(!1);const je=new Date;let de=O(je.getFullYear()),ie=O(je.getMonth());const Pe=["January","February","March","April","May","June","July","August","September","October","November","December"],Ve=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];async function Ze(){const Ne=l();Ne.isAuthenticated&&Ne.userData?.id&&await $r.forceRefresh(Ne.userData.id)}async function ve(){try{v(C,!0);const Ne=l().userData;if(!Ne||!Ne.id)throw new Error("User not authenticated");if(!e(P).trim()){Se.error("Please enter a title for your todo");return}const ct={title:e(P).trim(),description:e(Q).trim()||null,category:e(W),dueDate:e($)||null},Ft=await $r.addTodo(Ne.id,ct);if(Ft.success)Se.success("Todo added successfully!"),v(P,""),v(Q,""),v(W,"personal"),v($,""),v(R,!1);else throw new Error(Ft.error||"Failed to add todo")}catch(Ne){console.error("Error adding todo:",Ne),Se.error("Failed to add todo: "+Ne.message)}finally{v(C,!1)}}async function Ce(Ne){try{const ct=l().userData;if(!ct||!ct.id)throw new Error("User not authenticated");const Ft=await $r.deleteTodo(ct.id,Ne);if(Ft.success)Se.success("Todo deleted successfully!");else throw new Error(Ft.error||"Failed to delete todo")}catch(ct){console.error("Error deleting todo:",ct),Se.error("Failed to delete todo: "+ct.message)}}async function Qe(Ne){try{const ct=l().userData;if(!ct||!ct.id)throw new Error("User not authenticated");const Ft=await $r.toggleTodo(ct.id,Ne);if(Ft.success){const It=Ft.data.completed?"Todo marked as completed!":"Todo marked as pending!";Se.success(It)}else throw new Error(Ft.error||"Failed to update todo")}catch(ct){console.error("Error toggling todo:",ct),Se.error("Failed to update todo: "+ct.message)}}Ya(()=>{const Ne=l();if(Ne.isAuthenticated&&Ne.userData?.id){const ct=$r.init(Ne.userData.id);$r.loadTodos(Ne.userData.id,ct);const Ft=setInterval(()=>{const Mt=l();Mt.isAuthenticated&&Mt.userData?.id&&$r.loadTodos(Mt.userData.id,!0)},300*1e3);return()=>{clearInterval(Ft)}}});function Xe(Ne){us.confirm("Delete Task",`Are you sure you want to delete "${Ne.title}"? This action cannot be undone.`,async()=>{await Ce(Ne.id)},()=>{})}function ze(){v(R,!e(R)),e(R)||(v(P,""),v(Q,""),v(W,"personal"),v($,""),v(re,!1),v(me,!1))}function We(){v(F,!e(F))}function Te(){v(j,!e(j))}function ue(Ne){v(S,Ne),v(F,!1)}function be(Ne){v(L,Ne),v(j,!1)}function ke(Ne){const ct=X.find(Ft=>Ft.value===Ne);return ct?ct.label:"All Categories"}function Fe(Ne){const ct=X.find(Ft=>Ft.value===Ne);return ct?ct.icon:"category"}function Re(Ne){const ct=se.find(Ft=>Ft.value===Ne);return ct?ct.label:"All Status"}function et(Ne){const ct=se.find(Ft=>Ft.value===Ne);return ct?ct.icon:"list"}function $e(){v(re,!e(re))}function ot(Ne){v(W,Ne),v(re,!1)}function Me(Ne){Ne.target.closest(".custom-dropdown")||v(re,!1),Ne.target.closest(".custom-date-picker")||v(me,!1),Ne.target.closest(".filter-dropdown")||(v(F,!1),v(j,!1))}Ya(()=>(document.addEventListener("click",Me),()=>{document.removeEventListener("click",Me)}));function it(Ne){const ct=V.find(Ft=>Ft.value===Ne);return ct?ct.label:"Select Category"}function ft(Ne){const ct=V.find(Ft=>Ft.value===Ne);return ct?ct.icon:"category"}function Ye(){if(v(me,!e(me)),e(me))if(e($)){const Ne=new Date(e($)+"T00:00:00");v(de,Ne.getFullYear()),v(ie,Ne.getMonth()),Ne.getDate()}else{const Ne=new Date;v(de,Ne.getFullYear()),v(ie,Ne.getMonth())}}function Y(Ne){const ct=e(de),Ft=e(ie)+1,Mt=Ne.toString().padStart(2,"0"),It=Ft.toString().padStart(2,"0");v($,`${ct}-${It}-${Mt}`),v(me,!1)}function ce(){v($,""),v(me,!1)}function De(){e(ie)===0?(v(ie,11),or(de,-1)):or(ie,-1)}function U(){e(ie)===11?(v(ie,0),or(de)):or(ie)}function ne(Ne,ct){return new Date(Ne,ct+1,0).getDate()}function fe(Ne,ct){return new Date(Ne,ct,1).getDay()}function z(Ne){const ct=new Date;return Ne===ct.getDate()&&e(ie)===ct.getMonth()&&e(de)===ct.getFullYear()}function B(Ne){if(!e($))return!1;const ct=new Date(e($)+"T00:00:00");return Ne===ct.getDate()&&e(ie)===ct.getMonth()&&e(de)===ct.getFullYear()}function I(Ne){if(!Ne||Ne==="No due date")return"No due date";if(Ne==="Today"||Ne==="Tomorrow"||Ne==="Next Week")return Ne;const ct=Ne.split("-");if(ct.length!==3)return Ne;const Ft=parseInt(ct[0]),Mt=parseInt(ct[1])-1,It=parseInt(ct[2]);if(isNaN(Ft)||isNaN(Mt)||isNaN(It))return Ne;const ra=new Date,ha=ra.getFullYear(),ca=ra.getMonth(),Qt=ra.getDate();if(Ft===ha&&Mt===ca&&It===Qt)return"Today";const va=new Date(ra);va.setDate(va.getDate()+1);const pa=va.getFullYear(),ua=va.getMonth(),ba=va.getDate();return Ft===pa&&Mt===ua&&It===ba?"Tomorrow":new Date(Ft,Mt,It).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).replace(/^(\w+),/,"$1:")}let G=O(0),Z=O(""),le=O(e(S)),N=O(e(L));_t(()=>(e(c),e(d),e(f),e(p),e(h),n()),()=>{(Ne=>{v(c,Ne.todos),v(d,Ne.isLoading),v(f,Ne.isRefreshing),v(p,Ne.error),v(h,Ne.lastUpdated)})(n())}),_t(()=>(e(c),e(D),e(S),e(L)),()=>{v(g,(()=>{let Ne=e(c);if(e(D).trim()){const ct=e(D).toLowerCase().trim();Ne=Ne.filter(Ft=>Ft.title.toLowerCase().includes(ct)||Ft.description&&Ft.description.toLowerCase().includes(ct))}return e(S)!=="all"&&(Ne=Ne.filter(ct=>ct.category===e(S))),e(L)!=="all"&&(e(L)==="completed"?Ne=Ne.filter(ct=>ct.completed):e(L)==="pending"&&(Ne=Ne.filter(ct=>!ct.completed))),Ne})())}),_t(()=>e($),()=>{v(b,e($)?new Date(e($)+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).replace(/^(\w+),/,"$1:"):"Select due date")}),_t(()=>e(c),()=>{v(y,e(c).filter(Ne=>Ne.completed).length)}),_t(()=>e(c),()=>{v(k,e(c).length)}),_t(()=>e(g),()=>{v(A,e(g).filter(Ne=>Ne.completed).length)}),_t(()=>e(g),()=>{v(T,e(g).length)}),_t(()=>(e(D),e(Z),e(S),e(le),e(L),e(N),e(G)),()=>{(e(D)!==e(Z)||e(S)!==e(le)||e(L)!==e(N))&&(or(G),v(Z,e(D)),v(le,e(S)),v(N,e(L)))}),Rs(),Ls();var M=Mb();ye("click",Zs,Me);var H=o(M),pe=o(H),ee=o(pe),Ae=u(o(ee),2),Ue=u(o(Ae)),Le=o(Ue);i(Ue),i(Ae),i(ee),Bt(2),i(pe),i(H);var He=u(H,2),Ie=o(He),nt=o(Ie),bt=o(nt,!0);i(nt);var pt=u(nt);i(Ie),i(He);var vt=u(He,2);{var Tt=Ne=>{var ct=xb(),Ft=u(o(ct),2),Mt=o(Ft);aa(Mt);var It=u(Mt,2);xn(It);var ra=u(It,2),ha=o(ra),ca=u(o(ha),2),Qt=o(ca),va=o(Qt),pa=o(va),ua=o(pa,!0);i(pa);var ba=u(pa,2),Ta=o(ba,!0);i(ba),i(va);var Pa=u(va,2);i(Qt);var Ea=u(Qt,2);{var K=ma=>{var wa=hb();xt(wa,5,()=>V,Ua,(Ia,ae)=>{var he=mb(),st=o(he),At=o(st,!0);i(st);var kt=u(st,2),Ct=o(kt,!0);i(kt),i(he),q(()=>{_e(he,1,`dropdown-item ${e(ae),e(W),x(()=>e(ae).value===e(W)?"selected":"")??""}`),w(At,(e(ae),x(()=>e(ae).icon))),w(Ct,(e(ae),x(()=>e(ae).label)))}),ye("click",he,()=>ot(e(ae).value)),m(Ia,he)}),i(wa),m(ma,wa)};E(Ea,ma=>{e(re)&&ma(K)})}i(ca),i(ha);var xe=u(ha,2),Ke=u(o(xe),2),Dt=o(Ke),Wt=o(Dt),Nt=o(Wt),St=u(o(Nt),2),Na=o(St,!0);i(St),i(Nt);var Aa=u(Nt,2),ga=o(Aa);{var Da=ma=>{var wa=gb();ye("click",wa,vo(ce)),m(ma,wa)};E(ga,ma=>{e($)&&ma(Da)})}var Vt=u(ga,2);i(Aa),i(Wt),i(Dt);var Kt=u(Dt,2);{var xa=ma=>{var wa=wb(),Ia=o(wa),ae=o(Ia),he=u(ae,2),st=o(he),At=o(st,!0);i(st);var kt=u(st,2),Ct=o(kt,!0);i(kt),i(he);var ia=u(he,2);i(Ia);var Ca=u(Ia,2),jt=o(Ca);xt(jt,1,()=>Ve,Ua,(yt,Lt)=>{var Xt=_b(),na=o(Xt,!0);i(Xt),q(()=>w(na,e(Lt))),m(yt,Xt)});var qe=u(jt,2);xt(qe,1,()=>(e(de),e(ie),x(()=>Array(fe(e(de),e(ie))))),Ua,(yt,Lt)=>{var Xt=bb();m(yt,Xt)});var Jt=u(qe,2);xt(Jt,1,()=>(e(de),e(ie),x(()=>Array(ne(e(de),e(ie))))),Ua,(yt,Lt,Xt)=>{const na=fr(()=>Xt+1);var ja=yb(),$a=o(ja,!0);i(ja),q((Ra,Ba)=>{_e(ja,1,`day-cell ${Ra??""} ${Ba??""}`),w($a,e(na))},[()=>(xs(e(na)),x(()=>z(e(na))?"today":"")),()=>(xs(e(na)),x(()=>B(e(na))?"selected":""))]),ye("click",ja,()=>Y(e(na))),m(yt,ja)}),i(Ca),i(wa),q(()=>{w(At,(e(ie),x(()=>Pe[e(ie)]))),w(Ct,e(de))}),ye("click",ae,De),ye("click",ia,U),m(ma,wa)};E(Kt,ma=>{e(me)&&ma(xa)})}i(Ke),i(xe),i(ra);var ya=u(ra,2),Fa=o(ya,!0);i(ya),i(Ft),i(ct),q((ma,wa,Ia)=>{w(ua,ma),w(Ta,wa),_e(Pa,1,`material-symbols-outlined dropdown-icon ${e(re)?"open":""}`),w(Na,e(b)),_e(Vt,1,`material-symbols-outlined dropdown-icon ${e(me)?"open":""}`),ya.disabled=Ia,w(Fa,e(C)?"Adding...":"Add Task")},[()=>(e(W),x(()=>ft(e(W)))),()=>(e(W),x(()=>it(e(W)))),()=>(e(P),e(C),x(()=>!e(P).trim()||e(C)))]),oa(Mt,()=>e(P),ma=>v(P,ma)),ye("keydown",Mt,ma=>ma.key==="Enter"&&ve()),oa(It,()=>e(Q),ma=>v(Q,ma)),ye("click",Qt,$e),ye("click",Wt,Ye),ye("click",ya,ve),m(Ne,ct)};E(vt,Ne=>{e(R)&&Ne(Tt)})}var Ot=u(vt,2),la=o(Ot),sa=o(la),zt=u(o(sa),2);aa(zt);var qt=u(zt,2);{var Pt=Ne=>{var ct=Sb();ye("click",ct,()=>v(D,"")),m(Ne,ct)};E(qt,Ne=>{e(D)&&Ne(Pt)})}i(sa);var Yt=u(sa,2),Ut=o(Yt),Et=o(Ut),ta=o(Et),fa=o(ta),oe=o(fa,!0);i(fa);var Ee=u(fa,2),dt=o(Ee,!0);i(Ee),i(ta);var we=u(ta,2);let Oe;i(Et);var lt=u(Et,2);{var Rt=Ne=>{var ct=Ab();xt(ct,5,()=>X,Ua,(Ft,Mt)=>{var It=kb();let ra;var ha=o(It),ca=o(ha,!0);i(ha);var Qt=u(ha,2),va=o(Qt,!0);i(Qt),i(It),q(pa=>{ra=_e(It,1,"filter-dropdown-item",null,ra,pa),w(ca,(e(Mt),x(()=>e(Mt).icon))),w(va,(e(Mt),x(()=>e(Mt).label)))},[()=>({active:e(Mt).value===e(S)})]),ye("click",It,()=>ue(e(Mt).value)),m(Ft,It)}),i(ct),m(Ne,ct)};E(lt,Ne=>{e(F)&&Ne(Rt)})}i(Ut);var Ht=u(Ut,2),rt=o(Ht),ka=o(rt),Zt=o(ka),tt=o(Zt,!0);i(Zt);var wt=u(Zt,2),ge=o(wt,!0);i(wt),i(ka);var te=u(ka,2);let J;i(rt);var Be=u(rt,2);{var Ge=Ne=>{var ct=Cb();xt(ct,5,()=>se,Ua,(Ft,Mt)=>{var It=Db();let ra;var ha=o(It),ca=o(ha,!0);i(ha);var Qt=u(ha,2),va=o(Qt,!0);i(Qt),i(It),q(pa=>{ra=_e(It,1,"filter-dropdown-item",null,ra,pa),w(ca,(e(Mt),x(()=>e(Mt).icon))),w(va,(e(Mt),x(()=>e(Mt).label)))},[()=>({active:e(Mt).value===e(L)})]),ye("click",It,()=>be(e(Mt).value)),m(Ft,It)}),i(ct),m(Ne,ct)};E(Be,Ne=>{e(j)&&Ne(Ge)})}i(Ht);var at=u(Ht,2);i(Yt),i(la),i(Ot);var gt=u(Ot,2),Gt=o(gt);{var _a=Ne=>{var ct=Tb();m(Ne,ct)},ht=Ne=>{var ct=mt(),Ft=Je(ct);{var Mt=ra=>{var ha=Eb(),ca=u(o(ha),2),Qt=o(ca,!0);i(ca);var va=u(ca,2);i(ha),q(()=>w(Qt,e(p))),ye("click",va,Ze),m(ra,ha)},It=ra=>{var ha=mt(),ca=Je(ha);{var Qt=pa=>{var ua=mt(),ba=Je(ua);Is(ba,()=>e(G),Ta=>{var Pa=$b();xt(Pa,7,()=>e(g),Ea=>Ea.id,(Ea,K,xe)=>{var Ke=Nb();let Dt;var Wt=o(Ke),Nt=o(Wt);aa(Nt);var St=u(Nt,2);i(Wt);var Na=u(Wt,2),Aa=o(Na);let ga;var Da=o(Aa,!0);i(Aa);var Vt=u(Aa,2);{var Kt=he=>{var st=Fb(),At=o(st,!0);i(st),q(()=>w(At,(e(K),x(()=>e(K).description)))),m(he,st)};E(Vt,he=>{e(K),x(()=>e(K).description)&&he(Kt)})}var xa=u(Vt,2),ya=o(xa),Fa=o(ya,!0);i(ya);var ma=u(ya,2),wa=o(ma,!0);i(ma),i(xa),i(Na);var Ia=u(Na,2),ae=o(Ia);i(Ia),i(Ke),q((he,st,At)=>{Dt=_e(Ke,1,"todo-card",null,Dt,he),Wa(Ke,`--card-index: ${e(xe)??""};`),au(Nt,(e(K),x(()=>e(K).completed))),$t(Nt,"id",`todo-${e(K),x(()=>e(K).id)??""}`),Nt.disabled=e(d),$t(St,"for",`todo-${e(K),x(()=>e(K).id)??""}`),ga=_e(Aa,1,"todo-title",null,ga,st),w(Da,(e(K),x(()=>e(K).title))),w(Fa,(e(K),x(()=>e(K).category))),w(wa,At),ae.disabled=e(d)},[()=>({completed:e(K).completed}),()=>({completed:e(K).completed}),()=>(e(K),x(()=>I(e(K).dueDate)))]),ye("change",Nt,()=>Qe(e(K).id)),ye("click",ae,()=>Xe(e(K))),m(Ea,Ke)}),i(Pa),m(Ta,Pa)}),m(pa,ua)},va=pa=>{var ua=mt(),ba=Je(ua);{var Ta=Ea=>{var K=Pb(),xe=u(o(K),6);i(K),ye("click",xe,()=>{v(D,""),v(S,"all"),v(L,"all")}),m(Ea,K)},Pa=Ea=>{var K=Lb();m(Ea,K)};E(ba,Ea=>{e(c),x(()=>e(c).length>0)?Ea(Ta):Ea(Pa,!1)},!0)}m(pa,ua)};E(ca,pa=>{e(g),x(()=>e(g).length>0)?pa(Qt):pa(va,!1)},!0)}m(ra,ha)};E(Ft,ra=>{e(p)?ra(Mt):ra(It,!1)},!0)}m(Ne,ct)};E(Gt,Ne=>{e(d)?Ne(_a):Ne(ht,!1)})}i(gt),i(M),q((Ne,ct,Ft,Mt,It,ra)=>{w(Le,`${e(y)??""}/${e(k)??""} completed`),w(bt,e(R)?"remove":"add"),w(pt,` ${e(R)?"Cancel":"Add New Task"}`),w(oe,Ne),w(dt,ct),Oe=_e(we,1,"material-symbols-outlined dropdown-arrow",null,Oe,Ft),w(tt,Mt),w(ge,It),J=_e(te,1,"material-symbols-outlined dropdown-arrow",null,J,ra),at.disabled=e(d)},[()=>(e(S),x(()=>Fe(e(S)))),()=>(e(S),x(()=>ke(e(S)))),()=>({rotated:e(F)}),()=>(e(L),x(()=>et(e(L)))),()=>(e(L),x(()=>Re(e(L)))),()=>({rotated:e(j)})]),ye("click",Ie,ze),oa(zt,()=>e(D),Ne=>v(D,Ne)),ye("click",Et,We),ye("click",rt,Te),ye("click",at,Ze),m(s,M),za(),r()}function Rb(s,t){v(t,!e(t))}function Ob(s,t,a){v(t,!e(t)),a()}var jb=_('<img alt="Profile" class="avatar-image"/>'),qb=_('<div class="avatar-placeholder"> </div>'),zb=(s,t,a)=>{t(),a.onnavigate("profile")},Gb=async(s,t,a)=>{t(),await a.onlogout(),jr("Logged out successfully. See you next time!")},Vb=_('<div class="teacher-navbar-dropdown-menu"><button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Bb=_('<nav class="teacher-navbar" aria-label="Teacher navigation"><div class="teacher-navbar-container"><div class="teacher-navbar-left"><button class="teacher-navbar-icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">person_book</span> <span class="app-title"> </span></div></div> <div class="teacher-navbar-right"><button class="teacher-navbar-icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="teacher-navbar-user-profile"><div class="teacher-navbar-user-info"><span class="teacher-navbar-user-name"> </span> <span class="user-id"> </span></div> <div class="teacher-navbar-user-avatar"><!></div></button> <!></div></div></div></nav>');function Wb(s,t){qa(t,!0);let a=Ma(t,"teacherName",3,"John Does"),r=Ma(t,"firstName",3,"John"),n=Ma(t,"gender",3,"male"),l=Ma(t,"accountNumber",3,"TCH-2025-0001"),c=Ma(t,"profileImage",3,null);function d(ve){return ve==="female"?"Ms.":"Mr."}let f=ea(()=>`${d(n())} ${r()}`),p=ut(!0),h=ut(!1);function g(){v(h,!1)}function b(ve){e(h)&&!ve.target.closest(".user-profile-container")&&g()}Ya(()=>{const ve=localStorage.getItem("theme");return v(p,ve!=="light"),y(),document.addEventListener("click",b),()=>{document.removeEventListener("click",b)}});function y(){e(p)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function k(ve){return ve.split(" ").map(Ce=>Ce.charAt(0)).join("").toUpperCase().slice(0,2)}var A=Bb(),T=o(A),C=o(T),D=o(C);D.__click=function(...ve){t.onToggleNavRail?.apply(this,ve)};var S=u(D,2),L=u(o(S),2),F=o(L);i(L),i(S),i(C);var j=u(C,2),P=o(j);P.__click=[Ob,p,y];var Q=o(P),W=o(Q,!0);i(Q),i(P);var $=u(P,2),R=o($);R.__click=[Rb,h];var X=o(R),se=o(X),V=o(se,!0);i(se);var re=u(se,2),me=o(re);i(re),i(X);var je=u(X,2),de=o(je);{var ie=ve=>{var Ce=jb();q(()=>$t(Ce,"src",c())),m(ve,Ce)},Pe=ve=>{var Ce=qb(),Qe=o(Ce,!0);i(Ce),q(Xe=>w(Qe,Xe),[()=>k(r())]),m(ve,Ce)};E(de,ve=>{c()?ve(ie):ve(Pe,!1)})}i(je),i(R);var Ve=u(R,2);{var Ze=ve=>{var Ce=Vb(),Qe=o(Ce);Qe.__click=[zb,g,t];var Xe=u(Qe,2);Xe.__click=[Gb,g,t],i(Ce),m(ve,Ce)};E(Ve,ve=>{e(h)&&ve(Ze)})}i($),i(j),i(T),i(A),q(()=>{w(F,`Welcome, ${e(f)??""}`),w(W,e(p)?"light_mode":"dark_mode"),w(V,a()),w(me,`Account: ${l()??""}`)}),m(s,A),za()}Ps(["click"]);var Hb=(s,t,a)=>t(e(a).id),Ub=_('<button><div class="teacher-menu-rail-icon-container"><span class="material-symbols-outlined teacher-menu-rail-icon"> </span></div> <span class="teacher-menu-rail-label"> </span></button>'),Yb=(s,t,a)=>t(e(a).id),Qb=_('<button><div class="teacher-menu-nav-icon-container"><span class="material-symbols-outlined teacher-menu-nav-icon"> </span></div></button>'),Kb=_('<nav aria-label="Teacher portal navigation"><div class="teacher-menu-rail-container"></div></nav> <nav class="teacher-menu-bottom-navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-nav-container"></div></nav>',1);function Jb(s,t){qa(t,!0);let a=Ma(t,"teacherActiveSection",15,"schedule"),r=Ma(t,"teacherNavRailVisible",3,!0);const n=[{id:"schedule",label:"Schedule",icon:"schedule"},{id:"students",label:"Class Management",icon:"group"},{id:"advisory",label:"Advisory Class",icon:"supervisor_account"}];let l=ut(!1),c=ut(!1);Es(()=>{t.teacherId&&!e(c)&&d()});async function d(){try{const T=await da.get(`/api/teacher-advisory?teacher_id=${t.teacherId}`);v(l,T.success&&T.data.advisoryData!==null,!0)}catch(T){console.error("Error checking advisory status:",T),v(l,!1)}finally{v(c,!0)}}let f=ea(()=>n.filter(T=>T.id!=="advisory"||e(l)));function p(T){a(T),t.onnavigate&&t.onnavigate({detail:{section:T}})}var h=Kb(),g=Je(h);let b;var y=o(g);xt(y,21,()=>e(f),T=>T.id,(T,C)=>{var D=Ub();let S;D.__click=[Hb,p,C];var L=o(D),F=o(L),j=o(F,!0);i(F),i(L);var P=u(L,2),Q=o(P,!0);i(P),i(D),q(W=>{S=_e(D,1,"teacher-menu-rail-item",null,S,W),$t(D,"aria-label",e(C).label),$t(D,"aria-current",e(C).id===a()?"page":void 0),w(j,e(C).icon),w(Q,e(C).label)},[()=>({active:e(C).id===a()})]),m(T,D)}),i(y),i(g);var k=u(g,2),A=o(k);xt(A,21,()=>e(f),T=>T.id,(T,C)=>{var D=Qb();let S;D.__click=[Yb,p,C];var L=o(D),F=o(L),j=o(F,!0);i(F),i(L),i(D),q(P=>{S=_e(D,1,"teacher-menu-nav-item",null,S,P),$t(D,"aria-label",e(C).label),$t(D,"aria-current",e(C).id===a()?"page":void 0),w(j,e(C).icon)},[()=>({active:e(C).id===a()})]),m(T,D)}),i(A),i(k),q(T=>b=_e(g,1,"teacher-menu-navigation-rail",null,b,T),[()=>({collapsed:!r()})]),m(s,h),za()}Ps(["click"]);const Io="teacherProfileCache",Xb=300*1e3;function Zb(){const{subscribe:s,set:t,update:a}=Hs({teacherData:null,teacherProfileData:null,teacherSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),r={subscribe:s,init:n=>{const l=ey(n);return l?(a(c=>({...c,teacherData:l.teacherData,teacherProfileData:l.teacherProfileData,teacherSections:l.teacherSections,lastUpdated:l.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(n,l=!1)=>{a(c=>({...c,isLoading:n&&!c.isInitialized&&!l,isRefreshing:n&&l,error:n?null:c.error}))},setError:n=>{a(l=>({...l,isLoading:!1,isRefreshing:!1,error:n}))},updateProfileData:(n,l,c,d)=>{const f=Date.now();a(p=>({...p,teacherData:n,teacherProfileData:l,teacherSections:c,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),ty(n,l,c,d,f)},loadProfile:async(n,l=!1)=>{try{a(h=>({...h,isLoading:!l&&!h.isInitialized,isRefreshing:l,error:null}));const c=await da.get("/api/accounts?type=teacher&limit=1000");if(!c.success)throw new Error(c.message||"Failed to fetch teacher data");const d=c.accounts.find(h=>h.id===n||h.number===n);if(!d)throw new Error("Teacher data not found");let f=null;try{const h=await da.get(`/api/teacher-profile?teacherId=${n}`);h.success&&(f=h.data)}catch(h){console.warn("Failed to fetch teacher profile data:",h)}let p=[];try{const b=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",y=await fetch(`/api/teacher-sections?teacherId=${n}&schoolYear=${b}`);if(y.ok){const k=await y.json();k.success&&(p=k.data.classData||[])}}catch(h){console.warn("Failed to fetch teacher sections:",h)}r.updateProfileData(d,f,p,n)}catch(c){console.error("Error loading teacher profile:",c),a(d=>({...d,isLoading:!1,isRefreshing:!1,error:c.message}))}},clearCache:n=>{try{const l=`${Io}_${n}`;localStorage.removeItem(l)}catch(l){console.warn("Failed to clear teacher profile cache:",l)}},forceRefresh:async n=>{r.clearCache(n),a(l=>({...l,isInitialized:!1,teacherData:null,teacherProfileData:null,teacherSections:[]})),await r.loadProfile(n,!1)}};return r}function ey(s){try{const t=`${Io}_${s}`,a=localStorage.getItem(t);if(!a)return null;const r=JSON.parse(a);return Date.now()-r.timestamp>Xb?(localStorage.removeItem(t),null):{teacherData:r.teacherData,teacherProfileData:r.teacherProfileData,teacherSections:r.teacherSections,lastUpdated:r.timestamp}}catch(t){return console.warn("Failed to get cached teacher profile data:",t),null}}function ty(s,t,a,r,n){try{const l=`${Io}_${r}`,c={teacherData:s,teacherProfileData:t,teacherSections:a,timestamp:n};localStorage.setItem(l,JSON.stringify(c))}catch(l){console.warn("Failed to cache teacher profile data:",l)}}const Ur=Zb();function ay(s,t){v(t,!e(t))}function sy(s,t){v(t,!e(t))}function ry(s,t){v(t,!e(t))}function iy(s,t){us.confirm("Change Password",`
			<div class="teacher-profile-password-form">
				<div class="teacher-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var ny=_('<div class="teacher-error-container"><div class="teacher-error-icon"><span class="material-symbols-outlined">error</span></div> <p class="teacher-error-message"> </p> <button class="teacher-retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),oy=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teacher information...</p></div>'),ly=_('<div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Teacher ID</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">person</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Full Name</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">work</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Position</div> <div class="teacher-info-value"> </div></div></div></div> <div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">email</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Email</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Total Subjects</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">domain</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Department</div> <div class="teacher-info-value"> </div></div></div></div>',1),cy=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching sections...</p></div>'),dy=_('<div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">groups</span></div> <div class="teacher-info-content"><div class="teacher-info-label"> </div> <div class="teacher-info-value"> </div></div></div>'),uy=_('<div class="teacher-info-row teacher-row-three"></div>'),vy=_('<div class="teacher-sections-empty"><span class="material-symbols-outlined">groups</span> <p>No teaching sections assigned yet</p></div>'),fy=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching assignments...</p></div>'),py=_('<div class="teacher-subject-card"><div class="teacher-subject-icon-column"><div class="teacher-subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="teacher-subject-details-column"><h3 class="teacher-subject-name"> </h3> <p class="teacher-subject-classes"><!></p></div></div>'),my=_('<div class="teacher-subjects-grid"></div>'),hy=_('<div class="teacher-subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects assigned yet</p></div>'),gy=_('<div class="teacher-profile-header"><div class="teacher-header-content"><h1 class="teacher-page-title">Teacher Profile</h1> <p class="teacher-page-subtitle">Personal Information & Teaching Details</p></div> <div class="teacher-header-actions"><button class="teacher-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="teacher-profile-info-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teacher Information</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teacher information"><h2 class="teacher-section-title">Teacher Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-sections-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Sections</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching sections"><h2 class="teacher-section-title">Teaching Sections</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-subjects-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Assignments</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching assignments"><h2 class="teacher-section-title">Teaching Assignments</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-security-section"><h2 class="teacher-section-title teacher-section-title-desktop">Account Security</h2> <div class="teacher-section-content"><div class="teacher-info-row teacher-row-one"><div class="teacher-info-card teacher-security-card"><div class="teacher-info-content-container"><div class="teacher-info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Password</div> <div class="teacher-info-value">Change your account password for security</div></div></div> <div class="teacher-security-actions"><button class="teacher-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),_y=_('<div class="teacher-profile-container"><!></div>');function by(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(Ur,"$teacherProfileStore",a),l=()=>Ja(gs,"$authStore",a);let c=ut(void 0),d=ea(()=>n().teacherData),f=ea(()=>n().teacherProfileData),p=ea(()=>n().teacherSections),h=ea(()=>n().isLoading),g=ea(()=>n().error);Es(()=>gs.subscribe($=>{v(c,$,!0)})),Ya(async()=>{if(!e(c)?.userData?.id){console.error("User not authenticated");return}const W=e(c).userData.id,$=Ur.init(W);await Ur.loadProfile(W,$);const R=setInterval(async()=>{await Ur.loadProfile(W,!0)},300*1e3);return()=>{clearInterval(R)}});async function b(){const W=l();if(!W.isAuthenticated||!W.userData?.id){console.error("User not authenticated");return}const $=W.userData.id;await Ur.forceRefresh($)}Es(()=>{if(e(c)?.userData?.id){const W=e(c).userData.id;Ur.init(W)||Ur.loadProfile(W,!1)}});let y=ea(()=>({id:e(d)?.number||e(c)?.userData?.accountNumber||"N/A",name:e(d)?.name||e(c)?.userData?.name||"Teacher Name",firstName:e(d)?.firstName||e(c)?.userData?.firstName||"",lastName:e(d)?.lastName||"",middleInitial:e(d)?.middleInitial||"",department:e(d)?.department||"Not assigned",position:e(d)?.position||"Teacher",email:e(d)?.email||"Not available",phone:e(d)?.contactNumber||"Not available",address:e(d)?.address||"Not available",birthDate:e(d)?.birthdate?new Date(e(d).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(d)?.age||"Not available",gender:e(d)?.gender||e(c)?.userData?.gender||"male",employmentInfo:{hireDate:e(d)?.hireDate?new Date(e(d).hireDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",yearsOfService:e(d)?.yearsOfService||"Not available",employeeId:e(d)?.employeeId||"Not available"},subjects:e(f)?.subjects||[],classes:e(f)?.classes||[],sections:e(f)?.sections||[]})),k=ea(()=>e(y).subjects.length||"Not available"),A=ut(!0),T=ut(!0),C=ut(!0),D=ut(!1);function S(W){const $=document.getElementById(W),X=$.nextElementSibling.querySelector(".password-eye-icon");$.type==="password"?($.type="text",X.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):($.type="password",X.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=S);async function L(){const W=document.getElementById("current-password"),$=document.getElementById("new-password"),R=document.getElementById("confirm-password");if(!W||!$||!R){ds("Password form inputs not found");return}const X=W.value,se=$.value,V=R.value;if(!X){ds("Current password is required");return}if(!se){ds("New password is required");return}if(se!==V){ds("New passwords do not match");return}if(se.length<8){ds("Password must be at least 8 characters long");return}if(X===se){ds("New password must be different from current password");return}try{v(D,!0);const re=await da.post("/api/change-password",{currentPassword:X,newPassword:se});re.success?(W.value="",$.value="",R.value="",jr("Password changed successfully!"),us.close()):ds(re.error||"Failed to change password")}catch(re){ds(re.message||"Failed to change password")}finally{v(D,!1)}}var F=_y(),j=o(F);{var P=W=>{var $=ny(),R=u(o($),2),X=o(R);i(R);var se=u(R,2);se.__click=b,i($),q(()=>w(X,`Failed to load profile data: ${e(g)??""}`)),m(W,$)},Q=W=>{var $=gy(),R=Je($),X=u(o(R),2),se=o(X);se.__click=b,i(X),i(R);var V=u(R,2),re=u(o(V),2);re.__click=[ay,A];var me=u(o(re),2);let je;i(re);var de=u(re,2);let ie;var Pe=o(de);{var Ve=fe=>{var z=oy();m(fe,z)},Ze=fe=>{var z=ly(),B=Je(z),I=o(B),G=u(o(I),2),Z=u(o(G),2),le=o(Z,!0);i(Z),i(G),i(I);var N=u(I,2),M=u(o(N),2),H=u(o(M),2),pe=o(H,!0);i(H),i(M),i(N);var ee=u(N,2),Ae=u(o(ee),2),Ue=u(o(Ae),2),Le=o(Ue,!0);i(Ue),i(Ae),i(ee),i(B);var He=u(B,2),Ie=o(He),nt=u(o(Ie),2),bt=u(o(nt),2),pt=o(bt,!0);i(bt),i(nt),i(Ie);var vt=u(Ie,2),Tt=u(o(vt),2),Ot=u(o(Tt),2),la=o(Ot,!0);i(Ot),i(Tt),i(vt);var sa=u(vt,2),zt=u(o(sa),2),qt=u(o(zt),2),Pt=o(qt,!0);i(qt),i(zt),i(sa),i(He),q(()=>{w(le,e(y).id),w(pe,e(y).name),w(Le,e(y).position),w(pt,e(y).email||"Not provided"),w(la,e(k)),w(Pt,e(y).department)}),m(fe,z)};E(Pe,fe=>{e(h)?fe(Ve):fe(Ze,!1)})}i(de),i(V);var ve=u(V,2),Ce=u(o(ve),2);Ce.__click=[sy,T];var Qe=u(o(Ce),2);let Xe;i(Ce);var ze=u(Ce,2);let We;var Te=o(ze);{var ue=fe=>{var z=cy();m(fe,z)},be=fe=>{var z=mt(),B=Je(z);{var I=Z=>{var le=uy();xt(le,21,()=>e(p),Ua,(N,M)=>{var H=mt(),pe=Je(H);xt(pe,17,()=>e(M).sections,Ua,(ee,Ae)=>{var Ue=dy(),Le=u(o(Ue),2),He=o(Le),Ie=o(He,!0);i(He);var nt=u(He,2),bt=o(nt);i(nt),i(Le),i(Ue),q(()=>{w(Ie,e(Ae).name),w(bt,`${e(M).gradeName??""}  ${e(Ae).students??""} students`)}),m(ee,Ue)}),m(N,H)}),i(le),m(Z,le)},G=Z=>{var le=vy();m(Z,le)};E(B,Z=>{e(p).length>0?Z(I):Z(G,!1)},!0)}m(fe,z)};E(Te,fe=>{e(h)?fe(ue):fe(be,!1)})}i(ze),i(ve);var ke=u(ve,2),Fe=u(o(ke),2);Fe.__click=[ry,C];var Re=u(o(Fe),2);let et;i(Fe);var $e=u(Fe,2);let ot;var Me=o($e);{var it=fe=>{var z=fy();m(fe,z)},ft=fe=>{var z=mt(),B=Je(z);{var I=Z=>{var le=my();xt(le,21,()=>e(y).subjects,N=>N.id,(N,M)=>{var H=py(),pe=o(H),ee=o(pe);i(pe);var Ae=u(pe,2),Ue=o(Ae),Le=o(Ue,!0);i(Ue);var He=u(Ue,2),Ie=o(He);{var nt=pt=>{var vt=Sa();q(()=>w(vt,`${e(M).section_count??""} ${e(M).section_count===1?"section":"sections"}`)),m(pt,vt)},bt=pt=>{var vt=Sa("No sections assigned");m(pt,vt)};E(Ie,pt=>{e(M).section_count?pt(nt):pt(bt,!1)})}i(He),i(Ae),i(H),q(()=>{Wa(H,`border-color: ${e(M).color??""};`),Wa(ee,`background-color: ${e(M).color??""}20; color: ${e(M).color??""}`),w(Le,e(M).name)}),m(N,H)}),i(le),m(Z,le)},G=Z=>{var le=hy();m(Z,le)};E(B,Z=>{e(y).subjects.length>0?Z(I):Z(G,!1)},!0)}m(fe,z)};E(Me,fe=>{e(h)?fe(it):fe(ft,!1)})}i($e),i(ke);var Ye=u(ke,2),Y=u(o(Ye),2),ce=o(Y),De=o(ce),U=u(o(De),2),ne=o(U);ne.__click=[iy,L],i(U),i(De),i(ce),i(Y),i(Ye),q((fe,z,B,I,G,Z)=>{se.disabled=e(h),je=_e(me,1,"material-symbols-outlined teacher-collapse-icon",null,je,fe),ie=_e(de,1,"teacher-section-content",null,ie,z),Xe=_e(Qe,1,"material-symbols-outlined teacher-collapse-icon",null,Xe,B),We=_e(ze,1,"teacher-section-content",null,We,I),et=_e(Re,1,"material-symbols-outlined teacher-collapse-icon",null,et,G),ot=_e($e,1,"teacher-section-content",null,ot,Z)},[()=>({rotated:e(A)}),()=>({collapsed:e(A)}),()=>({rotated:e(T)}),()=>({collapsed:e(T)}),()=>({rotated:e(C)}),()=>({collapsed:e(C)})]),m(W,$)};E(j,W=>{e(g)?W(P):W(Q,!1)})}i(F),m(s,F),za(),r()}Ps(["click"]);const Pn="teacherScheduleCache",yy=300*1e3;function wy(){const{subscribe:s,set:t,update:a}=Hs({scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),r={subscribe:s,init:(n,l)=>{const c=xy(n,l);return c?(a(d=>({...d,scheduleData:c.scheduleData,lastUpdated:c.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(n,l=!1)=>{a(c=>({...c,isLoading:n&&!c.isInitialized&&!l,isRefreshing:n&&l,error:n?null:c.error}))},updateScheduleData:(n,l,c,d=!1)=>{const f=Date.now();a(p=>({...p,scheduleData:n,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),Sc(n,l,c,f)},setError:(n,l=!1)=>{a(c=>({...c,error:n,isLoading:!1,isRefreshing:!1}))},loadSchedule:async(n,l,c=!1)=>{try{a(g=>({...g,isLoading:!c&&!g.isInitialized,isRefreshing:c,error:null}));let d=l;d||(d=(await(await ns("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026");const p=await(await ns(`/api/schedules?action=teacher-schedules&teacherId=${n}&schoolYear=${d}`)).json();if(!p.success)throw new Error(p.error||"Failed to fetch schedule data");const h=Sy(p.data);a(g=>({...g,scheduleData:h,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),isInitialized:!0})),Sc(h,n,d,Date.now())}catch(d){console.error("Error loading teacher schedule:",d),a(f=>({...f,error:d.message,isLoading:!1,isRefreshing:!1}))}},clearCache:(n,l)=>{try{const c=`${Pn}_${n}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear teacher schedule cache:",c)}},forceRefresh:async(n,l)=>{try{const c=`${Pn}_${n}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear cache during force refresh:",c)}a(c=>({...c,isInitialized:!1,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}})),await r.loadSchedule(n,l,!1)}};return r}function xy(s,t){try{const a=`${Pn}_${s}_${t}`,r=localStorage.getItem(a);if(!r)return null;const n=JSON.parse(r);return Date.now()-n.timestamp>yy?(localStorage.removeItem(a),null):{scheduleData:n.scheduleData,lastUpdated:n.timestamp}}catch(a){return console.warn("Failed to retrieve cached teacher schedule:",a),null}}function Sc(s,t,a,r){try{const n=`${Pn}_${t}_${a}`,l={scheduleData:s,timestamp:r,teacherId:t,schoolYear:a};localStorage.setItem(n,JSON.stringify(l))}catch(n){console.warn("Failed to cache teacher schedule data:",n)}}function Sy(s){const t={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},a={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},r=["blue","green","purple","yellow","orange"];function n(c){return r[c%r.length]}const l={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return s.forEach(c=>{const d=a[c.day_of_week.toLowerCase()];if(d){const f=kc(c.start_time),p=kc(c.end_time);let h,g;c.schedule_type==="subject"?(h=c.section_name,g=c.subject_name||"Unknown Subject"):c.schedule_type==="activity"&&(h=c.activity_type_name||"Activity",g=c.activity_type_name||"Activity");const b={name:h,time:`${f} - ${p}`,room:c.room_name||"TBA",subject:g,gradeLevel:c.grade_level,scheduleType:c.schedule_type,color:n(l[d])};t[d].push(b),l[d]++}}),Object.keys(t).forEach(c=>{const d=t[c],f=ky(d),p=[...d,...f].sort((h,g)=>{const b=di(h.time.split(" - ")[0]),y=di(g.time.split(" - ")[0]);return b-y});t[c]=p}),t}function kc(s){const[t,a]=s.split(":"),r=parseInt(t),n=r>=12?"PM":"AM";return`${(r===0?12:r>12?r-12:r).toString().padStart(2,"0")}:${a} ${n}`}function di(s){const[t,a]=s.split(" "),[r,n]=t.split(":").map(Number);let l=n;return a==="PM"&&r!==12?l+=(r+12)*60:a==="AM"&&r===12?l+=0:l+=r*60,l}function Ac(s){const t=Math.floor(s/60),a=s%60,r=t>=12?"PM":"AM";return`${(t===0?12:t>12?t-12:t).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")} ${r}`}function ky(s){if(s.length<=1)return[];const t=[...s].sort((r,n)=>{const l=di(r.time.split(" - ")[0]),c=di(n.time.split(" - ")[0]);return l-c}),a=[];for(let r=0;r<t.length-1;r++){const n=t[r],l=t[r+1],c=di(n.time.split(" - ")[1]),d=di(l.time.split(" - ")[0]);if(d>c){const f=Ac(c),p=Ac(d);a.push({name:"Vacant Time",time:`${f} - ${p}`,room:"Available",subject:"Free Period",color:"gray",isVacant:!0})}}return a}const Ni=wy();var Ay=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),Dy=_("<button> </button>"),Cy=_('<div class="teacher-dropdown-menu"></div>'),Ty=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),Ey=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Fy=_('<div class="schedule-class-location"><span class="material-symbols-outlined">schedule</span> <span>Available Time</span></div>'),Ny=_('<div class="schedule-class-teacher"><span class="material-symbols-outlined">book</span> <span> </span></div>'),$y=_('<div class="schedule-class-grade"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Py=_('<div class="schedule-class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <!>',1),Ly=_('<div><div class="class-header"><h3 class="schedule-class-name"> </h3> <span class="schedule-class-time"> </span></div> <div class="class-details"><!></div></div>'),My=_('<div class="schedule-classes-grid"></div>'),Iy=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),Ry=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-schedule-header"><h1 class="schedule-page-title">Teaching Schedule</h1> <p class="schedule-page-subtitle">Your weekly teaching schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="schedule-day-selector"></div> <div class="teacher-mobile-dropdown"><button class="teacher-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function Oy(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(Ni,"$teacherScheduleStore",a),l=()=>Ja(gs,"$authStore",a),c=O(),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=new Date,k=["January","February","March","April","May","June","July","August","September","October","November","December"],A=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=k[y.getMonth()],C=y.getDate(),D=A[y.getDay()],S={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},L=y.getDay();let F=O(S[L]||"Mon");Ya(async()=>{const $e=l();if(!$e.isAuthenticated||!$e.userData?.id){console.error("User not authenticated");return}const ot=$e.userData.id,Me=Ni.init(ot,null);await Ni.loadSchedule(ot,null,Me);const it=setInterval(async()=>{await Ni.loadSchedule(ot,null,!0)},300*1e3);return()=>{clearInterval(it)}});async function j(){const $e=l();if(!$e.isAuthenticated||!$e.userData?.id){console.error("User not authenticated");return}const ot=$e.userData.id;await Ni.forceRefresh(ot,null)}const P={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"},Q=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}];let W=O(0),$=O(!1);function R($e){$e.target.closest(".teacher-mobile-dropdown")||v($,!1)}function X(){v($,!e($))}function se($e){v(F,$e),v($,!1)}_t(()=>(e(c),e(d),e(f),e(p),e(h),n()),()=>{($e=>{v(c,$e.scheduleData),v(d,$e.isLoading),v(f,$e.isRefreshing),v(p,$e.error),v(h,$e.lastUpdated)})(n())}),_t(()=>(e(c),e(F)),()=>{v(g,e(c)[e(F)]||[])}),_t(()=>e(F),()=>{v(b,P[e(F)]||"Monday")}),_t(()=>(e(F),e(W)),()=>{e(F),or(W)}),Rs(),Ls();var V=Ry(),re=u(o(V),2),me=o(re),je=o(me),de=o(je);i(je),i(me);var ie=u(me,2);xt(ie,5,()=>Q,Ua,($e,ot)=>{let Me=()=>e(ot).day;var it=Ay(),ft=o(it),Ye=o(ft,!0);i(ft);var Y=u(ft,2),ce=o(Y,!0);i(Y),i(it),q(()=>{_e(it,1,`schedule-day-btn ${Me()===e(F)?"active":""}`),w(Ye,Me()),w(ce,(Me(),x(()=>P[Me()])))}),ye("click",it,()=>se(Me())),m($e,it)}),i(ie);var Pe=u(ie,2),Ve=o(Pe),Ze=o(Ve),ve=o(Ze,!0);i(Ze);var Ce=u(Ze,2);i(Ve);var Qe=u(Ve,2);{var Xe=$e=>{var ot=Cy();xt(ot,5,()=>Q,Ua,(Me,it)=>{let ft=()=>e(it).day;var Ye=Dy(),Y=o(Ye,!0);i(Ye),q(()=>{_e(Ye,1,`teacher-dropdown-item ${ft()===e(F)?"selected":""}`),w(Y,(ft(),x(()=>P[ft()])))}),ye("click",Ye,()=>se(ft())),m(Me,Ye)}),i(ot),m($e,ot)};E(Qe,$e=>{e($)&&$e(Xe)})}i(Pe),i(re);var ze=u(re,2),We=o(ze),Te=o(We),ue=o(Te);i(Te);var be=u(Te,2),ke=o(be);i(be),i(We);var Fe=u(We,2);{var Re=$e=>{var ot=Ty();m($e,ot)},et=$e=>{var ot=mt(),Me=Je(ot);{var it=Ye=>{var Y=Ey(),ce=u(o(Y),4),De=o(ce,!0);i(ce);var U=u(ce,2);i(Y),q(()=>w(De,e(p))),ye("click",U,j),m(Ye,Y)},ft=Ye=>{var Y=mt(),ce=Je(Y);{var De=ne=>{var fe=mt(),z=Je(fe);Is(z,()=>e(W),B=>{var I=My();xt(I,5,()=>e(g),Ua,(G,Z,le)=>{var N=Ly();Wa(N,`--card-index: ${le};`);var M=o(N),H=o(M),pe=o(H,!0);i(H);var ee=u(H,2),Ae=o(ee,!0);i(ee),i(M);var Ue=u(M,2),Le=o(Ue);{var He=nt=>{var bt=Fy();m(nt,bt)},Ie=nt=>{var bt=Py(),pt=Je(bt),vt=u(o(pt),2),Tt=o(vt,!0);i(vt),i(pt);var Ot=u(pt,2);{var la=qt=>{var Pt=Ny(),Yt=u(o(Pt),2),Ut=o(Yt,!0);i(Yt),i(Pt),q(()=>w(Ut,(e(Z),x(()=>e(Z).subject)))),m(qt,Pt)};E(Ot,qt=>{e(Z),x(()=>e(Z).subject)&&qt(la)})}var sa=u(Ot,2);{var zt=qt=>{var Pt=$y(),Yt=u(o(Pt),2),Ut=o(Yt);i(Yt),i(Pt),q(()=>w(Ut,`Grade ${e(Z),x(()=>e(Z).gradeLevel)??""}`)),m(qt,Pt)};E(sa,qt=>{e(Z),x(()=>e(Z).gradeLevel&&e(Z).scheduleType==="subject")&&qt(zt)})}q(()=>w(Tt,(e(Z),x(()=>e(Z).room)))),m(nt,bt)};E(Le,nt=>{e(Z),x(()=>e(Z).scheduleType==="vacant")?nt(He):nt(Ie,!1)})}i(Ue),i(N),q(()=>{_e(N,1,`schedule-class-card ${e(Z),x(()=>e(Z).color)??""}`),w(pe,(e(Z),x(()=>e(Z).name))),w(Ae,(e(Z),x(()=>e(Z).time)))}),m(G,N)}),i(I),m(B,I)}),m(ne,fe)},U=ne=>{var fe=Iy(),z=u(o(fe),4),B=o(z);i(z),i(fe),q(()=>w(B,`You don't have any classes scheduled for ${e(b)??""}. Enjoy your free day!`)),m(ne,fe)};E(ce,ne=>{e(g),x(()=>e(g).length>0)?ne(De):ne(U,!1)},!0)}m(Ye,Y)};E(Me,Ye=>{e(p)?Ye(it):Ye(ft,!1)},!0)}m($e,ot)};E(Fe,$e=>{e(d)?$e(Re):$e(et,!1)})}i(ze),i(V),q(()=>{w(de,`${D??""}, ${T??""} ${C??""}`),w(ve,(e(F),x(()=>P[e(F)]||"Select Day"))),_e(Ce,1,`material-symbols-outlined teacher-dropdown-icon ${e($)?"open":""}`),w(ue,`${e(b)??""} Classes`),ke.disabled=e(d)}),ye("click",Ve,X),ye("click",ke,j),ye("click",V,R),ye("keydown",V,R),m(s,V),za(),r()}var jy=_('<div><div class="stat-card-header"><p class="class-mgmt-stat-label"> </p> <div class="class-mgmt-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="class-mgmt-stat-value"><!></h3></div></div>'),qy=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your teaching assignments...</p></div>'),zy=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Gy=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Teaching Assignments</h3> <p>You don't have any sections assigned for this school year.</p></div>`),Vy=(s,t,a,r)=>t(e(a).yearLevel,e(r).name,e(r).id),By=_('<span class="more-subjects"> </span>'),Wy=_('<div class="section-subjects"><span> </span> <!></div>'),Hy=_('<button class="section-card stagger-section-item"><div class="section-card-content"><div class="section-name"> </div> <!></div> <div class="section-card-icon"><span class="material-symbols-outlined">chevron_right</span></div></button>'),Uy=_('<div class="year-level-container stagger-item"><div class="year-level-header"><div class="year-level-info"><div class="year-level-icon"><span class="material-symbols-outlined">school</span></div> <div class="year-level-details"><h3 class="year-level-title"> </h3> <p class="year-level-summary"> </p></div></div></div> <div class="sections-grid"></div></div>'),Yy=_('<div class="year-levels-grid"></div>'),Qy=_('<div class="class-management-container"><div class="class-mgmt-page-header fade-in"><div class="header-content"><h1 class="class-mgmt-page-title">Class Management</h1> <p class="class-mgmt-page-subtitle">Overview of your teaching assignments and student distribution</p></div></div> <div class="class-mgmt-stats-section"><div class="class-mgmt-stats-grid"></div></div> <div class="classes-section-container"><h2 class="class-mgmt-section-title">Year Levels & Sections</h2> <!></div></div>');function Dc(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(gs,"$authStore",a);let l=ut(Xs({name:"Loading...",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0})),c=ut(Xs([])),d=ut(!0),f=ut(null);function p(F,j,P){t.onNavigateToClassList&&t.onNavigateToClassList({detail:{yearLevel:F,sectionName:j,sectionId:P}})}const h=["border-blue","border-green","border-orange","border-purple"];function g(F){return h[F%h.length]}let b=[{id:"year-levels",label:"Year Levels",getValue:()=>e(l).yearLevels.length,icon:"school",color:"var(--school-primary)"},{id:"sections",label:"Total Sections",getValue:()=>e(l).totalSections,icon:"class",color:"var(--school-secondary)"},{id:"students",label:"Total Students",getValue:()=>e(l).totalStudents,icon:"people",color:"var(--success)"},{id:"average",label:"Average Per Section",getValue:()=>e(l).averagePerSection,icon:"analytics",color:"var(--school-accent)"}];async function y(){try{v(d,!0),v(f,null);const F=n();if(!F.isAuthenticated||!F.userData?.id)throw new Error("User not authenticated");const j=F.userData.id,W=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",R=await(await fetch(`/api/teacher-sections?teacherId=${j}&schoolYear=${W}`)).json();if(!R.success)throw new Error(R.error||"Failed to fetch teacher sections");v(c,R.data.classData,!0),v(l,{name:F.userData.name||"Teacher",yearLevels:R.data.stats.yearLevels,totalSections:R.data.stats.totalSections,totalStudents:R.data.stats.totalStudents,averagePerSection:R.data.stats.averagePerSection},!0)}catch(F){console.error("Error fetching teacher sections:",F),v(f,F.message,!0),v(c,[],!0),v(l,{name:"Teacher",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0},!0)}finally{v(d,!1)}}Ya(()=>{y()});var k=Qy(),A=u(o(k),2),T=o(A);xt(T,23,()=>b,F=>F.id,(F,j,P)=>{var Q=jy(),W=o(Q),$=o(W),R=o($,!0);i($);var X=u($,2),se=o(X),V=o(se,!0);i(se),i(X),i(W);var re=u(W,2),me=o(re),je=o(me);{let de=ea(()=>e(j).getValue());Qr(je,{get value(){return e(de)},decimals:0,duration:2})}i(me),i(re),i(Q),q(de=>{_e(Q,1,`class-mgmt-stat-card ${de??""} stagger-item`),Wa(Q,`--stagger-index: ${e(P)??""}`),w(R,e(j).label),w(V,e(j).icon)},[()=>g(e(P))]),m(F,Q)}),i(T),i(A);var C=u(A,2),D=u(o(C),2);{var S=F=>{var j=qy();m(F,j)},L=F=>{var j=mt(),P=Je(j);{var Q=$=>{var R=zy(),X=u(o(R),2),se=o(X);i(X);var V=u(X,2);V.__click=y,i(R),q(()=>w(se,`Error: ${e(f)??""}`)),m($,R)},W=$=>{var R=mt(),X=Je(R);{var se=re=>{var me=Gy();m(re,me)},V=re=>{var me=Yy();xt(me,23,()=>e(c),je=>je.yearLevel,(je,de,ie)=>{var Pe=Uy(),Ve=o(Pe),Ze=o(Ve),ve=u(o(Ze),2),Ce=o(ve),Qe=o(Ce,!0);i(Ce);var Xe=u(Ce,2),ze=o(Xe);i(Xe),i(ve),i(Ze),i(Ve);var We=u(Ve,2);xt(We,23,()=>e(de).sections,Te=>Te.name,(Te,ue,be)=>{var ke=Hy();ke.__click=[Vy,p,de,ue];var Fe=o(ke),Re=o(Fe),et=o(Re,!0);i(Re);var $e=u(Re,2);{var ot=Me=>{var it=Wy(),ft=o(it),Ye=o(ft,!0);i(ft);var Y=u(ft,2);{var ce=De=>{var U=By(),ne=o(U);i(U),q(()=>w(ne,`+${e(ue).subjects.length-2} more`)),m(De,U)};E(Y,De=>{e(ue).subjects.length>2&&De(ce)})}i(it),q(De=>w(Ye,De),[()=>e(ue).subjects.slice(0,2).join(", ")]),m(Me,it)};E($e,Me=>{e(ue).subjects&&e(ue).subjects.length>0&&Me(ot)})}i(Fe),Bt(2),i(ke),q(()=>{$t(ke,"aria-label",`View class list for ${e(ue).name??""}`),Wa(ke,`--stagger-index: ${e(be)??""}`),w(et,e(ue).name)}),m(Te,ke)}),i(We),i(Pe),q(Te=>{Wa(Pe,`--stagger-index: ${e(ie)??""}`),w(Qe,e(de).gradeName),w(ze,`${e(de).sections.length??""} section${e(de).sections.length!==1?"s":""}  ${Te??""} students`)},[()=>e(de).sections.reduce((Te,ue)=>Te+ue.students,0)]),m(je,Pe)}),i(me),m(re,me)};E(X,re=>{e(c).length===0?re(se):re(V,!1)},!0)}m($,R)};E(P,$=>{e(f)?$(Q):$(W,!1)},!0)}m(F,j)};E(D,F=>{e(d)?F(S):F(L,!1)})}i(C),i(k),m(s,k),za(),r()}Ps(["click"]);async function Ky(s,t,a,r,n,l,c,d,f,p,h){if(!t.sectionId||!t.subjectId){Se.error("Missing section or subject information");return}us.confirm("Send Grades to Adviser","Are you sure you want to send final grades to the adviser?",async()=>{const g=a().filter(y=>!y.isVerified),b=a().length-g.length;if(g.length===0){Se.warning("All student grades have already been verified by the adviser. No grades to send.");return}v(r,!0),v(n,""),v(l,!1);try{const y=g.map(T=>{const C=c(T.writtenWork,d().writtenWork.totals,"writtenWork"),D=c(T.performanceTasks,d().performanceTasks.totals,"performanceTasks"),S=c(T.quarterlyAssessment,d().quarterlyAssessment.totals,"quarterlyAssessment"),L=f(T);return{student_id:T.accountNumber||T.account_number||T.id,written_work_average:C!==""?parseFloat(C):null,performance_tasks_average:D!==""?parseFloat(D):null,quarterly_assessment_average:S!==""?parseFloat(S):null,final_grade:L!==""?parseFloat(L):null,written_work_items:T.writtenWork||[],performance_tasks_items:T.performanceTasks||[],quarterly_assessment_items:T.quarterlyAssessment||[]}}),k=await ns("/api/grades",{method:"POST",body:JSON.stringify({action:"submit_final_grades",section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:p(),teacher_id:h().userData.id,final_grades:y})});if(!k.ok){const T=await k.json().catch(()=>({}));throw console.error("API error response:",T),new Error(T.error||`HTTP ${k.status}: ${k.statusText}`)}const A=await k.json();v(l,!0),b>0?Se.success(`Final grades sent to adviser for ${g.length} students. ${b} verified students were skipped.`):Se.success("Final grades have been sent to the adviser successfully!"),setTimeout(()=>{v(n,"")},3e3)}catch(y){console.error("Error saving final grades:",y),v(l,!1),v(n,y.message||"Failed to save final grades",!0),Se.error(e(n)),setTimeout(()=>{v(n,"")},5e3)}finally{v(r,!1)}},()=>{})}async function Jy(s,t,a,r,n,l,c,d,f,p){try{Se.info("Refreshing grades from database...");const h=t(),g=h.isAuthenticated?h.userData?.id:null,b=new URLSearchParams({sectionId:a.sectionId.toString(),subjectId:a.subjectId.toString(),gradingPeriodId:r().toString()});g&&b.append("teacherId",g.toString());const y=await ns(`/api/class-students?${b}`);if(!y.ok)throw new Error(`HTTP ${y.status}: ${y.statusText}`);const k=await y.json();if(k.success&&k.data?.students)n(k.data.students.map(A=>({...A,writtenWork:A.grades?.written_work||[],performanceTasks:A.grades?.performance_tasks||[],quarterlyAssessment:A.grades?.quarterly_assessment||[],grades:A.grades,id:A.account_number||A.id,name:A.full_name||`${A.first_name} ${A.last_name}`,isVerified:A.grades?.verified||A.grades?.verification?.verified||!1}))),l(),v(c,!0),v(d,!1),v(f,p(),!0),Se.success("Grades refreshed successfully");else throw new Error(k.error||"Failed to refresh grades")}catch(h){console.error("Error refreshing grades:",h),Se.error("Failed to refresh grades. Please try again.")}}var Xy=_('<span class="material-symbols-outlined spinning">sync</span> <span>Saving...</span>',1),Zy=_('<span class="material-symbols-outlined">check_circle</span> <span>Grades Saved</span>',1),e1=_('<span class="material-symbols-outlined">save</span> <span>Save Grades</span>',1),t1=_('<span class="material-symbols-outlined spinning">sync</span> <span>Uploading...</span>',1),a1=_('<span class="material-symbols-outlined">upload</span> <span>Send to Adviser</span>',1),s1=_('<div class="spreadsheet-loading-overlay"><div class="spreadsheet-loader"><div class="loader-spinner"></div> <p>Loading grading spreadsheet...</p></div></div>'),r1=_('<div class="header-overlay"><span class="header-icon material-symbols-outlined">settings</span></div>'),i1=_('<th><span class="header-text"> </span> <!></th>'),n1=_('<input type="text" class="cell-input"/>'),o1=_('<span class="cell-content verified-cell"> </span>'),l1=_('<span class="cell-content"> </span>'),c1=_("<td><!></td>"),d1=_("<tr></tr>"),u1=_('<div class="spreadsheet-container"><table class="spreadsheet-table"><thead><tr></tr></thead><tbody></tbody></table></div>'),v1=_('<div class="save-section"><div class="refresh-button-container"><button class="refresh-grades-button" title="Refresh grades from database"><span class="material-symbols-outlined">refresh</span> <span>Refresh</span></button></div> <div class="save-button-container"><button><!></button> <button class="final-grades-button" title="Upload final grades (averages and computed final grades) to database"><!></button></div></div> <div class="grading-spreadsheet"><!></div>',1);function f1(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(gs,"$authStore",a);let l=Ma(t,"students",23,()=>[]),c=Ma(t,"gradingPeriodId",3,1),d=Ma(t,"gradingConfig",23,()=>({writtenWork:{count:3,weight:.3,totals:[]},performanceTasks:{count:3,weight:.5,totals:[]},quarterlyAssessment:{count:1,weight:.2,totals:[]}})),f=ut(!1),p=ut(!1),h=ut(""),g=ut(!1),b=ut(!1),y=ut(!0),k=ut(null),A,T=ut(null),C=ut(!1),D=ut(""),S=ut(!0),L=ut(!1),F=ut(Xs(new Set)),j=ut(Xs([]));Xs([]);function P(z){if(z==null||z==="")return"0";const B=parseFloat(z);return isNaN(B)?z:(B%1===0,B.toString())}function Q(){return JSON.parse(JSON.stringify(l().map(z=>({id:z.id,writtenWork:Array.isArray(z.writtenWork)?[...z.writtenWork]:[],performanceTasks:Array.isArray(z.performanceTasks)?[...z.performanceTasks]:[],quarterlyAssessment:Array.isArray(z.quarterlyAssessment)?[...z.quarterlyAssessment]:[]}))))}function W(){if(!e(k))return!1;const z=Q(),B=JSON.stringify(z)!==JSON.stringify(e(k));return v(b,B),v(y,!B),B}function $(){const z=["Student ID","Student Name"];for(let B=1;B<=d().writtenWork.count;B++)z.push(Ze("writtenWork",B-1));z.push("WW Avg");for(let B=1;B<=d().performanceTasks.count;B++)z.push(Ze("performanceTasks",B-1));z.push("PT Avg");for(let B=1;B<=d().quarterlyAssessment.count;B++)z.push(Ze("quarterlyAssessment",B-1));z.push("QA Avg"),z.push("Final Grade"),v(j,[z],!0),l().forEach(B=>{if(!B||!B.id||!B.name){console.warn("Invalid student data:",B);return}const I=[B.id,B.name],G=B.writtenWork||[];for(let N=0;N<d().writtenWork.count;N++)I.push(P(G[N]));I.push(R(G,d().writtenWork.totals,"writtenWork"));const Z=B.performanceTasks||[];for(let N=0;N<d().performanceTasks.count;N++)I.push(P(Z[N]));I.push(R(Z,d().performanceTasks.totals,"performanceTasks"));const le=B.quarterlyAssessment||[];for(let N=0;N<d().quarterlyAssessment.count;N++)I.push(P(le[N]));I.push(R(le,d().quarterlyAssessment.totals,"quarterlyAssessment")),I.push(X(B)),e(j).push(I)}),v(k,Q(),!0),v(y,!1),v(b,!1),v(S,!1)}function R(z,B=null,I=null){if(!z||!Array.isArray(z))return"";const G=z.filter(le=>le!=null&&le!=="");if(G.length===0)return"";let Z=0;if(B&&B.length>0){let le=0,N=0;const M=Math.min(z.length,B.length);for(let pe=0;pe<M;pe++){const ee=z[pe];if(ee!=null&&ee!==""){const Ae=parseFloat(ee),Ue=B[pe];if(Ue&&Ue>0){const Le=Ae/Ue*100;le+=Le,N++}}}if(N===0)return"";const H=Math.round(le/N*10)/10;return P(H)}else{Z=G.reduce((N,M)=>N+parseFloat(M),0);const le=Math.round(Z/G.length*10)/10;return P(le)}}function X(z){if(!z)return"";const B=R(z.writtenWork,d().writtenWork.totals,"writtenWork"),I=R(z.performanceTasks,d().performanceTasks.totals,"performanceTasks"),G=R(z.quarterlyAssessment,d().quarterlyAssessment.totals,"quarterlyAssessment");if(B===""||I===""||G==="")return"";const Z=parseFloat(B)||0,le=parseFloat(I)||0,N=parseFloat(G)||0,M=Z*d().writtenWork.weight+le*d().performanceTasks.weight+N*d().quarterlyAssessment.weight,H=Math.round(M*10)/10;return P(H)}function se(z,B,I){if(B<2)return;const G=z-1,Z=l()[G];if(Z&&Z.isVerified){Se.warning("This student's grades have been verified by the adviser and cannot be edited.");return}v(T,{row:z,col:B},!0),v(C,!1)}function V(z){if(!e(T)||e(C))return;const{row:B,col:I}=e(T);if(z.key==="ArrowUp"||z.key==="ArrowDown"||z.key==="ArrowLeft"||z.key==="ArrowRight"){z.preventDefault(),re(z.key);return}if(z.key==="Enter"){z.preventDefault(),re("ArrowDown");return}if(z.key==="Tab"){z.preventDefault(),re(z.shiftKey?"ArrowLeft":"ArrowRight");return}if(/^[0-9.]$/.test(z.key)&&!je(I)&&I>1){const G=B-1,Z=l()[G];if(Z&&Z.isVerified){Se.warning("This student's grades have been verified by the adviser and cannot be edited.");return}z.preventDefault(),v(C,!0),v(D,z.key,!0),v(L,!1)}else if(z.key.length===1&&!je(I)&&I>1){const G=B-1,Z=l()[G];if(Z&&Z.isVerified){Se.warning("This student's grades have been verified by the adviser and cannot be edited.");return}z.preventDefault(),v(C,!0),v(D,z.key,!0),v(L,!1)}}function re(z){if(!e(T)||!e(j).length)return;const{row:B,col:I}=e(T),G=e(j).length-1,Z=e(j)[0].length-1;let le=B,N=I;switch(z){case"ArrowUp":le=Math.max(1,B-1);break;case"ArrowDown":le=Math.min(G,B+1);break;case"ArrowLeft":N=Math.max(0,I-1);break;case"ArrowRight":N=Math.min(Z,I+1);break}v(T,{row:le,col:N},!0),me(le,N)}function me(z,B){if(!A)return;const I=A.querySelector(`tbody tr:nth-child(${z}) td:nth-child(${B+1})`);I&&I.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}function je(z){const I=e(j)[0][z];return I?.includes("Avg")||I==="Final Grade"}function de(z){return Ve(z)!==null}function ie(z){const I=e(j)[0][z];return z<2?"spreadsheet-student-info":I==="Final Grade"||I?.includes("Avg")?"calculated":I?.startsWith("WW")?"written-work":I?.startsWith("PT")?"performance-task":I?.startsWith("QA")?"quarterly-assessment":"default"}function Pe(z,B){B.preventDefault(),B.stopPropagation(),de(z)&&We(z)}function Ve(z){let B=2;for(let I=0;I<d().writtenWork.count;I++){if(B===z)return{assessmentType:"writtenWork",columnIndex:I};B++}B++;for(let I=0;I<d().performanceTasks.count;I++){if(B===z)return{assessmentType:"performanceTasks",columnIndex:I};B++}B++;for(let I=0;I<d().quarterlyAssessment.count;I++){if(B===z)return{assessmentType:"quarterlyAssessment",columnIndex:I};B++}return null}function Ze(z,B){const I=ve(z,B),G=d()[z].totals[B]||100;return`${I} - ${G}`}function ve(z,B){if(d()[z].columnNames&&d()[z].columnNames[B])return d()[z].columnNames[B];const I=z==="writtenWork"?"WW":z==="performanceTasks"?"PT":"QA";return d()[z].columnPositions&&d()[z].columnPositions[B]!==void 0?`${I}${d()[z].columnPositions[B]}`:`${I}${B+1}`}function Ce(){return l().some(z=>z.isVerified||z.verified)}function Qe(){if(!e(T)||e(T).row===0)return;const{row:z,col:B}=e(T),I=z-1,G=l()[I];if(!G)return;const Z=Ve(B);if(!Z)return;const{assessmentType:le,columnIndex:N}=Z;let M=e(D).trim(),H=null,pe=!0,ee="";if(M!==""){if(H=parseFloat(M),isNaN(H)||H<0)H=0,pe=!1,ee=isNaN(parseFloat(M))?"Invalid input. Only numbers are allowed.":"Negative scores are not allowed.";else{const Ae=d()[le].totals?.[N];Ae&&H>Ae&&(H=0,pe=!1,ee=`Score cannot exceed the total score of ${Ae}.`)}pe?e(F).delete(`${z}-${B}`):(Se.error(ee),e(F).add(`${z}-${B}`),setTimeout(()=>{e(F).delete(`${z}-${B}`),v(F,new Set(e(F)),!0)},3e3))}else H=null,e(F).delete(`${z}-${B}`);G[le][N]=H,l([...l()]),$(),W()}function Xe(z,B,I){if(e(T)&&e(C)){if(z.key==="Enter"){z.preventDefault();const G=e(T).row,Z=e(T).col;Qe(),v(C,!1),setTimeout(()=>{v(T,{row:G,col:Z},!0),re("ArrowDown")},0);return}if(z.key==="Tab"){z.preventDefault();const G=e(T).row,Z=e(T).col;Qe(),v(C,!1),setTimeout(()=>{v(T,{row:G,col:Z},!0),re(z.shiftKey?"ArrowLeft":"ArrowRight")},0);return}if(z.key==="ArrowUp"||z.key==="ArrowDown"||z.key==="ArrowLeft"||z.key==="ArrowRight"){z.preventDefault();const G=e(T).row,Z=e(T).col;Qe(),v(C,!1),setTimeout(()=>{v(T,{row:G,col:Z},!0),re(z.key)},0);return}if(z.key==="Escape"){z.preventDefault(),v(C,!1),v(D,"");return}}}async function ze(){if(!t.sectionId||!t.subjectId){Se.error("Missing section or subject information");return}v(f,!0),v(h,""),v(g,!1);try{const z=l().map(G=>({student_id:G.accountNumber||G.account_number||G.id,writtenWork:G.writtenWork,performanceTasks:G.performanceTasks,quarterlyAssessment:G.quarterlyAssessment})),B=await ns("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:c(),grading_config:d(),grades:z})});if(!B.ok){const G=await B.json().catch(()=>({}));throw new Error(G.error||`HTTP ${B.status}: ${B.statusText}`)}const I=await B.json();v(g,!0),Se.success("Grades saved successfully"),v(k,Q(),!0),v(b,!1),v(y,!0),setTimeout(()=>{v(h,"")},3e3)}catch(z){console.error("Error saving grades:",z),v(g,!1),v(h,z.message||"Failed to save grades",!0),Se.error(e(h)),setTimeout(()=>{v(h,"")},5e3)}finally{v(f,!1)}}Es(()=>{const z=l().length,B=d(),I=t.subjectId;x(()=>{(z>0||B||I)&&$()})}),Es(()=>()=>{});function We(z){const B=Ve(z);if(!B){Se.error("Cannot edit this column");return}const{assessmentType:I,columnIndex:G}=B,Z=ve(I,G),le=d()[I].totals[G]||100,N=d()[I].gradeItemIds?.[G];if(!N){Se.error("Cannot edit column: Grade item ID not found");return}const M=Ce();us.form("Edit Column","Edit the column name and total score for this assessment:",{label:"Column Name",type:"text",placeholder:"Enter column name",value:Z},{label:"Total Score",type:"number",placeholder:"Enter total score",value:le,min:1,max:1e3,disabled:M,disabledReason:M?"Cannot edit total score when grades are verified by adviser":""},async(H,pe)=>{if(!H||!H.trim()){Se.error("Column name cannot be empty");return}const ee=parseInt(pe);if(isNaN(ee)||ee<1||ee>1e3){Se.error("Total score must be between 1 and 1000");return}try{const Ae=await ns("/api/grades/grade-items",{method:"PUT",body:JSON.stringify({grade_item_id:N,name:H.trim(),total_score:ee})});d()[I].columnNames||(d()[I].columnNames=[]),d()[I].columnNames[G]=H.trim(),d()[I].totals[G]=ee,d({...d()}),$(),Se.success("Column updated successfully")}catch(Ae){console.error("Error updating column:",Ae),Se.error("Failed to update column. Please try again.")}},()=>{},()=>{us.confirm("Delete Column",`<p>Are you sure you want to permanently delete the column <strong>"${Z}"</strong>?</p>
          <p class="grading-warning">This action will:</p>
          <ul class="grading-warning-list">
            <li>Permanently delete the column and all its grades</li>
            <li>Remove all student scores for this assessment</li>
            <li>This action cannot be undone</li>
          </ul>`,async()=>{try{const H=await ns("/api/grades/grade-items",{method:"DELETE",body:JSON.stringify({grade_item_id:N})});if(!H.ok){const ee=await H.json().catch(()=>({error:H.statusText}));throw new Error(ee.error||`HTTP ${H.status}: ${H.statusText}`)}const pe=await H.json();d()[I].count-=1,d()[I].columnNames&&d()[I].columnNames.splice(G,1),d()[I].totals&&d()[I].totals.splice(G,1),d()[I].columnPositions&&d()[I].columnPositions.splice(G,1),d()[I].gradeItemIds&&d()[I].gradeItemIds.splice(G,1),d({...d()}),l(l().map(ee=>{const Ae={...ee};return I==="writtenWork"&&Ae.writtenWork?Ae.writtenWork.splice(G,1):I==="performanceTasks"&&Ae.performanceTasks?Ae.performanceTasks.splice(G,1):I==="quarterlyAssessment"&&Ae.quarterlyAssessment&&Ae.quarterlyAssessment.splice(G,1),Ae})),$(),Se.success("Column deleted successfully")}catch(H){console.error("Error deleting column:",H),Se.error("Failed to delete column. Please try again.")}},null,{size:"medium"})},{size:"small",deleteDisabled:M,deleteDisabledReason:M?"Cannot delete columns when grades are verified by adviser":""})}var Te=v1();ye("keydown",Zs,V);var ue=Je(Te),be=o(ue),ke=o(be);ke.__click=[Jy,n,t,c,l,$,y,b,k,Q],i(be);var Fe=u(be,2),Re=o(Fe);let et;Re.__click=ze;var $e=o(Re);{var ot=z=>{var B=Xy();Bt(2),m(z,B)},Me=z=>{var B=mt(),I=Je(B);{var G=le=>{var N=Zy();Bt(2),m(le,N)},Z=le=>{var N=e1();Bt(2),m(le,N)};E(I,le=>{e(y)&&!e(b)?le(G):le(Z,!1)},!0)}m(z,B)};E($e,z=>{e(f)?z(ot):z(Me,!1)})}i(Re);var it=u(Re,2);it.__click=[Ky,t,l,p,h,g,R,d,X,c,n];var ft=o(it);{var Ye=z=>{var B=t1();Bt(2),m(z,B)},Y=z=>{var B=a1();Bt(2),m(z,B)};E(ft,z=>{e(p)?z(Ye):z(Y,!1)})}i(it),i(Fe),i(ue);var ce=u(ue,2),De=o(ce);{var U=z=>{var B=s1();m(z,B)},ne=z=>{var B=u1(),I=o(B),G=o(I),Z=o(G);xt(Z,21,()=>e(j)[0]||[],Ua,(N,M,H)=>{var pe=i1();let ee;pe.__click=Ie=>Pe(H,Ie);var Ae=o(pe),Ue=o(Ae,!0);i(Ae);var Le=u(Ae,2);{var He=Ie=>{var nt=r1();m(Ie,nt)};E(Le,Ie=>{de(H)&&Ie(He)})}i(pe),q((Ie,nt)=>{ee=_e(pe,1,"spreadsheet-header",null,ee,Ie),$t(pe,"title",nt),w(Ue,e(M))},[()=>({"spreadsheet-student-info":H<2,calculated:je(H),"final-grade":ie(H)==="final-grade",clickable:de(H)}),()=>de(H)?"Click to set total scores":""]),m(N,pe)}),i(Z),i(G);var le=u(G);xt(le,21,()=>e(j).slice(1),Ua,(N,M,H)=>{var pe=d1();let ee;xt(pe,21,()=>e(M),Ua,(Ae,Ue,Le)=>{var He=c1();let Ie;He.__click=vt=>se(H+1,Le);var nt=o(He);{var bt=vt=>{var Tt=n1();aa(Tt),Tt.__keydown=Ot=>Xe(Ot),Qd(Tt),ye("blur",Tt,()=>{Qe(),v(C,!1)}),oa(Tt,()=>e(D),Ot=>v(D,Ot)),m(vt,Tt)},pt=vt=>{var Tt=mt(),Ot=Je(Tt);{var la=zt=>{var qt=o1(),Pt=o(qt,!0);i(qt),q(()=>w(Pt,e(Ue))),m(zt,qt)},sa=zt=>{var qt=l1(),Pt=o(qt,!0);i(qt),q(()=>w(Pt,e(Ue))),m(zt,qt)};E(Ot,zt=>{e(C)&&e(T)?.row===H+1&&e(T)?.col===Le&&l()[H]?.isVerified?zt(la):zt(sa,!1)},!0)}m(vt,Tt)};E(nt,vt=>{e(C)&&e(T)?.row===H+1&&e(T)?.col===Le&&!l()[H]?.isVerified?vt(bt):vt(pt,!1)})}i(He),q(vt=>Ie=_e(He,1,"spreadsheet-cell",null,Ie,vt),[()=>({selected:e(T)?.row===H+1&&e(T)?.col===Le,editing:e(C)&&e(T)?.row===H+1&&e(T)?.col===Le,"spreadsheet-student-info":Le<2,calculated:je(Le),"final-grade":ie(Le)==="final-grade",editable:!je(Le)&&Le>1,invalid:e(F).has(`${H+1}-${Le}`)})]),m(Ae,He)}),i(pe),q(Ae=>ee=_e(pe,1,"spreadsheet-row",null,ee,Ae),[()=>({verified:l()[H]?.isVerified})]),m(N,pe)}),i(le),i(I),i(B),Ws(B,N=>A=N,()=>A),m(z,B)};E(De,z=>{e(S)?z(U):z(ne,!1)})}i(ce),Ws(ce,z=>A=z,()=>A),q(z=>{et=_e(Re,1,"save-grades-button",null,et,z),Re.disabled=e(f)||e(y)&&!e(b),$t(Re,"title",e(y)&&!e(b)?"All grades are saved":"Save all grades to database"),it.disabled=e(p)},[()=>({saved:e(y)&&!e(b)})]),m(s,Te);var fe=za({saveGrades:ze});return r(),fe}Ps(["click","keydown"]);function p1(s,t){v(t,!e(t))}var m1=(s,t)=>t.onBackToClassManagement&&t.onBackToClassManagement(),h1=_('<button><span class="material-symbols-outlined">book</span> </button>'),g1=_('<div class="subject-tab-navigation"></div>'),_1=_('<div class="classlist-quarter-selected-option"><span class="material-symbols-outlined classlist-quarter-option-icon"> </span> <div class="classlist-quarter-option-content"><span class="classlist-quarter-option-name"> </span></div></div>'),b1=_('<span class="classlist-quarter-placeholder">Select quarter</span>'),y1=(s,t,a)=>t(e(a)),w1=_('<button type="button"><span class="material-symbols-outlined classlist-quarter-option-icon"> </span> <div class="classlist-quarter-option-content"><span class="classlist-quarter-option-name"> </span></div></button>'),x1=(s,t)=>t("writtenWork"),S1=(s,t)=>t("performanceTasks"),k1=(s,t)=>t("quarterlyAssessment"),A1=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading class data...</p></div>'),D1=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),C1=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Students Found</h3> <p>This section doesn't have any enrolled students yet.</p></div>`),T1=_('<div class="class-management-container"><div class="classlist-page-header"><div class="header-content"><div class="header-navigation"><button class="back-button"><span class="material-symbols-outlined">arrow_back</span> <span>Back to Class Management</span></button></div> <h1 class="classlist-page-title">Class Grading Sheet</h1> <p class="classlist-page-subtitle"> </p></div> <!></div> <div class="grading-config-section"><div class="config-header"><h2 class="config-title">Grading Configuration</h2> <div class="classlist-quarter-selector-container"><div><button type="button" id="classlist-quarter-select"><!> <span class="material-symbols-outlined classlist-quarter-dropdown-arrow">expand_more</span></button> <div class="classlist-quarter-dropdown-menu"></div></div></div></div> <div class="config-grid"><div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div></div> <!></div></div> <!>',1);function E1(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(gs,"$authStore",a);let l=ut(!0),c=ut(null),d=ut(!1),f=ut(!1),p=ut(null),h=ut(1),g=ut("1st Quarter"),b=ut("2025-2026"),y=ut(!1),k=ut(0),A=ut(null),T=ea(()=>e(p)?.subjects?.[e(k)]||null);const C=[{id:1,name:"1st Quarter",icon:"looks_one"},{id:2,name:"2nd Quarter",icon:"looks_two"},{id:3,name:"3rd Quarter",icon:"looks_3"},{id:4,name:"4th Quarter",icon:"looks_4"}],D=ea(()=>C.find(oe=>oe.id===e(h)));async function S(oe){if(!(!e(p)?.subjects||oe<0||oe>=e(p).subjects.length)){if(e(A)&&typeof e(A).saveGrades=="function")try{await e(A).saveGrades()}catch{}v(k,oe,!0),v(R,{writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}},!0),setTimeout(async()=>{try{await Q(),await $()}catch(Ee){console.error("Error fetching data for subject:",Ee)}},0)}}let L=ea(()=>e(p)?{yearLevel:e(p).section.grade_level,sectionName:e(p).section.section_name,gradeName:`Grade ${e(p).section.grade_level}`,subject:e(T)?.name||"No Subject",section:`Grade ${e(p).section.grade_level} - ${e(p).section.section_name}`,quarter:e(g),totalStudents:e(p).students?.length||0,adviser:`${e(p).section.adviser_first_name||""} ${e(p).section.adviser_last_name||""}`.trim()||"No Adviser",room:e(p).section.room_name||"No Room"}:t.selectedClass?{yearLevel:t.selectedClass.yearLevel,sectionName:t.selectedClass.sectionName,gradeName:`Grade ${t.selectedClass.yearLevel}`,subject:"Loading...",section:`Grade ${t.selectedClass.yearLevel} - ${t.selectedClass.sectionName}`,quarter:e(g),totalStudents:0}:{yearLevel:7,sectionName:"Section A",gradeName:"Grade 7",subject:"Mathematics",section:"Grade 7 - Section A",quarter:e(g),totalStudents:0}),F=ut(Xs([]));async function j(){try{const Ee=await(await fetch("/api/current-quarter")).json();Ee.success&&Ee.data?(v(h,Ee.data.currentQuarter,!0),v(g,Ee.data.quarterName,!0),v(b,Ee.data.currentSchoolYear||"2025-2026",!0),console.log(`Current quarter set to: ${e(g)} (Quarter ${e(h)})`),console.log(`Current school year set to: ${e(b)}`)):(v(h,1),v(g,"1st Quarter"),v(b,"2025-2026"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter and 2025-2026"))}catch(oe){console.error("Error fetching current quarter:",oe),v(h,1),v(g,"1st Quarter"),v(b,"2025-2026")}}async function P(oe){oe.id!==e(h)?(v(h,oe.id,!0),v(g,oe.name,!0),v(y,!1),await Q(),await $()):v(y,!1)}async function Q(){if(!(!t.selectedClass||!e(T)))try{const oe={id:n().userData.id,name:n().userData.name,account_number:n().userData.accountNumber,account_type:n().userData.account_type||n().userData.accountType},Ee=await fetch(`/api/grades/grade-items?section_id=${t.selectedClass.sectionId}&subject_id=${e(T).id}&grading_period_id=${e(h)}&teacher_id=${n().userData.id}`,{method:"GET",headers:{"Content-Type":"application/json","x-user-info":JSON.stringify(oe)}});if(!Ee.ok)throw new Error(`HTTP error! status: ${Ee.status}`);const we=(await Ee.json()).data||{},Oe={writtenWork:{count:we.writtenWork?.length||0,weight:.3,label:"Written Work",totals:we.writtenWork?.map(lt=>lt.totalScore)||[],columnNames:we.writtenWork?.map(lt=>lt.name)||[],columnPositions:we.writtenWork?.map((lt,Rt)=>Rt+1)||[],gradeItemIds:we.writtenWork?.map(lt=>lt.id)||[]},performanceTasks:{count:we.performanceTasks?.length||0,weight:.5,label:"Performance Tasks",totals:we.performanceTasks?.map(lt=>lt.totalScore)||[],columnNames:we.performanceTasks?.map(lt=>lt.name)||[],columnPositions:we.performanceTasks?.map((lt,Rt)=>Rt+1)||[],gradeItemIds:we.performanceTasks?.map(lt=>lt.id)||[]},quarterlyAssessment:{count:we.quarterlyAssessment?.length||0,weight:.2,label:"Quarterly Assessment",totals:we.quarterlyAssessment?.map(lt=>lt.totalScore)||[],columnNames:we.quarterlyAssessment?.map(lt=>lt.name)||[],columnPositions:we.quarterlyAssessment?.map((lt,Rt)=>Rt+1)||[],gradeItemIds:we.quarterlyAssessment?.map(lt=>lt.id)||[]}};v(R,Oe,!0)}catch(oe){console.error("Error fetching grading configuration:",oe),ie("Failed to load grading configuration","error")}}async function W(){if(!e(d))try{if(v(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");const oe=n(),Ee=oe.isAuthenticated?oe.userData?.id:null,dt=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString()});Ee&&dt.append("teacherId",Ee.toString());const Oe=await(await fetch(`/api/class-students?${dt}`)).json();if(!Oe.success)throw new Error(Oe.error||"Failed to fetch section data");v(p,Oe.data,!0)}catch(oe){console.error("Error fetching section data:",oe),v(c,oe.message,!0)}}async function $(){if(!e(d))try{if(v(l,!0),v(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");if(!e(T)?.id)return;const oe=n(),Ee=oe.isAuthenticated?oe.userData?.id:null,dt=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString(),schoolYear:e(b)});Ee&&dt.append("teacherId",Ee.toString()),e(T)?.id&&dt.append("subjectId",e(T).id.toString()),e(h)&&dt.append("gradingPeriodId",e(h).toString());const Oe=await(await fetch(`/api/class-students?${dt}`)).json();if(!Oe.success)throw new Error(Oe.error||"Failed to fetch class students");v(p,Oe.data,!0),v(F,Oe.data.students.map(lt=>({...lt,writtenWork:lt.grades?.written_work||[],performanceTasks:lt.grades?.performance_tasks||[],quarterlyAssessment:lt.grades?.quarterly_assessment||[],grades:lt.grades,id:lt.account_number||lt.id,name:lt.full_name||`${lt.first_name} ${lt.last_name}`,isVerified:lt.grades?.verified||lt.grades?.verification?.verified||!1})),!0)}catch(oe){console.error("Error fetching class students:",oe),v(c,oe.message,!0),v(p,null),v(F,[],!0)}finally{v(l,!1)}}let R=ut(Xs({writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}})),X=ut(""),se=ut("error"),V=ut(!1);function re(oe){oe.target.closest(".classlist-quarter-dropdown")||v(y,!1)}function me(){return e(F).some(oe=>oe.isVerified||oe.verified)}async function je(oe){if(e(R)[oe].count<10&&!e(f)&&!e(d))try{if(v(f,!0),!{writtenWork:1,performanceTasks:2,quarterlyAssessment:3}[oe]){console.error("Invalid category:",oe);return}if(!n().isAuthenticated||!n().userData?.id){console.error("User not authenticated");return}const we={writtenWork:"WW",performanceTasks:"PT",quarterlyAssessment:"QA"},Oe=e(R)[oe].count,lt=`${we[oe]} ${Oe+1}`,Rt={id:n().userData.id,name:n().userData.name,account_number:n().userData.accountNumber,account_type:n().userData.account_type||n().userData.accountType},Ht=await fetch("/api/grades/grade-items",{method:"POST",headers:{"Content-Type":"application/json","x-user-info":JSON.stringify(Rt)},body:JSON.stringify({action:"create_grade_item",section_id:t.selectedClass?.sectionId||e(p)?.section?.id,subject_id:e(T)?.id||t.selectedClass?.subjectId||e(p)?.subjects?.[0]?.id,grading_period_id:e(h),teacher_id:n().userData.id,category:oe,name:lt,total_score:100})});if(!Ht.ok){const tt=await Ht.json();console.error("Failed to add grade item:",tt.error);return}const rt=await Ht.json();if(e(R)[oe].count+=1,e(R)[oe].gradeItemIds||(e(R)[oe].gradeItemIds=[]),e(R)[oe].gradeItemIds.push(rt.data.id),e(R)[oe].columnNames||(e(R)[oe].columnNames=[]),e(R)[oe].columnNames.push(rt.data.name),!e(R)[oe].columnPositions){e(R)[oe].columnPositions=[];for(let tt=0;tt<e(R)[oe].count-1;tt++)e(R)[oe].columnPositions[tt]=tt+1}const ka=e(R)[oe].columnPositions||[];let Zt=1;for(;ka.includes(Zt);)Zt++;e(R)[oe].columnPositions.push(Zt),de()}catch(Ee){console.error("Error adding column:",Ee)}finally{v(f,!1)}}function de(){v(F,e(F).map(oe=>oe&&{...oe,writtenWork:Array(e(R).writtenWork.count).fill(0).map((dt,we)=>oe.writtenWork?.[we]||0),performanceTasks:Array(e(R).performanceTasks.count).fill(0).map((dt,we)=>oe.performanceTasks?.[we]||0),quarterlyAssessment:Array(e(R).quarterlyAssessment.count).fill(0).map((dt,we)=>oe.quarterlyAssessment?.[we]||0)}),!0)}function ie(oe,Ee="error"){v(V,!1),setTimeout(()=>{v(X,oe,!0),v(se,Ee,!0),v(V,!0)},50)}Ya(async()=>{e(d)||(await j(),await W(),await new Promise(oe=>setTimeout(oe,0)),e(p)?.subjects&&e(p).subjects.length>0?(e(k)>=e(p).subjects.length&&v(k,0),await $(),await Q()):(v(c,"No subjects found for this section"),v(l,!1)))}),ei(()=>{v(d,!0),v(l,!1)});var Pe=T1();ye("click",Zs,re);var Ve=Je(Pe),Ze=o(Ve),ve=o(Ze),Ce=o(ve),Qe=o(Ce);Qe.__click=[m1,t],i(Ce);var Xe=u(Ce,4),ze=o(Xe);i(Xe),i(ve);var We=u(ve,2);{var Te=oe=>{var Ee=g1();xt(Ee,21,()=>e(p).subjects,Ua,(dt,we,Oe)=>{var lt=h1();let Rt;lt.__click=()=>S(Oe);var Ht=u(o(lt));i(lt),q(rt=>{Rt=_e(lt,1,"subject-tab-button",null,Rt,rt),w(Ht,` ${e(we).name??""}`)},[()=>({active:e(k)===Oe})]),m(dt,lt)}),i(Ee),m(oe,Ee)};E(We,oe=>{e(p)?.subjects&&e(p).subjects.length>1&&oe(Te)})}i(Ze);var ue=u(Ze,2),be=o(ue),ke=u(o(be),2),Fe=o(ke);let Re;var et=o(Fe);let $e;et.__click=[p1,y];var ot=o(et);{var Me=oe=>{var Ee=_1(),dt=o(Ee),we=o(dt,!0);i(dt);var Oe=u(dt,2),lt=o(Oe),Rt=o(lt,!0);i(lt),i(Oe),i(Ee),q(()=>{w(we,e(D).icon),w(Rt,e(D).name)}),m(oe,Ee)},it=oe=>{var Ee=b1();m(oe,Ee)};E(ot,oe=>{e(D)?oe(Me):oe(it,!1)})}Bt(2),i(et);var ft=u(et,2);xt(ft,21,()=>C,oe=>oe.id,(oe,Ee)=>{var dt=w1();let we;dt.__click=[y1,P,Ee];var Oe=o(dt),lt=o(Oe,!0);i(Oe);var Rt=u(Oe,2),Ht=o(Rt),rt=o(Ht,!0);i(Ht),i(Rt),i(dt),q(ka=>{we=_e(dt,1,"classlist-quarter-dropdown-option",null,we,ka),w(lt,e(Ee).icon),w(rt,e(Ee).name)},[()=>({selected:e(h)===e(Ee).id})]),m(oe,dt)}),i(ft),i(Fe),i(ke),i(be);var Ye=u(be,2),Y=o(Ye),ce=o(Y),De=o(ce);i(ce);var U=u(ce,2),ne=o(U),fe=o(ne),z=o(fe);{var B=oe=>{var Ee=Sa("Loading...");m(oe,Ee)},I=oe=>{var Ee=Sa();q(()=>w(Ee,`${e(R).writtenWork.count??""} Column${e(R).writtenWork.count!==1?"s":""}`)),m(oe,Ee)};E(z,oe=>{e(l)?oe(B):oe(I,!1)})}i(fe),i(ne);var G=u(ne,2),Z=o(G);Z.__click=[x1,je],i(G),i(U),i(Y);var le=u(Y,2),N=o(le),M=o(N);i(N);var H=u(N,2),pe=o(H),ee=o(pe),Ae=o(ee);{var Ue=oe=>{var Ee=Sa("Loading...");m(oe,Ee)},Le=oe=>{var Ee=Sa();q(()=>w(Ee,`${e(R).performanceTasks.count??""} Column${e(R).performanceTasks.count!==1?"s":""}`)),m(oe,Ee)};E(Ae,oe=>{e(l)?oe(Ue):oe(Le,!1)})}i(ee),i(pe);var He=u(pe,2),Ie=o(He);Ie.__click=[S1,je],i(He),i(H),i(le);var nt=u(le,2),bt=o(nt),pt=o(bt);i(bt);var vt=u(bt,2),Tt=o(vt),Ot=o(Tt),la=o(Ot);{var sa=oe=>{var Ee=Sa("Loading...");m(oe,Ee)},zt=oe=>{var Ee=Sa();q(()=>w(Ee,`${e(R).quarterlyAssessment.count??""} Column${e(R).quarterlyAssessment.count!==1?"s":""}`)),m(oe,Ee)};E(la,oe=>{e(l)?oe(sa):oe(zt,!1)})}i(Ot),i(Tt);var qt=u(Tt,2),Pt=o(qt);Pt.__click=[k1,je],i(qt),i(vt),i(nt),i(Ye);var Yt=u(Ye,2);{var Ut=oe=>{var Ee=A1();m(oe,Ee)},Et=oe=>{var Ee=mt(),dt=Je(Ee);{var we=lt=>{var Rt=D1(),Ht=u(o(Rt),2),rt=o(Ht);i(Ht);var ka=u(Ht,2);ka.__click=$,i(Rt),q(()=>w(rt,`Error: ${e(c)??""}`)),m(lt,Rt)},Oe=lt=>{var Rt=mt(),Ht=Je(Rt);{var rt=Zt=>{var tt=C1();m(Zt,tt)},ka=Zt=>{{let tt=ea(()=>t.selectedClass?.sectionId),wt=ea(()=>e(T)?.id);Ws(f1(Zt,{get sectionId(){return e(tt)},get subjectId(){return e(wt)},get gradingPeriodId(){return e(h)},get students(){return e(F)},set students(ge){v(F,ge,!0)},get gradingConfig(){return e(R)},set gradingConfig(ge){v(R,ge,!0)}}),ge=>v(A,ge,!0),()=>e(A))}};E(Ht,Zt=>{e(F).length===0?Zt(rt):Zt(ka,!1)},!0)}m(lt,Rt)};E(dt,lt=>{e(c)?lt(we):lt(Oe,!1)},!0)}m(oe,Ee)};E(Yt,oe=>{e(l)?oe(Ut):oe(Et,!1)})}i(ue),i(Ve);var ta=u(Ve,2);{var fa=oe=>{su(oe,{get message(){return e(X)},get type(){return e(se)},onClose:()=>v(V,!1)})};E(ta,oe=>{e(V)&&oe(fa)})}q((oe,Ee,dt,we,Oe,lt,Rt,Ht,rt,ka,Zt)=>{w(ze,`${e(L).section??""}  ${e(L).subject??""}  ${e(L).quarter??""}`),Re=_e(Fe,1,"classlist-quarter-dropdown",null,Re,oe),$e=_e(et,1,"classlist-quarter-select-button",null,$e,Ee),w(De,`Written Work (${dt??""}%)`),Z.disabled=we,$t(Z,"title",Oe),w(M,`Performance Tasks (${lt??""}%)`),Ie.disabled=Rt,$t(Ie,"title",Ht),w(pt,`Quarterly Assessment (${rt??""}%)`),Pt.disabled=ka,$t(Pt,"title",Zt)},[()=>({open:e(y)}),()=>({selected:e(h)}),()=>Math.round(e(R).writtenWork.weight*100),()=>e(R).writtenWork.count>=10||e(f)||me(),()=>me()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(R).performanceTasks.weight*100),()=>e(R).performanceTasks.count>=10||e(f)||me(),()=>me()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(R).quarterlyAssessment.weight*100),()=>e(R).quarterlyAssessment.count>=10||e(f)||me(),()=>me()?"Cannot add columns when grades are verified":"Add Column"]),m(s,Pe),za(),r()}Ps(["click"]);async function F1(s,t,a,r,n){const l=e(t).filter(c=>c.finalGrades?.some(d=>d.finalGrade===null||d.finalGrade==="N/A"||d.finalGrade===""));if(l.length>0){const c=l.map(d=>d.full_name).join(", ");Se.error(`Cannot verify all grades - the following students have N/A grades: ${c}`);return}us.confirm("Verify All Students","Are you sure you want to verify all grades for all students in this class?",async()=>{try{const c=await da.post("/api/teacher-advisory",{action:"verify_all_grades",section_id:e(a).section_id,teacher_id:r().userData.id,quarter:e(n),verified:!0});c.success?(v(t,e(t).map(d=>({...d,gradesVerified:!0,finalGrades:d.finalGrades?.map(f=>({...f,verified:!0}))||[],grades:d.grades.map(f=>({...f,verified:!0}))})),!0),Se.success("All student grades verified successfully")):(console.error("Failed to verify all students:",c.error),Se.error(c.error||"Failed to verify all students. Please try again."))}catch(c){console.error("Error verifying all students:",c),Se.error("Failed to verify all students. Please try again.")}},()=>{})}function N1(s,t){v(t,!e(t))}var $1=_('<div class="quarter-selected-option"><span class="material-symbols-outlined quarter-option-icon"> </span> <div class="quarter-option-content"><span class="quarter-option-name"> </span></div></div>'),P1=_('<span class="quarter-placeholder">Select quarter</span>'),L1=(s,t,a)=>t(e(a)),M1=_('<button type="button"><span class="material-symbols-outlined quarter-option-icon"> </span> <div class="quarter-option-content"><span class="quarter-option-name"> </span></div></button>'),I1=_('<span class="stat-suffix"> </span>'),R1=_('<div><div class="stat-card-header"><p class="advisory-stat-label"> </p> <div class="advisory-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="advisory-stat-value"><!> <!></h3></div></div>'),O1=_('<div class="students-loading"><div class="dashboard-loader"></div> <p>Loading students and grades...</p></div>'),j1=_('<div class="students-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),q1=_('<div class="students-empty"><span class="material-symbols-outlined">school</span> <p>No students found in this advisory class</p></div>'),z1=(s,t,a)=>t(e(a)),G1=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},V1=(s,t,a)=>!e(t)?.verified&&a(e(t).id),B1=_('<div class="loading-spinner"></div> <div class="overlay-text">Processing...</div>',1),W1=_('<span class="material-symbols-outlined">verified</span> <div class="overlay-text">Verify</div>',1),H1=_('<small class="submitted-date"> </small>'),U1=_('<small class="submitted-date not-submitted">Grades not submitted yet</small>'),Y1=_('<div class="grade-score-display"> </div>'),Q1=_('<div class="grade-score-display" style="color: #666;">N/A</div>'),K1=_('<button><div class="grade-overlay"><div class="overlay-content"><!></div></div> <div class="grade-item-header"><div class="grade-info"><div class="subject-name"> </div> <div class="subject-teacher"> </div> <!></div> <div class="grade-controls"><!></div></div></button>'),J1=_('<div class="student-grades"><div class="grades-header"><h4 class="grades-title"> </h4> <div class="student-verification-controls"><button class="verify-btn"><span class="material-symbols-outlined">verified</span> Verify All</button></div></div> <div class="grades-grid"></div></div>'),X1=_('<div><button class="student-header"><div class="student-header-content"><div class="student-title-section"><h3 class="student-title"> </h3></div> <div class="student-info-row"><div class="student-info-item"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined">assignment</span> <span> </span></div></div></div> <div class="student-average"><div class="average-score"> </div></div> <div class="expand-icon"><span class="material-symbols-outlined"> </span></div></button> <!></div>'),Z1=_('<div class="advisory-class-container"><div class="advisory-page-header fade-in"><div class="header-content"><h1 class="advisory-page-title">Advisory Class Dashboard</h1> <div class="header-controls"><div class="advisory-class-info"><div class="class-detail"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">meeting_room</span> <span> </span></div></div> <div class="quarter-selector-container"><div><button type="button" id="quarter-select"><!> <span class="material-symbols-outlined quarter-dropdown-arrow">expand_more</span></button> <div class="quarter-dropdown-menu"></div></div></div></div></div></div> <div class="advisory-stats-section"><div class="advisory-stats-grid"></div></div> <div class="students-section"><div class="section-header"><button class="refresh-btn"><span class="material-symbols-outlined">refresh</span> Refresh</button> <div class="bulk-controls"><button class="verify-all-btn"><span class="material-symbols-outlined">verified</span> Verify All Grades</button></div></div> <div class="advisory-students-grid"><!></div></div></div>');function e2(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(gs,"$authStore",a);function l(U){if(!U)return null;const ne=new Date(U),fe=String(ne.getMonth()+1).padStart(2,"0"),z=String(ne.getDate()).padStart(2,"0"),B=ne.getFullYear();return`${fe}-${z}-${B}`}let c=ut(!0),d=ut(null),f=ut(Xs({averageGrade:null})),p=ut(Xs([])),h=ut(Xs(new Set)),g=ut(2),b=ut("2nd Quarter");async function y(){try{v(c,!0),v(d,null);const U=await da.get(`/api/teacher-advisory?teacher_id=${n().userData.id}&quarter=${e(g)}`);U.success?(v(f,{...e(f),...U.data.advisoryData},!0),U.data.students&&v(p,U.data.students.map(ne=>({id:ne.id.toString(),name:ne.name,full_name:ne.name,studentNumber:ne.student_number,gradeLevel:ne.grade_level,gradesVerified:ne.grades_verified,finalGrades:ne.subjects.map(fe=>({id:`${ne.id}_${fe.subject_id}`,subjectName:fe.subject_name,subjectCode:fe.subject_code,teacherName:fe.teacher_name,finalGrade:fe.averages.final_grade,verified:fe.verified,verifiedAt:fe.verified_at,submittedToAdviser:fe.submitted_to_adviser})),grades:ne.subjects.map(fe=>({subject:fe.subject_name,teacher:fe.teacher_name,grade:fe.averages.final_grade,quarter:e(b),verified:fe.verified,submittedDate:fe.submitted_at?l(fe.submitted_at):null,submittedToAdviser:fe.submitted_to_adviser,gradeItems:[]}))})),!0)):v(d,U.error||"Failed to fetch advisory data",!0)}catch(U){console.error("Error fetching advisory data:",U),v(d,"Failed to load advisory data. Please try again.")}finally{v(c,!1)}}async function k(){try{const ne=await(await fetch("/api/current-quarter")).json();ne.success&&ne.data?(v(g,ne.data.currentQuarter,!0),v(b,ne.data.quarterName,!0),console.log(`Current quarter set to: ${e(b)} (Quarter ${e(g)})`)):(v(g,1),v(b,"1st Quarter"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter"))}catch(U){console.error("Error fetching current quarter:",U),v(g,1),v(b,"1st Quarter")}}Ya(async()=>{n().userData?.id&&(await k(),await y())});const A=ea(()=>e(p).map(U=>{if(!U.finalGrades||U.finalGrades.length===0)return{...U,average:0,verifiedGradesCount:0,pendingGradesCount:U.grades?.length||0};const fe=U.finalGrades.reduce((B,I)=>B+(I.finalGrade||0),0)/U.finalGrades.length,z=U.finalGrades?.filter(B=>B.verified)||[];return{...U,average:Math.round(fe*10)/10,verifiedGradesCount:z.length,pendingGradesCount:(U.finalGrades?.length||0)-z.length}}));Es(()=>{if(e(f)&&e(A).length>0){const U=e(A).map(ne=>ne.average).filter(ne=>ne!==null&&ne>0);U.length>0?e(f).averageGrade=Math.round(U.reduce((ne,fe)=>ne+fe,0)/U.length*10)/10:e(f).averageGrade=null}else e(f)&&(e(f).averageGrade=null)});async function T(U){if(!U||e(h).has(U))return;const[ne,fe]=U.split("_"),z=e(p).find(Z=>Z.id===ne),B=z?.finalGrades?.find(Z=>Z.id===U),I=B?.subjectName||"Unknown Subject",G=z?.full_name||"Unknown Student";if(B?.finalGrade===null||B?.finalGrade==="N/A"||B?.finalGrade===""){Se.error(`Cannot verify ${I} grade for ${G} - grade is N/A`);return}us.confirm("Verify Grade",`Are you sure you want to verify the ${I} grade for ${G}?`,async()=>{e(h).add(U),v(h,new Set(e(h)),!0);try{const Z=await da.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:ne,section_id:e(f).section_id,teacher_id:n().userData.id,quarter:e(g),verified:!0});Z.success?(v(p,e(p).map(le=>{const N={...le,finalGrades:le.finalGrades?.map(H=>H.id===U?{...H,verified:!0}:H)||[]},M=N.finalGrades?.every(H=>H.verified)||!1;return N.gradesVerified=M,N}),!0),Se.success(`${I} grade verified for ${G}`),e(h).delete(U),v(h,new Set(e(h)),!0)):(console.error("Failed to verify grade:",Z.error),Se.error(Z.error||"Failed to verify grade. Please try again."),e(h).delete(U),v(h,new Set(e(h)),!0))}catch(Z){console.error("Error verifying grade:",Z),Se.error("Failed to verify grade. Please try again."),e(h).delete(U),v(h,new Set(e(h)),!0)}},()=>{})}async function C(U){const ne=e(p).find(B=>B.id===U),fe=ne?.full_name||"Unknown Student";if(ne?.finalGrades?.some(B=>B.finalGrade===null||B.finalGrade==="N/A"||B.finalGrade==="")){Se.error(`Cannot verify all grades for ${fe} - some grades are N/A`);return}us.confirm("Verify All Grades",`Are you sure you want to verify all grades for ${fe}?`,async()=>{try{const B=await da.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:U,section_id:e(f).section_id,teacher_id:n().userData.id,quarter:e(g),verified:!0});B.success?(v(p,e(p).map(I=>I.id===U?{...I,gradesVerified:!0,finalGrades:I.finalGrades?.map(G=>({...G,verified:!0}))||[]}:I),!0),Se.success(`All grades verified for ${fe}`)):(console.error("Failed to verify student grades:",B.error),Se.error(B.error||"Failed to verify student grades. Please try again."))}catch(B){console.error("Error verifying student grades:",B),Se.error("Failed to verify student grades. Please try again.")}},()=>{})}const D=["border-blue","border-green","border-orange","border-purple"];function S(U){return D[U%D.length]}const L=ea(()=>()=>{const U=e(A).filter(z=>z.average>0);if(U.length===0)return 0;const ne=U.filter(z=>z.average>=75).length;return Math.round(ne/U.length*100)});let F=[{id:"students",label:"Total Students",getValue:()=>e(f)?.totalStudents||0,icon:"people",color:"var(--school-primary)",showAsNumber:!0},{id:"subjects",label:"Subjects Tracked",getValue:()=>e(f)?.subjectsCount||0,icon:"book",color:"var(--school-secondary)",showAsNumber:!0},{id:"average",label:"Class Average",getValue:()=>e(f)&&e(f).averageGrade!==null?e(f).averageGrade:0,icon:"grade",color:"var(--school-accent)",showAsNumber:!0},{id:"passRate",label:"Pass Rate",getValue:()=>e(L)(),icon:"trending_up",color:"var(--success)",showAsNumber:!0,suffix:"%"}],j=ut(null),P=ut(!1);function Q(U){v(j,e(j)?.id===U.id?null:U,!0)}function W(U){return U>=90?"var(--success)":U>=80?"var(--school-accent)":U>=75?"var(--warning)":"var(--error)"}const $=[{id:1,name:"1st Quarter",icon:"looks_one"},{id:2,name:"2nd Quarter",icon:"looks_two"},{id:3,name:"3rd Quarter",icon:"looks_3"},{id:4,name:"4th Quarter",icon:"looks_4"}];async function R(U){U.id!==e(g)?(v(g,U.id,!0),v(b,U.name,!0),v(P,!1),await y()):v(P,!1)}function X(U){U.target.closest(".quarter-dropdown")||v(P,!1)}const se=ea(()=>$.find(U=>U.id===e(g)));var V=Z1();ye("click",Zs,X);var re=o(V),me=o(re),je=u(o(me),2),de=o(je),ie=o(de),Pe=u(o(ie),2),Ve=o(Pe,!0);i(Pe),i(ie);var Ze=u(ie,2),ve=u(o(Ze),2),Ce=o(ve,!0);i(ve),i(Ze),i(de);var Qe=u(de,2),Xe=o(Qe);let ze;var We=o(Xe);let Te;We.__click=[N1,P];var ue=o(We);{var be=U=>{var ne=$1(),fe=o(ne),z=o(fe,!0);i(fe);var B=u(fe,2),I=o(B),G=o(I,!0);i(I),i(B),i(ne),q(()=>{w(z,e(se).icon),w(G,e(se).name)}),m(U,ne)},ke=U=>{var ne=P1();m(U,ne)};E(ue,U=>{e(se)?U(be):U(ke,!1)})}Bt(2),i(We);var Fe=u(We,2);xt(Fe,21,()=>$,U=>U.id,(U,ne)=>{var fe=M1();let z;fe.__click=[L1,R,ne];var B=o(fe),I=o(B,!0);i(B);var G=u(B,2),Z=o(G),le=o(Z,!0);i(Z),i(G),i(fe),q(N=>{z=_e(fe,1,"quarter-dropdown-option",null,z,N),w(I,e(ne).icon),w(le,e(ne).name)},[()=>({selected:e(g)===e(ne).id})]),m(U,fe)}),i(Fe),i(Xe),i(Qe),i(je),i(me),i(re);var Re=u(re,2),et=o(Re);xt(et,23,()=>F,U=>U.id,(U,ne,fe)=>{var z=R1(),B=o(z),I=o(B),G=o(I,!0);i(I);var Z=u(I,2),le=o(Z),N=o(le,!0);i(le),i(Z),i(B);var M=u(B,2),H=o(M),pe=o(H);Is(pe,()=>e(ne).getValue(),Ue=>{{let Le=ea(()=>e(ne).getValue()),He=ea(()=>e(ne).id==="average"?1:0);Qr(Ue,{get value(){return e(Le)},get decimals(){return e(He)},duration:2})}});var ee=u(pe,2);{var Ae=Ue=>{var Le=I1(),He=o(Le,!0);i(Le),q(()=>w(He,e(ne).suffix)),m(Ue,Le)};E(ee,Ue=>{e(ne).suffix&&Ue(Ae)})}i(H),i(M),i(z),q(Ue=>{_e(z,1,`advisory-stat-card ${Ue??""} stagger-item`),Wa(z,`--stagger-index: ${e(fe)??""}`),w(G,e(ne).label),w(N,e(ne).icon)},[()=>S(e(fe))]),m(U,z)}),i(et),i(Re);var $e=u(Re,2),ot=o($e),Me=o(ot);Me.__click=y;var it=u(Me,2),ft=o(it);ft.__click=[F1,p,f,n,g],i(it),i(ot);var Ye=u(ot,2),Y=o(Ye);{var ce=U=>{var ne=O1();m(U,ne)},De=U=>{var ne=mt(),fe=Je(ne);{var z=I=>{var G=j1(),Z=u(o(G),2),le=o(Z);i(Z),i(G),q(()=>w(le,`Error loading students: ${e(d)??""}`)),m(I,G)},B=I=>{var G=mt(),Z=Je(G);{var le=M=>{var H=q1();m(M,H)},N=M=>{var H=mt(),pe=Je(H);xt(pe,19,()=>e(A),ee=>ee.id,(ee,Ae,Ue)=>{var Le=X1();let He;var Ie=o(Le);Ie.__click=[z1,Q,Ae];var nt=o(Ie),bt=o(nt),pt=o(bt),vt=o(pt);i(pt),i(bt);var Tt=u(bt,2),Ot=o(Tt),la=u(o(Ot),2),sa=o(la,!0);i(la),i(Ot);var zt=u(Ot,2),qt=o(zt),Pt=o(qt,!0);i(qt);var Yt=u(qt,2),Ut=o(Yt,!0);i(Yt),i(zt);var Et=u(zt,2),ta=u(o(Et),2),fa=o(ta);i(ta),i(Et),i(Tt),i(nt);var oe=u(nt,2),Ee=o(oe),dt=o(Ee,!0);i(Ee),i(oe);var we=u(oe,2),Oe=o(we),lt=o(Oe,!0);i(Oe),i(we),i(Ie);var Rt=u(Ie,2);{var Ht=rt=>{var ka=J1(),Zt=o(ka),tt=o(Zt),wt=o(tt);i(tt);var ge=u(tt,2),te=o(ge);te.__click=[G1,C,Ae],i(ge),i(Zt);var J=u(Zt,2);xt(J,23,()=>e(Ae).grades,Be=>Be.subject,(Be,Ge,at)=>{const gt=ea(()=>e(Ae).finalGrades?.find(xe=>xe.subjectName===e(Ge).subject));var Gt=K1();let _a;Gt.__click=[V1,gt,T];var ht=o(Gt),Ne=o(ht),ct=o(Ne);{var Ft=xe=>{var Ke=B1();Bt(2),m(xe,Ke)},Mt=xe=>{var Ke=W1();Bt(2),m(xe,Ke)};E(ct,xe=>{e(h).has(e(gt)?.id)?xe(Ft):xe(Mt,!1)})}i(Ne),i(ht);var It=u(ht,2),ra=o(It),ha=o(ra),ca=o(ha,!0);i(ha);var Qt=u(ha,2),va=o(Qt);i(Qt);var pa=u(Qt,2);{var ua=xe=>{var Ke=H1(),Dt=o(Ke);i(Ke),q(()=>w(Dt,`Submitted: ${e(Ge).submittedDate||"N/A"}`)),m(xe,Ke)},ba=xe=>{var Ke=U1();m(xe,Ke)};E(pa,xe=>{e(gt)&&e(gt).submittedToAdviser&&e(gt).finalGrade!==null?xe(ua):xe(ba,!1)})}i(ra);var Ta=u(ra,2),Pa=o(Ta);{var Ea=xe=>{var Ke=Y1(),Dt=o(Ke,!0);i(Ke),q((Wt,Nt)=>{Wa(Ke,`color: ${Wt??""}`),w(Dt,Nt)},[()=>W(e(gt).finalGrade),()=>Math.round(e(gt).finalGrade*10)/10]),m(xe,Ke)},K=xe=>{var Ke=Q1();m(xe,Ke)};E(Pa,xe=>{e(gt)&&e(gt).submittedToAdviser&&e(gt).finalGrade!==null?xe(Ea):xe(K,!1)})}i(Ta),i(It),i(Gt),q((xe,Ke)=>{_a=_e(Gt,1,`grade-item ${e(gt)?.verified?"verified":"unverified"} stagger-grade-item`,null,_a,xe),Gt.disabled=Ke,Wa(Gt,`--stagger-index: ${e(at)??""}`),w(ca,e(Ge).subject),w(va,`by ${e(Ge).teacher??""}`)},[()=>({loading:e(h).has(e(gt)?.id)}),()=>e(h).has(e(gt)?.id)||e(gt)?.verified]),m(Be,Gt)}),i(J),i(ka),q(()=>w(wt,`Subject Grades (${e(b)??""})`)),m(rt,ka)};E(Rt,rt=>{e(j)?.id===e(Ae).id&&rt(Ht)})}i(Le),q((rt,ka)=>{He=_e(Le,1,`advisory-student-card ${e(Ae).gradesVerified?"verified":"pending"} stagger-item`,null,He,rt),Wa(Le,`--stagger-index: ${e(Ue)??""}`),w(vt,`${e(Ae).name??""}  Grade ${e(Ae).gradeLevel||"7"}`),w(sa,e(Ae).studentNumber),w(Pt,e(Ae).gradesVerified?"verified":"pending"),w(Ut,e(Ae).gradesVerified?"Verified":"Pending"),w(fa,`${e(Ae).verifiedGradesCount??""} Verified, ${e(Ae).pendingGradesCount??""} Pending`),Wa(Ee,`color: ${ka??""}`),w(dt,e(Ae).average!==null?e(Ae).average:"N/A"),w(lt,e(j)?.id===e(Ae).id?"expand_less":"expand_more")},[()=>({selected:e(j)?.id===e(Ae).id}),()=>e(Ae).average!==null?W(e(Ae).average):"#666"]),m(ee,Le)}),m(M,H)};E(Z,M=>{e(A).length===0?M(le):M(N,!1)},!0)}m(I,G)};E(fe,I=>{e(d)?I(z):I(B,!1)},!0)}m(U,ne)};E(Y,U=>{e(c)?U(ce):U(De,!1)})}i(Ye),i($e),i(V),q((U,ne)=>{w(Ve,e(f)?.sectionName||"Loading..."),w(Ce,e(f)?.roomName||"Loading..."),ze=_e(Xe,1,"quarter-dropdown",null,ze,U),Te=_e(We,1,"quarter-select-button",null,Te,ne)},[()=>({open:e(P)}),()=>({selected:e(g)})]),m(s,V),za(),r()}Ps(["click"]);function t2(s,t){v(t,!e(t))}function a2(s,t,a){v(t,!e(t)),a()}var s2=_('<img alt="Profile" class="avatar-image"/>'),r2=_('<div class="avatar-placeholder"> </div>'),i2=(s,t,a)=>{t(),a.onNavigateToSettings()},n2=async(s,t,a)=>{t(),await a.onlogout(),jr("Logged out successfully. See you next time!")},o2=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),l2=_('<nav class="admin-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">admin_panel_settings</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function c2(s,t){qa(t,!0);let a=Ma(t,"adminName",3,"Admin User"),r=Ma(t,"firstName",3,"Admin"),n=Ma(t,"gender",3,"male"),l=Ma(t,"accountNumber",3,"ADM-2025-0001"),c=Ma(t,"profileImage",3,null);function d(ve){return ve==="female"?"Ms.":"Mr."}let f=ea(()=>`${d(n())} ${r()}`),p=ut(!0),h=ut(!1);function g(){v(h,!1)}function b(ve){e(h)&&!ve.target.closest(".user-profile-container")&&g()}Ya(()=>{const ve=localStorage.getItem("theme");return v(p,ve!=="light"),y(),document.addEventListener("click",b),()=>{document.removeEventListener("click",b)}});function y(){e(p)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function k(ve){return ve.split(" ").map(Ce=>Ce.charAt(0)).join("").toUpperCase().slice(0,2)}var A=l2(),T=o(A),C=o(T),D=o(C);D.__click=function(...ve){t.onToggleNavRail?.apply(this,ve)};var S=u(D,2),L=u(o(S),2),F=o(L);i(L),i(S),i(C);var j=u(C,2),P=o(j);P.__click=[a2,p,y];var Q=o(P),W=o(Q,!0);i(Q),i(P);var $=u(P,2),R=o($);R.__click=[t2,h];var X=o(R),se=o(X),V=o(se,!0);i(se);var re=u(se,2),me=o(re);i(re),i(X);var je=u(X,2),de=o(je);{var ie=ve=>{var Ce=s2();q(()=>$t(Ce,"src",c())),m(ve,Ce)},Pe=ve=>{var Ce=r2(),Qe=o(Ce,!0);i(Ce),q(Xe=>w(Qe,Xe),[()=>k(r())]),m(ve,Ce)};E(de,ve=>{c()?ve(ie):ve(Pe,!1)})}i(je),i(R);var Ve=u(R,2);{var Ze=ve=>{var Ce=o2(),Qe=o(Ce);Qe.__click=[i2,g,t];var Xe=u(Qe,2);Xe.__click=[n2,g,t],i(Ce),m(ve,Ce)};E(Ve,ve=>{e(h)&&ve(Ze)})}i($),i(j),i(T),i(A),q(()=>{w(F,`Welcome, ${e(f)??""}`),w(W,e(p)?"light_mode":"dark_mode"),w(V,a()),w(me,`Account: ${l()??""}`)}),m(s,A),za()}Ps(["click"]);var d2=(s,t,a)=>t(e(a).id),u2=(s,t,a)=>t(e(a).id),v2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),f2=_('<div class="admin-menu-folder-contents"></div>'),p2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button> <!>',1),m2=(s,t,a)=>t(e(a).id),h2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),g2=(s,t,a)=>t(e(a).id),_2=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),b2=(s,t,a)=>t(e(a).id),y2=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),w2=(s,t)=>t("management-folder"),x2=(s,t)=>s.key==="Enter"||s.key===" "?t("management-folder"):null,S2=s=>s.stopPropagation(),k2=s=>s.stopPropagation(),A2=(s,t)=>t("management-folder"),D2=(s,t,a,r)=>{t(e(a).id),r("management-folder")},C2=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),T2=_('<div class="admin-menu-mobile-folder-overlay" role="button" tabindex="0" aria-label="Close management folder"><div class="admin-menu-mobile-folder-content" role="dialog" aria-label="Management folder menu" tabindex="-1"><div class="admin-menu-mobile-folder-header"><h3>Management</h3> <button class="admin-menu-close-folder"><span class="material-symbols-outlined">close</span></button></div> <div class="admin-menu-mobile-folder-items"></div></div></div>'),E2=_('<nav aria-label="Admin portal navigation"><div class="admin-menu-rail-container"></div></nav> <nav class="admin-menu-bottom-navigation" aria-label="Admin portal navigation"><div class="admin-menu-nav-container"><!> <!></div></nav>',1);function F2(s,t){qa(t,!0);let a=Ma(t,"adminActiveSection",15,"dashboard"),r=Ma(t,"adminNavRailVisible",3,!0),n=ut(!1);const l=[{id:"dashboard",label:"Dashboard",icon:"dashboard",type:"item"},{id:"management-folder",label:"Management",icon:"folder",type:"folder",items:[{id:"schedule-management",label:"Schedule",icon:"schedule"},{id:"department-management",label:"Department",icon:"corporate_fare"},{id:"subjects-and-activities",label:"Subjects & Activities",icon:"school"}]},{id:"account-creation",label:"Account Creation",icon:"person_add",type:"item"},{id:"document-requests",label:"Document Requests",icon:"description",type:"item"},{id:"student-masterlist",label:"Student Masterlist",icon:"groups",type:"item"},{id:"student-grades-list",label:"Student Grades List",icon:"grade",type:"item"},{id:"archived-students",label:"Archived Students",icon:"archive",type:"item"}];function c(D){a(D),t.onnavigate&&t.onnavigate({detail:{section:D}})}function d(D){D==="management-folder"&&v(n,!e(n))}function f(D){return D.items?.some(S=>S.id===a())||!1}var p=E2(),h=Je(p);let g;var b=o(h);xt(b,21,()=>l,D=>D.id,(D,S)=>{var L=mt(),F=Je(L);{var j=Q=>{var W=p2(),$=Je(W);let R;$.__click=[d2,d,S];var X=o($),se=o(X),V=o(se,!0);i(se),i(X);var re=u(X,2),me=o(re,!0);i(re),i($);var je=u($,2);{var de=ie=>{var Pe=f2();xt(Pe,21,()=>e(S).items,Ve=>Ve.id,(Ve,Ze)=>{var ve=v2();let Ce;ve.__click=[u2,c,Ze];var Qe=o(ve),Xe=o(Qe),ze=o(Xe,!0);i(Xe),i(Qe);var We=u(Qe,2),Te=o(We,!0);i(We),i(ve),q(ue=>{Ce=_e(ve,1,"admin-menu-rail-item admin-menu-sub-item",null,Ce,ue),$t(ve,"aria-label",e(Ze).label),$t(ve,"aria-current",e(Ze).id===a()?"page":void 0),w(ze,e(Ze).icon),w(Te,e(Ze).label)},[()=>({active:e(Ze).id===a()})]),m(Ve,ve)}),i(Pe),m(ie,Pe)};E(je,ie=>{e(n)&&ie(de)})}q(ie=>{R=_e($,1,"admin-menu-rail-item admin-menu-folder",null,R,ie),$t($,"aria-label",e(S).label),$t($,"aria-expanded",e(n)),w(V,e(n)?"folder_open":"folder"),w(me,e(S).label)},[()=>({active:f(e(S)),expanded:e(n)})]),m(Q,W)},P=Q=>{var W=h2();let $;W.__click=[m2,c,S];var R=o(W),X=o(R),se=o(X,!0);i(X),i(R);var V=u(R,2),re=o(V,!0);i(V),i(W),q(me=>{$=_e(W,1,"admin-menu-rail-item",null,$,me),$t(W,"aria-label",e(S).label),$t(W,"aria-current",e(S).id===a()?"page":void 0),w(se,e(S).icon),w(re,e(S).label)},[()=>({active:e(S).id===a()})]),m(Q,W)};E(F,Q=>{e(S).type==="folder"?Q(j):Q(P,!1)})}m(D,L)}),i(b),i(h);var y=u(h,2),k=o(y),A=o(k);xt(A,17,()=>l,D=>D.id,(D,S)=>{var L=mt(),F=Je(L);{var j=Q=>{var W=_2();let $;W.__click=[g2,d,S];var R=o(W),X=o(R),se=o(X,!0);i(X),i(R),i(W),q(V=>{$=_e(W,1,"admin-menu-nav-item admin-menu-folder",null,$,V),$t(W,"aria-label",e(S).label),$t(W,"aria-expanded",e(n)),w(se,e(n)?"folder_open":"folder")},[()=>({active:f(e(S))})]),m(Q,W)},P=Q=>{var W=y2();let $;W.__click=[b2,c,S];var R=o(W),X=o(R),se=o(X,!0);i(X),i(R),i(W),q(V=>{$=_e(W,1,"admin-menu-nav-item",null,$,V),$t(W,"aria-label",e(S).label),$t(W,"aria-current",e(S).id===a()?"page":void 0),w(se,e(S).icon)},[()=>({active:e(S).id===a()})]),m(Q,W)};E(F,Q=>{e(S).type==="folder"?Q(j):Q(P,!1)})}m(D,L)});var T=u(A,2);{var C=D=>{var S=T2();S.__click=[w2,d],S.__keydown=[x2,d];var L=o(S);L.__click=[S2],L.__keydown=[k2];var F=o(L),j=u(o(F),2);j.__click=[A2,d],i(F);var P=u(F,2);xt(P,21,()=>l.find(Q=>Q.id==="management-folder")?.items||[],Q=>Q.id,(Q,W)=>{var $=C2();let R;$.__click=[D2,c,W,d];var X=o($),se=o(X,!0);i(X);var V=u(X,2),re=o(V,!0);i(V),i($),q(me=>{R=_e($,1,"admin-menu-mobile-folder-item",null,R,me),w(se,e(W).icon),w(re,e(W).label)},[()=>({active:e(W).id===a()})]),m(Q,$)}),i(P),i(L),i(S),m(D,S)};E(T,D=>{e(n)&&D(C)})}i(k),i(y),q(D=>g=_e(h,1,"admin-menu-navigation-rail",null,g,D),[()=>({collapsed:!r()})]),m(s,p),za()}Ps(["click","keydown"]);function N2(){const{subscribe:s,set:t,update:a}=Hs({data:[{id:"students",label:"Total Students",value:0,icon:"school",color:"blue"},{id:"teachers",label:"Total Teachers",value:0,icon:"person",color:"green"},{id:"sections",label:"Total Sections",value:0,icon:"class",color:"orange"},{id:"rooms",label:"Total Rooms",value:0,icon:"meeting_room",color:"purple"}],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1,charts:{studentsPerGrade:{data:null,isLoading:!1,error:null,lastUpdated:null},sectionsPerGrade:{data:null,isLoading:!1,error:null,lastUpdated:null}}});return{subscribe:s,init:r=>{r&&a(n=>({...n,data:r,isInitialized:!0,isLoading:!1}))},setLoading:r=>{a(n=>({...n,isLoading:r&&!n.isInitialized}))},updateData:r=>{a(n=>({...n,data:r,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0}));try{localStorage.setItem("dashboard-stats-cache",JSON.stringify({data:r,timestamp:Date.now()}))}catch(n){console.warn("Failed to cache dashboard data:",n)}},setError:r=>{a(n=>({...n,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem("dashboard-stats-cache");if(r){const{data:n,timestamp:l}=JSON.parse(r);if(Date.now()-l<300*1e3)return n}}catch(r){console.warn("Failed to retrieve cached dashboard data:",r)}return null},clearCache:()=>{try{localStorage.removeItem("dashboard-stats-cache"),localStorage.removeItem("dashboard-charts-cache")}catch(r){console.warn("Failed to clear dashboard cache:",r)}},initChartData:(r,n)=>{n&&a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],data:n,isLoading:!1}}}))},setChartLoading:(r,n)=>{a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],isLoading:n}}}))},updateChartData:(r,n)=>{a(l=>({...l,charts:{...l.charts,[r]:{data:n,isLoading:!1,error:null,lastUpdated:new Date}}}));try{const l=`dashboard-chart-${r}-cache`;localStorage.setItem(l,JSON.stringify({data:n,timestamp:Date.now()}))}catch(l){console.warn(`Failed to cache ${r} data:`,l)}},setChartError:(r,n)=>{a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],error:n,isLoading:!1}}}))},getCachedChartData:r=>{try{const n=`dashboard-chart-${r}-cache`,l=localStorage.getItem(n);if(l){const{data:c,timestamp:d}=JSON.parse(l);if(Date.now()-d<300*1e3)return c}}catch(n){console.warn(`Failed to retrieve cached ${r} data:`,n)}return null}}}const Ms=N2();var $2=(s,t)=>t("students"),P2=(s,t)=>t("teachers"),L2=_('<div class="chart-loading svelte-y4xb3t"><div class="chart-loader svelte-y4xb3t"></div> <p class="svelte-y4xb3t">Loading chart data...</p></div>'),M2=_('<div class="chart-error svelte-y4xb3t"><span class="material-symbols-outlined svelte-y4xb3t">error</span> <p class="svelte-y4xb3t"> </p></div>'),I2=_('<div class="legend-item svelte-y4xb3t"><div class="legend-circle svelte-y4xb3t"></div> <span class="legend-text svelte-y4xb3t"> </span></div>'),R2=_('<canvas class="svelte-y4xb3t"></canvas> <div class="graph-label svelte-y4xb3t"></div>',1),O2=_('<div class="chart-container svelte-y4xb3t"><div class="chart-header svelte-y4xb3t"><h3 class="chart-title svelte-y4xb3t"> </h3> <div class="toggle-buttons svelte-y4xb3t"><button><span class="material-symbols-outlined svelte-y4xb3t">school</span> Students</button> <button><span class="material-symbols-outlined svelte-y4xb3t">person</span> Teachers</button></div></div> <!></div>');function j2(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(Ms,"$dashboardStore",a);cr.register(Ip,Xm,Yi,Hi,Ui);let l=ut(void 0),c,d=ut("students"),f=ut(Xs([])),p=ut(!1),h=ut(null),g=ea(()=>n().charts.studentsPerGrade),b=ea(()=>e(g).isLoading),y=ea(()=>e(g).error),k=ea(()=>e(g).data);const A=["7","8","9","10"],T=["rgb(0, 114, 178)","rgb(230, 159, 0)","rgb(86, 180, 233)","rgb(102, 102, 102)"],C=["rgb(244, 67, 54)","rgb(33, 150, 243)","rgb(76, 175, 80)","rgb(255, 152, 0)","rgb(156, 39, 176)","rgb(0, 188, 212)","rgb(255, 235, 59)","rgb(121, 85, 72)"];async function D(){try{v(p,!0),v(h,null);const ve=await da.get("/api/departments?action=departments");if(ve.success)v(f,ve.data.filter(Ce=>Ce.teacher_count>0),!0);else throw new Error(ve.error||"Failed to fetch teachers data")}catch(ve){console.error("Error fetching teachers data:",ve),v(h,ve.message,!0)}finally{v(p,!1)}}Es(()=>{e(l)&&(e(d)==="students"&&e(k)&&!e(b)?setTimeout(()=>{S(e(k))},0):e(d)==="teachers"&&e(f).length>0&&!e(p)&&setTimeout(()=>{L(e(f))},0))});function S(ve){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const Ce=A.map(Xe=>{const ze=ve.find(We=>We.grade_level===Xe);return ze?ze.count:0}),Qe=e(l).getContext("2d");c=new cr(Qe,{type:"doughnut",data:{labels:A.map(Xe=>`Grade ${Xe}`),datasets:[{label:"Students",data:Ce,backgroundColor:T,borderWidth:5,borderRadius:2,borderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim(),hoverBorderWidth:1,hoverBorderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim()}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label(Xe){const ze=Xe.label||"",We=Xe.parsed||0,Te=Xe.dataset.data.reduce((be,ke)=>be+ke,0),ue=Te>0?(We/Te*100).toFixed(1):0;return`${ze}: ${We} students (${ue}%)`}}}}},plugins:[{id:"centerText",beforeDraw(Xe){const{ctx:ze,chartArea:{width:We,height:Te}}=Xe,be=Xe.data.datasets[0].data.reduce((Me,it)=>Me+it,0),ke=getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),Fe=32,Re=14,et=5;ze.save(),ze.textAlign="center",ze.textBaseline="middle",ze.fillStyle=ke;const $e=We/2,ot=Te/2;ze.font=`bold ${Fe}px sans-serif`,ze.fillText(be,$e,ot-Re/1.5+et),ze.font=`400 ${Re}px sans-serif`,ze.fillText("Total Students",$e,ot+Fe/1.8+et),ze.restore()}}]})}function L(ve){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const Ce=ve.map(We=>We.name.replace(" Department","")),Qe=ve.map(We=>We.teacher_count),Xe=ve.map((We,Te)=>C[Te%C.length]),ze=e(l).getContext("2d");c=new cr(ze,{type:"doughnut",data:{labels:Ce,datasets:[{label:"Teachers",data:Qe,backgroundColor:Xe,borderWidth:5,borderRadius:2,borderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim(),hoverBorderWidth:1,hoverBorderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim()}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label(We){const Te=We.label||"",ue=We.parsed||0,be=We.dataset.data.reduce((Fe,Re)=>Fe+Re,0),ke=be>0?(ue/be*100).toFixed(1):0;return`${Te}: ${ue} teachers (${ke}%)`}}}}},plugins:[{id:"centerText",beforeDraw(We){const{ctx:Te,chartArea:{width:ue,height:be}}=We,Fe=We.data.datasets[0].data.reduce((ft,Ye)=>ft+Ye,0),Re=getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),et=32,$e=14,ot=5;Te.save(),Te.textAlign="center",Te.textBaseline="middle",Te.fillStyle=Re;const Me=ue/2,it=be/2;Te.font=`bold ${et}px sans-serif`,Te.fillText(Fe,Me,it-$e/1.5+ot),Te.font=`400 ${$e}px sans-serif`,Te.fillText("Total Teachers",Me,it+et/1.8+ot),Te.restore()}}]})}function F(ve){v(d,ve,!0),ve==="teachers"&&e(f).length===0&&!e(p)&&D()}function j(){c&&(e(d)==="students"&&e(k)?S(e(k)):e(d)==="teachers"&&e(f).length>0&&L(e(f)))}Ya(()=>{const ve=new MutationObserver(Ce=>{Ce.forEach(Qe=>{Qe.type==="attributes"&&Qe.attributeName==="data-theme"&&j()})});return ve.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{ve.disconnect()}}),ei(()=>{c&&c.destroy()});let P=ea(()=>e(d)==="students"?e(b):e(p)),Q=ea(()=>e(d)==="students"?e(y):e(h)),W=ea(()=>e(d)==="students"?"Students per Grade Level":"Teachers per Department"),$=ea(()=>e(d)==="students"?A.map((ve,Ce)=>({label:`Grade ${ve}`,color:T[Ce]})):e(f).map((ve,Ce)=>({label:ve.name.replace(" Department",""),color:C[Ce%C.length]})));var R=O2(),X=o(R),se=o(X),V=o(se,!0);i(se);var re=u(se,2),me=o(re);let je;me.__click=[$2,F];var de=u(me,2);let ie;de.__click=[P2,F],i(re),i(X);var Pe=u(X,2);{var Ve=ve=>{var Ce=L2();m(ve,Ce)},Ze=ve=>{var Ce=mt(),Qe=Je(Ce);{var Xe=We=>{var Te=M2(),ue=u(o(Te),2),be=o(ue,!0);i(ue),i(Te),q(()=>w(be,e(Q))),m(We,Te)},ze=We=>{var Te=R2(),ue=Je(Te);Ws(ue,ke=>v(l,ke),()=>e(l));var be=u(ue,2);xt(be,21,()=>e($),Ua,(ke,Fe)=>{var Re=I2(),et=o(Re),$e=u(et,2),ot=o($e,!0);i($e),i(Re),q(()=>{Wa(et,`background-color: ${e(Fe).color??""};`),w(ot,e(Fe).label)}),m(ke,Re)}),i(be),m(We,Te)};E(Qe,We=>{e(Q)?We(Xe):We(ze,!1)},!0)}m(ve,Ce)};E(Pe,ve=>{e(P)?ve(Ve):ve(Ze,!1)})}i(R),q((ve,Ce)=>{w(V,e(W)),je=_e(me,1,"toggle-btn svelte-y4xb3t",null,je,ve),ie=_e(de,1,"toggle-btn svelte-y4xb3t",null,ie,Ce)},[()=>({active:e(d)==="students"}),()=>({active:e(d)==="teachers"})]),m(s,R),za(),r()}Ps(["click"]);var q2=_('<div class="chart-loading svelte-1bi57z4"><div class="chart-loader svelte-1bi57z4"></div> <p class="svelte-1bi57z4">Loading chart data...</p></div>'),z2=_('<div class="chart-error svelte-1bi57z4"><span class="material-symbols-outlined svelte-1bi57z4">error</span> <p class="svelte-1bi57z4"> </p></div>'),G2=_('<canvas class="svelte-1bi57z4"></canvas>'),V2=_('<div class="chart-container svelte-1bi57z4"><!></div>');function B2(s,t){qa(t,!0);const[a,r]=ks(),n=()=>Ja(Ms,"$dashboardStore",a);cr.register(Mn,Rn,On,jn,Yi,Hi,Ui);let l=ut(void 0),c,d=ea(()=>n().charts.sectionsPerGrade),f=ea(()=>e(d).isLoading),p=ea(()=>e(d).error),h=ea(()=>e(d).data);const g=["7","8","9","10"];Es(()=>{e(h)&&!e(f)&&e(l)&&setTimeout(()=>{b(e(h))},0)});function b(D){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const S=g.map(F=>{const j=D.find(P=>P.grade_level===F);return j?j.section_count:0}),L=e(l).getContext("2d");c=new cr(L,{type:"bar",data:{labels:g.map(F=>`Grade ${F}`),datasets:[{label:"Number of Sections",data:S,backgroundColor:["rgba(54, 162, 235, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgb(54, 162, 235)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)"],borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,suggestedMax:Math.max(...S)+2,ticks:{stepSize:1,callback(F){return Math.floor(F)},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim()},title:{display:!0,text:"Number of Sections",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:12,weight:"bold"}}},x:{ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,text:"Sections per Grade Level",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(F){return`Sections: ${F.parsed.y||0}`}}}}}})}function y(){c&&e(h)&&b(e(h))}Ya(()=>{const D=new MutationObserver(S=>{S.forEach(L=>{L.type==="attributes"&&L.attributeName==="data-theme"&&y()})});return D.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{D.disconnect()}}),ei(()=>{c&&c.destroy()});var k=V2(),A=o(k);{var T=D=>{var S=q2();m(D,S)},C=D=>{var S=mt(),L=Je(S);{var F=P=>{var Q=z2(),W=u(o(Q),2),$=o(W,!0);i(W),i(Q),q(()=>w($,e(p))),m(P,Q)},j=P=>{var Q=G2();Ws(Q,W=>v(l,W),()=>e(l)),m(P,Q)};E(L,P=>{e(p)?P(F):P(j,!1)},!0)}m(D,S)};E(A,D=>{e(f)?D(T):D(C,!1)})}i(k),m(s,k),za(),r()}var W2=_('<div class="stats-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),H2=_('<div><div class="stat-card-header"><p class="stat-label"> </p> <div class="dashboard-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="stat-card-value"><!></h3></div></div>'),U2=_('<div class="stats-grid"></div>'),Y2=_('<div class="activities-loading"><div class="system-loader"></div> <p>Loading recent activities...</p></div>'),Q2=_('<div class="activities-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),K2=_('<div class="activities-empty"><span class="material-symbols-outlined">inbox</span> <p>No recent activities found</p></div>'),J2=_('<p class="activity-user"> </p>'),X2=_('<div class="activity-item"><div class="activity-icon"><span class="material-symbols-outlined"> </span></div> <div class="activity-content"><p class="activity-message"> </p> <!></div> <span class="activity-timestamp"> </span></div>'),Z2=_('<div class="dashboard-container"><div class="dashboard-header"><div class="header-content"><h1 class="page-title">Admin Dashboard</h1> <p class="page-subtitle">Overview of school management system statistics</p></div></div> <div class="stats-section"><!></div> <div class="graph-row"><div class="accounts-stats-container"><!></div> <div class="average-grades-stats-container"><!></div></div> <div class="activities-section"><div class="section-header"><h2 class="section-title">Activity Logs</h2> <button class="refresh-button" title="Refresh activity logs"><span class="material-symbols-outlined">refresh</span> Refresh</button></div> <div class="activities-list"><!></div></div></div>');function e0(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(Ms,"$dashboardStore",a),l=O(),c=O(),d=O();let f=O([]),p=O(!1),h=O(null);const g=["border-blue","border-green","border-orange","border-purple"];function b(de){return g[de%g.length]}async function y(de=!1){try{de||Ms.setLoading(!0);const ie=await da.get("/api/dashboard");if(ie.success){const Pe=[{id:"students",label:"Total Students",value:ie.data.students.toLocaleString(),icon:"school",color:"primary"},{id:"teachers",label:"Total Teachers",value:ie.data.teachers.toLocaleString(),icon:"person",color:"primary"},{id:"sections",label:"Total Sections",value:ie.data.sections.toLocaleString(),icon:"class",color:"primary"},{id:"rooms",label:"Total Rooms",value:ie.data.rooms.toLocaleString(),icon:"meeting_room",color:"primary"}];Ms.updateData(Pe)}else throw new Error(ie.error||"Failed to fetch dashboard statistics")}catch(ie){console.error("Error fetching dashboard statistics:",ie),Ms.setError(ie.message)}}async function k(de=!1){try{de||Ms.setChartLoading("studentsPerGrade",!0);const ie=await da.get("/api/dashboard/students-per-grade");if(ie.success)Ms.updateChartData("studentsPerGrade",ie.data);else throw new Error(ie.error||"Failed to fetch students per grade data")}catch(ie){console.error("Error fetching students per grade:",ie),Ms.setChartError("studentsPerGrade",ie.message)}}async function A(de=!1){try{de||Ms.setChartLoading("sectionsPerGrade",!0);const ie=await da.get("/api/dashboard/sections-per-grade");if(ie.success)Ms.updateChartData("sectionsPerGrade",ie.data);else throw new Error(ie.error||"Failed to fetch sections per grade data")}catch(ie){console.error("Error fetching sections per grade:",ie),Ms.setChartError("sectionsPerGrade",ie.message)}}async function T(de=!1){try{de||(v(p,!0),v(h,null));const ie=await da.get("/api/activity-logs");if(ie.success)v(f,ie.activities);else throw new Error(ie.error||"Failed to fetch activities")}catch(ie){console.error("Error fetching activities:",ie),v(h,ie.message)}finally{v(p,!1)}}Ya(()=>{const de=Ms.getCachedData();de&&Ms.init(de);const ie=Ms.getCachedChartData("studentsPerGrade");ie&&Ms.initChartData("studentsPerGrade",ie);const Pe=Ms.getCachedChartData("sectionsPerGrade");Pe&&Ms.initChartData("sectionsPerGrade",Pe),y(!!de),k(!!ie),A(!!Pe),T(!1);const Ve=setInterval(()=>{y(!0),k(!0),A(!0),T(!0)},3e4);return()=>{clearInterval(Ve)}}),_t(()=>(e(l),e(c),e(d),n()),()=>{(de=>{v(l,de.data),v(c,de.isLoading),v(d,de.error)})(n())}),Rs(),Ls();var C=Z2(),D=u(o(C),2),S=o(D);{var L=de=>{var ie=W2(),Pe=u(o(ie),2),Ve=o(Pe);i(Pe);var Ze=u(Pe,2);i(ie),q(()=>w(Ve,`Error loading statistics: ${e(d)??""}`)),ye("click",Ze,()=>y(!1)),m(de,ie)},F=de=>{var ie=U2();xt(ie,7,()=>e(l),Pe=>Pe.id,(Pe,Ve,Ze)=>{var ve=H2(),Ce=o(ve),Qe=o(Ce),Xe=o(Qe,!0);i(Qe);var ze=u(Qe,2),We=o(ze),Te=o(We,!0);i(We),i(ze),i(Ce);var ue=u(Ce,2),be=o(ue),ke=o(be);{var Fe=et=>{var $e=Sa("Loading...");m(et,$e)},Re=et=>{var $e=Sa();q(()=>w($e,(e(Ve),x(()=>e(Ve).value)))),m(et,$e)};E(ke,et=>{e(c)?et(Fe):et(Re,!1)})}i(be),i(ue),i(ve),q(et=>{_e(ve,1,`stat-card ${et??""}`),w(Xe,(e(Ve),x(()=>e(Ve).label))),w(Te,(e(Ve),x(()=>e(Ve).icon)))},[()=>(xs(e(Ze)),x(()=>b(e(Ze))))]),m(Pe,ve)}),i(ie),m(de,ie)};E(S,de=>{e(d)?de(L):de(F,!1)})}i(D);var j=u(D,2),P=o(j),Q=o(P);j2(Q,{}),i(P);var W=u(P,2),$=o(W);B2($,{}),i(W),i(j);var R=u(j,2),X=o(R),se=u(o(X),2);i(X);var V=u(X,2),re=o(V);{var me=de=>{var ie=Y2();m(de,ie)},je=de=>{var ie=mt(),Pe=Je(ie);{var Ve=ve=>{var Ce=Q2(),Qe=u(o(Ce),2),Xe=o(Qe);i(Qe),i(Ce),q(()=>w(Xe,`Error loading activities: ${e(h)??""}`)),m(ve,Ce)},Ze=ve=>{var Ce=mt(),Qe=Je(Ce);{var Xe=We=>{var Te=K2();m(We,Te)},ze=We=>{var Te=mt(),ue=Je(Te);xt(ue,1,()=>e(f),be=>be.id,(be,ke)=>{var Fe=X2(),Re=o(Fe),et=o(Re),$e=o(et,!0);i(et),i(Re);var ot=u(Re,2),Me=o(ot),it=o(Me,!0);i(Me);var ft=u(Me,2);{var Ye=De=>{var U=J2(),ne=o(U,!0);i(U),q(()=>w(ne,(e(ke),x(()=>e(ke).performed_by)))),m(De,U)};E(ft,De=>{e(ke),x(()=>e(ke).performed_by&&e(ke).performed_by!=="System")&&De(Ye)})}i(ot);var Y=u(ot,2),ce=o(Y,!0);i(Y),i(Fe),q(()=>{w($e,(e(ke),x(()=>e(ke).icon))),w(it,(e(ke),x(()=>e(ke).message))),w(ce,(e(ke),x(()=>e(ke).timestamp)))}),m(be,Fe)}),m(We,Te)};E(Qe,We=>{e(f),x(()=>e(f).length===0)?We(Xe):We(ze,!1)},!0)}m(ve,Ce)};E(Pe,ve=>{e(h)?ve(Ve):ve(Ze,!1)},!0)}m(de,ie)};E(re,de=>{e(p)?de(me):de(je,!1)})}i(V),i(R),i(C),q(()=>se.disabled=e(p)),ye("click",se,()=>T(!1)),m(s,C),za(),r()}var t0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),a0=_('<span class="placeholder">Select account type</span>'),s0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),r0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),i0=_('<span class="placeholder">Select gender</span>'),n0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),o0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),l0=_('<span class="placeholder">Select grade level</span>'),c0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),d0=_('<div class="form-group"><label class="form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div>'),u0=_('<span class="email-status checking"><span class="material-symbols-outlined spinning">progress_activity</span></span>'),v0=_('<span class="email-status valid"><span class="material-symbols-outlined">check_circle</span></span>'),f0=_('<span class="email-status error"><span class="material-symbols-outlined">error</span></span>'),p0=_('<p class="form-error"> </p>'),m0=_('<p class="form-success">Email is available</p>'),h0=_('<div class="form-group"><label class="form-label" for="email">Email Address *</label> <div class="email-input-wrapper"><input type="email" id="email" placeholder="Enter email address" required/> <!></div> <!></div>'),g0=_(`<div class="additional-info-section"><h3 class="section-subtitle">Additional Information</h3> <p class="section-description">Required information for student accounts</p> <div class="form-row"><div class="form-group"><label class="form-label" for="birthdate">Birthdate *</label> <input type="date" id="birthdate" class="form-input" required/></div> <div class="form-group"><label class="form-label" for="age">Age</label> <input type="number" id="age" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label" for="address">Address *</label> <textarea id="address" class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label" for="guardian">Guardian/Parent Name *</label> <input type="text" id="guardian" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label" for="contact-number">Guardian's Contact Number *</label> <input type="tel" id="contact-number" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`),_0=_('<span class="auto-label">Loading preview...</span>'),b0=_('<span class="auto-number"> </span> <span class="auto-label">(Preview - will use lowest available)</span>',1),y0=_('<span class="auto-label">Will be auto-assigned (lowest available number)</span>'),w0=_('<span class="placeholder-number">Select account type first</span>'),x0=_('<span class="material-symbols-outlined">person_add</span> Create Account',1),S0=_('<button type="button" class="account-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),k0=_('<div class="account-filter-selected-option"><span class="material-symbols-outlined account-filter-option-icon"> </span> <div class="account-filter-option-content"><span class="account-filter-option-name"> </span></div></div>'),A0=_('<span class="account-filter-placeholder">Filter by type</span>'),D0=_('<button type="button"><span class="material-symbols-outlined account-filter-option-icon"> </span> <div class="account-filter-option-content"><span class="account-filter-option-name"> </span></div></button>'),C0=_('<div class="loading-container"><span class="account-loader"></span> <p class="loading-text">Loading accounts...</p></div>'),T0=_("<p>No accounts created yet.</p>"),E0=_("<p>No accounts found matching your search or filter.</p>"),F0=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon">group_off</span> <!></div>'),N0=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),$0=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),P0=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),L0=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),M0=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),I0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),R0=_('<span class="placeholder">Select grade level</span>'),O0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),j0=_(`<div class="form-group"><label class="form-label">Grade Level</label> <div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="additional-info-section"><h4 class="section-subtitle">Additional Information</h4> <p class="section-description">Update student additional information</p> <div class="form-row"><div class="form-group"><label class="form-label">Birthdate *</label> <input type="date" class="form-input" required/></div> <div class="form-group"><label class="form-label">Age</label> <input type="number" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label">Address *</label> <textarea class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label">Guardian/Parent Name *</label> <input type="text" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label">Guardian's Contact Number *</label> <input type="tel" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`,1),q0=_('<div class="edit-form-section"><div class="edit-form-container"><div class="edit-form-header"><h4 class="edit-form-title">Edit Account Information</h4> <p class="edit-form-subtitle">Update the name information for this account</p></div> <form class="edit-form-content"><div class="edit-name-fields-row"><div class="form-group"><label class="form-label">Last Name *</label> <input type="text" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label">First Name *</label> <input type="text" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label">M.I.</label> <input type="text" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <div class="edit-form-actions"><a><button type="button" class="account-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),z0=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"> </h3></div> <div class="account-action-buttons"><a><button type="button" class="account-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="account-remove-button" title="Remove Account"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="account-details"><div class="account-detail-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <!> <!> <!> <!> <!> <div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),G0=_(`<div class="account-creation-container"><div class="account-header"><div class="header-content"><h1 class="page-title">Account Creation</h1> <p class="page-subtitle">Create new student, teacher, and admin accounts for the system</p></div></div> <div class="creation-form-section"><div class="account-section-header"><h2 class="section-title">Create New Account</h2> <p class="section-subtitle">Fill in the details below to create a new account</p></div> <div class="form-container"><form><div class="account-type-gender-row"><div class="form-group"><label class="form-label" for="account-type">Account Type *</label> <div><button type="button" id="account-type"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="form-group"><label class="form-label" for="gender">Gender *</label> <div><button type="button" id="gender"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div> <div class="name-fields-row"><div class="form-group"><label class="form-label" for="last-name">Last Name *</label> <input type="text" id="last-name" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label" for="first-name">First Name *</label> <input type="text" id="first-name" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label" for="middle-initial">M.I.</label> <input type="text" id="middle-initial" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <!> <div class="form-group"><div class="form-label"> </div> <div class="number-display"><!></div> <p class="form-help">Account number will be automatically assigned using the lowest available number.
						Password will be set to the same as the account number.</p></div> <div class="form-actions"><button type="submit"><!></button></div></form></div></div> <div class="recent-accounts-section"><div class="account-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="section-title">All Account Creations</h2> <p class="account-creation-section-subtitle">All accounts in the system</p></div> <div class="account-search-filter-container"><div class="account-search-container"><div class="account-search-input-wrapper"><span class="material-symbols-outlined account-search-icon">search</span> <input type="text" placeholder="Search by name, account number, or account type..." class="account-search-input"/> <!></div></div> <div class="account-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined account-filter-dropdown-arrow">expand_more</span></button> <div class="account-filter-dropdown-menu"></div></div></div></div></div></div> <div class="accounts-grid"><!></div></div></div>`);function V0(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(gs,"$authStore",a),l=O(),c=O(),d=O(),f=O(),p=O(),h=O(),g=O();let b=O(!1),y=O(""),k=O(""),A=O(""),T=O(""),C=O(""),D=O(""),S=O(""),L=O(""),F=O(!1),j=null;const P=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;let Q=O(""),W=O(""),$=O(""),R=O(""),X=O(0),se=O(!1),V=O(!1),re=O(!1),me=O(null),je=O(""),de=O(""),ie=O(""),Pe=O(""),Ve=O(!1),Ze=O(!1),ve=O(""),Ce=O(""),Qe=O(""),Xe=O(""),ze=O(0);function We(){const ae=new Date;return ae.setDate(ae.getDate()-1),ae.toISOString().split("T")[0]}function Te(ae){return ae&&ae.split(" ").map(he=>he.charAt(0).toUpperCase()+he.slice(1).toLowerCase()).join(" ")}function ue(ae,he,st=!1){const At=ae.target.value,kt=he==="middleInitial"?At.toUpperCase():Te(At);st?he==="firstName"?v(je,kt):he==="lastName"?v(de,kt):he==="middleInitial"&&v(ie,kt):he==="firstName"?v(T,kt):he==="lastName"?v(C,kt):he==="middleInitial"&&v(D,kt),ae.target.value=kt}function be(ae){if(!ae)return!1;const he=ae.replace(/\D/g,"");return he.startsWith("09")&&he.length===11}function ke(ae){return ae.replace(/\D/g,"").slice(0,11)}function Fe(ae,he=!1){const st=ke(ae.target.value);he?v(Xe,st):v(R,st),ae.target.value=st}async function Re(ae){if(v(L,""),!(!ae||ae.trim()==="")){if(!P.test(ae)){v(L,"Invalid email format");return}v(F,!0);try{const he=await da.get(`/api/accounts/check-email?email=${encodeURIComponent(ae)}`);he.valid?he.exists?v(L,"This email is already registered"):v(L,""):v(L,he.error||"Invalid email format")}catch(he){console.error("Error checking email:",he)}finally{v(F,!1)}}}function et(ae){const he=ae.target.value.trim().toLowerCase();v(S,he),j&&clearTimeout(j),he?j=setTimeout(()=>{Re(he)},500):v(L,"")}function $e(ae){if(!ae||ae.length<10)return!0;const he=new Date(ae),st=he.getFullYear(),At=new Date,kt=At.getFullYear();if(isNaN(he.getTime())||st<1900||st>kt)return!1;const Ct=new Date(At.getFullYear(),At.getMonth(),At.getDate());return!(new Date(he.getFullYear(),he.getMonth(),he.getDate())>=Ct)}const ot=[{id:"student",name:"Student Account",description:"Create a new student account",icon:"school"},{id:"teacher",name:"Teacher Account",description:"Create a new teacher account",icon:"person"},{id:"admin",name:"Admin Account",description:"Create a new admin account",icon:"admin_panel_settings"}],Me=[{id:"male",name:"Male",icon:"male"},{id:"female",name:"Female",icon:"female"}],it=[{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let ft=O([]),Ye=O(!1),Y=O(""),ce=O("all"),De=O(!1);const U=[{id:"all",name:"All Accounts",icon:"group"},{id:"student",name:"Student Accounts",icon:"school"},{id:"teacher",name:"Teacher Accounts",icon:"person"},{id:"admin",name:"Admin Accounts",icon:"admin_panel_settings"}];function ne(ae){!ae.target.closest(".custom-dropdown")&&!ae.target.closest(".account-filter-dropdown")&&(v(se,!1),v(V,!1),v(re,!1),v(Ve,!1),v(De,!1))}async function fe(ae){const he=n().userData;if(he&&he.accountNumber===ae.number){Se.error("You cannot delete your own account while logged in.");return}us.confirm("Remove Account",`<p>Are you sure you want to remove the account for <strong>"${ae.name}"</strong>?</p>`,async()=>{try{const st=await da.delete("/api/accounts",{id:ae.id});if(!st.success)throw new Error(st.message||"Failed to delete account");v(ft,e(ft).filter(At=>At.id!==ae.id)),Se.success(`Account for "${ae.name}" has been removed successfully`)}catch(st){console.error("Error deleting account:",st),Se.error(`Failed to delete account: ${st.message}`)}},()=>{},{size:"small"})}function z(ae){if(e(me)===ae.id)v(me,null),v(je,""),v(de,""),v(ie,""),v(Pe,""),v(ve,""),v(Ce,""),v(Qe,""),v(Xe,""),v(ze,0),v(Ve,!1);else if(v(me,ae.id),ae.firstName&&ae.lastName){if(v(je,ae.firstName),v(de,ae.lastName),v(ie,ae.middleInitial||""),v(Pe,ae.gradeLevel||""),ae.birthdate){const he=new Date(ae.birthdate),st=he.getFullYear(),At=String(he.getMonth()+1).padStart(2,"0"),kt=String(he.getDate()).padStart(2,"0");v(ve,`${st}-${At}-${kt}`)}else v(ve,"");v(Ce,ae.address||""),v(Qe,ae.guardian||""),v(Xe,ae.contactNumber||"")}else{const he=ae.name.split(", ");if(he.length>=2){v(de,he[0]);const At=he[1].split(" ");v(je,At[0]),At.length>1&&At[1].endsWith(".")?v(ie,At[1].replace(".","")):v(ie,"")}if(v(Pe,ae.gradeLevel||""),ae.birthdate){const st=new Date(ae.birthdate),At=st.getFullYear(),kt=String(st.getMonth()+1).padStart(2,"0"),Ct=String(st.getDate()).padStart(2,"0");v(ve,`${At}-${kt}-${Ct}`)}else v(ve,"");v(Ce,ae.address||""),v(Qe,ae.guardian||""),v(Xe,ae.contactNumber||"")}}async function B(){if(!e(je)||!e(de)){Se.error("Please fill in all required fields.");return}if(e(l)&&e(l).type.toLowerCase()==="student"){if(!e(ve)||!e(Ce)||!e(Qe)||!e(Xe)){Se.error("Please fill in all required student information fields.");return}if(!be(e(Xe))){Se.error("Invalid contact number.");return}}v(Ze,!0);try{const ae={id:e(me),firstName:e(je).trim(),lastName:e(de).trim(),middleInitial:e(ie)?e(ie).trim():null};e(l)&&e(l).type.toLowerCase()==="student"&&(ae.gradeLevel=e(Pe)||null,ae.birthdate=e(ve)||null,ae.address=e(Ce)?e(Ce).trim():null,ae.guardian=e(Qe)?e(Qe).trim():null,ae.contactNumber=e(Xe)?e(Xe).trim():null);const he=await da.put("/api/accounts",ae);he.success?(v(ft,e(ft).map(st=>st.id===e(me)?he.account:st)),Se.success(he.message),v(me,null),v(je,""),v(de,""),v(ie,""),v(Pe,""),v(ve,""),v(Ce,""),v(Qe,""),v(Xe,""),v(ze,0)):Se.error(he.error||"Failed to update account")}catch(ae){console.error("Error updating account:",ae),Se.error("Failed to update account. Please try again.")}finally{v(Ze,!1)}}function I(){v(se,!e(se))}function G(ae){v(y,ae.id),v(se,!1),ae.id!=="student"&&v(A,"")}function Z(){v(V,!e(V))}function le(ae){v(k,ae.id),v(V,!1)}function N(){v(re,!e(re))}function M(ae){v(A,ae.id),v(re,!1)}function H(){v(Ve,!e(Ve))}function pe(ae){v(Pe,ae.id),v(Ve,!1)}async function ee(){if(!e(y)||!e(k)||!e(T)||!e(C)){Se.error("Please fill in all required fields.");return}if((e(y)==="student"||e(y)==="teacher")&&!e(S)){Se.error("Please enter an email address.");return}if(e(L)){Se.error(e(L));return}if(e(F)){Se.error("Please wait while we verify the email address.");return}if(e(y)==="student"&&!e(A)){Se.error("Please select a grade level for the student account.");return}if(e(y)==="student"){if(!e(Q)||!e(W)||!e($)||!e(R)){Se.error("Please fill in all additional information fields for the student account.");return}if(!be(e(R))){Se.error("Invalid contact number.");return}}const ae=e(y)==="student"?"Student":e(y)==="teacher"?"Teacher":"Admin",he=`${e(T)} ${e(D)?e(D)+". ":""}${e(C)}`;us.confirm("Confirm Account Creation",`<p>Are you sure you want to create a <strong>${ae}</strong> account for <strong>"${he}"</strong>?</p>`,async()=>{await Ae()},()=>{},{size:"small"})}async function Ae(){v(b,!0);try{const ae=n().userData,he=await da.post("/api/accounts",{accountType:e(y),gender:e(k),gradeLevel:e(A),firstName:e(T),lastName:e(C),middleInitial:e(D),email:e(S),birthdate:e(y)==="student"?e(Q):null,address:e(y)==="student"?e(W):null,guardian:e(y)==="student"?e($):null,contactNumber:e(y)==="student"?e(R):null,createdBy:ae?ae.id:null});if(!he.success)throw new Error(he.message||"Failed to create account");v(ft,[he.account,...e(ft)]);const st=e(y)==="student"?"Student":e(y)==="teacher"?"Teacher":"Admin";Se.success(`${st} account created successfully for ${he.account.name}! Password is the same as account number: ${he.account.number}`),v(y,""),v(k,""),v(A,""),v(T,""),v(C,""),v(D,""),v(S,""),v(L,""),v(Q,""),v(W,""),v($,""),v(R,""),v(X,0)}catch(ae){console.error("Error creating account:",ae),Se.error(ae.message||"Failed to create account. Please try again.")}finally{v(b,!1)}}function Ue(){v(De,!e(De))}function Le(ae){v(ce,ae.id),v(De,!1)}function He(){v(Y,"")}let Ie=O(""),nt=O(!1);async function bt(ae){if(!ae){v(Ie,"");return}v(nt,!0);try{const he=await da.get(`/api/accounts/next-number?type=${ae}`);v(Ie,he.accountNumber)}catch(he){console.error("Error fetching next account number:",he),v(Ie,"Error loading preview")}finally{v(nt,!1)}}async function pt(){v(Ye,!0);try{const ae=await da.get("/api/accounts");if(!ae.success)throw new Error("Failed to load accounts");v(ft,ae.accounts)}catch(ae){console.error("Error loading accounts:",ae),Se.error("Failed to load existing accounts")}finally{v(Ye,!1)}}Ya(()=>{pt()}),_t(()=>(e(me),e(ft)),()=>{v(l,e(me)?e(ft).find(ae=>ae.id===e(me)):null)}),_t(()=>e(y),()=>{v(c,ot.find(ae=>ae.id===e(y)))}),_t(()=>e(k),()=>{v(d,Me.find(ae=>ae.id===e(k)))}),_t(()=>e(A),()=>{v(f,it.find(ae=>ae.id===e(A)))}),_t(()=>e(Pe),()=>{v(p,it.find(ae=>ae.id===e(Pe)))}),_t(()=>e(Q),()=>{if(e(Q)){const ae=new Date(e(Q)),he=new Date;let st=he.getFullYear()-ae.getFullYear();const At=he.getMonth()-ae.getMonth();(At<0||At===0&&he.getDate()<ae.getDate())&&st--,v(X,st>=0?st:0)}else v(X,0)}),_t(()=>e(ve),()=>{if(e(ve)){const ae=new Date(e(ve)),he=new Date;let st=he.getFullYear()-ae.getFullYear();const At=he.getMonth()-ae.getMonth();(At<0||At===0&&he.getDate()<ae.getDate())&&st--,v(ze,st>=0?st:0)}else v(ze,0)}),_t(()=>e(ce),()=>{v(h,U.find(ae=>ae.id===e(ce)))}),_t(()=>(e(ft),e(ce),e(Y)),()=>{v(g,e(ft).filter(ae=>{const he=e(ce)==="all"||ae.type.toLowerCase()===e(ce).toLowerCase(),st=!e(Y)||ae.name?.toLowerCase().includes(e(Y).toLowerCase())||ae.number?.toString().toLowerCase().includes(e(Y).toLowerCase())||ae.type?.toLowerCase().includes(e(Y).toLowerCase());return he&&st}))}),_t(()=>e(y),()=>{e(y)&&bt(e(y))}),Rs(),Ls();var vt=G0();ye("click",Zs,ne);var Tt=u(o(vt),2),Ot=u(o(Tt),2),la=o(Ot),sa=o(la),zt=o(sa),qt=u(o(zt),2);let Pt;var Yt=o(qt);let Ut;var Et=o(Yt);{var ta=ae=>{var he=t0(),st=o(he),At=o(st,!0);i(st);var kt=u(st,2),Ct=o(kt),ia=o(Ct,!0);i(Ct);var Ca=u(Ct,2),jt=o(Ca,!0);i(Ca),i(kt),i(he),q(()=>{w(At,(e(c),x(()=>e(c).icon))),w(ia,(e(c),x(()=>e(c).name))),w(jt,(e(c),x(()=>e(c).description)))}),m(ae,he)},fa=ae=>{var he=a0();m(ae,he)};E(Et,ae=>{e(c)?ae(ta):ae(fa,!1)})}Bt(2),i(Yt);var oe=u(Yt,2);xt(oe,5,()=>ot,ae=>ae.id,(ae,he)=>{var st=s0();let At;var kt=o(st),Ct=o(kt,!0);i(kt);var ia=u(kt,2),Ca=o(ia),jt=o(Ca,!0);i(Ca);var qe=u(Ca,2),Jt=o(qe,!0);i(qe),i(ia),i(st),q(yt=>{At=_e(st,1,"dropdown-option",null,At,yt),w(Ct,(e(he),x(()=>e(he).icon))),w(jt,(e(he),x(()=>e(he).name))),w(Jt,(e(he),x(()=>e(he).description)))},[()=>({selected:e(y)===e(he).id})]),ye("click",st,()=>G(e(he))),m(ae,st)}),i(oe),i(qt),i(zt);var Ee=u(zt,2),dt=u(o(Ee),2);let we;var Oe=o(dt);let lt;var Rt=o(Oe);{var Ht=ae=>{var he=r0(),st=o(he),At=o(st,!0);i(st);var kt=u(st,2),Ct=o(kt),ia=o(Ct,!0);i(Ct),i(kt),i(he),q(()=>{w(At,(e(d),x(()=>e(d).icon))),w(ia,(e(d),x(()=>e(d).name)))}),m(ae,he)},rt=ae=>{var he=i0();m(ae,he)};E(Rt,ae=>{e(d)?ae(Ht):ae(rt,!1)})}Bt(2),i(Oe);var ka=u(Oe,2);xt(ka,5,()=>Me,ae=>ae.id,(ae,he)=>{var st=n0();let At;var kt=o(st),Ct=o(kt,!0);i(kt);var ia=u(kt,2),Ca=o(ia),jt=o(Ca,!0);i(Ca),i(ia),i(st),q(qe=>{At=_e(st,1,"dropdown-option",null,At,qe),w(Ct,(e(he),x(()=>e(he).icon))),w(jt,(e(he),x(()=>e(he).name)))},[()=>({selected:e(k)===e(he).id})]),ye("click",st,()=>le(e(he))),m(ae,st)}),i(ka),i(dt),i(Ee);var Zt=u(Ee,2);{var tt=ae=>{var he=d0(),st=u(o(he),2);let At;var kt=o(st);let Ct;var ia=o(kt);{var Ca=Jt=>{var yt=o0(),Lt=o(yt),Xt=o(Lt,!0);i(Lt);var na=u(Lt,2),ja=o(na),$a=o(ja,!0);i(ja),i(na),i(yt),q(()=>{w(Xt,(e(f),x(()=>e(f).icon))),w($a,(e(f),x(()=>e(f).name)))}),m(Jt,yt)},jt=Jt=>{var yt=l0();m(Jt,yt)};E(ia,Jt=>{e(f)?Jt(Ca):Jt(jt,!1)})}Bt(2),i(kt);var qe=u(kt,2);xt(qe,5,()=>it,Jt=>Jt.id,(Jt,yt)=>{var Lt=c0();let Xt;var na=o(Lt),ja=o(na,!0);i(na);var $a=u(na,2),Ra=o($a),Ba=o(Ra,!0);i(Ra),i($a),i(Lt),q(ts=>{Xt=_e(Lt,1,"dropdown-option",null,Xt,ts),w(ja,(e(yt),x(()=>e(yt).icon))),w(Ba,(e(yt),x(()=>e(yt).name)))},[()=>({selected:e(A)===e(yt).id})]),ye("click",Lt,()=>M(e(yt))),m(Jt,Lt)}),i(qe),i(st),i(he),q((Jt,yt)=>{At=_e(st,1,"custom-dropdown",null,At,Jt),Ct=_e(kt,1,"dropdown-trigger",null,Ct,yt)},[()=>({open:e(re)}),()=>({selected:e(A)})]),ye("click",kt,N),m(ae,he)};E(Zt,ae=>{e(y)==="student"&&ae(tt)})}i(sa);var wt=u(sa,2),ge=o(wt),te=u(o(ge),2);aa(te),i(ge);var J=u(ge,2),Be=u(o(J),2);aa(Be),i(J);var Ge=u(J,2),at=u(o(Ge),2);aa(at),i(Ge),i(wt);var gt=u(wt,2);{var Gt=ae=>{var he=h0(),st=u(o(he),2),At=o(st);aa(At);let kt;var Ct=u(At,2);{var ia=yt=>{var Lt=u0();m(yt,Lt)},Ca=yt=>{var Lt=mt(),Xt=Je(Lt);{var na=$a=>{var Ra=v0();m($a,Ra)},ja=$a=>{var Ra=mt(),Ba=Je(Ra);{var ts=_s=>{var Ga=f0();m(_s,Ga)};E(Ba,_s=>{e(L)&&_s(ts)},!0)}m($a,Ra)};E(Xt,$a=>{e(S)&&!e(L)?$a(na):$a(ja,!1)},!0)}m(yt,Lt)};E(Ct,yt=>{e(F)?yt(ia):yt(Ca,!1)})}i(st);var jt=u(st,2);{var qe=yt=>{var Lt=p0(),Xt=o(Lt,!0);i(Lt),q(()=>w(Xt,e(L))),m(yt,Lt)},Jt=yt=>{var Lt=mt(),Xt=Je(Lt);{var na=ja=>{var $a=m0();m(ja,$a)};E(Xt,ja=>{e(S)&&!e(F)&&ja(na)},!0)}m(yt,Lt)};E(jt,yt=>{e(L)?yt(qe):yt(Jt,!1)})}i(he),q(yt=>kt=_e(At,1,"form-input",null,kt,yt),[()=>({error:e(L),valid:e(S)&&!e(L)&&!e(F)})]),oa(At,()=>e(S),yt=>v(S,yt)),ye("input",At,et),m(ae,he)};E(gt,ae=>{(e(y)==="student"||e(y)==="teacher")&&ae(Gt)})}var _a=u(gt,2);{var ht=ae=>{var he=g0(),st=u(o(he),4),At=o(st),kt=u(o(At),2);aa(kt),i(At);var Ct=u(At,2),ia=u(o(Ct),2);aa(ia),i(Ct),i(st);var Ca=u(st,2),jt=u(o(Ca),2);xn(jt),i(Ca);var qe=u(Ca,2),Jt=o(qe),yt=u(o(Jt),2);aa(yt),i(Jt);var Lt=u(Jt,2),Xt=u(o(Lt),2);aa(Xt),i(Lt),i(qe),i(he),q(na=>{$t(kt,"max",na),Ii(ia,e(X))},[()=>x(We)]),oa(kt,()=>e(Q),na=>v(Q,na)),ye("blur",kt,na=>{e(Q)&&!$e(e(Q))&&(Se.error("Invalid date. Please enter a valid date."),v(Q,""),na.target.value="")}),oa(jt,()=>e(W),na=>v(W,na)),oa(yt,()=>e($),na=>v($,na)),oa(Xt,()=>e(R),na=>v(R,na)),ye("input",Xt,na=>Fe(na,!1)),m(ae,he)};E(_a,ae=>{e(y)==="student"&&ae(ht)})}var Ne=u(_a,2),ct=o(Ne),Ft=o(ct,!0);i(ct);var Mt=u(ct,2),It=o(Mt);{var ra=ae=>{var he=mt(),st=Je(he);{var At=Ct=>{var ia=_0();m(Ct,ia)},kt=Ct=>{var ia=mt(),Ca=Je(ia);{var jt=Jt=>{var yt=b0(),Lt=Je(yt),Xt=o(Lt,!0);i(Lt),Bt(2),q(()=>w(Xt,e(Ie))),m(Jt,yt)},qe=Jt=>{var yt=y0();m(Jt,yt)};E(Ca,Jt=>{e(Ie)?Jt(jt):Jt(qe,!1)},!0)}m(Ct,ia)};E(st,Ct=>{e(nt)?Ct(At):Ct(kt,!1)})}m(ae,he)},ha=ae=>{var he=w0();m(ae,he)};E(It,ae=>{e(y)?ae(ra):ae(ha,!1)})}i(Mt),Bt(2),i(Ne);var ca=u(Ne,2),Qt=o(ca);let va;var pa=o(Qt);{var ua=ae=>{var he=Sa("Creating Account...");m(ae,he)},ba=ae=>{var he=x0();Bt(),m(ae,he)};E(pa,ae=>{e(b)?ae(ua):ae(ba,!1)})}i(Qt),i(ca),i(la),i(Ot),i(Tt);var Ta=u(Tt,2),Pa=o(Ta),Ea=o(Pa),K=u(o(Ea),2),xe=o(K),Ke=o(xe),Dt=u(o(Ke),2);aa(Dt);var Wt=u(Dt,2);{var Nt=ae=>{var he=S0();ye("click",he,He),m(ae,he)};E(Wt,ae=>{e(Y)&&ae(Nt)})}i(Ke),i(xe);var St=u(xe,2),Na=o(St);let Aa;var ga=o(Na);let Da;var Vt=o(ga);{var Kt=ae=>{var he=k0(),st=o(he),At=o(st,!0);i(st);var kt=u(st,2),Ct=o(kt),ia=o(Ct,!0);i(Ct),i(kt),i(he),q(()=>{w(At,(e(h),x(()=>e(h).icon))),w(ia,(e(h),x(()=>e(h).name)))}),m(ae,he)},xa=ae=>{var he=A0();m(ae,he)};E(Vt,ae=>{e(h)?ae(Kt):ae(xa,!1)})}Bt(2),i(ga);var ya=u(ga,2);xt(ya,5,()=>U,ae=>ae.id,(ae,he)=>{var st=D0();let At;var kt=o(st),Ct=o(kt,!0);i(kt);var ia=u(kt,2),Ca=o(ia),jt=o(Ca,!0);i(Ca),i(ia),i(st),q(qe=>{At=_e(st,1,"account-filter-dropdown-option",null,At,qe),w(Ct,(e(he),x(()=>e(he).icon))),w(jt,(e(he),x(()=>e(he).name)))},[()=>({selected:e(ce)===e(he).id})]),ye("click",st,()=>Le(e(he))),m(ae,st)}),i(ya),i(Na),i(St),i(K),i(Ea),i(Pa);var Fa=u(Pa,2),ma=o(Fa);{var wa=ae=>{var he=C0();m(ae,he)},Ia=ae=>{var he=mt(),st=Je(he);{var At=Ct=>{var ia=F0(),Ca=u(o(ia),2);{var jt=Jt=>{var yt=T0();m(Jt,yt)},qe=Jt=>{var yt=E0();m(Jt,yt)};E(Ca,Jt=>{e(ft),x(()=>e(ft).length===0)?Jt(jt):Jt(qe,!1)})}i(ia),m(Ct,ia)},kt=Ct=>{var ia=mt(),Ca=Je(ia);xt(Ca,1,()=>e(g),jt=>jt.id,(jt,qe)=>{var Jt=z0(),yt=o(Jt),Lt=o(yt),Xt=o(Lt),na=o(Xt);i(Xt),i(Lt);var ja=u(Lt,2),$a=o(ja),Ra=o($a),Ba=o(Ra),ts=o(Ba,!0);i(Ba),i(Ra),i($a);var _s=u($a,2);i(ja),i(yt);var Ga=u(yt,2),ss=o(Ga),La=o(ss),Ha=o(La,!0);i(La);var vs=u(La,2),Za=o(vs,!0);i(vs),i(ss);var Xa=u(ss,2),rs=u(o(Xa),2),is=o(rs);i(rs),i(Xa);var bs=u(Xa,2);{var ys=fs=>{var cs=N0(),Cs=u(o(cs),2),Os=o(Cs,!0);i(Cs),i(cs),q(()=>w(Os,(e(qe),x(()=>e(qe).advisorySection||"No advisory section assigned")))),m(fs,cs)};E(bs,fs=>{e(qe),x(()=>e(qe).type==="Teacher")&&fs(ys)})}var As=u(bs,2);{var Ds=fs=>{var cs=$0(),Cs=u(o(cs),2),Os=o(Cs);i(Cs),i(cs),q(()=>w(Os,`Grade ${e(qe),x(()=>e(qe).gradeLevel)??""}`)),m(fs,cs)};E(As,fs=>{e(qe),x(()=>e(qe).type==="Student"&&e(qe).gradeLevel)&&fs(Ds)})}var Us=u(As,2);{var ar=fs=>{var cs=P0(),Cs=u(o(cs),2),Os=o(Cs);i(Cs),i(cs),q(()=>w(Os,`Age: ${e(qe),x(()=>e(qe).age)??""}`)),m(fs,cs)};E(Us,fs=>{e(qe),x(()=>e(qe).type==="Student"&&e(qe).age)&&fs(ar)})}var sr=u(Us,2);{var zr=fs=>{var cs=L0(),Cs=u(o(cs),2),Os=o(Cs);i(Cs),i(cs),q(()=>w(Os,`Guardian: ${e(qe),x(()=>e(qe).guardian)??""}`)),m(fs,cs)};E(sr,fs=>{e(qe),x(()=>e(qe).type==="Student"&&e(qe).guardian)&&fs(zr)})}var pr=u(sr,2);{var hi=fs=>{var cs=M0(),Cs=u(o(cs),2),Os=o(Cs);i(Cs),i(cs),q(()=>w(Os,`Contact: ${e(qe),x(()=>e(qe).contactNumber)??""}`)),m(fs,cs)};E(pr,fs=>{e(qe),x(()=>e(qe).type==="Student"&&e(qe).contactNumber)&&fs(hi)})}var gi=u(pr,2),ai=u(o(gi),2),_i=o(ai);i(ai),i(gi);var Qi=u(gi,2),Ki=u(o(Qi),2),Ji=o(Ki);i(Ki),i(Qi),i(Ga);var Xi=u(Ga,2);{var zn=fs=>{var cs=q0(),Cs=o(cs),Os=u(o(Cs),2),bi=o(Os),yi=o(bi),Zi=o(yi),Oa=u(Zi,2);aa(Oa),i(yi);var Va=u(yi,2),ws=o(Va),js=u(ws,2);aa(js),i(Va);var er=u(Va,2),rr=o(er),mr=u(rr,2);aa(mr),i(er),i(bi);var Fr=u(bi,2);{var wi=ms=>{var Nr=j0(),Gn=Je(Nr),Oo=o(Gn),Vn=u(Oo,2);let jo;var ii=o(Vn);let qo;var wd=o(ii);{var xd=hs=>{var Ys=I0(),vr=o(Ys),tn=o(vr,!0);i(vr);var ni=u(vr,2),an=o(ni),sn=o(an,!0);i(an),i(ni),i(Ys),q(()=>{w(tn,(e(p),x(()=>e(p).icon))),w(sn,(e(p),x(()=>e(p).name)))}),m(hs,Ys)},Sd=hs=>{var Ys=R0();m(hs,Ys)};E(wd,hs=>{e(p)?hs(xd):hs(Sd,!1)})}Bt(2),i(ii);var zo=u(ii,2);xt(zo,5,()=>it,hs=>hs.id,(hs,Ys)=>{var vr=O0();let tn;var ni=o(vr),an=o(ni,!0);i(ni);var sn=u(ni,2),Jo=o(sn),kd=o(Jo,!0);i(Jo),i(sn),i(vr),q(Ad=>{tn=_e(vr,1,"dropdown-option",null,tn,Ad),w(an,(e(Ys),x(()=>e(Ys).icon))),w(kd,(e(Ys),x(()=>e(Ys).name)))},[()=>({selected:e(Pe)===e(Ys).id})]),ye("click",vr,()=>pe(e(Ys))),m(hs,vr)}),i(zo),i(Vn),i(Gn);var Go=u(Gn,2),Bn=u(o(Go),4),Wn=o(Bn),Vo=o(Wn),xi=u(Vo,2);aa(xi),i(Wn);var Bo=u(Wn,2),Wo=o(Bo),Hn=u(Wo,2);aa(Hn),i(Bo),i(Bn);var Un=u(Bn,2),Ho=o(Un),Yn=u(Ho,2);xn(Yn),i(Un);var Uo=u(Un,2),Qn=o(Uo),Yo=o(Qn),Kn=u(Yo,2);aa(Kn),i(Qn);var Qo=u(Qn,2),Ko=o(Qo),en=u(Ko,2);aa(en),i(Qo),i(Uo),i(Go),q((hs,Ys,vr)=>{$t(Oo,"for",`edit-grade-level-${e(qe),x(()=>e(qe).id)??""}`),jo=_e(Vn,1,"custom-dropdown",null,jo,hs),qo=_e(ii,1,"dropdown-trigger",null,qo,Ys),$t(ii,"id",`edit-grade-level-${e(qe),x(()=>e(qe).id)??""}`),$t(Vo,"for",`edit-birthdate-${e(qe),x(()=>e(qe).id)??""}`),$t(xi,"id",`edit-birthdate-${e(qe),x(()=>e(qe).id)??""}`),$t(xi,"max",vr),$t(Wo,"for",`edit-age-${e(qe),x(()=>e(qe).id)??""}`),$t(Hn,"id",`edit-age-${e(qe),x(()=>e(qe).id)??""}`),Ii(Hn,e(ze)),$t(Ho,"for",`edit-address-${e(qe),x(()=>e(qe).id)??""}`),$t(Yn,"id",`edit-address-${e(qe),x(()=>e(qe).id)??""}`),$t(Yo,"for",`edit-guardian-${e(qe),x(()=>e(qe).id)??""}`),$t(Kn,"id",`edit-guardian-${e(qe),x(()=>e(qe).id)??""}`),$t(Ko,"for",`edit-contact-number-${e(qe),x(()=>e(qe).id)??""}`),$t(en,"id",`edit-contact-number-${e(qe),x(()=>e(qe).id)??""}`)},[()=>({open:e(Ve)}),()=>({selected:e(Pe)}),()=>x(We)]),ye("click",ii,H),oa(xi,()=>e(ve),hs=>v(ve,hs)),ye("blur",xi,hs=>{e(ve)&&!$e(e(ve))&&(Se.error("Invalid date. Please enter a valid date."),v(ve,""),hs.target.value="")}),oa(Yn,()=>e(Ce),hs=>v(Ce,hs)),oa(Kn,()=>e(Qe),hs=>v(Qe,hs)),oa(en,()=>e(Xe),hs=>v(Xe,hs)),ye("input",en,hs=>Fe(hs,!0)),m(ms,Nr)};E(Fr,ms=>{e(qe),x(()=>e(qe).type.toLowerCase()==="student")&&ms(wi)})}var Gr=u(Fr,2),si=o(Gr),Vr=o(si);i(si);var ri=u(si,2);let Ro;var _d=o(ri);{var bd=ms=>{var Nr=Sa("Updating...");m(ms,Nr)},yd=ms=>{var Nr=Sa("Update Account");m(ms,Nr)};E(_d,ms=>{e(Ze)?ms(bd):ms(yd,!1)})}i(ri),i(Gr),i(Os),i(Cs),i(cs),q((ms,Nr)=>{$t(Zi,"for",`edit-last-name-${e(qe),x(()=>e(qe).id)??""}`),$t(Oa,"id",`edit-last-name-${e(qe),x(()=>e(qe).id)??""}`),$t(ws,"for",`edit-first-name-${e(qe),x(()=>e(qe).id)??""}`),$t(js,"id",`edit-first-name-${e(qe),x(()=>e(qe).id)??""}`),$t(rr,"for",`edit-middle-initial-${e(qe),x(()=>e(qe).id)??""}`),$t(mr,"id",`edit-middle-initial-${e(qe),x(()=>e(qe).id)??""}`),$t(si,"href",`#account-card-${e(qe),x(()=>e(qe).id)??""}`),Ro=_e(ri,1,"account-submit-button",null,Ro,ms),ri.disabled=Nr},[()=>({loading:e(Ze)}),()=>(e(Ze),e(je),e(de),e(l),e(ve),e(Ce),e(Qe),e(Xe),x(()=>e(Ze)||!e(je)||!e(de)||e(l)&&e(l).type.toLowerCase()==="student"&&(!e(ve)||!e(Ce)||!e(Qe)||!e(Xe))))]),oa(Oa,()=>e(de),ms=>v(de,ms)),ye("input",Oa,ms=>ue(ms,"lastName",!0)),oa(js,()=>e(je),ms=>v(je,ms)),ye("input",js,ms=>ue(ms,"firstName",!0)),oa(mr,()=>e(ie),ms=>v(ie,ms)),ye("input",mr,ms=>ue(ms,"middleInitial",!0)),ye("click",Vr,()=>z(e(qe))),ye("submit",Os,tr(B)),m(fs,cs)};E(Xi,fs=>{e(me),e(qe),x(()=>e(me)===e(qe).id)&&fs(zn)})}i(Jt),q(()=>{$t(Jt,"id",`account-card-${e(qe),x(()=>e(qe).id)??""}`),w(na,`${e(qe),x(()=>e(qe).name)??""}  ${e(qe),x(()=>e(qe).type)??""}`),$t($a,"href",`#account-card-${e(qe),x(()=>e(qe).id)??""}`),$t(Ra,"title",(e(me),e(qe),x(()=>e(me)===e(qe).id?"Cancel Edit":"Edit Account"))),w(ts,(e(me),e(qe),x(()=>e(me)===e(qe).id?"close":"edit"))),w(Ha,(e(qe),x(()=>e(qe).type==="Student"?"school":e(qe).type==="Teacher"?"person":"admin_panel_settings"))),w(Za,(e(qe),x(()=>e(qe).number))),w(is,`${e(qe),x(()=>e(qe).type)??""} Account`),w(_i,`Created: ${e(qe),x(()=>e(qe).createdDate)??""}`),w(Ji,`Updated: ${e(qe),x(()=>e(qe).updatedDate)??""}`)}),ye("click",Ra,()=>z(e(qe))),ye("click",_s,()=>fe(e(qe))),m(jt,Jt)}),m(Ct,ia)};E(st,Ct=>{e(g),x(()=>e(g).length===0)?Ct(At):Ct(kt,!1)},!0)}m(ae,he)};E(ma,ae=>{e(Ye)?ae(wa):ae(Ia,!1)})}i(Fa),i(Ta),i(vt),q((ae,he,st,At,kt,Ct,ia)=>{Pt=_e(qt,1,"custom-dropdown",null,Pt,ae),Ut=_e(Yt,1,"dropdown-trigger",null,Ut,he),we=_e(dt,1,"custom-dropdown",null,we,st),lt=_e(Oe,1,"dropdown-trigger",null,lt,At),w(Ft,e(y)==="student"?"Student Number":e(y)==="teacher"?"Teacher Number":e(y)==="admin"?"Admin Number":"Account Number"),va=_e(Qt,1,"account-create-button",null,va,kt),Qt.disabled=e(b)||!e(y)||!e(k)||!e(T)||!e(C)||(e(y)==="student"||e(y)==="teacher")&&(!e(S)||e(L)||e(F))||e(y)==="student"&&(!e(Q)||!e(W)||!e($)||!e(R)),Aa=_e(Na,1,"account-filter-dropdown",null,Aa,Ct),Da=_e(ga,1,"account-filter-trigger",null,Da,ia)},[()=>({open:e(se)}),()=>({selected:e(y)}),()=>({open:e(V)}),()=>({selected:e(k)}),()=>({loading:e(b)}),()=>({open:e(De)}),()=>({selected:e(ce)!=="all"})]),ye("click",Yt,I),ye("click",Oe,Z),oa(te,()=>e(C),ae=>v(C,ae)),ye("input",te,ae=>ue(ae,"lastName")),oa(Be,()=>e(T),ae=>v(T,ae)),ye("input",Be,ae=>ue(ae,"firstName")),oa(at,()=>e(D),ae=>v(D,ae)),ye("input",at,ae=>ue(ae,"middleInitial")),ye("submit",la,tr(ee)),oa(Dt,()=>e(Y),ae=>v(Y,ae)),ye("click",ga,Ue),m(s,vt),za(),r()}function B0(){const{subscribe:s,set:t,update:a}=Hs({students:[],sections:[],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:s,init:r=>{r&&a(n=>({...n,students:r.students||[],sections:r.sections||[],isInitialized:!0,isLoading:!1}))},setLoading:r=>{a(n=>({...n,isLoading:r&&!n.isInitialized}))},updateStudents:r=>{a(n=>{const l={...n,students:r,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0};try{localStorage.setItem("student-masterlist-cache",JSON.stringify({students:r,sections:n.sections,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache student masterlist data:",c)}return l})},updateSections:r=>{a(n=>{const l={...n,sections:r};try{localStorage.setItem("student-masterlist-cache",JSON.stringify({students:n.students,sections:r,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache sections data:",c)}return l})},setError:r=>{a(n=>({...n,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem("student-masterlist-cache");if(r){const{students:n,sections:l,timestamp:c}=JSON.parse(r);if(Date.now()-c<300*1e3)return{students:n,sections:l}}}catch(r){console.warn("Failed to retrieve cached student masterlist data:",r)}return null},clearCache:()=>{try{localStorage.removeItem("student-masterlist-cache")}catch(r){console.warn("Failed to clear student masterlist cache:",r)}},refresh:async(r,n)=>{a(l=>({...l,isLoading:!0})),await Promise.all([r(),n()])}}}const Pr=B0();var W0=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),H0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <span class="option-name"> </span></div>'),U0=_('<span class="placeholder">All Grade Levels</span>'),Y0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Q0=_('<div class="selected-option"><span class="option-name"> </span></div>'),K0=_('<span class="placeholder">All Sections</span>'),J0=_('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),X0=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Z0=_('<div class="masterlist-loading-container"><span class="student-loader"></span> <p class="masterlist-loading-text">Loading students...</p></div>'),ew=_('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),tw=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),aw=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),sw=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),rw=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),iw=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),nw=_('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),ow=_('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),lw=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Student"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),cw=_('<div class="students-grid"></div>'),dw=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p></div>'),uw=_('<div class="student-masterlist-container"><div class="admin-student-header"><div class="header-content"><h1 class="page-title">Student Masterlist</h1> <p class="page-subtitle">View and manage all student records in the system</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label" for="grade-level-dropdown">Grade Level</label> <div><button type="button" id="grade-level-dropdown" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label" for="section-dropdown">Section</label> <div><button type="button" id="section-dropdown" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="students-list-section"><!></div></div>');function vw(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(Pr,"$studentMasterlistStore",a),l=O(),c=O(),d=O(),f=O(),p=O(),h=O();let g=O([]),b=O(""),y=O(""),k=O(""),A=O(!1),T=O(!1);const C=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];async function D(U=!1){try{U||Pr.setLoading(!0);const ne=await da.get("/api/accounts?type=student");if(!ne.success)throw new Error("Failed to load students");const fe=ne.accounts.map(z=>({id:z.id,name:z.name,number:z.number,email:z.email,gradeLevel:z.gradeLevel||"Not specified",section:z.section||"Not specified",birthdate:z.birthdate||"Not specified",address:z.address||"Not specified",guardian:z.guardian||"Not specified",contactNumber:z.contactNumber||"Not specified",status:z.status||"active"}));Pr.updateStudents(fe)}catch(ne){console.error("Error loading students:",ne),Pr.setError(ne.message),U||Se.error("Failed to load students. Please try again.")}}async function S(){try{const U=await da.get("/api/sections");if(U.success&&U.data){const ne=U.data.map(z=>({id:z.name,name:z.name})),fe=[{id:"",name:"All Sections"},...ne];Pr.updateSections(fe)}}catch(U){console.error("Error loading sections:",U),Pr.updateSections([{id:"",name:"All Sections"}])}}function L(){v(g,e(l).filter(U=>{const ne=!e(b)||U.name.toLowerCase().includes(e(b).toLowerCase())||U.email.toLowerCase().includes(e(b).toLowerCase())||U.number&&U.number.toLowerCase().includes(e(b).toLowerCase()),fe=!e(y)||U.gradeLevel===e(y),z=!e(k)||U.section===e(k);return ne&&fe&&z}))}function F(){v(A,!e(A)),v(T,!1)}function j(){v(T,!e(T)),v(A,!1)}function P(U){v(y,U.id),v(A,!1),L()}function Q(U){v(k,U.id),v(T,!1),L()}function W(U){if(!U)return"N/A";const ne=new Date,fe=new Date(U);let z=ne.getFullYear()-fe.getFullYear();const B=ne.getMonth()-fe.getMonth();return(B<0||B===0&&ne.getDate()<fe.getDate())&&z--,z}function $(U){return U?new Date(U).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function R(){v(b,""),v(y,""),v(k,""),L()}function X(U){U.target.closest(".custom-dropdown")||(v(A,!1),v(T,!1))}async function se(U,ne){us.confirm("Archive Student",`Are you sure you want to archive ${ne}? This action will move the student to the archived list.`,async()=>{try{const fe=await da.patch("/api/accounts",{id:U,action:"archive"});fe.success?(Se.success(fe.message),await D()):Se.error(fe.message||"Failed to archive student")}catch(fe){console.error("Error archiving student:",fe),Se.error("Failed to archive student. Please try again.")}},()=>{})}Ya(()=>{const U=Pr.getCachedData();U&&Pr.init(U),S(),D(!!U);const ne=setInterval(()=>{D(!0)},3e4);return document.addEventListener("click",X),()=>{clearInterval(ne),document.removeEventListener("click",X)}}),_t(()=>(e(l),e(c),e(d),e(f),n()),()=>{(U=>{v(l,U.students),v(c,U.sections),v(d,U.isLoading),v(f,U.error)})(n())}),_t(()=>e(y),()=>{v(p,C.find(U=>U.id===e(y)))}),_t(()=>(e(c),e(k)),()=>{v(h,e(c).find(U=>U.id===e(k)))}),_t(()=>e(l),()=>{e(l)&&L()}),_t(()=>e(b),()=>{e(b)!==void 0&&L()}),Rs(),Ls();var V=uw(),re=u(o(V),2),me=o(re),je=o(me),de=o(je),ie=u(o(de),2);aa(ie);var Pe=u(ie,2);{var Ve=U=>{var ne=W0();ye("click",ne,()=>v(b,"")),m(U,ne)};E(Pe,U=>{e(b)&&U(Ve)})}i(de),i(je);var Ze=u(je,2),ve=o(Ze),Ce=u(o(ve),2);let Qe;var Xe=o(Ce),ze=o(Xe);{var We=U=>{var ne=H0(),fe=o(ne),z=o(fe,!0);i(fe);var B=u(fe,2),I=o(B,!0);i(B),i(ne),q(()=>{w(z,(e(p),x(()=>e(p).icon))),w(I,(e(p),x(()=>e(p).name)))}),m(U,ne)},Te=U=>{var ne=U0();m(U,ne)};E(ze,U=>{e(p)&&e(y)?U(We):U(Te,!1)})}Bt(2),i(Xe);var ue=u(Xe,2);xt(ue,5,()=>C,U=>U.id,(U,ne)=>{var fe=Y0();let z;var B=o(fe),I=o(B,!0);i(B);var G=u(B,2),Z=o(G),le=o(Z,!0);i(Z),i(G),i(fe),q(N=>{z=_e(fe,1,"dropdown-option",null,z,N),w(I,(e(ne),x(()=>e(ne).icon))),w(le,(e(ne),x(()=>e(ne).name)))},[()=>({selected:e(y)===e(ne).id})]),ye("click",fe,()=>P(e(ne))),m(U,fe)}),i(ue),i(Ce),i(ve);var be=u(ve,2),ke=u(o(be),2);let Fe;var Re=o(ke),et=o(Re);{var $e=U=>{var ne=Q0(),fe=o(ne),z=o(fe,!0);i(fe),i(ne),q(()=>w(z,(e(h),x(()=>e(h).name)))),m(U,ne)},ot=U=>{var ne=K0();m(U,ne)};E(et,U=>{e(h)&&e(k)?U($e):U(ot,!1)})}Bt(2),i(Re);var Me=u(Re,2);xt(Me,5,()=>e(c),U=>U.id,(U,ne)=>{var fe=J0();let z;var B=o(fe),I=o(B),G=o(I,!0);i(I),i(B),i(fe),q(Z=>{z=_e(fe,1,"dropdown-option",null,z,Z),w(G,(e(ne),x(()=>e(ne).name)))},[()=>({selected:e(k)===e(ne).id})]),ye("click",fe,()=>Q(e(ne))),m(U,fe)}),i(Me),i(ke),i(be);var it=u(be,2);{var ft=U=>{var ne=X0();ye("click",ne,R),m(U,ne)};E(it,U=>{(e(b)||e(y)||e(k))&&U(ft)})}i(Ze),i(me),i(re);var Ye=u(re,2),Y=o(Ye);{var ce=U=>{var ne=Z0();m(U,ne)},De=U=>{var ne=mt(),fe=Je(ne);{var z=I=>{var G=cw();xt(G,5,()=>e(g),Z=>Z.id,(Z,le)=>{var N=lw(),M=o(N),H=o(M),pe=o(H),ee=o(pe);{var Ae=oe=>{var Ee=Sa();q(()=>w(Ee,(e(le),x(()=>e(le).number)))),m(oe,Ee)};E(ee,oe=>{e(le),x(()=>e(le).number)&&oe(Ae)})}var Ue=u(ee);i(pe),i(H);var Le=u(H,2),He=o(Le);i(Le),i(M);var Ie=u(M,2),nt=o(Ie);{var bt=oe=>{var Ee=ew(),dt=u(o(Ee),2),we=o(dt,!0);i(dt),i(Ee),q(()=>w(we,(e(le),x(()=>e(le).email)))),m(oe,Ee)};E(nt,oe=>{e(le),x(()=>e(le).email)&&oe(bt)})}var pt=u(nt,2);{var vt=oe=>{var Ee=tw(),dt=u(o(Ee),2),we=o(dt,!0);i(dt),i(Ee),q(Oe=>w(we,Oe),[()=>(e(le),x(()=>C.find(Oe=>Oe.id===e(le).gradeLevel)?.name||e(le).gradeLevel))]),m(oe,Ee)};E(pt,oe=>{e(le),x(()=>e(le).gradeLevel&&e(le).gradeLevel!=="Not specified")&&oe(vt)})}var Tt=u(pt,2);{var Ot=oe=>{var Ee=aw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Section: ${Oe??""}`),[()=>(e(c),e(le),x(()=>e(c).find(Oe=>Oe.id===e(le).section)?.name||e(le).section))]),m(oe,Ee)};E(Tt,oe=>{e(le),x(()=>e(le).section&&e(le).section!=="Not specified")&&oe(Ot)})}var la=u(Tt,2);{var sa=oe=>{var Ee=sw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Age: ${Oe??""} years old`),[()=>(e(le),x(()=>W(e(le).birthdate)))]),m(oe,Ee)};E(la,oe=>{e(le),x(()=>e(le).birthdate&&e(le).birthdate!=="Not specified")&&oe(sa)})}var zt=u(la,2);{var qt=oe=>{var Ee=rw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Guardian: ${e(le),x(()=>e(le).guardian)??""}`)),m(oe,Ee)};E(zt,oe=>{e(le),x(()=>e(le).guardian&&e(le).guardian!=="Not specified")&&oe(qt)})}var Pt=u(zt,2);{var Yt=oe=>{var Ee=iw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Contact: ${e(le),x(()=>e(le).contactNumber)??""}`)),m(oe,Ee)};E(Pt,oe=>{e(le),x(()=>e(le).contactNumber&&e(le).contactNumber!=="Not specified")&&oe(Yt)})}var Ut=u(Pt,2);{var Et=oe=>{var Ee=nw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Address: ${e(le),x(()=>e(le).address)??""}`)),m(oe,Ee)};E(Ut,oe=>{e(le),x(()=>e(le).address&&e(le).address!=="Not specified")&&oe(Et)})}var ta=u(Ut,2);{var fa=oe=>{var Ee=ow(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Birthdate: ${Oe??""}`),[()=>(e(le),x(()=>$(e(le).birthdate)))]),m(oe,Ee)};E(ta,oe=>{e(le),x(()=>e(le).birthdate&&e(le).birthdate!=="Not specified")&&oe(fa)})}i(Ie),i(N),q(()=>w(Ue,`  ${e(le),x(()=>e(le).name)??""}`)),ye("click",He,()=>se(e(le).id,e(le).name)),m(Z,N)}),i(G),m(I,G)},B=I=>{var G=dw(),Z=o(G),le=o(Z,!0);i(Z);var N=u(Z,2),M=o(N);{var H=ee=>{var Ae=Sa("No students found matching your search criteria.");m(ee,Ae)},pe=ee=>{var Ae=Sa("No students found in the system.");m(ee,Ae)};E(M,ee=>{e(b)||e(y)||e(k)?ee(H):ee(pe,!1)})}i(N),i(G),q(()=>w(le,e(b)||e(y)||e(k)?"search_off":"school")),m(I,G)};E(fe,I=>{e(g),x(()=>e(g).length>0)?I(z):I(B,!1)},!0)}m(U,ne)};E(Y,U=>{e(d)?U(ce):U(De,!1)})}i(Ye),i(V),q((U,ne)=>{Qe=_e(Ce,1,"custom-dropdown",null,Qe,U),Fe=_e(ke,1,"custom-dropdown",null,Fe,ne)},[()=>({open:e(A)}),()=>({open:e(T)})]),oa(ie,()=>e(b),U=>v(b,U)),ye("click",Xe,F),ye("click",Re,j),m(s,V),za(),r()}var fw=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),pw=_('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),mw=_('<span class="aas-placeholder">All Grade Levels</span>'),hw=_('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),gw=_('<div class="aas-selected-option"><span class="aas-option-name"> </span></div>'),_w=_('<span class="aas-placeholder">All Sections</span>'),bw=_('<button type="button"><div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),yw=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),ww=_('<div class="aas-loading-container"><span class="aas-student-loader"></span> <p class="aas-loading-text">Loading archived students...</p></div>'),xw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),Sw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),kw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),Aw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Dw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),Cw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),Tw=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Ew=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),Fw=_('<div class="aas-account-card"><div class="aas-account-card-header"><div class="aas-account-title"><h3 class="aas-account-name"><!> </h3> <div class="aas-archived-badge"><span class="material-symbols-outlined">archive</span> <span> </span></div></div> <div class="aas-action-buttons"><button type="button" class="aas-restore-button" title="Restore Student"><span class="material-symbols-outlined">unarchive</span></button></div></div> <div class="aas-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),Nw=_('<div class="aas-students-grid"></div>'),$w=_('<button type="button" class="aas-clear-search-button-inline">Clear</button>'),Pw=_('<div class="aas-no-results"><span class="material-symbols-outlined aas-no-results-icon"> </span> <p><!></p> <!></div>'),Lw=_('<div class="aas-archived-students-container"><div class="aas-admin-student-header"><div class="aas-header-content"><h1 class="aas-page-title">Archived Students</h1> <p class="aas-page-subtitle">View and manage archived student records</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search archived students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label" for="archived-grade-level-dropdown">Grade Level</label> <div><button type="button" id="archived-grade-level-dropdown" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label" for="archived-section-dropdown">Section</label> <div><button type="button" id="archived-section-dropdown" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <!></div></div></div> <div class="aas-students-list-section"><!></div></div>');function Mw(s,t){qa(t,!1);const a=O(),r=O();let n=[],l=O([]),c=O(!0),d=O(""),f=O(""),p=O(""),h=O(!1),g=O(!1);const b=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let y=O([{id:"",name:"All Sections"}]);async function k(){v(c,!0);try{const Y=await da.get("/api/archived-students");if(!Y.students)throw new Error("No students data received");n=Y.students.map(ce=>({id:ce.id,name:ce.name,number:ce.number,email:ce.email,gradeLevel:ce.gradeLevel||"Not specified",section:ce.section||"Not specified",birthdate:ce.birthdate||"Not specified",address:ce.address||"Not specified",guardian:ce.guardian||"Not specified",contactNumber:ce.contactNumber||"Not specified",archivedDate:ce.archivedDate||"Not specified"})),T()}catch(Y){console.error("Error loading archived students:",Y),Se.error("Failed to load archived students. Please try again."),n=[]}finally{v(c,!1)}}async function A(){try{const Y=await da.get("/api/sections");if(Y.success&&Y.data){const ce=Y.data.map(De=>({id:De.name,name:De.name}));v(y,[{id:"",name:"All Sections"},...ce])}}catch(Y){console.error("Error loading sections:",Y)}}function T(){v(l,n.filter(Y=>{const ce=!e(d)||Y.name.toLowerCase().includes(e(d).toLowerCase())||Y.email.toLowerCase().includes(e(d).toLowerCase())||Y.number&&Y.number.toLowerCase().includes(e(d).toLowerCase()),De=!e(f)||Y.gradeLevel===e(f),U=!e(p)||Y.section===e(p);return ce&&De&&U}))}function C(){v(h,!e(h)),v(g,!1)}function D(){v(g,!e(g)),v(h,!1)}function S(Y){v(f,Y.id),v(h,!1),T()}function L(Y){v(p,Y.id),v(g,!1),T()}function F(Y){if(!Y)return"N/A";const ce=new Date,De=new Date(Y);let U=ce.getFullYear()-De.getFullYear();const ne=ce.getMonth()-De.getMonth();return(ne<0||ne===0&&ce.getDate()<De.getDate())&&U--,U}function j(Y){return Y?new Date(Y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function P(Y){return Y?new Date(Y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}async function Q(Y,ce){us.confirm("Restore Student",`Are you sure you want to restore ${ce}? This action will move the student back to the active list.`,async()=>{try{const De=await da.put("/api/archived-students",{id:Y});Se.success(De.message||"Student restored successfully"),await k()}catch(De){console.error("Error restoring student:",De),Se.error(De.message||"Failed to restore student. Please try again.")}},()=>{})}function W(){v(d,""),v(f,""),v(p,""),T()}function $(Y){Y.target.closest(".aas-custom-dropdown")||(v(h,!1),v(g,!1))}Ya(()=>(A(),k(),document.addEventListener("click",$),()=>{document.removeEventListener("click",$)})),_t(()=>e(f),()=>{v(a,b.find(Y=>Y.id===e(f)))}),_t(()=>(e(y),e(p)),()=>{v(r,e(y).find(Y=>Y.id===e(p)))}),_t(()=>e(d),()=>{e(d)!==void 0&&T()}),Rs(),Ls();var R=Lw(),X=u(o(R),2),se=o(X),V=o(se),re=o(V),me=u(o(re),2);aa(me);var je=u(me,2);{var de=Y=>{var ce=fw();ye("click",ce,()=>v(d,"")),m(Y,ce)};E(je,Y=>{e(d)&&Y(de)})}i(re),i(V);var ie=u(V,2),Pe=o(ie),Ve=u(o(Pe),2);let Ze;var ve=o(Ve),Ce=o(ve);{var Qe=Y=>{var ce=pw(),De=o(ce),U=o(De,!0);i(De);var ne=u(De,2),fe=o(ne,!0);i(ne),i(ce),q(()=>{w(U,(e(a),x(()=>e(a).icon))),w(fe,(e(a),x(()=>e(a).name)))}),m(Y,ce)},Xe=Y=>{var ce=mw();m(Y,ce)};E(Ce,Y=>{e(a)&&e(f)?Y(Qe):Y(Xe,!1)})}Bt(2),i(ve);var ze=u(ve,2);xt(ze,5,()=>b,Y=>Y.id,(Y,ce)=>{var De=hw();let U;var ne=o(De),fe=o(ne,!0);i(ne);var z=u(ne,2),B=o(z),I=o(B,!0);i(B),i(z),i(De),q(G=>{U=_e(De,1,"aas-dropdown-option",null,U,G),w(fe,(e(ce),x(()=>e(ce).icon))),w(I,(e(ce),x(()=>e(ce).name)))},[()=>({selected:e(f)===e(ce).id})]),ye("click",De,()=>S(e(ce))),m(Y,De)}),i(ze),i(Ve),i(Pe);var We=u(Pe,2),Te=u(o(We),2);let ue;var be=o(Te),ke=o(be);{var Fe=Y=>{var ce=gw(),De=o(ce),U=o(De,!0);i(De),i(ce),q(()=>w(U,(e(r),x(()=>e(r).name)))),m(Y,ce)},Re=Y=>{var ce=_w();m(Y,ce)};E(ke,Y=>{e(r)&&e(p)?Y(Fe):Y(Re,!1)})}Bt(2),i(be);var et=u(be,2);xt(et,5,()=>e(y),Y=>Y.id,(Y,ce)=>{var De=bw();let U;var ne=o(De),fe=o(ne),z=o(fe,!0);i(fe),i(ne),i(De),q(B=>{U=_e(De,1,"aas-dropdown-option",null,U,B),w(z,(e(ce),x(()=>e(ce).name)))},[()=>({selected:e(p)===e(ce).id})]),ye("click",De,()=>L(e(ce))),m(Y,De)}),i(et),i(Te),i(We);var $e=u(We,2);{var ot=Y=>{var ce=yw();ye("click",ce,W),m(Y,ce)};E($e,Y=>{(e(d)||e(f)||e(p))&&Y(ot)})}i(ie),i(se),i(X);var Me=u(X,2),it=o(Me);{var ft=Y=>{var ce=ww();m(Y,ce)},Ye=Y=>{var ce=mt(),De=Je(ce);{var U=fe=>{var z=Nw();xt(z,5,()=>e(l),B=>B.id,(B,I)=>{var G=Fw(),Z=o(G),le=o(Z),N=o(le),M=o(N);{var H=oe=>{var Ee=Sa();q(()=>w(Ee,(e(I),x(()=>e(I).number)))),m(oe,Ee)};E(M,oe=>{e(I),x(()=>e(I).number)&&oe(H)})}var pe=u(M);i(N);var ee=u(N,2),Ae=u(o(ee),2),Ue=o(Ae);i(Ae),i(ee),i(le);var Le=u(le,2),He=o(Le);i(Le),i(Z);var Ie=u(Z,2),nt=o(Ie);{var bt=oe=>{var Ee=xw(),dt=u(o(Ee),2),we=o(dt,!0);i(dt),i(Ee),q(()=>w(we,(e(I),x(()=>e(I).email)))),m(oe,Ee)};E(nt,oe=>{e(I),x(()=>e(I).email)&&oe(bt)})}var pt=u(nt,2);{var vt=oe=>{var Ee=Sw(),dt=u(o(Ee),2),we=o(dt,!0);i(dt),i(Ee),q(Oe=>w(we,Oe),[()=>(e(I),x(()=>b.find(Oe=>Oe.id===e(I).gradeLevel)?.name||e(I).gradeLevel))]),m(oe,Ee)};E(pt,oe=>{e(I),x(()=>e(I).gradeLevel&&e(I).gradeLevel!=="Not specified")&&oe(vt)})}var Tt=u(pt,2);{var Ot=oe=>{var Ee=kw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Section: ${Oe??""}`),[()=>(e(y),e(I),x(()=>e(y).find(Oe=>Oe.id===e(I).section)?.name||e(I).section))]),m(oe,Ee)};E(Tt,oe=>{e(I),x(()=>e(I).section&&e(I).section!=="Not specified")&&oe(Ot)})}var la=u(Tt,2);{var sa=oe=>{var Ee=Aw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Age: ${Oe??""} years old`),[()=>(e(I),x(()=>F(e(I).birthdate)))]),m(oe,Ee)};E(la,oe=>{e(I),x(()=>e(I).birthdate&&e(I).birthdate!=="Not specified")&&oe(sa)})}var zt=u(la,2);{var qt=oe=>{var Ee=Dw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Guardian: ${e(I),x(()=>e(I).guardian)??""}`)),m(oe,Ee)};E(zt,oe=>{e(I),x(()=>e(I).guardian&&e(I).guardian!=="Not specified")&&oe(qt)})}var Pt=u(zt,2);{var Yt=oe=>{var Ee=Cw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Contact: ${e(I),x(()=>e(I).contactNumber)??""}`)),m(oe,Ee)};E(Pt,oe=>{e(I),x(()=>e(I).contactNumber&&e(I).contactNumber!=="Not specified")&&oe(Yt)})}var Ut=u(Pt,2);{var Et=oe=>{var Ee=Tw(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(()=>w(we,`Address: ${e(I),x(()=>e(I).address)??""}`)),m(oe,Ee)};E(Ut,oe=>{e(I),x(()=>e(I).address&&e(I).address!=="Not specified")&&oe(Et)})}var ta=u(Ut,2);{var fa=oe=>{var Ee=Ew(),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee),q(Oe=>w(we,`Birthdate: ${Oe??""}`),[()=>(e(I),x(()=>j(e(I).birthdate)))]),m(oe,Ee)};E(ta,oe=>{e(I),x(()=>e(I).birthdate&&e(I).birthdate!=="Not specified")&&oe(fa)})}i(Ie),i(G),q(oe=>{w(pe,`  ${e(I),x(()=>e(I).name)??""}`),w(Ue,`Archived ${oe??""}`)},[()=>(e(I),x(()=>P(e(I).archivedDate)))]),ye("click",He,()=>Q(e(I).id,e(I).name)),m(B,G)}),i(z),m(fe,z)},ne=fe=>{var z=Pw(),B=o(z),I=o(B,!0);i(B);var G=u(B,2),Z=o(G);{var le=pe=>{var ee=Sa("No archived students found matching your search criteria.");m(pe,ee)},N=pe=>{var ee=Sa("No archived students found in the system.");m(pe,ee)};E(Z,pe=>{e(d)||e(f)||e(p)?pe(le):pe(N,!1)})}i(G);var M=u(G,2);{var H=pe=>{var ee=$w();ye("click",ee,W),m(pe,ee)};E(M,pe=>{(e(d)||e(f)||e(p))&&pe(H)})}i(z),q(()=>w(I,e(d)||e(f)||e(p)?"search_off":"archive")),m(fe,z)};E(De,fe=>{e(l),x(()=>e(l).length>0)?fe(U):fe(ne,!1)},!0)}m(Y,ce)};E(it,Y=>{e(c)?Y(ft):Y(Ye,!1)})}i(Me),i(R),q((Y,ce)=>{Ze=_e(Ve,1,"aas-custom-dropdown",null,Ze,Y),ue=_e(Te,1,"aas-custom-dropdown",null,ue,ce)},[()=>({open:e(h)}),()=>({open:e(g)})]),oa(me,()=>e(d),Y=>v(d,Y)),ye("click",ve,C),ye("click",be,D),m(s,R),za()}var Iw=_('<button type="button" class="sgl-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Rw=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),Ow=_('<span class="sgl-placeholder">Current Quarter</span>'),jw=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),qw=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),zw=_('<span class="sgl-placeholder">All Grade Levels</span>'),Gw=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Vw=_('<div class="sgl-selected-option"><span class="sgl-option-name"> </span></div>'),Bw=_('<span class="sgl-placeholder">All Sections</span>'),Ww=_('<button type="button"><div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Hw=_('<button type="button" class="sgl-clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Uw=_('<div class="sgl-masterlist-loading-container"><span class="sgl-student-loader"></span> <p class="sgl-masterlist-loading-text">Loading student grades...</p></div>'),Yw=_('<div class="sgl-empty-state"><span class="material-symbols-outlined sgl-empty-icon">search_off</span> <h3 class="sgl-empty-title">No students found</h3> <p class="sgl-empty-description"><!></p></div>'),Qw=_('<tr><td class="sgl-student-id"> </td><td class="sgl-student-name"> </td><td class="sgl-year-level"> </td><td class="sgl-section"> </td><td class="sgl-gwa"> </td></tr>'),Kw=_('<div class="sgl-results-header"><p class="sgl-results-count"> </p></div> <div class="sgl-table-container"><table class="sgl-students-table"><thead><tr><th>Student ID</th><th>Name</th><th>Grade Level</th><th>Section</th><th>GWA</th></tr></thead><tbody></tbody></table></div>',1),Jw=_('<div class="sgl-student-grades-container"><div class="sgl-admin-student-header"><div class="sgl-header-content"><h1 class="sgl-page-title">Student Grades List</h1> <p class="sgl-page-subtitle">View and manage student academic performance records</p></div></div> <div class="sgl-filters-section"><div class="sgl-search-filter-container"><div class="sgl-search-container"><div class="sgl-search-input-wrapper"><span class="material-symbols-outlined sgl-search-icon">search</span> <input type="text" class="sgl-search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="sgl-filter-container"><div class="sgl-filter-group"><label class="sgl-filter-label" for="quarter-dropdown">Quarter</label> <div><button type="button" id="quarter-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label" for="grades-grade-level-dropdown">Grade Level</label> <div><button type="button" id="grades-grade-level-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label" for="grades-section-dropdown">Section</label> <div><button type="button" id="grades-section-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <!></div></div></div> <div class="sgl-results-section"><!></div></div>');function Xw(s,t){qa(t,!1);const a=O(),r=O(),n=O();let l=O([]),c=O([]),d=[],f=O(!0),p=O(""),h=O(""),g=O(""),b=O(""),y=O(!1),k=O(!1),A=O(!1);const T=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}],C=[{id:"",name:"Current Quarter",icon:"event"},{id:"all",name:"Overall (All Quarters)",icon:"summarize"},{id:"1",name:"1st Quarter",icon:"filter_1"},{id:"2",name:"2nd Quarter",icon:"filter_2"},{id:"3",name:"3rd Quarter",icon:"filter_3"},{id:"4",name:"4th Quarter",icon:"filter_4"}];let D=O([{id:"",name:"All Sections"}]);async function S(){try{const M=await da.get("/api/sections");if(M.success){d=M.data||[];const H=d.filter(pe=>pe.status==="active");v(D,[{id:"",name:"All Sections"},...H.map(pe=>({id:pe.name,name:`Grade ${pe.grade_level}  ${pe.name}`}))])}}catch(M){console.error("Error loading sections:",M),Se.error("Failed to load sections")}}async function L(){v(f,!0);try{const M=new URLSearchParams;e(b)&&M.append("quarter",e(b));const H=`/api/students-bulk${M.toString()?"?"+M.toString():""}`,pe=await da.get(H);if(!pe.success)throw new Error(pe.error||"Failed to load students");v(l,pe.students||[]),F()}catch(M){console.error("Error loading students:",M),Se.error("Failed to load students. Please try again."),v(l,[])}finally{v(f,!1)}}function F(){v(c,e(l).filter(M=>{const H=!e(p)||M.name.toLowerCase().includes(e(p).toLowerCase())||M.id.toString().toLowerCase().includes(e(p).toLowerCase()),pe=!e(h)||M.gradeLevel===e(h),ee=!e(g)||M.section===e(g);return H&&pe&&ee}))}function j(){v(y,!e(y)),v(k,!1),v(A,!1)}function P(){v(k,!e(k)),v(y,!1),v(A,!1)}function Q(){v(A,!e(A)),v(y,!1),v(k,!1)}function W(M){v(h,M.id),v(y,!1),F()}function $(M){v(g,M.id),v(k,!1),F()}function R(M){v(b,M.id),v(A,!1),L()}function X(){F()}function se(){v(p,""),v(h,""),v(g,""),v(b,""),L()}function V(M){return{7:"Grade 7",8:"Grade 8",9:"Grade 9",10:"Grade 10"}[M]||M}function re(M){M.target.closest(".sgl-custom-dropdown")||(v(y,!1),v(k,!1),v(A,!1))}Ya(async()=>(await S(),await L(),document.addEventListener("click",re),()=>{document.removeEventListener("click",re)})),_t(()=>e(h),()=>{v(a,T.find(M=>M.id===e(h)))}),_t(()=>(e(D),e(g)),()=>{v(r,e(D).find(M=>M.id===e(g)))}),_t(()=>e(b),()=>{v(n,C.find(M=>M.id===e(b)))}),_t(()=>e(p),()=>{e(p)!==void 0&&X()}),Rs(),Ls();var me=Jw(),je=u(o(me),2),de=o(je),ie=o(de),Pe=o(ie),Ve=u(o(Pe),2);aa(Ve);var Ze=u(Ve,2);{var ve=M=>{var H=Iw();ye("click",H,()=>v(p,"")),m(M,H)};E(Ze,M=>{e(p)&&M(ve)})}i(Pe),i(ie);var Ce=u(ie,2),Qe=o(Ce),Xe=u(o(Qe),2);let ze;var We=o(Xe),Te=o(We);{var ue=M=>{var H=Rw(),pe=o(H),ee=o(pe,!0);i(pe);var Ae=u(pe,2),Ue=o(Ae,!0);i(Ae),i(H),q(()=>{w(ee,(e(n),x(()=>e(n).icon))),w(Ue,(e(n),x(()=>e(n).name)))}),m(M,H)},be=M=>{var H=Ow();m(M,H)};E(Te,M=>{e(n)?M(ue):M(be,!1)})}Bt(2),i(We);var ke=u(We,2);xt(ke,5,()=>C,M=>M.id,(M,H)=>{var pe=jw();let ee;var Ae=o(pe),Ue=o(Ae,!0);i(Ae);var Le=u(Ae,2),He=o(Le),Ie=o(He,!0);i(He),i(Le),i(pe),q(nt=>{ee=_e(pe,1,"sgl-dropdown-option",null,ee,nt),w(Ue,(e(H),x(()=>e(H).icon))),w(Ie,(e(H),x(()=>e(H).name)))},[()=>({selected:e(b)===e(H).id})]),ye("click",pe,()=>R(e(H))),m(M,pe)}),i(ke),i(Xe),i(Qe);var Fe=u(Qe,2),Re=u(o(Fe),2);let et;var $e=o(Re),ot=o($e);{var Me=M=>{var H=qw(),pe=o(H),ee=o(pe,!0);i(pe);var Ae=u(pe,2),Ue=o(Ae,!0);i(Ae),i(H),q(()=>{w(ee,(e(a),x(()=>e(a).icon))),w(Ue,(e(a),x(()=>e(a).name)))}),m(M,H)},it=M=>{var H=zw();m(M,H)};E(ot,M=>{e(a)&&e(h)?M(Me):M(it,!1)})}Bt(2),i($e);var ft=u($e,2);xt(ft,5,()=>T,M=>M.id,(M,H)=>{var pe=Gw();let ee;var Ae=o(pe),Ue=o(Ae,!0);i(Ae);var Le=u(Ae,2),He=o(Le),Ie=o(He,!0);i(He),i(Le),i(pe),q(nt=>{ee=_e(pe,1,"sgl-dropdown-option",null,ee,nt),w(Ue,(e(H),x(()=>e(H).icon))),w(Ie,(e(H),x(()=>e(H).name)))},[()=>({selected:e(h)===e(H).id})]),ye("click",pe,()=>W(e(H))),m(M,pe)}),i(ft),i(Re),i(Fe);var Ye=u(Fe,2),Y=u(o(Ye),2);let ce;var De=o(Y),U=o(De);{var ne=M=>{var H=Vw(),pe=o(H),ee=o(pe,!0);i(pe),i(H),q(()=>w(ee,(e(r),x(()=>e(r).name)))),m(M,H)},fe=M=>{var H=Bw();m(M,H)};E(U,M=>{e(r)&&e(g)?M(ne):M(fe,!1)})}Bt(2),i(De);var z=u(De,2);xt(z,5,()=>e(D),M=>M.id,(M,H)=>{var pe=Ww();let ee;var Ae=o(pe),Ue=o(Ae),Le=o(Ue,!0);i(Ue),i(Ae),i(pe),q(He=>{ee=_e(pe,1,"sgl-dropdown-option",null,ee,He),w(Le,(e(H),x(()=>e(H).name)))},[()=>({selected:e(g)===e(H).id})]),ye("click",pe,()=>$(e(H))),m(M,pe)}),i(z),i(Y),i(Ye);var B=u(Ye,2);{var I=M=>{var H=Hw();ye("click",H,se),m(M,H)};E(B,M=>{(e(p)||e(h)||e(g)||e(b))&&M(I)})}i(Ce),i(de),i(je);var G=u(je,2),Z=o(G);{var le=M=>{var H=Uw();m(M,H)},N=M=>{var H=mt(),pe=Je(H);{var ee=Ue=>{var Le=Yw(),He=u(o(Le),4),Ie=o(He);{var nt=pt=>{var vt=Sa("Try adjusting your search criteria or filters.");m(pt,vt)},bt=pt=>{var vt=Sa("No student records are available at the moment.");m(pt,vt)};E(Ie,pt=>{e(p)||e(h)||e(g)?pt(nt):pt(bt,!1)})}i(He),i(Le),m(Ue,Le)},Ae=Ue=>{var Le=Kw(),He=Je(Le),Ie=o(He),nt=o(Ie);i(Ie),i(He);var bt=u(He,2),pt=o(bt),vt=u(o(pt));xt(vt,5,()=>e(c),Tt=>Tt.id,(Tt,Ot)=>{var la=Qw();let sa;var zt=o(la),qt=o(zt,!0);i(zt);var Pt=u(zt),Yt=o(Pt,!0);i(Pt);var Ut=u(Pt),Et=o(Ut,!0);i(Ut);var ta=u(Ut),fa=o(ta,!0);i(ta);var oe=u(ta),Ee=o(oe,!0);i(oe),i(la),q((dt,we)=>{sa=_e(la,1,"sgl-student-row",null,sa,dt),w(qt,(e(Ot),x(()=>e(Ot).id))),w(Yt,(e(Ot),x(()=>e(Ot).name))),w(Et,we),w(fa,(e(Ot),x(()=>e(Ot).section))),w(Ee,(e(Ot),x(()=>e(Ot).gwa)))},[()=>({"low-gwa":e(Ot).gwa<75}),()=>(e(Ot),x(()=>V(e(Ot).gradeLevel)))]),m(Tt,la)}),i(vt),i(pt),i(bt),q(()=>w(nt,`Showing ${e(c),x(()=>e(c).length)??""} of ${e(l),x(()=>e(l).length)??""} students`)),m(Ue,Le)};E(pe,Ue=>{e(c),x(()=>e(c).length===0)?Ue(ee):Ue(Ae,!1)},!0)}m(M,H)};E(Z,M=>{e(f)?M(le):M(N,!1)})}i(G),i(me),q((M,H,pe)=>{ze=_e(Xe,1,"sgl-custom-dropdown",null,ze,M),et=_e(Re,1,"sgl-custom-dropdown",null,et,H),ce=_e(Y,1,"sgl-custom-dropdown",null,ce,pe)},[()=>({open:e(A)}),()=>({open:e(y)}),()=>({open:e(k)})]),oa(Ve,()=>e(p),M=>v(p,M)),ye("click",We,Q),ye("click",$e,j),ye("click",De,P),m(s,me),za()}var Zw=_('<label class="time-input-label svelte-rxn8x9"> </label>'),ex=_('<span class="time-display svelte-rxn8x9"> </span>'),tx=_('<span class="time-placeholder svelte-rxn8x9"> </span>'),ax=_('<button type="button"> </button>'),sx=_('<button type="button"> </button>'),rx=_('<button type="button"> </button>'),ix=_('<div class="time-dropdown-menu svelte-rxn8x9"><div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Hour</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Minute</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Period</div> <div class="time-options svelte-rxn8x9"></div></div></div>'),nx=_('<div class="time-input-container svelte-rxn8x9"><!> <button type="button"><!> <span class="material-symbols-outlined time-dropdown-arrow svelte-rxn8x9">expand_more</span></button> <!></div>');function Cc(s,t){qa(t,!1);const a=O();let r=Ma(t,"value",8,""),n=Ma(t,"placeholder",8,"Select time"),l=Ma(t,"disabled",8,!1),c=Ma(t,"label",8,""),d=Ma(t,"isOpen",12,!1);const f=Kd(),p=`time-input-${Math.random().toString(36).substr(2,9)}`;let h=O(""),g=O(""),b=O("AM");const y=Array.from({length:12},(de,ie)=>{const Pe=ie+1;return{value:Pe.toString().padStart(2,"0"),label:Pe.toString()}}),k=[{value:"00",label:"00"},{value:"15",label:"15"},{value:"30",label:"30"},{value:"45",label:"45"}],A=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}];function T(de){if(!de){v(h,""),v(g,""),v(b,"AM");return}const ie=de.split(":");let Pe=parseInt(ie[0]);const Ve=ie[1]||"00";Pe===0?(v(h,"12"),v(b,"AM")):Pe<12?(v(h,Pe.toString().padStart(2,"0")),v(b,"AM")):Pe===12?(v(h,"12"),v(b,"PM")):(v(h,(Pe-12).toString().padStart(2,"0")),v(b,"PM")),v(g,Ve)}function C(){if(!e(h)||!e(g))return"";let de=parseInt(e(h));return e(b)==="AM"&&de===12?de=0:e(b)==="PM"&&de!==12&&(de+=12),`${de.toString().padStart(2,"0")}:${e(g)}`}function D(){const de=C();de!==r()&&f("change",{value:de})}function S(de){v(h,de),D()}function L(de){v(g,de),D()}function F(de){v(b,de),D()}function j(){l()||(d(!d()),d()&&f("open"))}function P(de){de.target.closest(".time-input-container")||d(!1)}_t(()=>xs(r()),()=>{r()&&r()!==C()&&T(r())}),_t(()=>(e(h),e(g),e(b)),()=>{v(a,e(h)&&e(g)?`${e(h)}:${e(g)} ${e(b)}`:"")}),Rs(),Ls();var Q=nx();ye("click",Zs,P);var W=o(Q);{var $=de=>{var ie=Zw(),Pe=o(ie,!0);i(ie),q(()=>{$t(ie,"for",p),w(Pe,c())}),m(de,ie)};E(W,de=>{c()&&de($)})}var R=u(W,2);let X;var se=o(R);{var V=de=>{var ie=ex(),Pe=o(ie,!0);i(ie),q(()=>w(Pe,e(a))),m(de,ie)},re=de=>{var ie=tx(),Pe=o(ie,!0);i(ie),q(()=>w(Pe,n())),m(de,ie)};E(se,de=>{e(a)?de(V):de(re,!1)})}Bt(2),i(R);var me=u(R,2);{var je=de=>{var ie=ix(),Pe=o(ie),Ve=u(o(Pe),2);xt(Ve,5,()=>y,Ua,(Xe,ze)=>{var We=ax();let Te;var ue=o(We,!0);i(We),q(be=>{Te=_e(We,1,"time-option svelte-rxn8x9",null,Te,be),w(ue,(e(ze),x(()=>e(ze).label)))},[()=>({selected:e(h)===e(ze).value})]),ye("click",We,()=>S(e(ze).value)),m(Xe,We)}),i(Ve),i(Pe);var Ze=u(Pe,2),ve=u(o(Ze),2);xt(ve,5,()=>k,Ua,(Xe,ze)=>{var We=sx();let Te;var ue=o(We,!0);i(We),q(be=>{Te=_e(We,1,"time-option svelte-rxn8x9",null,Te,be),w(ue,(e(ze),x(()=>e(ze).label)))},[()=>({selected:e(g)===e(ze).value})]),ye("click",We,()=>L(e(ze).value)),m(Xe,We)}),i(ve),i(Ze);var Ce=u(Ze,2),Qe=u(o(Ce),2);xt(Qe,5,()=>A,Ua,(Xe,ze)=>{var We=rx();let Te;var ue=o(We,!0);i(We),q(be=>{Te=_e(We,1,"time-option svelte-rxn8x9",null,Te,be),w(ue,(e(ze),x(()=>e(ze).label)))},[()=>({selected:e(b)===e(ze).value})]),ye("click",We,()=>F(e(ze).value)),m(Xe,We)}),i(Qe),i(Ce),i(ie),m(de,ie)};E(me,de=>{d()&&de(je)})}i(Q),q(de=>{$t(R,"id",p),X=_e(R,1,"time-input-trigger svelte-rxn8x9",null,X,de),R.disabled=l()},[()=>({open:d(),selected:e(a),disabled:l()})]),ye("click",R,j),m(s,Q),za()}var ox=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span></div></div>'),lx=_('<span class="placeholder">Select year level</span>'),cx=_('<button type="button"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),dx=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span></div></div>'),ux=_('<span class="placeholder"> </span>'),vx=_('<div class="admin-section-loading"><span class="section-loader"></span> <span>Loading sections...</span></div>'),fx=_('<button type="button"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),px=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text">No sections available</span></div>'),mx=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon"> </span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),hx=_('<span class="scheduleassign-placeholder">Select Schedule Type</span>'),gx=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),_x=_('<span class="scheduleassign-placeholder">Select Subject</span>'),bx=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading subjects...</span></div>'),yx=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),wx=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text"> </span></div>'),xx=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-subject-dropdown">Subject</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-subject-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search subjects..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div>'),Sx=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),kx=_('<span class="scheduleassign-placeholder">Select Activity Type</span>'),Ax=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading activity types...</span></div>'),Dx=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),Cx=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No activity types available</span></div>'),Tx=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-activity-dropdown">Activity Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-activity-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),Ex=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),Fx=_('<span class="scheduleassign-placeholder">Select Teacher</span>'),Nx=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading teachers...</span></div>'),$x=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),Px=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text"> </span></div>'),Lx=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-teacher-dropdown">Teacher</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-teacher-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search teachers..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div>'),Mx=_('<div class="scheduleassign-time-error"><span class="material-symbols-outlined">error</span> <span> </span></div>'),Ix=_('<div class="scheduleassign-time-duration"><span class="material-symbols-outlined">schedule</span> <span> </span></div>'),Rx=_('<label class="scheduleassign-day-checkbox"><input type="checkbox"/> <span class="scheduleassign-checkbox-label"> </span></label>'),Ox=_('<div class="scheduleassign-add-form" id="addScheduleForm"><h4 class="scheduleassign-form-title">Add New Schedule</h4> <div class="scheduleassign-form-inputs"><div class="scheduleassign-type-subject-row"><div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-schedule-type-dropdown">Schedule Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-schedule-type-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Subject</span></div></button> <button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Activity</span></div></button></div></div></div> <!> <!></div> <div class="scheduleassign-time-section"><div class="scheduleassign-time-row"><div class="scheduleassign-input-group"><!></div> <div class="scheduleassign-input-group"><!></div></div> <div class="scheduleassign-time-info-container"><!></div> <div class="scheduleassign-day-selection-section"><div class="scheduleassign-day-checkboxes"></div></div></div></div> <div class="scheduleassign-form-actions"><button type="button"><span class="material-symbols-outlined"> </span> <!></button></div></div>'),jx=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">person</span> <span class="scheduleassign-detail-text"> </span></div>'),qx=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">schedule</span> <span class="scheduleassign-detail-text"> </span></div>'),zx=_('<span class="scheduleassign-room-details"> </span>'),Gx=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">location_on</span> <span class="scheduleassign-detail-text"> <!></span></div>'),Vx=_('<div class="scheduleassign-assignment-card"><div class="scheduleassign-assignment-header"><div class="scheduleassign-assignment-info"><h4 class="scheduleassign-assignment-title"> </h4> <p class="scheduleassign-assignment-subtitle"> </p></div> <div class="scheduleassign-assignment-actions"><button type="button" class="scheduleassign-delete-button" title="Delete assignment"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="scheduleassign-assignment-details"><!> <!> <!></div></div>'),Bx=_('<div class="scheduleassign-empty-day"><span class="material-symbols-outlined empty-icon">event_available</span> <span class="empty-text">No schedules</span></div>'),Wx=_('<div class="scheduleassign-day-column"><div class="scheduleassign-day-header"><span class="day-name"> </span></div> <div class="scheduleassign-day-schedules"><!></div></div>'),Hx=_('<div class="scheduleassign-schedule-grid"><div class="scheduleassign-schedule-actions"><a href="#addScheduleForm" class="scheduleassign-add-schedule-link"><button type="button"><span class="material-symbols-outlined"> </span> </button></a></div> <!> <div class="scheduleassign-days-grid"></div></div>'),Ux=_('<div class="scheduleassign-empty-state-main"><span class="material-symbols-outlined empty-icon">calendar_month</span> <h3>Select Year Level and Section</h3> <p>Choose a year level and section to view the weekly schedule.</p></div>'),Yx=_('<div class="scheduleassign-form-section"><div class="scheduleassign-section-header"><h2 class="admin-section-title">Schedule Management</h2> <p class="scheduleassign-form-instruction">Select year level and section to view all schedule assignments.</p></div> <form><div class="scheduleassign-hierarchical-form"><div class="scheduleassign-selection-row"><div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-year">Year Level *</label> <div><button type="button" id="form-year"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"></div></div></div> <div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-section">Section *</label> <div><button type="button" id="form-section"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search sections..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div></div> <!></div></form></div>');function Qx(s,t){qa(t,!1);const a=O(),r=O(),n=O(),l=O(),c=O(),d=O(),f=O(),p=O(),h=O(),g=[];let b=O(""),y=O(""),k=O(!1),A=O(!1),T=O(""),C=O(""),D=O(""),S=O(!1);const L=[{id:"grade-7",name:"Grade 7",description:"Junior High School - First Year"},{id:"grade-8",name:"Grade 8",description:"Junior High School - Second Year"},{id:"grade-9",name:"Grade 9",description:"Junior High School - Third Year"},{id:"grade-10",name:"Grade 10",description:"Junior High School - Fourth Year"}],F=[{id:"monday",name:"Monday"},{id:"tuesday",name:"Tuesday"},{id:"wednesday",name:"Wednesday"},{id:"thursday",name:"Thursday"},{id:"friday",name:"Friday"}];let j=O([]),P="2024-2025";async function Q(){try{const te=await(await fetch("/api/current-quarter")).json();te.success&&te.data?(P=te.data.currentSchoolYear,console.log(`School year set to: ${P}`)):console.warn("Failed to fetch current school year, using default: 2024-2025")}catch(ge){console.error("Error fetching current school year:",ge)}}async function W(){v(S,!0);try{const te=await(await ns("/api/sections?action=available-sections")).json();te.success&&v(j,te.data.map(J=>({id:J._id,name:J.name,grade:`Grade ${J.grade_level}`,year:`grade-${J.grade_level}`,grade_level:J.grade_level,school_year:J.school_year,status:J.status})))}catch(ge){console.error("Error loading sections:",ge)}finally{v(S,!1)}}let $=O([]),R=O(!1),X=O(!1),se=O([]),V=O({startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""}),re=O([]),me=O([]),je=O([]),de=O(!1),ie=O(!1),Pe=O(!1),Ve=O(!1),Ze=O(!1),ve=O(!1),Ce=O(!1),Qe=O(!1),Xe=O(!1),ze=O(""),We=O(""),Te=O(""),ue=O(!1),be=O([]);function ke(){const ge=e(V).startTime,te=e(V).endTime;if(!ge||!te){v(ze,""),v(We,"");return}const J=Fe(ge),Be=Fe(te);if(Be<=J)v(ze,"End time must be after start time"),v(We,"");else{v(ze,"");const Ge=Be-J,at=Math.floor(Ge/60),gt=Ge%60;at>0&&gt>0?v(We,`${at} hour${at>1?"s":""} and ${gt} minute${gt>1?"s":""}`):at>0?v(We,`${at} hour${at>1?"s":""}`):v(We,`${gt} minute${gt>1?"s":""}`)}}function Fe(ge){const[te,J]=ge.split(":").map(Number);return te*60+J}let Re;function et(ge,te){clearTimeout(Re),Re=setTimeout(ge,te)}async function $e(){et(async()=>{if(!(!e(y)||!e(V).startTime||!e(V).endTime||e(se).length===0)){v(ue,!1),v(be,[]),v(Te,"");try{const ge=e(se).map(async Ge=>{const at=F.find(ht=>ht.id===Ge)?.name.toLowerCase(),gt=new URLSearchParams({action:"check-conflicts",sectionId:e(y),dayOfWeek:at,startTime:e(V).startTime,endTime:e(V).endTime,schoolYear:P});e(V).teacherId&&e(V).scheduleType==="subject"&&gt.append("teacherId",e(V).teacherId);const _a=await(await ns(`/api/schedules?${gt}`)).json();return{day:at,dayDisplay:F.find(ht=>ht.id===Ge)?.name,..._a}}),te=await Promise.all(ge),J=[],Be=[];if(te.forEach(Ge=>{Ge.hasConflicts&&(Be.push(Ge.dayDisplay),Ge.conflicts.forEach(at=>{J.push({...at,day:Ge.dayDisplay})}))}),J.length>0){v(ue,!0),v(be,J);const Ge=J.filter(Gt=>Gt.type==="teacher_conflict"),at=J.filter(Gt=>Gt.type==="section_conflict");if(Ge.length===1)Se.error(Ge[0].message,6e3);else if(Ge.length>1){const Gt=[...new Set(Ge.map(ht=>ht.day))],_a=Ge[0].details?.teacher_name||"Selected teacher";Se.error(`${_a} has schedule conflicts on ${Gt.join(", ")}. Please choose different times or another teacher.`,8e3)}if(at.length===1)Se.error(at[0].message,6e3);else if(at.length>1){const Gt=[...new Set(at.map(_a=>_a.day))];Se.error(`Time conflicts detected for this section on ${Gt.join(", ")}. Please choose different time slots.`,6e3)}let gt=[];Ge.length>0&&gt.push(`Teacher conflicts detected on ${[...new Set(Ge.map(Gt=>Gt.day))].join(", ")}`),at.length>0&&gt.push(`Section time conflicts detected on ${[...new Set(at.map(Gt=>Gt.day))].join(", ")}`),v(Te,gt.join(". "))}else v(ue,!1),v(Te,"")}catch(ge){console.error("Error checking conflicts:",ge),Se.error("Error checking for conflicts. Please try again."),v(ue,!1)}finally{}}},500)}function ot(ge){if(!ge)return 0;const[te,J]=ge.split(" "),[Be,Ge]=te.split(":").map(Number);let at=Ge;return J==="PM"&&Be!==12?at+=(Be+12)*60:J==="AM"&&Be===12?at+=0:at+=Be*60,at}function Me(ge){ge.target.closest(".scheduleassign-custom-dropdown")||(v(k,!1),v(A,!1),v(Ve,!1),v(Ze,!1),v(ve,!1),v(Ce,!1)),ge.target.closest(".time-input-container")||(v(Qe,!1),v(Xe,!1))}function it(){v(k,!e(k))}function ft(){e(b)&&v(A,!e(A))}function Ye(ge){v(b,ge?ge.id:""),v(y,""),v(k,!1)}function Y(ge){v(y,ge?ge.id:""),v(A,!1),v(re,[]),Fs(V,e(V).subjectId="")}function ce(ge){if(!ge)return"";const te=ge.split(":");let J=parseInt(te[0]);const Be=te[1],Ge=J>=12?"PM":"AM";J=J%12,J=J||12;const at=Be.startsWith("0")&&Be!=="00"?Be.substring(1):Be;return at==="00"?`${J}:00 ${Ge}`:`${J}:${at} ${Ge}`}async function De(){try{const te=await(await ns("/api/schedules")).json();te.success?v($,te.data.map(J=>({id:J.id,year:`grade-${J.grade_level}`,grade:`Grade ${J.grade_level}`,section:J.section_name,day:J.day_of_week.charAt(0).toUpperCase()+J.day_of_week.slice(1),time:`${ce(J.start_time)} - ${ce(J.end_time)}`,subject:J.subject_name||J.activity_type_name,teacher:J.teacher_name,type:J.schedule_type,startTime:ce(J.start_time),endTime:ce(J.end_time),subjectId:J.subject_id,activityTypeId:J.activity_type_id,teacherId:J.teacher_id,sectionId:J.section_id,schoolYear:J.school_year,roomId:J.room_id,roomName:J.room_name,roomBuilding:J.room_building,roomFloor:J.room_floor}))):console.error("Failed to load schedules:",te.error)}catch(ge){console.error("Error loading schedules:",ge)}}async function U(ge){us.confirm("Delete Assignment","<p>Are you sure you want to delete this schedule assignment?</p>",async()=>{try{const te=await da.delete(`/api/schedules?id=${ge.id}`);te.success?(v($,e($).filter(J=>J.id!==ge.id)),v($,[...e($)]),setTimeout(()=>He(),0),Se.success(`Assignment for ${ge.subject} has been deleted successfully`)):Se.error(te.error||"Failed to delete assignment")}catch(te){console.error("Error deleting assignment:",te),Se.error("Failed to delete assignment. Please try again.")}},()=>{})}function ne(){v(R,!e(R)),e(R)||fe()}function fe(){v(se,[]),v(V,{startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""})}function z(){v(Ve,!e(Ve))}function B(){v(Ze,!e(Ze))}function I(){v(ve,!e(ve))}function G(){v(Ce,!e(Ce))}function Z(){v(Qe,!0),v(Xe,!1)}function le(){v(Xe,!0),v(Qe,!1)}function N(ge){const te=e(V).subjectId;if(Fs(V,e(V).subjectId=ge.id),v(Ve,!1),v(C,""),te!==ge.id&&e(V).teacherId){const J=e(je).find(Be=>Be.id===e(V).teacherId);J&&J.department_id!==ge.department_id&&Fs(V,e(V).teacherId="")}}function M(ge){Fs(V,e(V).activityTypeId=ge.id),v(Ze,!1)}function H(ge){Fs(V,e(V).teacherId=ge.id),v(ve,!1),v(D,"")}function pe(ge){Fs(V,e(V).scheduleType=ge),v(Ce,!1),ge==="subject"?Fs(V,e(V).activityTypeId=null):Fs(V,e(V).subjectId=null)}async function ee(){if(!(e(re).length>0)){v(de,!0);try{const ge=e(j).find(at=>at.id===e(y)),te=ge?ge.grade_level:"",J=te?`/api/subjects?action=available-subjects&grade_level=${te}`:"/api/subjects?action=available-subjects",Ge=await(await ns(J)).json();Ge.success&&v(re,Ge.data)}catch(ge){console.error("Error loading subjects:",ge)}finally{v(de,!1)}}}async function Ae(){if(!(e(me).length>0)){v(ie,!0);try{const te=await(await ns("/api/activity-types?action=available-activity-types")).json();te.success&&v(me,te.data)}catch(ge){console.error("Error loading activity types:",ge)}finally{v(ie,!1)}}}async function Ue(){if(!(e(je).length>0)){v(Pe,!0);try{const te=await(await ns("/api/users?action=teachers")).json();te.success&&v(je,te.data)}catch(ge){console.error("Error loading teachers:",ge)}finally{v(Pe,!1)}}}async function Le(){if(!e(y)||e(se).length===0){Se.error("Please select a section and at least one day");return}if(!e(V).startTime||!e(V).endTime){Se.error("Please enter start and end times");return}if(e(V).scheduleType==="subject"&&!e(V).subjectId){Se.error("Please select a subject");return}if(e(V).scheduleType==="activity"&&!e(V).activityTypeId){Se.error("Please select an activity type");return}v(X,!0);try{const ge=e(se).map(async Ge=>{const at=F.find(gt=>gt.id===Ge)?.name.toLowerCase();try{const gt=await ns("/api/schedules",{method:"POST",body:JSON.stringify({sectionId:e(y),dayOfWeek:at,startTime:e(V).startTime,endTime:e(V).endTime,scheduleType:e(V).scheduleType,subjectId:e(V).scheduleType==="subject"?e(V).subjectId:null,activityTypeId:e(V).scheduleType==="activity"?e(V).activityTypeId:null,teacherId:e(V).teacherId||null,schoolYear:P})}),Gt=await gt.json();return gt.ok?Gt:{success:!1,error:Gt.error||"Failed to create schedule",conflictType:Gt.conflictType,conflictingSchedule:Gt.conflictingSchedule}}catch(gt){return console.error("API Error:",gt),{success:!1,error:gt.message||"Failed to create schedule"}}}),te=await Promise.all(ge),J=te.filter(Ge=>!Ge.success),Be=te.filter(Ge=>Ge.success);if(Be.length>0&&await De(),J.length===0)Se.success(`Schedule added successfully for ${e(se).length} day(s)`),fe(),v(R,!1);else{Be.length>0&&Se.success(`Schedule added successfully for ${Be.length} day(s)`);const Ge=J.filter(gt=>gt.conflictType==="teacher_conflict"),at=J.filter(gt=>gt.conflictType!=="teacher_conflict");Ge.length>0&&Ge.forEach(gt=>{Se.error(gt.error,8e3)}),at.length>0&&Se.error(`Failed to add schedule for ${at.length} day(s) due to time conflicts`),J.length>Ge.length+at.length&&Se.error(`Failed to add schedule for ${J.length-Ge.length-at.length} day(s)`)}}catch(ge){console.error("Error submitting schedule:",ge),Se.error("Failed to add schedule. Please try again.")}finally{v(X,!1)}}Ya(async()=>{await Q(),W(),De()}),Jd(()=>{He()});function He(){if(!e(b)||!e(y))return;const ge=document.querySelectorAll(".scheduleassign-day-column");if(ge.length===0)return;let te=0;ge.forEach(J=>{const Be=J.querySelector(".scheduleassign-day-schedules");if(Be){const Ge=Be.scrollHeight;te=Math.max(te,Ge)}}),ge.forEach(J=>{const Be=J.querySelector(".scheduleassign-empty-day"),Ge=J.querySelector(".scheduleassign-day-schedules");Be&&Ge&&(Ge.children.length>1||Ge.children.length===1&&!Ge.querySelector(".scheduleassign-empty-day")||(Be.style.minHeight=`${te}px`))})}_t(()=>e(V),()=>{e(V).startTime&&e(V).endTime?ke():(v(ze,""),v(We,""))}),_t(()=>(e(y),e(V),e(se)),()=>{e(y)&&e(V).startTime&&e(V).endTime&&e(se).length>0?$e():(v(Te,""),v(ue,!1),v(be,[]))}),_t(()=>(e(b),e(j)),()=>{v(a,e(b)?e(j).filter(ge=>ge.year===e(b)):[])}),_t(()=>(e(a),e(T)),()=>{v(r,e(a).filter(ge=>ge.name.toLowerCase().includes(e(T).toLowerCase())||ge.grade.toLowerCase().includes(e(T).toLowerCase())))}),_t(()=>(e(re),e(C)),()=>{v(n,e(re).filter(ge=>ge.name?.toLowerCase().includes(e(C).toLowerCase())||ge.description?.toLowerCase().includes(e(C).toLowerCase())))}),_t(()=>(e(je),e(V),e(re),e(D)),()=>{v(l,e(je).filter(ge=>{if(e(V).subjectId){const gt=e(re).find(Gt=>Gt.id===e(V).subjectId);if(gt&&gt.department_id&&ge.department_id!==gt.department_id)return!1}const te=e(D).toLowerCase(),J=ge.full_name?.toLowerCase()||"",Be=ge.first_name?.toLowerCase()||"",Ge=ge.last_name?.toLowerCase()||"",at=ge.email?.toLowerCase()||"";return J.includes(te)||Be.includes(te)||Ge.includes(te)||at.includes(te)}))}),_t(()=>e(b),()=>{v(c,L.find(ge=>ge.id===e(b)))}),_t(()=>(e(j),e(y)),()=>{v(d,e(j).find(ge=>ge.id===e(y)))}),_t(()=>(e($),e(b),e(y),e(d)),()=>{v(f,F.reduce((ge,te)=>(ge[te.id]=e($).filter(J=>{if(!e(b)||!e(y))return!1;const Be=J.year===e(b),Ge=J.section===e(d)?.name,at=J.day===te.name;return Be&&Ge&&at}).sort((J,Be)=>{const Ge=ot(J.startTime),at=ot(Be.startTime);return Ge-at}),ge),{}))}),_t(()=>e(b),()=>{v(p,!!e(b))}),_t(()=>e(y),()=>{v(h,!!e(y))}),_t(()=>e(R),()=>{e(R)&&(ee(),Ae(),Ue())}),Rs(),Ls();var Ie=Yx();ye("click",Zs,Me);var nt=u(o(Ie),2),bt=o(nt),pt=o(bt),vt=o(pt),Tt=u(o(vt),2);let Ot;var la=o(Tt);let sa;var zt=o(la);{var qt=ge=>{var te=ox(),J=u(o(te),2),Be=o(J),Ge=o(Be,!0);i(Be),i(J),i(te),q(()=>w(Ge,(e(c),x(()=>e(c).name)))),m(ge,te)},Pt=ge=>{var te=lx();m(ge,te)};E(zt,ge=>{e(c)?ge(qt):ge(Pt,!1)})}Bt(2),i(la);var Yt=u(la,2);xt(Yt,5,()=>L,ge=>ge.id,(ge,te)=>{var J=cx();let Be;var Ge=u(o(J),2),at=o(Ge),gt=o(at,!0);i(at);var Gt=u(at,2),_a=o(Gt,!0);i(Gt),i(Ge),i(J),q(ht=>{Be=_e(J,1,"scheduleassign-dropdown-item",null,Be,ht),w(gt,(e(te),x(()=>e(te).name))),w(_a,(e(te),x(()=>e(te).description)))},[()=>({selected:e(b)===e(te).id})]),ye("click",J,()=>Ye(e(te))),m(ge,J)}),i(Yt),i(Tt),i(vt);var Ut=u(vt,2),Et=u(o(Ut),2);let ta;var fa=o(Et);let oe;var Ee=o(fa);{var dt=ge=>{var te=dx(),J=u(o(te),2),Be=o(J),Ge=o(Be);i(Be),i(J),i(te),q(()=>w(Ge,`${e(d),x(()=>e(d).grade)??""}  ${e(d),x(()=>e(d).name)??""}`)),m(ge,te)},we=ge=>{var te=ux(),J=o(te,!0);i(te),q(()=>w(J,e(b)?"Select section":"Select year level first")),m(ge,te)};E(Ee,ge=>{e(d)?ge(dt):ge(we,!1)})}Bt(2),i(fa);var Oe=u(fa,2),lt=o(Oe),Rt=o(lt);aa(Rt),Bt(2),i(lt);var Ht=u(lt,2);{var rt=ge=>{var te=vx();m(ge,te)},ka=ge=>{var te=mt(),J=Je(te);{var Be=at=>{var gt=mt(),Gt=Je(gt);xt(Gt,1,()=>e(r),_a=>_a.id,(_a,ht)=>{var Ne=fx();let ct;var Ft=u(o(Ne),2),Mt=o(Ft),It=o(Mt);i(Mt);var ra=u(Mt,2),ha=o(ra);i(ra),i(Ft),i(Ne),q(ca=>{ct=_e(Ne,1,"scheduleassign-dropdown-item",null,ct,ca),w(It,`${e(ht),x(()=>e(ht).grade)??""}  ${e(ht),x(()=>e(ht).name)??""}`),w(ha,`${e(ht),x(()=>e(ht).grade)??""} Section`)},[()=>({selected:e(y)===e(ht).id})]),ye("click",Ne,()=>Y(e(ht))),m(_a,Ne)}),m(at,gt)},Ge=at=>{var gt=px();m(at,gt)};E(J,at=>{e(r),x(()=>e(r).length>0)?at(Be):at(Ge,!1)},!0)}m(ge,te)};E(Ht,ge=>{e(S)?ge(rt):ge(ka,!1)})}i(Oe),i(Et),i(Ut),i(pt);var Zt=u(pt,2);{var tt=ge=>{var te=Hx(),J=o(te),Be=o(J),Ge=o(Be);let at;var gt=o(Ge),Gt=o(gt,!0);i(gt);var _a=u(gt);i(Ge),i(Be),i(J);var ht=u(J,2);{var Ne=Ft=>{var Mt=Ox(),It=u(o(Mt),2),ra=o(It),ha=o(ra),ca=u(o(ha),2),Qt=o(ca);let va;var pa=o(Qt);{var ua=jt=>{var qe=mx(),Jt=o(qe),yt=o(Jt,!0);i(Jt);var Lt=u(Jt,2),Xt=o(Lt),na=o(Xt,!0);i(Xt),i(Lt),i(qe),q(()=>{w(yt,(e(V),x(()=>e(V).scheduleType==="subject"?"book":"sports"))),w(na,(e(V),x(()=>e(V).scheduleType==="subject"?"Subject":"Activity")))}),m(jt,qe)},ba=jt=>{var qe=hx();m(jt,qe)};E(pa,jt=>{e(V),x(()=>e(V).scheduleType)?jt(ua):jt(ba,!1)})}Bt(2),i(Qt);var Ta=u(Qt,2);let Pa;var Ea=o(Ta);let K;var xe=u(Ea,2);let Ke;i(Ta),i(ca),i(ha);var Dt=u(ha,2);{var Wt=jt=>{var qe=xx(),Jt=u(o(qe),2),yt=o(Jt);let Lt;var Xt=o(yt);{var na=La=>{const Ha=fr(()=>(e(re),e(V),x(()=>e(re).find(is=>is.id===e(V).subjectId))));var vs=gx(),Za=u(o(vs),2),Xa=o(Za),rs=o(Xa,!0);i(Xa),i(Za),i(vs),q(()=>w(rs,(xs(e(Ha)),x(()=>e(Ha)?.name)))),m(La,vs)},ja=La=>{var Ha=_x();m(La,Ha)};E(Xt,La=>{e(V),x(()=>e(V).subjectId)?La(na):La(ja,!1)})}Bt(2),i(yt);var $a=u(yt,2);let Ra;var Ba=o($a),ts=o(Ba);aa(ts),Bt(2),i(Ba);var _s=u(Ba,2);{var Ga=La=>{var Ha=bx();m(La,Ha)},ss=La=>{var Ha=mt(),vs=Je(Ha);{var Za=rs=>{var is=mt(),bs=Je(is);xt(bs,1,()=>e(n),ys=>ys.id,(ys,As)=>{var Ds=yx();let Us;var ar=u(o(Ds),2),sr=o(ar),zr=o(sr,!0);i(sr),i(ar),i(Ds),q(pr=>{Us=_e(Ds,1,"scheduleassign-dropdown-option",null,Us,pr),w(zr,(e(As),x(()=>e(As).name)))},[()=>({selected:e(V).subjectId===e(As).id})]),ye("click",Ds,()=>N(e(As))),m(ys,Ds)}),m(rs,is)},Xa=rs=>{var is=wx(),bs=u(o(is),2),ys=o(bs,!0);i(bs),i(is),q(()=>w(ys,e(C)?"No subjects found":"No subjects available")),m(rs,is)};E(vs,rs=>{e(n),x(()=>e(n).length>0)?rs(Za):rs(Xa,!1)},!0)}m(La,Ha)};E(_s,La=>{e(de)?La(Ga):La(ss,!1)})}i($a),i(Jt),i(qe),q((La,Ha)=>{Lt=_e(yt,1,"scheduleassign-dropdown-trigger",null,Lt,La),yt.disabled=e(de),Ra=_e($a,1,"scheduleassign-dropdown-menu",null,Ra,Ha)},[()=>({open:e(Ve),selected:e(V).subjectId}),()=>({open:e(Ve)})]),ye("click",yt,z),oa(ts,()=>e(C),La=>v(C,La)),m(jt,qe)},Nt=jt=>{var qe=Tx(),Jt=u(o(qe),2),yt=o(Jt);let Lt;var Xt=o(yt);{var na=Ga=>{const ss=fr(()=>(e(me),e(V),x(()=>e(me).find(Xa=>Xa.id===e(V).activityTypeId))));var La=Sx(),Ha=u(o(La),2),vs=o(Ha),Za=o(vs,!0);i(vs),i(Ha),i(La),q(()=>w(Za,(xs(e(ss)),x(()=>e(ss)?.name)))),m(Ga,La)},ja=Ga=>{var ss=kx();m(Ga,ss)};E(Xt,Ga=>{e(V),x(()=>e(V).activityTypeId)?Ga(na):Ga(ja,!1)})}Bt(2),i(yt);var $a=u(yt,2);let Ra;var Ba=o($a);{var ts=Ga=>{var ss=Ax();m(Ga,ss)},_s=Ga=>{var ss=mt(),La=Je(ss);{var Ha=Za=>{var Xa=mt(),rs=Je(Xa);xt(rs,1,()=>e(me),is=>is.id,(is,bs)=>{var ys=Dx();let As;var Ds=u(o(ys),2),Us=o(Ds),ar=o(Us,!0);i(Us),i(Ds),i(ys),q(sr=>{As=_e(ys,1,"scheduleassign-dropdown-option",null,As,sr),w(ar,(e(bs),x(()=>e(bs).name)))},[()=>({selected:e(V).activityTypeId===e(bs).id})]),ye("click",ys,()=>M(e(bs))),m(is,ys)}),m(Za,Xa)},vs=Za=>{var Xa=Cx();m(Za,Xa)};E(La,Za=>{e(me),x(()=>e(me).length>0)?Za(Ha):Za(vs,!1)},!0)}m(Ga,ss)};E(Ba,Ga=>{e(ie)?Ga(ts):Ga(_s,!1)})}i($a),i(Jt),i(qe),q((Ga,ss)=>{Lt=_e(yt,1,"scheduleassign-dropdown-trigger",null,Lt,Ga),yt.disabled=e(ie),Ra=_e($a,1,"scheduleassign-dropdown-menu",null,Ra,ss)},[()=>({open:e(Ze),selected:e(V).activityTypeId}),()=>({open:e(Ze)})]),ye("click",yt,B),m(jt,qe)};E(Dt,jt=>{e(V),x(()=>e(V).scheduleType==="subject")?jt(Wt):jt(Nt,!1)})}var St=u(Dt,2);{var Na=jt=>{var qe=Lx(),Jt=u(o(qe),2),yt=o(Jt);let Lt;var Xt=o(yt);{var na=La=>{const Ha=fr(()=>(e(je),e(V),x(()=>e(je).find(is=>is.id===e(V).teacherId))));var vs=Ex(),Za=u(o(vs),2),Xa=o(Za),rs=o(Xa);i(Xa),i(Za),i(vs),q(()=>w(rs,`${xs(e(Ha)),x(()=>e(Ha)?.first_name)??""} ${xs(e(Ha)),x(()=>e(Ha)?.last_name)??""}`)),m(La,vs)},ja=La=>{var Ha=Fx();m(La,Ha)};E(Xt,La=>{e(V),x(()=>e(V).teacherId)?La(na):La(ja,!1)})}Bt(2),i(yt);var $a=u(yt,2);let Ra;var Ba=o($a),ts=o(Ba);aa(ts),Bt(2),i(Ba);var _s=u(Ba,2);{var Ga=La=>{var Ha=Nx();m(La,Ha)},ss=La=>{var Ha=mt(),vs=Je(Ha);{var Za=rs=>{var is=mt(),bs=Je(is);xt(bs,1,()=>e(l),ys=>ys.id,(ys,As)=>{var Ds=$x();let Us;var ar=u(o(Ds),2),sr=o(ar),zr=o(sr);i(sr),i(ar),i(Ds),q(pr=>{Us=_e(Ds,1,"scheduleassign-dropdown-option",null,Us,pr),w(zr,`${e(As),x(()=>e(As).first_name)??""} ${e(As),x(()=>e(As).last_name)??""}`)},[()=>({selected:e(V).teacherId===e(As).id})]),ye("click",Ds,()=>H(e(As))),m(ys,Ds)}),m(rs,is)},Xa=rs=>{var is=Px(),bs=u(o(is),2),ys=o(bs,!0);i(bs),i(is),q(()=>w(ys,e(D)?"No teachers found":"No teachers available")),m(rs,is)};E(vs,rs=>{e(l),x(()=>e(l).length>0)?rs(Za):rs(Xa,!1)},!0)}m(La,Ha)};E(_s,La=>{e(Pe)?La(Ga):La(ss,!1)})}i($a),i(Jt),i(qe),q((La,Ha)=>{Lt=_e(yt,1,"scheduleassign-dropdown-trigger",null,Lt,La),yt.disabled=e(Pe),Ra=_e($a,1,"scheduleassign-dropdown-menu",null,Ra,Ha)},[()=>({open:e(ve),selected:e(V).teacherId}),()=>({open:e(ve)})]),ye("click",yt,I),oa(ts,()=>e(D),La=>v(D,La)),m(jt,qe)};E(St,jt=>{e(V),x(()=>e(V).scheduleType==="subject")&&jt(Na)})}i(ra);var Aa=u(ra,2),ga=o(Aa),Da=o(ga),Vt=o(Da);Cc(Vt,{label:"Start Time",placeholder:"Select start time",get value(){return e(V).startTime},set value(jt){Fs(V,e(V).startTime=jt)},get isOpen(){return e(Qe)},set isOpen(jt){v(Qe,jt)},$$events:{change:jt=>Fs(V,e(V).startTime=jt.detail.value),open:Z},$$legacy:!0}),i(Da);var Kt=u(Da,2),xa=o(Kt);Cc(xa,{label:"End Time",placeholder:"Select end time",get value(){return e(V).endTime},set value(jt){Fs(V,e(V).endTime=jt)},get isOpen(){return e(Xe)},set isOpen(jt){v(Xe,jt)},$$events:{change:jt=>Fs(V,e(V).endTime=jt.detail.value),open:le},$$legacy:!0}),i(Kt),i(ga);var ya=u(ga,2),Fa=o(ya);{var ma=jt=>{var qe=mt(),Jt=Je(qe);{var yt=Xt=>{var na=Mx(),ja=u(o(na),2),$a=o(ja,!0);i(ja),i(na),q(()=>w($a,e(ze))),m(Xt,na)},Lt=Xt=>{var na=mt(),ja=Je(na);{var $a=Ra=>{var Ba=Ix(),ts=u(o(Ba),2),_s=o(ts);i(ts),i(Ba),q(()=>w(_s,`Duration: ${e(We)??""}`)),m(Ra,Ba)};E(ja,Ra=>{e(We)&&Ra($a)},!0)}m(Xt,na)};E(Jt,Xt=>{e(ze)?Xt(yt):Xt(Lt,!1)})}m(jt,qe)};E(Fa,jt=>{e(V),x(()=>e(V).startTime&&e(V).endTime)&&jt(ma)})}i(ya);var wa=u(ya,2),Ia=o(wa);xt(Ia,5,()=>F,Ua,(jt,qe)=>{var Jt=Rx(),yt=o(Jt);aa(yt);var Lt,Xt=u(yt,2),na=o(Xt,!0);i(Xt),i(Jt),q(()=>{Lt!==(Lt=(e(qe),x(()=>e(qe).id)))&&(yt.value=(yt.__value=(e(qe),x(()=>e(qe).id)))??""),w(na,(e(qe),x(()=>e(qe).name)))}),ru(g,[],yt,()=>(e(qe),x(()=>e(qe).id),e(se)),ja=>v(se,ja)),m(jt,Jt)}),i(Ia),i(wa),i(Aa),i(It);var ae=u(It,2),he=o(ae);let st;var At=o(he),kt=o(At,!0);i(At);var Ct=u(At,2);{var ia=jt=>{var qe=Sa("Cannot Save - Conflicts Detected");m(jt,qe)},Ca=jt=>{var qe=mt(),Jt=Je(qe);{var yt=Xt=>{var na=Sa("Saving...");m(Xt,na)},Lt=Xt=>{var na=Sa("Save Schedule");m(Xt,na)};E(Jt,Xt=>{e(X)?Xt(yt):Xt(Lt,!1)},!0)}m(jt,qe)};E(Ct,jt=>{e(ue)?jt(ia):jt(Ca,!1)})}i(he),i(ae),i(Mt),q((jt,qe,Jt,yt,Lt)=>{va=_e(Qt,1,"scheduleassign-dropdown-trigger",null,va,jt),Pa=_e(Ta,1,"scheduleassign-dropdown-menu",null,Pa,qe),K=_e(Ea,1,"scheduleassign-dropdown-option",null,K,Jt),Ke=_e(xe,1,"scheduleassign-dropdown-option",null,Ke,yt),st=_e(he,1,"scheduleassign-save-schedule-btn",null,st,Lt),he.disabled=(e(X),e(se),e(ue),e(ze),x(()=>e(X)||e(se).length===0||e(ue)||e(ze))),w(kt,e(ue)?"block":"save")},[()=>({open:e(Ce),selected:e(V).scheduleType}),()=>({open:e(Ce)}),()=>({selected:e(V).scheduleType==="subject"}),()=>({selected:e(V).scheduleType==="activity"}),()=>({"has-conflicts":e(ue)})]),ye("click",Qt,G),ye("click",Ea,()=>pe("subject")),ye("click",xe,()=>pe("activity")),ye("click",he,Le),m(Ft,Mt)};E(ht,Ft=>{e(R)&&Ft(Ne)})}var ct=u(ht,2);xt(ct,5,()=>F,Ft=>Ft.id,(Ft,Mt)=>{var It=Wx(),ra=o(It),ha=o(ra),ca=o(ha,!0);i(ha),i(ra);var Qt=u(ra,2),va=o(Qt);{var pa=ba=>{var Ta=mt(),Pa=Je(Ta);xt(Pa,1,()=>(e(f),e(Mt),x(()=>e(f)[e(Mt).id])),Ea=>Ea.id,(Ea,K)=>{var xe=Vx(),Ke=o(xe),Dt=o(Ke),Wt=o(Dt),Nt=o(Wt,!0);i(Wt);var St=u(Wt,2),Na=o(St);i(St),i(Dt);var Aa=u(Dt,2),ga=o(Aa);i(Aa),i(Ke);var Da=u(Ke,2),Vt=o(Da);{var Kt=wa=>{var Ia=jx(),ae=u(o(Ia),2),he=o(ae,!0);i(ae),i(Ia),q(()=>w(he,(e(K),x(()=>e(K).teacher)))),m(wa,Ia)};E(Vt,wa=>{e(K),x(()=>e(K).teacher)&&wa(Kt)})}var xa=u(Vt,2);{var ya=wa=>{var Ia=qx(),ae=u(o(Ia),2),he=o(ae);i(ae),i(Ia),q(()=>w(he,`${e(K),x(()=>e(K).startTime)??""} - ${e(K),x(()=>e(K).endTime)??""}`)),m(wa,Ia)};E(xa,wa=>{e(K),x(()=>e(K).startTime&&e(K).endTime)&&wa(ya)})}var Fa=u(xa,2);{var ma=wa=>{var Ia=Gx(),ae=u(o(Ia),2),he=o(ae),st=u(he);{var At=kt=>{var Ct=zx(),ia=o(Ct);i(Ct),q(()=>w(ia,`(${e(K),x(()=>e(K).roomBuilding)??""}${e(K),x(()=>e(K).roomFloor?`, Floor ${e(K).roomFloor}`:"")??""})`)),m(kt,Ct)};E(st,kt=>{e(K),x(()=>e(K).roomBuilding||e(K).roomFloor)&&kt(At)})}i(ae),i(Ia),q(()=>w(he,`${e(K),x(()=>e(K).roomName)??""} `)),m(wa,Ia)};E(Fa,wa=>{e(K),x(()=>e(K).type==="subject"&&e(K).roomName)&&wa(ma)})}i(Da),i(xe),q(()=>{w(Nt,(e(K),x(()=>e(K).subject))),w(Na,`${e(K),x(()=>e(K).grade)??""} - ${e(K),x(()=>e(K).section)??""}`)}),ye("click",ga,()=>U(e(K))),m(Ea,xe)}),m(ba,Ta)},ua=ba=>{var Ta=Bx();m(ba,Ta)};E(va,ba=>{e(f),e(Mt),x(()=>e(f)[e(Mt).id]&&e(f)[e(Mt).id].length>0)?ba(pa):ba(ua,!1)})}i(Qt),i(It),q(()=>w(ca,(e(Mt),x(()=>e(Mt).name)))),m(Ft,It)}),i(ct),i(te),q(Ft=>{at=_e(Ge,1,"scheduleassign-add-schedule-card",null,at,Ft),w(Gt,e(R)?"close":"add"),w(_a,` ${e(R)?"Cancel Schedule":"Add Schedule"}`)},[()=>({"cancel-mode":e(R)})]),ye("click",Ge,ne),m(ge,te)},wt=ge=>{var te=Ux();m(ge,te)};E(Zt,ge=>{e(b)&&e(y)?ge(tt):ge(wt,!1)})}i(bt),i(nt),i(Ie),q((ge,te,J,Be)=>{Ot=_e(Tt,1,"scheduleassign-custom-dropdown",null,Ot,ge),sa=_e(la,1,"scheduleassign-dropdown-button",null,sa,te),ta=_e(Et,1,"scheduleassign-custom-dropdown",null,ta,J),oe=_e(fa,1,"scheduleassign-dropdown-button",null,oe,Be),fa.disabled=!e(b)},[()=>({open:e(k)}),()=>({selected:e(b)}),()=>({open:e(A),disabled:!e(b)}),()=>({selected:e(y),disabled:!e(b)})]),ye("click",la,it),ye("click",fa,ft),oa(Rt,()=>e(T),ge=>v(T,ge)),m(s,Ie),za()}const ci="roomManagementData",co="availableSectionsData",Tc=300*1e3;function Kx(){const{subscribe:s,set:t,update:a}=Hs({rooms:[],availableSections:[],isLoading:!1,error:null,lastUpdated:null});return{subscribe:s,init:r=>{r&&r.rooms&&t({rooms:r.rooms,availableSections:r.availableSections||[],isLoading:!1,error:null,lastUpdated:r.lastUpdated})},setLoading:r=>{a(n=>({...n,isLoading:r,error:r?null:n.error}))},updateRooms:r=>{const n=Date.now(),l={rooms:r,lastUpdated:n,isLoading:!1,error:null};a(c=>({...c,...l}));try{localStorage.setItem(ci,JSON.stringify({rooms:r,lastUpdated:n}))}catch(c){console.warn("Failed to cache rooms data:",c)}},updateSections:r=>{const n=Date.now();a(l=>({...l,availableSections:r,lastUpdated:n}));try{localStorage.setItem(co,JSON.stringify({sections:r,lastUpdated:n}))}catch(l){console.warn("Failed to cache sections data:",l)}},setError:r=>{a(n=>({...n,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem(ci),n=localStorage.getItem(co);if(!r)return null;const l=JSON.parse(r),c=n?JSON.parse(n):{sections:[]},d=Date.now(),f=d-(l.lastUpdated||0),p=d-(c.lastUpdated||0);return f<Tc?{rooms:l.rooms||[],availableSections:p<Tc?c.sections||[]:[],lastUpdated:l.lastUpdated}:null}catch(r){return console.warn("Failed to retrieve cached room data:",r),null}},clearCache:()=>{try{localStorage.removeItem(ci),localStorage.removeItem(co)}catch(r){console.warn("Failed to clear room cache:",r)}},addRoom:r=>{a(n=>{const l=[r,...n.rooms];try{localStorage.setItem(ci,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after adding room:",c)}return{...n,rooms:l}})},removeRoom:r=>{a(n=>{const l=n.rooms.filter(c=>c.id!==r);try{localStorage.setItem(ci,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after removing room:",c)}return{...n,rooms:l}})},updateRoom:(r,n)=>{a(l=>{const c=l.rooms.map(d=>d.id===r?{...d,...n}:d);try{localStorage.setItem(ci,JSON.stringify({rooms:c,lastUpdated:Date.now()}))}catch(d){console.warn("Failed to update cache after updating room:",d)}return{...l,rooms:c}})}}}const _r=Kx();var Jx=_('<span class="material-symbols-outlined">add_ad</span> Create Room',1),Xx=_('<button type="button" class="adminroom-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Zx=_('<div class="admin-room-loading"><span class="room-loader"></span> <p>Loading rooms...</p></div>'),eS=_("<p>No rooms found. Create your first room using the form above.</p>"),tS=_("<p>No rooms found matching your search.</p>"),aS=_('<div class="admin-room-empty-state"><span class="material-symbols-outlined">meeting_room</span> <!></div>'),sS=_('<button type="button" class="admin-room-unassign-button" title="Unassign Room"><span class="material-symbols-outlined">remove_circle</span></button>'),rS=_('<a><button type="button" class="admin-room-assign-button"><span class="material-symbols-outlined"> </span></button></a>'),iS=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">group</span> <span> </span></div>'),nS=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">check_circle</span> <span>Available</span></div>'),oS=_('<div class="admin-room-room-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),lS=_('<div class="admin-room-edit-form-section"><div class="admin-room-edit-form-container"><div class="admin-room-edit-form-header"><h2 class="admin-room-edit-form-title">Edit Room</h2> <p class="admin-room-edit-form-subtitle">Update room information</p></div> <form class="admin-room-edit-form-content"><div class="admin-room-edit-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-room-name">Room Name *</label> <input type="text" id="edit-room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-building">Building *</label> <input type="text" id="edit-building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-floor">Floor *</label> <input type="text" id="edit-floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-edit-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-update-button"><!></button></div></form></div></div>'),cS=_('<div class="selected-option"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),dS=_('<span class="placeholder">Select a section</span>'),uS=_('<button type="button"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),vS=_('<div class="admin-room-assign-form-section"><div class="admin-room-assign-form-container"><div class="admin-room-assign-form-header"><h2 class="admin-room-assign-form-title">Assign Room</h2> <p class="admin-room-assign-form-subtitle">Select a section to assign this room to</p></div> <form class="admin-room-assign-form-content"><div class="admin-room-assign-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="assign-section-select">Select Section *</label> <div><button type="button" id="assign-section-select"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div> <div class="admin-room-assign-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-assign-submit-button"><!></button></div></form></div></div>'),fS=_('<div><div class="admin-room-room-header"><div class="admin-room-room-title"><h3 class="admin-room-room-name"> </h3></div> <div class="admin-room-action-buttons"><!> <a><button type="button" class="admin-room-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="admin-room-remove-button" title="Remove Room"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="admin-room-room-details"><div class="admin-room-room-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <div class="admin-room-room-created"><span class="material-symbols-outlined">schedule</span> <span> </span></div> <!></div> <!> <!></div>'),pS=_('<div class="admin-room-rooms-grid"></div>'),mS=_('<div class="admin-room-creation-form-container"><div class="admin-room-creation-form-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Create New Room</h2> <p class="admin-room-section-subtitle">Fill in the details below to create a new room</p></div> <div class="admin-room-form-container"><form><div class="admin-room-form-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="room-name">Room Name *</label> <input type="text" id="room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="building">Building *</label> <input type="text" id="building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="floor">Floor *</label> <input type="text" id="floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-form-actions"><button type="submit" class="admin-room-create-button"><!></button></div></form></div></div> <div class="admin-room-rooms-list-section"><div class="admin-room-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-room-section-title">All Rooms</h2> <p class="admin-room-section-subtitle">All rooms in the system</p></div> <div class="adminroom-filters-container"><div class="adminroom-search-container"><div class="adminroom-search-input-wrapper"><span class="material-symbols-outlined adminroom-search-icon">search</span> <input type="text" placeholder="Search by room name, building, or floor..." class="adminroom-search-input"/> <!></div></div></div></div></div> <!></div></div>');function hS(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(_r,"$roomManagementStore",a),l=O(),c=O(),d=O(),f=O(),p=O();let h=O(!1),g=O(""),b=O(""),y=O(""),k=O(""),A=O(null),T=O(""),C=O(""),D=O(""),S=O(!1),L=O(null),F=O(""),j=O(!1),P=O(!1);async function Q(I=!1){try{I||_r.setLoading(!0);const G=await da.get("/api/rooms");if(G.success)_r.updateRooms(G.data||[]);else throw new Error(G.message||"Failed to load rooms")}catch(G){console.error("Error loading rooms:",G),_r.setError("Failed to load rooms. Please try again."),Se.error("Failed to load rooms. Please try again.")}}async function W(I=!1){try{const G=await da.get("/api/sections?action=available-sections");if(G.success)_r.updateSections(G.data||[]);else throw new Error(G.message||"Failed to load sections")}catch(G){console.error("Error loading sections:",G),I||Se.error("Failed to load sections. Please try again.")}}const $=I=>{us.confirm("Remove Room",`Are you sure you want to remove room ${I.name}? This action cannot be undone.`,async()=>{try{const G=await da.delete("/api/rooms",{id:I.id});if(G.success)_r.removeRoom(I.id),Se.success(G.message);else throw new Error(G.message||"Failed to remove room")}catch(G){console.error("Error removing room:",G),Se.error("Failed to remove room. Please try again.")}},()=>{})};async function R(){if(!e(b)||!e(y)||!e(k)){Se.warning("Please fill in all required fields.");return}v(h,!0);try{const I=await da.post("/api/rooms",{name:e(b),building:e(y),floor:e(k)});if(I.success)_r.addRoom(I.data),Se.success(I.message),V();else throw new Error(I.message||"Failed to create room")}catch(I){console.error("Error creating room:",I),Se.error("Failed to create room. Please try again.")}finally{v(h,!1)}}async function X(I){const G=e(l).find(Z=>Z.id===I);G&&us.confirm("Unassign Room",`Are you sure you want to unassign room "${G.name}"? This will remove all section assignments from this room.`,async()=>{await se(I)},()=>{})}async function se(I){try{if(!e(l).find(le=>le.id===I))return;const Z=await da.patch("/api/rooms",{roomId:I,action:"unassign"});if(Z.success)await Q(),await W(),Se.success(Z.message);else throw new Error(Z.message||"Failed to unassign room")}catch(G){console.error("Error unassigning room:",G),Se.error("Failed to unassign room. Please try again.")}}function V(){v(b,""),v(y,""),v(k,"")}function re(I){I.target.closest(".custom-dropdown")||v(P,!1)}function me(I){e(A)===I.id?(v(A,null),v(T,""),v(C,""),v(D,"")):(e(L)===I.id&&(v(L,null),v(F,""),v(P,!1)),v(A,I.id),v(T,I.name),v(C,I.building),v(D,I.floor))}async function je(){if(!e(T)||!e(C)||!e(D)){Se.warning("Please fill in all required fields.");return}v(S,!0);try{const I=e(l).find(Z=>Z.id===e(A)),G=await da.put("/api/rooms",{id:e(A),name:e(T),building:e(C),floor:e(D),status:I.status,assignedTo:I.assignedTo});if(G.success)_r.updateRoom(e(A),G.data),Se.success(G.message),v(A,null),v(T,""),v(C,""),v(D,"");else throw new Error(G.message||"Failed to update room")}catch(I){console.error("Error updating room:",I),Se.error("Failed to update room. Please try again.")}finally{v(S,!1)}}function de(I){e(L)===I.id?(v(L,null),v(F,""),v(P,!1)):(e(A)===I.id&&(v(A,null),v(T,""),v(C,""),v(D,"")),v(L,I.id),v(F,""),v(P,!1))}function ie(){v(P,!e(P))}function Pe(I){v(F,I.id||I._id?.toString()),v(P,!1)}async function Ve(){if(!e(F)){Se.warning("Please select a section.");return}v(j,!0);try{const I=await da.patch("/api/rooms",{roomId:e(L),sectionIds:[e(F)],action:"assign"});if(I.success)await Q(),await W(),Se.success(I.message),v(L,null),v(F,"");else throw new Error(I.message||"Failed to assign room")}catch(I){console.error("Error assigning room:",I),Se.error("Failed to assign room. Please try again.")}finally{v(j,!1)}}Ya(()=>{const I=_r.getCachedData();I&&_r.init(I),Q(!!I),W(!!I);const G=setInterval(()=>{Q(!0),W(!0)},3e4);return()=>{clearInterval(G)}}),_t(()=>(e(l),e(c),e(d),e(f),n()),()=>{(I=>{v(l,I.rooms),v(c,I.availableSections),v(d,I.isLoading),v(f,I.error)})(n())}),_t(()=>(e(l),e(g)),()=>{v(p,e(l).filter(I=>I.name.toLowerCase().includes(e(g).toLowerCase())||I.building.toLowerCase().includes(e(g).toLowerCase())||I.floor.toLowerCase().includes(e(g).toLowerCase())))}),Rs(),Ls();var Ze=mS();ye("click",Zs,re);var ve=o(Ze),Ce=u(o(ve),2),Qe=o(Ce),Xe=o(Qe),ze=o(Xe),We=u(o(ze),2);aa(We),i(ze);var Te=u(ze,2),ue=u(o(Te),2);aa(ue),i(Te);var be=u(Te,2),ke=u(o(be),2);aa(ke),i(be),i(Xe);var Fe=u(Xe,2),Re=o(Fe),et=o(Re);{var $e=I=>{var G=Sa("Creating...");m(I,G)},ot=I=>{var G=Jx();Bt(),m(I,G)};E(et,I=>{e(h)?I($e):I(ot,!1)})}i(Re),i(Fe),i(Qe),i(Ce),i(ve);var Me=u(ve,2),it=o(Me),ft=o(it),Ye=u(o(ft),2),Y=o(Ye),ce=o(Y),De=u(o(ce),2);aa(De);var U=u(De,2);{var ne=I=>{var G=Xx();ye("click",G,()=>v(g,"")),m(I,G)};E(U,I=>{e(g)&&I(ne)})}i(ce),i(Y),i(Ye),i(ft),i(it);var fe=u(it,2);{var z=I=>{var G=Zx();m(I,G)},B=I=>{var G=mt(),Z=Je(G);{var le=M=>{var H=aS(),pe=u(o(H),2);{var ee=Ue=>{var Le=eS();m(Ue,Le)},Ae=Ue=>{var Le=tS();m(Ue,Le)};E(pe,Ue=>{e(l),x(()=>e(l).length===0)?Ue(ee):Ue(Ae,!1)})}i(H),m(M,H)},N=M=>{var H=pS();xt(H,5,()=>e(p),pe=>pe.id,(pe,ee)=>{var Ae=fS();let Ue;var Le=o(Ae),He=o(Le),Ie=o(He),nt=o(Ie,!0);i(Ie),i(He);var bt=u(He,2),pt=o(bt);{var vt=Zt=>{var tt=sS();ye("click",tt,()=>X(e(ee).id)),m(Zt,tt)},Tt=Zt=>{var tt=rS(),wt=o(tt),ge=o(wt),te=o(ge,!0);i(ge),i(wt),i(tt),q(()=>{$t(tt,"href",`#admin-room-room-card-${e(ee),x(()=>e(ee).id)??""}`),$t(wt,"title",(e(L),e(ee),x(()=>e(L)===e(ee).id?"Cancel Assign":"Assign Room"))),w(te,(e(L),e(ee),x(()=>e(L)===e(ee).id?"close":"add_circle")))}),ye("click",wt,()=>de(e(ee))),m(Zt,tt)};E(pt,Zt=>{e(ee),x(()=>e(ee).assignedSections&&e(ee).assignedSections.length>0)?Zt(vt):Zt(Tt,!1)})}var Ot=u(pt,2),la=o(Ot),sa=o(la),zt=o(sa,!0);i(sa),i(la),i(Ot);var qt=u(Ot,2);i(bt),i(Le);var Pt=u(Le,2),Yt=o(Pt),Ut=u(o(Yt),2),Et=o(Ut);i(Ut),i(Yt);var ta=u(Yt,2);{var fa=Zt=>{var tt=iS(),wt=u(o(tt),2),ge=o(wt);i(wt),i(tt),q(te=>w(ge,`Assigned to: ${te??""}`),[()=>(e(ee),x(()=>e(ee).assignedSections.map(te=>te.name).join(", ")))]),m(Zt,tt)},oe=Zt=>{var tt=nS();m(Zt,tt)};E(ta,Zt=>{e(ee),x(()=>e(ee).assignedSections&&e(ee).assignedSections.length>0)?Zt(fa):Zt(oe,!1)})}var Ee=u(ta,2),dt=u(o(Ee),2),we=o(dt);i(dt),i(Ee);var Oe=u(Ee,2);{var lt=Zt=>{var tt=oS(),wt=u(o(tt),2),ge=o(wt);i(wt),i(tt),q(()=>w(ge,`Updated: ${e(ee),x(()=>e(ee).updatedDate)??""}`)),m(Zt,tt)};E(Oe,Zt=>{e(ee),x(()=>e(ee).updatedDate&&e(ee).updatedDate!==e(ee).createdDate)&&Zt(lt)})}i(Pt);var Rt=u(Pt,2);{var Ht=Zt=>{var tt=lS(),wt=o(tt),ge=u(o(wt),2),te=o(ge),J=o(te),Be=u(o(J),2);aa(Be),i(J);var Ge=u(J,2),at=u(o(Ge),2);aa(at),i(Ge);var gt=u(Ge,2),Gt=u(o(gt),2);aa(Gt),i(gt),i(te);var _a=u(te,2),ht=o(_a),Ne=u(ht,2),ct=o(Ne);{var Ft=It=>{var ra=Sa("Updating...");m(It,ra)},Mt=It=>{var ra=Sa("Update");m(It,ra)};E(ct,It=>{e(S)?It(Ft):It(Mt,!1)})}i(Ne),i(_a),i(ge),i(wt),i(tt),q(()=>Ne.disabled=e(S)||!e(T)||!e(C)||!e(D)),oa(Be,()=>e(T),It=>v(T,It)),oa(at,()=>e(C),It=>v(C,It)),oa(Gt,()=>e(D),It=>v(D,It)),ye("click",ht,()=>me(e(ee))),ye("submit",ge,tr(je)),m(Zt,tt)};E(Rt,Zt=>{e(A),e(ee),x(()=>e(A)===e(ee).id)&&Zt(Ht)})}var rt=u(Rt,2);{var ka=Zt=>{var tt=vS(),wt=o(tt),ge=u(o(wt),2),te=o(ge),J=o(te),Be=u(o(J),2);let Ge;var at=o(Be);let gt;var Gt=o(at);{var _a=ca=>{const Qt=fr(()=>(e(c),e(F),x(()=>e(c).find(ba=>(ba.id||ba._id?.toString())===e(F)))));var va=mt(),pa=Je(va);{var ua=ba=>{var Ta=cS(),Pa=u(o(Ta),2),Ea=o(Pa),K=o(Ea,!0);i(Ea);var xe=u(Ea,2),Ke=o(xe);i(xe),i(Pa),i(Ta),q(()=>{w(K,(xs(e(Qt)),x(()=>e(Qt).name))),w(Ke,`Grade ${xs(e(Qt)),x(()=>e(Qt).grade_level)??""} Section`)}),m(ba,Ta)};E(pa,ba=>{e(Qt)&&ba(ua)})}m(ca,va)},ht=ca=>{var Qt=dS();m(ca,Qt)};E(Gt,ca=>{e(F)?ca(_a):ca(ht,!1)})}Bt(2),i(at);var Ne=u(at,2);xt(Ne,5,()=>e(c),ca=>ca.id||ca._id,(ca,Qt)=>{var va=uS();let pa;var ua=u(o(va),2),ba=o(ua),Ta=o(ba,!0);i(ba);var Pa=u(ba,2),Ea=o(Pa);i(Pa),i(ua),i(va),q(K=>{pa=_e(va,1,"dropdown-option",null,pa,K),w(Ta,(e(Qt),x(()=>e(Qt).name))),w(Ea,`Grade ${e(Qt),x(()=>e(Qt).grade_level)??""} Section`)},[()=>({selected:e(F)===(e(Qt).id||e(Qt)._id?.toString())})]),ye("click",va,vo(()=>Pe(e(Qt)))),m(ca,va)}),i(Ne),i(Be),i(J),i(te);var ct=u(te,2),Ft=o(ct),Mt=u(Ft,2),It=o(Mt);{var ra=ca=>{var Qt=Sa("Assigning");m(ca,Qt)},ha=ca=>{var Qt=Sa("Assign");m(ca,Qt)};E(It,ca=>{e(j)?ca(ra):ca(ha,!1)})}i(Mt),i(ct),i(ge),i(wt),i(tt),q((ca,Qt)=>{Ge=_e(Be,1,"custom-dropdown",null,Ge,ca),gt=_e(at,1,"dropdown-trigger",null,gt,Qt),Mt.disabled=e(j)||!e(F)},[()=>({open:e(P)}),()=>({selected:e(F)})]),ye("click",at,vo(ie)),ye("click",Ft,()=>de(e(ee))),ye("submit",ge,tr(Ve)),m(Zt,tt)};E(rt,Zt=>{e(L),e(ee),x(()=>e(L)===e(ee).id)&&Zt(ka)})}i(Ae),q(Zt=>{Ue=_e(Ae,1,"admin-room-room-card",null,Ue,Zt),$t(Ae,"id",`admin-room-room-card-${e(ee),x(()=>e(ee).id)??""}`),w(nt,(e(ee),x(()=>e(ee).name))),$t(Ot,"href",`#admin-room-room-card-${e(ee),x(()=>e(ee).id)??""}`),$t(la,"title",(e(A),e(ee),x(()=>e(A)===e(ee).id?"Cancel Edit":"Edit Room"))),w(zt,(e(A),e(ee),x(()=>e(A)===e(ee).id?"close":"edit"))),w(Et,`${e(ee),x(()=>e(ee).building)??""}, ${e(ee),x(()=>e(ee).floor)??""}`),w(we,`Created: ${e(ee),x(()=>e(ee).createdDate)??""}`)},[()=>({editing:e(A)===e(ee).id,assigning:e(L)===e(ee).id})]),ye("click",la,()=>me(e(ee))),ye("click",qt,()=>$(e(ee))),m(pe,Ae)}),i(H),m(M,H)};E(Z,M=>{e(p),x(()=>e(p).length===0)?M(le):M(N,!1)},!0)}m(I,G)};E(fe,I=>{e(d)?I(z):I(B,!1)})}i(Me),i(Ze),q(()=>Re.disabled=e(h)||!e(b)||!e(y)||!e(k)),oa(We,()=>e(b),I=>v(b,I)),oa(ue,()=>e(y),I=>v(y,I)),oa(ke,()=>e(k),I=>v(k,I)),ye("submit",Qe,tr(R)),oa(De,()=>e(g),I=>v(g,I)),m(s,Ze),za(),r()}const $i="sectionsCache",gS=180*1e3,nr=(()=>{const s=Hs([]),t=Hs(!1),a=Hs(null),r=()=>{try{const k=localStorage.getItem($i);if(!k)return null;const A=JSON.parse(k);return Date.now()-A.timestamp>gS?(localStorage.removeItem($i),null):A.sections}catch(k){return console.error("Error reading sections cache:",k),localStorage.removeItem($i),null}},n=k=>{try{const A={sections:k,timestamp:Date.now()};localStorage.setItem($i,JSON.stringify(A))}catch(A){console.error("Error setting sections cache:",A)}},l=()=>{try{localStorage.removeItem($i)}catch(k){console.error("Error clearing sections cache:",k)}},c=()=>{const k=r();return k?(s.set(k),!0):!1},d=(k,A=!1)=>{s.set(k),a.set(null),A||t.set(!1),n(k)},f=(k,A=!1)=>{A||t.set(k)},p=k=>{a.set(k),t.set(!1)},h=async(k=!1,A="")=>{try{f(!0,k);let T="/api/sections";A&&A.trim()&&(T+=`?search=${encodeURIComponent(A.trim())}`);const C=await ns(T);if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const D=await C.json();if(!D.success||!D.data)throw new Error("Invalid API response structure");const S=D.data.map(L=>({...L,students:L.students||[],adviser:L.adviser||null}));d(S,k)}catch(T){console.error("Error loading sections:",T),p(T.message)}finally{f(!1,!1)}},g=k=>{s.update(A=>{const T=[...A,k];return n(T),T})},b=(k,A)=>{s.update(T=>{const C=T.map(D=>D.id===k?{...D,...A}:D);return n(C),C})},y=k=>{s.update(A=>{const T=A.filter(C=>C.id!==k);return n(T),T})};return{sections:{subscribe:s.subscribe},isLoadingSections:{subscribe:t.subscribe},sectionsError:{subscribe:a.subscribe},initSections:c,loadSections:h,updateSections:d,setLoadingSections:f,setSectionsError:p,addSection:g,updateSection:b,removeSection:y,clearSectionsCache:l}})();var _S=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),bS=_('<span class="sectionmgmt-placeholder">Select grade level</span>'),yS=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),wS=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),xS=_('<span class="sectionmgmt-placeholder">Select advisory teacher</span>'),SS=_('<span class="sectionmgmt-placeholder">Select grade level first</span>'),kS=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading teachers...</p></div>'),AS=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available teachers found</span></div>'),DS=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),CS=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),TS=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading students...</p></div>'),ES=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found for this grade level</span></div>'),FS=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <div class="sectionmgmt-student-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),NS=_('<div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="students"/> <!></div> <div class="sectionmgmt-student-list"><!></div>',1),$S=_('<div class="sectionmgmt-placeholder-message"><span class="material-symbols-outlined">info</span> <span>Please select a grade level first to view available students.</span></div>'),PS=_('<span class="material-symbols-outlined">groups</span> Create Section',1),LS=_('<button type="button" class="adminform-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),MS=_('<div class="adminform-selected-option"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></div>'),IS=_('<span class="adminform-placeholder">Filter by grade</span>'),RS=_('<button type="button"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></button>'),OS=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading sections...</p></div>'),jS=_('<div class="sectionmgmt-section-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),qS=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),zS=_('<span class="sectionmgmt-placeholder">Select section adviser</span>'),GS=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),VS=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available advisers found</span></div>'),BS=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),WS=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <span class="material-symbols-outlined sectionmgmt-option-icon"> </span></button>'),HS=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found</span></div>'),US=_('<div class="sectionmgmt-edit-form-section"><div class="sectionmgmt-edit-form-container" id="section-edit-form-container"><div class="sectionmgmt-edit-form-header"><h2 class="sectionmgmt-edit-form-title">Edit Section</h2> <p class="sectionmgmt-edit-form-subtitle">Update section information and manage students</p></div> <form class="sectionmgmt-edit-form-content"><div class="sectionmgmt-edit-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-name">Section Name</label> <input type="text" id="edit-section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-adviser">Section Adviser</label> <div><button type="button" id="edit-section-adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search advisers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!> <!></div></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-students"> </label> <div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="edit-students"/> <!></div> <div class="sectionmgmt-student-list"><!> <!></div></div> <div class="sectionmgmt-edit-form-actions"><button type="button" class="sectionmgmt-cancel-button">Cancel</button> <button type="submit" class="sectionmgmt-submit-button"><!></button></div></form></div></div>'),YS=_('<div><div class="sectionmgmt-section-header-card"><div class="sectionmgmt-section-title"><h3 class="sectionmgmt-section-name"> </h3></div> <div class="sectionmgmt-action-buttons"><a><button type="button" class="sectionmgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="sectionmgmt-remove-button" title="Remove Section"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="sectionmgmt-section-details"><div class="sectionmgmt-section-adviser"><span class="material-symbols-outlined">person_book</span> <span> </span></div> <div class="sectionmgmt-section-students"><span class="material-symbols-outlined">group</span> <span> </span></div> <div class="sectionmgmt-section-room"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <div class="sectionmgmt-section-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div> <!></div>'),QS=_("<p>No sections found</p>"),KS=_("<p>No sections found matching your search.</p>"),JS=_('<div class="sectionmgmt-sections-empty"><span class="material-symbols-outlined">school</span> <!></div>'),XS=_("<!> <!>",1),ZS=_(`<div class="sectionmgmt-form-container"><div class="sectionmgmt-creation-form-section"><div class="sectionmgmt-section-header"><h2 class="sectionmgmt-section-title">Create New Section</h2> <p class="sectionmgmt-section-subtitle">Fill in the details below to create a new class section</p></div> <div class="sectionmgmt-form-container"><form><div class="sectionmgmt-basic-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="section-name">Section Name *</label> <input type="text" id="section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="school-year">School Year</label> <input type="text" id="school-year" class="sectionmgmt-form-input" readonly=""/></div></div> <div class="sectionmgmt-create-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="adviser">Advisory Teacher (Optional)</label> <div><button type="button" id="adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search teachers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only teachers without assigned sections are shown. Each teacher can only advise one
							section.</p></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="students">Students (Optional)</label> <!></div> <div class="sectionmgmt-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="sectionmgmt-recent-sections-section"><div class="sectionmgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="sectionmgmt-section-title">All Sections</h2> <p class="sectionmgmt-section-subtitle">All sections in the system</p></div> <div class="adminform-search-filter-container"><div class="adminform-search-container"><div class="adminform-search-input-wrapper"><span class="material-symbols-outlined adminform-search-icon">search</span> <input type="text" placeholder="Search by section name, grade level, student account number, or student name..." class="adminform-search-input"/> <!></div></div> <div class="adminform-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined adminform-dropdown-arrow">expand_more</span></button> <div class="adminform-dropdown-menu"></div></div></div></div></div></div> <div class="sectionmgmt-sections-grid"><!></div></div></div>`);function ek(s,t){qa(t,!1);const[a,r]=ks(),n=()=>Ja(e(d),"$isLoadingSections",a),l=()=>Ja(e(c),"$sections",a),c=O(),d=O(),f=O(),p=O(),h=O(),g=O(),b=O(),y=O(),k=O(),A=O(),T=O(),C=O();let D=O(!1),S=O(""),L=O(""),F=O(""),j=O(null),P=O([]),Q=O(!1),W=O(!1),$=O(!1),R=O(""),X=O(""),se=O(""),V,re=O("all"),me=O(null),je=O(""),de=O(null),ie=O([]),Pe=O(!1),Ve=O(!1),Ze=O(""),ve=O(""),Ce=O([]),Qe=O([]),Xe=O(!1),ze=O(!1);async function We(){try{const xe=await(await ns("/api/current-quarter")).json();xe.success&&xe.data?.currentSchoolYear&&v(F,xe.data.currentSchoolYear)}catch(K){console.error("Error fetching current school year:",K)}}Ya(async()=>{await We();const K=nr.initSections();await nr.loadSections(K),await Te()});async function Te(K=null){try{v(Xe,!0);const xe=K?`&teacherGradeLevel=${K}`:"",Ke=await da.get(`/api/sections?action=available-teachers&schoolYear=${e(F)}${xe}`);if(Ke.success&&(v(Ce,Ke.data.map(Dt=>{const Wt=e(h)&&e(h).length>0?e(h).some(Nt=>Nt.adviser_id===Dt.id):!1;return{id:Dt.id,name:Dt.full_name,employeeId:Dt.account_number,subject:Dt.subject_code||"No Subject",subject_grade_level:Dt.subject_grade_level,hasSection:Wt}})),e(h)&&e(h).length>0))for(const Dt of e(h))Dt.adviser_id&&!e(Ce).find(Wt=>Wt.id===Dt.adviser_id)&&e(Ce).push({id:Dt.adviser_id,name:Dt.adviser_name,employeeId:Dt.adviser_account_number||"N/A",subject:Dt.adviser_subject||"No Subject",subject_grade_level:Dt.grade_level,hasSection:!0})}catch(xe){console.error("Error loading teachers:",xe),Se.error("Failed to load available teachers")}finally{v(Xe,!1)}}async function ue(K){try{v(ze,!0);const xe=await da.get(`/api/sections?action=available-students&gradeLevel=${K}&schoolYear=${e(F)}`);xe.success&&v(Qe,xe.data.map(Ke=>({id:Ke.id,name:Ke.full_name,studentId:Ke.account_number,grade:Ke.grade_level,hasSection:!1})))}catch(xe){console.error("Error loading students:",xe),Se.error("Failed to load available students")}finally{v(ze,!1)}}async function be(K){try{const xe=await da.get(`/api/sections?action=section-students&sectionId=${K}`);return xe.success?xe.data.map(Ke=>({id:Ke.id,name:Ke.full_name,studentId:Ke.account_number,grade:Ke.grade_level})):[]}catch(xe){return console.error("Error loading section students:",xe),[]}}function ke(K){e(ie).findIndex(Ke=>Ke.id===K.id)>-1?v(ie,e(ie).filter(Ke=>Ke.id!==K.id)):v(ie,[...e(ie),K])}function Fe(){if(e(ie).length===e(C).length&&e(C).every(K=>e(ie).some(xe=>xe.id===K.id)))v(ie,e(ie).filter(K=>!e(C).some(xe=>xe.id===K.id)));else{const K=e(C).filter(xe=>!e(ie).some(Ke=>Ke.id===xe.id));v(ie,[...e(ie),...K])}}const Re=[{id:"7",name:"Grade 7",description:"First Year Junior High School"},{id:"8",name:"Grade 8",description:"Second Year Junior High School"},{id:"9",name:"Grade 9",description:"Third Year Junior High School"},{id:"10",name:"Grade 10",description:"Fourth Year Junior High School"}],et=[{id:"all",name:"All Sections",icon:"group"},{id:"7",name:"Grade 7",icon:"school"},{id:"8",name:"Grade 8",icon:"school"},{id:"9",name:"Grade 9",icon:"school"},{id:"10",name:"Grade 10",icon:"school"}];function $e(){v(Q,!e(Q)),v(W,!1)}function ot(){v(W,!e(W)),v(Q,!1)}function Me(){v($,!e($))}function it(K){v(L,K.id),v(Q,!1),v(P,[]),ue(K.id),Te(K.id)}function ft(K){v(j,K),v(W,!1),v(R,"")}function Ye(K){v(re,K.id),v($,!1)}function Y(K){e(P).findIndex(Ke=>Ke.id===K.id)>-1?v(P,e(P).filter(Ke=>Ke.id!==K.id)):v(P,[...e(P),K])}function ce(){if(e(P).length===e(k).length&&e(k).every(K=>e(P).some(xe=>xe.id===K.id)))v(P,e(P).filter(K=>!e(k).some(xe=>xe.id===K.id)));else{const K=e(k).filter(xe=>!e(P).some(Ke=>Ke.id===xe.id));v(P,[...e(P),...K])}}function De(){clearTimeout(V),V=setTimeout(async()=>{await nr.loadSections(!1,e(se))},500)}function U(){v(se,""),nr.loadSections(!1,"")}async function ne(){if(!e(S)||!e(L)){Se.error("Please fill in section name and grade level.");return}v(D,!0);try{const K=await da.post("/api/sections",{sectionName:e(S),gradeLevel:parseInt(e(L)),schoolYear:e(F),adviserId:e(j)?.id||null,studentIds:e(P).map(xe=>xe.id),roomId:null});K.success?(Se.success(K.message),v(S,""),v(L,""),v(j,null),v(P,[]),v(R,""),v(X,""),v(Qe,[]),nr.addSection(K.data),await Te()):Se.error(K.error||"Failed to create section")}catch(K){console.error("Error creating section:",K),Se.error("Failed to create section. Please try again.")}finally{v(D,!1)}}async function fe(K){e(me)===K.id?(v(me,null),v(je,""),v(de,null),v(ie,[]),v(Ze,""),v(ve,""),v(Ve,!1)):(v(me,K.id),v(je,K.name),v(de,e(Ce).find(xe=>xe.id===K.adviser_id)),!e(de)&&K.adviser_id&&(v(de,{id:K.adviser_id,name:"Loading...",employeeId:"",subject:"",hasSection:!0}),await Te(K.grade_level),v(de,e(Ce).find(xe=>xe.id===K.adviser_id)||e(de))),v(ie,await be(K.id)),v(le,[...e(ie)]),v(ve,""),await ue(K.grade_level))}async function z(){if(!e(je)){Se.error("Please fill in section name.");return}v(Pe,!0);try{const K={sectionId:e(me),sectionName:e(je),adviserId:e(de)?.id||null,studentIds:e(ie).map(Ke=>Ke.id||Ke._id),roomId:null},xe=await da.put("/api/sections",K);xe.success?(Se.success(xe.message),v(me,null),v(je,""),v(de,null),v(ie,[]),v(Ze,""),v(ve,""),v(Ve,!1),nr.updateSection(e(me),xe.data),await nr.loadSections(!0),await Te()):Se.error(xe.error||"Failed to update section")}catch(K){console.error("Error updating section:",K),Se.error("Failed to update section. Please try again.")}finally{v(Pe,!1)}}function B(){v(Ve,!e(Ve))}async function I(K){const xe=K.id;v(de,K),v(Ve,!1),v(Ze,""),await Te(),v(de,e(Ce).find(Ke=>Ke.id===xe)||K)}function G(K){us.confirm("Delete Section",`<p>Are you sure you want to permanently delete section <strong>"${K.name}"</strong> (Grade ${K.grade_level})?</p>
			<p class="sectionmgmt-warning">This action will:</p>
			<ul class="sectionmgmt-warning-list">
				<li>Permanently delete the section and all its data</li>
				<li>Remove all students from this section</li>
				<li>Free up the advisory teacher for other sections</li>
				<li>This action cannot be undone</li>
			</ul>`,()=>Z(K),null,{size:"medium"})}async function Z(K){try{const xe=await da.delete(`/api/sections?sectionId=${K._id}`);xe.success?(Se.success("Section deleted successfully"),nr.removeSection(K._id)):Se.error(xe.error||"Failed to delete section")}catch(xe){console.error("Error deleting section:",xe),Se.error("An error occurred while deleting the section")}}let le=O([]);_t(()=>(e(c),e(d),e(f),nr),()=>{Zo(v(c,nr.sections),"$sections",a),Zo(v(d,nr.isLoadingSections),"$isLoadingSections",a),v(f,nr.sectionsError)}),_t(()=>n(),()=>{v(p,n())}),_t(()=>l(),()=>{v(h,l())}),_t(()=>e(se),()=>{e(se)!==void 0&&De()}),_t(()=>e(L),()=>{v(g,Re.find(K=>K.id===e(L)))}),_t(()=>e(re),()=>{v(b,et.find(K=>K.id===e(re)))}),_t(()=>(e(Ce),e(R)),()=>{v(y,e(Ce).filter(K=>!K.hasSection&&K.name.toLowerCase().includes(e(R).toLowerCase())))}),_t(()=>(e(L),e(P),e(j)),()=>{e(L)&&(v(P,e(P).filter(K=>K.grade===e(L))),e(j)&&e(j).subject_grade_level&&e(j).subject_grade_level!==parseInt(e(L))&&v(j,null))}),_t(()=>(e(Qe),e(L),e(X),e(P)),()=>{v(k,e(Qe).filter(K=>{const xe=K.grade===e(L),Ke=K.name.toLowerCase().includes(e(X).toLowerCase()),Dt=!K.hasSection,Wt=!e(P).some(Nt=>Nt.id===K.id);return xe&&Ke&&(Dt||!Wt)}).sort((K,xe)=>{const Ke=e(P).some(Wt=>Wt.id===K.id),Dt=e(P).some(Wt=>Wt.id===xe.id);return Ke&&!Dt?-1:!Ke&&Dt?1:K.name.localeCompare(xe.name)}))}),_t(()=>e(h),()=>{v(A,e(h))}),_t(()=>(e(Ce),e(me),e(h),e(Ze)),()=>{v(T,e(Ce).filter(K=>{const xe=e(me)&&e(h).find(St=>St.id===e(me))?.adviser_id,Ke=!K.hasSection||K.id===xe,Wt=(e(me)&&e(h).find(St=>St.id===e(me)))?.grade_level,Nt=!Wt||!K.subject_grade_level||K.subject_grade_level===Wt;return Ke&&Nt&&K.name.toLowerCase().includes(e(Ze).toLowerCase())}))}),_t(()=>(e(h),e(me),e(Qe),e(le),e(ve),e(ie)),()=>{v(C,(()=>{e(h).find(xe=>xe.id===e(me));const K=[...e(Qe)];return e(le).forEach(xe=>{K.some(Ke=>Ke.id===xe.id)||K.push({...xe,hasSection:!0})}),K.filter(xe=>{const Ke=xe.name.toLowerCase().includes(e(ve).toLowerCase()),Dt=e(ie).some(St=>St.id===xe.id),Wt=e(le).some(St=>St.id===xe.id),Nt=!xe.hasSection||Dt||Wt;return Ke&&Nt}).sort((xe,Ke)=>{const Dt=e(ie).some(Nt=>Nt.id===xe.id),Wt=e(ie).some(Nt=>Nt.id===Ke.id);return Dt&&!Wt?-1:!Dt&&Wt?1:xe.name.localeCompare(Ke.name)})})())}),Rs(),Ls();var N=ZS(),M=o(N),H=u(o(M),2),pe=o(H),ee=o(pe),Ae=o(ee),Ue=u(o(Ae),2);aa(Ue),i(Ae);var Le=u(Ae,2),He=u(o(Le),2);aa(He),i(Le),i(ee);var Ie=u(ee,2),nt=o(Ie),bt=u(o(nt),2);let pt;var vt=o(bt);let Tt;var Ot=o(vt);{var la=K=>{var xe=_S(),Ke=u(o(xe),2),Dt=o(Ke),Wt=o(Dt,!0);i(Dt),i(Ke),i(xe),q(()=>w(Wt,(e(g),x(()=>e(g).name)))),m(K,xe)},sa=K=>{var xe=bS();m(K,xe)};E(Ot,K=>{e(g)?K(la):K(sa,!1)})}Bt(2),i(vt);var zt=u(vt,2);xt(zt,5,()=>Re,K=>K.id,(K,xe)=>{var Ke=yS();let Dt;var Wt=u(o(Ke),2),Nt=o(Wt),St=o(Nt,!0);i(Nt);var Na=u(Nt,2),Aa=o(Na,!0);i(Na),i(Wt),i(Ke),q(ga=>{Dt=_e(Ke,1,"sectionmgmt-dropdown-option",null,Dt,ga),w(St,(e(xe),x(()=>e(xe).name))),w(Aa,(e(xe),x(()=>e(xe).description)))},[()=>({selected:e(L)===e(xe).id})]),ye("click",Ke,()=>it(e(xe))),m(K,Ke)}),i(zt),i(bt),i(nt);var qt=u(nt,2),Pt=u(o(qt),2);let Yt;var Ut=o(Pt);let Et;var ta=o(Ut);{var fa=K=>{var xe=wS(),Ke=u(o(xe),2),Dt=o(Ke),Wt=o(Dt,!0);i(Dt),i(Ke),i(xe),q(()=>w(Wt,(e(j),x(()=>e(j).name)))),m(K,xe)},oe=K=>{var xe=mt(),Ke=Je(xe);{var Dt=Nt=>{var St=xS();m(Nt,St)},Wt=Nt=>{var St=SS();m(Nt,St)};E(Ke,Nt=>{e(L)?Nt(Dt):Nt(Wt,!1)},!0)}m(K,xe)};E(ta,K=>{e(j)?K(fa):K(oe,!1)})}Bt(2),i(Ut);var Ee=u(Ut,2),dt=o(Ee),we=o(dt);aa(we),Bt(2),i(dt);var Oe=u(dt,2);{var lt=K=>{var xe=kS();m(K,xe)},Rt=K=>{var xe=mt(),Ke=Je(xe);{var Dt=Nt=>{var St=AS();m(Nt,St)},Wt=Nt=>{var St=mt(),Na=Je(St);xt(Na,1,()=>e(y),Aa=>Aa.id,(Aa,ga)=>{var Da=DS();let Vt;var Kt=u(o(Da),2),xa=o(Kt),ya=o(xa,!0);i(xa);var Fa=u(xa,2),ma=o(Fa,!0);i(Fa),i(Kt),i(Da),q(wa=>{Vt=_e(Da,1,"sectionmgmt-dropdown-option",null,Vt,wa),w(ya,(e(ga),x(()=>e(ga).name))),w(ma,(e(ga),x(()=>e(ga).employeeId)))},[()=>({selected:e(j)?.id===e(ga).id})]),ye("click",Da,()=>ft(e(ga))),m(Aa,Da)}),m(Nt,St)};E(Ke,Nt=>{e(y),x(()=>e(y).length===0)?Nt(Dt):Nt(Wt,!1)},!0)}m(K,xe)};E(Oe,K=>{e(Xe)?K(lt):K(Rt,!1)})}i(Ee),i(Pt),Bt(2),i(qt),i(Ie);var Ht=u(Ie,2),rt=u(o(Ht),2);{var ka=K=>{var xe=NS(),Ke=Je(xe),Dt=o(Ke);aa(Dt);var Wt=u(Dt,2);{var Nt=Da=>{const Vt=fr(()=>(e(k),e(P),x(()=>e(k).every(Fa=>e(P).some(ma=>ma.id===Fa.id)))));var Kt=CS(),xa=o(Kt),ya=o(xa,!0);i(xa),i(Kt),q(()=>{$t(Kt,"title",`${e(Vt)?"Deselect All":"Select All"} (${e(k),x(()=>e(k).length)??""})`),w(ya,e(Vt)?"deselect":"select_all")}),ye("click",Kt,ce),m(Da,Kt)};E(Wt,Da=>{e(k),x(()=>e(k).length>0)&&Da(Nt)})}i(Ke);var St=u(Ke,2),Na=o(St);{var Aa=Da=>{var Vt=TS();m(Da,Vt)},ga=Da=>{var Vt=mt(),Kt=Je(Vt);{var xa=Fa=>{var ma=ES();m(Fa,ma)},ya=Fa=>{var ma=mt(),wa=Je(ma);xt(wa,1,()=>e(k),Ia=>Ia.id,(Ia,ae)=>{var he=FS();let st;var At=o(he),kt=u(o(At),2),Ct=o(kt);i(kt);var ia=u(kt,2),Ca=o(ia);i(ia),i(At);var jt=u(At,2),qe=o(jt),Jt=o(qe,!0);i(qe),i(jt),i(he),q((yt,Lt)=>{st=_e(he,1,"sectionmgmt-student-item",null,st,yt),w(Ct,`Grade ${e(ae),x(()=>e(ae).grade)??""} |`),w(Ca,`${e(ae),x(()=>e(ae).name)??""}  ${e(ae),x(()=>e(ae).studentId)??""}`),w(Jt,Lt)},[()=>({selected:e(P).some(yt=>yt.id===e(ae).id)}),()=>(e(P),e(ae),x(()=>e(P).some(yt=>yt.id===e(ae).id)?"check_box":"check_box_outline_blank"))]),ye("click",he,()=>Y(e(ae))),m(Ia,he)}),m(Fa,ma)};E(Kt,Fa=>{e(k),x(()=>e(k).length===0)?Fa(xa):Fa(ya,!1)},!0)}m(Da,Vt)};E(Na,Da=>{e(ze)?Da(Aa):Da(ga,!1)})}i(St),oa(Dt,()=>e(X),Da=>v(X,Da)),m(K,xe)},Zt=K=>{var xe=$S();m(K,xe)};E(rt,K=>{e(L)?K(ka):K(Zt,!1)})}i(Ht);var tt=u(Ht,2),wt=o(tt);let ge;var te=o(wt);{var J=K=>{var xe=Sa("Creating...");m(K,xe)},Be=K=>{var xe=PS();Bt(),m(K,xe)};E(te,K=>{e(D)?K(J):K(Be,!1)})}i(wt),i(tt),i(pe),i(H),i(M);var Ge=u(M,2),at=o(Ge),gt=o(at),Gt=u(o(gt),2),_a=o(Gt),ht=o(_a),Ne=u(o(ht),2);aa(Ne);var ct=u(Ne,2);{var Ft=K=>{var xe=LS();ye("click",xe,U),m(K,xe)};E(ct,K=>{e(se)&&K(Ft)})}i(ht),i(_a);var Mt=u(_a,2),It=o(Mt);let ra;var ha=o(It);let ca;var Qt=o(ha);{var va=K=>{var xe=MS(),Ke=o(xe),Dt=o(Ke,!0);i(Ke);var Wt=u(Ke,2),Nt=o(Wt),St=o(Nt,!0);i(Nt),i(Wt),i(xe),q(()=>{w(Dt,(e(b),x(()=>e(b).icon))),w(St,(e(b),x(()=>e(b).name)))}),m(K,xe)},pa=K=>{var xe=IS();m(K,xe)};E(Qt,K=>{e(b)?K(va):K(pa,!1)})}Bt(2),i(ha);var ua=u(ha,2);xt(ua,5,()=>et,K=>K.id,(K,xe)=>{var Ke=RS();let Dt;var Wt=o(Ke),Nt=o(Wt,!0);i(Wt);var St=u(Wt,2),Na=o(St),Aa=o(Na,!0);i(Na),i(St),i(Ke),q(ga=>{Dt=_e(Ke,1,"adminform-dropdown-option",null,Dt,ga),w(Nt,(e(xe),x(()=>e(xe).icon))),w(Aa,(e(xe),x(()=>e(xe).name)))},[()=>({selected:e(re)===e(xe).id})]),ye("click",Ke,()=>Ye(e(xe))),m(K,Ke)}),i(ua),i(It),i(Mt),i(Gt),i(gt),i(at);var ba=u(at,2),Ta=o(ba);{var Pa=K=>{var xe=OS();m(K,xe)},Ea=K=>{var xe=XS(),Ke=Je(xe);xt(Ke,1,()=>e(A),Nt=>Nt.id,(Nt,St)=>{var Na=YS();let Aa;var ga=o(Na),Da=o(ga),Vt=o(Da),Kt=o(Vt);i(Vt),i(Da);var xa=u(Da,2),ya=o(xa),Fa=o(ya),ma=o(Fa),wa=o(ma,!0);i(ma),i(Fa),i(ya);var Ia=u(ya,2);i(xa),i(ga);var ae=u(ga,2),he=o(ae),st=u(o(he),2),At=o(st,!0);i(st),i(he);var kt=u(he,2),Ct=u(o(kt),2),ia=o(Ct);i(Ct),i(kt);var Ca=u(kt,2),jt=u(o(Ca),2),qe=o(jt,!0);i(jt),i(Ca);var Jt=u(Ca,2),yt=u(o(Jt),2),Lt=o(yt);i(yt),i(Jt);var Xt=u(Jt,2);{var na=Ra=>{var Ba=jS(),ts=u(o(Ba),2),_s=o(ts);i(ts),i(Ba),q(Ga=>w(_s,`Updated: ${Ga??""}`),[()=>(e(St),x(()=>new Date(e(St).updated_at).toLocaleDateString()))]),m(Ra,Ba)};E(Xt,Ra=>{e(St),x(()=>e(St).updated_at&&e(St).updated_at!==e(St).created_at)&&Ra(na)})}i(ae);var ja=u(ae,2);{var $a=Ra=>{var Ba=US(),ts=o(Ba),_s=u(o(ts),2),Ga=o(_s),ss=o(Ga),La=u(o(ss),2);aa(La),i(ss);var Ha=u(ss,2),vs=u(o(Ha),2);let Za;var Xa=o(vs);let rs;var is=o(Xa);{var bs=Oa=>{var Va=qS(),ws=u(o(Va),2),js=o(ws),er=o(js,!0);i(js),i(ws),i(Va),q(()=>w(er,(e(de),x(()=>e(de).name)))),m(Oa,Va)},ys=Oa=>{var Va=zS();m(Oa,Va)};E(is,Oa=>{e(de)?Oa(bs):Oa(ys,!1)})}Bt(2),i(Xa);var As=u(Xa,2),Ds=o(As),Us=o(Ds);aa(Us),Bt(2),i(Ds);var ar=u(Ds,2);xt(ar,1,()=>e(T),Oa=>Oa.id,(Oa,Va)=>{var ws=GS();let js;var er=u(o(ws),2),rr=o(er),mr=o(rr,!0);i(rr);var Fr=u(rr,2),wi=o(Fr,!0);i(Fr),i(er),i(ws),q(Gr=>{js=_e(ws,1,"sectionmgmt-dropdown-option",null,js,Gr),w(mr,(e(Va),x(()=>e(Va).name))),w(wi,(e(Va),x(()=>e(Va).employeeId)))},[()=>({selected:e(de)?.id===e(Va).id})]),ye("click",ws,()=>I(e(Va))),m(Oa,ws)});var sr=u(ar,2);{var zr=Oa=>{var Va=VS();m(Oa,Va)};E(sr,Oa=>{e(T),x(()=>e(T).length===0)&&Oa(zr)})}i(As),i(vs),i(Ha),i(Ga);var pr=u(Ga,2),hi=o(pr),gi=o(hi);i(hi);var ai=u(hi,2),_i=o(ai);aa(_i);var Qi=u(_i,2);{var Ki=Oa=>{const Va=fr(()=>(e(C),e(ie),x(()=>e(C).every(rr=>e(ie).some(mr=>mr.id===rr.id)))));var ws=BS(),js=o(ws),er=o(js,!0);i(js),i(ws),q(()=>{$t(ws,"title",`${e(Va)?"Deselect All":"Select All"} (${e(C),x(()=>e(C).length)??""})`),w(er,e(Va)?"deselect":"select_all")}),ye("click",ws,Fe),m(Oa,ws)};E(Qi,Oa=>{e(C),x(()=>e(C).length>0)&&Oa(Ki)})}i(ai);var Ji=u(ai,2),Xi=o(Ji);xt(Xi,1,()=>e(C),Oa=>Oa.id,(Oa,Va)=>{var ws=WS();let js;var er=o(ws),rr=u(o(er),2),mr=o(rr,!0);i(rr);var Fr=u(rr,2),wi=o(Fr);i(Fr),i(er);var Gr=u(er,2),si=o(Gr,!0);i(Gr),i(ws),q((Vr,ri)=>{js=_e(ws,1,"sectionmgmt-student-item",null,js,Vr),w(mr,(e(Va),x(()=>e(Va).name))),w(wi,`${e(Va),x(()=>e(Va).studentId)??""}  Grade ${e(Va),x(()=>e(Va).grade)??""}`),w(si,ri)},[()=>({selected:e(ie).some(Vr=>Vr.id===e(Va).id)}),()=>(e(ie),e(Va),x(()=>e(ie).some(Vr=>Vr.id===e(Va).id)?"check_box":"check_box_outline_blank"))]),ye("click",ws,()=>ke(e(Va))),m(Oa,ws)});var zn=u(Xi,2);{var fs=Oa=>{var Va=HS();m(Oa,Va)};E(zn,Oa=>{e(C),x(()=>e(C).length===0)&&Oa(fs)})}i(Ji),i(pr);var cs=u(pr,2),Cs=o(cs),Os=u(Cs,2),bi=o(Os);{var yi=Oa=>{var Va=Sa("Updating...");m(Oa,Va)},Zi=Oa=>{var Va=Sa("Update");m(Oa,Va)};E(bi,Oa=>{e(Pe)?Oa(yi):Oa(Zi,!1)})}i(Os),i(cs),i(_s),i(ts),i(Ba),q((Oa,Va)=>{Za=_e(vs,1,"sectionmgmt-custom-dropdown",null,Za,Oa),rs=_e(Xa,1,"sectionmgmt-dropdown-trigger",null,rs,Va),w(gi,`Students (${e(ie),x(()=>e(ie).length)??""} selected)`),Os.disabled=e(Pe)||!e(je)},[()=>({open:e(Ve)}),()=>({selected:e(de)})]),oa(La,()=>e(je),Oa=>v(je,Oa)),ye("click",Xa,B),oa(Us,()=>e(Ze),Oa=>v(Ze,Oa)),oa(_i,()=>e(ve),Oa=>v(ve,Oa)),ye("click",Cs,()=>fe(e(St))),ye("submit",_s,tr(z)),m(Ra,Ba)};E(ja,Ra=>{e(me),e(St),x(()=>e(me)===e(St).id)&&Ra($a)})}i(Na),q((Ra,Ba)=>{Aa=_e(Na,1,"sectionmgmt-section-card",null,Aa,Ra),$t(Na,"id",`sectionmgmt-section-card-${e(St),x(()=>e(St).id)??""}`),w(Kt,`${e(St),x(()=>e(St).name)??""}  Grade ${e(St),x(()=>e(St).grade_level)??""}`),$t(ya,"href",`#sectionmgmt-section-card-${e(St),x(()=>e(St).id)??""}`),$t(Fa,"title",(e(me),e(St),x(()=>e(me)===e(St).id?"Cancel Edit":"Edit Section"))),w(wa,(e(me),e(St),x(()=>e(me)===e(St).id?"close":"edit"))),w(At,(e(St),x(()=>e(St).adviser_name||"No adviser"))),w(ia,`${e(St),x(()=>e(St).student_count)??""} students`),w(qe,(e(St),x(()=>e(St).room_name?`${e(St).room_name} (${e(St).room_building}, ${e(St).room_floor})`:"No room assigned"))),w(Lt,`Created: ${Ba??""}`)},[()=>({editing:e(me)===e(St).id}),()=>(e(St),x(()=>new Date(e(St).created_at).toLocaleDateString()))]),ye("click",Fa,()=>fe(e(St))),ye("click",Ia,()=>G(e(St))),m(Nt,Na)});var Dt=u(Ke,2);{var Wt=Nt=>{var St=JS(),Na=u(o(St),2);{var Aa=Da=>{var Vt=QS();m(Da,Vt)},ga=Da=>{var Vt=KS();m(Da,Vt)};E(Na,Da=>{e(h),x(()=>e(h).length===0)?Da(Aa):Da(ga,!1)})}i(St),m(Nt,St)};E(Dt,Nt=>{e(A),x(()=>e(A).length===0)&&Nt(Wt)})}m(K,xe)};E(Ta,K=>{e(p)?K(Pa):K(Ea,!1)})}i(ba),i(Ge),i(N),q((K,xe,Ke,Dt,Wt,Nt,St)=>{pt=_e(bt,1,"sectionmgmt-custom-dropdown",null,pt,K),Tt=_e(vt,1,"sectionmgmt-dropdown-trigger",null,Tt,xe),Yt=_e(Pt,1,"sectionmgmt-custom-dropdown",null,Yt,Ke),Et=_e(Ut,1,"sectionmgmt-dropdown-trigger",null,Et,Dt),Ut.disabled=!e(L),ge=_e(wt,1,"sectionmgmt-create-button",null,ge,Wt),wt.disabled=e(D)||!e(S)||!e(L),ra=_e(It,1,"adminform-custom-dropdown",null,ra,Nt),ca=_e(ha,1,"adminform-dropdown-trigger adminform-filter-trigger",null,ca,St)},[()=>({open:e(Q)}),()=>({selected:e(L)}),()=>({open:e(W)}),()=>({selected:e(j)}),()=>({loading:e(D)}),()=>({open:e($)}),()=>({selected:e(re)!=="all"})]),oa(Ue,()=>e(S),K=>v(S,K)),oa(He,()=>e(F),K=>v(F,K)),ye("click",vt,$e),ye("click",Ut,ot),oa(we,()=>e(R),K=>v(R,K)),ye("submit",pe,tr(ne)),oa(Ne,()=>e(se),K=>v(se,K)),ye("click",ha,Me),m(s,N),za(),r()}var tk=_('<div class="scheduleassign-container"><div class="scheduleassign-header"><div class="scheduleassign-header-content"><h1 class="scheduleassign-page-title">Schedule Management</h1> <p class="scheduleassign-page-subtitle">Assign subjects and teachers to sections with specific time periods</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">schedule</span> Schedule</button> <button><span class="material-icons">groups</span> Section</button> <button><span class="material-icons">meeting_room</span> Room</button></div></div> <div class="schedule-content-container"><!> <!> <!></div></div>');function ak(s){let t=O("schedule");function a(S){v(t,S)}var r=tk(),n=o(r),l=u(o(n),2),c=o(l);let d;var f=u(c,2);let p;var h=u(f,2);let g;i(l),i(n);var b=u(n,2),y=o(b);{var k=S=>{Qx(S,{})};E(y,S=>{e(t)==="schedule"&&S(k)})}var A=u(y,2);{var T=S=>{ek(S,{})};E(A,S=>{e(t)==="section"&&S(T)})}var C=u(A,2);{var D=S=>{hS(S,{})};E(C,S=>{e(t)==="room"&&S(D)})}i(b),i(r),q((S,L,F)=>{d=_e(c,1,"admin-tab-button",null,d,S),p=_e(f,1,"admin-tab-button",null,p,L),g=_e(h,1,"admin-tab-button",null,g,F)},[()=>({active:e(t)==="schedule"}),()=>({active:e(t)==="section"}),()=>({active:e(t)==="room"})]),ye("click",c,()=>a("schedule")),ye("click",f,()=>a("section")),ye("click",h,()=>a("room")),m(s,r)}var sk=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),rk=_('<span class="adminsubject-placeholder">Select grade level</span>'),ik=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),nk=_('<span class="material-symbols-outlined">add_circle</span> Create Subject',1),ok=_('<button type="button" class="adminsubject-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),lk=_('<div class="adminsubject-loading-container"><span class="subject-loader"></span> <p class="adminsubject-loading-text">Loading subjects...</p></div>'),ck=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),dk=_('<span class="adminsubject-placeholder">Select grade level</span>'),uk=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),vk=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container" id="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Subject</h2> <p class="adminsubject-edit-form-subtitle">Update subject information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-grade-level">Grade Level *</label> <div><button type="button" id="edit-grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectName" class="adminsubject-form-label">Subject Name *</label> <input id="editSubjectName" type="text" class="adminsubject-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectCode" class="adminsubject-form-label">Subject Code *</label> <input id="editSubjectCode" type="text" class="adminsubject-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="adminsubject-edit-form-actions"><button type="button" class="adminsubject-cancel-button">Cancel</button> <button type="submit" class="adminsubject-submit-button"><!></button></div></form></div></div>'),fk=_('<div class="adminsubject-subject-card"><div class="adminsubject-subject-header"><div class="adminsubject-subject-title"><h3 class="adminsubject-subject-name"> </h3></div> <div class="adminsubject-action-buttons"><a><button type="button" class="adminsubject-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminsubject-remove-button" title="Remove Subject"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminsubject-subject-details"><div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),pk=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">search_off</span> <p>No subjects found matching your search.</p></div>'),mk=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Subject</h2> <p class="admin-section-subtitle">Fill in the details below to create a new subject</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="admin-form-group admin-form-group-third"><label for="subjectName" class="admin-form-label">Subject Name *</label> <input id="subjectName" type="text" class="admin-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="admin-form-group admin-form-group-third"><label for="subjectCode" class="admin-form-label">Subject Code *</label> <input id="subjectCode" type="text" class="admin-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Subjects</h2> <p class="admin-section-subtitle">All subjects in the system</p></div> <div class="adminsubject-search-container"><div class="adminsubject-search-input-wrapper"><span class="material-symbols-outlined adminsubject-search-icon">search</span> <input type="text" placeholder="Search by subject name or code..." class="adminsubject-search-input"/> <!></div></div></div></div> <div class="adminsubject-subjects-grid"><!></div></div></div>'),hk=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),gk=_('<span class="adminsubject-placeholder">Select icon</span>'),_k=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),bk=_('<span class="material-symbols-outlined">add_circle</span> Create Activity Type',1),yk=_('<button type="button" class="adminactivity-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),wk=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),xk=_('<span class="adminsubject-placeholder">Select icon</span>'),Sk=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),kk=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Activity Type</h2> <p class="adminsubject-edit-form-subtitle">Update activity type information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-name">Activity Name *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-name" placeholder="e.g., Flag Ceremony" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-code">Activity Code *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-code" placeholder="e.g., FLAG" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-icon">Icon</label> <div><button type="button" id="edit-activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="adminsubject-edit-form-actions"><a><button type="button" class="adminsubject-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),Ak=_('<div class="adminactivity-activity-card"><div class="adminactivity-activity-header"><div class="adminactivity-activity-title"><h3 class="adminactivity-activity-name"> </h3></div> <div class="adminactivity-action-buttons"><a><button type="button" class="adminactivity-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminactivity-remove-button" title="Remove Activity Type"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminactivity-activity-details"><div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">palette</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!></div>'),Dk=_("<p>No activity types created yet.</p>"),Ck=_("<p>No activity types found matching your search.</p>"),Tk=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">event_note</span> <!></div>'),Ek=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Activity Type</h2> <p class="admin-section-subtitle">Fill in the details below to create a new activity type</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-name">Activity Name *</label> <input id="activity-name" type="text" class="admin-form-input" placeholder="e.g., Flag Ceremony, Break Time" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-code">Activity Code *</label> <input id="activity-code" type="text" class="admin-form-input" placeholder="e.g., FLAG, BREAK" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-icon">Icon</label> <div><button type="button" id="activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Activities</h2> <p class="admin-section-subtitle">All activity types in the system</p></div> <div class="adminactivity-search-container"><div class="adminactivity-search-input-wrapper"><span class="material-symbols-outlined adminactivity-search-icon">search</span> <input type="text" placeholder="Search by activity name or code..." class="adminactivity-search-input"/> <!></div></div></div></div> <div class="adminactivity-activities-grid"><!></div></div></div>'),Fk=_('<div class="admin-subject-creation-container"><div class="admin-subject-header"><div class="admin-header-content"><h1 class="admin-page-title">Subjects & Activities</h1> <p class="admin-page-subtitle">Manage subjects and activity types for the curriculum</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">subject</span> Subjects</button> <button><span class="material-icons">event</span> Activity Types</button></div></div> <!> <!></div>');function Nk(s,t){qa(t,!1);const a=O(),r=O(),n=O(),l=O();let c=O(!1),d=O(""),f=O(""),p=O(""),h=O(!1),g=O(""),b=O(""),y=O("");function k(){v(g,"")}function A(){v(y,"")}let T=O(null),C=O(""),D=O(""),S=O(""),L=O(!1),F=O(!1),j=O("subjects"),P=O([]),Q=O(!1),W=O(""),$=O(""),R=O("event"),X=O(!1),se=O(null),V=O(""),re=O(""),me=O("event"),je=O(!1),de=O(!1),ie=O(!1),Pe=O([]);const Ve=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],Ze=[{value:"event",name:"Event"},{value:"flag",name:"Flag"},{value:"coffee",name:"Coffee"},{value:"restaurant",name:"Restaurant"},{value:"groups",name:"Groups"},{value:"home",name:"Home"},{value:"book",name:"Book"},{value:"group_work",name:"Group Work"},{value:"schedule",name:"Schedule"}];async function ve(){v(ie,!0);try{const N=await da.get("/api/subjects");N.success?v(Pe,N.data):Se.error("Failed to load subjects: "+N.message)}catch(N){console.error("Error loading subjects:",N),Se.error("Failed to load subjects. Please try again.")}finally{v(ie,!1)}}async function Ce(){try{const N=await da.get("/api/activity-types");N.success?v(P,N.data):Se.error("Failed to load activity types: "+N.message)}catch(N){console.error("Error loading activity types:",N),Se.error("Failed to load activity types. Please try again.")}}Ya(()=>{ve(),Ce()});async function Qe(){if(!e(d)||!e(f).trim()||!e(p).trim()){Se.error("Please fill in all required fields");return}v(c,!0);try{const N=await da.post("/api/subjects",{name:e(f).trim(),code:e(p).trim(),gradeLevel:e(d)});N.success?(v(Pe,[N.data,...e(Pe)]),v(d,""),v(f,""),v(p,""),Se.success(N.message)):Se.error(N.message)}catch(N){console.error("Error creating subject:",N),Se.error("Failed to create subject. Please try again.")}finally{v(c,!1)}}async function Xe(N){us.confirm("Remove Subject",`<p>Are you sure you want to remove the subject <strong>"${N.name}"</strong>?</p>`,async()=>{try{const M=await da.delete("/api/subjects",{id:N.id});M.success?(v(Pe,e(Pe).filter(H=>H.id!==N.id)),Se.success(M.message)):Se.error(M.message)}catch(M){console.error("Error removing subject:",M),Se.error("Failed to remove subject. Please try again.")}},null,{size:"small"})}function ze(){v(F,!e(F))}function We(N){v(S,N.value),v(F,!1)}function Te(){v(h,!e(h))}function ue(N){v(d,N.value),v(h,!1)}function be(N){N.target.closest(".adminsubject-custom-dropdown")||(v(h,!1),v(F,!1),v(X,!1),v(de,!1))}function ke(){v(X,!e(X))}function Fe(N){v(R,N),v(X,!1)}function Re(N){const M=Ze.find(H=>H.value===N);return M?M.name:N}function et(N){e(T)===N.id?(v(T,null),v(C,""),v(D,""),v(S,""),v(F,!1)):(v(T,N.id),v(C,N.name),v(D,N.code),v(S,parseInt(N.gradeLevel.replace("Grade ",""))))}async function $e(){if(!e(C).trim()||!e(D).trim()||!e(S)){Se.error("Please fill in all required fields");return}v(L,!0);try{const N=await da.put("/api/subjects",{id:e(T),name:e(C).trim(),code:e(D).trim(),gradeLevel:e(S)});N.success?(v(Pe,e(Pe).map(M=>M.id===e(T)?N.data:M)),Se.success(N.message),v(T,null),v(C,""),v(D,""),v(S,""),v(F,!1)):Se.error(N.message)}catch(N){console.error("Error updating subject:",N),Se.error("Failed to update subject. Please try again.")}finally{v(L,!1)}}function ot(N){e(se)===N.id?(v(se,null),v(V,""),v(re,""),v(me,"event"),v(de,!1)):(v(se,N.id),v(V,N.name),v(re,N.code),v(me,N.icon))}async function Me(){if(!e(V).trim()||!e(re).trim()){Se.error("Please fill in all required fields");return}v(je,!0);try{const N=await da.put("/api/activity-types",{id:e(se),name:e(V).trim(),code:e(re).trim(),icon:e(me)});N.success?(recentActivityTypes=recentActivityTypes.map(M=>M.id===e(se)?N.data:M),Se.success(N.message),v(se,null),v(V,""),v(re,""),v(me,"event"),v(de,!1)):Se.error(N.message)}catch(N){console.error("Error updating activity type:",N),Se.error("Failed to update activity type. Please try again.")}finally{v(je,!1)}}function it(){v(de,!e(de))}function ft(N){v(me,N),v(de,!1)}async function Ye(){if(!e(W).trim()||!e($).trim()){Se.error("Please fill in all required fields");return}v(Q,!0);try{const N=await da.post("/api/activity-types",{name:e(W).trim(),code:e($).trim(),icon:e(R)});N.success?(v(P,[N.data,...e(P)]),v(W,""),v($,""),v(R,"event"),Se.success("Activity type created successfully")):Se.error(N.message)}catch(N){console.error("Error creating activity type:",N),Se.error("Failed to create activity type. Please try again.")}finally{v(Q,!1)}}async function Y(N){us.confirm("Remove Activity Type",`<p>Are you sure you want to remove the activity type <strong>"${N.name}"</strong>?</p>`,async()=>{try{const M=await da.delete("/api/activity-types",{id:N.id});M.success?(v(P,e(P).filter(H=>H.id!==N.id)),Se.success(M.message)):Se.error(M.message)}catch(M){console.error("Error removing activity type:",M),Se.error("Failed to remove activity type. Please try again.")}},null,{size:"small"})}_t(()=>e(d),()=>{v(a,Ve.find(N=>N.value===e(d)))}),_t(()=>(e(Pe),e(g),e(b)),()=>{v(r,e(Pe).filter(N=>{const M=N.name.toLowerCase().includes(e(g).toLowerCase())||N.code.toLowerCase().includes(e(g).toLowerCase()),H=e(b)?N.gradeLevel===`Grade ${e(b)}`:!0;return M&&H}))}),_t(()=>(e(P),e(y)),()=>{v(n,e(P).filter(N=>N.name.toLowerCase().includes(e(y).toLowerCase())||N.code.toLowerCase().includes(e(y).toLowerCase())))}),_t(()=>e(S),()=>{v(l,Ve.find(N=>N.value===e(S)))}),Rs(),Ls();var ce=Fk();ye("click",Zs,be);var De=o(ce),U=u(o(De),2),ne=o(U);let fe;var z=u(ne,2);let B;i(U),i(De);var I=u(De,2);{var G=N=>{var M=mk(),H=o(M),pe=u(o(H),2),ee=o(pe),Ae=o(ee),Ue=o(Ae),Le=u(o(Ue),2);let He;var Ie=o(Le);let nt;var bt=o(Ie);{var pt=tt=>{var wt=sk(),ge=u(o(wt),2),te=o(ge),J=o(te,!0);i(te),i(ge),i(wt),q(()=>w(J,(e(a),x(()=>e(a).label)))),m(tt,wt)},vt=tt=>{var wt=rk();m(tt,wt)};E(bt,tt=>{e(a)?tt(pt):tt(vt,!1)})}Bt(2),i(Ie);var Tt=u(Ie,2);xt(Tt,5,()=>Ve,tt=>tt.value,(tt,wt)=>{var ge=ik();let te;var J=u(o(ge),2),Be=o(J),Ge=o(Be,!0);i(Be);var at=u(Be,2),gt=o(at,!0);i(at),i(J),i(ge),q(Gt=>{te=_e(ge,1,"adminsubject-dropdown-option",null,te,Gt),w(Ge,(e(wt),x(()=>e(wt).label))),w(gt,(e(wt),x(()=>e(wt).description)))},[()=>({selected:e(d)===e(wt).value})]),ye("click",ge,()=>ue(e(wt))),m(tt,ge)}),i(Tt),i(Le),i(Ue);var Ot=u(Ue,2),la=u(o(Ot),2);aa(la),i(Ot);var sa=u(Ot,2),zt=u(o(sa),2);aa(zt),i(sa),i(Ae);var qt=u(Ae,2),Pt=o(qt);let Yt;var Ut=o(Pt);{var Et=tt=>{var wt=Sa("Creating...");m(tt,wt)},ta=tt=>{var wt=nk();Bt(),m(tt,wt)};E(Ut,tt=>{e(c)?tt(Et):tt(ta,!1)})}i(Pt),i(qt),i(ee),i(pe),i(H);var fa=u(H,2),oe=o(fa),Ee=o(oe),dt=u(o(Ee),2),we=o(dt),Oe=u(o(we),2);aa(Oe);var lt=u(Oe,2);{var Rt=tt=>{var wt=ok();ye("click",wt,k),m(tt,wt)};E(lt,tt=>{e(g)&&tt(Rt)})}i(we),i(dt),i(Ee),i(oe);var Ht=u(oe,2),rt=o(Ht);{var ka=tt=>{var wt=lk();m(tt,wt)},Zt=tt=>{var wt=mt(),ge=Je(wt);xt(ge,1,()=>e(r),te=>te.id,(te,J)=>{var Be=fk(),Ge=o(Be),at=o(Ge),gt=o(at),Gt=o(gt);i(gt),i(at);var _a=u(at,2),ht=o(_a),Ne=o(ht),ct=o(Ne),Ft=o(ct,!0);i(ct),i(Ne),i(ht);var Mt=u(ht,2);i(_a),i(Ge);var It=u(Ge,2),ra=o(It),ha=u(o(ra),2),ca=o(ha,!0);i(ha),i(ra);var Qt=u(ra,2),va=u(o(Qt),2),pa=o(va);i(va),i(Qt);var ua=u(Qt,2),ba=u(o(ua),2),Ta=o(ba);i(ba),i(ua),i(It);var Pa=u(It,2);{var Ea=K=>{var xe=vk(),Ke=o(xe),Dt=u(o(Ke),2),Wt=o(Dt),Nt=o(Wt),St=u(o(Nt),2);let Na;var Aa=o(St);let ga;var Da=o(Aa);{var Vt=Ct=>{var ia=ck(),Ca=u(o(ia),2),jt=o(Ca),qe=o(jt,!0);i(jt),i(Ca),i(ia),q(()=>w(qe,(e(l),x(()=>e(l).label)))),m(Ct,ia)},Kt=Ct=>{var ia=dk();m(Ct,ia)};E(Da,Ct=>{e(l)?Ct(Vt):Ct(Kt,!1)})}Bt(2),i(Aa);var xa=u(Aa,2);xt(xa,5,()=>Ve,Ct=>Ct.value,(Ct,ia)=>{var Ca=uk();let jt;var qe=u(o(Ca),2),Jt=o(qe),yt=o(Jt,!0);i(Jt);var Lt=u(Jt,2),Xt=o(Lt,!0);i(Lt),i(qe),i(Ca),q(na=>{jt=_e(Ca,1,"adminsubject-dropdown-option",null,jt,na),w(yt,(e(ia),x(()=>e(ia).label))),w(Xt,(e(ia),x(()=>e(ia).description)))},[()=>({selected:e(S)===e(ia).value})]),ye("click",Ca,()=>We(e(ia))),m(Ct,Ca)}),i(xa),i(St),i(Nt);var ya=u(Nt,2),Fa=u(o(ya),2);aa(Fa),i(ya);var ma=u(ya,2),wa=u(o(ma),2);aa(wa),i(ma),i(Wt);var Ia=u(Wt,2),ae=o(Ia),he=u(ae,2),st=o(he);{var At=Ct=>{var ia=Sa("Updating...");m(Ct,ia)},kt=Ct=>{var ia=Sa("Update Subject");m(Ct,ia)};E(st,Ct=>{e(L)?Ct(At):Ct(kt,!1)})}i(he),i(Ia),i(Dt),i(Ke),i(xe),q((Ct,ia,Ca)=>{Na=_e(St,1,"adminsubject-custom-dropdown",null,Na,Ct),ga=_e(Aa,1,"adminsubject-dropdown-trigger",null,ga,ia),he.disabled=Ca},[()=>({open:e(F)}),()=>({selected:e(S)}),()=>(e(L),e(C),e(D),e(S),x(()=>e(L)||!e(C).trim()||!e(D).trim()||!e(S)))]),ye("click",Aa,ze),oa(Fa,()=>e(C),Ct=>v(C,Ct)),oa(wa,()=>e(D),Ct=>v(D,Ct)),ye("click",ae,()=>et(e(J))),ye("submit",Dt,tr($e)),m(K,xe)};E(Pa,K=>{e(T),e(J),x(()=>e(T)===e(J).id)&&K(Ea)})}i(Be),q(()=>{$t(Be,"id",`adminsubject-subject-card-${e(J),x(()=>e(J).id)??""}`),w(Gt,`${e(J),x(()=>e(J).name)??""}  ${e(J),x(()=>e(J).gradeLevel)??""}`),$t(ht,"href",`#adminsubject-subject-card-${e(J),x(()=>e(J).id)??""}`),$t(Ne,"title",(e(T),e(J),x(()=>e(T)===e(J).id?"Cancel Edit":"Edit Subject"))),w(Ft,(e(T),e(J),x(()=>e(T)===e(J).id?"close":"edit"))),w(ca,(e(J),x(()=>e(J).code))),w(pa,`Created: ${e(J),x(()=>e(J).createdDate)??""}`),w(Ta,`Updated: ${e(J),x(()=>e(J).updatedDate)??""}`)}),ye("click",Ne,()=>et(e(J))),ye("click",Mt,()=>Xe(e(J))),m(te,Be)},te=>{var J=pk();m(te,J)}),m(tt,wt)};E(rt,tt=>{e(ie)?tt(ka):tt(Zt,!1)})}i(Ht),i(fa),i(M),q((tt,wt,ge,te)=>{He=_e(Le,1,"adminsubject-custom-dropdown",null,He,tt),nt=_e(Ie,1,"adminsubject-dropdown-trigger",null,nt,wt),la.disabled=!e(d),Yt=_e(Pt,1,"admin-create-button",null,Yt,ge),Pt.disabled=te},[()=>({open:e(h)}),()=>({selected:e(d)}),()=>({loading:e(c)}),()=>(e(c),e(d),e(f),x(()=>e(c)||!e(d)||!e(f).trim()))]),ye("click",Ie,Te),oa(la,()=>e(f),tt=>v(f,tt)),oa(zt,()=>e(p),tt=>v(p,tt)),ye("submit",ee,tr(Qe)),oa(Oe,()=>e(g),tt=>v(g,tt)),m(N,M)};E(I,N=>{e(j)==="subjects"&&N(G)})}var Z=u(I,2);{var le=N=>{var M=Ek(),H=o(M),pe=u(o(H),2),ee=o(pe),Ae=o(ee),Ue=o(Ae),Le=u(o(Ue),2);aa(Le),i(Ue);var He=u(Ue,2),Ie=u(o(He),2);aa(Ie),i(He);var nt=u(He,2),bt=u(o(nt),2);let pt;var vt=o(bt);let Tt;var Ot=o(vt);{var la=tt=>{var wt=hk(),ge=o(wt),te=o(ge,!0);i(ge);var J=u(ge,2),Be=o(J),Ge=o(Be,!0);i(Be),i(J),i(wt),q(at=>{w(te,e(R)),w(Ge,at)},[()=>(e(R),x(()=>Re(e(R))))]),m(tt,wt)},sa=tt=>{var wt=gk();m(tt,wt)};E(Ot,tt=>{e(R)?tt(la):tt(sa,!1)})}Bt(2),i(vt);var zt=u(vt,2);xt(zt,5,()=>Ze,tt=>tt.value,(tt,wt)=>{var ge=_k();let te;var J=o(ge),Be=o(J,!0);i(J);var Ge=u(J,2),at=o(Ge),gt=o(at,!0);i(at),i(Ge),i(ge),q(Gt=>{te=_e(ge,1,"adminsubject-dropdown-option",null,te,Gt),w(Be,(e(wt),x(()=>e(wt).value))),w(gt,(e(wt),x(()=>e(wt).name)))},[()=>({selected:e(R)===e(wt).value})]),ye("click",ge,()=>Fe(e(wt).value)),m(tt,ge)}),i(zt),i(bt),i(nt),i(Ae);var qt=u(Ae,2),Pt=o(qt);let Yt;var Ut=o(Pt);{var Et=tt=>{var wt=Sa("Creating...");m(tt,wt)},ta=tt=>{var wt=bk();Bt(),m(tt,wt)};E(Ut,tt=>{e(Q)?tt(Et):tt(ta,!1)})}i(Pt),i(qt),i(ee),i(pe),i(H);var fa=u(H,2),oe=o(fa),Ee=o(oe),dt=u(o(Ee),2),we=o(dt),Oe=u(o(we),2);aa(Oe);var lt=u(Oe,2);{var Rt=tt=>{var wt=yk();ye("click",wt,A),m(tt,wt)};E(lt,tt=>{e(y)&&tt(Rt)})}i(we),i(dt),i(Ee),i(oe);var Ht=u(oe,2),rt=o(Ht);{var ka=tt=>{var wt=mt(),ge=Je(wt);xt(ge,1,()=>e(n),te=>te.id,(te,J)=>{var Be=Ak(),Ge=o(Be),at=o(Ge),gt=o(at),Gt=o(gt,!0);i(gt),i(at);var _a=u(at,2),ht=o(_a),Ne=o(ht),ct=o(Ne),Ft=o(ct,!0);i(ct),i(Ne),i(ht);var Mt=u(ht,2);i(_a),i(Ge);var It=u(Ge,2),ra=o(It),ha=u(o(ra),2),ca=o(ha,!0);i(ha),i(ra);var Qt=u(ra,2),va=o(Qt),pa=o(va,!0);i(va);var ua=u(va,2),ba=o(ua);i(ua),i(Qt);var Ta=u(Qt,2),Pa=u(o(Ta),2),Ea=o(Pa);i(Pa),i(Ta);var K=u(Ta,2),xe=u(o(K),2),Ke=o(xe);i(xe),i(K),i(It);var Dt=u(It,2);{var Wt=Nt=>{var St=kk(),Na=o(St),Aa=u(o(Na),2),ga=o(Aa),Da=o(ga),Vt=u(o(Da),2);aa(Vt),i(Da);var Kt=u(Da,2),xa=u(o(Kt),2);aa(xa),i(Kt);var ya=u(Kt,2),Fa=u(o(ya),2);let ma;var wa=o(Fa);let Ia;var ae=o(wa);{var he=Lt=>{var Xt=wk(),na=o(Xt),ja=o(na,!0);i(na);var $a=u(na,2),Ra=o($a),Ba=o(Ra,!0);i(Ra),i($a),i(Xt),q(ts=>{w(ja,e(me)),w(Ba,ts)},[()=>(e(me),x(()=>Re(e(me))))]),m(Lt,Xt)},st=Lt=>{var Xt=xk();m(Lt,Xt)};E(ae,Lt=>{e(me)?Lt(he):Lt(st,!1)})}Bt(2),i(wa);var At=u(wa,2);xt(At,5,()=>Ze,Lt=>Lt.value,(Lt,Xt)=>{var na=Sk();let ja;var $a=o(na),Ra=o($a,!0);i($a);var Ba=u($a,2),ts=o(Ba),_s=o(ts,!0);i(ts),i(Ba),i(na),q(Ga=>{ja=_e(na,1,"adminsubject-dropdown-option",null,ja,Ga),w(Ra,(e(Xt),x(()=>e(Xt).value))),w(_s,(e(Xt),x(()=>e(Xt).name)))},[()=>({selected:e(me)===e(Xt).value})]),ye("click",na,()=>ft(e(Xt).value)),m(Lt,na)}),i(At),i(Fa),i(ya),i(ga);var kt=u(ga,2),Ct=o(kt),ia=o(Ct);i(Ct);var Ca=u(Ct,2);let jt;var qe=o(Ca);{var Jt=Lt=>{var Xt=Sa("Updating...");m(Lt,Xt)},yt=Lt=>{var Xt=Sa("Update Activity Type");m(Lt,Xt)};E(qe,Lt=>{e(je)?Lt(Jt):Lt(yt,!1)})}i(Ca),i(kt),i(Aa),i(Na),i(St),q((Lt,Xt,na,ja)=>{ma=_e(Fa,1,"adminsubject-custom-dropdown",null,ma,Lt),Ia=_e(wa,1,"adminsubject-dropdown-trigger",null,Ia,Xt),$t(Ct,"href",`#adminactivity-activity-card-${e(J),x(()=>e(J).id)??""}`),jt=_e(Ca,1,"adminsubject-submit-button",null,jt,na),Ca.disabled=ja},[()=>({open:e(de)}),()=>({selected:e(me)}),()=>({loading:e(je)}),()=>(e(je),e(V),e(re),x(()=>e(je)||!e(V).trim()||!e(re).trim()))]),oa(Vt,()=>e(V),Lt=>v(V,Lt)),oa(xa,()=>e(re),Lt=>v(re,Lt)),ye("click",wa,it),ye("click",ia,()=>ot(e(J))),ye("submit",Aa,tr(Me)),m(Nt,St)};E(Dt,Nt=>{e(se),e(J),x(()=>e(se)===e(J).id)&&Nt(Wt)})}i(Be),q(Nt=>{$t(Be,"id",`adminactivity-activity-card-${e(J),x(()=>e(J).id)??""}`),w(Gt,(e(J),x(()=>e(J).name))),$t(ht,"href",`#adminactivity-activity-card-${e(J),x(()=>e(J).id)??""}`),$t(Ne,"title",(e(se),e(J),x(()=>e(se)===e(J).id?"Cancel Edit":"Edit Activity Type"))),w(Ft,(e(se),e(J),x(()=>e(se)===e(J).id?"close":"edit"))),w(ca,(e(J),x(()=>e(J).code))),Wa(va,`color: var(--${e(J),x(()=>e(J).color)??""}-500)`),w(pa,(e(J),x(()=>e(J).icon))),w(ba,`Icon: ${e(J),x(()=>e(J).icon)??""}`),w(Ea,`Color: ${e(J),x(()=>e(J).color)??""}`),w(Ke,`Created: ${Nt??""}`)},[()=>x(()=>new Date().toLocaleDateString())]),ye("click",Ne,()=>ot(e(J))),ye("click",Mt,()=>Y(e(J))),m(te,Be)}),m(tt,wt)},Zt=tt=>{var wt=Tk(),ge=u(o(wt),2);{var te=Be=>{var Ge=Dk();m(Be,Ge)},J=Be=>{var Ge=Ck();m(Be,Ge)};E(ge,Be=>{e(P),x(()=>e(P).length===0)?Be(te):Be(J,!1)})}i(wt),m(tt,wt)};E(rt,tt=>{e(n),x(()=>e(n).length>0)?tt(ka):tt(Zt,!1)})}i(Ht),i(fa),i(M),q((tt,wt,ge,te)=>{pt=_e(bt,1,"adminsubject-custom-dropdown",null,pt,tt),Tt=_e(vt,1,"adminsubject-dropdown-trigger",null,Tt,wt),Yt=_e(Pt,1,"admin-create-button",null,Yt,ge),Pt.disabled=te},[()=>({open:e(X)}),()=>({selected:e(R)}),()=>({loading:e(Q)}),()=>(e(Q),e(W),e($),x(()=>e(Q)||!e(W).trim()||!e($).trim()))]),oa(Le,()=>e(W),tt=>v(W,tt)),oa(Ie,()=>e($),tt=>v($,tt)),ye("click",vt,ke),ye("submit",ee,tr(Ye)),oa(Oe,()=>e(y),tt=>v(y,tt)),m(N,M)};E(Z,N=>{e(j)==="activities"&&N(le)})}i(ce),q((N,M)=>{fe=_e(ne,1,"admin-tab-button",null,fe,N),B=_e(z,1,"admin-tab-button",null,B,M)},[()=>({active:e(j)==="subjects"}),()=>({active:e(j)==="activities"})]),ye("click",ne,()=>v(j,"subjects")),ye("click",z,()=>v(j,"activities")),m(s,ce),za()}var $k=_('<span class="material-symbols-outlined">add_ad</span> Create Department',1),Pk=_('<button type="button" class="dept-mgmt-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Lk=_('<div class="dept-mgmt-loading"><span class="dept-loader"></span> <p>Loading departments...</p></div>'),Mk=_('<h3 class="dept-mgmt-empty-title">No departments created yet</h3> <p class="dept-mgmt-empty-description">Create your first department to get started</p>',1),Ik=_('<h3 class="dept-mgmt-empty-title">No departments found</h3> <p class="dept-mgmt-empty-description">No departments match your search or filter criteria</p>',1),Rk=_('<div class="dept-mgmt-empty-state"><span class="material-symbols-outlined dept-mgmt-empty-icon">corporate_fare</span> <!></div>'),Ok=_('<div class="dept-mgmt-edit-form-section"><div class="dept-mgmt-edit-form-container" id="admin-department-edit-form-container"><div class="dept-mgmt-edit-form-header"><h2 class="dept-mgmt-edit-form-title">Edit Department</h2> <p class="dept-mgmt-edit-form-subtitle">Update department information</p></div> <form class="dept-mgmt-edit-form-content"><div class="dept-mgmt-edit-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-name">Department Name *</label> <input type="text" id="edit-department-name" class="dept-mgmt-form-input" placeholder="Enter department name" required/></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-code">Department Code *</label> <input type="text" id="edit-department-code" class="dept-mgmt-form-input" placeholder="Enter department code" required/></div></div> <div class="dept-mgmt-edit-form-actions"><a><button type="button" class="dept-mgmt-cancel-button">Cancel</button></a> <button type="submit" class="dept-mgmt-update-button"><!></button></div></form></div></div>'),jk=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),qk=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">subject</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-subject-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),zk=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">subject</span> <span>No subjects found</span></div>'),Gk=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),Vk=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">person</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-teacher-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),Bk=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No teachers found</span></div>'),Wk=_('<div class="dept-mgmt-assign-form-section"><div class="dept-mgmt-assign-form-container"><div class="dept-mgmt-assign-form-header"><h2 class="dept-mgmt-assign-form-title">Assign Subjects & Teachers</h2> <p class="dept-mgmt-assign-form-subtitle">Select subjects and teachers for this department</p></div> <form class="dept-mgmt-assign-form-content"><div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="subjects"> </label> <div class="dept-mgmt-subject-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search subjects by name or code..." id="subjects"/> <!></div> <div class="dept-mgmt-subject-list"><!> <!></div> <p class="dept-mgmt-form-help">Select subjects that will be managed by this department.</p></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="teachers"> </label> <div class="dept-mgmt-teacher-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search teachers by name or account number..." id="teachers"/> <!></div> <div class="dept-mgmt-teacher-list"><!> <!></div> <p class="dept-mgmt-form-help">Select teachers who will be part of this department.</p></div></div> <div class="dept-mgmt-assign-actions"><button type="button" class="dept-mgmt-cancel-button">Cancel</button> <button type="submit" class="dept-mgmt-assign-submit-button"><!></button></div></form></div></div>'),Hk=_('<div><div class="dept-mgmt-department-header"><div class="dept-mgmt-department-title"><h3 class="dept-mgmt-department-name"> </h3></div> <div class="dept-mgmt-action-buttons"><a><button type="button" class="dept-mgmt-assign-button"><span class="material-symbols-outlined"> </span></button></a> <a><button type="button" class="dept-mgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="dept-mgmt-remove-button" title="Remove Department"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="dept-mgmt-department-details"><div class="dept-mgmt-department-code"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="dept-mgmt-department-subjects"><span class="material-symbols-outlined">subject</span> <span> </span></div> <div class="dept-mgmt-department-teachers"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="dept-mgmt-department-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!> <!></div>'),Uk=_('<div class="dept-mgmt-container"><div class="dept-mgmt-header"><div class="dept-mgmt-header-content"><h1 class="dept-mgmt-page-title">Department Management</h1> <p class="dept-mgmt-page-subtitle">Create and manage academic departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-create-section"><h2 class="dept-mgmt-section-title">Create New Department</h2> <p class="dept-mgmt-section-subtitle">Add a new academic department to organize subjects and teachers</p> <div class="dept-mgmt-create-form"><div class="dept-mgmt-form-row"><div class="dept-mgmt-form-group"><label for="departmentName" class="dept-mgmt-form-label">Department Name *</label> <input id="departmentName" type="text" placeholder="e.g., Mathematics Department" class="dept-mgmt-form-input"/></div> <div class="dept-mgmt-form-group"><label for="departmentCode" class="dept-mgmt-form-label">Department Code *</label> <input id="departmentCode" type="text" placeholder="e.g., MATH-DEPT" class="dept-mgmt-form-input"/></div></div> <div class="dept-mgmt-form-actions"><button type="submit" class="dept-mgmt-btn-primary"><!></button></div></div></div> <div class="dept-mgmt-departments-section"><div class="dept-mgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="dept-mgmt-section-title">All Departments</h2> <p class="dept-mgmt-section-subtitle">Manage existing departments, assign subjects and teachers</p></div> <div class="dept-mgmt-search-container"><div class="dept-mgmt-search-input-wrapper"><span class="material-symbols-outlined dept-mgmt-search-icon">search</span> <input type="text" placeholder="Search by name or code..." class="dept-mgmt-search-input"/> <!></div></div></div></div> <div class="dept-mgmt-departments-grid"><!></div></div></div>');function Yk(s,t){qa(t,!1);const a=O(),r=O(),n=O(),l=O();let c=O(!1),d=O([]),f=O([]),p=O(""),h=O(""),g=O([]),b=O([]),y="all",k=O(""),A=O(null),T=O(""),C=O(""),D=O(!1),S=O(null),L=O(!1),F=O([]),j=O([]),P=O(""),Q=O(""),W=O(!1);async function $(){v(W,!0);try{const N=await da.get("/api/departments?action=departments");N.success?v(g,N.data.map(M=>({id:M.id,name:M.name,code:M.code,subjects:M.subjects||[],teachers:M.teachers||[],createdAt:M.created_at?M.created_at.split("T")[0]:new Date().toISOString().split("T")[0]}))):Se.error("Failed to load departments")}catch(N){console.error("Error fetching departments:",N),Se.error("Failed to load departments")}finally{v(W,!1)}}async function R(){try{const N=await da.get("/api/departments?action=subjects");N.success?v(F,N.data.map(M=>({id:M.id,name:M.name,code:M.code,gradeLevel:`Grade ${M.grade_level}`}))):Se.error("Failed to load subjects")}catch(N){console.error("Error fetching subjects:",N),Se.error("Failed to load subjects")}finally{}}async function X(){try{const N=await da.get("/api/departments?action=teachers");N.success?v(j,N.data.map(M=>({id:M.id,name:M.full_name||`${M.first_name} ${M.last_name}`,accountNumber:M.account_number}))):Se.error("Failed to load teachers")}catch(N){console.error("Error fetching teachers:",N),Se.error("Failed to load teachers")}finally{}}Ya(async()=>{await Promise.all([$(),R(),X()]),se()});function se(N=e(g),M=y,H=e(k)){let pe=[...N];M==="with_subjects"?pe=pe.filter(ee=>ee.subjects.length>0):M==="with_teachers"?pe=pe.filter(ee=>ee.teachers.length>0):M==="empty"&&(pe=pe.filter(ee=>ee.subjects.length===0&&ee.teachers.length===0)),H.trim()!==""&&(pe=pe.filter(ee=>ee.name.toLowerCase().includes(H.toLowerCase())||ee.code.toLowerCase().includes(H.toLowerCase()))),v(b,pe)}async function V(){if(!e(p).trim()||!e(h).trim()){Se.error("Please fill in all required fields");return}if(e(g).some(N=>N.code.toLowerCase()===e(h).toLowerCase())){Se.error("Department code already exists");return}v(c,!0);try{const N=await da.post("/api/departments",{name:e(p).trim(),code:e(h).trim().toUpperCase()});N.success?(await $(),v(p,""),v(h,""),Se.success("Department created successfully")):Se.error(N.error||"Failed to create department")}catch(N){console.error("Error creating department:",N);const M=N.message||"Failed to create department. Please try again.";Se.error(M)}finally{v(c,!1)}}async function re(N){if(N.preventDefault(),!e(D)){v(D,!0);try{if(!e(T).trim()||!e(C).trim()){Se.error("Department name and code are required");return}if(e(C).trim().length>20){Se.error("Department code cannot exceed 20 characters");return}if(e(g).find(Ue=>Ue.code.toLowerCase()===e(C).trim().toLowerCase()&&Ue.id!==e(A))){Se.error("Department code already exists");return}const H=e(g).find(Ue=>Ue.id===e(A));if(!H)throw new Error("Department not found");const pe=H.teachers?H.teachers.map(Ue=>Ue.id):[],ee=H.subjects?H.subjects.map(Ue=>Ue.id):[],Ae=await da.put("/api/departments",{id:e(A),name:e(T).trim(),code:e(C).trim().toUpperCase(),teachers:pe,subjects:ee});Ae.success?(await $(),v(A,null),v(T,""),v(C,""),Se.success("Department updated successfully")):Se.error(Ae.error||"Failed to update department")}catch(M){console.error("Error updating department:",M);const H=M.message||"Failed to update department. Please try again.";Se.error(H)}finally{v(D,!1)}}}function me(N){e(A)===N.id?(v(A,null),v(T,""),v(C,"")):(e(S)===N.id&&(v(S,null),v(d,[]),v(f,[]),v(P,""),v(Q,"")),v(A,N.id),v(T,N.name),v(C,N.code))}function je(N){us.confirm("Remove Department",`<p>Are you sure you want to remove the department <strong>"${N.name}"</strong>?</p>
			 <p class="warning-text">This action will also remove all subject and teacher assignments.</p>`,async()=>{try{const M=await da.delete("/api/departments",{id:N.id,name:N.name});M.success?(await $(),Se.success("Department removed successfully")):Se.error(M.error||"Failed to remove department")}catch(M){console.error("Error removing department:",M),Se.error("Failed to remove department. Please try again.")}},()=>{},{size:"small"})}function de(N){e(S)===N.id?(v(S,null),v(d,[]),v(f,[]),v(P,""),v(Q,"")):(e(A)===N.id&&(v(A,null),v(T,""),v(C,"")),v(S,N.id),v(d,N.subjects?N.subjects.map(M=>M.id):[]),v(f,N.teachers?N.teachers.map(M=>M.id):[]),v(P,""),v(Q,""))}function ie(N){e(d).findIndex(H=>H===N.id)>-1?v(d,e(d).filter(H=>H!==N.id)):v(d,[...e(d),N.id])}function Pe(N){e(f).findIndex(H=>H===N.id)>-1?v(f,e(f).filter(H=>H!==N.id)):v(f,[...e(f),N.id])}function Ve(){if(e(n).every(M=>e(d).some(H=>H===M.id)))v(d,e(d).filter(M=>!e(n).some(H=>H.id===M)));else{const M=e(n).filter(H=>!e(d).some(pe=>pe===H.id)).map(H=>H.id);v(d,[...e(d),...M])}}function Ze(){if(e(l).every(M=>e(f).some(H=>H===M.id)))v(f,e(f).filter(M=>!e(l).some(H=>H.id===M)));else{const M=e(l).filter(H=>!e(f).some(pe=>pe===H.id)).map(H=>H.id);v(f,[...e(f),...M])}}async function ve(){v(L,!0);try{const N=e(g).find(pe=>pe.id===e(S));if(!N)throw new Error("Department not found");const M={id:e(S),name:N.name,code:N.code,teachers:e(f),subjects:e(d)},H=await da.put("/api/departments",M);if(!H.success)throw new Error(H.error||"Failed to update assignments");v(g,e(g).map(pe=>{if(pe.id===e(S)){const ee=e(F).filter(Ue=>e(d).includes(Ue.id)),Ae=e(j).filter(Ue=>e(f).includes(Ue.id));return{...pe,subjects:ee,teachers:Ae}}return pe})),Se.success("Department assignments updated successfully"),v(S,null),v(d,[]),v(f,[])}catch(N){console.error("Error assigning department:",N),Se.error("Failed to update assignments. Please try again.")}finally{v(L,!1)}}function Ce(N){return N.subjects||[]}function Qe(N){return N.teachers||[]}function Xe(N){}function ze(N){if(!N)return"";const M=N.split("-");return M.length===3?`${M[1]}-${M[2]}-${M[0]}`:N}function We(){v(k,"")}_t(()=>(e(g),e(k)),()=>{e(g)&&se(e(g),y,e(k))}),_t(()=>(e(F),e(P)),()=>{v(a,e(F).filter(N=>N.name.toLowerCase().includes(e(P).toLowerCase())||N.code.toLowerCase().includes(e(P).toLowerCase())))}),_t(()=>(e(j),e(Q)),()=>{v(r,e(j).filter(N=>N.name.toLowerCase().includes(e(Q).toLowerCase())||N.accountNumber.toLowerCase().includes(e(Q).toLowerCase())))}),_t(()=>(e(a),e(d)),()=>{v(n,e(a).sort((N,M)=>{const H=e(d).some(ee=>ee===N.id),pe=e(d).some(ee=>ee===M.id);return H&&!pe?-1:!H&&pe?1:N.name.localeCompare(M.name)}))}),_t(()=>(e(r),e(f)),()=>{v(l,e(r).sort((N,M)=>{const H=e(f).some(ee=>ee===N.id),pe=e(f).some(ee=>ee===M.id);return H&&!pe?-1:!H&&pe?1:N.name.localeCompare(M.name)}))}),Rs(),Ls();var Te=Uk();ye("click",Zs,Xe);var ue=u(o(Te),2),be=u(o(ue),4),ke=o(be),Fe=o(ke),Re=u(o(Fe),2);aa(Re),i(Fe);var et=u(Fe,2),$e=u(o(et),2);aa($e),i(et),i(ke);var ot=u(ke,2),Me=o(ot),it=o(Me);{var ft=N=>{var M=Sa("Creating...");m(N,M)},Ye=N=>{var M=$k();Bt(),m(N,M)};E(it,N=>{e(c)?N(ft):N(Ye,!1)})}i(Me),i(ot),i(be),i(ue);var Y=u(ue,2),ce=o(Y),De=o(ce),U=u(o(De),2),ne=o(U),fe=u(o(ne),2);aa(fe);var z=u(fe,2);{var B=N=>{var M=Pk();ye("click",M,We),m(N,M)};E(z,N=>{e(k)&&N(B)})}i(ne),i(U),i(De),i(ce);var I=u(ce,2),G=o(I);{var Z=N=>{var M=Lk();m(N,M)},le=N=>{var M=mt(),H=Je(M);{var pe=Ae=>{var Ue=Rk(),Le=u(o(Ue),2);{var He=nt=>{var bt=Mk();Bt(2),m(nt,bt)},Ie=nt=>{var bt=Ik();Bt(2),m(nt,bt)};E(Le,nt=>{e(g),x(()=>e(g).length===0)?nt(He):nt(Ie,!1)})}i(Ue),m(Ae,Ue)},ee=Ae=>{var Ue=mt(),Le=Je(Ue);xt(Le,1,()=>e(b),He=>He.id,(He,Ie)=>{var nt=Hk();let bt;var pt=o(nt),vt=o(pt),Tt=o(vt),Ot=o(Tt,!0);i(Tt),i(vt);var la=u(vt,2),sa=o(la),zt=o(sa),qt=o(zt),Pt=o(qt,!0);i(qt),i(zt),i(sa);var Yt=u(sa,2),Ut=o(Yt),Et=o(Ut),ta=o(Et,!0);i(Et),i(Ut),i(Yt);var fa=u(Yt,2);i(la),i(pt);var oe=u(pt,2),Ee=o(oe),dt=u(o(Ee),2),we=o(dt,!0);i(dt),i(Ee);var Oe=u(Ee,2),lt=u(o(Oe),2),Rt=o(lt);i(lt),i(Oe);var Ht=u(Oe,2),rt=u(o(Ht),2),ka=o(rt);i(rt),i(Ht);var Zt=u(Ht,2),tt=u(o(Zt),2),wt=o(tt);i(tt),i(Zt),i(oe);var ge=u(oe,2);{var te=Ge=>{var at=Ok(),gt=o(at),Gt=u(o(gt),2),_a=o(Gt),ht=o(_a),Ne=u(o(ht),2);aa(Ne),i(ht);var ct=u(ht,2),Ft=u(o(ct),2);aa(Ft),i(ct),i(_a);var Mt=u(_a,2),It=o(Mt),ra=o(It);i(It);var ha=u(It,2),ca=o(ha);{var Qt=pa=>{var ua=Sa("Updating...");m(pa,ua)},va=pa=>{var ua=Sa("Update Department");m(pa,ua)};E(ca,pa=>{e(D)?pa(Qt):pa(va,!1)})}i(ha),i(Mt),i(Gt),i(gt),i(at),q(()=>{$t(It,"href",`#department-card-${e(Ie),x(()=>e(Ie).id)??""}`),ha.disabled=e(D)||!e(T)||!e(C)}),oa(Ne,()=>e(T),pa=>v(T,pa)),oa(Ft,()=>e(C),pa=>v(C,pa)),ye("click",ra,()=>me(e(Ie))),ye("submit",Gt,tr(re)),m(Ge,at)};E(ge,Ge=>{e(A),e(Ie),x(()=>e(A)===e(Ie).id)&&Ge(te)})}var J=u(ge,2);{var Be=Ge=>{var at=Wk(),gt=o(at),Gt=u(o(gt),2),_a=o(Gt),ht=o(_a),Ne=o(ht),ct=o(Ne);i(Ne);var Ft=u(Ne,2),Mt=o(Ft);aa(Mt);var It=u(Mt,2);{var ra=Vt=>{const Kt=fr(()=>(e(n),e(d),x(()=>e(n).every(ma=>e(d).some(wa=>wa===ma.id)))));var xa=jk(),ya=o(xa),Fa=o(ya,!0);i(ya),i(xa),q(()=>{$t(xa,"title",`${e(Kt)?"Deselect All":"Select All"} (${e(n),x(()=>e(n).length)??""})`),w(Fa,e(Kt)?"deselect":"select_all")}),ye("click",xa,Ve),m(Vt,xa)};E(It,Vt=>{e(n),x(()=>e(n).length>0)&&Vt(ra)})}i(Ft);var ha=u(Ft,2),ca=o(ha);xt(ca,1,()=>e(n),Vt=>Vt.id,(Vt,Kt)=>{var xa=qk();let ya;var Fa=o(xa),ma=u(o(Fa),2),wa=o(ma,!0);i(ma);var Ia=u(ma,2),ae=o(Ia);i(Ia),i(Fa);var he=u(Fa,2),st=o(he),At=o(st,!0);i(st),i(he),i(xa),q((kt,Ct)=>{ya=_e(xa,1,"dept-mgmt-subject-item",null,ya,kt),w(wa,(e(Kt),x(()=>e(Kt).name))),w(ae,`${e(Kt),x(()=>e(Kt).code)??""}  ${e(Kt),x(()=>e(Kt).gradeLevel)??""}`),w(At,Ct)},[()=>({selected:e(d).some(kt=>kt===e(Kt).id)}),()=>(e(d),e(Kt),x(()=>e(d).some(kt=>kt===e(Kt).id)?"check_box":"check_box_outline_blank"))]),ye("click",xa,()=>ie(e(Kt))),m(Vt,xa)});var Qt=u(ca,2);{var va=Vt=>{var Kt=zk();m(Vt,Kt)};E(Qt,Vt=>{e(n),x(()=>e(n).length===0)&&Vt(va)})}i(ha),Bt(2),i(ht);var pa=u(ht,2),ua=o(pa),ba=o(ua);i(ua);var Ta=u(ua,2),Pa=o(Ta);aa(Pa);var Ea=u(Pa,2);{var K=Vt=>{const Kt=fr(()=>(e(l),e(f),x(()=>e(l).every(ma=>e(f).some(wa=>wa===ma.id)))));var xa=Gk(),ya=o(xa),Fa=o(ya,!0);i(ya),i(xa),q(()=>{$t(xa,"title",`${e(Kt)?"Deselect All":"Select All"} (${e(l),x(()=>e(l).length)??""})`),w(Fa,e(Kt)?"deselect":"select_all")}),ye("click",xa,Ze),m(Vt,xa)};E(Ea,Vt=>{e(l),x(()=>e(l).length>0)&&Vt(K)})}i(Ta);var xe=u(Ta,2),Ke=o(xe);xt(Ke,1,()=>e(l),Vt=>Vt.id,(Vt,Kt)=>{var xa=Vk();let ya;var Fa=o(xa),ma=u(o(Fa),2),wa=o(ma,!0);i(ma);var Ia=u(ma,2),ae=o(Ia,!0);i(Ia),i(Fa);var he=u(Fa,2),st=o(he),At=o(st,!0);i(st),i(he),i(xa),q((kt,Ct)=>{ya=_e(xa,1,"dept-mgmt-teacher-item",null,ya,kt),w(wa,(e(Kt),x(()=>e(Kt).name))),w(ae,(e(Kt),x(()=>e(Kt).accountNumber))),w(At,Ct)},[()=>({selected:e(f).some(kt=>kt===e(Kt).id)}),()=>(e(f),e(Kt),x(()=>e(f).some(kt=>kt===e(Kt).id)?"check_box":"check_box_outline_blank"))]),ye("click",xa,()=>Pe(e(Kt))),m(Vt,xa)});var Dt=u(Ke,2);{var Wt=Vt=>{var Kt=Bk();m(Vt,Kt)};E(Dt,Vt=>{e(l),x(()=>e(l).length===0)&&Vt(Wt)})}i(xe),Bt(2),i(pa),i(_a);var Nt=u(_a,2),St=o(Nt),Na=u(St,2),Aa=o(Na);{var ga=Vt=>{var Kt=Sa("Assigning...");m(Vt,Kt)},Da=Vt=>{var Kt=Sa("Update");m(Vt,Kt)};E(Aa,Vt=>{e(L)?Vt(ga):Vt(Da,!1)})}i(Na),i(Nt),i(Gt),i(gt),i(at),q(()=>{w(ct,`Select Subjects (${e(d),x(()=>e(d).length)??""} selected)`),w(ba,`Select Teachers (${e(f),x(()=>e(f).length)??""} selected)`),Na.disabled=e(L)}),oa(Mt,()=>e(P),Vt=>v(P,Vt)),oa(Pa,()=>e(Q),Vt=>v(Q,Vt)),ye("click",St,()=>de(e(Ie))),ye("submit",Gt,tr(ve)),m(Ge,at)};E(J,Ge=>{e(S),e(Ie),x(()=>e(S)===e(Ie).id)&&Ge(Be)})}i(nt),q((Ge,at,gt,Gt)=>{bt=_e(nt,1,"dept-mgmt-department-card",null,bt,Ge),$t(nt,"id",`department-card-${e(Ie),x(()=>e(Ie).id)??""}`),w(Ot,(e(Ie),x(()=>e(Ie).name))),$t(sa,"href",`#department-card-${e(Ie),x(()=>e(Ie).id)??""}`),$t(zt,"title",(e(S),e(Ie),x(()=>e(S)===e(Ie).id?"Cancel Assign":"Assign"))),w(Pt,(e(S),e(Ie),x(()=>e(S)===e(Ie).id?"close":"add_circle"))),$t(Yt,"href",`#department-card-${e(Ie),x(()=>e(Ie).id)??""}`),$t(Ut,"title",(e(A),e(Ie),x(()=>e(A)===e(Ie).id?"Cancel Edit":"Edit Department"))),w(ta,(e(A),e(Ie),x(()=>e(A)===e(Ie).id?"close":"edit"))),w(we,(e(Ie),x(()=>e(Ie).code))),w(Rt,`${at??""} Subjects`),w(ka,`${gt??""} Teachers`),w(wt,`Created: ${Gt??""}`)},[()=>({editing:e(A)===e(Ie).id,assigning:e(S)===e(Ie).id}),()=>(e(Ie),x(()=>Ce(e(Ie)).length)),()=>(e(Ie),x(()=>Qe(e(Ie)).length)),()=>(e(Ie),x(()=>ze(e(Ie).createdAt)))]),ye("click",zt,()=>de(e(Ie))),ye("click",Ut,()=>me(e(Ie))),ye("click",fa,()=>je(e(Ie))),m(He,nt)}),m(Ae,Ue)};E(H,Ae=>{e(b),x(()=>e(b).length===0)?Ae(pe):Ae(ee,!1)},!0)}m(N,M)};E(G,N=>{e(W)?N(Z):N(le,!1)})}i(I),i(Y),i(Te),q(()=>{Re.disabled=e(c),$e.disabled=e(c),Me.disabled=e(c)||!e(p)||!e(h)}),oa(Re,()=>e(p),N=>v(p,N)),oa($e,()=>e(h),N=>v(h,N)),ye("click",Me,V),oa(fe,()=>e(k),N=>v(k,N)),m(s,Te),za()}var Qk=_('<div class="chart-loading svelte-8jize4"><div class="chart-loader svelte-8jize4"></div> <p class="svelte-8jize4">Loading chart data...</p></div>'),Kk=_('<div class="chart-error svelte-8jize4"><span class="material-symbols-outlined svelte-8jize4">error</span> <p class="svelte-8jize4"> </p> <button class="retry-button svelte-8jize4"><span class="material-symbols-outlined svelte-8jize4">refresh</span> Retry</button></div>'),Jk=_('<canvas class="svelte-8jize4"></canvas>'),Xk=_('<div class="chart-container svelte-8jize4"><!></div>');function Zk(s,t){qa(t,!1),cr.register(Mn,Rn,On,jn,Yi,Hi,Ui);let a=O(),r,n=O(!0),l=O(null),c=null;const d={on_hold:"On Hold",verifying:"Verifying",processing:"Processing",for_pickup:"For Pickup",released:"Released"},f=["rgba(253, 216, 53, 0.6)","rgba(92, 107, 192, 0.6)","rgba(255, 152, 0, 0.6)","rgba(0, 188, 212, 0.6)","rgba(76, 175, 80, 0.6)"],p=["rgb(253, 216, 53)","rgb(92, 107, 192)","rgb(255, 152, 0)","rgb(0, 188, 212)","rgb(76, 175, 80)"];async function h(){try{v(n,!0),v(l,null);const C=await da.get("/api/document-requests?action=stats");if(C.success)c=C.data,v(n,!1),setTimeout(()=>{e(a)&&g(C.data)},0);else throw new Error(C.error||"Failed to fetch document requests data")}catch(C){console.error("Error fetching document requests data:",C),v(l,C.message),v(n,!1)}}function g(C){if(!e(a)){console.warn("Canvas not yet available");return}r&&r.destroy();const D=Object.keys(d).map(L=>C[L]||0),S=e(a).getContext("2d");r=new cr(S,{type:"bar",data:{labels:Object.values(d),datasets:[{label:"Number of Requests",data:D,backgroundColor:f,borderColor:p,borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,suggestedMax:Math.max(...D)+2,ticks:{stepSize:1,callback(L){return Math.floor(L)},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim()},title:{display:!0,text:"Number of Requests",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:12,weight:"bold"}}},x:{ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,text:"Document Requests by Status",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(L){return`Requests: ${L.parsed.y||0}`}}}}}})}function b(){r&&c&&g(c)}Ya(()=>{h();const C=setInterval(()=>{h()},6e4),D=new MutationObserver(S=>{S.forEach(L=>{L.type==="attributes"&&L.attributeName==="data-theme"&&b()})});return D.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{clearInterval(C),D.disconnect()}}),ei(()=>{r&&r.destroy()}),Ls();var y=Xk(),k=o(y);{var A=C=>{var D=Qk();m(C,D)},T=C=>{var D=mt(),S=Je(D);{var L=j=>{var P=Kk(),Q=u(o(P),2),W=o(Q,!0);i(Q);var $=u(Q,2);i(P),q(()=>w(W,e(l))),ye("click",$,h),m(j,P)},F=j=>{var P=Jk();Ws(P,Q=>v(a,Q),()=>e(a)),m(j,P)};E(S,j=>{e(l)?j(L):j(F,!1)},!0)}m(C,D)};E(k,C=>{e(n)?C(A):C(T,!1)})}i(y),m(s,y),za()}function eA(s,t,a,r){v(t,!e(t)),v(a,!1),v(r,!1)}function tA(s,t,a,r){v(t,!e(t)),v(a,!1),v(r,!1)}function aA(s,t,a,r){v(t,!e(t)),v(a,!1),v(r,!1)}var sA=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),rA=_('<span class="admindocreq-placeholder">All Statuses</span>'),iA=(s,t)=>t(null),nA=(s,t,a)=>t(e(a)),oA=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),lA=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),cA=_('<span class="admindocreq-placeholder">All Document Types</span>'),dA=(s,t)=>t(null),uA=(s,t,a)=>t(e(a)),vA=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),fA=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),pA=_('<span class="admindocreq-placeholder">All Grades</span>'),mA=(s,t)=>t(null),hA=(s,t,a)=>t(e(a)),gA=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),_A=_('<div style="padding: 20px; background: #fee; border-radius: 8px; color: #c33; margin: 20px 0;"><strong>Error:</strong> </div>'),bA=_('<div style="padding: 40px; text-align: center; color: #666;"><span class="material-symbols-outlined" style="font-size: 48px; animation: spin 1s linear infinite;">sync</span> <p>Loading document requests...</p></div>'),yA=_('<div style="padding: 40px; text-align: center; color: #999;"><span class="material-symbols-outlined" style="font-size: 48px;">description</span> <p>No document requests found</p></div>'),wA=(s,t,a)=>t(e(a)),xA=(s,t,a)=>{(s.key==="Enter"||s.key===" ")&&t(e(a))},SA=_('<span class="material-symbols-outlined">pause_circle</span> <span>On Hold</span>',1),kA=_('<span class="material-symbols-outlined">fact_check</span> <span>Verifying</span>',1),AA=_('<span class="material-symbols-outlined">sync</span> <span>For Processing</span>',1),DA=_('<span class="material-symbols-outlined">hand_package</span> <span>For Pick up</span>',1),CA=_('<span class="material-symbols-outlined">check_circle</span> <span>Released</span>',1),TA=_('<span class="material-symbols-outlined">block</span> <span>Cancelled</span>',1),EA=_('<span class="material-symbols-outlined">cancel</span> <span>Rejected</span>',1),FA=_('<span class="chat-badge"> </span>'),NA=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">event_busy</span> <span> </span></div>'),$A=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">payments</span> <span> </span></div>'),PA=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">event</span> <span> </span></div>'),LA=_('<div role="button" tabindex="0"><div class="docreq-request-header"><div class="docreq-request-info"><div class="docreq-student-info"><h3 class="docreq-student-name"> </h3></div></div> <div class="docreq-action-buttons"><div><!></div> <button class="chat-indicator-btn"><span class="material-symbols-outlined">chat_bubble</span> <!></button></div></div> <div class="docreq-request-details"><div class="docreq-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">description</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!> <!> <!></div></div>'),MA=_('<div class="docreq-requests-grid"></div>'),IA=_('<div class="admin-document-requests-container"><div class="admin-docreq-header"><div class="admin-header-content"><h1 class="admin-page-title">Document Requests</h1> <p class="admin-page-subtitle">Manage and process student document requests</p></div></div> <div class="docreq-status-cards-section"><div class="docreq-status-cards-grid"><div class="docreq-status-card docreq-status-onhold"><div class="docreq-status-icon"><span class="material-symbols-outlined">pause_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">On Hold</p></div></div> <div class="docreq-status-card docreq-status-verifying"><div class="docreq-status-icon"><span class="material-symbols-outlined">fact_check</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Verifying</p></div></div> <div class="docreq-status-card docreq-status-processing"><div class="docreq-status-icon"><span class="material-symbols-outlined">sync</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Processing</p></div></div> <div class="docreq-status-card docreq-status-pickup"><div class="docreq-status-icon"><span class="material-symbols-outlined">hand_package</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">For Pickup</p></div></div> <div class="docreq-status-card docreq-status-released"><div class="docreq-status-icon"><span class="material-symbols-outlined">check_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Released</p></div></div> <div class="docreq-status-card docreq-status-cancelled"><div class="docreq-status-icon"><span class="material-symbols-outlined">block</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Cancelled</p></div></div></div></div> <div class="docreq-chart-section"><!></div> <div class="admin-docreq-filters-section"><div class="admin-section-header"><h2 class="admin-section-title">Filter Requests</h2> <p class="admin-section-subtitle">Search and filter document requests</p></div> <div class="admindocreq-filters-container"><div class="admindocreq-search-container"><input type="text" placeholder="Search by student name, ID, or document type..." class="admindocreq-search-input"/> <span class="material-symbols-outlined admindocreq-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Statuses</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Document Types</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Grades</span></div></button> <!></div></div></div></div> <div class="admin-docreq-requests-section"><div class="docreq-section-header"><div class="docreq-section-header-content"><div class="docreq-section-title-group"><h2 class="docreq-section-title">Document Requests</h2> <p class="docreq-section-subtitle">Manage and review all student document requests</p></div></div></div> <!> <!></div></div>');function RA(s,t){qa(t,!1);const a=O(),r=O(),n=O();let l=O([]),c=O(!0),d=!1,f=O(null),p=O(""),h=O(""),g=O(""),b=O(""),y=O(!1),k=O(!1),A=O(!1);const T=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],C=[{id:"tor",name:"Transcript of Records (TOR)",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"},{id:"good-moral",name:"Good Moral",description:"Certificate of good moral character"},{id:"grade-slip",name:"Grade Slip",description:"Grade slip for specific period"}],D=[{id:"on_hold",name:"On Hold",description:"Awaiting review"},{id:"verifying",name:"Verifying",description:"Under verification"},{id:"processing",name:"For Processing",description:"Currently being processed"},{id:"for_pickup",name:"For Pick Up",description:"Ready for pickup"},{id:"released",name:"Released",description:"Successfully released"},{id:"rejected",name:"Rejected",description:"Request denied"},{id:"cancelled",name:"Cancelled",description:"Cancelled by student"}],S=[{id:"on_hold",name:"On Hold"},{id:"verifying",name:"Verifying"},{id:"processing",name:"For Processing"},{id:"for_pickup",name:"For Pick Up"},{id:"released",name:"Released"}];function L(te){te?v(h,te.id):v(h,""),v(y,!1)}function F(te){te?v(g,te.id):v(g,""),v(k,!1)}function j(te){te?v(b,te.value):v(b,""),v(A,!1)}function P(te){te.target.closest(".admindocreq-status-filter")||v(y,!1),te.target.closest(".admindocreq-doctype-filter")||v(k,!1),te.target.closest(".admindocreq-grade-filter")||v(A,!1)}async function Q(te){try{el.open(te,D,S,R,X);const Be=await(await ns(`/api/document-requests?action=single&requestId=${te.requestId}`)).json();Be.success?(el.open(Be.data,D,S,R,X),await W(te.requestId)):console.error("Failed to fetch request details:",Be.error)}catch(J){console.error("Error fetching request details:",J)}}async function W(te){try{const Be=await(await ns("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"markAsRead",requestId:te})})).json();Be.success?v(l,e(l).map(Ge=>Ge.requestId===te?{...Ge,lastReadAt:new Date().toISOString()}:Ge)):console.error("Failed to mark messages as read:",Be.error)}catch(J){console.error("Error marking messages as read:",J)}}async function $(te=!1){try{te?d=!0:v(c,!0),v(f,null);const J=new URLSearchParams({action:"all"});if(e(p)&&J.append("search",e(p)),e(h)&&J.append("status",e(h)),e(g)){const at=C.find(gt=>gt.id===e(g));at&&J.append("documentType",at.name)}e(b)&&J.append("gradeLevel",e(b));const Ge=await(await ns(`/api/document-requests?${J.toString()}`)).json();Ge.success?v(l,Ge.data):v(f,Ge.error||"Failed to fetch document requests")}catch(J){console.error("Error fetching document requests:",J),v(f,"Failed to load document requests")}finally{v(c,!1),d=!1}}async function R(te,J){try{const Ge=await(await ns("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",requestId:te,...J})})).json();return Ge.success?(await $(),Se.success("Document request updated successfully!"),!0):(v(f,Ge.error||"Failed to update request"),Se.error(Ge.error||"Failed to update document request"),!1)}catch(Be){return console.error("Error updating request:",Be),v(f,"Failed to update request"),Se.error("An error occurred while updating the request"),!1}}async function X(te){try{const Be=await(await ns("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject",requestId:te})})).json();return Be.success?(await $(),Se.success("Document request rejected successfully"),!0):(v(f,Be.error||"Failed to reject request"),Se.error(Be.error||"Failed to reject document request"),!1)}catch(J){return console.error("Error rejecting request:",J),v(f,"Failed to reject request"),Se.error("An error occurred while rejecting the request"),!1}}function se(te){if(!te)return"N/A";const[J,Be,Ge]=te.split("-");return!J||!Be||!Ge?te:`${Be}/${Ge}/${J}`}function V(te){if(!te.messages||te.messages.length===0)return 0;const J=te.messages.filter(Ge=>Ge.authorRole!=="admin");if(J.length===0)return 0;if(!te.lastReadAt)return J.length;const Be=new Date(te.lastReadAt).getTime();return J.filter(Ge=>new Date(Ge.created_at).getTime()>Be).length}let re=O(!1),me;Ya(()=>($(),v(re,!0),me=setInterval(()=>{$(!0)},30*1e3),()=>{me&&clearInterval(me)}));let je=O(),de=O(""),ie=O(""),Pe=O(""),Ve=O("");_t(()=>e(h),()=>{v(a,D.find(te=>te.id===e(h)))}),_t(()=>e(g),()=>{v(r,C.find(te=>te.id===e(g)))}),_t(()=>e(b),()=>{v(n,T.find(te=>te.value===e(b)))}),_t(()=>(e(re),e(p),e(de),e(je)),()=>{e(re)&&e(p)!==e(de)&&(v(de,e(p)),clearTimeout(e(je)),v(je,setTimeout(()=>{$()},300)))}),_t(()=>(e(re),e(h),e(ie),e(g),e(Pe),e(b),e(Ve)),()=>{e(re)&&(e(h)!==e(ie)||e(g)!==e(Pe)||e(b)!==e(Ve))&&(v(ie,e(h)),v(Pe,e(g)),v(Ve,e(b)),$())}),Rs(),Ls();var Ze=IA();ye("click",Zs,P);var ve=u(o(Ze),2),Ce=o(ve),Qe=o(Ce),Xe=u(o(Qe),2),ze=o(Xe),We=o(ze,!0);i(ze),Bt(2),i(Xe),i(Qe);var Te=u(Qe,2),ue=u(o(Te),2),be=o(ue),ke=o(be,!0);i(be),Bt(2),i(ue),i(Te);var Fe=u(Te,2),Re=u(o(Fe),2),et=o(Re),$e=o(et,!0);i(et),Bt(2),i(Re),i(Fe);var ot=u(Fe,2),Me=u(o(ot),2),it=o(Me),ft=o(it,!0);i(it),Bt(2),i(Me),i(ot);var Ye=u(ot,2),Y=u(o(Ye),2),ce=o(Y),De=o(ce,!0);i(ce),Bt(2),i(Y),i(Ye);var U=u(Ye,2),ne=u(o(U),2),fe=o(ne),z=o(fe,!0);i(fe),Bt(2),i(ne),i(U),i(Ce),i(ve);var B=u(ve,2),I=o(B);Zk(I,{}),i(B);var G=u(B,2),Z=u(o(G),2),le=o(Z),N=o(le);aa(N),Bt(2),i(le);var M=u(le,2);let H;var pe=o(M);let ee;pe.__click=[eA,y,k,A];var Ae=o(pe);{var Ue=te=>{var J=sA(),Be=u(o(J),2),Ge=o(Be),at=o(Ge,!0);i(Ge),i(Be),i(J),q(()=>w(at,(e(a),x(()=>e(a).name)))),m(te,J)},Le=te=>{var J=rA();m(te,J)};E(Ae,te=>{e(a)?te(Ue):te(Le,!1)})}Bt(2),i(pe);var He=u(pe,2),Ie=o(He);let nt;Ie.__click=[iA,L];var bt=u(Ie,2);xt(bt,1,()=>D,te=>te.id,(te,J)=>{var Be=oA();let Ge;Be.__click=[nA,L,J];var at=u(o(Be),2),gt=o(at),Gt=o(gt,!0);i(gt);var _a=u(gt,2),ht=o(_a,!0);i(_a),i(at),i(Be),q(Ne=>{Ge=_e(Be,1,"admindocreq-dropdown-option",null,Ge,Ne),w(Gt,(e(J),x(()=>e(J).name))),w(ht,(e(J),x(()=>e(J).description)))},[()=>({selected:e(h)===e(J).id})]),m(te,Be)}),i(He),i(M);var pt=u(M,2);let vt;var Tt=o(pt);let Ot;Tt.__click=[tA,k,y,A];var la=o(Tt);{var sa=te=>{var J=lA(),Be=u(o(J),2),Ge=o(Be),at=o(Ge,!0);i(Ge),i(Be),i(J),q(()=>w(at,(e(r),x(()=>e(r).name)))),m(te,J)},zt=te=>{var J=cA();m(te,J)};E(la,te=>{e(r)?te(sa):te(zt,!1)})}Bt(2),i(Tt);var qt=u(Tt,2),Pt=o(qt);let Yt;Pt.__click=[dA,F];var Ut=u(Pt,2);xt(Ut,1,()=>C,te=>te.id,(te,J)=>{var Be=vA();let Ge;Be.__click=[uA,F,J];var at=u(o(Be),2),gt=o(at),Gt=o(gt,!0);i(gt);var _a=u(gt,2),ht=o(_a,!0);i(_a),i(at),i(Be),q(Ne=>{Ge=_e(Be,1,"admindocreq-dropdown-option",null,Ge,Ne),w(Gt,(e(J),x(()=>e(J).name))),w(ht,(e(J),x(()=>e(J).description)))},[()=>({selected:e(g)===e(J).id})]),m(te,Be)}),i(qt),i(pt);var Et=u(pt,2);let ta;var fa=o(Et);let oe;fa.__click=[aA,A,y,k];var Ee=o(fa);{var dt=te=>{var J=fA(),Be=u(o(J),2),Ge=o(Be),at=o(Ge,!0);i(Ge),i(Be),i(J),q(()=>w(at,(e(n),x(()=>e(n).label)))),m(te,J)},we=te=>{var J=pA();m(te,J)};E(Ee,te=>{e(n)?te(dt):te(we,!1)})}Bt(2),i(fa);var Oe=u(fa,2),lt=o(Oe);let Rt;lt.__click=[mA,j];var Ht=u(lt,2);xt(Ht,1,()=>T,te=>te.value,(te,J)=>{var Be=gA();let Ge;Be.__click=[hA,j,J];var at=u(o(Be),2),gt=o(at),Gt=o(gt,!0);i(gt);var _a=u(gt,2),ht=o(_a,!0);i(_a),i(at),i(Be),q(Ne=>{Ge=_e(Be,1,"admindocreq-dropdown-option",null,Ge,Ne),w(Gt,(e(J),x(()=>e(J).label))),w(ht,(e(J),x(()=>e(J).description)))},[()=>({selected:e(b)===e(J).value})]),m(te,Be)}),i(Oe),i(Et),i(Z),i(G);var rt=u(G,2),ka=u(o(rt),2);{var Zt=te=>{var J=_A(),Be=u(o(J));i(J),q(()=>w(Be,` ${e(f)??""}`)),m(te,J)};E(ka,te=>{e(f)&&te(Zt)})}var tt=u(ka,2);{var wt=te=>{var J=bA();m(te,J)},ge=te=>{var J=mt(),Be=Je(J);{var Ge=gt=>{var Gt=yA();m(gt,Gt)},at=gt=>{var Gt=MA();xt(Gt,5,()=>e(l),_a=>_a.id,(_a,ht)=>{var Ne=LA();Ne.__click=[wA,Q,ht],Ne.__keydown=[xA,Q,ht];var ct=o(Ne),Ft=o(ct),Mt=o(Ft),It=o(Mt),ra=o(It,!0);i(It),i(Mt),i(Ft);var ha=u(Ft,2),ca=o(ha),Qt=o(ca);{var va=he=>{var st=SA();Bt(2),m(he,st)},pa=he=>{var st=mt(),At=Je(st);{var kt=ia=>{var Ca=kA();Bt(2),m(ia,Ca)},Ct=ia=>{var Ca=mt(),jt=Je(Ca);{var qe=yt=>{var Lt=AA();Bt(2),m(yt,Lt)},Jt=yt=>{var Lt=mt(),Xt=Je(Lt);{var na=$a=>{var Ra=DA();Bt(2),m($a,Ra)},ja=$a=>{var Ra=mt(),Ba=Je(Ra);{var ts=Ga=>{var ss=CA();Bt(2),m(Ga,ss)},_s=Ga=>{var ss=mt(),La=Je(ss);{var Ha=Za=>{var Xa=TA();Bt(2),m(Za,Xa)},vs=Za=>{var Xa=mt(),rs=Je(Xa);{var is=bs=>{var ys=EA();Bt(2),m(bs,ys)};E(rs,bs=>{e(ht),x(()=>e(ht).status==="rejected")&&bs(is)},!0)}m(Za,Xa)};E(La,Za=>{e(ht),x(()=>e(ht).status==="cancelled")?Za(Ha):Za(vs,!1)},!0)}m(Ga,ss)};E(Ba,Ga=>{e(ht),x(()=>e(ht).status==="released")?Ga(ts):Ga(_s,!1)},!0)}m($a,Ra)};E(Xt,$a=>{e(ht),x(()=>e(ht).status==="for_pickup")?$a(na):$a(ja,!1)},!0)}m(yt,Lt)};E(jt,yt=>{e(ht),x(()=>e(ht).status==="processing")?yt(qe):yt(Jt,!1)},!0)}m(ia,Ca)};E(At,ia=>{e(ht),x(()=>e(ht).status==="verifying")?ia(kt):ia(Ct,!1)},!0)}m(he,st)};E(Qt,he=>{e(ht),x(()=>e(ht).status==="on_hold")?he(va):he(pa,!1)})}i(ca);var ua=u(ca,2),ba=u(o(ua),2);{var Ta=he=>{var st=FA(),At=o(st,!0);i(st),q(kt=>w(At,kt),[()=>(e(ht),x(()=>V(e(ht))))]),m(he,st)};E(ba,he=>{e(ht),x(()=>V(e(ht))>0)&&he(Ta)})}i(ua),i(ha),i(ct);var Pa=u(ct,2),Ea=o(Pa),K=u(o(Ea),2),xe=o(K,!0);i(K),i(Ea);var Ke=u(Ea,2),Dt=u(o(Ke),2),Wt=o(Dt,!0);i(Dt),i(Ke);var Nt=u(Ke,2),St=u(o(Nt),2),Na=o(St,!0);i(St),i(Nt);var Aa=u(Nt,2),ga=u(o(Aa),2),Da=o(ga);i(ga),i(Aa);var Vt=u(Aa,2),Kt=u(o(Vt),2),xa=o(Kt);i(Kt),i(Vt);var ya=u(Vt,2);{var Fa=he=>{var st=NA(),At=u(o(st),2),kt=o(At);i(At),i(st),q(()=>w(kt,`Cancelled: ${e(ht),x(()=>e(ht).cancelledDate)??""}`)),m(he,st)};E(ya,he=>{e(ht),x(()=>e(ht).status==="cancelled"&&e(ht).cancelledDate)&&he(Fa)})}var ma=u(ya,2);{var wa=he=>{var st=$A(),At=u(o(st),2),kt=o(At,!0);i(At),i(st),q(()=>w(kt,(e(ht),x(()=>e(ht).payment)))),m(he,st)};E(ma,he=>{e(ht),x(()=>e(ht).payment&&e(ht).payment!=="Free"&&!e(ht).payment.toLowerCase().includes("tentative"))&&he(wa)})}var Ia=u(ma,2);{var ae=he=>{var st=PA(),At=u(o(st),2),kt=o(At);i(At),i(st),q(Ct=>w(kt,`Tentative: ${Ct??""}`),[()=>(e(ht),x(()=>se(e(ht).tentativeDate)))]),m(he,st)};E(Ia,he=>{e(ht),x(()=>e(ht).tentativeDate)&&he(ae)})}i(Pa),i(Ne),q(he=>{_e(Ne,1,`docreq-request-card status-${e(ht),x(()=>e(ht).status)??""}-border`),w(ra,(e(ht),x(()=>e(ht).studentName))),_e(ca,1,`docreq-status-badge docreq-status-${e(ht),x(()=>e(ht).status)??""}`),$t(ua,"title",he),w(xe,(e(ht),x(()=>e(ht).studentId))),w(Wt,(e(ht),x(()=>e(ht).gradeLevel))),w(Na,(e(ht),x(()=>e(ht).documentType))),w(Da,`ID: ${e(ht),x(()=>e(ht).requestId)??""}`),w(xa,`Requested: ${e(ht),x(()=>e(ht).submittedDate)??""}`)},[()=>(e(ht),x(()=>V(e(ht))>0?`${V(e(ht))} unread message${V(e(ht))!==1?"s":""}`:"View messages"))]),m(_a,Ne)}),i(Gt),m(gt,Gt)};E(Be,gt=>{e(l),x(()=>e(l).length===0)?gt(Ge):gt(at,!1)},!0)}m(te,J)};E(tt,te=>{e(c)?te(wt):te(ge,!1)})}i(rt),i(Ze),q((te,J,Be,Ge,at,gt,Gt,_a,ht,Ne,ct,Ft,Mt,It,ra)=>{w(We,te),w(ke,J),w($e,Be),w(ft,Ge),w(De,at),w(z,gt),H=_e(M,1,"admindocreq-status-filter admindocreq-custom-dropdown",null,H,Gt),ee=_e(pe,1,"admindocreq-dropdown-trigger",null,ee,_a),nt=_e(Ie,1,"admindocreq-dropdown-option",null,nt,ht),vt=_e(pt,1,"admindocreq-doctype-filter admindocreq-custom-dropdown",null,vt,Ne),Ot=_e(Tt,1,"admindocreq-dropdown-trigger",null,Ot,ct),Yt=_e(Pt,1,"admindocreq-dropdown-option",null,Yt,Ft),ta=_e(Et,1,"admindocreq-grade-filter admindocreq-custom-dropdown",null,ta,Mt),oe=_e(fa,1,"admindocreq-dropdown-trigger",null,oe,It),Rt=_e(lt,1,"admindocreq-dropdown-option",null,Rt,ra)},[()=>(e(l),x(()=>e(l).filter(te=>te.status==="on_hold").length)),()=>(e(l),x(()=>e(l).filter(te=>te.status==="verifying").length)),()=>(e(l),x(()=>e(l).filter(te=>te.status==="processing").length)),()=>(e(l),x(()=>e(l).filter(te=>te.status==="for_pickup").length)),()=>(e(l),x(()=>e(l).filter(te=>te.status==="released").length)),()=>(e(l),x(()=>e(l).filter(te=>te.status==="cancelled").length)),()=>({open:e(y)}),()=>({selected:e(h)}),()=>({selected:e(h)===""}),()=>({open:e(k)}),()=>({selected:e(g)}),()=>({selected:e(g)===""}),()=>({open:e(A)}),()=>({selected:e(b)}),()=>({selected:e(b)===""})]),oa(N,()=>e(p),te=>v(p,te)),m(s,Ze),za()}Ps(["click","keydown"]);function OA(s,t,a,r,n){us.confirm("Change Password",`
			<div class="admin-settings-password-form">
				<div class="admin-settings-form-group">
					<label for="current-password">Current Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="new-password">New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{v(a,""),v(r,""),v(n,"")},{size:"medium"})}var jA=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),qA=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),zA=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),GA=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),VA=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),BA=_('<span class="material-symbols-outlined">check</span> Apply Date Changes',1),WA=_('<div class="admin-settings-container"><div class="admin-settings-header"><div class="admin-settings-header-content"><h1 class="admin-settings-page-title">Admin Settings</h1> <p class="admin-settings-page-subtitle">Manage system settings and configurations</p></div></div> <div class="admin-settings-section"><div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Current School Year</h3> <p class="admin-settings-item-description">The active academic year for the system</p></div> <div class="admin-settings-item-value"><span class="admin-settings-current-year"> </span></div></div></div></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">School Year Dates</h3> <p class="admin-settings-item-description">Set the start and end dates for classes</p></div></div> <div class="admin-settings-dates-section"><div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="start-date" class="admin-settings-date-label">Start of Classes</label> <input id="start-date" type="date"/></div> <div class="admin-settings-date-item"><label for="end-date" class="admin-settings-date-label">End of Classes</label> <input id="end-date" type="date"/></div></div> <div class="admin-settings-quarters-section svelte-jysw9o"><h4 class="admin-settings-quarters-title svelte-jysw9o">Quarter Schedules</h4> <div class="admin-settings-quarters-row svelte-jysw9o"><div class="admin-settings-quarter-group quarter-1 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">1st Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q1-start" class="admin-settings-date-label">Start</label> <input id="q1-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q1-end" class="admin-settings-date-label">End</label> <input id="q1-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-2 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">2nd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q2-start" class="admin-settings-date-label">Start</label> <input id="q2-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q2-end" class="admin-settings-date-label">End</label> <input id="q2-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-3 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">3rd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q3-start" class="admin-settings-date-label">Start</label> <input id="q3-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q3-end" class="admin-settings-date-label">End</label> <input id="q3-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-4 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">4th Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q4-start" class="admin-settings-date-label">Start</label> <input id="q4-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q4-end" class="admin-settings-date-label">End</label> <input id="q4-end" type="date"/></div></div> <!></div></div></div> <!></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><!></button></div></div></div></div> <div class="admin-settings-section"><div class="admin-settings-section-header"><h2 class="admin-settings-section-title">Account Security</h2> <p class="admin-settings-section-subtitle">Manage your account password and security settings</p></div> <div class="admin-settings-security-row"><div class="admin-settings-security-card"><div class="admin-settings-security-content-container"><div class="admin-settings-security-icon"><span class="material-symbols-outlined">lock</span></div> <div class="admin-settings-security-content"><div class="admin-settings-security-label">Password</div> <div class="admin-settings-security-value">Change your account password for security</div></div></div> <div class="admin-settings-security-actions"><button class="admin-settings-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>');function HA(s,t){qa(t,!0);let a=ut(!1),r=ut(!1),n=ut("2024-2025"),l=ut(""),c=ut("");function d(we,Oe){if(!we||!Oe)return"2024-2025";const lt=new Date(we),Rt=new Date(Oe),Ht=lt.getFullYear(),rt=Rt.getFullYear();return rt>Ht?`${Ht}-${rt}`:`${Ht}-${Ht}`}let f=ut(""),p=ut(""),h=ut(""),g=ut(""),b=ut(""),y=ut(""),k=ut(""),A=ut("");async function T(){try{v(a,!0);const we=await da.get("/api/admin-settings");if(we.success){let lt=function(Rt){if(!Rt)return Rt;const[Ht,rt,ka]=Rt.split("-");return`${ka}-${Ht}-${rt}`};const Oe=we.data;v(l,lt(Oe.school_year_start_date)||"",!0),v(c,lt(Oe.school_year_end_date)||"",!0),v(n,d(e(l),e(c)),!0),v(f,lt(Oe.quarter_1_start_date)||"",!0),v(p,lt(Oe.quarter_1_end_date)||"",!0),v(h,lt(Oe.quarter_2_start_date)||"",!0),v(g,lt(Oe.quarter_2_end_date)||"",!0),v(b,lt(Oe.quarter_3_start_date)||"",!0),v(y,lt(Oe.quarter_3_end_date)||"",!0),v(k,lt(Oe.quarter_4_start_date)||"",!0),v(A,lt(Oe.quarter_4_end_date)||"",!0)}}catch(we){console.error("Error loading admin settings:",we),ds("Failed to load admin settings")}finally{v(a,!1)}}async function C(){try{let we=function(Rt){if(!Rt)return Rt;const[Ht,rt,ka]=Rt.split("-");return`${rt}-${ka}-${Ht}`};v(r,!0);const Oe={current_school_year:e(n),school_year_start_date:we(e(l)),school_year_end_date:we(e(c)),quarter_1_start_date:we(e(f)),quarter_1_end_date:we(e(p)),quarter_2_start_date:we(e(h)),quarter_2_end_date:we(e(g)),quarter_3_start_date:we(e(b)),quarter_3_end_date:we(e(y)),quarter_4_start_date:we(e(k)),quarter_4_end_date:we(e(A))},lt=await da.put("/api/admin-settings",{settings:Oe});if(lt.success)jr("Admin settings saved successfully");else throw new Error(lt.error||"Failed to save settings")}catch(we){console.error("Error saving admin settings:",we),ds("Failed to save admin settings")}finally{v(r,!1)}}let D=ut("");Es(()=>{if(e(l)&&e(c)){const we=new Date(e(l)),Oe=new Date(e(c));we>=Oe?v(D,"Start date must be before end date"):(v(D,""),v(n,d(e(l),e(c)),!0))}else v(D,"")});let S={quarter1:"",quarter2:"",quarter3:"",quarter4:""};Es(()=>{if(e(f)&&e(p)){const we=new Date(e(f)),Oe=new Date(e(p));we>=Oe?S.quarter1="1st Quarter start date must be before end date":S.quarter1=""}else S.quarter1="";if(e(h)&&e(g)){const we=new Date(e(h)),Oe=new Date(e(g));we>=Oe?S.quarter2="2nd Quarter start date must be before end date":S.quarter2=""}else S.quarter2="";if(e(b)&&e(y)){const we=new Date(e(b)),Oe=new Date(e(y));we>=Oe?S.quarter3="3rd Quarter start date must be before end date":S.quarter3=""}else S.quarter3="";if(e(k)&&e(A)){const we=new Date(e(k)),Oe=new Date(e(A));we>=Oe?S.quarter4="4th Quarter start date must be before end date":S.quarter4=""}else S.quarter4=""});async function L(){if(e(D)){console.error("Cannot apply changes: Date validation error");return}if(Object.values(S).some(Oe=>Oe!=="")){console.error("Cannot apply changes: Quarter validation errors");return}await C()}let F=ut(""),j=ut(""),P=ut(""),Q=ut(!1);function W(we){const Oe=document.getElementById(we),Rt=Oe.nextElementSibling.querySelector(".password-eye-icon");Oe.type==="password"?(Oe.type="text",Rt.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(Oe.type="password",Rt.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=W);async function $(){const we=document.getElementById("current-password"),Oe=document.getElementById("new-password"),lt=document.getElementById("confirm-password");if(!we||!Oe||!lt){ds("Password form inputs not found");return}const Rt=we.value,Ht=Oe.value,rt=lt.value;if(!Rt){ds("Current password is required");return}if(!Ht){ds("New password is required");return}if(Ht!==rt){ds("New passwords do not match");return}if(Ht.length<8){ds("Password must be at least 8 characters long");return}if(Rt===Ht){ds("New password must be different from current password");return}try{v(Q,!0);const ka=await da.post("/api/change-password",{currentPassword:Rt,newPassword:Ht});ka.success?(we.value="",Oe.value="",lt.value="",jr("Password changed successfully!"),us.close()):ds(ka.error||"Failed to change password")}catch(ka){console.error("Password change error:",ka),ds(ka.message||"Failed to change password")}finally{v(Q,!1)}}Ya(()=>{T()});var R=WA(),X=u(o(R),2),se=o(X),V=o(se),re=o(V),me=u(o(re),2),je=o(me),de=o(je,!0);i(je),i(me),i(re),i(V),i(se);var ie=u(se,2),Pe=o(ie),Ve=u(o(Pe),2),Ze=o(Ve),ve=o(Ze),Ce=u(o(ve),2);aa(Ce);let Qe;i(ve);var Xe=u(ve,2),ze=u(o(Xe),2);aa(ze);let We;i(Xe),i(Ze);var Te=u(Ze,2),ue=u(o(Te),2),be=o(ue),ke=u(o(be),2),Fe=o(ke),Re=u(o(Fe),2);aa(Re);let et;i(Fe);var $e=u(Fe,2),ot=u(o($e),2);aa(ot);let Me;i($e),i(ke);var it=u(ke,2);{var ft=we=>{var Oe=jA(),lt=u(o(Oe));i(Oe),q(()=>w(lt,` ${S.quarter1??""}`)),m(we,Oe)};E(it,we=>{S.quarter1&&we(ft)})}i(be);var Ye=u(be,2),Y=u(o(Ye),2),ce=o(Y),De=u(o(ce),2);aa(De);let U;i(ce);var ne=u(ce,2),fe=u(o(ne),2);aa(fe);let z;i(ne),i(Y);var B=u(Y,2);{var I=we=>{var Oe=qA(),lt=u(o(Oe));i(Oe),q(()=>w(lt,` ${S.quarter2??""}`)),m(we,Oe)};E(B,we=>{S.quarter2&&we(I)})}i(Ye);var G=u(Ye,2),Z=u(o(G),2),le=o(Z),N=u(o(le),2);aa(N);let M;i(le);var H=u(le,2),pe=u(o(H),2);aa(pe);let ee;i(H),i(Z);var Ae=u(Z,2);{var Ue=we=>{var Oe=zA(),lt=u(o(Oe));i(Oe),q(()=>w(lt,` ${S.quarter3??""}`)),m(we,Oe)};E(Ae,we=>{S.quarter3&&we(Ue)})}i(G);var Le=u(G,2),He=u(o(Le),2),Ie=o(He),nt=u(o(Ie),2);aa(nt);let bt;i(Ie);var pt=u(Ie,2),vt=u(o(pt),2);aa(vt);let Tt;i(pt),i(He);var Ot=u(He,2);{var la=we=>{var Oe=GA(),lt=u(o(Oe));i(Oe),q(()=>w(lt,` ${S.quarter4??""}`)),m(we,Oe)};E(Ot,we=>{S.quarter4&&we(la)})}i(Le),i(ue),i(Te);var sa=u(Te,2);{var zt=we=>{var Oe=VA(),lt=u(o(Oe));i(Oe),q(()=>w(lt,` ${e(D)??""}`)),m(we,Oe)};E(sa,we=>{e(D)&&we(zt)})}i(Ve);var qt=u(Ve,2),Pt=o(qt);Pt.__click=L;var Yt=o(Pt);{var Ut=we=>{var Oe=Sa("Saving...");m(we,Oe)},Et=we=>{var Oe=BA();Bt(),m(we,Oe)};E(Yt,we=>{e(r)?we(Ut):we(Et,!1)})}i(Pt),i(qt),i(Pe),i(ie),i(X);var ta=u(X,2),fa=u(o(ta),2),oe=o(fa),Ee=u(o(oe),2),dt=o(Ee);dt.__click=[OA,$,F,j,P],i(Ee),i(oe),i(fa),i(ta),i(R),q((we,Oe,lt,Rt,Ht,rt,ka,Zt,tt,wt)=>{w(de,e(n)),Qe=_e(Ce,1,"admin-settings-date-input",null,Qe,we),We=_e(ze,1,"admin-settings-date-input",null,We,Oe),et=_e(Re,1,"admin-settings-date-input quarter-1-input",null,et,lt),Me=_e(ot,1,"admin-settings-date-input quarter-1-input",null,Me,Rt),U=_e(De,1,"admin-settings-date-input quarter-2-input",null,U,Ht),z=_e(fe,1,"admin-settings-date-input quarter-2-input",null,z,rt),M=_e(N,1,"admin-settings-date-input quarter-3-input",null,M,ka),ee=_e(pe,1,"admin-settings-date-input quarter-3-input",null,ee,Zt),bt=_e(nt,1,"admin-settings-date-input quarter-4-input",null,bt,tt),Tt=_e(vt,1,"admin-settings-date-input quarter-4-input",null,Tt,wt),Pt.disabled=e(r)||e(a)||!!e(D)||S.quarter1||S.quarter2||S.quarter3||S.quarter4||!e(l)||!e(c)},[()=>({error:e(D)}),()=>({error:e(D)}),()=>({error:S.quarter1}),()=>({error:S.quarter1}),()=>({error:S.quarter2}),()=>({error:S.quarter2}),()=>({error:S.quarter3}),()=>({error:S.quarter3}),()=>({error:S.quarter4}),()=>({error:S.quarter4})]),oa(Ce,()=>e(l),we=>v(l,we)),oa(ze,()=>e(c),we=>v(c,we)),oa(Re,()=>e(f),we=>v(f,we)),oa(ot,()=>e(p),we=>v(p,we)),oa(De,()=>e(h),we=>v(h,we)),oa(fe,()=>e(g),we=>v(g,we)),oa(N,()=>e(b),we=>v(b,we)),oa(pe,()=>e(y),we=>v(y,we)),oa(nt,()=>e(k),we=>v(k,we)),oa(vt,()=>e(A),we=>v(A,we)),m(s,R),za()}Ps(["click"]);var UA=_('<meta name="description" content="High School Student Information System"/>'),YA=_('<div><!> <main class="content-area"><!></main> <!></div>'),QA=_('<div><!> <main class="content-area"><!></main> <!></div>'),KA=_('<div><!> <main class="content-area"><!></main> <!></div>'),JA=_('<div class="app-container"><!></div>');function rD(s,t){qa(t,!0);let a=ut(void 0);Es(()=>gs.subscribe(R=>{v(a,R,!0)}));let r=ut("grades"),n=ut(null),l=ut("students"),c=ut("dashboard"),d=ut(!1),f=ut(!1),p=ut(!1);function h($){typeof $=="string"?(v(r,$,!0),v(n,null)):(v(r,$.detail.section,!0),$.detail.requestId?v(n,$.detail.requestId,!0):v(n,null))}function g($){typeof $=="string"?v(l,$,!0):v(l,$.detail.section,!0),(typeof $=="string"?$:$.detail.section)!=="class-list"&&v(k,null)}function b($){const{yearLevel:R,sectionName:X,sectionId:se}=$.detail;v(k,{yearLevel:R,sectionName:X,sectionId:se},!0),v(l,"class-list")}function y(){v(k,null),v(l,"students")}let k=ut(null);function A($){v(c,$.detail.section,!0)}function T(){v(c,"settings")}function C(){v(d,!e(d))}function D(){v(f,!e(f))}function S(){v(p,!e(p))}async function L(){await gs.logout(),v(r,"grades"),v(l,"students"),v(c,"dashboard")}let F=ea(()=>e(a)?.isAuthenticated?e(a).userType==="student"?"Student Portal - High School":e(a).userType==="teacher"?"Teacher Portal - High School":e(a).userType==="admin"?"Admin Portal - High School":"High School Student Information System":"Login - High School Student Information System");var j=JA();Xd($=>{var R=UA();q(()=>Zd.title=e(F)),m($,R)});var P=o(j);{var Q=$=>{Yu($,{})},W=$=>{var R=mt(),X=Je(R);{var se=re=>{var me=YA();let je;var de=o(me);{let Ce=ea(()=>e(a).userData?.name||"Student"),Qe=ea(()=>e(a).userData?.firstName||"Student"),Xe=ea(()=>e(a).userData?.gender||"male"),ze=ea(()=>e(a).userData?.accountNumber||"N/A"),We=ea(()=>e(a).userData?.profileImage);ov(de,{get studentName(){return e(Ce)},get firstName(){return e(Qe)},get gender(){return e(Xe)},get accountNumber(){return e(ze)},get profileImage(){return e(We)},onlogout:L,onToggleNavRail:C,onnavigate:h})}var ie=u(de,2),Pe=o(ie);{var Ve=Ce=>{Pv(Ce,{})},Ze=Ce=>{var Qe=mt(),Xe=Je(Qe);{var ze=Te=>{Ig(Te,{})},We=Te=>{var ue=mt(),be=Je(ue);{var ke=Re=>{s_(Re,{})},Fe=Re=>{var et=mt(),$e=Je(et);{var ot=it=>{g_(it,{})},Me=it=>{var ft=mt(),Ye=Je(ft);{var Y=De=>{q_(De,{get openRequestId(){return e(n)}})},ce=De=>{var U=mt(),ne=Je(U);{var fe=B=>{ub(B,{onnavigate:h})},z=B=>{var I=mt(),G=Je(I);{var Z=le=>{Ib(le,{})};E(G,le=>{e(r)==="todo"&&le(Z)},!0)}m(B,I)};E(ne,B=>{e(r)==="notifications"?B(fe):B(z,!1)},!0)}m(De,U)};E(Ye,De=>{e(r)==="documents"?De(Y):De(ce,!1)},!0)}m(it,ft)};E($e,it=>{e(r)==="schedule"?it(ot):it(Me,!1)},!0)}m(Re,et)};E(be,Re=>{e(r)==="ranking"?Re(ke):Re(Fe,!1)},!0)}m(Te,ue)};E(Xe,Te=>{e(r)==="grades"?Te(ze):Te(We,!1)},!0)}m(Ce,Qe)};E(Pe,Ce=>{e(r)==="profile"?Ce(Ve):Ce(Ze,!1)})}i(ie);var ve=u(ie,2);fv(ve,{get activeSection(){return e(r)},get isNavRailVisible(){return e(d)},onnavigate:h}),i(me),q(Ce=>je=_e(me,1,"student-portal",null,je,Ce),[()=>({"nav-rail-collapsed":!e(d)})]),m(re,me)},V=re=>{var me=mt(),je=Je(me);{var de=Pe=>{var Ve=QA();let Ze;var ve=o(Ve);{let Te=ea(()=>e(a).userData?.name||"Teacher"),ue=ea(()=>e(a).userData?.firstName||"Teacher"),be=ea(()=>e(a).userData?.gender||"male"),ke=ea(()=>e(a).userData?.accountNumber||"N/A"),Fe=ea(()=>e(a).userData?.profileImage);Wb(ve,{get teacherName(){return e(Te)},get firstName(){return e(ue)},get gender(){return e(be)},get accountNumber(){return e(ke)},get profileImage(){return e(Fe)},onlogout:L,onToggleNavRail:D,onnavigate:g})}var Ce=u(ve,2),Qe=o(Ce);{var Xe=Te=>{by(Te,{})},ze=Te=>{var ue=mt(),be=Je(ue);{var ke=Re=>{Oy(Re,{})},Fe=Re=>{var et=mt(),$e=Je(et);{var ot=it=>{Dc(it,{onNavigateToClassList:b})},Me=it=>{var ft=mt(),Ye=Je(ft);{var Y=De=>{E1(De,{get selectedClass(){return e(k)},onBackToClassManagement:y})},ce=De=>{var U=mt(),ne=Je(U);{var fe=B=>{e2(B,{})},z=B=>{Dc(B,{onNavigateToClassList:b})};E(ne,B=>{e(l)==="advisory"?B(fe):B(z,!1)},!0)}m(De,U)};E(Ye,De=>{e(l)==="class-list"&&e(k)?De(Y):De(ce,!1)},!0)}m(it,ft)};E($e,it=>{e(l)==="students"?it(ot):it(Me,!1)},!0)}m(Re,et)};E(be,Re=>{e(l)==="schedule"?Re(ke):Re(Fe,!1)},!0)}m(Te,ue)};E(Qe,Te=>{e(l)==="profile"?Te(Xe):Te(ze,!1)})}i(Ce);var We=u(Ce,2);{let Te=ea(()=>e(a).userData?.id);Jb(We,{get teacherActiveSection(){return e(l)},get teacherNavRailVisible(){return e(f)},onnavigate:g,get teacherId(){return e(Te)}})}i(Ve),q(Te=>Ze=_e(Ve,1,"teacher-portal",null,Ze,Te),[()=>({"nav-rail-collapsed":!e(f)})]),m(Pe,Ve)},ie=Pe=>{var Ve=mt(),Ze=Je(Ve);{var ve=Ce=>{var Qe=KA();let Xe;var ze=o(Qe);{let Fe=ea(()=>e(a).userData?.name||"Admin"),Re=ea(()=>e(a).userData?.firstName||"Admin"),et=ea(()=>e(a).userData?.gender||"male"),$e=ea(()=>e(a).userData?.accountNumber||"N/A"),ot=ea(()=>e(a).userData?.profileImage);c2(ze,{get adminName(){return e(Fe)},get firstName(){return e(Re)},get gender(){return e(et)},get accountNumber(){return e($e)},get profileImage(){return e(ot)},onlogout:L,onToggleNavRail:S,onNavigateToSettings:T})}var We=u(ze,2),Te=o(We);{var ue=Fe=>{e0(Fe,{})},be=Fe=>{var Re=mt(),et=Je(Re);{var $e=Me=>{V0(Me,{})},ot=Me=>{var it=mt(),ft=Je(it);{var Ye=ce=>{vw(ce,{})},Y=ce=>{var De=mt(),U=Je(De);{var ne=z=>{Mw(z,{})},fe=z=>{var B=mt(),I=Je(B);{var G=le=>{Xw(le,{})},Z=le=>{var N=mt(),M=Je(N);{var H=ee=>{ak(ee)},pe=ee=>{var Ae=mt(),Ue=Je(Ae);{var Le=Ie=>{Yk(Ie,{})},He=Ie=>{var nt=mt(),bt=Je(nt);{var pt=Tt=>{Nk(Tt,{})},vt=Tt=>{var Ot=mt(),la=Je(Ot);{var sa=qt=>{RA(qt,{})},zt=qt=>{var Pt=mt(),Yt=Je(Pt);{var Ut=Et=>{HA(Et,{})};E(Yt,Et=>{e(c)==="settings"&&Et(Ut)},!0)}m(qt,Pt)};E(la,qt=>{e(c)==="document-requests"?qt(sa):qt(zt,!1)},!0)}m(Tt,Ot)};E(bt,Tt=>{e(c)==="subjects-and-activities"?Tt(pt):Tt(vt,!1)},!0)}m(Ie,nt)};E(Ue,Ie=>{e(c)==="department-management"?Ie(Le):Ie(He,!1)},!0)}m(ee,Ae)};E(M,ee=>{e(c)==="schedule-management"?ee(H):ee(pe,!1)},!0)}m(le,N)};E(I,le=>{e(c)==="student-grades-list"?le(G):le(Z,!1)},!0)}m(z,B)};E(U,z=>{e(c)==="archived-students"?z(ne):z(fe,!1)},!0)}m(ce,De)};E(ft,ce=>{e(c)==="student-masterlist"?ce(Ye):ce(Y,!1)},!0)}m(Me,it)};E(et,Me=>{e(c)==="account-creation"?Me($e):Me(ot,!1)},!0)}m(Fe,Re)};E(Te,Fe=>{e(c)==="dashboard"?Fe(ue):Fe(be,!1)})}i(We);var ke=u(We,2);F2(ke,{get adminActiveSection(){return e(c)},get adminNavRailVisible(){return e(p)},onnavigate:A}),i(Qe),q(Fe=>Xe=_e(Qe,1,"admin-portal",null,Xe,Fe),[()=>({"nav-rail-collapsed":!e(p)})]),m(Ce,Qe)};E(Ze,Ce=>{e(a).userType==="admin"&&Ce(ve)},!0)}m(Pe,Ve)};E(je,Pe=>{e(a).userType==="teacher"?Pe(de):Pe(ie,!1)},!0)}m(re,me)};E(X,re=>{e(a).userType==="student"?re(se):re(V,!1)},!0)}m($,R)};E(P,$=>{e(a)?.isAuthenticated?$(W,!1):$(Q)})}i(j),m(s,j),za()}export{rD as component};
