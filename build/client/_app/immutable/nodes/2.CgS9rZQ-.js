const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../assets/odometer-theme-default.DMiGbRSv.css"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{h as ai,aQ as Ds,q as Yt,ae as ba,_ as As,ad as Bt,Q as s,t as n,z as t,A as a,B as r,l as e,w as b,C as o,x as i,y as Wt,v as va,aV as et,aS as R,ah as jt,R as Si,aP as Gs,i as Is,ag as ja,O as h,aX as gs,aY as at,aZ as ps,m as us,aT as Ts,Z as js,ai as $t,a_ as Sr,j as l,a$ as yr,b0 as xi,b1 as ki,aR as Di,b2 as Ai,aU as Ti,b3 as Ni}from"../chunks/BYO0ofv7.js";import{i as m,p as qt,a as ns,c as fs,b as ur,d as ti}from"../chunks/DpPKuoqJ.js";import{d as $i,c as ls,f as Os,r as Xa,s as Z,g as vr,a as Fa,b as tt,e as xa,i as Jt,m as is,j as Xt,h as Ci,t as ye,k as ji,T as Ei,l as qi}from"../chunks/mQ7MoB3J.js";import{i as cs}from"../chunks/BHKFJT1E.js";import{_ as si}from"../chunks/D9Z9MdNV.js";const Fi=!0;function Zt(V,d,_,w){var v=V.__style;if(ai||v!==d){var f=$i(d);(!ai||f!==V.getAttribute("style"))&&(f==null?V.removeAttribute("style"):V.style.cssText=f),V.__style=d}return w}function xr(V){return function(...d){var _=d[0];return _.stopPropagation(),V?.apply(this,d)}}function ks(V){return function(...d){var _=d[0];return _.preventDefault(),V?.apply(this,d)}}const vi=Fi,ui=V=>{const d=/^[A-Z]{3}-\d{4}-\d{4}$/;return V?d.test(V)?"":"Please enter a valid ID Number (e.g., STU-2025-0001)":"ID Number is required"},mi=V=>V?"":"Password is required",pi=()=>document.documentElement.getAttribute("data-theme")||"light",Li=V=>{document.documentElement.setAttribute("data-theme",V),localStorage.setItem("theme",V)},Ii=()=>{const d=pi()==="dark"?"light":"dark";return Li(d),d},Pi=async({accountNumber:V,password:d})=>{try{const w=await(await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountNumber:V,password:d})})).json();if(w.success){const v={id:w.user.id,name:w.user.name,firstName:w.user.firstName,gender:w.user.gender,accountNumber:w.user.accountNumber,accountType:w.user.accountType,isAuthenticated:!0};return ls.login(v.accountType,v),Os(`Login successful! Welcome back, ${v.name}`),console.log("Login successful:",{accountNumber:V,userType:v.accountType}),v}else throw new Error(w.error||"Invalid credentials. Please try again.")}catch(_){const w=_.message||"Network error. Please try again.";throw new Error(w)}};function Gi(V,d){const _=Ii();s(d,_==="dark")}const Ri=(V,d,_)=>{s(d,V.target.value,!0),e(_).idNumber&&s(_,{...e(_),idNumber:ui(e(d))},!0)},Mi=(V,d,_)=>{s(d,V.target.value,!0),e(_).password&&s(_,{...e(_),password:mi(e(d))},!0)},ri=(V,d)=>{V.key==="Enter"&&(V.preventDefault(),d(V))};async function Oi(V,d,_,w,v){s(d,""),s(_,["","","","","",""],!0),s(w,5),await v({preventDefault:()=>{}})}var Vi=n('<div class="error-text"> </div>'),Ui=(V,d)=>{V.preventDefault(),V.stopPropagation(),s(d,!e(d))},Yi=(V,d)=>{V.key==="Enter"&&(V.preventDefault(),V.stopPropagation(),s(d,!e(d)))},Wi=n('<div class="error-text"> </div>'),Hi=n('<div class="error-message-item"> </div>'),Qi=n('<div class="error-message-item"> </div>'),Bi=n('<div class="error-message-item"> </div>'),Ji=n('<div class="login-error-container"><span class="material-symbols-outlined">error</span> <div class="error-messages"><!> <!> <!></div></div>'),zi=n('<div class="login-loading-spinner"></div>'),Ki=n("<span>Login</span>"),Zi=n('<div class="login-header"><h1 class="login-title">Login</h1> <h2 class="login-subtitle">Enter your account details</h2></div> <form class="login-form" novalidate="" autocomplete="off"><div class="form-field"><div><span class="leading-icon material-symbols-outlined">badge</span> <input type="text" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="idnumber-input">ID Number</label></div> <!></div> <div class="form-field"><div><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="password-input">Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div> <!></div> <!> <button id="login-submit-btn" type="submit" class="custom-filled-button login-submit" aria-label="Sign in"><!></button> <button type="button" id="forgot-password-btn" class="custom-text-button forgot-password" aria-label="forgot-password">Forgot Password</button></form>',1),Xi=n('<div class="success-message-box"><span class="material-symbols-outlined">check_circle</span> <span> </span></div>'),en=n('<div class="error-message-box"><span class="material-symbols-outlined">error</span> <span> </span></div>'),an=n('<div class="login-loading-spinner"></div>'),tn=n('<span class="material-symbols-outlined">send</span> <span>Send Code</span>',1),sn=n('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">email</span> <input type="email" autocomplete="email" class="text-input" placeholder=" " required/> <label class="text-label">Email Address</label></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),rn=n('<input type="text" maxlength="1" inputmode="numeric" autocomplete="off" class="code-box" required/>'),nn=n('<div class="info-text"> </div>'),on=n('<div class="verification-loading"><div class="login-loading-spinner"></div> <span>Verifying code...</span></div>'),ln=n('<div class="login-loading-spinner"></div>'),dn=n('<span class="material-symbols-outlined">refresh</span> <span>Resend Code</span>',1),cn=n('<form class="login-form"><div class="form-field"><div class="code-boxes-container"></div> <!> <!></div> <button type="button" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),vn=(V,d)=>{V.preventDefault(),s(d,!e(d))},un=(V,d)=>{V.preventDefault(),s(d,!e(d))},mn=n('<div class="login-loading-spinner"></div>'),pn=n("<span>Reset Password</span>"),fn=n('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="new-password" class="text-input" placeholder=" " required/> <label class="text-label">New Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock_reset</span> <input autocomplete="new-password" class="text-input" placeholder=" " required/> <label class="text-label">Confirm Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button></form>'),_n=n('<div class="login-header"><h1 class="login-title"> </h1> <h2 class="login-subtitle"> </h2></div> <!> <!> <!> <!> <!>',1),gn=n('<div class="login-container"><button class="theme-toggle-btn" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="left-side"><!></div> <div class="right-side"><div class="welcome-text"><h1 class="welcome-title"> </h1> <p class="welcome-subtitle"> </p></div></div></div>');function hn(V,d){Yt(d,!0);let _=ba(""),w=ba(""),v=ba(!1),f=ba(!1),p=ba(As({idNumber:"",password:"",general:""})),g=ba(!1),C=ba(1),k=ba(""),N=ba(""),E=ba(""),q=ba(As(["","","","","",""])),D=ba(""),P=ba(""),Y=ba(!1),ee=ba(!1),H=ba(""),U=ba(5),A=ba(!1);Bt(()=>{const We=pi();s(A,We==="dark")});const M=async We=>{We.preventDefault(),s(p,{idNumber:"",password:"",general:""},!0);const sa=ui(e(_)),xe=mi(e(w));if(sa||xe){s(p,{idNumber:sa,password:xe,general:""},!0);return}s(v,!0);try{await Pi({accountNumber:e(_),password:e(w)})}catch(ge){s(p,{...e(p),general:ge.message},!0)}finally{s(v,!1)}};function ae(){s(g,!e(g)),e(g)||(s(C,1),s(k,""),s(N,""),s(E,""),s(q,["","","","","",""],!0),s(D,""),s(P,""),s(p,{idNumber:"",password:"",general:""},!0),s(H,""),s(U,5))}function Se(We,sa){const ge=sa.target.value.replace(/\D/g,"");if(ge.length>0)if(e(q)[We]=ge[ge.length-1],s(E,e(q).join(""),!0),We<5&&ge){const Ie=document.getElementById(`code-digit-${We+1}`);Ie&&Ie.focus()}else We===5&&e(q).every(Ie=>Ie!=="")&&le({preventDefault:()=>{}});else e(q)[We]="",s(E,e(q).join(""),!0)}function B(We,sa){if(sa.key==="Backspace"&&!e(q)[We]&&We>0){const xe=document.getElementById(`code-digit-${We-1}`);xe&&xe.focus()}}function ue(We){We.preventDefault();const sa=We.clipboardData.getData("text").replace(/\D/g,"").slice(0,6);if(sa.length>0){const xe=sa.split("");s(q,[...xe,...Array(6-xe.length).fill("")],!0),s(E,e(q).join(""),!0);const ge=Math.min(xe.length,5),Ie=document.getElementById(`code-digit-${ge}`);Ie&&Ie.focus(),sa.length===6&&le({preventDefault:()=>{}})}}function S(We){return We?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(We)?"":"Please enter a valid email address":"Email address is required"}function y(We){return We?/^\d{6}$/.test(We)?"":"Code must be 6 digits":"Verification code is required"}function ce(We){return We?We.length<6?"Password must be at least 6 characters":"":"Password is required"}async function ve(We){We.preventDefault(),s(p,{idNumber:"",password:"",general:""},!0),s(H,"");const sa=S(e(k));if(sa){s(p,{...e(p),general:sa},!0);return}s(v,!0);try{const xe=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(k).toLowerCase().trim()})}),ge=await xe.json();if(!xe.ok)throw new Error(ge.error||"Failed to send reset code");s(N,ge.resetToken,!0),s(H,"A verification code has been sent to your email address."),s(C,2)}catch(xe){s(p,{...e(p),general:xe.message},!0)}finally{s(v,!1)}}async function le(We){We.preventDefault(),s(p,{idNumber:"",password:"",general:""},!0),s(H,"");const sa=y(e(E));if(sa){s(p,{...e(p),general:sa},!0);return}s(v,!0);try{const xe=await fetch("/api/forgot-password/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(N),code:e(E)})}),ge=await xe.json();if(!xe.ok)throw ge.attemptsRemaining!==void 0&&s(U,ge.attemptsRemaining,!0),new Error(ge.error||"Invalid verification code");s(H,"Code verified! Please enter your new password."),s(C,3)}catch(xe){s(p,{...e(p),general:xe.message},!0)}finally{s(v,!1)}}async function Ce(We){We.preventDefault(),s(p,{idNumber:"",password:"",general:""},!0),s(H,"");const sa=ce(e(D));if(sa){s(p,{...e(p),general:sa},!0);return}if(e(D)!==e(P)){s(p,{...e(p),general:"Passwords do not match"},!0);return}s(v,!0);try{const xe=await fetch("/api/forgot-password/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(N),code:e(E),newPassword:e(D)})}),ge=await xe.json();if(!xe.ok)throw new Error(ge.error||"Failed to reset password");s(H,"Password reset successfully! Redirecting to login..."),setTimeout(()=>{ae()},2e3)}catch(xe){s(p,{...e(p),general:xe.message},!0)}finally{s(v,!1)}}var me=gn(),Me=t(me);Me.__click=[Gi,A];var Ae=t(Me),re=t(Ae,!0);a(Ae),a(Me);var Te=r(Me,2),Oe=t(Te);{var ea=We=>{var sa=Zi(),xe=r(va(sa),2),ge=t(xe),Ie=t(ge),fa=r(t(Ie),2);Xa(fa),fa.__input=[Ri,_,p],fa.__keydown=[ri,M],et(2),a(Ie);var _a=r(Ie,2);{var Je=$=>{var Q=Vi(),X=t(Q,!0);a(Q),b(()=>o(X,e(p).idNumber)),i($,Q)};m(_a,$=>{e(p).idNumber&&$(Je)})}a(ge);var Re=r(ge,2),He=t(Re),la=r(t(He),2);Xa(la),la.__input=[Mi,w,p],la.__keydown=[ri,M];var aa=r(la,4);aa.__click=[Ui,f],aa.__keydown=[Yi,f];var c=t(aa),u=t(c,!0);a(c),a(aa),a(He);var j=r(He,2);{var K=$=>{var Q=Wi(),X=t(Q,!0);a(Q),b(()=>o(X,e(p).password)),i($,Q)};m(j,$=>{e(p).password&&$(K)})}a(Re);var ke=r(Re,2);{var Pe=$=>{var Q=Ji(),X=r(t(Q),2),Le=t(X);{var I=Ze=>{var Ye=Hi(),ga=t(Ye,!0);a(Ye),b(()=>o(ga,e(p).idNumber)),i(Ze,Ye)};m(Le,Ze=>{e(p).idNumber&&Ze(I)})}var ie=r(Le,2);{var se=Ze=>{var Ye=Qi(),ga=t(Ye,!0);a(Ye),b(()=>o(ga,e(p).password)),i(Ze,Ye)};m(ie,Ze=>{e(p).password&&Ze(se)})}var Ge=r(ie,2);{var Ve=Ze=>{var Ye=Bi(),ga=t(Ye,!0);a(Ye),b(()=>o(ga,e(p).general)),i(Ze,Ye)};m(Ge,Ze=>{e(p).general&&Ze(Ve)})}a(X),a(Q),i($,Q)};m(ke,$=>{(e(p).idNumber||e(p).password||e(p).general)&&$(Pe)})}var de=r(ke,2),$e=t(de);{var te=$=>{var Q=zi();i($,Q)},T=$=>{var Q=Ki();i($,Q)};m($e,$=>{e(v)?$(te):$(T,!1)})}a(de);var x=r(de,2);x.__click=ae,a(xe),b(()=>{Z(Ie,1,`custom-text-field ${e(p).idNumber?"error":""}`),vr(fa,e(_)),Z(He,1,`custom-text-field ${e(p).password?"error":""}`),Fa(la,"type",e(f)?"text":"password"),vr(la,e(w)),Fa(aa,"aria-label",e(f)?"Hide password":"Show password"),o(u,e(f)?"visibility":"visibility_off"),de.disabled=e(v)}),R("submit",xe,M),i(We,sa)},Ke=We=>{var sa=_n(),xe=va(sa),ge=t(xe),Ie=t(ge,!0);a(ge);var fa=r(ge,2),_a=t(fa,!0);a(fa),a(xe);var Je=r(xe,2);{var Re=Pe=>{var de=Xi(),$e=r(t(de),2),te=t($e,!0);a($e),a(de),b(()=>o(te,e(H))),i(Pe,de)};m(Je,Pe=>{e(H)&&Pe(Re)})}var He=r(Je,2);{var la=Pe=>{var de=en(),$e=r(t(de),2),te=t($e,!0);a($e),a(de),b(()=>o(te,e(p).general)),i(Pe,de)};m(He,Pe=>{e(p).general&&Pe(la)})}var aa=r(He,2);{var c=Pe=>{var de=sn(),$e=t(de),te=t($e),T=r(t(te),2);Xa(T),et(2),a(te),a($e);var x=r($e,2),$=t(x);{var Q=I=>{var ie=an();i(I,ie)},X=I=>{var ie=tn();et(2),i(I,ie)};m($,I=>{e(v)?I(Q):I(X,!1)})}a(x);var Le=r(x,2);Le.__click=ae,a(de),b(()=>x.disabled=e(v)),R("submit",de,ve),tt(T,()=>e(k),I=>s(k,I)),i(Pe,de)};m(aa,Pe=>{e(C)===1&&Pe(c)})}var u=r(aa,2);{var j=Pe=>{var de=cn(),$e=t(de),te=t($e);xa(te,21,()=>e(q),Jt,(Ge,Ve,Ze)=>{var Ye=rn();Xa(Ye),Fa(Ye,"id",`code-digit-${Ze}`),Ye.__input=ga=>Se(Ze,ga),Ye.__keydown=ga=>B(Ze,ga),b(()=>{vr(Ye,e(Ve)),Ye.disabled=e(v)}),R("paste",Ye,function(...ga){(Ze===0?ue:null)?.apply(this,ga)}),i(Ge,Ye)}),a(te);var T=r(te,2);{var x=Ge=>{var Ve=nn(),Ze=t(Ve);a(Ve),b(()=>o(Ze,`Attempts remaining: ${e(U)??""}`)),i(Ge,Ve)};m(T,Ge=>{e(U)<5&&Ge(x)})}var $=r(T,2);{var Q=Ge=>{var Ve=on();i(Ge,Ve)};m($,Ge=>{e(v)&&Ge(Q)})}a($e);var X=r($e,2);X.__click=[Oi,E,q,U,ve];var Le=t(X);{var I=Ge=>{var Ve=ln();i(Ge,Ve)},ie=Ge=>{var Ve=dn();et(2),i(Ge,Ve)};m(Le,Ge=>{e(v)?Ge(I):Ge(ie,!1)})}a(X);var se=r(X,2);se.__click=ae,a(de),b(()=>X.disabled=e(v)),R("submit",de,Ge=>{Ge.preventDefault()}),i(Pe,de)};m(u,Pe=>{e(C)===2&&Pe(j)})}var K=r(u,2);{var ke=Pe=>{var de=fn(),$e=t(de),te=t($e),T=r(t(te),2);Xa(T);var x=r(T,4);x.__click=[vn,Y];var $=t(x),Q=t($,!0);a($),a(x),a(te),a($e);var X=r($e,2),Le=t(X),I=r(t(Le),2);Xa(I);var ie=r(I,4);ie.__click=[un,ee];var se=t(ie),Ge=t(se,!0);a(se),a(ie),a(Le),a(X);var Ve=r(X,2),Ze=t(Ve);{var Ye=da=>{var Oa=mn();i(da,Oa)},ga=da=>{var Oa=pn();i(da,Oa)};m(Ze,da=>{e(v)?da(Ye):da(ga,!1)})}a(Ve),a(de),b(()=>{Fa(T,"type",e(Y)?"text":"password"),Fa(x,"aria-label",e(Y)?"Hide password":"Show password"),o(Q,e(Y)?"visibility":"visibility_off"),Fa(I,"type",e(ee)?"text":"password"),Fa(ie,"aria-label",e(ee)?"Hide password":"Show password"),o(Ge,e(ee)?"visibility":"visibility_off"),Ve.disabled=e(v)}),R("submit",de,Ce),tt(T,()=>e(D),da=>s(D,da)),tt(I,()=>e(P),da=>s(P,da)),i(Pe,de)};m(K,Pe=>{e(C)===3&&Pe(ke)})}b(()=>{o(Ie,e(C)===1?"Forgot Password?":e(C)===2?"Verify Code":"Reset Password"),o(_a,e(C)===1?"Enter your email to receive a verification code":e(C)===2?"Enter the 6-digit code sent to your email":"Create a new password for your account")}),i(We,sa)};m(Oe,We=>{e(g)?We(Ke,!1):We(ea)})}a(Te);var z=r(Te,2),Ne=t(z),Qe=t(Ne),we=t(Qe,!0);a(Qe);var ze=r(Qe,2),Be=t(ze,!0);a(ze),a(Ne),a(z),a(me),b(()=>{o(re,e(A)?"light_mode":"dark_mode"),o(we,e(g)?"Password Reset":"Welcome"),o(Be,e(g)?"Recover your account securely":"Login to access your account")}),i(V,me),Wt()}Ds(["click","input","keydown"]);function bn(V,d){s(d,!e(d))}function yn(V,d,_){s(d,!e(d)),_()}var wn=n('<img alt="Profile" class="avatar-image"/>'),Sn=n('<div class="avatar-placeholder"> </div>'),xn=(V,d,_)=>{d(),_.onnavigate("profile")},kn=async(V,d,_)=>{d(),await _.onlogout(),Os("Logged out successfully. See you next time!")},Dn=n('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),An=n('<nav class="student-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">school</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function Tn(V,d){Yt(d,!0);let _=qt(d,"studentName",3,"John Does"),w=qt(d,"firstName",3,"John"),v=qt(d,"gender",3,"male"),f=qt(d,"accountNumber",3,"STU-2025-0001"),p=qt(d,"profileImage",3,null);function g(z){return z==="female"?"Ms.":"Mr."}let C=jt(()=>`${g(v())} ${w()}`),k=ba(!0),N=ba(!1);function E(){s(N,!1)}function q(z){e(N)&&!z.target.closest(".user-profile-container")&&E()}Bt(()=>{const z=localStorage.getItem("theme");return s(k,z!=="light"),D(),document.addEventListener("click",q),()=>{document.removeEventListener("click",q)}});function D(){e(k)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function P(z){return z.split(" ").map(Ne=>Ne.charAt(0)).join("").toUpperCase().slice(0,2)}var Y=An(),ee=t(Y),H=t(ee),U=t(H);U.__click=function(...z){d.onToggleNavRail?.apply(this,z)};var A=r(U,2),M=r(t(A),2),ae=t(M);a(M),a(A),a(H);var Se=r(H,2),B=t(Se);B.__click=[yn,k,D];var ue=t(B),S=t(ue,!0);a(ue),a(B);var y=r(B,2),ce=t(y);ce.__click=[bn,N];var ve=t(ce),le=t(ve),Ce=t(le,!0);a(le);var me=r(le,2),Me=t(me);a(me),a(ve);var Ae=r(ve,2),re=t(Ae);{var Te=z=>{var Ne=wn();b(()=>Fa(Ne,"src",p())),i(z,Ne)},Oe=z=>{var Ne=Sn(),Qe=t(Ne,!0);a(Ne),b(we=>o(Qe,we),[()=>P(w())]),i(z,Ne)};m(re,z=>{p()?z(Te):z(Oe,!1)})}a(Ae),a(ce);var ea=r(ce,2);{var Ke=z=>{var Ne=Dn(),Qe=t(Ne);Qe.__click=[xn,E,d];var we=r(Qe,2);we.__click=[kn,E,d],a(Ne),i(z,Ne)};m(ea,z=>{e(N)&&z(Ke)})}a(y),a(Se),a(ee),a(Y),b(()=>{o(ae,`Welcome, ${e(C)??""}`),o(S,e(k)?"light_mode":"dark_mode"),o(Ce,_()),o(Me,`Account: ${f()??""}`)}),i(V,Y),Wt()}Ds(["click"]);async function ms(V,d={}){const _=Si(ls),w={"Content-Type":"application/json",...d.headers};if(_.isAuthenticated&&_.userData){const f={id:_.userData.id,name:_.userData.name,account_number:_.userData.accountNumber,account_type:_.userData.account_type||_.userData.accountType};w["x-user-info"]=JSON.stringify(f),w["x-user-id"]=_.userData.id.toString(),w["x-user-account-number"]=_.userData.accountNumber,w["x-user-name"]=encodeURIComponent(_.userData.name)}const v={...d,headers:w};try{return await fetch(V,v)}catch(f){throw console.error("Fetch error:",f),f}}const lt={get:async(V,d={})=>{const _=await ms(V,{...d,method:"GET"});if(!_.ok)throw new Error(`HTTP ${_.status}: ${_.statusText}`);return _.json()},post:async(V,d,_={})=>{const w=await ms(V,{..._,method:"POST",body:JSON.stringify(d)});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);return w.json()},put:async(V,d,_={})=>{const w=await ms(V,{..._,method:"PUT",body:JSON.stringify(d)});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);return w.json()},delete:async(V,d,_={})=>{const w=await ms(V,{..._,method:"DELETE",body:d?JSON.stringify(d):void 0});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);return w.json()},patch:async(V,d,_={})=>{const w=await ms(V,{..._,method:"PATCH",body:JSON.stringify(d)});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);return w.json()}};var Nn=(V,d,_)=>d(e(_).id),$n=n('<span class="menu-notification-badge menu-rail-badge"> </span>'),Cn=n('<button><div class="rail-icon-container"><span class="material-symbols-outlined rail-icon"> </span> <!></div> <span class="rail-label"> </span></button>'),jn=(V,d,_)=>d(e(_).id),En=n('<span class="menu-notification-badge menu-nav-badge"> </span>'),qn=n('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),Fn=(V,d)=>d("todo"),Ln=(V,d,_)=>d(e(_).id),In=n('<span class="menu-notification-badge menu-nav-badge"> </span>'),Pn=n('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),Gn=n(`<nav role="navigation" aria-label="Student portal navigation"><div class="rail-container"></div></nav> <nav class="bottom-navigation" role="	navigation" aria-label="Student portal navigation"><div class="nav-container"><!> <button aria-label="Todo List"><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon" style="font-variation-settings: 'FILL' 1; font-size: 28px;">checklist</span></div></button> <!></div></nav>`,1);function Rn(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=qt(d,"activeSection",15,"grades"),p=qt(d,"isNavRailVisible",3,!0),g=ba(0);const C=[{id:"grades",label:"My Grades",icon:"grade"},{id:"schedule",label:"Schedule",icon:"schedule"},{id:"documents",label:"Documents",icon:"description"},{id:"notifications",label:"Notifications",icon:"notifications",hasBadge:!0},{id:"todo",label:"Todo List",icon:"checklist"}];async function k(){if(v().isAuthenticated)try{const Se=await ms("/api/notifications?limit=1&offset=0");Se.success&&s(g,Se.data.unreadCount||0,!0)}catch(Se){console.error("Error fetching notification count:",Se)}}function N(ae){f(ae),d.onnavigate&&d.onnavigate({detail:{section:ae}})}Bt(()=>{let ae;ae=ls.subscribe(B=>{B.isAuthenticated&&(k(),ae&&ae())});const Se=setInterval(()=>{v().isAuthenticated&&k()},15e3);return()=>{clearInterval(Se),ae&&ae()}});var E=Gn(),q=va(E);let D;var P=t(q);xa(P,21,()=>C,ae=>ae.id,(ae,Se)=>{var B=Cn();let ue;B.__click=[Nn,N,Se];var S=t(B),y=t(S),ce=t(y,!0);a(y);var ve=r(y,2);{var le=Me=>{var Ae=$n(),re=t(Ae,!0);a(Ae),b(()=>o(re,e(g)>99?"99+":e(g))),i(Me,Ae)};m(ve,Me=>{e(Se).hasBadge&&e(g)>0&&Me(le)})}a(S);var Ce=r(S,2),me=t(Ce,!0);a(Ce),a(B),b(Me=>{ue=Z(B,1,"rail-item",null,ue,Me),Fa(B,"aria-label",e(Se).label),Fa(B,"aria-current",e(Se).id===f()?"page":void 0),o(ce,e(Se).icon),o(me,e(Se).label)},[()=>({active:e(Se).id===f()})]),i(ae,B)}),a(P),a(q);var Y=r(q,2),ee=t(Y),H=t(ee);xa(H,17,()=>C.slice(0,2),ae=>ae.id,(ae,Se)=>{var B=qn();let ue;B.__click=[jn,N,Se];var S=t(B),y=t(S),ce=t(y,!0);a(y);var ve=r(y,2);{var le=Ce=>{var me=En(),Me=t(me,!0);a(me),b(()=>o(Me,e(g)>99?"99+":e(g))),i(Ce,me)};m(ve,Ce=>{e(Se).hasBadge&&e(g)>0&&Ce(le)})}a(S),a(B),b(Ce=>{ue=Z(B,1,"nav-item",null,ue,Ce),Fa(B,"aria-label",e(Se).label),Fa(B,"aria-current",e(Se).id===f()?"page":void 0),o(ce,e(Se).icon)},[()=>({active:e(Se).id===f()})]),i(ae,B)});var U=r(H,2);let A;U.__click=[Fn,N];var M=r(U,2);xa(M,17,()=>C.slice(2,4),ae=>ae.id,(ae,Se)=>{var B=Pn();let ue;B.__click=[Ln,N,Se];var S=t(B),y=t(S),ce=t(y,!0);a(y);var ve=r(y,2);{var le=Ce=>{var me=In(),Me=t(me,!0);a(me),b(()=>o(Me,e(g)>99?"99+":e(g))),i(Ce,me)};m(ve,Ce=>{e(Se).hasBadge&&e(g)>0&&Ce(le)})}a(S),a(B),b(Ce=>{ue=Z(B,1,"nav-item",null,ue,Ce),Fa(B,"aria-label",e(Se).label),Fa(B,"aria-current",e(Se).id===f()?"page":void 0),o(ce,e(Se).icon)},[()=>({active:e(Se).id===f()})]),i(ae,B)}),a(ee),a(Y),b((ae,Se)=>{D=Z(q,1,"navigation-rail",null,D,ae),A=Z(U,1,"nav-item",null,A,Se),Fa(U,"aria-current",f()==="todo"?"page":void 0)},[()=>({collapsed:!p()}),()=>({active:f()==="todo"})]),i(V,E),Wt(),w()}Ds(["click"]);const Mn=300*1e3,On="student_profile_";function Vn(){const V={studentData:null,studentProfileData:null,studentSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:d,set:_,update:w}=Gs(V);function v(q){return`${On}${q}`}function f(q){return!q||!q.timestamp?!1:Date.now()-q.timestamp<Mn}function p(q){try{const D=v(q),P=localStorage.getItem(D);if(P){const Y=JSON.parse(P);if(f(Y))return Y.data}}catch(D){console.warn("Failed to retrieve cached student profile data:",D)}return null}function g(q,D){try{const P=v(q),Y={data:D,timestamp:Date.now()};localStorage.setItem(P,JSON.stringify(Y))}catch(P){console.warn("Failed to cache student profile data:",P)}}async function C(q,D=!1){try{w(M=>({...M,isLoading:!D,isRefreshing:D,error:null,currentStudentId:q}));const P=await fetch("/api/accounts?type=student&limit=1000");if(!P.ok)throw new Error("Failed to fetch student data");const Y=await P.json();if(!Y.success)throw new Error(Y.message||"Failed to fetch student data");const ee=Y.accounts.find(M=>M.id===q||M.number===q);if(!ee)throw new Error("Student data not found");let H=null;try{const M=await fetch(`/api/student-profile?studentId=${q}`);if(M.ok){const ae=await M.json();ae.success&&(H=ae.data)}}catch(M){console.warn("Failed to fetch additional student profile data:",M)}let U=[];try{const Se=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",B=await fetch(`/api/student-sections?studentId=${q}&schoolYear=${Se}`);if(B.ok){const ue=await B.json();ue.success&&(U=ue.data.classData||[])}}catch(M){console.warn("Failed to fetch student sections:",M)}const A={studentData:ee,studentProfileData:H,studentSections:U,lastUpdated:new Date().toISOString()};w(M=>({...M,...A,isLoading:!1,isRefreshing:!1,error:null})),g(q,A)}catch(P){console.error("Error loading student profile:",P),w(Y=>({...Y,isLoading:!1,isRefreshing:!1,error:P.message}))}}function k(q){const D=p(q);return D?(w(P=>({...P,...D,currentStudentId:q,isLoading:!1,isRefreshing:!1,error:null})),!0):(w(P=>({...P,currentStudentId:q,isLoading:!0,isRefreshing:!1,error:null})),!1)}function N(q){try{const D=v(q);localStorage.removeItem(D)}catch(D){console.warn("Failed to clear student profile cache:",D)}return w(D=>({...V,currentStudentId:q,isLoading:!0})),E.loadProfile(q,!1)}const E={subscribe:d,init:k,loadProfile:C,forceRefresh:N,getCachedData:q=>p(q)};return E}const or=Vn();function Un(V,d){s(d,!e(d))}function Yn(V,d){s(d,!e(d))}function Wn(V,d){s(d,!e(d))}function Hn(V,d){is.confirm("Change Password",`
			<div class="student-profile-password-form">
				<div class="student-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,d,()=>{},{size:"medium"})}var Qn=n('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Bn=n('<div class="silent-refresh-indicator"><span class="refresh-spinner"></span></div>'),Jn=n('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading student information...</p></div>'),zn=n('<div class="info-row row-five"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="info-content"><div class="info-label">Student ID</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person</span></div> <div class="info-content"><div class="info-label">Full Name</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">school</span></div> <div class="info-content"><div class="info-label">Year Level</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">group</span></div> <div class="info-content"><div class="info-label">Section</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="info-content"><div class="info-label">Total Subjects</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">email</span></div> <div class="info-content"><div class="info-label">Email</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">phone</span></div> <div class="info-content"><div class="info-label">Contact Number</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">family_restroom</span></div> <div class="info-content"><div class="info-label">Guardian</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-one"><div class="info-card address-card"><div class="info-icon"><span class="material-symbols-outlined">home</span></div> <div class="info-content"><div class="info-label">Address</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-two"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">cake</span></div> <div class="info-content"><div class="info-label">Birth Date</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Age</div> <div class="info-value"> </div></div></div></div>',1),Kn=n('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading academic performance...</p></div>'),Zn=n('<div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Adviser</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">grade</span></div> <div class="info-content"><div class="info-label">General Average</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">leaderboard</span></div> <div class="info-content"><div class="info-label">Class Rank</div> <div class="info-value"> </div></div></div></div>'),Xn=n('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading enrolled subjects...</p></div>'),eo=n('<div class="subject-card"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p class="teacher-name"> </p></div></div>'),ao=n('<div class="subjects-grid"></div>'),to=n('<div class="subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects enrolled yet</p></div>'),so=n('<div class="profile-header"><div class="header-content"><h1 class="page-title">Student Profile</h1> <p class="page-subtitle">Personal Information & Academic Details</p></div> <div class="header-actions"><!> <button class="student-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="profile-info-section"><h2 class="section-title section-title-desktop">Student Information</h2> <button class="section-header-mobile" aria-label="Toggle student information"><h2 class="section-title">Student Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-academic-section"><h2 class="section-title section-title-desktop">Academic Performance</h2> <button class="section-header-mobile" aria-label="Toggle academic performance"><h2 class="section-title">Academic Performance</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-subjects-section"><h2 class="section-title section-title-desktop">Enrolled Subjects</h2> <button class="section-header-mobile" aria-label="Toggle enrolled subjects"><h2 class="section-title">Enrolled Subjects</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-security-section"><h2 class="section-title section-title-desktop">Account Security</h2> <div class="section-content"><div class="info-row row-one"><div class="info-card security-card"><div class="info-content-container"><div class="info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="info-content"><div class="info-label">Password</div> <div class="info-value">Change your account password for security</div></div></div> <div class="security-actions"><button class="security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),ro=n('<div class="profile-container"><!></div>');function io(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(or,"$studentProfileStore",_);let f=ba(void 0);Is(()=>ls.subscribe(y=>{s(f,y,!0)}));let p=jt(v),g=jt(()=>e(p).studentData),C=jt(()=>e(p).studentProfileData),k=jt(()=>e(p).isLoading),N=jt(()=>e(p).isRefreshing),E=jt(()=>e(p).error);function q(){e(f)?.userData?.id&&or.forceRefresh(e(f).userData.id)}Is(()=>{e(f)?.userData?.id&&(or.init(e(f).userData.id)||or.loadProfile(e(f).userData.id,!1))}),Bt(()=>{const S=setInterval(()=>{e(f)?.userData?.id&&or.loadProfile(e(f).userData.id,!0)},3e5);return()=>clearInterval(S)});let D=jt(()=>({id:e(g)?.number||e(f)?.userData?.accountNumber||"N/A",name:e(g)?.name||e(f)?.userData?.name||"Student Name",firstName:e(g)?.firstName||e(f)?.userData?.firstName||"",lastName:e(g)?.lastName||"",middleInitial:e(g)?.middleInitial||"",yearLevel:e(g)?.gradeLevel?`Grade ${e(g).gradeLevel}`:"Not assigned",section:e(C)?.section?.name||"Not assigned",email:e(g)?.email||"Not available",phone:e(g)?.contactNumber||"Not available",address:e(g)?.address||"Not available",birthDate:e(g)?.birthdate?new Date(e(g).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(g)?.age||"Not available",guardian:e(g)?.guardian||"Not available",gender:e(g)?.gender||e(f)?.userData?.gender||"male",academicSummary:{adviser:e(C)?.section?.adviser||"Not available",gpa:e(C)?.academicSummary?.generalAverage||"Not available",rank:e(C)?.academicSummary?.classRank||"Not available",totalStudents:e(C)?.academicSummary?.totalStudentsInSection||"Not available"},subjects:e(C)?.subjects||[]})),P=jt(()=>e(D).subjects.length||"Not available"),Y=ba(!0),ee=ba(!1),H=ba(!0),U=ba(!1);function A(S){const y=document.getElementById(S),ve=y.nextElementSibling.querySelector(".password-eye-icon");y.type==="password"?(y.type="text",ve.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(y.type="password",ve.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=A);async function M(){const S=document.getElementById("current-password"),y=document.getElementById("new-password"),ce=document.getElementById("confirm-password");if(!S||!y||!ce){Xt("Password form inputs not found");return}const ve=S.value,le=y.value,Ce=ce.value;if(!ve){Xt("Current password is required");return}if(!le){Xt("New password is required");return}if(le!==Ce){Xt("New passwords do not match");return}if(le.length<8){Xt("Password must be at least 8 characters long");return}if(ve===le){Xt("New password must be different from current password");return}try{s(U,!0);const me=await api.post("/api/change-password",{currentPassword:ve,newPassword:le});me.success?(S.value="",y.value="",ce.value="",Os("Password changed successfully!"),is.close()):Xt(me.error||"Failed to change password")}catch(me){console.error("Password change error:",me),Xt(me.message||"Failed to change password")}finally{s(U,!1)}}var ae=ro(),Se=t(ae);{var B=S=>{var y=Qn(),ce=r(t(y),2),ve=t(ce);a(ce);var le=r(ce,2);le.__click=q,a(y),b(()=>o(ve,`Failed to load profile data: ${e(E)??""}`)),i(S,y)},ue=S=>{var y=so(),ce=va(y),ve=r(t(ce),2),le=t(ve);{var Ce=te=>{var T=Bn();i(te,T)};m(le,te=>{e(N)&&te(Ce)})}var me=r(le,2);me.__click=q,a(ve),a(ce);var Me=r(ce,2),Ae=r(t(Me),2);Ae.__click=[Un,Y];var re=r(t(Ae),2);let Te;a(Ae);var Oe=r(Ae,2);let ea;var Ke=t(Oe);{var z=te=>{var T=Jn();i(te,T)},Ne=te=>{var T=zn(),x=va(T),$=t(x),Q=r(t($),2),X=r(t(Q),2),Le=t(X,!0);a(X),a(Q),a($);var I=r($,2),ie=r(t(I),2),se=r(t(ie),2),Ge=t(se,!0);a(se),a(ie),a(I);var Ve=r(I,2),Ze=r(t(Ve),2),Ye=r(t(Ze),2),ga=t(Ye,!0);a(Ye),a(Ze),a(Ve);var da=r(Ve,2),Oa=r(t(da),2),Ga=r(t(Oa),2),fe=t(Ga,!0);a(Ga),a(Oa),a(da);var O=r(da,2),F=r(t(O),2),J=r(t(F),2),_e=t(J,!0);a(J),a(F),a(O),a(x);var qe=r(x,2),ia=t(qe),na=r(t(ia),2),Ra=r(t(na),2),Ue=t(Ra,!0);a(Ra),a(na),a(ia);var Fe=r(ia,2),Ma=r(t(Fe),2),dt=r(t(Ma),2),ha=t(dt,!0);a(dt),a(Ma),a(Fe);var ka=r(Fe,2),La=r(t(ka),2),Ya=r(t(La),2),oe=t(Ya,!0);a(Ya),a(La),a(ka),a(qe);var Sa=r(qe,2),Ba=t(Sa),ht=r(t(Ba),2),Et=r(t(ht),2),De=t(Et,!0);a(Et),a(ht),a(Ba),a(Sa);var Ee=r(Sa,2),je=t(Ee),Da=r(t(je),2),ma=r(t(Da),2),L=t(ma,!0);a(ma),a(Da),a(je);var ne=r(je,2),oa=r(t(ne),2),Ea=r(t(oa),2),Xe=t(Ea,!0);a(Ea),a(oa),a(ne),a(Ee),b(()=>{o(Le,e(D).id),o(Ge,e(D).name),o(ga,e(D).yearLevel),o(fe,e(D).section),o(_e,e(P)),o(Ue,e(D).email||"Not provided"),o(ha,e(D).phone||"Not provided"),o(oe,e(D).guardian||"Not provided"),o(De,e(D).address||"Not provided"),o(L,e(D).birthDate||"Not provided"),o(Xe,e(D).age?`${e(D).age} years old`:"Not available")}),i(te,T)};m(Ke,te=>{e(k)?te(z):te(Ne,!1)})}a(Oe),a(Me);var Qe=r(Me,2),we=r(t(Qe),2);we.__click=[Yn,ee];var ze=r(t(we),2);let Be;a(we);var We=r(we,2);let sa;var xe=t(We);{var ge=te=>{var T=Kn();i(te,T)},Ie=te=>{var T=Zn(),x=t(T),$=r(t(x),2),Q=r(t($),2),X=t(Q,!0);a(Q),a($),a(x);var Le=r(x,2),I=r(t(Le),2),ie=r(t(I),2),se=t(ie,!0);a(ie),a(I),a(Le);var Ge=r(Le,2),Ve=r(t(Ge),2),Ze=r(t(Ve),2),Ye=t(Ze,!0);a(Ze),a(Ve),a(Ge),a(T),b(()=>{o(X,e(D).academicSummary.adviser),o(se,e(D).academicSummary.gpa!=="Not available"?`${e(D).academicSummary.gpa}`:"Not available"),o(Ye,e(D).academicSummary.rank!=="Not available"&&e(D).academicSummary.totalStudents!=="Not available"?`${e(D).academicSummary.rank} of ${e(D).academicSummary.totalStudents}`:"Not available")}),i(te,T)};m(xe,te=>{e(k)?te(ge):te(Ie,!1)})}a(We),a(Qe);var fa=r(Qe,2),_a=r(t(fa),2);_a.__click=[Wn,H];var Je=r(t(_a),2);let Re;a(_a);var He=r(_a,2);let la;var aa=t(He);{var c=te=>{var T=Xn();i(te,T)},u=te=>{var T=ja(),x=va(T);{var $=X=>{var Le=ao();xa(Le,21,()=>e(D).subjects,I=>I.id,(I,ie)=>{var se=eo(),Ge=t(se),Ve=t(Ge);a(Ge);var Ze=r(Ge,2),Ye=t(Ze),ga=t(Ye,!0);a(Ye);var da=r(Ye,2),Oa=t(da,!0);a(da),a(Ze),a(se),b(()=>{Zt(se,`border-color: ${e(ie).color??""};`),Zt(Ve,`background-color: ${e(ie).color??""}20; color: ${e(ie).color??""}`),o(ga,e(ie).name),o(Oa,e(ie).teacher)}),i(I,se)}),a(Le),i(X,Le)},Q=X=>{var Le=to();i(X,Le)};m(x,X=>{e(D).subjects.length>0?X($):X(Q,!1)},!0)}i(te,T)};m(aa,te=>{e(k)?te(c):te(u,!1)})}a(He),a(fa);var j=r(fa,2),K=r(t(j),2),ke=t(K),Pe=t(ke),de=r(t(Pe),2),$e=t(de);$e.__click=[Hn,M],a(de),a(Pe),a(ke),a(K),a(j),b((te,T,x,$,Q,X)=>{me.disabled=e(k),Te=Z(re,1,"material-symbols-outlined collapse-icon",null,Te,te),ea=Z(Oe,1,"section-content",null,ea,T),Be=Z(ze,1,"material-symbols-outlined collapse-icon",null,Be,x),sa=Z(We,1,"section-content",null,sa,$),Re=Z(Je,1,"material-symbols-outlined collapse-icon",null,Re,Q),la=Z(He,1,"section-content",null,la,X)},[()=>({rotated:e(Y)}),()=>({collapsed:e(Y)}),()=>({rotated:e(ee)}),()=>({collapsed:e(ee)}),()=>({rotated:e(H)}),()=>({collapsed:e(H)})]),i(S,y)};m(Se,S=>{e(E)?S(B):S(ue,!1)})}a(ae),i(V,ae),Wt(),w()}Ds(["click"]);var kr=function(){return kr=Object.assign||function(V){for(var d,_=1,w=arguments.length;_<w;_++)for(var v in d=arguments[_])Object.prototype.hasOwnProperty.call(d,v)&&(V[v]=d[v]);return V},kr.apply(this,arguments)},no=(function(){function V(d,_,w){var v=this;this.endVal=_,this.options=w,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(f){v.startTime||(v.startTime=f);var p=f-v.startTime;v.remaining=v.duration-p,v.useEasing?v.countDown?v.frameVal=v.startVal-v.easingFn(p,0,v.startVal-v.endVal,v.duration):v.frameVal=v.easingFn(p,v.startVal,v.endVal-v.startVal,v.duration):v.frameVal=v.startVal+(v.endVal-v.startVal)*(p/v.duration);var g=v.countDown?v.frameVal<v.endVal:v.frameVal>v.endVal;v.frameVal=g?v.endVal:v.frameVal,v.frameVal=Number(v.frameVal.toFixed(v.options.decimalPlaces)),v.printValue(v.frameVal),p<v.duration?v.rAF=requestAnimationFrame(v.count):v.finalEndVal!==null?v.update(v.finalEndVal):v.options.onCompleteCallback&&v.options.onCompleteCallback()},this.formatNumber=function(f){var p,g,C,k,N=f<0?"-":"";p=Math.abs(f).toFixed(v.options.decimalPlaces);var E=(p+="").split(".");if(g=E[0],C=E.length>1?v.options.decimal+E[1]:"",v.options.useGrouping){k="";for(var q=3,D=0,P=0,Y=g.length;P<Y;++P)v.options.useIndianSeparators&&P===4&&(q=2,D=1),P!==0&&D%q==0&&(k=v.options.separator+k),D++,k=g[Y-P-1]+k;g=k}return v.options.numerals&&v.options.numerals.length&&(g=g.replace(/[0-9]/g,(function(ee){return v.options.numerals[+ee]})),C=C.replace(/[0-9]/g,(function(ee){return v.options.numerals[+ee]}))),N+v.options.prefix+g+C+v.options.suffix},this.easeOutExpo=function(f,p,g,C){return g*(1-Math.pow(2,-10*f/C))*1024/1023+p},this.options=kr(kr({},this.defaults),w),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof d=="string"?document.getElementById(d):d,_=_??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(_),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,d):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return v.handleScroll(v)})),window.onscroll=function(){window.onScrollFns.forEach((function(f){return f()}))},this.handleScroll(this)))}return V.prototype.handleScroll=function(d){if(d&&window&&!d.once){var _=window.innerHeight+window.scrollY,w=d.el.getBoundingClientRect(),v=w.top+window.pageYOffset,f=w.top+w.height+window.pageYOffset;f<_&&f>window.scrollY&&d.paused?(d.paused=!1,setTimeout((function(){return d.start()}),d.options.scrollSpyDelay),d.options.scrollSpyOnce&&(d.once=!0)):(window.scrollY>f||v>_)&&!d.paused&&d.reset()}},V.prototype.determineDirectionAndSmartEasing=function(){var d=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>d;var _=d-this.startVal;if(Math.abs(_)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=d;var w=this.countDown?1:-1;this.endVal=d+w*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=d,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},V.prototype.start=function(d){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),d&&(this.options.onCompleteCallback=d),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},V.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},V.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},V.prototype.update=function(d){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(d),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},V.prototype.printValue=function(d){var _;if(this.el){var w=this.formattingFn(d);!((_=this.options.plugin)===null||_===void 0)&&_.render?this.options.plugin.render(this.el,w):this.el.tagName==="INPUT"?this.el.value=w:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=w:this.el.innerHTML=w}},V.prototype.ensureNumber=function(d){return typeof d=="number"&&!isNaN(d)},V.prototype.validateValue=function(d){var _=Number(d);return this.ensureNumber(_)?_:(this.error="[CountUp] invalid start or end value: ".concat(d),null)},V.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},V.prototype.parse=function(d){var _=function(p){return p.replace(/([.,'Â  ])/g,"\\$1")},w=_(this.options.separator),v=_(this.options.decimal),f=d.replace(new RegExp(w,"g"),"").replace(new RegExp(v,"g"),".");return parseFloat(f)},V})(),oo=n('<span class="countup-container svelte-3g4hm4"><!></span>');function wr(V,d){Yt(d,!1);let _=qt(d,"value",8,0),w=qt(d,"decimals",8,1),v=qt(d,"duration",8,2),f=qt(d,"useEasing",8,!0),p=qt(d,"useGrouping",8,!0),g=qt(d,"separator",8,","),C=qt(d,"decimal",8,"."),k=qt(d,"prefix",8,""),N=qt(d,"suffix",8,""),E=qt(d,"startVal",8,0),q=h(),D=h(),P=h(!1),Y=h(!1);function ee(M,ae){return M.toFixed(ae).replace(/\.0+$/,"")}Bt(()=>{e(q)&&(gs(q,e(q).textContent=`${k()}${ee(E(),w())}${N()}`),s(P,!0),_()!==E()&&_()>0&&H())});function H(){if(!(!e(q)||!e(P)||e(Y)))try{s(D,new no(e(q),_(),{startVal:E(),decimalPlaces:w(),duration:v(),useEasing:f(),useGrouping:p(),separator:g(),decimal:C(),prefix:k(),suffix:N(),formattingFn:M=>M.toFixed(w()).replace(/\.0+$/,"")})),e(D).error?(console.error("CountUp error:",e(D).error),gs(q,e(q).textContent=`${k()}${ee(_(),w())}${N()}`)):(e(D).start(),s(Y,!0))}catch(M){console.error("Failed to initialize CountUp:",M),gs(q,e(q).textContent=`${k()}${ee(_(),w())}${N()}`)}}at(()=>(e(P),us(_()),us(E()),e(Y)),()=>{e(P)&&_()!==E()&&_()>0&&!e(Y)&&H()}),at(()=>(e(D),e(Y),us(_()),us(E()),us(k()),us(w()),us(N())),()=>{if(e(D)&&vi&&e(Y)&&_()!==E())try{e(D).update(_())}catch(M){console.error("CountUp update error:",M),gs(q,e(q).textContent=`${k()}${ee(_(),w())}${N()}`)}}),ps(),cs();var U=oo(),A=t(U);m(A,M=>{}),a(U),ur(U,M=>s(q,M),()=>e(q)),i(V,U),Wt()}var lo=n("<button> </button>"),co=n('<div class="dropdown-menu-quarter"></div>'),vo=n('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),uo=n('<div class="performance-subtitle"> </div>'),mo=n('<span class="material-symbols-outlined">expand_less</span>'),po=n('<span class="material-symbols-outlined">expand_more</span>'),fo=n('<div class="analysis-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-analysis-btn">Try Again</button></div>'),_o=n('<div class="analysis-text"><!></div>'),go=n('<div class="analysis-placeholder"><span class="material-symbols-outlined">auto_awesome</span> <p>Generating Grade Analysis...</p></div>'),ho=n('<div class="analysis-content"><!></div>'),bo=n('<div class="loading-container"><div class="system-loader"></div> <p>Loading your grades...</p></div>'),yo=n('<div class="no-subjects"><span class="material-symbols-outlined">school</span> <p> </p> <small>Grades will appear here once they are verified by your teachers</small></div>'),wo=n('<div class="progress-fill"></div>'),So=n('<span class="unverified-indicator" title="Grade not yet verified">*</span>'),xo=n('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),ko=n('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">edit</span> <span>Written Work</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Do=n('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Ao=n('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">assignment</span> <span>Performance Tasks</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),To=n('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),No=n('<div class="breakdown-category quarterly-assessment-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">quiz</span> <span>Quarterly Assessment</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),$o=n('<div class="grade-breakdown-section"><div class="breakdown-container"><!> <!> <!></div></div>'),Co=n('<div class="subject-accordion"><div><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p> </p> <div class="progress-bar"><!></div></div> <div class="grade-column"><div class="grade-large"><!> <!></div> <div> </div></div></div> <!></div>'),jo=n('<div class="subjects-grid"></div>'),Eo=n('<div class="performance-card"><div class="performance-header"><div class="performance-title-section"><div class="performance-title-content"><h2 class="performance-title">Academic Performance</h2> <!></div></div></div> <div class="performance-stats"><div class="grade-stat-item primary"><div class="stat-icon"><span class="material-symbols-outlined">star</span></div> <div class="stat-content"><div class="grade-stat-value"><!></div> <div class="stat-label">Overall Average</div></div></div> <div class="grade-stat-item secondary"><div class="stat-icon"><span class="material-symbols-outlined">school</span></div> <div class="stat-content"><div class="grade-stat-value"><!></div> <div class="stat-label">Total Subjects</div></div></div> <div class="grade-stat-item tertiary"><div class="stat-icon"><span class="material-symbols-outlined">crown</span></div> <div class="stat-content"><div class="grade-stat-value">Rank <!></div> <div class="stat-label"> </div></div></div></div> <div class="ai-analysis-container"><div class="analysis-header"><h3 class="analysis-title">AI Performance Analysis</h3> <button class="ai-analysis-toggle-btn"><!></button></div> <!></div></div> <div class="subjects-section"><h2 class="section-title">Subject Performance</h2> <!></div>',1),qo=n('<div class="grades-container"><div class="grades-header"><div class="header-content"><h1 class="page-title">My Grades</h1> <p class="page-subtitle">Academic Performance Overview</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function Fo(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=h(!0),p=h(null),g=h("2nd Quarter"),C=2,k="2025-2026",N=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],E=h(!1),q=h([]),D=h(0),P=h(0),Y=null,ee=h(null),H=h(null),U=h(0),A=h(new Set),M=h(""),ae=!1,Se=h(null),B=h(!1);const ue={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};function S(){s(E,!e(E))}async function y(c){s(g,c),s(E,!1),s(M,""),s(B,!1),s(Se,null),await we()}function ce(c){e(E)&&!c.target.closest(".custom-dropdown")&&s(E,!1)}async function ve(){try{const c=await lt.get(`/api/student-profile?studentId=${v().userData.id}`);if(c.success){const{section:u,academicSummary:j}=c.data;s(ee,u),s(H,j.classRank),s(U,j.totalStudentsInSection)}}catch(c){console.error("Error fetching student profile:",c)}}function le(c){return c===0||c===null||c===void 0?"var(--grade-no-grade)":c>=85?"var(--grade-excellent)":c>=80?"var(--grade-good)":c>=75?"var(--grade-satisfactory)":(c>=65,"var(--grade-needs-improvement)")}function Ce(c,u,j,K){return!u||!j||!K?"N/A":c>0?me(c):"N/A"}function me(c){return c==null||c===0?"N/A":c%1===0?c.toString():c.toFixed(1)}function Me(c,u,j,K){return!u||!j||!K||c===0?0:Math.min(c/100*100,100)}function Ae(c){const u=["blue","green","purple","yellow","orange"];return u[c%u.length]}function re(c){const u=Ae(c);return{border:`var(--subject-card-${u}-border)`,text:`var(--subject-card-${u}-text)`,icon:`var(--subject-card-${u}-icon)`}}function Te(c){return c>=85?"Excellent":c>=80?"Good":c>=75?"Satisfactory":c>=65?"Needs Improvement":"No Grade"}function Oe(c){e(A).has(c)?e(A).delete(c):e(A).add(c),s(A,new Set(e(A)))}function ea(c){return c.verified&&(c.writtenWorkScores&&c.writtenWorkScores.length>0||c.performanceTasksScores&&c.performanceTasksScores.length>0||c.quarterlyAssessmentScores&&c.quarterlyAssessmentScores.length>0)}async function Ke(){if(!(ae||!e(q).length||!v().userData?.id)){ae=!0,s(Se,null),s(M,""),s(B,!0);try{const c=ue[e(g)],u=await fetch("/api/ai-grade-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:v().userData.id,quarter:c,schoolYear:k})});if(!u.ok)throw new Error("Failed to get AI analysis");ae=!1;const j=u.body.getReader(),K=new TextDecoder;for(;;){const{done:ke,value:Pe}=await j.read();if(ke)break;const de=K.decode(Pe,{stream:!0});s(M,e(M)+de),s(M,e(M))}}catch(c){console.error("AI Analysis Error:",c),s(Se,c.message),ae=!1}}}function z(){!e(B)&&!e(M)?Ke():s(B,!e(B))}function Ne(c,u){return`${{written:"Quiz",performance:"Project",quarterly:"Exam"}[u]||"Task"} ${c+1}`}Bt(async()=>{v().userData?.id?(await Qe(),we(),ve()):(s(p,"Please log in to view your grades"),s(f,!1))});async function Qe(){try{const u=await(await fetch("/api/current-quarter")).json();u.success&&u.data&&(C=u.data.currentQuarter,s(g,u.data.quarterName),k=u.data.currentSchoolYear,console.log(`Current quarter set to: ${e(g)} (Quarter ${C})`),console.log(`Current school year set to: ${k}`))}catch(c){console.error("Error fetching current quarter/school year:",c)}}async function we(){try{s(f,!0),s(p,null);const c=ue[e(g)],u=await lt.get(`/api/student-grades?student_id=${v().userData.id}&quarter=${c}&school_year=${k}`);if(u.success){const{grades:j,statistics:K}=u.data;s(q,j),s(P,K.overallAverage||0),s(D,K.totalSubjects||0),Y={name:v().userData.full_name||"Student",id:v().userData.id}}else s(p,u.error||"Failed to fetch grades")}catch(c){console.error("Error fetching grades:",c),s(p,"Unable to load grades. Please try again.")}finally{s(f,!1)}}cs();var ze=qo();R("click",Ts,ce);var Be=t(ze),We=r(t(Be),2),sa=t(We),xe=t(sa),ge=r(t(xe),2),Ie=t(ge,!0);a(ge);var fa=r(ge,2);let _a;a(xe);var Je=r(xe,2);{var Re=c=>{var u=co();xa(u,5,()=>N,Jt,(j,K)=>{var ke=lo();let Pe;var de=t(ke,!0);a(ke),b($e=>{Pe=Z(ke,1,"dropdown-item-quarter",null,Pe,$e),o(de,e(K))},[()=>({active:e(K)===e(g)})]),R("click",ke,()=>y(e(K))),i(j,ke)}),a(u),i(c,u)};m(Je,c=>{e(E)&&c(Re)})}a(sa),a(We),a(Be);var He=r(Be,2);{var la=c=>{var u=vo(),j=r(t(u),2),K=t(j);a(j);var ke=r(j,2);a(u),b(()=>o(K,`Error: ${e(p)??""}`)),R("click",ke,we),i(c,u)},aa=c=>{var u=Eo(),j=va(u),K=t(j),ke=t(K),Pe=t(ke),de=r(t(Pe),2);{var $e=Ue=>{var Fe=uo(),Ma=t(Fe);a(Fe),b(()=>o(Ma,`Grade ${e(ee).gradeLevel??""} â¢ ${e(ee).name??""}`)),i(Ue,Fe)};m(de,Ue=>{e(ee)&&Ue($e)})}a(Pe),a(ke),a(K);var te=r(K,2),T=t(te),x=r(t(T),2),$=t(x),Q=t($);wr(Q,{get value(){return e(P)},decimals:1,duration:2.5}),a($),et(2),a(x),a(T);var X=r(T,2),Le=r(t(X),2),I=t(Le),ie=t(I);wr(ie,{get value(){return e(D)},decimals:0,duration:2}),a(I),et(2),a(Le),a(X);var se=r(X,2),Ge=r(t(se),2),Ve=t(Ge),Ze=r(t(Ve));wr(Ze,{get value(){return e(H)},decimals:0,duration:2}),a(Ve);var Ye=r(Ve,2),ga=t(Ye);a(Ye),a(Ge),a(se),a(te);var da=r(te,2),Oa=t(da),Ga=r(t(Oa),2),fe=t(Ga);{var O=Ue=>{var Fe=mo();i(Ue,Fe)},F=Ue=>{var Fe=po();i(Ue,Fe)};m(fe,Ue=>{e(B)?Ue(O):Ue(F,!1)})}a(Ga),a(Oa);var J=r(Oa,2);{var _e=Ue=>{var Fe=ho(),Ma=t(Fe);{var dt=ka=>{var La=fo(),Ya=r(t(La),2),oe=t(Ya);a(Ya);var Sa=r(Ya,2);a(La),b(()=>o(oe,`Failed to generate AI analysis: ${e(Se)??""}`)),R("click",Sa,Ke),i(ka,La)},ha=ka=>{var La=ja(),Ya=va(La);{var oe=Ba=>{var ht=_o(),Et=t(ht);Ci(Et,()=>e(M).replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")),a(ht),i(Ba,ht)},Sa=Ba=>{var ht=go();i(Ba,ht)};m(Ya,Ba=>{e(M)?Ba(oe):Ba(Sa,!1)},!0)}i(ka,La)};m(Ma,ka=>{e(Se)?ka(dt):ka(ha,!1)})}a(Fe),i(Ue,Fe)};m(J,Ue=>{e(B)&&Ue(_e)})}a(da),a(j);var qe=r(j,2),ia=r(t(qe),2);{var na=Ue=>{var Fe=bo();i(Ue,Fe)},Ra=Ue=>{var Fe=ja(),Ma=va(Fe);{var dt=ka=>{var La=yo(),Ya=r(t(La),2),oe=t(Ya);a(Ya),et(2),a(La),b(()=>o(oe,`No subjects found for ${e(g)??""}`)),i(ka,La)},ha=ka=>{var La=jo();xa(La,7,()=>e(q),Ya=>Ya.subject_id||Ya.id,(Ya,oe,Sa)=>{const Ba=js(()=>re(e(Sa))),ht=js(()=>ea(e(oe)));var Et=Co(),De=t(Et);let Ee;var je=t(De),Da=t(je);a(je);var ma=r(je,2),L=t(ma),ne=t(L,!0);a(L);var oa=r(L,2);let Ea;var Xe=t(oa,!0);a(oa);var Ja=r(oa,2),pt=t(Ja);{var ct=ut=>{var _t=wo();b((qa,W)=>Zt(_t,`width: ${qa??""}%; background-color: ${W??""}`),[()=>Me(e(oe).numericGrade,e(oe).teacher!=="No teacher",e(oe).numericGrade>0,e(oe).verified),()=>le(e(oe).numericGrade)]),i(ut,_t)};m(pt,ut=>{Me(e(oe).numericGrade,e(oe).teacher!=="No teacher",e(oe).numericGrade>0,e(oe).verified)>0&&ut(ct)})}a(Ja),a(ma);var vt=r(ma,2),bt=t(vt),za=t(bt);{var ua=ut=>{wr(ut,{get value(){return e(oe).numericGrade},decimals:1,duration:2.5})},Ta=ut=>{var _t=$t();b(qa=>o(_t,qa),[()=>Ce(e(oe).numericGrade,e(oe).teacher!=="No teacher",e(oe).numericGrade>0,e(oe).verified)]),i(ut,_t)};m(za,ut=>{e(oe).numericGrade>0&&e(oe).teacher!=="No teacher"&&e(oe).verified?ut(ua):ut(Ta,!1)})}var Na=r(za,2);{var Tt=ut=>{var _t=So();i(ut,_t)};m(Na,ut=>{e(oe).numericGrade>0&&!e(oe).verified&&ut(Tt)})}a(bt);var Za=r(bt,2),nt=t(Za,!0);a(Za),a(vt),a(De);var Wa=r(De,2);{var ft=ut=>{var _t=$o(),qa=t(_t),W=t(qa);{var he=wa=>{var St=ko(),Nt=t(St),wt=r(t(Nt),2),Ka=t(wt,!0);a(wt),a(Nt);var Qa=r(Nt,2);xa(Qa,5,()=>e(oe).writtenWorkScores,Jt,(gt,yt,Mt)=>{var kt=xo(),xt=t(kt),Gt=t(xt,!0);a(xt);var Ft=r(xt,2),Lt=t(Ft,!0);a(Ft),a(kt),b((Ht,G)=>{o(Gt,Ht),Zt(Ft,`color: ${G??""}`),o(Lt,e(yt))},[()=>Ne(Mt,"written"),()=>le(e(yt))]),i(gt,kt)}),a(Qa),a(St),b((gt,yt)=>{Zt(wt,`color: ${gt??""}`),o(Ka,yt)},[()=>le(e(oe).writtenWork),()=>me(e(oe).writtenWork)]),i(wa,St)};m(W,wa=>{e(oe).writtenWorkScores&&e(oe).writtenWorkScores.length>0&&wa(he)})}var ta=r(W,2);{var Pa=wa=>{var St=Ao(),Nt=t(St),wt=r(t(Nt),2),Ka=t(wt,!0);a(wt),a(Nt);var Qa=r(Nt,2);xa(Qa,5,()=>e(oe).performanceTasksScores,Jt,(gt,yt,Mt)=>{var kt=Do(),xt=t(kt),Gt=t(xt,!0);a(xt);var Ft=r(xt,2),Lt=t(Ft,!0);a(Ft),a(kt),b((Ht,G)=>{o(Gt,Ht),Zt(Ft,`color: ${G??""}`),o(Lt,e(yt))},[()=>Ne(Mt,"performance"),()=>le(e(yt))]),i(gt,kt)}),a(Qa),a(St),b((gt,yt)=>{Zt(wt,`color: ${gt??""}`),o(Ka,yt)},[()=>le(e(oe).performanceTasks),()=>me(e(oe).performanceTasks)]),i(wa,St)};m(ta,wa=>{e(oe).performanceTasksScores&&e(oe).performanceTasksScores.length>0&&wa(Pa)})}var st=r(ta,2);{var Ha=wa=>{var St=No(),Nt=t(St),wt=r(t(Nt),2),Ka=t(wt,!0);a(wt),a(Nt);var Qa=r(Nt,2);xa(Qa,5,()=>e(oe).quarterlyAssessmentScores,Jt,(gt,yt,Mt)=>{var kt=To(),xt=t(kt),Gt=t(xt,!0);a(xt);var Ft=r(xt,2),Lt=t(Ft,!0);a(Ft),a(kt),b((Ht,G)=>{o(Gt,Ht),Zt(Ft,`color: ${G??""}`),o(Lt,e(yt))},[()=>Ne(Mt,"quarterly"),()=>le(e(yt))]),i(gt,kt)}),a(Qa),a(St),b((gt,yt)=>{Zt(wt,`color: ${gt??""}`),o(Ka,yt)},[()=>le(e(oe).quarterlyAssessment),()=>me(e(oe).quarterlyAssessment)]),i(wa,St)};m(st,wa=>{e(oe).quarterlyAssessmentScores&&e(oe).quarterlyAssessmentScores.length>0&&wa(Ha)})}a(qa),a(_t),i(ut,_t)};m(Wa,ut=>{e(A).has(e(oe).id)&&ut(ft)})}a(Et),b((ut,_t,qa,W,he)=>{Ee=Z(De,1,"subject-card",null,Ee,ut),Zt(De,`border: 2px solid ${e(Ba).border??""};`),Fa(De,"role",e(ht)?"button":void 0),Zt(Da,`color: ${e(Ba).icon??""};`),Zt(L,`color: ${e(Ba).text??""};`),o(ne,e(oe).name),Ea=Z(oa,1,"teacher-name",null,Ea,_t),o(Xe,e(oe).teacher),Zt(bt,`color: ${qa??""}`),Z(Za,1,`grade-indicator ${W??""}`),o(nt,he)},[()=>({clickable:e(ht)}),()=>({"no-teacher":e(oe).teacher==="No teacher"}),()=>le(e(oe).numericGrade),()=>Te(e(oe).numericGrade).color,()=>Te(e(oe).numericGrade).text]),R("click",De,function(...ut){(e(ht)?()=>Oe(e(oe).id):void 0)?.apply(this,ut)}),R("keydown",De,function(...ut){(e(ht)?_t=>_t.key==="Enter"&&Oe(e(oe).id):void 0)?.apply(this,ut)}),i(Ya,Et)}),a(La),i(ka,La)};m(Ma,ka=>{e(q).length===0?ka(dt):ka(ha,!1)},!0)}i(Ue,Fe)};m(ia,Ue=>{e(f)?Ue(na):Ue(Ra,!1)})}a(qe),b(Ue=>{Zt($,`color: ${Ue??""}`),o(ga,`Out of ${e(U)??""} Students`),Fa(Ga,"title",e(B)?"Hide AI Analysis":"Get AI Analysis")},[()=>le(e(P))]),R("click",Ga,z),i(c,u)};m(He,c=>{e(p)?c(la):c(aa,!1)})}a(ze),b(c=>{o(Ie,e(g)),_a=Z(fa,1,"material-symbols-outlined dropdown-arrow",null,_a,c)},[()=>({rotated:e(E)})]),R("click",xe,S),i(V,ze),Wt(),w()}const Lo=300*1e3,Io="student_schedule_";function Po(){const V={scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:d,set:_,update:w}=Gs(V);function v(H){return`${Io}${H}`}function f(H){return!H||!H.timestamp?!1:Date.now()-H.timestamp<Lo}function p(H){try{const U=v(H),A=localStorage.getItem(U);if(A){const M=JSON.parse(A);if(f(M))return M.data}}catch(U){console.warn("Failed to retrieve cached student schedule data:",U)}return null}function g(H,U){try{const A=v(H),M={data:U,timestamp:Date.now()};localStorage.setItem(A,JSON.stringify(M))}catch(A){console.warn("Failed to cache student schedule data:",A)}}const C={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},k=["blue","green","purple","yellow","orange"];function N(H){return k[H%k.length]}function E(H){const[U,A]=H.split(":"),M=parseInt(U),ae=M>=12?"PM":"AM";return`${(M===0?12:M>12?M-12:M).toString().padStart(2,"0")}:${A} ${ae}`}function q(H){const U={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},A={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return H.forEach(M=>{const ae=C[M.day_of_week.toLowerCase()];if(ae){const Se=E(M.start_time),B=E(M.end_time);let ue,S;M.schedule_type==="subject"?(ue=M.subject_name||"Unknown Subject",S=M.teacher_name||"No Teacher Assigned"):M.schedule_type==="activity"&&(ue=M.activity_type_name||"Activity",S=M.teacher_name||"");const y={name:ue,time:`${Se} - ${B}`,room:M.room_name||"TBA",teacher:S,scheduleType:M.schedule_type,color:N(A[ae])};U[ae].push(y),A[ae]++}}),U}async function D(H,U=!1){try{w(S=>({...S,isLoading:!U,isRefreshing:U,error:null,currentStudentId:H}));const ae=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",B=await(await fetch(`/api/schedules?action=student-schedules&studentId=${H}&schoolYear=${ae}`)).json();if(!B.success)throw new Error(B.error||"Failed to fetch schedule data");const ue=q(B.data);w(S=>({...S,scheduleData:ue,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),g(H,{scheduleData:ue,lastUpdated:new Date().toISOString()})}catch(A){console.error("Error loading student schedule:",A),w(M=>({...M,isLoading:!1,isRefreshing:!1,error:A.message,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}}))}}function P(H){const U=p(H);return U?(w(A=>({...A,...U,currentStudentId:H,isLoading:!1,isRefreshing:!1,error:null})),!0):(w(A=>({...A,currentStudentId:H,isLoading:!0,isRefreshing:!1,error:null})),!1)}function Y(H){try{const U=v(H);localStorage.removeItem(U)}catch(U){console.warn("Failed to clear student schedule cache:",U)}return w(U=>({...V,currentStudentId:H,isLoading:!0})),ee.loadSchedule(H,!1)}const ee={subscribe:d,init:P,loadSchedule:D,forceRefresh:Y,getCachedData:H=>p(H)};return ee}const lr=Po();var Go=n('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),Ro=n("<button> </button>"),Mo=n('<div class="schedule-dropdown-menu"></div>'),Oo=n('<div class="silent-refresh-indicator"><div class="silent-loader"></div> <span>Updating...</span></div>'),Vo=n('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),Uo=n('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p>Error Loading Schedule</p> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Yo=n('<div class="class-teacher"><span class="material-symbols-outlined">person_book</span> <span> </span></div>'),Wo=n('<div><div class="class-header"><h3 class="class-name"> </h3> <span class="class-time"> </span></div> <div class="class-details"><div class="class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!></div></div>'),Ho=n('<div class="classes-list"></div>'),Qo=n('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),Bo=n('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-header"><div class="schedule-header-content"><div class="schedule-header-text"><h1 class="page-title">Schedule</h1> <p class="page-subtitle">Your weekly class schedule</p></div></div></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="day-selector"></div> <div class="schedule-mobile-dropdown"><button class="schedule-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><!> <button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function Jo(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(lr,"$studentScheduleStore",_),f=()=>ns(ls,"$authStore",_),p=new Date,g=["January","February","March","April","May","June","July","August","September","October","November","December"],C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k=g[p.getMonth()],N=p.getDate(),E=C[p.getDay()],q={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},D=p.getDay();let P=q[D]||"Mon",Y=jt(()=>v().scheduleData),ee=jt(()=>v().isLoading),H=jt(()=>v().isRefreshing),U=jt(()=>v().error);async function A(){const Je=f();Je.isAuthenticated&&Je.userData?.id&&await lr.forceRefresh(Je.userData.id)}Bt(()=>{const Je=f();if(Je.isAuthenticated&&Je.userData?.id){const Re=lr.init(Je.userData.id);lr.loadSchedule(Je.userData.id,Re);const He=setInterval(()=>{const la=f();la.isAuthenticated&&la.userData?.id&&lr.loadSchedule(la.userData.id,!0)},300*1e3);return()=>{clearInterval(He)}}});const M=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}],ae={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"};let Se=jt(()=>e(Y)[P]||[]),B=jt(()=>ae[P]||P),ue=!1;function S(Je){Je.target.closest(".schedule-mobile-dropdown")||(ue=!1)}function y(){ue=!ue}function ce(Je){P=Je,ue=!1}var ve=Bo(),le=r(t(ve),2),Ce=t(le),me=t(Ce),Me=t(me);a(me),a(Ce);var Ae=r(Ce,2);xa(Ae,21,()=>M,Jt,(Je,Re)=>{let He=()=>e(Re).day;var la=Go(),aa=t(la),c=t(aa,!0);a(aa);var u=r(aa,2),j=t(u,!0);a(u),a(la),b(()=>{Z(la,1,`day-btn ${He()===P?"active":""}`),o(c,He()),o(j,ae[He()])}),R("click",la,()=>ce(He())),i(Je,la)}),a(Ae);var re=r(Ae,2),Te=t(re),Oe=t(Te),ea=t(Oe,!0);a(Oe);var Ke=r(Oe,2);a(Te);var z=r(Te,2);{var Ne=Je=>{var Re=Mo();xa(Re,21,()=>M,Jt,(He,la)=>{let aa=()=>e(la).day;var c=Ro(),u=t(c,!0);a(c),b(()=>{Z(c,1,`schedule-dropdown-item ${aa()===P?"selected":""}`),o(u,ae[aa()])}),R("click",c,()=>ce(aa())),i(He,c)}),a(Re),i(Je,Re)};m(z,Je=>{ue&&Je(Ne)})}a(re),a(le);var Qe=r(le,2),we=t(Qe),ze=t(we),Be=t(ze);a(ze);var We=r(ze,2),sa=t(We);{var xe=Je=>{var Re=Oo();i(Je,Re)};m(sa,Je=>{e(H)&&Je(xe)})}var ge=r(sa,2);a(We),a(we);var Ie=r(we,2);{var fa=Je=>{var Re=Vo();i(Je,Re)},_a=Je=>{var Re=ja(),He=va(Re);{var la=c=>{var u=Uo(),j=r(t(u),4),K=t(j,!0);a(j);var ke=r(j,2);a(u),b(()=>o(K,e(U))),R("click",ke,A),i(c,u)},aa=c=>{var u=ja(),j=va(u);{var K=Pe=>{var de=Ho();xa(de,21,()=>e(Se),Jt,($e,te)=>{var T=Wo(),x=t(T),$=t(x),Q=t($,!0);a($);var X=r($,2),Le=t(X,!0);a(X),a(x);var I=r(x,2),ie=t(I),se=r(t(ie),2),Ge=t(se,!0);a(se),a(ie);var Ve=r(ie,2);{var Ze=Ye=>{var ga=Yo(),da=r(t(ga),2),Oa=t(da,!0);a(da),a(ga),b(()=>o(Oa,e(te).teacher)),i(Ye,ga)};m(Ve,Ye=>{e(te).teacher&&Ye(Ze)})}a(I),a(T),b(()=>{Z(T,1,`class-card ${e(te).color??""}`),o(Q,e(te).name),o(Le,e(te).time),o(Ge,e(te).scheduleType==="activity"?"No room":e(te).room)}),i($e,T)}),a(de),i(Pe,de)},ke=Pe=>{var de=Qo(),$e=r(t(de),4),te=t($e);a($e),a(de),b(()=>o(te,`You don't have any classes scheduled for ${e(B)??""}. Enjoy your free day!`)),i(Pe,de)};m(j,Pe=>{e(Se).length>0?Pe(K):Pe(ke,!1)},!0)}i(c,u)};m(He,c=>{e(U)?c(la):c(aa,!1)},!0)}i(Je,Re)};m(Ie,Je=>{e(ee)?Je(fa):Je(_a,!1)})}a(Qe),a(ve),b(()=>{o(Me,`${E??""}, ${k??""} ${N??""}`),o(ea,ae[P]||"Select Day"),Z(Ke,1,`material-symbols-outlined schedule-dropdown-icon ${ue?"open":""}`),o(Be,`${e(B)??""} Classes`),ge.disabled=e(ee)}),R("click",Te,y),R("click",ge,A),R("click",ve,S),R("keydown",ve,S),i(V,ve),Wt(),w()}var zo=n('<button><div class="doc-dropdown-item-content"><span class="doc-dropdown-item-name"> </span> <span class="doc-dropdown-item-desc"> </span></div></button>'),Ko=n('<div class="dropdown-menu-document"></div>'),Zo=n('<div class="request-form-section"><div class="form-container"><div class="form-header"><h2 class="form-title">New Document Request</h2> <p class="form-subtitle">Fill out the form below to request a document</p></div> <div class="form-content"><div class="form-group"><label class="form-label" for="document-type-dropdown"><span class="material-symbols-outlined form-icon">description</span> Document Type</label> <div class="custom-dropdown"><button id="document-type-dropdown" class="dropdown-toggle"><span><!></span> <span>expand_more</span></button> <!></div></div> <div class="form-group"><label class="form-label" for="description"><span class="material-symbols-outlined form-icon">edit_note</span> Purpose & Details</label> <textarea id="description" class="form-textarea enhanced" placeholder="Please describe the purpose of your request and any specific requirements..." rows="5"></textarea> <div class="form-help"><span class="material-symbols-outlined help-icon">info</span> Be specific about your needs to help us process your request efficiently</div></div> <div class="document-form-actions"><button class="document-cancel-button">Cancel</button> <button class="submit-button"><!></button></div></div></div></div>'),Xo=n('<div class="loading-message"><div class="system-loader"></div> Loading your document requests...</div>'),el=n('<div class="no-requests-message"><span class="material-symbols-outlined">description</span> <p>No document requests found</p> <p class="subtitle">Start by requesting your first document above</p></div>'),al=n('<div class="request-footer completed-footer"><span class="footer-info"> </span></div>'),tl=n('<div class="request-footer processing-footer"><span class="footer-info"><!></span></div>'),sl=n('<div class="request-footer pending-footer"><span class="footer-info">Awaiting review</span> <button class="cancel-request-button"><span class="material-symbols-outlined">close</span> Cancel</button></div>'),rl=n('<div class="request-footer cancelled-footer"><span class="footer-info"> </span></div>'),il=n('<div class="request-footer rejected-footer"><span class="footer-info"> </span></div>'),nl=n('<div><div class="request-main-content"><div class="request-status-icon"><span class="material-symbols-outlined"> </span></div> <div class="request-content"><div class="request-header"><div class="request-info"><h3 class="request-title"> </h3> <p class="request-date"> </p></div> <div> </div></div> <p class="request-description"> </p></div></div> <!></div>'),ol=n('<div class="request-history-grid"></div>'),ll=n('<div class="document-request-container" role="button" tabindex="0"><div class="document-header"><div class="header-content"><h1 class="page-title">Document Requests</h1> <p class="page-subtitle">Request new documents or check existing requests</p></div></div> <div class="quick-actions-section"><div class="quick-actions-header"><h2 class="section-title">Quick Actions</h2> <p class="section-subtitle">Request new documents or check existing requests</p></div> <button class="request-new-button"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="request-history-section"><h2 class="section-title">Request History</h2> <!></div></div>');function dl(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=h(!1),p=h(""),g=h(""),C=h(!1),k=h(!1),N=h([]),E=h(!0),q=null;function D(re){re.target.closest(".custom-dropdown")||s(k,!1)}function P(){s(k,!e(k))}function Y(re){s(p,re.id),s(k,!1)}const ee=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}];async function H(){try{if(s(E,!0),q=null,!v().userData?.id){q="User not authenticated";return}const re=await lt.get(`/api/document-requests?student_id=${v().userData.id}`);re.success?s(N,re.data):q=re.error||"Failed to fetch document requests"}catch(re){console.error("Error fetching document requests:",re),q="Failed to load document requests. Please try again."}finally{s(E,!1)}}Bt(()=>{v().userData?.id?H():(q="Please log in to view your document requests",s(E,!1))});async function U(re){try{const Te=await lt.patch("/api/document-requests",{id:re,action:"cancel"});Te.success?s(N,e(N).map(Oe=>Oe.id===re?{...Oe,status:"cancelled",cancelledDate:Te.data.cancelledDate}:Oe)):console.error("Failed to cancel request:",Te.error)}catch(Te){console.error("Error cancelling request:",Te)}}function A(){s(f,!e(f)),e(f)?setTimeout(()=>{const re=document.querySelector(".request-form-section");re&&re.scrollIntoView({behavior:"smooth",block:"center"})},100):(s(p,""),s(g,""),s(k,!1))}async function M(){if(!(!e(p)||!e(g).trim())){s(C,!0);try{const re=await lt.post("/api/document-requests",{student_id:v().userData.id,document_type:e(p),purpose:e(g)});re.success?(s(N,[re.data,...e(N)]),A()):q=re.error||"Failed to submit document request"}catch(re){console.error("Error submitting document request:",re),q="Failed to submit document request. Please try again."}finally{s(C,!1)}}}function ae(re){switch(re){case"completed":return"check_circle";case"processing":return"sync";case"pending":return"hourglass_empty";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}cs();var Se=ll(),B=r(t(Se),2),ue=r(t(B),2),S=t(ue),y=t(S,!0);a(S);var ce=r(S);a(ue),a(B);var ve=r(B,2);{var le=re=>{var Te=Zo(),Oe=t(Te),ea=r(t(Oe),2),Ke=t(ea),z=r(t(Ke),2),Ne=t(z),Qe=t(Ne),we=t(Qe);{var ze=aa=>{var c=$t();b(u=>o(c,u),[()=>ee.find(u=>u.id===e(p))?.name||"Select Document Type"]),i(aa,c)},Be=aa=>{var c=$t("Choose the document you need");i(aa,c)};m(we,aa=>{e(p)?aa(ze):aa(Be,!1)})}a(Qe);var We=r(Qe,2);a(Ne);var sa=r(Ne,2);{var xe=aa=>{var c=Ko();xa(c,5,()=>ee,Jt,(u,j)=>{var K=zo(),ke=t(K),Pe=t(ke),de=t(Pe,!0);a(Pe);var $e=r(Pe,2),te=t($e,!0);a($e),a(ke),a(K),b(()=>{Z(K,1,`doc-dropdown-item ${e(j).id===e(p)?"selected":""}`),o(de,e(j).name),o(te,e(j).description)}),R("click",K,()=>Y(e(j))),i(u,K)}),a(c),i(aa,c)};m(sa,aa=>{e(k)&&aa(xe)})}a(z),a(Ke);var ge=r(Ke,2),Ie=r(t(ge),2);Sr(Ie),et(2),a(ge);var fa=r(ge,2),_a=t(fa),Je=r(_a,2),Re=t(Je);{var He=aa=>{var c=$t("Submitting...");i(aa,c)},la=aa=>{var c=$t("Submit Request");i(aa,c)};m(Re,aa=>{e(C)?aa(He):aa(la,!1)})}a(Je),a(fa),a(ea),a(Oe),a(Te),b(aa=>{Z(We,1,`material-symbols-outlined dropdown-icon ${e(k)?"open":""}`),_a.disabled=e(C),Je.disabled=aa},[()=>!e(p)||!e(g).trim()||e(C)]),R("click",Ne,P),tt(Ie,()=>e(g),aa=>s(g,aa)),R("click",_a,A),R("click",Je,M),i(re,Te)};m(ve,re=>{e(f)&&re(le)})}var Ce=r(ve,2),me=r(t(Ce),2);{var Me=re=>{var Te=Xo();i(re,Te)},Ae=re=>{var Te=ja(),Oe=va(Te);{var ea=z=>{var Ne=el();i(z,Ne)},Ke=z=>{var Ne=ol();xa(Ne,7,()=>e(N),Qe=>Qe.id,(Qe,we,ze)=>{var Be=nl(),We=t(Be),sa=t(We),xe=t(sa),ge=t(xe,!0);a(xe),a(sa);var Ie=r(sa,2),fa=t(Ie),_a=t(fa),Je=t(_a),Re=t(Je,!0);a(Je);var He=r(Je,2),la=t(He);a(He),a(_a);var aa=r(_a,2),c=t(aa,!0);a(aa),a(fa);var u=r(fa,2),j=t(u,!0);a(u),a(Ie),a(We);var K=r(We,2);{var ke=de=>{var $e=al(),te=t($e),T=t(te);a(te),a($e),b(()=>o(T,`Completed on ${e(we).completedDate??""}${e(we).completedByAdmin?` by ${e(we).completedByAdmin}`:""}`)),i(de,$e)},Pe=de=>{var $e=ja(),te=va($e);{var T=$=>{var Q=tl(),X=t(Q),Le=t(X);{var I=se=>{var Ge=$t();b(()=>o(Ge,`Note${e(we).adminName?` by ${e(we).adminName}`:""}: ${e(we).adminNote??""}`)),i(se,Ge)},ie=se=>{var Ge=$t();b(()=>o(Ge,e(we).adminName?`Being processed by ${e(we).adminName}`:"Processing your request")),i(se,Ge)};m(Le,se=>{e(we).adminNote?se(I):se(ie,!1)})}a(X),a(Q),i($,Q)},x=$=>{var Q=ja(),X=va(Q);{var Le=ie=>{var se=sl(),Ge=r(t(se),2);a(se),R("click",Ge,()=>U(e(we).id)),i(ie,se)},I=ie=>{var se=ja(),Ge=va(se);{var Ve=Ye=>{var ga=rl(),da=t(ga),Oa=t(da);a(da),a(ga),b(()=>o(Oa,`Cancelled on ${e(we).cancelledDate??""}`)),i(Ye,ga)},Ze=Ye=>{var ga=ja(),da=va(ga);{var Oa=Ga=>{var fe=il(),O=t(fe),F=t(O);a(O),a(fe),b(()=>o(F,`Reason${e(we).adminName?` by ${e(we).adminName}`:""}: ${e(we).rejectionReason??""}`)),i(Ga,fe)};m(da,Ga=>{e(we).status==="rejected"&&Ga(Oa)},!0)}i(Ye,ga)};m(Ge,Ye=>{e(we).status==="cancelled"?Ye(Ve):Ye(Ze,!1)},!0)}i(ie,se)};m(X,ie=>{e(we).status==="pending"?ie(Le):ie(I,!1)},!0)}i($,Q)};m(te,$=>{e(we).status==="processing"?$(T):$(x,!1)},!0)}i(de,$e)};m(K,de=>{e(we).status==="completed"?de(ke):de(Pe,!1)})}a(Be),b(de=>{Z(Be,1,`request-card ${e(we).status??""}`),Zt(Be,`--card-index: ${e(ze)+1};`),o(ge,de),o(Re,e(we).type),o(la,`Requested on ${e(we).requestedDate??""}`),Z(aa,1,`student-status-badge status-${e(we).status??""}`),o(c,e(we).status==="completed"?"Completed":e(we).status==="processing"?"Processing":e(we).status==="pending"?"Pending":e(we).status==="rejected"?"Rejected":e(we).status==="cancelled"?"Cancelled":"Unknown"),o(j,e(we).purpose)},[()=>ae(e(we).status)]),i(Qe,Be)}),a(Ne),i(z,Ne)};m(Oe,z=>{e(N).length===0?z(ea):z(Ke,!1)},!0)}i(re,Te)};m(me,re=>{e(E)?re(Me):re(Ae,!1)})}a(Ce),a(Se),b(()=>{ue.disabled=e(E),o(y,e(f)?"remove":"add"),o(ce,` ${e(f)?"Cancel Request":"Request New Document"}`)}),R("click",ue,A),R("click",Se,D),R("keydown",Se,D),i(V,Se),Wt(),w()}var cl=n('<span class="count-badge"> </span>'),vl=n('<button><span class="material-symbols-outlined"> </span> <span> </span> <!></button>'),ul=n('<div class="filter-dropdown-menu"></div>'),ml=n('<button class="notifications-action-btn mark-all-read" title="Mark All Read"><span class="material-symbols-outlined">done_all</span></button>'),pl=n('<button class="notifications-action-btn clear-read" title="Clear Read"><span class="material-symbols-outlined">clear_all</span></button>'),fl=n('<div class="loading-state"><div class="system-loader"></div> <p>Loading notifications...</p></div>'),_l=n('<div class="error-state"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Notifications</h3> <p> </p> <button class="retry-btn">Reload</button></div>'),gl=n('<div class="admin-note"><span class="material-symbols-outlined">note</span> <div class="note-content"><span class="note-label">Admin Note:</span> <span class="note-text"> </span></div></div>'),hl=n('<div class="rejection-reason"><span class="material-symbols-outlined">error</span> <div class="reason-content"><span class="reason-label">Rejection Reason:</span> <span class="reason-text"> </span></div></div>'),bl=n("<!> <!>",1),yl=n('<div><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p> <!></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),wl=n('<div class="notifications-list"></div>'),Sl=n('<div class="no-notifications"><div class="no-notifications-icon"><span class="material-symbols-outlined"> </span></div> <h3> </h3> <p> </p></div>'),xl=n('<div class="notification-container"><div class="notification-header"><div class="header-content"><h1 class="page-title">Notifications</h1> <p class="page-subtitle">Stay updated with your academic activities <span class="notification-badge"> </span></p></div></div> <div class="filter-actions-section"><div class="filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="actions-section"><!> <!></div></div> <div class="notifications-section"><!></div></div>');function kl(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_),f=h();let p=h([]),g=h(!0),C=h(null),k=h(0),N=0;const E=[{value:"all",label:"All Notifications",icon:"notifications"},{value:"unread",label:"Unread Only",icon:"mark_email_unread"},{value:"todo",label:"To-Do Due Dates",icon:"assignment"},{value:"grade",label:"Grades",icon:"grade"},{value:"document",label:"Document Requests",icon:"description"}];let q=h("all"),D=h(!1);function P(){s(D,!e(D))}function Y(c){s(q,c),s(D,!1),ue()}function ee(c){c.target.closest(".filter-dropdown")||s(D,!1)}function H(c){const u=e(p).find(j=>j.id===c);u?S(c,!u.isRead):console.warn("Notification not found for toggle:",c)}function U(c){y(c)}function A(){ce()}function M(){ve()}function ae(c){const u=new Date(c),j=new Date,K=Math.floor((j-u)/(1e3*60*60));if(K<1){const ke=Math.floor((j-u)/6e4);return ke<=1?"Just now":`${ke} minutes ago`}else{if(K<24)return`${K} hour${K>1?"s":""} ago`;{const ke=Math.floor(K/24);return ke<7?`${ke} day${ke>1?"s":""} ago`:u.toLocaleDateString("en-US",{month:"short",day:"numeric",year:u.getFullYear()!==j.getFullYear()?"numeric":void 0})}}}function Se(c){const u=E.find(j=>j.value===c);return u?u.label:"All Notifications"}function B(c){const u=E.find(j=>j.value===c);return u?u.icon:"notifications"}async function ue(){try{s(g,!0),s(C,null);const c=v().userData;if(console.log("Auth store userData:",c),!c?.id)throw new Error("User not authenticated");const u=new URLSearchParams({student_id:c.id,...e(q)!=="all"&&e(q)!=="unread"&&{type:e(q)},...e(q)==="unread"&&{is_read:"false"}});console.log("Fetching notifications with params:",u.toString());const j=await ms(`/api/notifications?${u}`);if(!j.ok)throw new Error(`Failed to fetch notifications: ${j.status}`);const K=await j.json();console.log("API response data:",K);const ke=K.data||K;s(p,ke.notifications||[]),console.log("Transformed notifications:",e(p)),s(k,ke.unreadCount||0),N=ke.pagination?.total||e(p).length}catch(c){console.error("Error fetching notifications:",c),s(C,c.message),s(p,[])}finally{s(g,!1)}}async function S(c,u){try{if(!v().userData?.id)throw new Error("User not authenticated");const K=await ms("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,action:u?"mark_read":"mark_unread"})});if(!K.ok)throw new Error(`Failed to update notification: ${K.status}`);s(p,e(p).map(ke=>ke.id===c?{...ke,isRead:u}:ke)),u?s(k,Math.max(0,e(k)-1)):s(k,e(k)+1)}catch(j){console.error("Error updating notification status:",j),s(C,j.message)}}async function y(c){try{if(!v().userData?.id)throw new Error("User not authenticated");const j=await ms("/api/notifications",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c})});if(!j.ok)throw new Error(`Failed to delete notification: ${j.status}`);const K=e(p).find(ke=>ke.id===c);s(p,e(p).filter(ke=>ke.id!==c)),K&&!K.isRead&&s(k,Math.max(0,e(k)-1)),N=Math.max(0,N-1)}catch(u){console.error("Error deleting notification:",u),s(C,u.message)}}async function ce(){try{if(!v().userData?.id)throw new Error("User not authenticated");const u=await ms("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"mark_all_read"})});if(!u.ok)throw new Error(`Failed to mark all as read: ${u.status}`);s(p,e(p).map(j=>({...j,isRead:!0}))),s(k,0)}catch(c){console.error("Error marking all as read:",c),s(C,c.message)}}async function ve(){try{if(!v().userData?.id)throw new Error("User not authenticated");const u=await ms("/api/notifications",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete_read"})});if(!u.ok)throw new Error(`Failed to clear read notifications: ${u.status}`);const j=e(p).filter(K=>K.isRead).length;s(p,e(p).filter(K=>!K.isRead)),N=Math.max(0,N-j)}catch(c){console.error("Error clearing read notifications:",c),s(C,c.message)}}Bt(()=>{v().userData?.id&&ue()}),at(()=>(e(p),e(q)),()=>{s(f,Array.isArray(e(p))?e(q)==="all"?e(p):e(q)==="unread"?e(p).filter(c=>!c.isRead):e(p).filter(c=>c.type===e(q)):[])}),ps(),cs();var le=xl();R("click",Ts,ee);var Ce=t(le),me=t(Ce),Me=r(t(me),2),Ae=r(t(Me)),re=t(Ae);a(Ae),a(Me),a(me),a(Ce);var Te=r(Ce,2),Oe=t(Te),ea=t(Oe),Ke=t(ea),z=t(Ke),Ne=t(z),Qe=t(Ne,!0);a(Ne);var we=r(Ne,2),ze=t(we,!0);a(we),a(z);var Be=r(z,2);let We;a(Ke);var sa=r(Ke,2);{var xe=c=>{var u=ul();xa(u,5,()=>E,Jt,(j,K)=>{var ke=vl();let Pe;var de=t(ke),$e=t(de,!0);a(de);var te=r(de,2),T=t(te,!0);a(te);var x=r(te,2);{var $=Q=>{var X=cl(),Le=t(X,!0);a(X),b(()=>o(Le,e(k))),i(Q,X)};m(x,Q=>{e(K),l(()=>e(K).value==="unread")&&Q($)})}a(ke),b(Q=>{Pe=Z(ke,1,"filter-dropdown-item",null,Pe,Q),o($e,(e(K),l(()=>e(K).icon))),o(T,(e(K),l(()=>e(K).label)))},[()=>({active:e(K).value===e(q)})]),R("click",ke,()=>Y(e(K).value)),i(j,ke)}),a(u),i(c,u)};m(sa,c=>{e(D)&&c(xe)})}a(ea),a(Oe);var ge=r(Oe,2),Ie=t(ge);{var fa=c=>{var u=ml();R("click",u,A),i(c,u)};m(Ie,c=>{e(k)>0&&c(fa)})}var _a=r(Ie,2);{var Je=c=>{var u=pl();R("click",u,M),i(c,u)};m(_a,c=>{e(p),l(()=>e(p).some(u=>u.isRead))&&c(Je)})}a(ge),a(Te);var Re=r(Te,2),He=t(Re);{var la=c=>{var u=fl();i(c,u)},aa=c=>{var u=ja(),j=va(u);{var K=Pe=>{var de=_l(),$e=r(t(de),4),te=t($e,!0);a($e);var T=r($e,2);a(de),b(()=>o(te,e(C))),R("click",T,ue),i(Pe,de)},ke=Pe=>{var de=ja(),$e=va(de);{var te=x=>{var $=wl();xa($,7,()=>e(f),Q=>Q.id,(Q,X,Le)=>{var I=yl(),ie=t(I),se=t(ie),Ge=t(se,!0);a(se);var Ve=r(se,2),Ze=t(Ve,!0);a(Ve),a(ie);var Ye=r(ie,2),ga=t(Ye),da=t(ga),Oa=t(da,!0);a(da);var Ga=r(da,2);{var fe=ia=>{var na=bl(),Ra=va(na);{var Ue=dt=>{var ha=gl(),ka=r(t(ha),2),La=r(t(ka),2),Ya=t(La,!0);a(La),a(ka),a(ha),b(()=>o(Ya,(e(X),l(()=>e(X).adminNote)))),i(dt,ha)};m(Ra,dt=>{e(X),l(()=>e(X).adminNote)&&dt(Ue)})}var Fe=r(Ra,2);{var Ma=dt=>{var ha=hl(),ka=r(t(ha),2),La=r(t(ka),2),Ya=t(La,!0);a(La),a(ka),a(ha),b(()=>o(Ya,(e(X),l(()=>e(X).rejectionReason)))),i(dt,ha)};m(Fe,dt=>{e(X),l(()=>e(X).rejectionReason)&&dt(Ma)})}i(ia,na)};m(Ga,ia=>{e(X),l(()=>e(X).type==="document_request")&&ia(fe)})}a(ga);var O=r(ga,2),F=t(O),J=t(F),_e=t(J,!0);a(J),a(F);var qe=r(F,2);a(O),a(Ye),a(I),b(ia=>{Z(I,1,`notification-card ${e(X),l(()=>e(X).isRead?"read":"unread")??""}`),Zt(I,`--card-index: ${e(Le)??""}`),o(Ge,(e(X),l(()=>e(X).title))),o(Ze,ia),o(Oa,(e(X),l(()=>e(X).message))),Fa(F,"title",(e(X),l(()=>e(X).isRead?"Mark as unread":"Mark as read"))),o(_e,(e(X),l(()=>e(X).isRead?"mark_email_unread":"mark_email_read")))},[()=>(e(X),l(()=>ae(e(X).timestamp)))]),R("click",F,()=>H(e(X).id)),R("click",qe,()=>U(e(X).id)),i(Q,I)}),a($),i(x,$)},T=x=>{var $=Sl(),Q=t($),X=t(Q),Le=t(X,!0);a(X),a(Q);var I=r(Q,2),ie=t(I,!0);a(I);var se=r(I,2),Ge=t(se,!0);a(se),a($),b(Ve=>{o(Le,e(q)==="unread"?"mark_email_read":"notifications_off"),o(ie,e(q)==="unread"?"All Caught Up!":"No Notifications"),o(Ge,Ve)},[()=>(e(q),l(()=>e(q)==="unread"?"You have no unread notifications. Great job staying on top of things!":e(q)==="all"?"You don't have any notifications yet.":`No ${Se(e(q)).toLowerCase()} notifications found.`))]),i(x,$)};m($e,x=>{e(f),l(()=>e(f).length>0)?x(te):x(T,!1)},!0)}i(Pe,de)};m(j,Pe=>{e(C)?Pe(K):Pe(ke,!1)},!0)}i(c,u)};m(He,c=>{e(g)?c(la):c(aa,!1)})}a(Re),a(le),b((c,u,j)=>{o(re,`${e(k)??""} unread`),o(Qe,c),o(ze,u),We=Z(Be,1,"material-symbols-outlined dropdown-arrow",null,We,j)},[()=>(e(q),l(()=>B(e(q)))),()=>(e(q),l(()=>Se(e(q)))),()=>({rotated:e(D)})]),R("click",Ke,P),i(V,le),Wt(),w()}var Dl=n('<button type="button"><span class="material-symbols-outlined"> </span> <span> </span></button>'),Al=n('<div class="dropdown-menu-category"></div>'),Tl=n('<button class="clear-date-btn" type="button" title="Clear date"><span class="material-symbols-outlined">close</span></button>'),Nl=n('<div class="day-header"> </div>'),$l=n('<div class="empty-day"></div>'),Cl=n('<button type="button"> </button>'),jl=n('<div class="date-picker-dropdown"><div class="date-picker-header"><button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_left</span></button> <div class="month-year-display"><span class="month-name"> </span> <span class="year-name"> </span></div> <button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_right</span></button></div> <div class="calendar-grid"><!> <!> <!></div></div>'),El=n('<div class="add-todo-section"><h2 class="section-title">Add New Task</h2> <div class="add-todo-form"><input type="text" placeholder="Enter task title..." class="todo-input"/> <textarea placeholder="Enter description (optional)..." class="todo-input todo-textarea" rows="3"></textarea> <div class="form-row"><div class="form-field"><label class="form-label" for="category-dropdown">Category</label> <div class="custom-dropdown"><button class="dropdown-toggle" id="category-dropdown" type="button"><div class="dropdown-toggle-content"><span class="material-symbols-outlined dropdown-icon-left"> </span> <span class="dropdown-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="form-field"><label class="form-label" for="due-date-picker">Due Date (optional)</label> <div class="custom-date-picker"><div class="date-picker-toggle-wrapper"><button class="date-picker-toggle" id="due-date-picker" type="button"><div class="date-picker-toggle-content"><span class="material-symbols-outlined date-picker-icon-left">calendar_today</span> <span class="date-picker-label"> </span></div> <div class="date-picker-actions"><!> <span>expand_more</span></div></button></div> <!></div></div></div> <button class="add-todo-btn"> </button></div></div>'),ql=n('<button class="clear-search-btn"><span class="material-symbols-outlined">close</span></button>'),Fl=n('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Ll=n('<div class="filter-dropdown-menu"></div>'),Il=n('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Pl=n('<div class="filter-dropdown-menu"></div>'),Gl=n('<div class="loading-state"><div class="system-loader"></div> <p>Loading todos...</p></div>'),Rl=n('<div class="error-state"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-btn">Retry</button></div>'),Ml=n('<p class="todo-description"> </p>'),Ol=n('<div><div class="todo-checkbox"><input type="checkbox"/> <label class="checkbox-label"></label></div> <div class="todo-content"><h3> </h3> <!> <div class="todo-meta"><span class="todo-category"> </span> <span class="todo-due-date"> </span></div></div> <div class="todo-actions"><button class="action-btn todo-delete-btn" title="Delete task"><span class="material-symbols-outlined">delete</span></button></div></div>'),Vl=n('<div class="todos-list"></div>'),Ul=n('<div class="no-filtered-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">search_off</span></div> <h3>No Matching Tasks</h3> <p>No tasks match your current search or filter criteria.</p> <button class="clear-filters-btn">Clear all filters</button></div>'),Yl=n(`<div class="no-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">check_circle</span></div> <h3>No Tasks</h3> <p>You don't have any tasks yet. Add one above to get started!</p></div>`),Wl=n('<div class="todo-container"><div class="todo-header"><div class="header-content"><h1 class="page-title">Todo List</h1> <p class="page-subtitle">Keep track of your tasks and assignments <span class="progress-badge"> </span></p></div></div> <div class="add-todo-button-section"><button class="add-todo-toggle-btn"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="search-filter-section"><div class="search-filter-row"><div class="todo-search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="todo-search-input" placeholder="Search todos by title or description..."/> <!></div> <div class="todo-filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div></div></div> <div class="todos-section"><!></div></div>');function Hl(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_),f=h(),p=h(),g=h(),C=h(),k=h(),N=h();let E=h([]),q=h(!1),D=h(!1),P=h(null),Y=h(""),ee=h("all"),H=h("all"),U=h(!1),A=h(!1),M=h(""),ae=h(""),Se=h("personal"),B=h(""),ue=h(!1);const S=[{value:"all",label:"All Categories",icon:"category"},{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}],y=[{value:"all",label:"All Status",icon:"list"},{value:"pending",label:"Pending",icon:"pending"},{value:"completed",label:"Completed",icon:"check_circle"}],ce=[{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}];let ve=h(!1),le=h(!1);const Ce=new Date;let me=h(Ce.getFullYear()),Me=h(Ce.getMonth());const Ae=["January","February","March","April","May","June","July","August","September","October","November","December"],re=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];async function Te(){try{s(D,!0),s(P,null);const L=v().userData;if(!L||!L.id)throw new Error("User not authenticated");const ne=await lt.get(`/api/student-todos?studentId=${L.id}`);if(ne.success)s(E,ne.data||[]);else throw new Error(ne.error||"Failed to fetch todos")}catch(L){console.error("Error fetching todos:",L),s(P,L.message),ye.error("Failed to load todos: "+L.message)}finally{s(D,!1)}}async function Oe(){try{s(q,!0);const L=v().userData;if(!L||!L.id)throw new Error("User not authenticated");if(!e(M).trim()){ye.error("Please enter a title for your todo");return}const ne={studentId:L.id,title:e(M).trim(),description:e(ae).trim()||null,category:e(Se),dueDate:e(B)||null},oa=await lt.post("/api/student-todos",ne);if(oa.success)s(E,[oa.data,...e(E)]),ye.success("Todo added successfully!"),s(M,""),s(ae,""),s(Se,"personal"),s(B,""),s(ue,!1);else throw new Error(oa.error||"Failed to add todo")}catch(L){console.error("Error adding todo:",L),ye.error("Failed to add todo: "+L.message)}finally{s(q,!1)}}async function ea(L){try{const ne=v().userData;if(!ne||!ne.id)throw new Error("User not authenticated");const oa=await lt.delete("/api/student-todos",{id:L,studentId:ne.id});if(oa.success)s(E,e(E).filter(Ea=>Ea.id!==L)),ye.success("Todo deleted successfully!");else throw new Error(oa.error||"Failed to delete todo")}catch(ne){console.error("Error deleting todo:",ne),ye.error("Failed to delete todo: "+ne.message)}}async function Ke(L){try{const ne=v().userData;if(!ne||!ne.id)throw new Error("User not authenticated");const oa=await lt.put("/api/student-todos",{id:L,studentId:ne.id,action:"toggle"});if(oa.success){s(E,e(E).map(Ja=>Ja.id===L?oa.data:Ja));const Xe=oa.data.completed?"Todo marked as completed!":"Todo marked as pending!";ye.success(Xe)}else throw new Error(oa.error||"Failed to update todo")}catch(ne){console.error("Error toggling todo:",ne),ye.error("Failed to update todo: "+ne.message)}}Bt(()=>{Te()});function z(L){is.confirm("Delete Task",`Are you sure you want to delete "${L.title}"? This action cannot be undone.`,async()=>{await ea(L.id)},()=>{})}function Ne(){s(ue,!e(ue)),e(ue)||(s(M,""),s(ae,""),s(Se,"personal"),s(B,""),s(ve,!1),s(le,!1))}function Qe(){s(U,!e(U))}function we(){s(A,!e(A))}function ze(L){s(ee,L),s(U,!1)}function Be(L){s(H,L),s(A,!1)}function We(L){const ne=S.find(oa=>oa.value===L);return ne?ne.label:"All Categories"}function sa(L){const ne=S.find(oa=>oa.value===L);return ne?ne.icon:"category"}function xe(L){const ne=y.find(oa=>oa.value===L);return ne?ne.label:"All Status"}function ge(L){const ne=y.find(oa=>oa.value===L);return ne?ne.icon:"list"}function Ie(){s(ve,!e(ve))}function fa(L){s(Se,L),s(ve,!1)}function _a(L){L.target.closest(".custom-dropdown")||s(ve,!1),L.target.closest(".custom-date-picker")||s(le,!1),L.target.closest(".filter-dropdown")||(s(U,!1),s(A,!1))}Bt(()=>(document.addEventListener("click",_a),v().userData?.id&&Te(),()=>{document.removeEventListener("click",_a)}));function Je(L){const ne=ce.find(oa=>oa.value===L);return ne?ne.label:"Select Category"}function Re(L){const ne=ce.find(oa=>oa.value===L);return ne?ne.icon:"category"}function He(){if(s(le,!e(le)),e(le))if(e(B)){const L=new Date(e(B)+"T00:00:00");s(me,L.getFullYear()),s(Me,L.getMonth()),L.getDate()}else{const L=new Date;s(me,L.getFullYear()),s(Me,L.getMonth())}}function la(L){const ne=e(me),oa=e(Me)+1,Ea=L.toString().padStart(2,"0"),Xe=oa.toString().padStart(2,"0");s(B,`${ne}-${Xe}-${Ea}`),s(le,!1)}function aa(){s(B,""),s(le,!1)}function c(){e(Me)===0?(s(Me,11),yr(me,-1)):yr(Me,-1)}function u(){e(Me)===11?(s(Me,0),yr(me)):yr(Me)}function j(L,ne){return new Date(L,ne+1,0).getDate()}function K(L,ne){return new Date(L,ne,1).getDay()}function ke(L){const ne=new Date;return L===ne.getDate()&&e(Me)===ne.getMonth()&&e(me)===ne.getFullYear()}function Pe(L){if(!e(B))return!1;const ne=new Date(e(B)+"T00:00:00");return L===ne.getDate()&&e(Me)===ne.getMonth()&&e(me)===ne.getFullYear()}function de(L){if(!L||L==="No due date")return"No due date";if(L==="Today"||L==="Tomorrow"||L==="Next Week")return L;const ne=L.split("-");if(ne.length!==3)return L;const oa=parseInt(ne[0]),Ea=parseInt(ne[1])-1,Xe=parseInt(ne[2]);if(isNaN(oa)||isNaN(Ea)||isNaN(Xe))return L;const Ja=new Date,pt=Ja.getFullYear(),ct=Ja.getMonth(),vt=Ja.getDate();if(oa===pt&&Ea===ct&&Xe===vt)return"Today";const bt=new Date(Ja);bt.setDate(bt.getDate()+1);const za=bt.getFullYear(),ua=bt.getMonth(),Ta=bt.getDate();return oa===za&&Ea===ua&&Xe===Ta?"Tomorrow":new Date(oa,Ea,Xe).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).replace(/^(\w+),/,"$1:")}at(()=>(e(E),e(Y),e(ee),e(H)),()=>{s(f,(()=>{let L=e(E);if(e(Y).trim()){const ne=e(Y).toLowerCase().trim();L=L.filter(oa=>oa.title.toLowerCase().includes(ne)||oa.description&&oa.description.toLowerCase().includes(ne))}return e(ee)!=="all"&&(L=L.filter(ne=>ne.category===e(ee))),e(H)!=="all"&&(e(H)==="completed"?L=L.filter(ne=>ne.completed):e(H)==="pending"&&(L=L.filter(ne=>!ne.completed))),L})())}),at(()=>e(B),()=>{s(p,e(B)?new Date(e(B)+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).replace(/^(\w+),/,"$1:"):"Select due date")}),at(()=>e(E),()=>{s(g,e(E).filter(L=>L.completed).length)}),at(()=>e(E),()=>{s(C,e(E).length)}),at(()=>e(f),()=>{s(k,e(f).filter(L=>L.completed).length)}),at(()=>e(f),()=>{s(N,e(f).length)}),ps(),cs();var $e=Wl();R("click",Ts,_a);var te=t($e),T=t(te),x=r(t(T),2),$=r(t(x)),Q=t($);a($),a(x),a(T),a(te);var X=r(te,2),Le=t(X),I=t(Le),ie=t(I,!0);a(I);var se=r(I);a(Le),a(X);var Ge=r(X,2);{var Ve=L=>{var ne=El(),oa=r(t(ne),2),Ea=t(oa);Xa(Ea);var Xe=r(Ea,2);Sr(Xe);var Ja=r(Xe,2),pt=t(Ja),ct=r(t(pt),2),vt=t(ct),bt=t(vt),za=t(bt),ua=t(za,!0);a(za);var Ta=r(za,2),Na=t(Ta,!0);a(Ta),a(bt);var Tt=r(bt,2);a(vt);var Za=r(vt,2);{var nt=Ka=>{var Qa=Al();xa(Qa,5,()=>ce,Jt,(gt,yt)=>{var Mt=Dl(),kt=t(Mt),xt=t(kt,!0);a(kt);var Gt=r(kt,2),Ft=t(Gt,!0);a(Gt),a(Mt),b(()=>{Z(Mt,1,`dropdown-item ${e(yt),e(Se),l(()=>e(yt).value===e(Se)?"selected":"")??""}`),o(xt,(e(yt),l(()=>e(yt).icon))),o(Ft,(e(yt),l(()=>e(yt).label)))}),R("click",Mt,()=>fa(e(yt).value)),i(gt,Mt)}),a(Qa),i(Ka,Qa)};m(Za,Ka=>{e(ve)&&Ka(nt)})}a(ct),a(pt);var Wa=r(pt,2),ft=r(t(Wa),2),ut=t(ft),_t=t(ut),qa=t(_t),W=r(t(qa),2),he=t(W,!0);a(W),a(qa);var ta=r(qa,2),Pa=t(ta);{var st=Ka=>{var Qa=Tl();R("click",Qa,xr(aa)),i(Ka,Qa)};m(Pa,Ka=>{e(B)&&Ka(st)})}var Ha=r(Pa,2);a(ta),a(_t),a(ut);var wa=r(ut,2);{var St=Ka=>{var Qa=jl(),gt=t(Qa),yt=t(gt),Mt=r(yt,2),kt=t(Mt),xt=t(kt,!0);a(kt);var Gt=r(kt,2),Ft=t(Gt,!0);a(Gt),a(Mt);var Lt=r(Mt,2);a(gt);var Ht=r(gt,2),G=t(Ht);xa(G,1,()=>re,Jt,($a,pe)=>{var ca=Nl(),Aa=t(ca,!0);a(ca),b(()=>o(Aa,e(pe))),i($a,ca)});var be=r(G,2);xa(be,1,()=>(e(me),e(Me),l(()=>Array(K(e(me),e(Me))))),Jt,($a,pe)=>{var ca=$l();i($a,ca)});var ra=r(be,2);xa(ra,1,()=>(e(me),e(Me),l(()=>Array(j(e(me),e(Me))))),Jt,($a,pe,ca)=>{const Aa=js(()=>ca+1);var ya=Cl(),pa=t(ya,!0);a(ya),b((Ia,Va)=>{Z(ya,1,`day-cell ${Ia??""} ${Va??""}`),o(pa,e(Aa))},[()=>(us(e(Aa)),l(()=>ke(e(Aa))?"today":"")),()=>(us(e(Aa)),l(()=>Pe(e(Aa))?"selected":""))]),R("click",ya,()=>la(e(Aa))),i($a,ya)}),a(Ht),a(Qa),b(()=>{o(xt,(e(Me),l(()=>Ae[e(Me)]))),o(Ft,e(me))}),R("click",yt,c),R("click",Lt,u),i(Ka,Qa)};m(wa,Ka=>{e(le)&&Ka(St)})}a(ft),a(Wa),a(Ja);var Nt=r(Ja,2),wt=t(Nt,!0);a(Nt),a(oa),a(ne),b((Ka,Qa,gt)=>{o(ua,Ka),o(Na,Qa),Z(Tt,1,`material-symbols-outlined dropdown-icon ${e(ve)?"open":""}`),o(he,e(p)),Z(Ha,1,`material-symbols-outlined dropdown-icon ${e(le)?"open":""}`),Nt.disabled=gt,o(wt,e(q)?"Adding...":"Add Task")},[()=>(e(Se),l(()=>Re(e(Se)))),()=>(e(Se),l(()=>Je(e(Se)))),()=>(e(M),e(q),l(()=>!e(M).trim()||e(q)))]),tt(Ea,()=>e(M),Ka=>s(M,Ka)),R("keydown",Ea,Ka=>Ka.key==="Enter"&&Oe()),tt(Xe,()=>e(ae),Ka=>s(ae,Ka)),R("click",vt,Ie),R("click",_t,He),R("click",Nt,Oe),i(L,ne)};m(Ge,L=>{e(ue)&&L(Ve)})}var Ze=r(Ge,2),Ye=t(Ze),ga=t(Ye),da=r(t(ga),2);Xa(da);var Oa=r(da,2);{var Ga=L=>{var ne=ql();R("click",ne,()=>s(Y,"")),i(L,ne)};m(Oa,L=>{e(Y)&&L(Ga)})}a(ga);var fe=r(ga,2),O=t(fe),F=t(O),J=t(F),_e=t(J),qe=t(_e,!0);a(_e);var ia=r(_e,2),na=t(ia,!0);a(ia),a(J);var Ra=r(J,2);let Ue;a(F);var Fe=r(F,2);{var Ma=L=>{var ne=Ll();xa(ne,5,()=>S,Jt,(oa,Ea)=>{var Xe=Fl();let Ja;var pt=t(Xe),ct=t(pt,!0);a(pt);var vt=r(pt,2),bt=t(vt,!0);a(vt),a(Xe),b(za=>{Ja=Z(Xe,1,"filter-dropdown-item",null,Ja,za),o(ct,(e(Ea),l(()=>e(Ea).icon))),o(bt,(e(Ea),l(()=>e(Ea).label)))},[()=>({active:e(Ea).value===e(ee)})]),R("click",Xe,()=>ze(e(Ea).value)),i(oa,Xe)}),a(ne),i(L,ne)};m(Fe,L=>{e(U)&&L(Ma)})}a(O);var dt=r(O,2),ha=t(dt),ka=t(ha),La=t(ka),Ya=t(La,!0);a(La);var oe=r(La,2),Sa=t(oe,!0);a(oe),a(ka);var Ba=r(ka,2);let ht;a(ha);var Et=r(ha,2);{var De=L=>{var ne=Pl();xa(ne,5,()=>y,Jt,(oa,Ea)=>{var Xe=Il();let Ja;var pt=t(Xe),ct=t(pt,!0);a(pt);var vt=r(pt,2),bt=t(vt,!0);a(vt),a(Xe),b(za=>{Ja=Z(Xe,1,"filter-dropdown-item",null,Ja,za),o(ct,(e(Ea),l(()=>e(Ea).icon))),o(bt,(e(Ea),l(()=>e(Ea).label)))},[()=>({active:e(Ea).value===e(H)})]),R("click",Xe,()=>Be(e(Ea).value)),i(oa,Xe)}),a(ne),i(L,ne)};m(Et,L=>{e(A)&&L(De)})}a(dt),a(fe),a(Ye),a(Ze);var Ee=r(Ze,2),je=t(Ee);{var Da=L=>{var ne=Gl();i(L,ne)},ma=L=>{var ne=ja(),oa=va(ne);{var Ea=Ja=>{var pt=Rl(),ct=r(t(pt),2),vt=t(ct,!0);a(ct);var bt=r(ct,2);a(pt),b(()=>o(vt,e(P))),R("click",bt,Te),i(Ja,pt)},Xe=Ja=>{var pt=ja(),ct=va(pt);{var vt=za=>{var ua=Vl();xa(ua,7,()=>e(f),Ta=>Ta.id,(Ta,Na,Tt)=>{var Za=Ol();let nt;var Wa=t(Za),ft=t(Wa);Xa(ft);var ut=r(ft,2);a(Wa);var _t=r(Wa,2),qa=t(_t);let W;var he=t(qa,!0);a(qa);var ta=r(qa,2);{var Pa=Qa=>{var gt=Ml(),yt=t(gt,!0);a(gt),b(()=>o(yt,(e(Na),l(()=>e(Na).description)))),i(Qa,gt)};m(ta,Qa=>{e(Na),l(()=>e(Na).description)&&Qa(Pa)})}var st=r(ta,2),Ha=t(st),wa=t(Ha,!0);a(Ha);var St=r(Ha,2),Nt=t(St,!0);a(St),a(st),a(_t);var wt=r(_t,2),Ka=t(wt);a(wt),a(Za),b((Qa,gt,yt)=>{nt=Z(Za,1,"todo-card",null,nt,Qa),Zt(Za,`--card-index: ${e(Tt)+1};`),ji(ft,(e(Na),l(()=>e(Na).completed))),Fa(ft,"id",`todo-${e(Na),l(()=>e(Na).id)??""}`),ft.disabled=e(D),Fa(ut,"for",`todo-${e(Na),l(()=>e(Na).id)??""}`),W=Z(qa,1,"todo-title",null,W,gt),o(he,(e(Na),l(()=>e(Na).title))),o(wa,(e(Na),l(()=>e(Na).category))),o(Nt,yt),Ka.disabled=e(D)},[()=>({completed:e(Na).completed}),()=>({completed:e(Na).completed}),()=>(e(Na),l(()=>de(e(Na).dueDate)))]),R("change",ft,()=>Ke(e(Na).id)),R("click",Ka,()=>z(e(Na))),i(Ta,Za)}),a(ua),i(za,ua)},bt=za=>{var ua=ja(),Ta=va(ua);{var Na=Za=>{var nt=Ul(),Wa=r(t(nt),6);a(nt),R("click",Wa,()=>{s(Y,""),s(ee,"all"),s(H,"all")}),i(Za,nt)},Tt=Za=>{var nt=Yl();i(Za,nt)};m(Ta,Za=>{e(E),l(()=>e(E).length>0)?Za(Na):Za(Tt,!1)},!0)}i(za,ua)};m(ct,za=>{e(f),l(()=>e(f).length>0)?za(vt):za(bt,!1)},!0)}i(Ja,pt)};m(oa,Ja=>{e(P)?Ja(Ea):Ja(Xe,!1)},!0)}i(L,ne)};m(je,L=>{e(D)?L(Da):L(ma,!1)})}a(Ee),a($e),b((L,ne,oa,Ea,Xe,Ja)=>{o(Q,`${e(g)??""}/${e(C)??""} completed`),o(ie,e(ue)?"remove":"add"),o(se,` ${e(ue)?"Cancel":"Add New Task"}`),o(qe,L),o(na,ne),Ue=Z(Ra,1,"material-symbols-outlined dropdown-arrow",null,Ue,oa),o(Ya,Ea),o(Sa,Xe),ht=Z(Ba,1,"material-symbols-outlined dropdown-arrow",null,ht,Ja)},[()=>(e(ee),l(()=>sa(e(ee)))),()=>(e(ee),l(()=>We(e(ee)))),()=>({rotated:e(U)}),()=>(e(H),l(()=>ge(e(H)))),()=>(e(H),l(()=>xe(e(H)))),()=>({rotated:e(A)})]),R("click",Le,Ne),tt(da,()=>e(Y),L=>s(Y,L)),R("click",F,Qe),R("click",ha,we),i(V,$e),Wt(),w()}function Ql(V,d){s(d,!e(d))}function Bl(V,d,_){s(d,!e(d)),_()}var Jl=n('<img alt="Profile" class="avatar-image"/>'),zl=n('<div class="avatar-placeholder"> </div>'),Kl=(V,d,_)=>{d(),_.onnavigate("profile")},Zl=async(V,d,_)=>{d(),await _.onlogout(),Os("Logged out successfully. See you next time!")},Xl=n('<div class="teacher-navbar-dropdown-menu"><button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),ed=n('<nav class="teacher-navbar" role="navigation" aria-label="Teacher navigation"><div class="teacher-navbar-container"><div class="teacher-navbar-left"><button class="teacher-navbar-icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">person_book</span> <span class="app-title"> </span></div></div> <div class="teacher-navbar-right"><button class="teacher-navbar-icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="teacher-navbar-user-profile"><div class="teacher-navbar-user-info"><span class="teacher-navbar-user-name"> </span> <span class="user-id"> </span></div> <div class="teacher-navbar-user-avatar"><!></div></button> <!></div></div></div></nav>');function ad(V,d){Yt(d,!0);let _=qt(d,"teacherName",3,"John Does"),w=qt(d,"firstName",3,"John"),v=qt(d,"gender",3,"male"),f=qt(d,"accountNumber",3,"TCH-2025-0001"),p=qt(d,"profileImage",3,null);function g(z){return z==="female"?"Ms.":"Mr."}let C=jt(()=>`${g(v())} ${w()}`),k=ba(!0),N=ba(!1);function E(){s(N,!1)}function q(z){e(N)&&!z.target.closest(".user-profile-container")&&E()}Bt(()=>{const z=localStorage.getItem("theme");return s(k,z!=="light"),D(),document.addEventListener("click",q),()=>{document.removeEventListener("click",q)}});function D(){e(k)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function P(z){return z.split(" ").map(Ne=>Ne.charAt(0)).join("").toUpperCase().slice(0,2)}var Y=ed(),ee=t(Y),H=t(ee),U=t(H);U.__click=function(...z){d.onToggleNavRail?.apply(this,z)};var A=r(U,2),M=r(t(A),2),ae=t(M);a(M),a(A),a(H);var Se=r(H,2),B=t(Se);B.__click=[Bl,k,D];var ue=t(B),S=t(ue,!0);a(ue),a(B);var y=r(B,2),ce=t(y);ce.__click=[Ql,N];var ve=t(ce),le=t(ve),Ce=t(le,!0);a(le);var me=r(le,2),Me=t(me);a(me),a(ve);var Ae=r(ve,2),re=t(Ae);{var Te=z=>{var Ne=Jl();b(()=>Fa(Ne,"src",p())),i(z,Ne)},Oe=z=>{var Ne=zl(),Qe=t(Ne,!0);a(Ne),b(we=>o(Qe,we),[()=>P(w())]),i(z,Ne)};m(re,z=>{p()?z(Te):z(Oe,!1)})}a(Ae),a(ce);var ea=r(ce,2);{var Ke=z=>{var Ne=Xl(),Qe=t(Ne);Qe.__click=[Kl,E,d];var we=r(Qe,2);we.__click=[Zl,E,d],a(Ne),i(z,Ne)};m(ea,z=>{e(N)&&z(Ke)})}a(y),a(Se),a(ee),a(Y),b(()=>{o(ae,`Welcome, ${e(C)??""}`),o(S,e(k)?"light_mode":"dark_mode"),o(Ce,_()),o(Me,`Account: ${f()??""}`)}),i(V,Y),Wt()}Ds(["click"]);var td=(V,d,_)=>d(e(_).id),sd=n('<button><div class="teacher-menu-rail-icon-container"><span class="material-symbols-outlined teacher-menu-rail-icon"> </span></div> <span class="teacher-menu-rail-label"> </span></button>'),rd=(V,d,_)=>d(e(_).id),id=n('<button><div class="teacher-menu-nav-icon-container"><span class="material-symbols-outlined teacher-menu-nav-icon"> </span></div></button>'),nd=n('<nav role="navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-rail-container"></div></nav> <nav class="teacher-menu-bottom-navigation" role="navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-nav-container"></div></nav>',1);function od(V,d){Yt(d,!0);let _=qt(d,"teacherActiveSection",15,"schedule"),w=qt(d,"teacherNavRailVisible",3,!0);const v=[{id:"schedule",label:"Schedule",icon:"schedule"},{id:"students",label:"Class Management",icon:"group"},{id:"advisory",label:"Advisory Class",icon:"supervisor_account"}];function f(q){_(q),d.onnavigate&&d.onnavigate({detail:{section:q}})}var p=nd(),g=va(p);let C;var k=t(g);xa(k,21,()=>v,q=>q.id,(q,D)=>{var P=sd();let Y;P.__click=[td,f,D];var ee=t(P),H=t(ee),U=t(H,!0);a(H),a(ee);var A=r(ee,2),M=t(A,!0);a(A),a(P),b(ae=>{Y=Z(P,1,"teacher-menu-rail-item",null,Y,ae),Fa(P,"aria-label",e(D).label),Fa(P,"aria-current",e(D).id===_()?"page":void 0),o(U,e(D).icon),o(M,e(D).label)},[()=>({active:e(D).id===_()})]),i(q,P)}),a(k),a(g);var N=r(g,2),E=t(N);xa(E,21,()=>v,q=>q.id,(q,D)=>{var P=id();let Y;P.__click=[rd,f,D];var ee=t(P),H=t(ee),U=t(H,!0);a(H),a(ee),a(P),b(A=>{Y=Z(P,1,"teacher-menu-nav-item",null,Y,A),Fa(P,"aria-label",e(D).label),Fa(P,"aria-current",e(D).id===_()?"page":void 0),o(U,e(D).icon)},[()=>({active:e(D).id===_()})]),i(q,P)}),a(E),a(N),b(q=>C=Z(g,1,"teacher-menu-navigation-rail",null,C,q),[()=>({collapsed:!w()})]),i(V,p),Wt()}Ds(["click"]);const Mr="teacherProfileCache",ld=300*1e3;function dd(){const{subscribe:V,set:d,update:_}=Gs({teacherData:null,teacherProfileData:null,teacherSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),w={subscribe:V,init:v=>{const f=cd(v);return f?(_(p=>({...p,teacherData:f.teacherData,teacherProfileData:f.teacherProfileData,teacherSections:f.teacherSections,lastUpdated:f.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(v,f=!1)=>{_(p=>({...p,isLoading:v&&!p.isInitialized&&!f,isRefreshing:v&&f,error:v?null:p.error}))},setError:v=>{_(f=>({...f,isLoading:!1,isRefreshing:!1,error:v}))},updateProfileData:(v,f,p,g)=>{const C=Date.now();_(k=>({...k,teacherData:v,teacherProfileData:f,teacherSections:p,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:C,isInitialized:!0})),vd(v,f,p,g,C)},loadProfile:async(v,f=!1)=>{try{_(N=>({...N,isLoading:!f&&!N.isInitialized,isRefreshing:f,error:null}));const p=await lt.get("/api/accounts?type=teacher&limit=1000");if(!p.success)throw new Error(p.message||"Failed to fetch teacher data");const g=p.accounts.find(N=>N.id===v||N.number===v);if(!g)throw new Error("Teacher data not found");let C=null;try{const N=await lt.get(`/api/teacher-profile?teacherId=${v}`);N.success&&(C=N.data)}catch(N){console.warn("Failed to fetch teacher profile data:",N)}let k=[];try{const q=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",D=await fetch(`/api/teacher-sections?teacherId=${v}&schoolYear=${q}`);if(D.ok){const P=await D.json();P.success&&(k=P.data.classData||[])}}catch(N){console.warn("Failed to fetch teacher sections:",N)}w.updateProfileData(g,C,k,v)}catch(p){console.error("Error loading teacher profile:",p),_(g=>({...g,isLoading:!1,isRefreshing:!1,error:p.message}))}},clearCache:v=>{try{const f=`${Mr}_${v}`;localStorage.removeItem(f)}catch(f){console.warn("Failed to clear teacher profile cache:",f)}},forceRefresh:async v=>{w.clearCache(v),_(f=>({...f,isInitialized:!1,teacherData:null,teacherProfileData:null,teacherSections:[]})),await w.loadProfile(v,!1)}};return w}function cd(V){try{const d=`${Mr}_${V}`,_=localStorage.getItem(d);if(!_)return null;const w=JSON.parse(_);return Date.now()-w.timestamp>ld?(localStorage.removeItem(d),null):{teacherData:w.teacherData,teacherProfileData:w.teacherProfileData,teacherSections:w.teacherSections,lastUpdated:w.timestamp}}catch(d){return console.warn("Failed to get cached teacher profile data:",d),null}}function vd(V,d,_,w,v){try{const f=`${Mr}_${w}`,p={teacherData:V,teacherProfileData:d,teacherSections:_,timestamp:v};localStorage.setItem(f,JSON.stringify(p))}catch(f){console.warn("Failed to cache teacher profile data:",f)}}const Us=dd();function ud(V,d){s(d,!e(d))}function md(V,d){s(d,!e(d))}function pd(V,d){s(d,!e(d))}function fd(V,d){is.confirm("Change Password",`
			<div class="teacher-profile-password-form">
				<div class="teacher-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,d,()=>{},{size:"medium"})}var _d=n('<div class="teacher-error-container"><div class="teacher-error-icon"><span class="material-symbols-outlined">error</span></div> <p class="teacher-error-message"> </p> <button class="teacher-retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),gd=n('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teacher information...</p></div>'),hd=n('<div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Teacher ID</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">person</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Full Name</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">work</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Position</div> <div class="teacher-info-value"> </div></div></div></div> <div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">email</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Email</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Total Subjects</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">domain</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Department</div> <div class="teacher-info-value"> </div></div></div></div>',1),bd=n('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching sections...</p></div>'),yd=n('<div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">groups</span></div> <div class="teacher-info-content"><div class="teacher-info-label"> </div> <div class="teacher-info-value"> </div></div></div>'),wd=n('<div class="teacher-info-row teacher-row-three"></div>'),Sd=n('<div class="teacher-sections-empty"><span class="material-symbols-outlined">groups</span> <p>No teaching sections assigned yet</p></div>'),xd=n('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching assignments...</p></div>'),kd=n('<div class="teacher-subject-card"><div class="teacher-subject-icon-column"><div class="teacher-subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="teacher-subject-details-column"><h3 class="teacher-subject-name"> </h3> <p class="teacher-subject-classes"><!></p></div></div>'),Dd=n('<div class="teacher-subjects-grid"></div>'),Ad=n('<div class="teacher-subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects assigned yet</p></div>'),Td=n('<div class="teacher-profile-header"><div class="teacher-header-content"><h1 class="teacher-page-title">Teacher Profile</h1> <p class="teacher-page-subtitle">Personal Information & Teaching Details</p></div> <div class="teacher-header-actions"><button class="teacher-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="teacher-profile-info-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teacher Information</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teacher information"><h2 class="teacher-section-title">Teacher Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-sections-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Sections</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching sections"><h2 class="teacher-section-title">Teaching Sections</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-subjects-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Assignments</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching assignments"><h2 class="teacher-section-title">Teaching Assignments</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-security-section"><h2 class="teacher-section-title teacher-section-title-desktop">Account Security</h2> <div class="teacher-section-content"><div class="teacher-info-row teacher-row-one"><div class="teacher-info-card teacher-security-card"><div class="teacher-info-content-container"><div class="teacher-info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Password</div> <div class="teacher-info-value">Change your account password for security</div></div></div> <div class="teacher-security-actions"><button class="teacher-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),Nd=n('<div class="teacher-profile-container"><!></div>');function $d(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(Us,"$teacherProfileStore",_),f=()=>ns(ls,"$authStore",_);let p=ba(void 0),g=jt(()=>v().teacherData),C=jt(()=>v().teacherProfileData),k=jt(()=>v().teacherSections),N=jt(()=>v().isLoading),E=jt(()=>v().error);Is(()=>ls.subscribe(y=>{s(p,y,!0)})),Bt(async()=>{if(!e(p)?.userData?.id){console.error("User not authenticated");return}const S=e(p).userData.id,y=Us.init(S);await Us.loadProfile(S,y);const ce=setInterval(async()=>{await Us.loadProfile(S,!0)},300*1e3);return()=>{clearInterval(ce)}});async function q(){const S=f();if(!S.isAuthenticated||!S.userData?.id){console.error("User not authenticated");return}const y=S.userData.id;await Us.forceRefresh(y)}Is(()=>{if(e(p)?.userData?.id){const S=e(p).userData.id;Us.init(S)||Us.loadProfile(S,!1)}});let D=jt(()=>({id:e(g)?.number||e(p)?.userData?.accountNumber||"N/A",name:e(g)?.name||e(p)?.userData?.name||"Teacher Name",firstName:e(g)?.firstName||e(p)?.userData?.firstName||"",lastName:e(g)?.lastName||"",middleInitial:e(g)?.middleInitial||"",department:e(g)?.department||"Not assigned",position:e(g)?.position||"Teacher",email:e(g)?.email||"Not available",phone:e(g)?.contactNumber||"Not available",address:e(g)?.address||"Not available",birthDate:e(g)?.birthdate?new Date(e(g).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(g)?.age||"Not available",gender:e(g)?.gender||e(p)?.userData?.gender||"male",employmentInfo:{hireDate:e(g)?.hireDate?new Date(e(g).hireDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",yearsOfService:e(g)?.yearsOfService||"Not available",employeeId:e(g)?.employeeId||"Not available"},subjects:e(C)?.subjects||[],classes:e(C)?.classes||[],sections:e(C)?.sections||[]})),P=jt(()=>e(D).subjects.length||"Not available"),Y=ba(!0),ee=ba(!0),H=ba(!0),U=ba(!1);function A(S){const y=document.getElementById(S),ve=y.nextElementSibling.querySelector(".password-eye-icon");y.type==="password"?(y.type="text",ve.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(y.type="password",ve.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=A);async function M(){const S=document.getElementById("current-password"),y=document.getElementById("new-password"),ce=document.getElementById("confirm-password");if(!S||!y||!ce){Xt("Password form inputs not found");return}const ve=S.value,le=y.value,Ce=ce.value;if(!ve){Xt("Current password is required");return}if(!le){Xt("New password is required");return}if(le!==Ce){Xt("New passwords do not match");return}if(le.length<8){Xt("Password must be at least 8 characters long");return}if(ve===le){Xt("New password must be different from current password");return}try{s(U,!0);const me=await lt.post("/api/change-password",{currentPassword:ve,newPassword:le});me.success?(S.value="",y.value="",ce.value="",Os("Password changed successfully!"),is.close()):Xt(me.error||"Failed to change password")}catch(me){Xt(me.message||"Failed to change password")}finally{s(U,!1)}}var ae=Nd(),Se=t(ae);{var B=S=>{var y=_d(),ce=r(t(y),2),ve=t(ce);a(ce);var le=r(ce,2);le.__click=q,a(y),b(()=>o(ve,`Failed to load profile data: ${e(E)??""}`)),i(S,y)},ue=S=>{var y=Td(),ce=va(y),ve=r(t(ce),2),le=t(ve);le.__click=q,a(ve),a(ce);var Ce=r(ce,2),me=r(t(Ce),2);me.__click=[ud,Y];var Me=r(t(me),2);let Ae;a(me);var re=r(me,2);let Te;var Oe=t(re);{var ea=de=>{var $e=gd();i(de,$e)},Ke=de=>{var $e=hd(),te=va($e),T=t(te),x=r(t(T),2),$=r(t(x),2),Q=t($,!0);a($),a(x),a(T);var X=r(T,2),Le=r(t(X),2),I=r(t(Le),2),ie=t(I,!0);a(I),a(Le),a(X);var se=r(X,2),Ge=r(t(se),2),Ve=r(t(Ge),2),Ze=t(Ve,!0);a(Ve),a(Ge),a(se),a(te);var Ye=r(te,2),ga=t(Ye),da=r(t(ga),2),Oa=r(t(da),2),Ga=t(Oa,!0);a(Oa),a(da),a(ga);var fe=r(ga,2),O=r(t(fe),2),F=r(t(O),2),J=t(F,!0);a(F),a(O),a(fe);var _e=r(fe,2),qe=r(t(_e),2),ia=r(t(qe),2),na=t(ia,!0);a(ia),a(qe),a(_e),a(Ye),b(()=>{o(Q,e(D).id),o(ie,e(D).name),o(Ze,e(D).position),o(Ga,e(D).email||"Not provided"),o(J,e(P)),o(na,e(D).department)}),i(de,$e)};m(Oe,de=>{e(N)?de(ea):de(Ke,!1)})}a(re),a(Ce);var z=r(Ce,2),Ne=r(t(z),2);Ne.__click=[md,ee];var Qe=r(t(Ne),2);let we;a(Ne);var ze=r(Ne,2);let Be;var We=t(ze);{var sa=de=>{var $e=bd();i(de,$e)},xe=de=>{var $e=ja(),te=va($e);{var T=$=>{var Q=wd();xa(Q,21,()=>e(k),Jt,(X,Le)=>{var I=ja(),ie=va(I);xa(ie,17,()=>e(Le).sections,Jt,(se,Ge)=>{var Ve=yd(),Ze=r(t(Ve),2),Ye=t(Ze),ga=t(Ye,!0);a(Ye);var da=r(Ye,2),Oa=t(da);a(da),a(Ze),a(Ve),b(()=>{o(ga,e(Ge).name),o(Oa,`${e(Le).gradeName??""} â¢ ${e(Ge).students??""} students`)}),i(se,Ve)}),i(X,I)}),a(Q),i($,Q)},x=$=>{var Q=Sd();i($,Q)};m(te,$=>{e(k).length>0?$(T):$(x,!1)},!0)}i(de,$e)};m(We,de=>{e(N)?de(sa):de(xe,!1)})}a(ze),a(z);var ge=r(z,2),Ie=r(t(ge),2);Ie.__click=[pd,H];var fa=r(t(Ie),2);let _a;a(Ie);var Je=r(Ie,2);let Re;var He=t(Je);{var la=de=>{var $e=xd();i(de,$e)},aa=de=>{var $e=ja(),te=va($e);{var T=$=>{var Q=Dd();xa(Q,21,()=>e(D).subjects,X=>X.id,(X,Le)=>{var I=kd(),ie=t(I),se=t(ie);a(ie);var Ge=r(ie,2),Ve=t(Ge),Ze=t(Ve,!0);a(Ve);var Ye=r(Ve,2),ga=t(Ye);{var da=Ga=>{var fe=$t();b(()=>o(fe,`${e(Le).section_count??""} ${e(Le).section_count===1?"section":"sections"}`)),i(Ga,fe)},Oa=Ga=>{var fe=$t("No sections assigned");i(Ga,fe)};m(ga,Ga=>{e(Le).section_count?Ga(da):Ga(Oa,!1)})}a(Ye),a(Ge),a(I),b(()=>{Zt(I,`border-color: ${e(Le).color??""};`),Zt(se,`background-color: ${e(Le).color??""}20; color: ${e(Le).color??""}`),o(Ze,e(Le).name)}),i(X,I)}),a(Q),i($,Q)},x=$=>{var Q=Ad();i($,Q)};m(te,$=>{e(D).subjects.length>0?$(T):$(x,!1)},!0)}i(de,$e)};m(He,de=>{e(N)?de(la):de(aa,!1)})}a(Je),a(ge);var c=r(ge,2),u=r(t(c),2),j=t(u),K=t(j),ke=r(t(K),2),Pe=t(ke);Pe.__click=[fd,M],a(ke),a(K),a(j),a(u),a(c),b((de,$e,te,T,x,$)=>{le.disabled=e(N),Ae=Z(Me,1,"material-symbols-outlined teacher-collapse-icon",null,Ae,de),Te=Z(re,1,"teacher-section-content",null,Te,$e),we=Z(Qe,1,"material-symbols-outlined teacher-collapse-icon",null,we,te),Be=Z(ze,1,"teacher-section-content",null,Be,T),_a=Z(fa,1,"material-symbols-outlined teacher-collapse-icon",null,_a,x),Re=Z(Je,1,"teacher-section-content",null,Re,$)},[()=>({rotated:e(Y)}),()=>({collapsed:e(Y)}),()=>({rotated:e(ee)}),()=>({collapsed:e(ee)}),()=>({rotated:e(H)}),()=>({collapsed:e(H)})]),i(S,y)};m(Se,S=>{e(E)?S(B):S(ue,!1)})}a(ae),i(V,ae),Wt(),w()}Ds(["click"]);const Dr="teacherScheduleCache",Cd=300*1e3;function jd(){const{subscribe:V,set:d,update:_}=Gs({scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),w={subscribe:V,init:(v,f)=>{const p=Ed(v,f);return p?(_(g=>({...g,scheduleData:p.scheduleData,lastUpdated:p.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(v,f=!1)=>{_(p=>({...p,isLoading:v&&!p.isInitialized&&!f,isRefreshing:v&&f,error:v?null:p.error}))},updateScheduleData:(v,f,p,g=!1)=>{const C=Date.now();_(k=>({...k,scheduleData:v,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:C,isInitialized:!0})),ii(v,f,p,C)},setError:(v,f=!1)=>{_(p=>({...p,error:v,isLoading:!1,isRefreshing:!1}))},loadSchedule:async(v,f,p=!1)=>{try{_(E=>({...E,isLoading:!p&&!E.isInitialized,isRefreshing:p,error:null}));let g=f;g||(g=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026");const k=await(await fetch(`/api/schedules?action=teacher-schedules&teacherId=${v}&schoolYear=${g}`)).json();if(!k.success)throw new Error(k.error||"Failed to fetch schedule data");const N=qd(k.data);_(E=>({...E,scheduleData:N,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),isInitialized:!0})),ii(N,v,g,Date.now())}catch(g){console.error("Error loading teacher schedule:",g),_(C=>({...C,error:g.message,isLoading:!1,isRefreshing:!1}))}},clearCache:(v,f)=>{try{const p=`${Dr}_${v}_${f}`;localStorage.removeItem(p)}catch(p){console.warn("Failed to clear teacher schedule cache:",p)}},forceRefresh:async(v,f)=>{try{const p=`${Dr}_${v}_${f}`;localStorage.removeItem(p)}catch(p){console.warn("Failed to clear cache during force refresh:",p)}_(p=>({...p,isInitialized:!1,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}})),await w.loadSchedule(v,f,!1)}};return w}function Ed(V,d){try{const _=`${Dr}_${V}_${d}`,w=localStorage.getItem(_);if(!w)return null;const v=JSON.parse(w);return Date.now()-v.timestamp>Cd?(localStorage.removeItem(_),null):{scheduleData:v.scheduleData,lastUpdated:v.timestamp}}catch(_){return console.warn("Failed to retrieve cached teacher schedule:",_),null}}function ii(V,d,_,w){try{const v=`${Dr}_${d}_${_}`,f={scheduleData:V,timestamp:w,teacherId:d,schoolYear:_};localStorage.setItem(v,JSON.stringify(f))}catch(v){console.warn("Failed to cache teacher schedule data:",v)}}function qd(V){const d={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},_={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},w=["blue","green","purple","yellow","orange"];function v(p){return w[p%w.length]}const f={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return V.forEach(p=>{const g=_[p.day_of_week.toLowerCase()];if(g){const C=ni(p.start_time),k=ni(p.end_time);let N,E;p.schedule_type==="subject"?(N=p.section_name,E=p.subject_name||"Unknown Subject"):p.schedule_type==="activity"&&(N=p.activity_type_name||"Activity",E=p.activity_type_name||"Activity");const q={name:N,time:`${C} - ${k}`,room:p.room_name||"TBA",subject:E,gradeLevel:p.grade_level,scheduleType:p.schedule_type,color:v(f[g])};d[g].push(q),f[g]++}}),Object.keys(d).forEach(p=>{const g=d[p],C=Fd(g),k=[...g,...C].sort((N,E)=>{const q=er(N.time.split(" - ")[0]),D=er(E.time.split(" - ")[0]);return q-D});d[p]=k}),d}function ni(V){const[d,_]=V.split(":"),w=parseInt(d),v=w>=12?"PM":"AM";return`${(w===0?12:w>12?w-12:w).toString().padStart(2,"0")}:${_} ${v}`}function er(V){const[d,_]=V.split(" "),[w,v]=d.split(":").map(Number);let f=v;return _==="PM"&&w!==12?f+=(w+12)*60:_==="AM"&&w===12?f+=0:f+=w*60,f}function oi(V){const d=Math.floor(V/60),_=V%60,w=d>=12?"PM":"AM";return`${(d===0?12:d>12?d-12:d).toString().padStart(2,"0")}:${_.toString().padStart(2,"0")} ${w}`}function Fd(V){if(V.length<=1)return[];const d=[...V].sort((w,v)=>{const f=er(w.time.split(" - ")[0]),p=er(v.time.split(" - ")[0]);return f-p}),_=[];for(let w=0;w<d.length-1;w++){const v=d[w],f=d[w+1],p=er(v.time.split(" - ")[1]),g=er(f.time.split(" - ")[0]);if(g>p){const C=oi(p),k=oi(g);_.push({name:"Vacant Time",time:`${C} - ${k}`,room:"Available",subject:"Free Period",color:"gray",isVacant:!0})}}return _}const dr=jd();var Ld=n('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),Id=n("<button> </button>"),Pd=n('<div class="teacher-dropdown-menu"></div>'),Gd=n('<div class="silent-refresh-indicator"><div class="silent-loader"></div> <span>Updating...</span></div>'),Rd=n('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),Md=n('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Od=n('<div class="schedule-class-location"><span class="material-symbols-outlined">schedule</span> <span>Available Time</span></div>'),Vd=n('<div class="schedule-class-teacher"><span class="material-symbols-outlined">book</span> <span> </span></div>'),Ud=n('<div class="schedule-class-grade"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Yd=n('<div class="schedule-class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <!>',1),Wd=n('<div><div class="class-header"><h3 class="schedule-class-name"> </h3> <span class="schedule-class-time"> </span></div> <div class="class-details"><!></div></div>'),Hd=n('<div class="schedule-classes-grid"></div>'),Qd=n('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),Bd=n('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-schedule-header"><h1 class="schedule-page-title">Teaching Schedule</h1> <p class="schedule-page-subtitle">Your weekly teaching schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="schedule-day-selector"></div> <div class="teacher-mobile-dropdown"><button class="teacher-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><!> <button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function Jd(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(dr,"$teacherScheduleStore",_),f=()=>ns(ls,"$authStore",_),p=h(),g=h(),C=h(),k=h(),N=h(),E=h(),q=h(),D=new Date,P=["January","February","March","April","May","June","July","August","September","October","November","December"],Y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ee=P[D.getMonth()],H=D.getDate(),U=Y[D.getDay()],A={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},M=D.getDay();let ae=h(A[M]||"Mon");Bt(async()=>{const Re=f();if(!Re.isAuthenticated||!Re.userData?.id){console.error("User not authenticated");return}const He=Re.userData.id,la=dr.init(He,null);await dr.loadSchedule(He,null,la);const aa=setInterval(async()=>{await dr.loadSchedule(He,null,!0)},300*1e3);return()=>{clearInterval(aa)}});async function Se(){const Re=f();if(!Re.isAuthenticated||!Re.userData?.id){console.error("User not authenticated");return}const He=Re.userData.id;await dr.forceRefresh(He,null)}const B={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"},ue=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}];let S=h(!1);function y(Re){Re.target.closest(".teacher-mobile-dropdown")||s(S,!1)}function ce(){s(S,!e(S))}function ve(Re){s(ae,Re),s(S,!1)}at(()=>(e(p),e(g),e(C),e(k),e(N),v()),()=>{(Re=>{s(p,Re.scheduleData),s(g,Re.isLoading),s(C,Re.isRefreshing),s(k,Re.error),s(N,Re.lastUpdated)})(v())}),at(()=>(e(p),e(ae)),()=>{s(E,e(p)[e(ae)]||[])}),at(()=>e(ae),()=>{s(q,B[e(ae)]||"Monday")}),ps(),cs();var le=Bd(),Ce=r(t(le),2),me=t(Ce),Me=t(me),Ae=t(Me);a(Me),a(me);var re=r(me,2);xa(re,5,()=>ue,Jt,(Re,He)=>{let la=()=>e(He).day;var aa=Ld(),c=t(aa),u=t(c,!0);a(c);var j=r(c,2),K=t(j,!0);a(j),a(aa),b(()=>{Z(aa,1,`schedule-day-btn ${la()===e(ae)?"active":""}`),o(u,la()),o(K,(la(),l(()=>B[la()])))}),R("click",aa,()=>ve(la())),i(Re,aa)}),a(re);var Te=r(re,2),Oe=t(Te),ea=t(Oe),Ke=t(ea,!0);a(ea);var z=r(ea,2);a(Oe);var Ne=r(Oe,2);{var Qe=Re=>{var He=Pd();xa(He,5,()=>ue,Jt,(la,aa)=>{let c=()=>e(aa).day;var u=Id(),j=t(u,!0);a(u),b(()=>{Z(u,1,`teacher-dropdown-item ${c()===e(ae)?"selected":""}`),o(j,(c(),l(()=>B[c()])))}),R("click",u,()=>ve(c())),i(la,u)}),a(He),i(Re,He)};m(Ne,Re=>{e(S)&&Re(Qe)})}a(Te),a(Ce);var we=r(Ce,2),ze=t(we),Be=t(ze),We=t(Be);a(Be);var sa=r(Be,2),xe=t(sa);{var ge=Re=>{var He=Gd();i(Re,He)};m(xe,Re=>{e(C)&&Re(ge)})}var Ie=r(xe,2);a(sa),a(ze);var fa=r(ze,2);{var _a=Re=>{var He=Rd();i(Re,He)},Je=Re=>{var He=ja(),la=va(He);{var aa=u=>{var j=Md(),K=r(t(j),4),ke=t(K,!0);a(K);var Pe=r(K,2);a(j),b(()=>o(ke,e(k))),R("click",Pe,Se),i(u,j)},c=u=>{var j=ja(),K=va(j);{var ke=de=>{var $e=Hd();xa($e,5,()=>e(E),Jt,(te,T)=>{var x=Wd(),$=t(x),Q=t($),X=t(Q,!0);a(Q);var Le=r(Q,2),I=t(Le,!0);a(Le),a($);var ie=r($,2),se=t(ie);{var Ge=Ze=>{var Ye=Od();i(Ze,Ye)},Ve=Ze=>{var Ye=Yd(),ga=va(Ye),da=r(t(ga),2),Oa=t(da,!0);a(da),a(ga);var Ga=r(ga,2);{var fe=J=>{var _e=Vd(),qe=r(t(_e),2),ia=t(qe,!0);a(qe),a(_e),b(()=>o(ia,(e(T),l(()=>e(T).subject)))),i(J,_e)};m(Ga,J=>{e(T),l(()=>e(T).subject)&&J(fe)})}var O=r(Ga,2);{var F=J=>{var _e=Ud(),qe=r(t(_e),2),ia=t(qe);a(qe),a(_e),b(()=>o(ia,`Grade ${e(T),l(()=>e(T).gradeLevel)??""}`)),i(J,_e)};m(O,J=>{e(T),l(()=>e(T).gradeLevel&&e(T).scheduleType==="subject")&&J(F)})}b(()=>o(Oa,(e(T),l(()=>e(T).room)))),i(Ze,Ye)};m(se,Ze=>{e(T),l(()=>e(T).scheduleType==="vacant")?Ze(Ge):Ze(Ve,!1)})}a(ie),a(x),b(()=>{Z(x,1,`schedule-class-card ${e(T),l(()=>e(T).color)??""}`),o(X,(e(T),l(()=>e(T).name))),o(I,(e(T),l(()=>e(T).time)))}),i(te,x)}),a($e),i(de,$e)},Pe=de=>{var $e=Qd(),te=r(t($e),4),T=t(te);a(te),a($e),b(()=>o(T,`You don't have any classes scheduled for ${e(q)??""}. Enjoy your free day!`)),i(de,$e)};m(K,de=>{e(E),l(()=>e(E).length>0)?de(ke):de(Pe,!1)},!0)}i(u,j)};m(la,u=>{e(k)?u(aa):u(c,!1)},!0)}i(Re,He)};m(fa,Re=>{e(g)?Re(_a):Re(Je,!1)})}a(we),a(le),b(()=>{o(Ae,`${U??""}, ${ee??""} ${H??""}`),o(Ke,(e(ae),l(()=>B[e(ae)]||"Select Day"))),Z(z,1,`material-symbols-outlined teacher-dropdown-icon ${e(S)?"open":""}`),o(We,`${e(q)??""} Classes`),Ie.disabled=e(g)}),R("click",Oe,ce),R("click",Ie,Se),R("click",le,y),R("keydown",le,y),i(V,le),Wt(),w()}var zd=n('<div class="odometer-container svelte-1ve39fg"><!></div>');function fi(V,d){Yt(d,!1);let _=qt(d,"value",8,0),w=qt(d,"format",8,"d"),v=qt(d,"theme",8,"default"),f=qt(d,"duration",8,2e3),p=qt(d,"auto",8,!0);qt(d,"selector",8,null);let g=qt(d,"useCommaDecimal",8,!1),C=qt(d,"animation",8,"ease"),k=h(),N=h();Bt(async()=>{try{const D=(await si(async()=>{const{default:P}=await import("../chunks/7634Yfgp.js").then(Y=>Y.o);return{default:P}},[],import.meta.url)).default;await si(()=>Promise.resolve({}),__vite__mapDeps([0]),import.meta.url),s(N,new D({el:e(k),format:w(),theme:v(),duration:f(),auto:p(),animation:C(),value:0})),g()&&new MutationObserver(()=>{const Y=e(k).textContent;Y&&Y.includes(".")&&gs(k,e(k).textContent=Y.replace(".",","))}).observe(e(k),{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>{e(N)&&e(N).update(_())},100)}catch(D){console.error("Failed to load odometer:",D)}}),at(()=>(e(N),us(_())),()=>{e(N)&&vi&&e(N).update(_())}),ps(),cs();var E=zd(),q=t(E);m(q,D=>{}),a(E),ur(E,D=>s(k,D),()=>e(k)),i(V,E),Wt()}var Kd=n('<div class="class-mgmt-stat-card"><div class="class-mgmt-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="class-mgmt-stat-value"><!></div> <div class="class-mgmt-stat-label"> </div></div></div>'),Zd=n('<div class="loading-container"><div class="system-loader"></div> <p>Loading your teaching assignments...</p></div>'),Xd=n('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),ec=n(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Teaching Assignments</h3> <p>You don't have any sections assigned for this school year.</p></div>`),ac=(V,d,_,w)=>d(e(_).yearLevel,e(w).name,e(w).id),tc=n('<span class="more-subjects"> </span>'),sc=n('<div class="section-subjects"> <!></div>'),rc=n('<button class="section-card"><div class="section-name"> </div> <!></button>'),ic=n('<div class="year-level-container"><div class="year-level-header"><div class="year-level-info"><div class="year-level-icon"><span class="material-symbols-outlined">school</span></div> <div class="year-level-details"><h3 class="year-level-title"> </h3> <p class="year-level-summary"> </p></div></div></div> <div class="sections-grid"></div></div>'),nc=n('<div class="year-levels-grid"></div>'),oc=n('<div class="class-management-container"><div class="class-mgmt-page-header"><div class="header-content"><h1 class="class-mgmt-page-title">Class Management</h1> <p class="class-mgmt-page-subtitle">Overview of your teaching assignments and student distribution</p></div></div> <div class="class-mgmt-stats-section"><div class="class-mgmt-stats-grid"></div></div> <div class="classes-section-container"><h2 class="class-mgmt-section-title">Year Levels & Sections</h2> <!></div></div>');function li(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=ba(As({name:"Loading...",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0})),p=ba(As([])),g=ba(!0),C=ba(null);function k(A,M,ae){d.onNavigateToClassList&&d.onNavigateToClassList({detail:{yearLevel:A,sectionName:M,sectionId:ae}})}let N=[{id:"year-levels",label:"Year Levels",getValue:()=>e(f).yearLevels.length,icon:"school",color:"var(--school-primary)"},{id:"sections",label:"Total Sections",getValue:()=>e(f).totalSections,icon:"class",color:"var(--school-secondary)"},{id:"students",label:"Total Students",getValue:()=>e(f).totalStudents,icon:"people",color:"var(--success)"},{id:"average",label:"Average Per Section",getValue:()=>e(f).averagePerSection,icon:"analytics",color:"var(--school-accent)"}];async function E(){try{s(g,!0),s(C,null);const A=v();if(!A.isAuthenticated||!A.userData?.id)throw new Error("User not authenticated");const M=A.userData.id,B=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",S=await(await fetch(`/api/teacher-sections?teacherId=${M}&schoolYear=${B}`)).json();if(!S.success)throw new Error(S.error||"Failed to fetch teacher sections");s(p,S.data.classData,!0),s(f,{name:A.userData.name||"Teacher",yearLevels:S.data.stats.yearLevels,totalSections:S.data.stats.totalSections,totalStudents:S.data.stats.totalStudents,averagePerSection:S.data.stats.averagePerSection},!0)}catch(A){console.error("Error fetching teacher sections:",A),s(C,A.message,!0),s(p,[],!0),s(f,{name:"Teacher",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0},!0)}finally{s(g,!1)}}Bt(()=>{E()});var q=oc(),D=r(t(q),2),P=t(D);xa(P,21,()=>N,A=>A.id,(A,M)=>{var ae=Kd(),Se=t(ae),B=t(Se),ue=t(B,!0);a(B),a(Se);var S=r(Se,2),y=t(S),ce=t(y);{let Ce=jt(()=>e(M).getValue());fi(ce,{get value(){return e(Ce)},format:"d",duration:2e3,animation:"ease-out"})}a(y);var ve=r(y,2),le=t(ve,!0);a(ve),a(S),a(ae),b(()=>{Zt(Se,`background-color: ${e(M).color??""}20; color: ${e(M).color??""}`),o(ue,e(M).icon),Zt(y,`color: ${e(M).color??""}`),o(le,e(M).label)}),i(A,ae)}),a(P),a(D);var Y=r(D,2),ee=r(t(Y),2);{var H=A=>{var M=Zd();i(A,M)},U=A=>{var M=ja(),ae=va(M);{var Se=ue=>{var S=Xd(),y=r(t(S),2),ce=t(y);a(y);var ve=r(y,2);ve.__click=E,a(S),b(()=>o(ce,`Error: ${e(C)??""}`)),i(ue,S)},B=ue=>{var S=ja(),y=va(S);{var ce=le=>{var Ce=ec();i(le,Ce)},ve=le=>{var Ce=nc();xa(Ce,21,()=>e(p),me=>me.yearLevel,(me,Me)=>{var Ae=ic(),re=t(Ae),Te=t(re),Oe=r(t(Te),2),ea=t(Oe),Ke=t(ea,!0);a(ea);var z=r(ea,2),Ne=t(z);a(z),a(Oe),a(Te),a(re);var Qe=r(re,2);xa(Qe,21,()=>e(Me).sections,we=>we.name,(we,ze)=>{var Be=rc();Be.__click=[ac,k,Me,ze];var We=t(Be),sa=t(We,!0);a(We);var xe=r(We,2);{var ge=Ie=>{var fa=sc(),_a=t(fa),Je=r(_a);{var Re=He=>{var la=tc(),aa=t(la);a(la),b(()=>o(aa,`+${e(ze).subjects.length-2} more`)),i(He,la)};m(Je,He=>{e(ze).subjects.length>2&&He(Re)})}a(fa),b(He=>o(_a,`${He??""} `),[()=>e(ze).subjects.slice(0,2).join(", ")]),i(Ie,fa)};m(xe,Ie=>{e(ze).subjects&&e(ze).subjects.length>0&&Ie(ge)})}a(Be),b(()=>{Fa(Be,"aria-label",`View class list for ${e(ze).name??""}`),o(sa,e(ze).name)}),i(we,Be)}),a(Qe),a(Ae),b(we=>{o(Ke,e(Me).gradeName),o(Ne,`${e(Me).sections.length??""} section${e(Me).sections.length!==1?"s":""} â¢ ${we??""} students`)},[()=>e(Me).sections.reduce((we,ze)=>we+ze.students,0)]),i(me,Ae)}),a(Ce),i(le,Ce)};m(y,le=>{e(p).length===0?le(ce):le(ve,!1)},!0)}i(ue,S)};m(ae,ue=>{e(C)?ue(Se):ue(B,!1)},!0)}i(A,M)};m(ee,A=>{e(g)?A(H):A(U,!1)})}a(Y),a(q),i(V,q),Wt(),w()}Ds(["click"]);async function lc(V,d,_,w,v,f,p,g,C,k,N){if(!d.sectionId||!d.subjectId){ye.error("Missing section or subject information");return}s(_,!0),s(w,""),s(v,!1);try{const E=f().filter(ee=>!ee.isVerified),q=f().length-E.length;if(E.length===0){ye.warning("All student grades have already been verified by the adviser. No grades to send."),s(_,!1);return}const D=E.map(ee=>{const H=p(ee.writtenWork,g().writtenWork.totals,"writtenWork"),U=p(ee.performanceTasks,g().performanceTasks.totals,"performanceTasks"),A=p(ee.quarterlyAssessment,g().quarterlyAssessment.totals,"quarterlyAssessment"),M=C(ee);return{student_id:ee.accountNumber||ee.account_number||ee.id,written_work_average:H!==""?parseFloat(H):null,performance_tasks_average:U!==""?parseFloat(U):null,quarterly_assessment_average:A!==""?parseFloat(A):null,final_grade:M!==""?parseFloat(M):null,written_work_items:ee.writtenWork||[],performance_tasks_items:ee.performanceTasks||[],quarterly_assessment_items:ee.quarterlyAssessment||[]}}),P=await ms("/api/grades",{method:"POST",body:JSON.stringify({action:"submit_final_grades",section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:k(),teacher_id:N().userData.id,final_grades:D})});if(!P.ok){const ee=await P.json().catch(()=>({}));throw console.error("API error response:",ee),new Error(ee.error||`HTTP ${P.status}: ${P.statusText}`)}const Y=await P.json();s(v,!0),q>0?ye.success(`Final grades sent to adviser for ${E.length} students. ${q} verified students were skipped.`):ye.success("Final grades have been sent to the adviser successfully!"),setTimeout(()=>{s(w,"")},3e3)}catch(E){console.error("Error saving final grades:",E),s(v,!1),s(w,E.message||"Failed to save final grades",!0),ye.error(e(w)),setTimeout(()=>{s(w,"")},5e3)}finally{s(_,!1)}}async function dc(V,d,_,w,v,f,p,g,C,k){try{ye.info("Refreshing grades from database...");const N=d(),E=N.isAuthenticated?N.userData?.id:null,q=new URLSearchParams({sectionId:_.sectionId.toString(),subjectId:_.subjectId.toString(),gradingPeriodId:w().toString()});E&&q.append("teacherId",E.toString());const D=await ms(`/api/class-students?${q}`);if(!D.ok)throw new Error(`HTTP ${D.status}: ${D.statusText}`);const P=await D.json();if(P.success&&P.data?.students)v(P.data.students.map(Y=>({...Y,writtenWork:Y.grades?.written_work||[],performanceTasks:Y.grades?.performance_tasks||[],quarterlyAssessment:Y.grades?.quarterly_assessment||[],grades:Y.grades,id:Y.account_number||Y.id,name:Y.full_name||`${Y.first_name} ${Y.last_name}`,isVerified:Y.grades?.verification?.verified||!1}))),f(),s(p,!0),s(g,!1),s(C,k(),!0),ye.success("Grades refreshed successfully");else throw new Error(P.error||"Failed to refresh grades")}catch(N){console.error("Error refreshing grades:",N),ye.error("Failed to refresh grades. Please try again.")}}var cc=n('<span class="material-symbols-outlined spinning">sync</span> <span>Saving...</span>',1),vc=n('<span class="material-symbols-outlined">check_circle</span> <span>Grades Saved</span>',1),uc=n('<span class="material-symbols-outlined">save</span> <span>Save Grades</span>',1),mc=n('<span class="material-symbols-outlined spinning">sync</span> <span>Uploading...</span>',1),pc=n('<span class="material-symbols-outlined">upload</span> <span>Send to Adviser</span>',1),fc=n('<div class="spreadsheet-loading-overlay"><div class="spreadsheet-loader"><div class="loader-spinner"></div> <p>Loading grading spreadsheet...</p></div></div>'),_c=n('<div class="header-overlay"><span class="header-icon material-symbols-outlined">settings</span></div>'),gc=n('<th><span class="header-text"> </span> <!></th>'),hc=n('<input type="text" class="cell-input"/>'),bc=n('<span class="cell-content verified-cell"> </span>'),yc=n('<span class="cell-content"> </span>'),wc=n("<td><!></td>"),Sc=n("<tr></tr>"),xc=n('<div class="spreadsheet-container"><table class="spreadsheet-table"><thead><tr></tr></thead><tbody></tbody></table></div>'),kc=n('<div class="save-section"><div class="refresh-button-container"><button class="refresh-grades-button" title="Refresh grades from database"><span class="material-symbols-outlined">refresh</span> <span>Refresh</span></button></div> <div class="save-button-container"><button><!></button> <button class="final-grades-button" title="Upload final grades (averages and computed final grades) to database"><!></button></div></div> <div class="grading-spreadsheet"><!></div>',1);function Dc(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=qt(d,"students",23,()=>[]),p=qt(d,"gradingPeriodId",3,1),g=qt(d,"gradingConfig",23,()=>({writtenWork:{count:3,weight:.3,totals:[]},performanceTasks:{count:3,weight:.5,totals:[]},quarterlyAssessment:{count:1,weight:.2,totals:[]}})),C=ba(!1),k=ba(!1),N=ba(""),E=ba(!1),q=null,D=null,P=ba(!1),Y=ba(!0),ee=ba(null),H,U=ba(null),A=ba(!1),M=ba(""),ae=ba(!0),Se=ba(!1),B=ba(As(new Set)),ue=ba(As([]));As([]);function S(x){if(x==null||x==="")return"0";const $=parseFloat(x);return isNaN($)?x:($%1===0,$.toString())}function y(){return JSON.parse(JSON.stringify(f().map(x=>({id:x.id,writtenWork:Array.isArray(x.writtenWork)?[...x.writtenWork]:[],performanceTasks:Array.isArray(x.performanceTasks)?[...x.performanceTasks]:[],quarterlyAssessment:Array.isArray(x.quarterlyAssessment)?[...x.quarterlyAssessment]:[]}))))}function ce(){if(!e(ee))return!1;const x=y(),$=JSON.stringify(x)!==JSON.stringify(e(ee));return s(P,$),s(Y,!$),$}function ve(){const x=["Student ID","Student Name"];for(let $=1;$<=g().writtenWork.count;$++)x.push(Ne("writtenWork",$-1));x.push("WW Avg");for(let $=1;$<=g().performanceTasks.count;$++)x.push(Ne("performanceTasks",$-1));x.push("PT Avg");for(let $=1;$<=g().quarterlyAssessment.count;$++)x.push(Ne("quarterlyAssessment",$-1));x.push("QA Avg"),x.push("Final Grade"),s(ue,[x],!0),f().forEach($=>{if(!$||!$.id||!$.name){console.warn("Invalid student data:",$);return}const Q=[$.id,$.name],X=$.writtenWork||[];for(let ie=0;ie<g().writtenWork.count;ie++)Q.push(S(X[ie]));Q.push(le(X,g().writtenWork.totals,"writtenWork"));const Le=$.performanceTasks||[];for(let ie=0;ie<g().performanceTasks.count;ie++)Q.push(S(Le[ie]));Q.push(le(Le,g().performanceTasks.totals,"performanceTasks"));const I=$.quarterlyAssessment||[];for(let ie=0;ie<g().quarterlyAssessment.count;ie++)Q.push(S(I[ie]));Q.push(le(I,g().quarterlyAssessment.totals,"quarterlyAssessment")),Q.push(Ce($)),e(ue).push(Q)}),s(ee,y(),!0),s(Y,!1),s(P,!1),s(ae,!1)}function le(x,$=null,Q=null){if(!x||!Array.isArray(x))return"";const X=x.filter(I=>I!=null&&I!=="");if(X.length===0)return"";let Le=0;if($&&$.length>0){let I=0,ie=0;const se=Math.min(x.length,$.length);for(let Ve=0;Ve<se;Ve++){const Ze=x[Ve];if(Ze!=null&&Ze!==""){const Ye=parseFloat(Ze),ga=$[Ve];if(ga&&ga>0){const da=Ye/ga*100;I+=da,ie++}}}if(ie===0)return"";const Ge=Math.round(I/ie*10)/10;return S(Ge)}else{Le=X.reduce((ie,se)=>ie+parseFloat(se),0);const I=Math.round(Le/X.length*10)/10;return S(I)}}function Ce(x){if(!x)return"";const $=le(x.writtenWork,g().writtenWork.totals,"writtenWork"),Q=le(x.performanceTasks,g().performanceTasks.totals,"performanceTasks"),X=le(x.quarterlyAssessment,g().quarterlyAssessment.totals,"quarterlyAssessment");if($===""||Q===""||X==="")return"";const Le=parseFloat($)||0,I=parseFloat(Q)||0,ie=parseFloat(X)||0,se=Le*g().writtenWork.weight+I*g().performanceTasks.weight+ie*g().quarterlyAssessment.weight,Ge=Math.round(se*10)/10;return S(Ge)}function me(x,$,Q){if($<2)return;const X=x-1,Le=f()[X];if(Le&&Le.isVerified){ye.warning("This student's grades have been verified by the adviser and cannot be edited.");return}s(U,{row:x,col:$},!0),s(A,!1)}function Me(x){if(!e(U)||e(A))return;const{row:$,col:Q}=e(U);if(x.key==="ArrowUp"||x.key==="ArrowDown"||x.key==="ArrowLeft"||x.key==="ArrowRight"){x.preventDefault(),Ae(x.key);return}if(x.key==="Enter"){x.preventDefault(),Ae("ArrowDown");return}if(x.key==="Tab"){x.preventDefault(),Ae(x.shiftKey?"ArrowLeft":"ArrowRight");return}if(/^[0-9.]$/.test(x.key)&&!Te(Q)&&Q>1){const X=$-1,Le=f()[X];if(Le&&Le.isVerified){ye.warning("This student's grades have been verified by the adviser and cannot be edited.");return}x.preventDefault(),s(A,!0),s(M,x.key,!0),s(Se,!1)}else if(x.key.length===1&&!Te(Q)&&Q>1){const X=$-1,Le=f()[X];if(Le&&Le.isVerified){ye.warning("This student's grades have been verified by the adviser and cannot be edited.");return}x.preventDefault(),s(A,!0),s(M,x.key,!0),s(Se,!1)}}function Ae(x){if(!e(U)||!e(ue).length)return;const{row:$,col:Q}=e(U),X=e(ue).length-1,Le=e(ue)[0].length-1;let I=$,ie=Q;switch(x){case"ArrowUp":I=Math.max(1,$-1);break;case"ArrowDown":I=Math.min(X,$+1);break;case"ArrowLeft":ie=Math.max(0,Q-1);break;case"ArrowRight":ie=Math.min(Le,Q+1);break}s(U,{row:I,col:ie},!0),re(I,ie)}function re(x,$){if(!H)return;const Q=H.querySelector(`tbody tr:nth-child(${x}) td:nth-child(${$+1})`);Q&&Q.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}function Te(x){const Q=e(ue)[0][x];return Q?.includes("Avg")||Q==="Final Grade"}function Oe(x){return z(x)!==null}function ea(x){const Q=e(ue)[0][x];return x<2?"student-info":Q==="Final Grade"||Q?.includes("Avg")?"calculated":Q?.startsWith("WW")?"written-work":Q?.startsWith("PT")?"performance-task":Q?.startsWith("QA")?"quarterly-assessment":"default"}function Ke(x,$){$.preventDefault(),$.stopPropagation(),Oe(x)&&xe(x)}function z(x){let $=2;for(let Q=0;Q<g().writtenWork.count;Q++){if($===x)return{assessmentType:"writtenWork",columnIndex:Q};$++}$++;for(let Q=0;Q<g().performanceTasks.count;Q++){if($===x)return{assessmentType:"performanceTasks",columnIndex:Q};$++}$++;for(let Q=0;Q<g().quarterlyAssessment.count;Q++){if($===x)return{assessmentType:"quarterlyAssessment",columnIndex:Q};$++}return null}function Ne(x,$){const Q=Qe(x,$),X=g()[x].totals[$]||100;return`${Q} - ${X}`}function Qe(x,$){if(g()[x].columnNames&&g()[x].columnNames[$])return g()[x].columnNames[$];const Q=x==="writtenWork"?"WW":x==="performanceTasks"?"PT":"QA";return g()[x].columnPositions&&g()[x].columnPositions[$]!==void 0?`${Q}${g()[x].columnPositions[$]}`:`${Q}${$+1}`}function we(){if(!e(U)||e(U).row===0)return;const{row:x,col:$}=e(U),Q=x-1,X=f()[Q];if(!X)return;const Le=z($);if(!Le)return;const{assessmentType:I,columnIndex:ie}=Le;let se=e(M).trim(),Ge=null,Ve=!0,Ze="";if(se!==""){if(Ge=parseFloat(se),isNaN(Ge)||Ge<0)Ge=0,Ve=!1,Ze=isNaN(parseFloat(se))?"Invalid input. Only numbers are allowed.":"Negative scores are not allowed.";else{const Ye=g()[I].totals?.[ie];Ye&&Ge>Ye&&(Ge=0,Ve=!1,Ze=`Score cannot exceed the total score of ${Ye}.`)}Ve?e(B).delete(`${x}-${$}`):(ye.error(Ze),e(B).add(`${x}-${$}`),setTimeout(()=>{e(B).delete(`${x}-${$}`),s(B,new Set(e(B)),!0)},3e3))}else Ge=null,e(B).delete(`${x}-${$}`);X[I][ie]=Ge,f([...f()]),ve(),ce(),We()}function ze(x,$,Q){if(e(U)&&e(A)){if(x.key==="Enter"){x.preventDefault();const X=e(U).row,Le=e(U).col;we(),s(A,!1),setTimeout(()=>{s(U,{row:X,col:Le},!0),Ae("ArrowDown")},0);return}if(x.key==="Tab"){x.preventDefault();const X=e(U).row,Le=e(U).col;we(),s(A,!1),setTimeout(()=>{s(U,{row:X,col:Le},!0),Ae(x.shiftKey?"ArrowLeft":"ArrowRight")},0);return}if(x.key==="ArrowUp"||x.key==="ArrowDown"||x.key==="ArrowLeft"||x.key==="ArrowRight"){x.preventDefault();const X=e(U).row,Le=e(U).col;we(),s(A,!1),setTimeout(()=>{s(U,{row:X,col:Le},!0),Ae(x.key)},0);return}if(x.key==="Escape"){x.preventDefault(),s(A,!1),s(M,"");return}}}Bt(()=>{ve()});async function Be(){if(!(e(C)||!f().length||!d.sectionId||!d.subjectId))try{const x=f().map($=>({student_id:$.account_number||$.accountNumber||$.id,writtenWork:$.writtenWork,performanceTasks:$.performanceTasks,quarterlyAssessment:$.quarterlyAssessment}));await ms("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:p(),grading_config:g(),grades:x})})}catch(x){console.error("Auto-save failed:",x.message)}}function We(){D&&clearTimeout(D),D=setTimeout(()=>{Be()},3e3)}async function sa(){if(!d.sectionId||!d.subjectId){ye.error("Missing section or subject information");return}s(C,!0),s(N,""),s(E,!1);try{const x=f().map(X=>({student_id:X.accountNumber||X.account_number||X.id,writtenWork:X.writtenWork,performanceTasks:X.performanceTasks,quarterlyAssessment:X.quarterlyAssessment})),$=await ms("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:p(),grading_config:g(),grades:x})});if(!$.ok){const X=await $.json().catch(()=>({}));throw new Error(X.error||`HTTP ${$.status}: ${$.statusText}`)}const Q=await $.json();s(E,!0),ye.success("Grades saved successfully"),s(ee,y(),!0),s(P,!1),s(Y,!0),setTimeout(()=>{s(N,"")},3e3)}catch(x){console.error("Error saving grades:",x),s(E,!1),s(N,x.message||"Failed to save grades",!0),ye.error(e(N)),setTimeout(()=>{s(N,"")},5e3)}finally{s(C,!1)}}Is(()=>{const x=f().length,$=g(),Q=d.subjectId;l(()=>{(x>0||$||Q)&&ve()})}),Is(()=>(q=setInterval(Be,3e4),()=>{q&&clearInterval(q),D&&clearTimeout(D)}));function xe(x){const $=z(x);if(!$){ye.error("Cannot edit this column");return}const{assessmentType:Q,columnIndex:X}=$,Le=Qe(Q,X),I=g()[Q].totals[X]||100,ie=g()[Q].gradeItemIds?.[X];if(!ie){ye.error("Cannot edit column: Grade item ID not found");return}is.form("Edit Column","Edit the column name and total score for this assessment:",{label:"Column Name",type:"text",placeholder:"Enter column name",value:Le},{label:"Total Score",type:"number",placeholder:"Enter total score",value:I,min:1,max:1e3},async(se,Ge)=>{if(!se||!se.trim()){ye.error("Column name cannot be empty");return}const Ve=parseInt(Ge);if(isNaN(Ve)||Ve<1||Ve>1e3){ye.error("Total score must be between 1 and 1000");return}try{const Ze=await ms("/api/grades/grade-items",{method:"PUT",body:JSON.stringify({grade_item_id:ie,name:se.trim(),total_score:Ve})});g()[Q].columnNames||(g()[Q].columnNames=[]),g()[Q].columnNames[X]=se.trim(),g()[Q].totals[X]=Ve,g({...g()}),ve(),ye.success("Column updated successfully")}catch(Ze){console.error("Error updating column:",Ze),ye.error("Failed to update column. Please try again.")}},()=>{},async()=>{try{const se=await ms("/api/grades/grade-items",{method:"DELETE",body:JSON.stringify({grade_item_id:ie})});g()[Q].count-=1,g()[Q].columnNames&&g()[Q].columnNames.splice(X,1),g()[Q].totals&&g()[Q].totals.splice(X,1),g()[Q].columnPositions&&g()[Q].columnPositions.splice(X,1),g()[Q].gradeItemIds&&g()[Q].gradeItemIds.splice(X,1),g({...g()}),f(f().map(Ge=>{const Ve={...Ge};return Q==="writtenWork"&&Ve.writtenWork?Ve.writtenWork.splice(X,1):Q==="performanceTasks"&&Ve.performanceTasks?Ve.performanceTasks.splice(X,1):Q==="quarterlyAssessment"&&Ve.quarterlyAssessment&&Ve.quarterlyAssessment.splice(X,1),Ve})),ve(),ye.success("Column deleted successfully")}catch(se){console.error("Error deleting column:",se),ye.error("Failed to delete column. Please try again.")}},{size:"small"})}var ge=kc();R("keydown",Ts,Me);var Ie=va(ge),fa=t(Ie),_a=t(fa);_a.__click=[dc,v,d,p,f,ve,Y,P,ee,y],a(fa);var Je=r(fa,2),Re=t(Je);let He;Re.__click=sa;var la=t(Re);{var aa=x=>{var $=cc();et(2),i(x,$)},c=x=>{var $=ja(),Q=va($);{var X=I=>{var ie=vc();et(2),i(I,ie)},Le=I=>{var ie=uc();et(2),i(I,ie)};m(Q,I=>{e(Y)&&!e(P)?I(X):I(Le,!1)},!0)}i(x,$)};m(la,x=>{e(C)?x(aa):x(c,!1)})}a(Re);var u=r(Re,2);u.__click=[lc,d,k,N,E,f,le,g,Ce,p,v];var j=t(u);{var K=x=>{var $=mc();et(2),i(x,$)},ke=x=>{var $=pc();et(2),i(x,$)};m(j,x=>{e(k)?x(K):x(ke,!1)})}a(u),a(Je),a(Ie);var Pe=r(Ie,2),de=t(Pe);{var $e=x=>{var $=fc();i(x,$)},te=x=>{var $=xc(),Q=t($),X=t(Q),Le=t(X);xa(Le,21,()=>e(ue)[0]||[],Jt,(ie,se,Ge)=>{var Ve=gc();let Ze;Ve.__click=Ga=>Ke(Ge,Ga);var Ye=t(Ve),ga=t(Ye,!0);a(Ye);var da=r(Ye,2);{var Oa=Ga=>{var fe=_c();i(Ga,fe)};m(da,Ga=>{Oe(Ge)&&Ga(Oa)})}a(Ve),b((Ga,fe)=>{Ze=Z(Ve,1,"spreadsheet-header",null,Ze,Ga),Fa(Ve,"title",fe),o(ga,e(se))},[()=>({"student-info":Ge<2,calculated:Te(Ge),"final-grade":ea(Ge)==="final-grade",clickable:Oe(Ge)}),()=>Oe(Ge)?"Click to set total scores":""]),i(ie,Ve)}),a(Le),a(X);var I=r(X);xa(I,21,()=>e(ue).slice(1),Jt,(ie,se,Ge)=>{var Ve=Sc();let Ze;xa(Ve,21,()=>e(se),Jt,(Ye,ga,da)=>{var Oa=wc();let Ga;Oa.__click=J=>me(Ge+1,da);var fe=t(Oa);{var O=J=>{var _e=hc();Xa(_e),_e.__keydown=qe=>ze(qe),xi(_e),R("blur",_e,()=>{we(),s(A,!1)}),tt(_e,()=>e(M),qe=>s(M,qe)),i(J,_e)},F=J=>{var _e=ja(),qe=va(_e);{var ia=Ra=>{var Ue=bc(),Fe=t(Ue,!0);a(Ue),b(()=>o(Fe,e(ga))),i(Ra,Ue)},na=Ra=>{var Ue=yc(),Fe=t(Ue,!0);a(Ue),b(()=>o(Fe,e(ga))),i(Ra,Ue)};m(qe,Ra=>{e(A)&&e(U)?.row===Ge+1&&e(U)?.col===da&&f()[Ge]?.isVerified?Ra(ia):Ra(na,!1)},!0)}i(J,_e)};m(fe,J=>{e(A)&&e(U)?.row===Ge+1&&e(U)?.col===da&&!f()[Ge]?.isVerified?J(O):J(F,!1)})}a(Oa),b(J=>Ga=Z(Oa,1,"spreadsheet-cell",null,Ga,J),[()=>({selected:e(U)?.row===Ge+1&&e(U)?.col===da,editing:e(A)&&e(U)?.row===Ge+1&&e(U)?.col===da,"student-info":da<2,calculated:Te(da),"final-grade":ea(da)==="final-grade",editable:!Te(da)&&da>1,invalid:e(B).has(`${Ge+1}-${da}`)})]),i(Ye,Oa)}),a(Ve),b(Ye=>Ze=Z(Ve,1,"spreadsheet-row",null,Ze,Ye),[()=>({verified:f()[Ge]?.isVerified})]),i(ie,Ve)}),a(I),a(Q),a($),ur($,ie=>H=ie,()=>H),i(x,$)};m(de,x=>{e(ae)?x($e):x(te,!1)})}a(Pe),ur(Pe,x=>H=x,()=>H),b(x=>{He=Z(Re,1,"save-grades-button",null,He,x),Re.disabled=e(C)||e(Y)&&!e(P),Fa(Re,"title",e(Y)&&!e(P)?"All grades are saved":"Save all grades to database"),u.disabled=e(k)},[()=>({saved:e(Y)&&!e(P)})]),i(V,ge);var T=Wt({saveGrades:sa});return w(),T}Ds(["click","keydown"]);var Ac=(V,d)=>d.onBackToClassManagement&&d.onBackToClassManagement(),Tc=n('<button><span class="material-symbols-outlined">book</span> </button>'),Nc=n('<div class="subject-tab-navigation"></div>'),$c=(V,d)=>d("writtenWork"),Cc=(V,d)=>d("performanceTasks"),jc=(V,d)=>d("quarterlyAssessment"),Ec=n('<div class="loading-container"><div class="system-loader"></div> <p>Loading class data...</p></div>'),qc=n('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Fc=n(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Students Found</h3> <p>This section doesn't have any enrolled students yet.</p></div>`),Lc=n('<div class="class-management-container"><div class="classlist-page-header"><div class="header-content"><div class="header-navigation"><button class="back-button"><span class="material-symbols-outlined">arrow_back</span> <span>Back to Class Management</span></button></div> <h1 class="classlist-page-title">Class Grading Sheet</h1> <p class="classlist-page-subtitle"> </p></div> <!></div> <div class="grading-config-section"><h2 class="config-title">Grading Configuration</h2> <div class="config-grid"><div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div></div> <!></div></div> <!>',1);function Ic(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);let f=ba(!0),p=ba(null),g=ba(!1),C=ba(!1),k=ba(null),N=null,E=ba(1),q=ba("1st Quarter"),D=ba("2025-2026"),P=ba(0),Y=ba(null),ee=jt(()=>e(k)?.subjects?.[e(P)]||null);async function H(fe){if(!(!e(k)?.subjects||fe<0||fe>=e(k).subjects.length)){if(e(Y)&&typeof e(Y).saveGrades=="function")try{await e(Y).saveGrades()}catch{}s(P,fe,!0),s(S,{writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}},!0),setTimeout(async()=>{try{await ae(),await B()}catch(O){console.error("Error fetching data for subject:",O)}},0)}}let U=jt(()=>e(k)?{yearLevel:e(k).section.grade_level,sectionName:e(k).section.section_name,gradeName:`Grade ${e(k).section.grade_level}`,subject:e(ee)?.name||"No Subject",section:`Grade ${e(k).section.grade_level} - ${e(k).section.section_name}`,quarter:e(q),totalStudents:e(k).students?.length||0,adviser:`${e(k).section.adviser_first_name||""} ${e(k).section.adviser_last_name||""}`.trim()||"No Adviser",room:e(k).section.room_name||"No Room"}:d.selectedClass?{yearLevel:d.selectedClass.yearLevel,sectionName:d.selectedClass.sectionName,gradeName:`Grade ${d.selectedClass.yearLevel}`,subject:"Loading...",section:`Grade ${d.selectedClass.yearLevel} - ${d.selectedClass.sectionName}`,quarter:e(q),totalStudents:0}:{yearLevel:7,sectionName:"Section A",gradeName:"Grade 7",subject:"Mathematics",section:"Grade 7 - Section A",quarter:e(q),totalStudents:0}),A=ba(As([]));async function M(){try{const O=await(await fetch("/api/current-quarter")).json();O.success&&O.data?(s(E,O.data.currentQuarter,!0),s(q,O.data.quarterName,!0),s(D,O.data.currentSchoolYear||"2025-2026",!0),console.log(`Current quarter set to: ${e(q)} (Quarter ${e(E)})`),console.log(`Current school year set to: ${e(D)}`)):(s(E,1),s(q,"1st Quarter"),s(D,"2025-2026"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter and 2025-2026"))}catch(fe){console.error("Error fetching current quarter:",fe),s(E,1),s(q,"1st Quarter"),s(D,"2025-2026")}}async function ae(){if(!(!d.selectedClass||!e(ee)))try{const fe=await fetch(`/api/grades/grade-items?section_id=${d.selectedClass.sectionId}&subject_id=${e(ee).id}&grading_period_id=${e(E)}&teacher_id=${v().userData.id}`,{method:"GET",headers:{"Content-Type":"application/json","x-user-id":v().userData.id.toString(),"x-user-account-number":v().userData.accountNumber||"","x-user-name":encodeURIComponent(v().userData.name||"")}});if(!fe.ok)throw new Error(`HTTP error! status: ${fe.status}`);const F=(await fe.json()).data||{},J={writtenWork:{count:F.writtenWork?.length||0,weight:.3,label:"Written Work",totals:F.writtenWork?.map(_e=>_e.totalScore)||[],columnNames:F.writtenWork?.map(_e=>_e.name)||[],columnPositions:F.writtenWork?.map((_e,qe)=>qe+1)||[],gradeItemIds:F.writtenWork?.map(_e=>_e.id)||[]},performanceTasks:{count:F.performanceTasks?.length||0,weight:.5,label:"Performance Tasks",totals:F.performanceTasks?.map(_e=>_e.totalScore)||[],columnNames:F.performanceTasks?.map(_e=>_e.name)||[],columnPositions:F.performanceTasks?.map((_e,qe)=>qe+1)||[],gradeItemIds:F.performanceTasks?.map(_e=>_e.id)||[]},quarterlyAssessment:{count:F.quarterlyAssessment?.length||0,weight:.2,label:"Quarterly Assessment",totals:F.quarterlyAssessment?.map(_e=>_e.totalScore)||[],columnNames:F.quarterlyAssessment?.map(_e=>_e.name)||[],columnPositions:F.quarterlyAssessment?.map((_e,qe)=>qe+1)||[],gradeItemIds:F.quarterlyAssessment?.map(_e=>_e.id)||[]}};s(S,J,!0)}catch(fe){console.error("Error fetching grading configuration:",fe),Me("Failed to load grading configuration","error")}}async function Se(){if(!e(g))try{if(s(f,!0),s(p,null),!d.selectedClass?.sectionId)throw new Error("No section selected");const fe=v(),O=fe.isAuthenticated?fe.userData?.id:null,F=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString()});O&&F.append("teacherId",O.toString());const _e=await(await fetch(`/api/class-students?${F}`)).json();if(!_e.success)throw new Error(_e.error||"Failed to fetch section data");s(k,_e.data,!0)}catch(fe){console.error("Error fetching section data:",fe),s(p,fe.message,!0)}finally{s(f,!1)}}async function B(){if(!e(g))try{if(s(f,!0),s(p,null),!d.selectedClass?.sectionId)throw new Error("No section selected");if(!e(ee)?.id)return;const fe=v(),O=fe.isAuthenticated?fe.userData?.id:null,F=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString(),schoolYear:e(D)});O&&F.append("teacherId",O.toString()),e(ee)?.id&&F.append("subjectId",e(ee).id.toString()),e(E)&&F.append("gradingPeriodId",e(E).toString());const _e=await(await fetch(`/api/class-students?${F}`)).json();if(!_e.success)throw new Error(_e.error||"Failed to fetch class students");s(k,_e.data,!0),s(A,_e.data.students.map(qe=>({...qe,writtenWork:qe.grades?.written_work||[],performanceTasks:qe.grades?.performance_tasks||[],quarterlyAssessment:qe.grades?.quarterly_assessment||[],grades:qe.grades,id:qe.account_number||qe.id,name:qe.full_name||`${qe.first_name} ${qe.last_name}`,isVerified:qe.grades?.verified||qe.grades?.verification?.verified||!1})),!0)}catch(fe){console.error("Error fetching class students:",fe),s(p,fe.message,!0),s(k,null),s(A,[],!0)}finally{s(f,!1)}}async function ue(){if(!(e(g)||!d.selectedClass?.sectionId||!e(ee)?.id))try{const fe=v(),O=fe.isAuthenticated?fe.userData?.id:null,F=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString(),schoolYear:e(D),verificationOnly:"true"});O&&F.append("teacherId",O.toString()),e(ee)?.id&&F.append("subjectId",e(ee).id.toString()),e(E)&&F.append("gradingPeriodId",e(E).toString());const _e=await(await fetch(`/api/class-students?${F}`)).json();if(_e.success&&_e.data?.students){const qe=e(A).map(na=>{const Ra=_e.data.students.find(Ue=>Ue.id===na.id);return Ra?{...na,isVerified:Ra.isVerified}:na});qe.some((na,Ra)=>na.isVerified!==e(A)[Ra]?.isVerified)&&s(A,qe,!0)}}catch(fe){console.error("Error checking verification status:",fe)}}let S=ba(As({writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}})),y=ba(""),ce=ba("error"),ve=ba(!1);function le(fe){}async function Ce(fe){if(e(S)[fe].count<10&&!e(C)&&!e(g))try{if(s(C,!0),!{writtenWork:1,performanceTasks:2,quarterlyAssessment:3}[fe]){console.error("Invalid category:",fe);return}if(!v().isAuthenticated||!v().userData?.id){console.error("User not authenticated");return}const J={writtenWork:"WW",performanceTasks:"PT",quarterlyAssessment:"QA"},_e=e(S)[fe].count,qe=`${J[fe]} ${_e+1}`,ia=await fetch("/api/grades/grade-items",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":v().userData.id.toString(),"x-user-account-number":v().userData.accountNumber||"","x-user-name":encodeURIComponent(v().userData.name||"")},body:JSON.stringify({action:"create_grade_item",section_id:d.selectedClass?.sectionId||e(k)?.section?.id,subject_id:e(ee)?.id||d.selectedClass?.subjectId||e(k)?.subjects?.[0]?.id,grading_period_id:e(E),teacher_id:v().userData.id,category:fe,name:qe,total_score:100})});if(!ia.ok){const Fe=await ia.json();console.error("Failed to add grade item:",Fe.error);return}const na=await ia.json();if(e(S)[fe].count+=1,e(S)[fe].gradeItemIds||(e(S)[fe].gradeItemIds=[]),e(S)[fe].gradeItemIds.push(na.data.id),e(S)[fe].columnNames||(e(S)[fe].columnNames=[]),e(S)[fe].columnNames.push(na.data.name),!e(S)[fe].columnPositions){e(S)[fe].columnPositions=[];for(let Fe=0;Fe<e(S)[fe].count-1;Fe++)e(S)[fe].columnPositions[Fe]=Fe+1}const Ra=e(S)[fe].columnPositions||[];let Ue=1;for(;Ra.includes(Ue);)Ue++;e(S)[fe].columnPositions.push(Ue),me()}catch(O){console.error("Error adding column:",O)}finally{s(C,!1)}}function me(){s(A,e(A).map(fe=>fe&&{...fe,writtenWork:Array(e(S).writtenWork.count).fill(0).map((F,J)=>fe.writtenWork?.[J]||0),performanceTasks:Array(e(S).performanceTasks.count).fill(0).map((F,J)=>fe.performanceTasks?.[J]||0),quarterlyAssessment:Array(e(S).quarterlyAssessment.count).fill(0).map((F,J)=>fe.quarterlyAssessment?.[J]||0)}),!0)}function Me(fe,O="error"){s(ve,!1),setTimeout(()=>{s(y,fe,!0),s(ce,O,!0),s(ve,!0)},50)}Bt(async()=>{e(g)||(await M(),await Se(),await new Promise(fe=>setTimeout(fe,0)),e(k)?.subjects&&e(k).subjects.length>0?(e(P)>=e(k).subjects.length&&s(P,0),await B(),await ae()):(s(p,"No subjects found for this section"),s(f,!1)),N=setInterval(()=>{ue()},3e4))}),ki(()=>{s(g,!0),s(f,!1),N&&(clearInterval(N),N=null)});var Ae=Lc();R("click",Ts,le);var re=va(Ae),Te=t(re),Oe=t(Te),ea=t(Oe),Ke=t(ea);Ke.__click=[Ac,d],a(ea);var z=r(ea,4),Ne=t(z);a(z),a(Oe);var Qe=r(Oe,2);{var we=fe=>{var O=Nc();xa(O,21,()=>e(k).subjects,Jt,(F,J,_e)=>{var qe=Tc();let ia;qe.__click=()=>H(_e);var na=r(t(qe));a(qe),b(Ra=>{ia=Z(qe,1,"subject-tab-button",null,ia,Ra),o(na,` ${e(J).name??""}`)},[()=>({active:e(P)===_e})]),i(F,qe)}),a(O),i(fe,O)};m(Qe,fe=>{e(k)?.subjects&&e(k).subjects.length>1&&fe(we)})}a(Te);var ze=r(Te,2),Be=r(t(ze),2),We=t(Be),sa=t(We),xe=t(sa);a(sa);var ge=r(sa,2),Ie=t(ge),fa=t(Ie),_a=t(fa);{var Je=fe=>{var O=$t("Loading...");i(fe,O)},Re=fe=>{var O=$t();b(()=>o(O,`${e(S).writtenWork.count??""} Column${e(S).writtenWork.count!==1?"s":""}`)),i(fe,O)};m(_a,fe=>{e(f)?fe(Je):fe(Re,!1)})}a(fa),a(Ie);var He=r(Ie,2),la=t(He);la.__click=[$c,Ce],a(He),a(ge),a(We);var aa=r(We,2),c=t(aa),u=t(c);a(c);var j=r(c,2),K=t(j),ke=t(K),Pe=t(ke);{var de=fe=>{var O=$t("Loading...");i(fe,O)},$e=fe=>{var O=$t();b(()=>o(O,`${e(S).performanceTasks.count??""} Column${e(S).performanceTasks.count!==1?"s":""}`)),i(fe,O)};m(Pe,fe=>{e(f)?fe(de):fe($e,!1)})}a(ke),a(K);var te=r(K,2),T=t(te);T.__click=[Cc,Ce],a(te),a(j),a(aa);var x=r(aa,2),$=t(x),Q=t($);a($);var X=r($,2),Le=t(X),I=t(Le),ie=t(I);{var se=fe=>{var O=$t("Loading...");i(fe,O)},Ge=fe=>{var O=$t();b(()=>o(O,`${e(S).quarterlyAssessment.count??""} Column${e(S).quarterlyAssessment.count!==1?"s":""}`)),i(fe,O)};m(ie,fe=>{e(f)?fe(se):fe(Ge,!1)})}a(I),a(Le);var Ve=r(Le,2),Ze=t(Ve);Ze.__click=[jc,Ce],a(Ve),a(X),a(x),a(Be);var Ye=r(Be,2);{var ga=fe=>{var O=Ec();i(fe,O)},da=fe=>{var O=ja(),F=va(O);{var J=qe=>{var ia=qc(),na=r(t(ia),2),Ra=t(na);a(na);var Ue=r(na,2);Ue.__click=B,a(ia),b(()=>o(Ra,`Error: ${e(p)??""}`)),i(qe,ia)},_e=qe=>{var ia=ja(),na=va(ia);{var Ra=Fe=>{var Ma=Fc();i(Fe,Ma)},Ue=Fe=>{{let Ma=jt(()=>d.selectedClass?.sectionId),dt=jt(()=>e(ee)?.id);ur(Dc(Fe,{get sectionId(){return e(Ma)},get subjectId(){return e(dt)},get gradingPeriodId(){return e(E)},get students(){return e(A)},set students(ha){s(A,ha,!0)},get gradingConfig(){return e(S)},set gradingConfig(ha){s(S,ha,!0)}}),ha=>s(Y,ha,!0),()=>e(Y))}};m(na,Fe=>{e(A).length===0?Fe(Ra):Fe(Ue,!1)},!0)}i(qe,ia)};m(F,qe=>{e(p)?qe(J):qe(_e,!1)},!0)}i(fe,O)};m(Ye,fe=>{e(f)?fe(ga):fe(da,!1)})}a(ze),a(re);var Oa=r(re,2);{var Ga=fe=>{Ei(fe,{get message(){return e(y)},get type(){return e(ce)},onClose:()=>s(ve,!1)})};m(Oa,fe=>{e(ve)&&fe(Ga)})}b((fe,O,F)=>{o(Ne,`${e(U).section??""} â¢ ${e(U).subject??""} â¢ ${e(U).quarter??""}`),o(xe,`Written Work (${fe??""}%)`),la.disabled=e(S).writtenWork.count>=10||e(C),o(u,`Performance Tasks (${O??""}%)`),T.disabled=e(S).performanceTasks.count>=10||e(C),o(Q,`Quarterly Assessment (${F??""}%)`),Ze.disabled=e(S).quarterlyAssessment.count>=10||e(C)},[()=>Math.round(e(S).writtenWork.weight*100),()=>Math.round(e(S).performanceTasks.weight*100),()=>Math.round(e(S).quarterlyAssessment.weight*100)]),i(V,Ae),Wt(),w()}Ds(["click"]);var Pc=n('<div class="advisory-stat-card"><div class="advisory-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="advisory-stat-value"><!> <!></div> <div class="advisory-stat-label"> </div></div></div>'),Gc=n('<div class="students-loading"><div class="dashboard-loader"></div> <p>Loading students and grades...</p></div>'),Rc=n('<div class="students-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),Mc=n('<div class="students-empty"><span class="material-symbols-outlined">school</span> <p>No students found in this advisory class</p></div>'),Oc=n('<div class="loading-spinner"></div> <div class="overlay-text">Processing...</div>',1),Vc=n('<span class="material-symbols-outlined">verified</span> <div class="overlay-text">Verify</div>',1),Uc=n('<small class="submitted-date"> </small>'),Yc=n('<small class="submitted-date not-submitted">Grades not submitted yet</small>'),Wc=n('<div class="grade-score-display"> </div>'),Hc=n('<div class="grade-score-display" style="color: #666;">N/A</div>'),Qc=n('<button><div class="grade-overlay"><div class="overlay-content"><!></div></div> <div class="grade-item-header"><div class="grade-info"><div class="subject-name"> </div> <div class="subject-teacher"> </div> <!></div> <div class="grade-controls"><!></div></div></button>'),Bc=n('<div class="student-grades"><div class="grades-header"><h4 class="grades-title"> </h4> <div class="student-verification-controls"><button class="verify-btn"><span class="material-symbols-outlined">verified</span> Verify All</button></div></div> <div class="grades-grid"></div></div>'),Jc=n('<div><div class="student-header"><div class="student-header-content"><div class="student-title-section"><h3 class="student-title"> </h3></div> <div class="student-info-row"><div class="student-info-item"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined">assignment</span> <span> </span></div></div></div> <div class="student-average"><div class="average-score"> </div></div> <div class="expand-icon"><span class="material-symbols-outlined"> </span></div></div> <!></div>'),zc=n('<div class="advisory-class-container"><div class="advisory-page-header"><div class="header-content"><h1 class="advisory-page-title">Advisory Class Dashboard</h1> <div class="advisory-class-info"><div class="class-detail"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">meeting_room</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div></div></div> <div class="advisory-stats-section"><div class="advisory-stats-grid"></div></div> <div class="students-section"><div class="section-header"><button class="refresh-btn"><span class="material-symbols-outlined">refresh</span> Refresh</button> <div class="bulk-controls"><button class="verify-all-btn"><span class="material-symbols-outlined">verified</span> Verify All Grades</button></div></div> <div class="advisory-students-grid"><!></div></div></div>');function Kc(V,d){Yt(d,!0);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_);function f(xe){if(!xe)return null;const ge=new Date(xe),Ie=String(ge.getMonth()+1).padStart(2,"0"),fa=String(ge.getDate()).padStart(2,"0"),_a=ge.getFullYear();return`${Ie}-${fa}-${_a}`}let p=ba(!0),g=ba(null),C=ba(As({averageGrade:null})),k=ba(As([])),N=ba(As(new Set)),E=ba(2),q=ba("2nd Quarter");async function D(){try{s(p,!0),s(g,null);const xe=await lt.get(`/api/teacher-advisory?teacher_id=${v().userData.id}&quarter=${e(E)}`);xe.success?(s(C,{...e(C),...xe.data.advisoryData},!0),xe.data.students&&s(k,xe.data.students.map(ge=>({id:ge.id.toString(),name:ge.name,full_name:ge.name,studentNumber:ge.student_number,gradeLevel:ge.grade_level,gradesVerified:ge.grades_verified,finalGrades:ge.subjects.map(Ie=>({id:`${ge.id}_${Ie.subject_id}`,subjectName:Ie.subject_name,subjectCode:Ie.subject_code,teacherName:Ie.teacher_name,finalGrade:Ie.averages.final_grade,verified:Ie.verified,verifiedAt:Ie.verified_at,submittedToAdviser:Ie.submitted_to_adviser})),grades:ge.subjects.map(Ie=>({subject:Ie.subject_name,teacher:Ie.teacher_name,grade:Ie.averages.final_grade,quarter:e(q),verified:Ie.verified,submittedDate:Ie.submitted_at?f(Ie.submitted_at):null,submittedToAdviser:Ie.submitted_to_adviser,gradeItems:[]}))})),!0)):s(g,xe.error||"Failed to fetch advisory data",!0)}catch(xe){console.error("Error fetching advisory data:",xe),s(g,"Failed to load advisory data. Please try again.")}finally{s(p,!1)}}async function P(){try{const ge=await(await fetch("/api/current-quarter")).json();ge.success&&ge.data?(s(E,ge.data.currentQuarter,!0),s(q,ge.data.quarterName,!0),console.log(`Current quarter set to: ${e(q)} (Quarter ${e(E)})`)):(s(E,1),s(q,"1st Quarter"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter"))}catch(xe){console.error("Error fetching current quarter:",xe),s(E,1),s(q,"1st Quarter")}}Bt(async()=>{v().userData?.id&&(await P(),await D())});const Y=jt(()=>e(k).map(xe=>{if(!xe.finalGrades||xe.finalGrades.length===0)return{...xe,average:0,verifiedGradesCount:0,pendingGradesCount:xe.grades?.length||0};const Ie=xe.finalGrades.reduce((_a,Je)=>_a+(Je.finalGrade||0),0)/xe.finalGrades.length,fa=xe.finalGrades?.filter(_a=>_a.verified)||[];return{...xe,average:Math.round(Ie*10)/10,verifiedGradesCount:fa.length,pendingGradesCount:(xe.finalGrades?.length||0)-fa.length}}));Is(()=>{if(e(C)&&e(Y).length>0){const xe=e(Y).map(ge=>ge.average).filter(ge=>ge!==null&&ge>0);xe.length>0?e(C).averageGrade=Math.round(xe.reduce((ge,Ie)=>ge+Ie,0)/xe.length*10)/10:e(C).averageGrade=null}else e(C)&&(e(C).averageGrade=null)});async function ee(xe){if(!xe||e(N).has(xe))return;const[ge,Ie]=xe.split("_"),fa=e(k).find(He=>He.id===ge),_a=fa?.finalGrades?.find(He=>He.id===xe),Je=_a?.subjectName||"Unknown Subject",Re=fa?.full_name||"Unknown Student";if(_a?.finalGrade===null||_a?.finalGrade==="N/A"||_a?.finalGrade===""){ye.error(`Cannot verify ${Je} grade for ${Re} - grade is N/A`);return}is.confirm("Verify Grade",`Are you sure you want to verify the ${Je} grade for ${Re}?`,async()=>{e(N).add(xe),s(N,new Set(e(N)),!0);try{const He=await lt.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:ge,section_id:e(C).section_id,teacher_id:v().userData.id,quarter:e(E),verified:!0});He.success?(s(k,e(k).map(la=>{const aa={...la,finalGrades:la.finalGrades?.map(u=>u.id===xe?{...u,verified:!0}:u)||[]},c=aa.finalGrades?.every(u=>u.verified)||!1;return aa.gradesVerified=c,aa}),!0),ye.success(`${Je} grade verified for ${Re}`),e(N).delete(xe),s(N,new Set(e(N)),!0)):(console.error("Failed to verify grade:",He.error),ye.error(He.error||"Failed to verify grade. Please try again."),e(N).delete(xe),s(N,new Set(e(N)),!0))}catch(He){console.error("Error verifying grade:",He),ye.error("Failed to verify grade. Please try again."),e(N).delete(xe),s(N,new Set(e(N)),!0)}},()=>{})}async function H(xe){const ge=e(k).find(_a=>_a.id===xe),Ie=ge?.full_name||"Unknown Student";if(ge?.finalGrades?.some(_a=>_a.finalGrade===null||_a.finalGrade==="N/A"||_a.finalGrade==="")){ye.error(`Cannot verify all grades for ${Ie} - some grades are N/A`);return}is.confirm("Verify All Grades",`Are you sure you want to verify all grades for ${Ie}?`,async()=>{try{const _a=await lt.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:xe,section_id:e(C).section_id,teacher_id:v().userData.id,quarter:e(E),verified:!0});_a.success?(s(k,e(k).map(Je=>Je.id===xe?{...Je,gradesVerified:!0,finalGrades:Je.finalGrades?.map(Re=>({...Re,verified:!0}))||[]}:Je),!0),ye.success(`All grades verified for ${Ie}`)):(console.error("Failed to verify student grades:",_a.error),ye.error(_a.error||"Failed to verify student grades. Please try again."))}catch(_a){console.error("Error verifying student grades:",_a),ye.error("Failed to verify student grades. Please try again.")}},()=>{})}async function U(){const xe=e(k).filter(ge=>ge.finalGrades?.some(Ie=>Ie.finalGrade===null||Ie.finalGrade==="N/A"||Ie.finalGrade===""));if(xe.length>0){const ge=xe.map(Ie=>Ie.full_name).join(", ");ye.error(`Cannot verify all grades - the following students have N/A grades: ${ge}`);return}is.confirm("Verify All Students","Are you sure you want to verify all grades for all students in this class?",async()=>{try{const ge=await lt.post("/api/teacher-advisory",{action:"verify_all_grades",section_id:e(C).section_id,teacher_id:v().userData.id,quarter:e(E),verified:!0});ge.success?(s(k,e(k).map(Ie=>({...Ie,gradesVerified:!0,finalGrades:Ie.finalGrades?.map(fa=>({...fa,verified:!0}))||[],grades:Ie.grades.map(fa=>({...fa,verified:!0}))})),!0),ye.success("All student grades verified successfully")):(console.error("Failed to verify all students:",ge.error),ye.error(ge.error||"Failed to verify all students. Please try again."))}catch(ge){console.error("Error verifying all students:",ge),ye.error("Failed to verify all students. Please try again.")}},()=>{})}let A=[{id:"students",label:"Total Students",getValue:()=>e(C)?.totalStudents||0,icon:"people",color:"var(--school-primary)"},{id:"subjects",label:"Subjects Tracked",getValue:()=>e(C)?.subjectsCount||0,icon:"book",color:"var(--school-secondary)"},{id:"average",label:"Class Average",getValue:()=>e(C)&&e(C).averageGrade!==null?`${e(C).averageGrade}`:"N/A",icon:"grade",color:"var(--school-accent)"}],M=ba(null);function ae(xe){s(M,e(M)?.id===xe.id?null:xe,!0)}function Se(xe){return xe>=90?"var(--success)":xe>=80?"var(--school-accent)":xe>=75?"var(--warning)":"var(--error)"}var B=zc(),ue=t(B),S=t(ue),y=r(t(S),2),ce=t(y),ve=r(t(ce),2),le=t(ve,!0);a(ve),a(ce);var Ce=r(ce,2),me=r(t(Ce),2),Me=t(me,!0);a(me),a(Ce);var Ae=r(Ce,2),re=r(t(Ae),2),Te=t(re,!0);a(re),a(Ae),a(y),a(S),a(ue);var Oe=r(ue,2),ea=t(Oe);xa(ea,21,()=>A,xe=>xe.id,(xe,ge)=>{var Ie=Pc(),fa=t(Ie),_a=t(fa),Je=t(_a,!0);a(_a),a(fa);var Re=r(fa,2),He=t(Re),la=t(He);{let K=jt(()=>e(ge).getValue());fi(la,{get value(){return e(K)},format:"d",duration:2e3,animation:"ease-out"})}var aa=r(la,2);{var c=K=>{};m(aa,K=>{e(ge).id==="average"&&K(c)})}a(He);var u=r(He,2),j=t(u,!0);a(u),a(Re),a(Ie),b(()=>{Zt(fa,`background-color: ${e(ge).color??""}20; color: ${e(ge).color??""}`),o(Je,e(ge).icon),Zt(He,`color: ${e(ge).color??""}`),o(j,e(ge).label)}),i(xe,Ie)}),a(ea),a(Oe);var Ke=r(Oe,2),z=t(Ke),Ne=t(z),Qe=r(Ne,2),we=t(Qe);a(Qe),a(z);var ze=r(z,2),Be=t(ze);{var We=xe=>{var ge=Gc();i(xe,ge)},sa=xe=>{var ge=ja(),Ie=va(ge);{var fa=Je=>{var Re=Rc(),He=r(t(Re),2),la=t(He);a(He),a(Re),b(()=>o(la,`Error loading students: ${e(g)??""}`)),i(Je,Re)},_a=Je=>{var Re=ja(),He=va(Re);{var la=c=>{var u=Mc();i(c,u)},aa=c=>{var u=ja(),j=va(u);xa(j,17,()=>e(Y),K=>K.id,(K,ke)=>{var Pe=Jc();let de;var $e=t(Pe),te=t($e),T=t(te),x=t(T),$=t(x);a(x),a(T);var Q=r(T,2),X=t(Q),Le=r(t(X),2),I=t(Le);a(Le),a(X);var ie=r(X,2),se=t(ie),Ge=t(se,!0);a(se);var Ve=r(se,2),Ze=t(Ve,!0);a(Ve),a(ie);var Ye=r(ie,2),ga=r(t(Ye),2),da=t(ga);a(ga),a(Ye),a(Q),a(te);var Oa=r(te,2),Ga=t(Oa),fe=t(Ga,!0);a(Ga),a(Oa);var O=r(Oa,2),F=t(O),J=t(F,!0);a(F),a(O),a($e);var _e=r($e,2);{var qe=ia=>{var na=Bc(),Ra=t(na),Ue=t(Ra),Fe=t(Ue);a(Ue);var Ma=r(Ue,2),dt=t(Ma);a(Ma),a(Ra);var ha=r(Ra,2);xa(ha,21,()=>e(ke).grades,ka=>ka.subject,(ka,La)=>{const Ya=jt(()=>e(ke).finalGrades?.find(za=>za.subjectName===e(La).subject));var oe=Qc();let Sa;var Ba=t(oe),ht=t(Ba),Et=t(ht);{var De=za=>{var ua=Oc();et(2),i(za,ua)},Ee=za=>{var ua=Vc();et(2),i(za,ua)};m(Et,za=>{e(N).has(e(Ya)?.id)?za(De):za(Ee,!1)})}a(ht),a(Ba);var je=r(Ba,2),Da=t(je),ma=t(Da),L=t(ma,!0);a(ma);var ne=r(ma,2),oa=t(ne);a(ne);var Ea=r(ne,2);{var Xe=za=>{var ua=Uc(),Ta=t(ua);a(ua),b(()=>o(Ta,`Submitted: ${e(La).submittedDate||"N/A"}`)),i(za,ua)},Ja=za=>{var ua=Yc();i(za,ua)};m(Ea,za=>{e(Ya)&&e(Ya).submittedToAdviser&&e(Ya).finalGrade!==null?za(Xe):za(Ja,!1)})}a(Da);var pt=r(Da,2),ct=t(pt);{var vt=za=>{var ua=Wc(),Ta=t(ua,!0);a(ua),b((Na,Tt)=>{Zt(ua,`color: ${Na??""}`),o(Ta,Tt)},[()=>Se(e(Ya).finalGrade),()=>Math.round(e(Ya).finalGrade*10)/10]),i(za,ua)},bt=za=>{var ua=Hc();i(za,ua)};m(ct,za=>{e(Ya)&&e(Ya).submittedToAdviser&&e(Ya).finalGrade!==null?za(vt):za(bt,!1)})}a(pt),a(je),a(oe),b((za,ua)=>{Sa=Z(oe,1,`grade-item ${e(Ya)?.verified?"verified":"unverified"}`,null,Sa,za),oe.disabled=ua,o(L,e(La).subject),o(oa,`by ${e(La).teacher??""}`)},[()=>({loading:e(N).has(e(Ya)?.id)}),()=>e(N).has(e(Ya)?.id)]),R("click",oe,()=>ee(e(Ya).id)),i(ka,oe)}),a(ha),a(na),b(()=>o(Fe,`Subject Grades (${e(q)??""})`)),R("click",dt,xr(()=>H(e(ke).id))),i(ia,na)};m(_e,ia=>{e(M)?.id===e(ke).id&&ia(qe)})}a(Pe),b((ia,na)=>{de=Z(Pe,1,`advisory-student-card ${e(ke).gradesVerified?"verified":"pending"}`,null,de,ia),o($,`${e(ke).name??""} Â· Grade ${e(ke).gradeLevel||"7"}`),o(I,`Student #${e(ke).studentNumber??""}`),o(Ge,e(ke).gradesVerified?"verified":"pending"),o(Ze,e(ke).gradesVerified?"Verified":"Pending"),o(da,`${e(ke).verifiedGradesCount??""} Verified, ${e(ke).pendingGradesCount??""} Pending`),Zt(Ga,`color: ${na??""}`),o(fe,e(ke).average!==null?e(ke).average:"N/A"),o(J,e(M)?.id===e(ke).id?"expand_less":"expand_more")},[()=>({selected:e(M)?.id===e(ke).id}),()=>e(ke).average!==null?Se(e(ke).average):"#666"]),R("click",$e,()=>ae(e(ke))),i(K,Pe)}),i(c,u)};m(He,c=>{e(Y).length===0?c(la):c(aa,!1)},!0)}i(Je,Re)};m(Ie,Je=>{e(g)?Je(fa):Je(_a,!1)},!0)}i(xe,ge)};m(Be,xe=>{e(p)?xe(We):xe(sa,!1)})}a(ze),a(Ke),a(B),b(()=>{o(le,e(C)?.sectionName||"Loading..."),o(Me,e(C)?.roomName||"Loading..."),o(Te,e(q))}),R("click",Ne,D),R("click",we,U),i(V,B),Wt(),w()}function Zc(V,d){s(d,!e(d))}function Xc(V,d,_){s(d,!e(d)),_()}var ev=n('<img alt="Profile" class="avatar-image"/>'),av=n('<div class="avatar-placeholder"> </div>'),tv=(V,d,_)=>{d(),_.onNavigateToSettings()},sv=async(V,d,_)=>{d(),await _.onlogout(),Os("Logged out successfully. See you next time!")},rv=n('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),iv=n('<nav class="admin-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">admin_panel_settings</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function nv(V,d){Yt(d,!0);let _=qt(d,"adminName",3,"Admin User"),w=qt(d,"firstName",3,"Admin"),v=qt(d,"gender",3,"male"),f=qt(d,"accountNumber",3,"ADM-2025-0001"),p=qt(d,"profileImage",3,null);function g(z){return z==="female"?"Ms.":"Mr."}let C=jt(()=>`${g(v())} ${w()}`),k=ba(!0),N=ba(!1);function E(){s(N,!1)}function q(z){e(N)&&!z.target.closest(".user-profile-container")&&E()}Bt(()=>{const z=localStorage.getItem("theme");return s(k,z!=="light"),D(),document.addEventListener("click",q),()=>{document.removeEventListener("click",q)}});function D(){e(k)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function P(z){return z.split(" ").map(Ne=>Ne.charAt(0)).join("").toUpperCase().slice(0,2)}var Y=iv(),ee=t(Y),H=t(ee),U=t(H);U.__click=function(...z){d.onToggleNavRail?.apply(this,z)};var A=r(U,2),M=r(t(A),2),ae=t(M);a(M),a(A),a(H);var Se=r(H,2),B=t(Se);B.__click=[Xc,k,D];var ue=t(B),S=t(ue,!0);a(ue),a(B);var y=r(B,2),ce=t(y);ce.__click=[Zc,N];var ve=t(ce),le=t(ve),Ce=t(le,!0);a(le);var me=r(le,2),Me=t(me);a(me),a(ve);var Ae=r(ve,2),re=t(Ae);{var Te=z=>{var Ne=ev();b(()=>Fa(Ne,"src",p())),i(z,Ne)},Oe=z=>{var Ne=av(),Qe=t(Ne,!0);a(Ne),b(we=>o(Qe,we),[()=>P(w())]),i(z,Ne)};m(re,z=>{p()?z(Te):z(Oe,!1)})}a(Ae),a(ce);var ea=r(ce,2);{var Ke=z=>{var Ne=rv(),Qe=t(Ne);Qe.__click=[tv,E,d];var we=r(Qe,2);we.__click=[sv,E,d],a(Ne),i(z,Ne)};m(ea,z=>{e(N)&&z(Ke)})}a(y),a(Se),a(ee),a(Y),b(()=>{o(ae,`Welcome, ${e(C)??""}`),o(S,e(k)?"light_mode":"dark_mode"),o(Ce,_()),o(Me,`Account: ${f()??""}`)}),i(V,Y),Wt()}Ds(["click"]);var ov=(V,d,_)=>d(e(_).id),lv=(V,d,_)=>d(e(_).id),dv=n('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),cv=n('<div class="admin-menu-folder-contents"></div>'),vv=n('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button> <!>',1),uv=(V,d,_)=>d(e(_).id),mv=n('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),pv=(V,d,_)=>d(e(_).id),fv=n('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),_v=(V,d,_)=>d(e(_).id),gv=n('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),hv=(V,d)=>d("management-folder"),bv=V=>V.stopPropagation(),yv=(V,d)=>d("management-folder"),wv=(V,d,_,w)=>{d(e(_).id),w("management-folder")},Sv=n('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),xv=n('<div class="admin-menu-mobile-folder-overlay"><div class="admin-menu-mobile-folder-content"><div class="admin-menu-mobile-folder-header"><h3>Management</h3> <button class="admin-menu-close-folder"><span class="material-symbols-outlined">close</span></button></div> <div class="admin-menu-mobile-folder-items"></div></div></div>'),kv=n('<nav role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-rail-container"></div></nav> <nav class="admin-menu-bottom-navigation" role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-nav-container"><!> <!></div></nav>',1);function Dv(V,d){Yt(d,!0);let _=qt(d,"adminActiveSection",15,"dashboard"),w=qt(d,"adminNavRailVisible",3,!0),v=ba(!1);const f=[{id:"dashboard",label:"Dashboard",icon:"dashboard",type:"item"},{id:"management-folder",label:"Management",icon:"folder",type:"folder",expanded:e(v),items:[{id:"schedule-management",label:"Schedule",icon:"schedule"},{id:"department-management",label:"Department",icon:"corporate_fare"},{id:"subjects-and-activities",label:"Subjects & Activities",icon:"school"}]},{id:"account-creation",label:"Account Creation",icon:"person_add",type:"item"},{id:"document-requests",label:"Document Requests",icon:"description",type:"item"},{id:"student-masterlist",label:"Student Masterlist",icon:"groups",type:"item"},{id:"student-grades-list",label:"Student Grades List",icon:"grade",type:"item"},{id:"archived-students",label:"Archived Students",icon:"archive",type:"item"}];function p(U){_(U),d.onnavigate&&d.onnavigate({detail:{section:U}})}function g(U){U==="management-folder"&&s(v,!e(v))}function C(U){return U.items?.some(A=>A.id===_())||!1}var k=kv(),N=va(k);let E;var q=t(N);xa(q,21,()=>f,U=>U.id,(U,A)=>{var M=ja(),ae=va(M);{var Se=ue=>{var S=vv(),y=va(S);let ce;y.__click=[ov,g,A];var ve=t(y),le=t(ve),Ce=t(le,!0);a(le),a(ve);var me=r(ve,2),Me=t(me,!0);a(me),a(y);var Ae=r(y,2);{var re=Te=>{var Oe=cv();xa(Oe,21,()=>e(A).items,ea=>ea.id,(ea,Ke)=>{var z=dv();let Ne;z.__click=[lv,p,Ke];var Qe=t(z),we=t(Qe),ze=t(we,!0);a(we),a(Qe);var Be=r(Qe,2),We=t(Be,!0);a(Be),a(z),b(sa=>{Ne=Z(z,1,"admin-menu-rail-item admin-menu-sub-item",null,Ne,sa),Fa(z,"aria-label",e(Ke).label),Fa(z,"aria-current",e(Ke).id===_()?"page":void 0),o(ze,e(Ke).icon),o(We,e(Ke).label)},[()=>({active:e(Ke).id===_()})]),i(ea,z)}),a(Oe),i(Te,Oe)};m(Ae,Te=>{e(v)&&Te(re)})}b(Te=>{ce=Z(y,1,"admin-menu-rail-item admin-menu-folder",null,ce,Te),Fa(y,"aria-label",e(A).label),Fa(y,"aria-expanded",e(v)),o(Ce,e(v)?"folder_open":"folder"),o(Me,e(A).label)},[()=>({active:C(e(A)),expanded:e(v)})]),i(ue,S)},B=ue=>{var S=mv();let y;S.__click=[uv,p,A];var ce=t(S),ve=t(ce),le=t(ve,!0);a(ve),a(ce);var Ce=r(ce,2),me=t(Ce,!0);a(Ce),a(S),b(Me=>{y=Z(S,1,"admin-menu-rail-item",null,y,Me),Fa(S,"aria-label",e(A).label),Fa(S,"aria-current",e(A).id===_()?"page":void 0),o(le,e(A).icon),o(me,e(A).label)},[()=>({active:e(A).id===_()})]),i(ue,S)};m(ae,ue=>{e(A).type==="folder"?ue(Se):ue(B,!1)})}i(U,M)}),a(q),a(N);var D=r(N,2),P=t(D),Y=t(P);xa(Y,17,()=>f,U=>U.id,(U,A)=>{var M=ja(),ae=va(M);{var Se=ue=>{var S=fv();let y;S.__click=[pv,g,A];var ce=t(S),ve=t(ce),le=t(ve,!0);a(ve),a(ce),a(S),b(Ce=>{y=Z(S,1,"admin-menu-nav-item admin-menu-folder",null,y,Ce),Fa(S,"aria-label",e(A).label),Fa(S,"aria-expanded",e(v)),o(le,e(v)?"folder_open":"folder")},[()=>({active:C(e(A))})]),i(ue,S)},B=ue=>{var S=gv();let y;S.__click=[_v,p,A];var ce=t(S),ve=t(ce),le=t(ve,!0);a(ve),a(ce),a(S),b(Ce=>{y=Z(S,1,"admin-menu-nav-item",null,y,Ce),Fa(S,"aria-label",e(A).label),Fa(S,"aria-current",e(A).id===_()?"page":void 0),o(le,e(A).icon)},[()=>({active:e(A).id===_()})]),i(ue,S)};m(ae,ue=>{e(A).type==="folder"?ue(Se):ue(B,!1)})}i(U,M)});var ee=r(Y,2);{var H=U=>{var A=xv();A.__click=[hv,g];var M=t(A);M.__click=[bv];var ae=t(M),Se=r(t(ae),2);Se.__click=[yv,g],a(ae);var B=r(ae,2);xa(B,21,()=>f.find(ue=>ue.id==="management-folder")?.items||[],ue=>ue.id,(ue,S)=>{var y=Sv();let ce;y.__click=[wv,p,S,g];var ve=t(y),le=t(ve,!0);a(ve);var Ce=r(ve,2),me=t(Ce,!0);a(Ce),a(y),b(Me=>{ce=Z(y,1,"admin-menu-mobile-folder-item",null,ce,Me),o(le,e(S).icon),o(me,e(S).label)},[()=>({active:e(S).id===_()})]),i(ue,y)}),a(B),a(M),a(A),i(U,A)};m(ee,U=>{e(v)&&U(H)})}a(P),a(D),b(U=>E=Z(N,1,"admin-menu-navigation-rail",null,E,U),[()=>({collapsed:!w()})]),i(V,k),Wt()}Ds(["click"]);function Av(){const{subscribe:V,set:d,update:_}=Gs({data:[{id:"students",label:"Total Students",value:0,icon:"school",color:"blue"},{id:"teachers",label:"Total Teachers",value:0,icon:"person",color:"green"},{id:"sections",label:"Total Sections",value:0,icon:"class",color:"orange"},{id:"rooms",label:"Total Rooms",value:0,icon:"meeting_room",color:"purple"}],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:V,init:w=>{w&&_(v=>({...v,data:w,isInitialized:!0,isLoading:!1}))},setLoading:w=>{_(v=>({...v,isLoading:w&&!v.isInitialized}))},updateData:w=>{_(v=>({...v,data:w,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0}));try{localStorage.setItem("dashboard-stats-cache",JSON.stringify({data:w,timestamp:Date.now()}))}catch(v){console.warn("Failed to cache dashboard data:",v)}},setError:w=>{_(v=>({...v,error:w,isLoading:!1}))},getCachedData:()=>{try{const w=localStorage.getItem("dashboard-stats-cache");if(w){const{data:v,timestamp:f}=JSON.parse(w);if(Date.now()-f<300*1e3)return v}}catch(w){console.warn("Failed to retrieve cached dashboard data:",w)}return null},clearCache:()=>{try{localStorage.removeItem("dashboard-stats-cache")}catch(w){console.warn("Failed to clear dashboard cache:",w)}}}}const Zs=Av();var Tv=n('<div class="stats-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Nv=n('<div><div class="stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><h3 class="stat-value"><!></h3> <p class="stat-label"> </p></div></div>'),$v=n('<div class="stats-grid"></div>'),Cv=n('<div class="activities-loading"><div class="system-loader"></div> <p>Loading recent activities...</p></div>'),jv=n('<div class="activities-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),Ev=n('<div class="activities-empty"><span class="material-symbols-outlined">inbox</span> <p>No recent activities found</p></div>'),qv=n('<p class="activity-user"> </p>'),Fv=n('<div class="activity-item"><div class="activity-icon"><span class="material-symbols-outlined"> </span></div> <div class="activity-content"><p class="activity-message"> </p> <!></div> <span class="activity-timestamp"> </span></div>'),Lv=n('<div class="dashboard-container"><div class="dashboard-header"><div class="header-content"><h1 class="page-title">Admin Dashboard</h1> <p class="page-subtitle">Overview of school management system statistics</p></div></div> <div class="stats-section"><div class="section-header"><h2 class="section-title">System Statistics</h2> <p class="dashboard-section-subtitle">Current overview of your school management system</p></div> <!></div> <div class="activities-section"><div class="section-header"><h2 class="section-title">Activity Logs</h2> <button class="refresh-button" title="Refresh activity logs"><span class="material-symbols-outlined">refresh</span> Refresh</button></div> <div class="activities-list"><!></div></div></div>');function Iv(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(Zs,"$dashboardStore",_),f=h(),p=h(),g=h();let C=h([]),k=h(!1),N=h(null);async function E(S=!1){try{S||Zs.setLoading(!0);const y=await lt.get("/api/dashboard");if(y.success){const ce=[{id:"students",label:"Total Students",value:y.data.students.toLocaleString(),icon:"school",color:"primary"},{id:"teachers",label:"Total Teachers",value:y.data.teachers.toLocaleString(),icon:"person",color:"primary"},{id:"sections",label:"Total Sections",value:y.data.sections.toLocaleString(),icon:"class",color:"primary"},{id:"rooms",label:"Total Rooms",value:y.data.rooms.toLocaleString(),icon:"meeting_room",color:"primary"}];Zs.updateData(ce)}else throw new Error(y.error||"Failed to fetch dashboard statistics")}catch(y){console.error("Error fetching dashboard statistics:",y),Zs.setError(y.message)}}async function q(S=!1){try{S||(s(k,!0),s(N,null));const y=await lt.get("/api/activity-logs");if(y.success)s(C,y.activities);else throw new Error(y.error||"Failed to fetch activities")}catch(y){console.error("Error fetching activities:",y),s(N,y.message)}finally{s(k,!1)}}Bt(()=>{const S=Zs.getCachedData();S&&Zs.init(S),E(!!S),q(!1);const y=setInterval(()=>{E(!0),q(!0)},3e4);return()=>{clearInterval(y)}}),at(()=>(e(f),e(p),e(g),v()),()=>{(S=>{s(f,S.data),s(p,S.isLoading),s(g,S.error)})(v())}),ps(),cs();var D=Lv(),P=r(t(D),2),Y=r(t(P),2);{var ee=S=>{var y=Tv(),ce=r(t(y),2),ve=t(ce);a(ce);var le=r(ce,2);a(y),b(()=>o(ve,`Error loading statistics: ${e(g)??""}`)),R("click",le,()=>E(!1)),i(S,y)},H=S=>{var y=$v();xa(y,5,()=>e(f),ce=>ce.id,(ce,ve)=>{var le=Nv(),Ce=t(le),me=t(Ce),Me=t(me,!0);a(me),a(Ce);var Ae=r(Ce,2),re=t(Ae),Te=t(re);{var Oe=Ne=>{var Qe=$t("Loading...");i(Ne,Qe)},ea=Ne=>{var Qe=$t();b(()=>o(Qe,(e(ve),l(()=>e(ve).value)))),i(Ne,Qe)};m(Te,Ne=>{e(p)?Ne(Oe):Ne(ea,!1)})}a(re);var Ke=r(re,2),z=t(Ke,!0);a(Ke),a(Ae),a(le),b(()=>{Z(le,1,`stat-card stat-${e(ve),l(()=>e(ve).color)??""}`),o(Me,(e(ve),l(()=>e(ve).icon))),o(z,(e(ve),l(()=>e(ve).label)))}),i(ce,le)}),a(y),i(S,y)};m(Y,S=>{e(g)?S(ee):S(H,!1)})}a(P);var U=r(P,2),A=t(U),M=r(t(A),2);a(A);var ae=r(A,2),Se=t(ae);{var B=S=>{var y=Cv();i(S,y)},ue=S=>{var y=ja(),ce=va(y);{var ve=Ce=>{var me=jv(),Me=r(t(me),2),Ae=t(Me);a(Me),a(me),b(()=>o(Ae,`Error loading activities: ${e(N)??""}`)),i(Ce,me)},le=Ce=>{var me=ja(),Me=va(me);{var Ae=Te=>{var Oe=Ev();i(Te,Oe)},re=Te=>{var Oe=ja(),ea=va(Oe);xa(ea,1,()=>e(C),Ke=>Ke.id,(Ke,z)=>{var Ne=Fv(),Qe=t(Ne),we=t(Qe),ze=t(we,!0);a(we),a(Qe);var Be=r(Qe,2),We=t(Be),sa=t(We,!0);a(We);var xe=r(We,2);{var ge=_a=>{var Je=qv(),Re=t(Je,!0);a(Je),b(()=>o(Re,(e(z),l(()=>e(z).performed_by)))),i(_a,Je)};m(xe,_a=>{e(z),l(()=>e(z).performed_by&&e(z).performed_by!=="System")&&_a(ge)})}a(Be);var Ie=r(Be,2),fa=t(Ie,!0);a(Ie),a(Ne),b(()=>{o(ze,(e(z),l(()=>e(z).icon))),o(sa,(e(z),l(()=>e(z).message))),o(fa,(e(z),l(()=>e(z).timestamp)))}),i(Ke,Ne)}),i(Te,Oe)};m(Me,Te=>{e(C),l(()=>e(C).length===0)?Te(Ae):Te(re,!1)},!0)}i(Ce,me)};m(ce,Ce=>{e(N)?Ce(ve):Ce(le,!1)},!0)}i(S,y)};m(Se,S=>{e(k)?S(B):S(ue,!1)})}a(ae),a(U),a(D),b(()=>M.disabled=e(k)),R("click",M,()=>q(!1)),i(V,D),Wt(),w()}var Pv=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),Gv=n('<span class="placeholder">Select account type</span>'),Rv=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),Mv=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),Ov=n('<span class="placeholder">Select gender</span>'),Vv=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Uv=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),Yv=n('<span class="placeholder">Select grade level</span>'),Wv=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Hv=n('<div class="form-group"><label class="form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div>'),Qv=n('<span class="email-status checking"><span class="material-symbols-outlined spinning">progress_activity</span></span>'),Bv=n('<span class="email-status valid"><span class="material-symbols-outlined">check_circle</span></span>'),Jv=n('<span class="email-status error"><span class="material-symbols-outlined">error</span></span>'),zv=n('<p class="form-error"> </p>'),Kv=n('<p class="form-success">Email is available</p>'),Zv=n('<div class="form-group"><label class="form-label" for="email">Email Address *</label> <div class="email-input-wrapper"><input type="email" id="email" placeholder="Enter email address" required/> <!></div> <!></div>'),Xv=n(`<div class="additional-info-section"><h3 class="section-subtitle">Additional Information</h3> <p class="section-description">Required information for student accounts</p> <div class="form-row"><div class="form-group"><label class="form-label" for="birthdate">Birthdate *</label> <input type="date" id="birthdate" class="form-input" required/></div> <div class="form-group"><label class="form-label" for="age">Age</label> <input type="number" id="age" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label" for="address">Address *</label> <textarea id="address" class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label" for="guardian">Guardian/Parent Name *</label> <input type="text" id="guardian" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label" for="contact-number">Guardian's Contact Number *</label> <input type="tel" id="contact-number" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`),eu=n('<span class="auto-label">Loading preview...</span>'),au=n('<span class="auto-number"> </span> <span class="auto-label">(Preview - will use lowest available)</span>',1),tu=n('<span class="auto-label">Will be auto-assigned (lowest available number)</span>'),su=n('<span class="placeholder-number">Select account type first</span>'),ru=n('<span class="material-symbols-outlined">person_add</span> Create Account',1),iu=n('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),nu=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),ou=n('<span class="placeholder">Filter by type</span>'),lu=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),du=n('<div class="loading-container"><span class="account-loader"></span> <p class="loading-text">Loading accounts...</p></div>'),cu=n('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),vu=n('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),uu=n('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),mu=n('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),pu=n('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),fu=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),_u=n('<span class="placeholder">Select grade level</span>'),gu=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),hu=n(`<div class="form-group"><label class="form-label">Grade Level</label> <div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="additional-info-section"><h4 class="section-subtitle">Additional Information</h4> <p class="section-description">Update student additional information</p> <div class="form-row"><div class="form-group"><label class="form-label">Birthdate *</label> <input type="date" class="form-input" required/></div> <div class="form-group"><label class="form-label">Age</label> <input type="number" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label">Address *</label> <textarea class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label">Guardian/Parent Name *</label> <input type="text" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label">Guardian's Contact Number *</label> <input type="tel" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`,1),bu=n('<div class="edit-form-section"><div class="edit-form-container"><div class="edit-form-header"><h4 class="edit-form-title">Edit Account Information</h4> <p class="edit-form-subtitle">Update the name information for this account</p></div> <form class="edit-form-content"><div class="edit-name-fields-row"><div class="form-group"><label class="form-label">Last Name *</label> <input type="text" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label">First Name *</label> <input type="text" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label">M.I.</label> <input type="text" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <div class="edit-form-actions"><a><button type="button" class="account-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),yu=n('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"> </h3></div> <div class="account-action-buttons"><a><button type="button" class="account-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="account-remove-button" title="Remove Account"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="account-details"><div class="account-detail-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <!> <!> <!> <!> <!> <div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),wu=n("<p>No accounts created yet.</p>"),Su=n("<p>No accounts found matching your search or filter.</p>"),xu=n('<div class="no-results"><span class="material-symbols-outlined no-results-icon">group_off</span> <!></div>'),ku=n(`<div class="account-creation-container"><div class="account-header"><div class="header-content"><h1 class="page-title">Account Creation</h1> <p class="page-subtitle">Create new student, teacher, and admin accounts for the system</p></div></div> <div class="creation-form-section"><div class="account-section-header"><h2 class="section-title">Create New Account</h2> <p class="section-subtitle">Fill in the details below to create a new account</p></div> <div class="form-container"><form><div class="account-type-gender-row"><div class="form-group"><label class="form-label" for="account-type">Account Type *</label> <div><button type="button" id="account-type"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="form-group"><label class="form-label" for="gender">Gender *</label> <div><button type="button" id="gender"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div> <div class="name-fields-row"><div class="form-group"><label class="form-label" for="last-name">Last Name *</label> <input type="text" id="last-name" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label" for="first-name">First Name *</label> <input type="text" id="first-name" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label" for="middle-initial">M.I.</label> <input type="text" id="middle-initial" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <!> <div class="form-group"><div class="form-label"> </div> <div class="number-display"><!></div> <p class="form-help">Account number will be automatically assigned using the lowest available number.
						Password will be set to the same as the account number.</p></div> <div class="form-actions"><button type="submit"><!></button></div></form></div></div> <div class="recent-accounts-section"><div class="account-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="section-title">All Account Creations</h2> <p class="section-subtitle">All accounts in the system</p></div> <div class="search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search accounts by name or number..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div></div></div> <div class="accounts-grid"><!></div></div></div>`);function Du(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(ls,"$authStore",_),f=h(),p=h(),g=h(),C=h(),k=h(),N=h(),E=h();let q=h(!1),D=h(""),P=h(""),Y=h(""),ee=h(""),H=h(""),U=h(""),A=h(""),M=h(""),ae=h(!1),Se=null;const B=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;let ue=h(""),S=h(""),y=h(""),ce=h(""),ve=h(0),le=h(!1),Ce=h(!1),me=h(!1),Me=h(!1),Ae=h("all"),re=h(null),Te=h(""),Oe=h(""),ea=h(""),Ke=h(""),z=h(!1),Ne=h(!1),Qe=h(""),we=h(""),ze=h(""),Be=h(""),We=h(0);function sa(){const G=new Date;return G.setDate(G.getDate()-1),G.toISOString().split("T")[0]}function xe(G){return G&&G.split(" ").map(be=>be.charAt(0).toUpperCase()+be.slice(1).toLowerCase()).join(" ")}function ge(G,be,ra=!1){const $a=G.target.value,pe=be==="middleInitial"?$a.toUpperCase():xe($a);ra?be==="firstName"?s(Te,pe):be==="lastName"?s(Oe,pe):be==="middleInitial"&&s(ea,pe):be==="firstName"?s(ee,pe):be==="lastName"?s(H,pe):be==="middleInitial"&&s(U,pe),G.target.value=pe}function Ie(G){if(!G)return!1;const be=G.replace(/\D/g,"");return be.startsWith("09")&&be.length===11}function fa(G){return G.replace(/\D/g,"").slice(0,11)}function _a(G,be=!1){const ra=fa(G.target.value);be?s(Be,ra):s(ce,ra),G.target.value=ra}async function Je(G){if(s(M,""),!(!G||G.trim()==="")){if(!B.test(G)){s(M,"Invalid email format");return}s(ae,!0);try{const be=await lt.get(`/api/accounts/check-email?email=${encodeURIComponent(G)}`);be.valid?be.exists?s(M,"This email is already registered"):s(M,""):s(M,be.error||"Invalid email format")}catch(be){console.error("Error checking email:",be)}finally{s(ae,!1)}}}function Re(G){const be=G.target.value.trim().toLowerCase();s(A,be),Se&&clearTimeout(Se),be?Se=setTimeout(()=>{Je(be)},500):s(M,"")}function He(G){if(!G||G.length<10)return!0;const be=new Date(G),ra=be.getFullYear(),$a=new Date,pe=$a.getFullYear();if(isNaN(be.getTime())||ra<1900||ra>pe)return!1;const ca=new Date($a.getFullYear(),$a.getMonth(),$a.getDate());return!(new Date(be.getFullYear(),be.getMonth(),be.getDate())>=ca)}let la=h("");const aa=[{id:"student",name:"Student Account",description:"Create a new student account",icon:"school"},{id:"teacher",name:"Teacher Account",description:"Create a new teacher account",icon:"person"},{id:"admin",name:"Admin Account",description:"Create a new admin account",icon:"admin_panel_settings"}],c=[{id:"all",name:"All Accounts",icon:"group"},{id:"student",name:"Students",icon:"school"},{id:"teacher",name:"Teachers",icon:"person"},{id:"admin",name:"Admins",icon:"admin_panel_settings"}],u=[{id:"male",name:"Male",icon:"male"},{id:"female",name:"Female",icon:"female"}],j=[{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let K=h([]),ke=h(!1);function Pe(G){G.target.closest(".custom-dropdown")||(s(le,!1),s(Ce,!1),s(me,!1),s(z,!1),s(Me,!1))}async function de(G){const be=v().userData;if(be&&be.accountNumber===G.number){ye.error("You cannot delete your own account while logged in.");return}is.confirm("Remove Account",`<p>Are you sure you want to remove the account for <strong>"${G.name}"</strong>?</p>`,async()=>{try{const ra=await lt.delete("/api/accounts",{id:G.id});if(!ra.success)throw new Error(ra.message||"Failed to delete account");s(K,e(K).filter($a=>$a.id!==G.id)),ye.success(`Account for "${G.name}" has been removed successfully`)}catch(ra){console.error("Error deleting account:",ra),ye.error(`Failed to delete account: ${ra.message}`)}},()=>{},{size:"small"})}function $e(G){if(e(re)===G.id)s(re,null),s(Te,""),s(Oe,""),s(ea,""),s(Ke,""),s(Qe,""),s(we,""),s(ze,""),s(Be,""),s(We,0),s(z,!1);else if(s(re,G.id),G.firstName&&G.lastName){if(s(Te,G.firstName),s(Oe,G.lastName),s(ea,G.middleInitial||""),s(Ke,G.gradeLevel||""),G.birthdate){const be=new Date(G.birthdate),ra=be.getFullYear(),$a=String(be.getMonth()+1).padStart(2,"0"),pe=String(be.getDate()).padStart(2,"0");s(Qe,`${ra}-${$a}-${pe}`)}else s(Qe,"");s(we,G.address||""),s(ze,G.guardian||""),s(Be,G.contactNumber||"")}else{const be=G.name.split(", ");if(be.length>=2){s(Oe,be[0]);const $a=be[1].split(" ");s(Te,$a[0]),$a.length>1&&$a[1].endsWith(".")?s(ea,$a[1].replace(".","")):s(ea,"")}if(s(Ke,G.gradeLevel||""),G.birthdate){const ra=new Date(G.birthdate),$a=ra.getFullYear(),pe=String(ra.getMonth()+1).padStart(2,"0"),ca=String(ra.getDate()).padStart(2,"0");s(Qe,`${$a}-${pe}-${ca}`)}else s(Qe,"");s(we,G.address||""),s(ze,G.guardian||""),s(Be,G.contactNumber||"")}}async function te(){if(!e(Te)||!e(Oe)){ye.error("Please fill in all required fields.");return}if(e(f)&&e(f).type.toLowerCase()==="student"){if(!e(Qe)||!e(we)||!e(ze)||!e(Be)){ye.error("Please fill in all required student information fields.");return}if(!Ie(e(Be))){ye.error("Invalid contact number.");return}}s(Ne,!0);try{const G={id:e(re),firstName:e(Te).trim(),lastName:e(Oe).trim(),middleInitial:e(ea)?e(ea).trim():null};e(f)&&e(f).type.toLowerCase()==="student"&&(G.gradeLevel=e(Ke)||null,G.birthdate=e(Qe)||null,G.address=e(we)?e(we).trim():null,G.guardian=e(ze)?e(ze).trim():null,G.contactNumber=e(Be)?e(Be).trim():null);const be=await lt.put("/api/accounts",G);be.success?(s(K,e(K).map(ra=>ra.id===e(re)?be.account:ra)),ye.success(be.message),s(re,null),s(Te,""),s(Oe,""),s(ea,""),s(Ke,""),s(Qe,""),s(we,""),s(ze,""),s(Be,""),s(We,0)):ye.error(be.error||"Failed to update account")}catch(G){console.error("Error updating account:",G),ye.error("Failed to update account. Please try again.")}finally{s(Ne,!1)}}function T(){s(le,!e(le))}function x(G){s(D,G.id),s(le,!1),G.id!=="student"&&s(Y,"")}function $(){s(Ce,!e(Ce))}function Q(G){s(P,G.id),s(Ce,!1)}function X(){s(me,!e(me))}function Le(G){s(Y,G.id),s(me,!1)}function I(){s(z,!e(z))}function ie(G){s(Ke,G.id),s(z,!1)}function se(){s(Me,!e(Me))}function Ge(G){s(Ae,G.id),s(Me,!1)}async function Ve(){if(!e(D)||!e(P)||!e(ee)||!e(H)){ye.error("Please fill in all required fields.");return}if((e(D)==="student"||e(D)==="teacher")&&!e(A)){ye.error("Please enter an email address.");return}if(e(M)){ye.error(e(M));return}if(e(ae)){ye.error("Please wait while we verify the email address.");return}if(e(D)==="student"&&!e(Y)){ye.error("Please select a grade level for the student account.");return}if(e(D)==="student"){if(!e(ue)||!e(S)||!e(y)||!e(ce)){ye.error("Please fill in all additional information fields for the student account.");return}if(!Ie(e(ce))){ye.error("Invalid contact number.");return}}const G=e(D)==="student"?"Student":e(D)==="teacher"?"Teacher":"Admin",be=`${e(ee)} ${e(U)?e(U)+". ":""}${e(H)}`;is.confirm("Confirm Account Creation",`<p>Are you sure you want to create a <strong>${G}</strong> account for <strong>"${be}"</strong>?</p>`,async()=>{await Ze()},()=>{},{size:"small"})}async function Ze(){s(q,!0);try{const G=v().userData,be=await lt.post("/api/accounts",{accountType:e(D),gender:e(P),gradeLevel:e(Y),firstName:e(ee),lastName:e(H),middleInitial:e(U),email:e(A),birthdate:e(D)==="student"?e(ue):null,address:e(D)==="student"?e(S):null,guardian:e(D)==="student"?e(y):null,contactNumber:e(D)==="student"?e(ce):null,createdBy:G?G.id:null});if(!be.success)throw new Error(be.message||"Failed to create account");s(K,[be.account,...e(K)]);const ra=e(D)==="student"?"Student":e(D)==="teacher"?"Teacher":"Admin";ye.success(`${ra} account created successfully for ${be.account.name}! Password is the same as account number: ${be.account.number}`),s(D,""),s(P,""),s(Y,""),s(ee,""),s(H,""),s(U,""),s(A,""),s(M,""),s(ue,""),s(S,""),s(y,""),s(ce,""),s(ve,0)}catch(G){console.error("Error creating account:",G),ye.error(G.message||"Failed to create account. Please try again.")}finally{s(q,!1)}}let Ye=h(""),ga=h(!1);async function da(G){if(!G){s(Ye,"");return}s(ga,!0);try{const be=await lt.get(`/api/accounts/next-number?type=${G}`);s(Ye,be.accountNumber)}catch(be){console.error("Error fetching next account number:",be),s(Ye,"Error loading preview")}finally{s(ga,!1)}}async function Oa(){s(ke,!0);try{const G=await lt.get("/api/accounts");if(!G.success)throw new Error("Failed to load accounts");s(K,G.accounts)}catch(G){console.error("Error loading accounts:",G),ye.error("Failed to load existing accounts")}finally{s(ke,!1)}}Bt(()=>{Oa()}),at(()=>(e(re),e(K)),()=>{s(f,e(re)?e(K).find(G=>G.id===e(re)):null)}),at(()=>e(D),()=>{s(p,aa.find(G=>G.id===e(D)))}),at(()=>e(P),()=>{s(g,u.find(G=>G.id===e(P)))}),at(()=>e(Y),()=>{s(C,j.find(G=>G.id===e(Y)))}),at(()=>e(Ae),()=>{s(k,c.find(G=>G.id===e(Ae)))}),at(()=>e(Ke),()=>{s(N,j.find(G=>G.id===e(Ke)))}),at(()=>e(ue),()=>{if(e(ue)){const G=new Date(e(ue)),be=new Date;let ra=be.getFullYear()-G.getFullYear();const $a=be.getMonth()-G.getMonth();($a<0||$a===0&&be.getDate()<G.getDate())&&ra--,s(ve,ra>=0?ra:0)}else s(ve,0)}),at(()=>e(Qe),()=>{if(e(Qe)){const G=new Date(e(Qe)),be=new Date;let ra=be.getFullYear()-G.getFullYear();const $a=be.getMonth()-G.getMonth();($a<0||$a===0&&be.getDate()<G.getDate())&&ra--,s(We,ra>=0?ra:0)}else s(We,0)}),at(()=>(e(K),e(Ae),e(la)),()=>{s(E,e(K).filter(G=>{const be=G.type.toLowerCase(),ra=e(Ae)==="all"||be===e(Ae);if(!e(la).trim())return ra;const $a=e(la).toLowerCase().trim(),pe=G.name.toLowerCase().includes($a),ca=G.number.toString().includes($a);return ra&&(pe||ca)}))}),at(()=>e(D),()=>{e(D)&&da(e(D))}),ps(),cs();var Ga=ku();R("click",Ts,Pe);var fe=r(t(Ga),2),O=r(t(fe),2),F=t(O),J=t(F),_e=t(J),qe=r(t(_e),2);let ia;var na=t(qe);let Ra;var Ue=t(na);{var Fe=G=>{var be=Pv(),ra=t(be),$a=t(ra,!0);a(ra);var pe=r(ra,2),ca=t(pe),Aa=t(ca,!0);a(ca);var ya=r(ca,2),pa=t(ya,!0);a(ya),a(pe),a(be),b(()=>{o($a,(e(p),l(()=>e(p).icon))),o(Aa,(e(p),l(()=>e(p).name))),o(pa,(e(p),l(()=>e(p).description)))}),i(G,be)},Ma=G=>{var be=Gv();i(G,be)};m(Ue,G=>{e(p)?G(Fe):G(Ma,!1)})}et(2),a(na);var dt=r(na,2);xa(dt,5,()=>aa,G=>G.id,(G,be)=>{var ra=Rv();let $a;var pe=t(ra),ca=t(pe,!0);a(pe);var Aa=r(pe,2),ya=t(Aa),pa=t(ya,!0);a(ya);var Ia=r(ya,2),Va=t(Ia,!0);a(Ia),a(Aa),a(ra),b(Ca=>{$a=Z(ra,1,"dropdown-option",null,$a,Ca),o(ca,(e(be),l(()=>e(be).icon))),o(pa,(e(be),l(()=>e(be).name))),o(Va,(e(be),l(()=>e(be).description)))},[()=>({selected:e(D)===e(be).id})]),R("click",ra,()=>x(e(be))),i(G,ra)}),a(dt),a(qe),a(_e);var ha=r(_e,2),ka=r(t(ha),2);let La;var Ya=t(ka);let oe;var Sa=t(Ya);{var Ba=G=>{var be=Mv(),ra=t(be),$a=t(ra,!0);a(ra);var pe=r(ra,2),ca=t(pe),Aa=t(ca,!0);a(ca),a(pe),a(be),b(()=>{o($a,(e(g),l(()=>e(g).icon))),o(Aa,(e(g),l(()=>e(g).name)))}),i(G,be)},ht=G=>{var be=Ov();i(G,be)};m(Sa,G=>{e(g)?G(Ba):G(ht,!1)})}et(2),a(Ya);var Et=r(Ya,2);xa(Et,5,()=>u,G=>G.id,(G,be)=>{var ra=Vv();let $a;var pe=t(ra),ca=t(pe,!0);a(pe);var Aa=r(pe,2),ya=t(Aa),pa=t(ya,!0);a(ya),a(Aa),a(ra),b(Ia=>{$a=Z(ra,1,"dropdown-option",null,$a,Ia),o(ca,(e(be),l(()=>e(be).icon))),o(pa,(e(be),l(()=>e(be).name)))},[()=>({selected:e(P)===e(be).id})]),R("click",ra,()=>Q(e(be))),i(G,ra)}),a(Et),a(ka),a(ha);var De=r(ha,2);{var Ee=G=>{var be=Hv(),ra=r(t(be),2);let $a;var pe=t(ra);let ca;var Aa=t(pe);{var ya=Va=>{var Ca=Uv(),ot=t(Ca),Ct=t(ot,!0);a(ot);var Dt=r(ot,2),Ot=t(Dt),rt=t(Ot,!0);a(Ot),a(Dt),a(Ca),b(()=>{o(Ct,(e(C),l(()=>e(C).icon))),o(rt,(e(C),l(()=>e(C).name)))}),i(Va,Ca)},pa=Va=>{var Ca=Yv();i(Va,Ca)};m(Aa,Va=>{e(C)?Va(ya):Va(pa,!1)})}et(2),a(pe);var Ia=r(pe,2);xa(Ia,5,()=>j,Va=>Va.id,(Va,Ca)=>{var ot=Wv();let Ct;var Dt=t(ot),Ot=t(Dt,!0);a(Dt);var rt=r(Dt,2),At=t(rt),Ua=t(At,!0);a(At),a(rt),a(ot),b(it=>{Ct=Z(ot,1,"dropdown-option",null,Ct,it),o(Ot,(e(Ca),l(()=>e(Ca).icon))),o(Ua,(e(Ca),l(()=>e(Ca).name)))},[()=>({selected:e(Y)===e(Ca).id})]),R("click",ot,()=>Le(e(Ca))),i(Va,ot)}),a(Ia),a(ra),a(be),b((Va,Ca)=>{$a=Z(ra,1,"custom-dropdown",null,$a,Va),ca=Z(pe,1,"dropdown-trigger",null,ca,Ca)},[()=>({open:e(me)}),()=>({selected:e(Y)})]),R("click",pe,X),i(G,be)};m(De,G=>{e(D)==="student"&&G(Ee)})}a(J);var je=r(J,2),Da=t(je),ma=r(t(Da),2);Xa(ma),a(Da);var L=r(Da,2),ne=r(t(L),2);Xa(ne),a(L);var oa=r(L,2),Ea=r(t(oa),2);Xa(Ea),a(oa),a(je);var Xe=r(je,2);{var Ja=G=>{var be=Zv(),ra=r(t(be),2),$a=t(ra);Xa($a);let pe;var ca=r($a,2);{var Aa=Ca=>{var ot=Qv();i(Ca,ot)},ya=Ca=>{var ot=ja(),Ct=va(ot);{var Dt=rt=>{var At=Bv();i(rt,At)},Ot=rt=>{var At=ja(),Ua=va(At);{var it=mt=>{var Pt=Jv();i(mt,Pt)};m(Ua,mt=>{e(M)&&mt(it)},!0)}i(rt,At)};m(Ct,rt=>{e(A)&&!e(M)?rt(Dt):rt(Ot,!1)},!0)}i(Ca,ot)};m(ca,Ca=>{e(ae)?Ca(Aa):Ca(ya,!1)})}a(ra);var pa=r(ra,2);{var Ia=Ca=>{var ot=zv(),Ct=t(ot,!0);a(ot),b(()=>o(Ct,e(M))),i(Ca,ot)},Va=Ca=>{var ot=ja(),Ct=va(ot);{var Dt=Ot=>{var rt=Kv();i(Ot,rt)};m(Ct,Ot=>{e(A)&&!e(ae)&&Ot(Dt)},!0)}i(Ca,ot)};m(pa,Ca=>{e(M)?Ca(Ia):Ca(Va,!1)})}a(be),b(Ca=>pe=Z($a,1,"form-input",null,pe,Ca),[()=>({error:e(M),valid:e(A)&&!e(M)&&!e(ae)})]),tt($a,()=>e(A),Ca=>s(A,Ca)),R("input",$a,Re),i(G,be)};m(Xe,G=>{(e(D)==="student"||e(D)==="teacher")&&G(Ja)})}var pt=r(Xe,2);{var ct=G=>{var be=Xv(),ra=r(t(be),4),$a=t(ra),pe=r(t($a),2);Xa(pe),a($a);var ca=r($a,2),Aa=r(t(ca),2);Xa(Aa),a(ca),a(ra);var ya=r(ra,2),pa=r(t(ya),2);Sr(pa),a(ya);var Ia=r(ya,2),Va=t(Ia),Ca=r(t(Va),2);Xa(Ca),a(Va);var ot=r(Va,2),Ct=r(t(ot),2);Xa(Ct),a(ot),a(Ia),a(be),b(Dt=>{Fa(pe,"max",Dt),vr(Aa,e(ve))},[()=>l(sa)]),tt(pe,()=>e(ue),Dt=>s(ue,Dt)),R("blur",pe,Dt=>{e(ue)&&!He(e(ue))&&(ye.error("Invalid date. Please enter a valid date."),s(ue,""),Dt.target.value="")}),tt(pa,()=>e(S),Dt=>s(S,Dt)),tt(Ca,()=>e(y),Dt=>s(y,Dt)),tt(Ct,()=>e(ce),Dt=>s(ce,Dt)),R("input",Ct,Dt=>_a(Dt,!1)),i(G,be)};m(pt,G=>{e(D)==="student"&&G(ct)})}var vt=r(pt,2),bt=t(vt),za=t(bt,!0);a(bt);var ua=r(bt,2),Ta=t(ua);{var Na=G=>{var be=ja(),ra=va(be);{var $a=ca=>{var Aa=eu();i(ca,Aa)},pe=ca=>{var Aa=ja(),ya=va(Aa);{var pa=Va=>{var Ca=au(),ot=va(Ca),Ct=t(ot,!0);a(ot),et(2),b(()=>o(Ct,e(Ye))),i(Va,Ca)},Ia=Va=>{var Ca=tu();i(Va,Ca)};m(ya,Va=>{e(Ye)?Va(pa):Va(Ia,!1)},!0)}i(ca,Aa)};m(ra,ca=>{e(ga)?ca($a):ca(pe,!1)})}i(G,be)},Tt=G=>{var be=su();i(G,be)};m(Ta,G=>{e(D)?G(Na):G(Tt,!1)})}a(ua),et(2),a(vt);var Za=r(vt,2),nt=t(Za);let Wa;var ft=t(nt);{var ut=G=>{var be=$t("Creating Account...");i(G,be)},_t=G=>{var be=ru();et(),i(G,be)};m(ft,G=>{e(q)?G(ut):G(_t,!1)})}a(nt),a(Za),a(F),a(O),a(fe);var qa=r(fe,2),W=t(qa),he=t(W),ta=r(t(he),2),Pa=t(ta),st=t(Pa),Ha=r(t(st),2);Xa(Ha);var wa=r(Ha,2);{var St=G=>{var be=iu();R("click",be,()=>s(la,"")),i(G,be)};m(wa,G=>{e(la)&&G(St)})}a(st),a(Pa);var Nt=r(Pa,2),wt=t(Nt);let Ka;var Qa=t(wt);let gt;var yt=t(Qa);{var Mt=G=>{var be=nu(),ra=t(be),$a=t(ra,!0);a(ra);var pe=r(ra,2),ca=t(pe),Aa=t(ca,!0);a(ca),a(pe),a(be),b(()=>{o($a,(e(k),l(()=>e(k).icon))),o(Aa,(e(k),l(()=>e(k).name)))}),i(G,be)},kt=G=>{var be=ou();i(G,be)};m(yt,G=>{e(k)?G(Mt):G(kt,!1)})}et(2),a(Qa);var xt=r(Qa,2);xa(xt,5,()=>c,G=>G.id,(G,be)=>{var ra=lu();let $a;var pe=t(ra),ca=t(pe,!0);a(pe);var Aa=r(pe,2),ya=t(Aa),pa=t(ya,!0);a(ya),a(Aa),a(ra),b(Ia=>{$a=Z(ra,1,"dropdown-option",null,$a,Ia),o(ca,(e(be),l(()=>e(be).icon))),o(pa,(e(be),l(()=>e(be).name)))},[()=>({selected:e(Ae)===e(be).id})]),R("click",ra,()=>Ge(e(be))),i(G,ra)}),a(xt),a(wt),a(Nt),a(ta),a(he),a(W);var Gt=r(W,2),Ft=t(Gt);{var Lt=G=>{var be=du();i(G,be)},Ht=G=>{var be=ja(),ra=va(be);xa(ra,1,()=>e(E),$a=>$a.id,($a,pe)=>{var ca=yu(),Aa=t(ca),ya=t(Aa),pa=t(ya),Ia=t(pa);a(pa),a(ya);var Va=r(ya,2),Ca=t(Va),ot=t(Ca),Ct=t(ot),Dt=t(Ct,!0);a(Ct),a(ot),a(Ca);var Ot=r(Ca,2);a(Va),a(Aa);var rt=r(Aa,2),At=t(rt),Ua=t(At),it=t(Ua,!0);a(Ua);var mt=r(Ua,2),Pt=t(mt,!0);a(mt),a(At);var Ut=r(At,2),Rt=r(t(Ut),2),Qt=t(Rt);a(Rt),a(Ut);var os=r(Ut,2);{var vs=zt=>{var Kt=cu(),ds=r(t(Kt),2),ys=t(ds,!0);a(ds),a(Kt),b(()=>o(ys,(e(pe),l(()=>e(pe).advisorySection||"No advisory section assigned")))),i(zt,Kt)};m(os,zt=>{e(pe),l(()=>e(pe).type==="Teacher")&&zt(vs)})}var es=r(os,2);{var ss=zt=>{var Kt=vu(),ds=r(t(Kt),2),ys=t(ds);a(ds),a(Kt),b(()=>o(ys,`Grade ${e(pe),l(()=>e(pe).gradeLevel)??""}`)),i(zt,Kt)};m(es,zt=>{e(pe),l(()=>e(pe).type==="Student"&&e(pe).gradeLevel)&&zt(ss)})}var hs=r(es,2);{var Ss=zt=>{var Kt=uu(),ds=r(t(Kt),2),ys=t(ds);a(ds),a(Kt),b(()=>o(ys,`Age: ${e(pe),l(()=>e(pe).age)??""}`)),i(zt,Kt)};m(hs,zt=>{e(pe),l(()=>e(pe).type==="Student"&&e(pe).age)&&zt(Ss)})}var bs=r(hs,2);{var Es=zt=>{var Kt=mu(),ds=r(t(Kt),2),ys=t(ds);a(ds),a(Kt),b(()=>o(ys,`Guardian: ${e(pe),l(()=>e(pe).guardian)??""}`)),i(zt,Kt)};m(bs,zt=>{e(pe),l(()=>e(pe).type==="Student"&&e(pe).guardian)&&zt(Es)})}var Ns=r(bs,2);{var Ar=zt=>{var Kt=pu(),ds=r(t(Kt),2),ys=t(ds);a(ds),a(Kt),b(()=>o(ys,`Contact: ${e(pe),l(()=>e(pe).contactNumber)??""}`)),i(zt,Kt)};m(Ns,zt=>{e(pe),l(()=>e(pe).type==="Student"&&e(pe).contactNumber)&&zt(Ar)})}var ar=r(Ns,2),Ys=r(t(ar),2),tr=t(Ys);a(Ys),a(ar);var mr=r(ar,2),Ws=r(t(mr),2),sr=t(Ws);a(Ws),a(mr),a(rt);var Tr=r(rt,2);{var Nr=zt=>{var Kt=bu(),ds=t(Kt),ys=r(t(ds),2),Hs=t(ys),Qs=t(Hs),Bs=t(Qs),Js=r(Bs,2);Xa(Js),a(Qs);var rr=r(Qs,2),pr=t(rr),It=r(pr,2);Xa(It),a(rr);var Vt=r(rr,2),rs=t(Vt),_s=r(rs,2);Xa(_s),a(Vt),a(Hs);var xs=r(Hs,2);{var $s=as=>{var Ms=hu(),Cr=va(Ms),Or=t(Cr),jr=r(Or,2);let Vr;var zs=t(jr);let Ur;var gi=t(zs);{var hi=ts=>{var ws=fu(),Cs=t(ws),gr=t(Cs,!0);a(Cs);var Ks=r(Cs,2),hr=t(Ks),br=t(hr,!0);a(hr),a(Ks),a(ws),b(()=>{o(gr,(e(N),l(()=>e(N).icon))),o(br,(e(N),l(()=>e(N).name)))}),i(ts,ws)},bi=ts=>{var ws=_u();i(ts,ws)};m(gi,ts=>{e(N)?ts(hi):ts(bi,!1)})}et(2),a(zs);var Yr=r(zs,2);xa(Yr,5,()=>j,ts=>ts.id,(ts,ws)=>{var Cs=gu();let gr;var Ks=t(Cs),hr=t(Ks,!0);a(Ks);var br=r(Ks,2),ei=t(br),yi=t(ei,!0);a(ei),a(br),a(Cs),b(wi=>{gr=Z(Cs,1,"dropdown-option",null,gr,wi),o(hr,(e(ws),l(()=>e(ws).icon))),o(yi,(e(ws),l(()=>e(ws).name)))},[()=>({selected:e(Ke)===e(ws).id})]),R("click",Cs,()=>ie(e(ws))),i(ts,Cs)}),a(Yr),a(jr),a(Cr);var Wr=r(Cr,2),Er=r(t(Wr),4),qr=t(Er),Hr=t(qr),nr=r(Hr,2);Xa(nr),a(qr);var Qr=r(qr,2),Br=t(Qr),Fr=r(Br,2);Xa(Fr),a(Qr),a(Er);var Lr=r(Er,2),Jr=t(Lr),Ir=r(Jr,2);Sr(Ir),a(Lr);var zr=r(Lr,2),Pr=t(zr),Kr=t(Pr),Gr=r(Kr,2);Xa(Gr),a(Pr);var Zr=r(Pr,2),Xr=t(Zr),_r=r(Xr,2);Xa(_r),a(Zr),a(zr),a(Wr),b((ts,ws,Cs)=>{Fa(Or,"for",`edit-grade-level-${e(pe),l(()=>e(pe).id)??""}`),Vr=Z(jr,1,"custom-dropdown",null,Vr,ts),Ur=Z(zs,1,"dropdown-trigger",null,Ur,ws),Fa(zs,"id",`edit-grade-level-${e(pe),l(()=>e(pe).id)??""}`),Fa(Hr,"for",`edit-birthdate-${e(pe),l(()=>e(pe).id)??""}`),Fa(nr,"id",`edit-birthdate-${e(pe),l(()=>e(pe).id)??""}`),Fa(nr,"max",Cs),Fa(Br,"for",`edit-age-${e(pe),l(()=>e(pe).id)??""}`),Fa(Fr,"id",`edit-age-${e(pe),l(()=>e(pe).id)??""}`),vr(Fr,e(We)),Fa(Jr,"for",`edit-address-${e(pe),l(()=>e(pe).id)??""}`),Fa(Ir,"id",`edit-address-${e(pe),l(()=>e(pe).id)??""}`),Fa(Kr,"for",`edit-guardian-${e(pe),l(()=>e(pe).id)??""}`),Fa(Gr,"id",`edit-guardian-${e(pe),l(()=>e(pe).id)??""}`),Fa(Xr,"for",`edit-contact-number-${e(pe),l(()=>e(pe).id)??""}`),Fa(_r,"id",`edit-contact-number-${e(pe),l(()=>e(pe).id)??""}`)},[()=>({open:e(z)}),()=>({selected:e(Ke)}),()=>l(sa)]),R("click",zs,I),tt(nr,()=>e(Qe),ts=>s(Qe,ts)),R("blur",nr,ts=>{e(Qe)&&!He(e(Qe))&&(ye.error("Invalid date. Please enter a valid date."),s(Qe,""),ts.target.value="")}),tt(Ir,()=>e(we),ts=>s(we,ts)),tt(Gr,()=>e(ze),ts=>s(ze,ts)),tt(_r,()=>e(Be),ts=>s(Be,ts)),R("input",_r,ts=>_a(ts,!0)),i(as,Ms)};m(xs,as=>{e(pe),l(()=>e(pe).type.toLowerCase()==="student")&&as($s)})}var Rs=r(xs,2),qs=t(Rs),ir=t(qs);a(qs);var Ps=r(qs,2);let fr;var Vs=t(Ps);{var $r=as=>{var Ms=$t("Updating...");i(as,Ms)},_i=as=>{var Ms=$t("Update Account");i(as,Ms)};m(Vs,as=>{e(Ne)?as($r):as(_i,!1)})}a(Ps),a(Rs),a(ys),a(ds),a(Kt),b((as,Ms)=>{Fa(Bs,"for",`edit-last-name-${e(pe),l(()=>e(pe).id)??""}`),Fa(Js,"id",`edit-last-name-${e(pe),l(()=>e(pe).id)??""}`),Fa(pr,"for",`edit-first-name-${e(pe),l(()=>e(pe).id)??""}`),Fa(It,"id",`edit-first-name-${e(pe),l(()=>e(pe).id)??""}`),Fa(rs,"for",`edit-middle-initial-${e(pe),l(()=>e(pe).id)??""}`),Fa(_s,"id",`edit-middle-initial-${e(pe),l(()=>e(pe).id)??""}`),Fa(qs,"href",`#account-card-${e(pe),l(()=>e(pe).id)??""}`),fr=Z(Ps,1,"account-submit-button",null,fr,as),Ps.disabled=Ms},[()=>({loading:e(Ne)}),()=>(e(Ne),e(Te),e(Oe),e(f),e(Qe),e(we),e(ze),e(Be),l(()=>e(Ne)||!e(Te)||!e(Oe)||e(f)&&e(f).type.toLowerCase()==="student"&&(!e(Qe)||!e(we)||!e(ze)||!e(Be))))]),tt(Js,()=>e(Oe),as=>s(Oe,as)),R("input",Js,as=>ge(as,"lastName",!0)),tt(It,()=>e(Te),as=>s(Te,as)),R("input",It,as=>ge(as,"firstName",!0)),tt(_s,()=>e(ea),as=>s(ea,as)),R("input",_s,as=>ge(as,"middleInitial",!0)),R("click",ir,()=>$e(e(pe))),R("submit",ys,ks(te)),i(zt,Kt)};m(Tr,zt=>{e(re),e(pe),l(()=>e(re)===e(pe).id)&&zt(Nr)})}a(ca),b(()=>{Fa(ca,"id",`account-card-${e(pe),l(()=>e(pe).id)??""}`),o(Ia,`${e(pe),l(()=>e(pe).name)??""} Â· ${e(pe),l(()=>e(pe).type)??""}`),Fa(Ca,"href",`#account-card-${e(pe),l(()=>e(pe).id)??""}`),Fa(ot,"title",(e(re),e(pe),l(()=>e(re)===e(pe).id?"Cancel Edit":"Edit Account"))),o(Dt,(e(re),e(pe),l(()=>e(re)===e(pe).id?"close":"edit"))),o(it,(e(pe),l(()=>e(pe).type==="Student"?"school":e(pe).type==="Teacher"?"person":"admin_panel_settings"))),o(Pt,(e(pe),l(()=>e(pe).number))),o(Qt,`${e(pe),l(()=>e(pe).type)??""} Account`),o(tr,`Created: ${e(pe),l(()=>e(pe).createdDate)??""}`),o(sr,`Updated: ${e(pe),l(()=>e(pe).updatedDate)??""}`)}),R("click",ot,()=>$e(e(pe))),R("click",Ot,()=>de(e(pe))),i($a,ca)},$a=>{var pe=xu(),ca=r(t(pe),2);{var Aa=pa=>{var Ia=wu();i(pa,Ia)},ya=pa=>{var Ia=Su();i(pa,Ia)};m(ca,pa=>{e(K),l(()=>e(K).length===0)?pa(Aa):pa(ya,!1)})}a(pe),i($a,pe)}),i(G,be)};m(Ft,G=>{e(ke)?G(Lt):G(Ht,!1)})}a(Gt),a(qa),a(Ga),b((G,be,ra,$a,pe,ca,Aa)=>{ia=Z(qe,1,"custom-dropdown",null,ia,G),Ra=Z(na,1,"dropdown-trigger",null,Ra,be),La=Z(ka,1,"custom-dropdown",null,La,ra),oe=Z(Ya,1,"dropdown-trigger",null,oe,$a),o(za,e(D)==="student"?"Student Number":e(D)==="teacher"?"Teacher Number":e(D)==="admin"?"Admin Number":"Account Number"),Wa=Z(nt,1,"account-create-button",null,Wa,pe),nt.disabled=e(q)||!e(D)||!e(P)||!e(ee)||!e(H)||(e(D)==="student"||e(D)==="teacher")&&(!e(A)||e(M)||e(ae))||e(D)==="student"&&(!e(ue)||!e(S)||!e(y)||!e(ce)),Ka=Z(wt,1,"custom-dropdown",null,Ka,ca),gt=Z(Qa,1,"dropdown-trigger filter-trigger",null,gt,Aa)},[()=>({open:e(le)}),()=>({selected:e(D)}),()=>({open:e(Ce)}),()=>({selected:e(P)}),()=>({loading:e(q)}),()=>({open:e(Me)}),()=>({selected:e(Ae)!=="all"})]),R("click",na,T),R("click",Ya,$),tt(ma,()=>e(H),G=>s(H,G)),R("input",ma,G=>ge(G,"lastName")),tt(ne,()=>e(ee),G=>s(ee,G)),R("input",ne,G=>ge(G,"firstName")),tt(Ea,()=>e(U),G=>s(U,G)),R("input",Ea,G=>ge(G,"middleInitial")),R("submit",F,ks(Ve)),tt(Ha,()=>e(la),G=>s(la,G)),R("click",Qa,se),i(V,Ga),Wt(),w()}var Au=n('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Tu=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <span class="option-name"> </span></div>'),Nu=n('<span class="placeholder">All Grade Levels</span>'),$u=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Cu=n('<div class="selected-option"><span class="option-name"> </span></div>'),ju=n('<span class="placeholder">All Sections</span>'),Eu=n('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),qu=n('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Fu=n('<div class="masterlist-loading-container"><span class="student-loader"></span> <p class="masterlist-loading-text">Loading students...</p></div>'),Lu=n('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),Iu=n('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Pu=n('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),Gu=n('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Ru=n('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),Mu=n('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),Ou=n('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Vu=n('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),Uu=n('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Student"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),Yu=n('<div class="students-grid"></div>'),Wu=n('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p></div>'),Hu=n('<div class="student-masterlist-container"><div class="admin-student-header"><div class="header-content"><h1 class="page-title">Student Masterlist</h1> <p class="page-subtitle">View and manage all student records in the system</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="students-list-section"><!></div></div>');function Qu(V,d){Yt(d,!1);const _=h(),w=h();let v=[],f=h([]),p=h(!0),g=h(""),C=h(""),k=h(""),N=h(!1),E=h(!1);const q=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let D=h([{id:"",name:"All Sections"}]);async function P(){s(p,!0);try{const c=await lt.get("/api/accounts?type=student");if(!c.success)throw new Error("Failed to load students");v=c.accounts.map(u=>({id:u.id,name:u.name,number:u.number,email:u.email,gradeLevel:u.gradeLevel||"Not specified",section:u.section||"Not specified",birthdate:u.birthdate||"Not specified",address:u.address||"Not specified",guardian:u.guardian||"Not specified",contactNumber:u.contactNumber||"Not specified",status:u.status||"active"})),ee()}catch(c){console.error("Error loading students:",c),ye.error("Failed to load students. Please try again."),v=[]}finally{s(p,!1)}}async function Y(){try{const c=await lt.get("/api/sections");if(c.success&&c.data){const u=c.data.map(j=>({id:j.name,name:j.name}));s(D,[{id:"",name:"All Sections"},...u])}}catch(c){console.error("Error loading sections:",c)}}function ee(){s(f,v.filter(c=>{const u=!e(g)||c.name.toLowerCase().includes(e(g).toLowerCase())||c.email.toLowerCase().includes(e(g).toLowerCase())||c.number&&c.number.toLowerCase().includes(e(g).toLowerCase()),j=!e(C)||c.gradeLevel===e(C),K=!e(k)||c.section===e(k);return u&&j&&K}))}function H(){s(N,!e(N)),s(E,!1)}function U(){s(E,!e(E)),s(N,!1)}function A(c){s(C,c.id),s(N,!1),ee()}function M(c){s(k,c.id),s(E,!1),ee()}function ae(c){if(!c)return"N/A";const u=new Date,j=new Date(c);let K=u.getFullYear()-j.getFullYear();const ke=u.getMonth()-j.getMonth();return(ke<0||ke===0&&u.getDate()<j.getDate())&&K--,K}function Se(c){return c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function B(){s(g,""),s(C,""),s(k,""),ee()}function ue(c){c.target.closest(".custom-dropdown")||(s(N,!1),s(E,!1))}async function S(c,u){is.confirm("Archive Student",`Are you sure you want to archive ${u}? This action will move the student to the archived list.`,async()=>{try{const j=await lt.patch("/api/accounts",{id:c,action:"archive"});j.success?(ye.success(j.message),await P()):ye.error(j.message||"Failed to archive student")}catch(j){console.error("Error archiving student:",j),ye.error("Failed to archive student. Please try again.")}},()=>{})}Bt(()=>(Y(),P(),document.addEventListener("click",ue),()=>{document.removeEventListener("click",ue)})),at(()=>e(C),()=>{s(_,q.find(c=>c.id===e(C)))}),at(()=>(e(D),e(k)),()=>{s(w,e(D).find(c=>c.id===e(k)))}),at(()=>e(g),()=>{e(g)!==void 0&&ee()}),ps(),cs();var y=Hu(),ce=r(t(y),2),ve=t(ce),le=t(ve),Ce=t(le),me=r(t(Ce),2);Xa(me);var Me=r(me,2);{var Ae=c=>{var u=Au();R("click",u,()=>s(g,"")),i(c,u)};m(Me,c=>{e(g)&&c(Ae)})}a(Ce),a(le);var re=r(le,2),Te=t(re),Oe=r(t(Te),2);let ea;var Ke=t(Oe),z=t(Ke);{var Ne=c=>{var u=Tu(),j=t(u),K=t(j,!0);a(j);var ke=r(j,2),Pe=t(ke,!0);a(ke),a(u),b(()=>{o(K,(e(_),l(()=>e(_).icon))),o(Pe,(e(_),l(()=>e(_).name)))}),i(c,u)},Qe=c=>{var u=Nu();i(c,u)};m(z,c=>{e(_)&&e(C)?c(Ne):c(Qe,!1)})}et(2),a(Ke);var we=r(Ke,2);xa(we,5,()=>q,c=>c.id,(c,u)=>{var j=$u();let K;var ke=t(j),Pe=t(ke,!0);a(ke);var de=r(ke,2),$e=t(de),te=t($e,!0);a($e),a(de),a(j),b(T=>{K=Z(j,1,"dropdown-option",null,K,T),o(Pe,(e(u),l(()=>e(u).icon))),o(te,(e(u),l(()=>e(u).name)))},[()=>({selected:e(C)===e(u).id})]),R("click",j,()=>A(e(u))),i(c,j)}),a(we),a(Oe),a(Te);var ze=r(Te,2),Be=r(t(ze),2);let We;var sa=t(Be),xe=t(sa);{var ge=c=>{var u=Cu(),j=t(u),K=t(j,!0);a(j),a(u),b(()=>o(K,(e(w),l(()=>e(w).name)))),i(c,u)},Ie=c=>{var u=ju();i(c,u)};m(xe,c=>{e(w)&&e(k)?c(ge):c(Ie,!1)})}et(2),a(sa);var fa=r(sa,2);xa(fa,5,()=>e(D),c=>c.id,(c,u)=>{var j=Eu();let K;var ke=t(j),Pe=t(ke),de=t(Pe,!0);a(Pe),a(ke),a(j),b($e=>{K=Z(j,1,"dropdown-option",null,K,$e),o(de,(e(u),l(()=>e(u).name)))},[()=>({selected:e(k)===e(u).id})]),R("click",j,()=>M(e(u))),i(c,j)}),a(fa),a(Be),a(ze);var _a=r(ze,2);{var Je=c=>{var u=qu();R("click",u,B),i(c,u)};m(_a,c=>{(e(g)||e(C)||e(k))&&c(Je)})}a(re),a(ve),a(ce);var Re=r(ce,2),He=t(Re);{var la=c=>{var u=Fu();i(c,u)},aa=c=>{var u=ja(),j=va(u);{var K=Pe=>{var de=Yu();xa(de,5,()=>e(f),$e=>$e.id,($e,te)=>{var T=Uu(),x=t(T),$=t(x),Q=t($),X=t(Q);{var Le=Ue=>{var Fe=$t();b(()=>o(Fe,(e(te),l(()=>e(te).number)))),i(Ue,Fe)};m(X,Ue=>{e(te),l(()=>e(te).number)&&Ue(Le)})}var I=r(X);a(Q),a($);var ie=r($,2),se=t(ie);a(ie),a(x);var Ge=r(x,2),Ve=t(Ge);{var Ze=Ue=>{var Fe=Lu(),Ma=r(t(Fe),2),dt=t(Ma,!0);a(Ma),a(Fe),b(()=>o(dt,(e(te),l(()=>e(te).email)))),i(Ue,Fe)};m(Ve,Ue=>{e(te),l(()=>e(te).email)&&Ue(Ze)})}var Ye=r(Ve,2);{var ga=Ue=>{var Fe=Iu(),Ma=r(t(Fe),2),dt=t(Ma,!0);a(Ma),a(Fe),b(ha=>o(dt,ha),[()=>(e(te),l(()=>q.find(ha=>ha.id===e(te).gradeLevel)?.name||e(te).gradeLevel))]),i(Ue,Fe)};m(Ye,Ue=>{e(te),l(()=>e(te).gradeLevel&&e(te).gradeLevel!=="Not specified")&&Ue(ga)})}var da=r(Ye,2);{var Oa=Ue=>{var Fe=Pu(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(ha=>o(dt,`Section: ${ha??""}`),[()=>(e(D),e(te),l(()=>e(D).find(ha=>ha.id===e(te).section)?.name||e(te).section))]),i(Ue,Fe)};m(da,Ue=>{e(te),l(()=>e(te).section&&e(te).section!=="Not specified")&&Ue(Oa)})}var Ga=r(da,2);{var fe=Ue=>{var Fe=Gu(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(ha=>o(dt,`Age: ${ha??""} years old`),[()=>(e(te),l(()=>ae(e(te).birthdate)))]),i(Ue,Fe)};m(Ga,Ue=>{e(te),l(()=>e(te).birthdate&&e(te).birthdate!=="Not specified")&&Ue(fe)})}var O=r(Ga,2);{var F=Ue=>{var Fe=Ru(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(()=>o(dt,`Guardian: ${e(te),l(()=>e(te).guardian)??""}`)),i(Ue,Fe)};m(O,Ue=>{e(te),l(()=>e(te).guardian&&e(te).guardian!=="Not specified")&&Ue(F)})}var J=r(O,2);{var _e=Ue=>{var Fe=Mu(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(()=>o(dt,`Contact: ${e(te),l(()=>e(te).contactNumber)??""}`)),i(Ue,Fe)};m(J,Ue=>{e(te),l(()=>e(te).contactNumber&&e(te).contactNumber!=="Not specified")&&Ue(_e)})}var qe=r(J,2);{var ia=Ue=>{var Fe=Ou(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(()=>o(dt,`Address: ${e(te),l(()=>e(te).address)??""}`)),i(Ue,Fe)};m(qe,Ue=>{e(te),l(()=>e(te).address&&e(te).address!=="Not specified")&&Ue(ia)})}var na=r(qe,2);{var Ra=Ue=>{var Fe=Vu(),Ma=r(t(Fe),2),dt=t(Ma);a(Ma),a(Fe),b(ha=>o(dt,`Birthdate: ${ha??""}`),[()=>(e(te),l(()=>Se(e(te).birthdate)))]),i(Ue,Fe)};m(na,Ue=>{e(te),l(()=>e(te).birthdate&&e(te).birthdate!=="Not specified")&&Ue(Ra)})}a(Ge),a(T),b(()=>o(I,` Â· ${e(te),l(()=>e(te).name)??""}`)),R("click",se,()=>S(e(te).id,e(te).name)),i($e,T)}),a(de),i(Pe,de)},ke=Pe=>{var de=Wu(),$e=t(de),te=t($e,!0);a($e);var T=r($e,2),x=t(T);{var $=X=>{var Le=$t("No students found matching your search criteria.");i(X,Le)},Q=X=>{var Le=$t("No students found in the system.");i(X,Le)};m(x,X=>{e(g)||e(C)||e(k)?X($):X(Q,!1)})}a(T),a(de),b(()=>o(te,e(g)||e(C)||e(k)?"search_off":"school")),i(Pe,de)};m(j,Pe=>{e(f),l(()=>e(f).length>0)?Pe(K):Pe(ke,!1)},!0)}i(c,u)};m(He,c=>{e(p)?c(la):c(aa,!1)})}a(Re),a(y),b((c,u)=>{ea=Z(Oe,1,"custom-dropdown",null,ea,c),We=Z(Be,1,"custom-dropdown",null,We,u)},[()=>({open:e(N)}),()=>({open:e(E)})]),tt(me,()=>e(g),c=>s(g,c)),R("click",Ke,H),R("click",sa,U),i(V,y),Wt()}var Bu=n('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Ju=n('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),zu=n('<span class="aas-placeholder">All Grade Levels</span>'),Ku=n('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),Zu=n('<div class="aas-selected-option"><span class="aas-option-name"> </span></div>'),Xu=n('<span class="aas-placeholder">All Sections</span>'),em=n('<button type="button"><div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),am=n('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),tm=n('<div class="aas-loading-container"><span class="aas-student-loader"></span> <p class="aas-loading-text">Loading archived students...</p></div>'),sm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),rm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),im=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),nm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),om=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),lm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),dm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),cm=n('<div class="aas-account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),vm=n('<div class="aas-account-card"><div class="aas-account-card-header"><div class="aas-account-title"><h3 class="aas-account-name"><!> </h3> <div class="aas-archived-badge"><span class="material-symbols-outlined">archive</span> <span> </span></div></div> <div class="aas-action-buttons"><button type="button" class="aas-restore-button" title="Restore Student"><span class="material-symbols-outlined">unarchive</span></button></div></div> <div class="aas-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),um=n('<div class="aas-students-grid"></div>'),mm=n('<button type="button" class="aas-clear-search-button-inline">Clear</button>'),pm=n('<div class="aas-no-results"><span class="material-symbols-outlined aas-no-results-icon"> </span> <p><!></p> <!></div>'),fm=n('<div class="aas-archived-students-container"><div class="aas-admin-student-header"><div class="aas-header-content"><h1 class="aas-page-title">Archived Students</h1> <p class="aas-page-subtitle">View and manage archived student records</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search archived students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <!></div></div></div> <div class="aas-students-list-section"><!></div></div>');function _m(V,d){Yt(d,!1);const _=h(),w=h();let v=[],f=h([]),p=h(!0),g=h(""),C=h(""),k=h(""),N=h(!1),E=h(!1);const q=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let D=h([{id:"",name:"All Sections"}]);async function P(){s(p,!0);try{const u=await lt.get("/api/archived-students");if(!u.students)throw new Error("No students data received");v=u.students.map(j=>({id:j.id,name:j.name,number:j.number,email:j.email,gradeLevel:j.gradeLevel||"Not specified",section:j.section||"Not specified",birthdate:j.birthdate||"Not specified",address:j.address||"Not specified",guardian:j.guardian||"Not specified",contactNumber:j.contactNumber||"Not specified",archivedDate:j.archivedDate||"Not specified"})),ee()}catch(u){console.error("Error loading archived students:",u),ye.error("Failed to load archived students. Please try again."),v=[]}finally{s(p,!1)}}async function Y(){try{const u=await lt.get("/api/sections");if(u.success&&u.data){const j=u.data.map(K=>({id:K.name,name:K.name}));s(D,[{id:"",name:"All Sections"},...j])}}catch(u){console.error("Error loading sections:",u)}}function ee(){s(f,v.filter(u=>{const j=!e(g)||u.name.toLowerCase().includes(e(g).toLowerCase())||u.email.toLowerCase().includes(e(g).toLowerCase())||u.number&&u.number.toLowerCase().includes(e(g).toLowerCase()),K=!e(C)||u.gradeLevel===e(C),ke=!e(k)||u.section===e(k);return j&&K&&ke}))}function H(){s(N,!e(N)),s(E,!1)}function U(){s(E,!e(E)),s(N,!1)}function A(u){s(C,u.id),s(N,!1),ee()}function M(u){s(k,u.id),s(E,!1),ee()}function ae(u){if(!u)return"N/A";const j=new Date,K=new Date(u);let ke=j.getFullYear()-K.getFullYear();const Pe=j.getMonth()-K.getMonth();return(Pe<0||Pe===0&&j.getDate()<K.getDate())&&ke--,ke}function Se(u){return u?new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function B(u){return u?new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}async function ue(u,j){is.confirm("Restore Student",`Are you sure you want to restore ${j}? This action will move the student back to the active list.`,async()=>{try{const K=await lt.put("/api/archived-students",{id:u});ye.success(K.message||"Student restored successfully"),await P()}catch(K){console.error("Error restoring student:",K),ye.error(K.message||"Failed to restore student. Please try again.")}},()=>{})}function S(){s(g,""),s(C,""),s(k,""),ee()}function y(u){u.target.closest(".aas-custom-dropdown")||(s(N,!1),s(E,!1))}Bt(()=>(Y(),P(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)})),at(()=>e(C),()=>{s(_,q.find(u=>u.id===e(C)))}),at(()=>(e(D),e(k)),()=>{s(w,e(D).find(u=>u.id===e(k)))}),at(()=>e(g),()=>{e(g)!==void 0&&ee()}),ps(),cs();var ce=fm(),ve=r(t(ce),2),le=t(ve),Ce=t(le),me=t(Ce),Me=r(t(me),2);Xa(Me);var Ae=r(Me,2);{var re=u=>{var j=Bu();R("click",j,()=>s(g,"")),i(u,j)};m(Ae,u=>{e(g)&&u(re)})}a(me),a(Ce);var Te=r(Ce,2),Oe=t(Te),ea=r(t(Oe),2);let Ke;var z=t(ea),Ne=t(z);{var Qe=u=>{var j=Ju(),K=t(j),ke=t(K,!0);a(K);var Pe=r(K,2),de=t(Pe,!0);a(Pe),a(j),b(()=>{o(ke,(e(_),l(()=>e(_).icon))),o(de,(e(_),l(()=>e(_).name)))}),i(u,j)},we=u=>{var j=zu();i(u,j)};m(Ne,u=>{e(_)&&e(C)?u(Qe):u(we,!1)})}et(2),a(z);var ze=r(z,2);xa(ze,5,()=>q,u=>u.id,(u,j)=>{var K=Ku();let ke;var Pe=t(K),de=t(Pe,!0);a(Pe);var $e=r(Pe,2),te=t($e),T=t(te,!0);a(te),a($e),a(K),b(x=>{ke=Z(K,1,"aas-dropdown-option",null,ke,x),o(de,(e(j),l(()=>e(j).icon))),o(T,(e(j),l(()=>e(j).name)))},[()=>({selected:e(C)===e(j).id})]),R("click",K,()=>A(e(j))),i(u,K)}),a(ze),a(ea),a(Oe);var Be=r(Oe,2),We=r(t(Be),2);let sa;var xe=t(We),ge=t(xe);{var Ie=u=>{var j=Zu(),K=t(j),ke=t(K,!0);a(K),a(j),b(()=>o(ke,(e(w),l(()=>e(w).name)))),i(u,j)},fa=u=>{var j=Xu();i(u,j)};m(ge,u=>{e(w)&&e(k)?u(Ie):u(fa,!1)})}et(2),a(xe);var _a=r(xe,2);xa(_a,5,()=>e(D),u=>u.id,(u,j)=>{var K=em();let ke;var Pe=t(K),de=t(Pe),$e=t(de,!0);a(de),a(Pe),a(K),b(te=>{ke=Z(K,1,"aas-dropdown-option",null,ke,te),o($e,(e(j),l(()=>e(j).name)))},[()=>({selected:e(k)===e(j).id})]),R("click",K,()=>M(e(j))),i(u,K)}),a(_a),a(We),a(Be);var Je=r(Be,2);{var Re=u=>{var j=am();R("click",j,S),i(u,j)};m(Je,u=>{(e(g)||e(C)||e(k))&&u(Re)})}a(Te),a(le),a(ve);var He=r(ve,2),la=t(He);{var aa=u=>{var j=tm();i(u,j)},c=u=>{var j=ja(),K=va(j);{var ke=de=>{var $e=um();xa($e,5,()=>e(f),te=>te.id,(te,T)=>{var x=vm(),$=t(x),Q=t($),X=t(Q),Le=t(X);{var I=ha=>{var ka=$t();b(()=>o(ka,(e(T),l(()=>e(T).number)))),i(ha,ka)};m(Le,ha=>{e(T),l(()=>e(T).number)&&ha(I)})}var ie=r(Le);a(X);var se=r(X,2),Ge=r(t(se),2),Ve=t(Ge);a(Ge),a(se),a(Q);var Ze=r(Q,2),Ye=t(Ze);a(Ze),a($);var ga=r($,2),da=t(ga);{var Oa=ha=>{var ka=sm(),La=r(t(ka),2),Ya=t(La,!0);a(La),a(ka),b(()=>o(Ya,(e(T),l(()=>e(T).email)))),i(ha,ka)};m(da,ha=>{e(T),l(()=>e(T).email)&&ha(Oa)})}var Ga=r(da,2);{var fe=ha=>{var ka=rm(),La=r(t(ka),2),Ya=t(La,!0);a(La),a(ka),b(oe=>o(Ya,oe),[()=>(e(T),l(()=>q.find(oe=>oe.id===e(T).gradeLevel)?.name||e(T).gradeLevel))]),i(ha,ka)};m(Ga,ha=>{e(T),l(()=>e(T).gradeLevel&&e(T).gradeLevel!=="Not specified")&&ha(fe)})}var O=r(Ga,2);{var F=ha=>{var ka=im(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(oe=>o(Ya,`Section: ${oe??""}`),[()=>(e(D),e(T),l(()=>e(D).find(oe=>oe.id===e(T).section)?.name||e(T).section))]),i(ha,ka)};m(O,ha=>{e(T),l(()=>e(T).section&&e(T).section!=="Not specified")&&ha(F)})}var J=r(O,2);{var _e=ha=>{var ka=nm(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(oe=>o(Ya,`Age: ${oe??""} years old`),[()=>(e(T),l(()=>ae(e(T).birthdate)))]),i(ha,ka)};m(J,ha=>{e(T),l(()=>e(T).birthdate&&e(T).birthdate!=="Not specified")&&ha(_e)})}var qe=r(J,2);{var ia=ha=>{var ka=om(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(()=>o(Ya,`Guardian: ${e(T),l(()=>e(T).guardian)??""}`)),i(ha,ka)};m(qe,ha=>{e(T),l(()=>e(T).guardian&&e(T).guardian!=="Not specified")&&ha(ia)})}var na=r(qe,2);{var Ra=ha=>{var ka=lm(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(()=>o(Ya,`Contact: ${e(T),l(()=>e(T).contactNumber)??""}`)),i(ha,ka)};m(na,ha=>{e(T),l(()=>e(T).contactNumber&&e(T).contactNumber!=="Not specified")&&ha(Ra)})}var Ue=r(na,2);{var Fe=ha=>{var ka=dm(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(()=>o(Ya,`Address: ${e(T),l(()=>e(T).address)??""}`)),i(ha,ka)};m(Ue,ha=>{e(T),l(()=>e(T).address&&e(T).address!=="Not specified")&&ha(Fe)})}var Ma=r(Ue,2);{var dt=ha=>{var ka=cm(),La=r(t(ka),2),Ya=t(La);a(La),a(ka),b(oe=>o(Ya,`Birthdate: ${oe??""}`),[()=>(e(T),l(()=>Se(e(T).birthdate)))]),i(ha,ka)};m(Ma,ha=>{e(T),l(()=>e(T).birthdate&&e(T).birthdate!=="Not specified")&&ha(dt)})}a(ga),a(x),b(ha=>{o(ie,` Â· ${e(T),l(()=>e(T).name)??""}`),o(Ve,`Archived ${ha??""}`)},[()=>(e(T),l(()=>B(e(T).archivedDate)))]),R("click",Ye,()=>ue(e(T).id,e(T).name)),i(te,x)}),a($e),i(de,$e)},Pe=de=>{var $e=pm(),te=t($e),T=t(te,!0);a(te);var x=r(te,2),$=t(x);{var Q=ie=>{var se=$t("No archived students found matching your search criteria.");i(ie,se)},X=ie=>{var se=$t("No archived students found in the system.");i(ie,se)};m($,ie=>{e(g)||e(C)||e(k)?ie(Q):ie(X,!1)})}a(x);var Le=r(x,2);{var I=ie=>{var se=mm();R("click",se,S),i(ie,se)};m(Le,ie=>{(e(g)||e(C)||e(k))&&ie(I)})}a($e),b(()=>o(T,e(g)||e(C)||e(k)?"search_off":"archive")),i(de,$e)};m(K,de=>{e(f),l(()=>e(f).length>0)?de(ke):de(Pe,!1)},!0)}i(u,j)};m(la,u=>{e(p)?u(aa):u(c,!1)})}a(He),a(ce),b((u,j)=>{Ke=Z(ea,1,"aas-custom-dropdown",null,Ke,u),sa=Z(We,1,"aas-custom-dropdown",null,sa,j)},[()=>({open:e(N)}),()=>({open:e(E)})]),tt(Me,()=>e(g),u=>s(g,u)),R("click",z,H),R("click",xe,U),i(V,ce),Wt()}var gm=n('<button type="button" class="sgl-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),hm=n('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),bm=n('<span class="sgl-placeholder">All Grade Levels</span>'),ym=n('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),wm=n('<div class="sgl-selected-option"><span class="sgl-option-name"> </span></div>'),Sm=n('<span class="sgl-placeholder">All Sections</span>'),xm=n('<button type="button"><div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),km=n('<button type="button" class="sgl-clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Dm=n('<div class="sgl-masterlist-loading-container"><span class="sgl-student-loader"></span> <p class="sgl-masterlist-loading-text">Loading student grades...</p></div>'),Am=n('<div class="sgl-empty-state"><span class="material-symbols-outlined sgl-empty-icon">search_off</span> <h3 class="sgl-empty-title">No students found</h3> <p class="sgl-empty-description"><!></p></div>'),Tm=n('<tr><td class="sgl-student-id"> </td><td class="sgl-student-name"> </td><td class="sgl-year-level"> </td><td class="sgl-section"> </td><td class="sgl-gwa"> </td></tr>'),Nm=n('<div class="sgl-results-header"><p class="sgl-results-count"> </p></div> <div class="sgl-table-container"><table class="sgl-students-table"><thead><tr><th>Student ID</th><th>Name</th><th>Grade Level</th><th>Section</th><th>GWA</th></tr></thead><tbody></tbody></table></div>',1),$m=n('<div class="sgl-student-grades-container"><div class="sgl-admin-student-header"><div class="sgl-header-content"><h1 class="sgl-page-title">Student Grades List</h1> <p class="sgl-page-subtitle">View and manage student academic performance records</p></div></div> <div class="sgl-filters-section"><div class="sgl-search-filter-container"><div class="sgl-search-container"><div class="sgl-search-input-wrapper"><span class="material-symbols-outlined sgl-search-icon">search</span> <input type="text" class="sgl-search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="sgl-filter-container"><div class="sgl-filter-group"><label class="sgl-filter-label">Grade Level</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label">Section</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <!></div></div></div> <div class="sgl-results-section"><!></div></div>');function Cm(V,d){Yt(d,!1);const _=h(),w=h();let v=h([]),f=h([]),p=[],g=h(!0),C=h(""),k=h(""),N=h(""),E=h(!1),q=h(!1);const D=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let P=h([{id:"",name:"All Sections"}]);async function Y(){try{const c=await lt.get("/api/sections");if(c.success){p=c.data||[];const u=p.filter(j=>j.status==="active");s(P,[{id:"",name:"All Sections"},...u.map(j=>({id:j.name,name:`Grade ${j.grade_level} Â· ${j.name}`}))])}}catch(c){console.error("Error loading sections:",c),ye.error("Failed to load sections")}}async function ee(){s(g,!0);try{const c=await lt.get("/api/students-bulk");if(!c.success)throw new Error(c.error||"Failed to load students");s(v,c.students||[]),H()}catch(c){console.error("Error loading students:",c),ye.error("Failed to load students. Please try again."),s(v,[])}finally{s(g,!1)}}function H(){s(f,e(v).filter(c=>{const u=!e(C)||c.name.toLowerCase().includes(e(C).toLowerCase())||c.id.toString().toLowerCase().includes(e(C).toLowerCase()),j=!e(k)||c.gradeLevel===e(k),K=!e(N)||c.section===e(N);return u&&j&&K}))}function U(){s(E,!e(E)),s(q,!1)}function A(){s(q,!e(q)),s(E,!1)}function M(c){s(k,c.id),s(E,!1),H()}function ae(c){s(N,c.id),s(q,!1),H()}function Se(){H()}function B(){s(C,""),s(k,""),s(N,""),H()}function ue(c){return{7:"Grade 7",8:"Grade 8",9:"Grade 9",10:"Grade 10"}[c]||c}function S(c){c.target.closest(".sgl-custom-dropdown")||(s(E,!1),s(q,!1))}Bt(async()=>(await Y(),await ee(),document.addEventListener("click",S),()=>{document.removeEventListener("click",S)})),at(()=>e(k),()=>{s(_,D.find(c=>c.id===e(k)))}),at(()=>(e(P),e(N)),()=>{s(w,e(P).find(c=>c.id===e(N)))}),at(()=>e(C),()=>{e(C)!==void 0&&Se()}),ps(),cs();var y=$m(),ce=r(t(y),2),ve=t(ce),le=t(ve),Ce=t(le),me=r(t(Ce),2);Xa(me);var Me=r(me,2);{var Ae=c=>{var u=gm();R("click",u,()=>s(C,"")),i(c,u)};m(Me,c=>{e(C)&&c(Ae)})}a(Ce),a(le);var re=r(le,2),Te=t(re),Oe=r(t(Te),2);let ea;var Ke=t(Oe),z=t(Ke);{var Ne=c=>{var u=hm(),j=t(u),K=t(j,!0);a(j);var ke=r(j,2),Pe=t(ke,!0);a(ke),a(u),b(()=>{o(K,(e(_),l(()=>e(_).icon))),o(Pe,(e(_),l(()=>e(_).name)))}),i(c,u)},Qe=c=>{var u=bm();i(c,u)};m(z,c=>{e(_)&&e(k)?c(Ne):c(Qe,!1)})}et(2),a(Ke);var we=r(Ke,2);xa(we,5,()=>D,c=>c.id,(c,u)=>{var j=ym();let K;var ke=t(j),Pe=t(ke,!0);a(ke);var de=r(ke,2),$e=t(de),te=t($e,!0);a($e),a(de),a(j),b(T=>{K=Z(j,1,"sgl-dropdown-option",null,K,T),o(Pe,(e(u),l(()=>e(u).icon))),o(te,(e(u),l(()=>e(u).name)))},[()=>({selected:e(k)===e(u).id})]),R("click",j,()=>M(e(u))),i(c,j)}),a(we),a(Oe),a(Te);var ze=r(Te,2),Be=r(t(ze),2);let We;var sa=t(Be),xe=t(sa);{var ge=c=>{var u=wm(),j=t(u),K=t(j,!0);a(j),a(u),b(()=>o(K,(e(w),l(()=>e(w).name)))),i(c,u)},Ie=c=>{var u=Sm();i(c,u)};m(xe,c=>{e(w)&&e(N)?c(ge):c(Ie,!1)})}et(2),a(sa);var fa=r(sa,2);xa(fa,5,()=>e(P),c=>c.id,(c,u)=>{var j=xm();let K;var ke=t(j),Pe=t(ke),de=t(Pe,!0);a(Pe),a(ke),a(j),b($e=>{K=Z(j,1,"sgl-dropdown-option",null,K,$e),o(de,(e(u),l(()=>e(u).name)))},[()=>({selected:e(N)===e(u).id})]),R("click",j,()=>ae(e(u))),i(c,j)}),a(fa),a(Be),a(ze);var _a=r(ze,2);{var Je=c=>{var u=km();R("click",u,B),i(c,u)};m(_a,c=>{(e(C)||e(k)||e(N))&&c(Je)})}a(re),a(ve),a(ce);var Re=r(ce,2),He=t(Re);{var la=c=>{var u=Dm();i(c,u)},aa=c=>{var u=ja(),j=va(u);{var K=Pe=>{var de=Am(),$e=r(t(de),4),te=t($e);{var T=$=>{var Q=$t("Try adjusting your search criteria or filters.");i($,Q)},x=$=>{var Q=$t("No student records are available at the moment.");i($,Q)};m(te,$=>{e(C)||e(k)||e(N)?$(T):$(x,!1)})}a($e),a(de),i(Pe,de)},ke=Pe=>{var de=Nm(),$e=va(de),te=t($e),T=t(te);a(te),a($e);var x=r($e,2),$=t(x),Q=r(t($));xa(Q,5,()=>e(f),X=>X.id,(X,Le)=>{var I=Tm();let ie;var se=t(I),Ge=t(se,!0);a(se);var Ve=r(se),Ze=t(Ve,!0);a(Ve);var Ye=r(Ve),ga=t(Ye,!0);a(Ye);var da=r(Ye),Oa=t(da,!0);a(da);var Ga=r(da),fe=t(Ga,!0);a(Ga),a(I),b((O,F)=>{ie=Z(I,1,"sgl-student-row",null,ie,O),o(Ge,(e(Le),l(()=>e(Le).id))),o(Ze,(e(Le),l(()=>e(Le).name))),o(ga,F),o(Oa,(e(Le),l(()=>e(Le).section))),o(fe,(e(Le),l(()=>e(Le).gwa)))},[()=>({"low-gwa":e(Le).gwa<75}),()=>(e(Le),l(()=>ue(e(Le).gradeLevel)))]),i(X,I)}),a(Q),a($),a(x),b(()=>o(T,`Showing ${e(f),l(()=>e(f).length)??""} of ${e(v),l(()=>e(v).length)??""} students`)),i(Pe,de)};m(j,Pe=>{e(f),l(()=>e(f).length===0)?Pe(K):Pe(ke,!1)},!0)}i(c,u)};m(He,c=>{e(g)?c(la):c(aa,!1)})}a(Re),a(y),b((c,u)=>{ea=Z(Oe,1,"sgl-custom-dropdown",null,ea,c),We=Z(Be,1,"sgl-custom-dropdown",null,We,u)},[()=>({open:e(E)}),()=>({open:e(q)})]),tt(me,()=>e(C),c=>s(C,c)),R("click",Ke,U),R("click",sa,A),i(V,y),Wt()}var jm=n('<label class="time-input-label svelte-rxn8x9"> </label>'),Em=n('<span class="time-display svelte-rxn8x9"> </span>'),qm=n('<span class="time-placeholder svelte-rxn8x9"> </span>'),Fm=n('<button type="button"> </button>'),Lm=n('<button type="button"> </button>'),Im=n('<button type="button"> </button>'),Pm=n('<div class="time-dropdown-menu svelte-rxn8x9"><div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Hour</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Minute</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Period</div> <div class="time-options svelte-rxn8x9"></div></div></div>'),Gm=n('<div class="time-input-container svelte-rxn8x9"><!> <button type="button"><!> <span class="material-symbols-outlined time-dropdown-arrow svelte-rxn8x9">expand_more</span></button> <!></div>');function di(V,d){Yt(d,!1);const _=h();let w=qt(d,"value",8,""),v=qt(d,"placeholder",8,"Select time"),f=qt(d,"disabled",8,!1),p=qt(d,"label",8,""),g=qt(d,"isOpen",12,!1);const C=Di();let k=h(""),N=h(""),E=h("AM");const q=Array.from({length:12},(Ae,re)=>{const Te=re+1;return{value:Te.toString().padStart(2,"0"),label:Te.toString()}}),D=[{value:"00",label:"00"},{value:"15",label:"15"},{value:"30",label:"30"},{value:"45",label:"45"}],P=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}];function Y(Ae){if(!Ae){s(k,""),s(N,""),s(E,"AM");return}const re=Ae.split(":");let Te=parseInt(re[0]);const Oe=re[1]||"00";Te===0?(s(k,"12"),s(E,"AM")):Te<12?(s(k,Te.toString().padStart(2,"0")),s(E,"AM")):Te===12?(s(k,"12"),s(E,"PM")):(s(k,(Te-12).toString().padStart(2,"0")),s(E,"PM")),s(N,Oe)}function ee(){if(!e(k)||!e(N))return"";let Ae=parseInt(e(k));return e(E)==="AM"&&Ae===12?Ae=0:e(E)==="PM"&&Ae!==12&&(Ae+=12),`${Ae.toString().padStart(2,"0")}:${e(N)}`}function H(){const Ae=ee();Ae!==w()&&C("change",{value:Ae})}function U(Ae){s(k,Ae),H()}function A(Ae){s(N,Ae),H()}function M(Ae){s(E,Ae),H()}function ae(){f()||(g(!g()),g()&&C("open"))}function Se(Ae){Ae.target.closest(".time-input-container")||g(!1)}at(()=>us(w()),()=>{w()&&w()!==ee()&&Y(w())}),at(()=>(e(k),e(N),e(E)),()=>{s(_,e(k)&&e(N)?`${e(k)}:${e(N)} ${e(E)}`:"")}),ps(),cs();var B=Gm();R("click",Ts,Se);var ue=t(B);{var S=Ae=>{var re=jm(),Te=t(re,!0);a(re),b(()=>o(Te,p())),i(Ae,re)};m(ue,Ae=>{p()&&Ae(S)})}var y=r(ue,2);let ce;var ve=t(y);{var le=Ae=>{var re=Em(),Te=t(re,!0);a(re),b(()=>o(Te,e(_))),i(Ae,re)},Ce=Ae=>{var re=qm(),Te=t(re,!0);a(re),b(()=>o(Te,v())),i(Ae,re)};m(ve,Ae=>{e(_)?Ae(le):Ae(Ce,!1)})}et(2),a(y);var me=r(y,2);{var Me=Ae=>{var re=Pm(),Te=t(re),Oe=r(t(Te),2);xa(Oe,5,()=>q,Jt,(Qe,we)=>{var ze=Fm();let Be;var We=t(ze,!0);a(ze),b(sa=>{Be=Z(ze,1,"time-option svelte-rxn8x9",null,Be,sa),o(We,(e(we),l(()=>e(we).label)))},[()=>({selected:e(k)===e(we).value})]),R("click",ze,()=>U(e(we).value)),i(Qe,ze)}),a(Oe),a(Te);var ea=r(Te,2),Ke=r(t(ea),2);xa(Ke,5,()=>D,Jt,(Qe,we)=>{var ze=Lm();let Be;var We=t(ze,!0);a(ze),b(sa=>{Be=Z(ze,1,"time-option svelte-rxn8x9",null,Be,sa),o(We,(e(we),l(()=>e(we).label)))},[()=>({selected:e(N)===e(we).value})]),R("click",ze,()=>A(e(we).value)),i(Qe,ze)}),a(Ke),a(ea);var z=r(ea,2),Ne=r(t(z),2);xa(Ne,5,()=>P,Jt,(Qe,we)=>{var ze=Im();let Be;var We=t(ze,!0);a(ze),b(sa=>{Be=Z(ze,1,"time-option svelte-rxn8x9",null,Be,sa),o(We,(e(we),l(()=>e(we).label)))},[()=>({selected:e(E)===e(we).value})]),R("click",ze,()=>M(e(we).value)),i(Qe,ze)}),a(Ne),a(z),a(re),i(Ae,re)};m(me,Ae=>{g()&&Ae(Me)})}a(B),b(Ae=>{ce=Z(y,1,"time-input-trigger svelte-rxn8x9",null,ce,Ae),y.disabled=f()},[()=>({open:g(),selected:e(_),disabled:f()})]),R("click",y,ae),i(V,B),Wt()}var Rm=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span></div></div>'),Mm=n('<span class="placeholder">Select year level</span>'),Om=n('<button type="button"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),Vm=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span></div></div>'),Um=n('<span class="placeholder"> </span>'),Ym=n('<div class="admin-section-loading"><span class="section-loader"></span> <span>Loading sections...</span></div>'),Wm=n('<button type="button"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),Hm=n('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text">No sections available</span></div>'),Qm=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon"> </span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),Bm=n('<span class="scheduleassign-placeholder">Select Schedule Type</span>'),Jm=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),zm=n('<span class="scheduleassign-placeholder">Select Subject</span>'),Km=n('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading subjects...</span></div>'),Zm=n('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),Xm=n('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No subjects available</span></div>'),ep=n('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Subject</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),ap=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),tp=n('<span class="scheduleassign-placeholder">Select Activity Type</span>'),sp=n('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading activity types...</span></div>'),rp=n('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),ip=n('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No activity types available</span></div>'),np=n('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Activity Type</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),op=n('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),lp=n('<span class="scheduleassign-placeholder">Select Teacher</span>'),dp=n('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading teachers...</span></div>'),cp=n('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),vp=n('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No teachers available</span></div>'),up=n('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Teacher</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),mp=n('<div class="scheduleassign-time-error"><span class="material-symbols-outlined">error</span> <span> </span></div>'),pp=n('<div class="scheduleassign-time-duration"><span class="material-symbols-outlined">schedule</span> <span> </span></div>'),fp=n('<label class="scheduleassign-day-checkbox"><input type="checkbox"/> <span class="scheduleassign-checkbox-label"> </span></label>'),_p=n('<div class="scheduleassign-add-form" id="addScheduleForm"><h4 class="scheduleassign-form-title">Add New Schedule</h4> <div class="scheduleassign-form-inputs"><div class="scheduleassign-type-subject-row"><div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Schedule Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-schedule-type-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Subject</span></div></button> <button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Activity</span></div></button></div></div></div> <!> <!></div> <div class="scheduleassign-time-section"><div class="scheduleassign-time-row"><div class="scheduleassign-input-group"><!></div> <div class="scheduleassign-input-group"><!></div></div> <div class="scheduleassign-time-info-container"><!></div> <div class="scheduleassign-day-selection-section"><div class="scheduleassign-day-checkboxes"></div></div></div></div> <div class="scheduleassign-form-actions"><button type="button"><span class="material-symbols-outlined"> </span> <!></button></div></div>'),gp=n('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">person</span> <span class="scheduleassign-detail-text"> </span></div>'),hp=n('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">schedule</span> <span class="scheduleassign-detail-text"> </span></div>'),bp=n('<span class="scheduleassign-room-details"> </span>'),yp=n('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">location_on</span> <span class="scheduleassign-detail-text"> <!></span></div>'),wp=n('<div class="scheduleassign-assignment-card"><div class="scheduleassign-assignment-header"><div class="scheduleassign-assignment-info"><h4 class="scheduleassign-assignment-title"> </h4> <p class="scheduleassign-assignment-subtitle"> </p></div> <div class="scheduleassign-assignment-actions"><button type="button" class="scheduleassign-delete-button" title="Delete assignment"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="scheduleassign-assignment-details"><!> <!> <!></div></div>'),Sp=n('<div class="scheduleassign-empty-day"><span class="material-symbols-outlined empty-icon">event_available</span> <span class="empty-text">No schedules</span></div>'),xp=n('<div class="scheduleassign-day-column"><div class="scheduleassign-day-header"><span class="day-name"> </span></div> <div class="scheduleassign-day-schedules"><!></div></div>'),kp=n('<div class="scheduleassign-schedule-grid"><div class="scheduleassign-schedule-actions"><a href="#addScheduleForm" class="scheduleassign-add-schedule-link"><button type="button"><span class="material-symbols-outlined"> </span> </button></a></div> <!> <div class="scheduleassign-days-grid"></div></div>'),Dp=n('<div class="scheduleassign-empty-state-main"><span class="material-symbols-outlined empty-icon">calendar_month</span> <h3>Select Year Level and Section</h3> <p>Choose a year level and section to view the weekly schedule.</p></div>'),Ap=n('<div class="scheduleassign-form-section"><div class="scheduleassign-section-header"><h2 class="admin-section-title">Schedule Management</h2> <p class="scheduleassign-form-instruction">Select year level and section to view all schedule assignments.</p></div> <form><div class="scheduleassign-hierarchical-form"><div class="scheduleassign-selection-row"><div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-year">Year Level *</label> <div><button type="button" id="form-year"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"></div></div></div> <div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-section">Section *</label> <div><button type="button" id="form-section"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search sections..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div></div> <!></div></form></div>');function Tp(V,d){Yt(d,!1);const _=h(),w=h(),v=h(),f=h(),p=h(),g=h(),C=h(),k=[];let N=h(""),E=h(""),q=h(!1),D=h(!1),P=h(""),Y=h(!1);const ee=[{id:"grade-7",name:"Grade 7",description:"Junior High School - First Year"},{id:"grade-8",name:"Grade 8",description:"Junior High School - Second Year"},{id:"grade-9",name:"Grade 9",description:"Junior High School - Third Year"},{id:"grade-10",name:"Grade 10",description:"Junior High School - Fourth Year"}],H=[{id:"monday",name:"Monday"},{id:"tuesday",name:"Tuesday"},{id:"wednesday",name:"Wednesday"},{id:"thursday",name:"Thursday"},{id:"friday",name:"Friday"}];let U=h([]),A="2024-2025";async function M(){try{const Ee=await(await fetch("/api/current-quarter")).json();Ee.success&&Ee.data?(A=Ee.data.currentSchoolYear,console.log(`School year set to: ${A}`)):console.warn("Failed to fetch current school year, using default: 2024-2025")}catch(De){console.error("Error fetching current school year:",De)}}async function ae(){s(Y,!0);try{const Ee=await(await fetch("/api/sections?action=available-sections")).json();Ee.success&&s(U,Ee.data.map(je=>({id:je._id,name:je.name,grade:`Grade ${je.grade_level}`,year:`grade-${je.grade_level}`,grade_level:je.grade_level,school_year:je.school_year,status:je.status})))}catch(De){console.error("Error loading sections:",De)}finally{s(Y,!1)}}let Se=h([]),B=h(!1),ue=h(!1),S=h([]),y=h({startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""}),ce=h([]),ve=h([]),le=h([]),Ce=h(!1),me=h(!1),Me=h(!1),Ae=h(!1),re=h(!1),Te=h(!1),Oe=h(!1),ea=h(!1),Ke=h(!1),z=h(""),Ne=h(""),Qe=h(""),we=h(!1),ze=h([]);function Be(){const De=e(y).startTime,Ee=e(y).endTime;if(!De||!Ee){s(z,""),s(Ne,"");return}const je=We(De),Da=We(Ee);if(Da<=je)s(z,"End time must be after start time"),s(Ne,"");else{s(z,"");const ma=Da-je,L=Math.floor(ma/60),ne=ma%60;L>0&&ne>0?s(Ne,`${L} hour${L>1?"s":""} and ${ne} minute${ne>1?"s":""}`):L>0?s(Ne,`${L} hour${L>1?"s":""}`):s(Ne,`${ne} minute${ne>1?"s":""}`)}}function We(De){const[Ee,je]=De.split(":").map(Number);return Ee*60+je}let sa;function xe(De,Ee){clearTimeout(sa),sa=setTimeout(De,Ee)}async function ge(){xe(async()=>{if(!(!e(E)||!e(y).startTime||!e(y).endTime||e(S).length===0)){s(we,!1),s(ze,[]),s(Qe,"");try{const De=e(S).map(async ma=>{const L=H.find(Xe=>Xe.id===ma)?.name.toLowerCase(),ne=new URLSearchParams({action:"check-conflicts",sectionId:e(E),dayOfWeek:L,startTime:e(y).startTime,endTime:e(y).endTime,schoolYear:A});e(y).teacherId&&e(y).scheduleType==="subject"&&ne.append("teacherId",e(y).teacherId);const Ea=await(await fetch(`/api/schedules?${ne}`)).json();return{day:L,dayDisplay:H.find(Xe=>Xe.id===ma)?.name,...Ea}}),Ee=await Promise.all(De),je=[],Da=[];if(Ee.forEach(ma=>{ma.hasConflicts&&(Da.push(ma.dayDisplay),ma.conflicts.forEach(L=>{je.push({...L,day:ma.dayDisplay})}))}),je.length>0){s(we,!0),s(ze,je);const ma=je.filter(oa=>oa.type==="teacher_conflict"),L=je.filter(oa=>oa.type==="section_conflict");if(ma.length===1)ye.error(ma[0].message,6e3);else if(ma.length>1){const oa=[...new Set(ma.map(Xe=>Xe.day))],Ea=ma[0].details?.teacher_name||"Selected teacher";ye.error(`${Ea} has schedule conflicts on ${oa.join(", ")}. Please choose different times or another teacher.`,8e3)}if(L.length===1)ye.error(L[0].message,6e3);else if(L.length>1){const oa=[...new Set(L.map(Ea=>Ea.day))];ye.error(`Time conflicts detected for this section on ${oa.join(", ")}. Please choose different time slots.`,6e3)}let ne=[];ma.length>0&&ne.push(`Teacher conflicts detected on ${[...new Set(ma.map(oa=>oa.day))].join(", ")}`),L.length>0&&ne.push(`Section time conflicts detected on ${[...new Set(L.map(oa=>oa.day))].join(", ")}`),s(Qe,ne.join(". "))}else s(we,!1),s(Qe,"")}catch(De){console.error("Error checking conflicts:",De),ye.error("Error checking for conflicts. Please try again."),s(we,!1)}finally{}}},500)}function Ie(De){if(!De)return 0;const[Ee,je]=De.split(" "),[Da,ma]=Ee.split(":").map(Number);let L=ma;return je==="PM"&&Da!==12?L+=(Da+12)*60:je==="AM"&&Da===12?L+=0:L+=Da*60,L}function fa(De){De.target.closest(".scheduleassign-custom-dropdown")||(s(q,!1),s(D,!1),s(Ae,!1),s(re,!1),s(Te,!1),s(Oe,!1)),De.target.closest(".time-input-container")||(s(ea,!1),s(Ke,!1))}function _a(){s(q,!e(q))}function Je(){e(N)&&s(D,!e(D))}function Re(De){s(N,De?De.id:""),s(E,""),s(q,!1)}function He(De){s(E,De?De.id:""),s(D,!1),s(ce,[]),gs(y,e(y).subjectId="")}function la(De){if(!De)return"";const Ee=De.split(":");let je=parseInt(Ee[0]);const Da=Ee[1],ma=je>=12?"PM":"AM";je=je%12,je=je||12;const L=Da.startsWith("0")&&Da!=="00"?Da.substring(1):Da;return L==="00"?`${je}:00 ${ma}`:`${je}:${L} ${ma}`}async function aa(){try{const Ee=await(await fetch("/api/schedules")).json();Ee.success?s(Se,Ee.data.map(je=>({id:je.id,year:`grade-${je.grade_level}`,grade:`Grade ${je.grade_level}`,section:je.section_name,day:je.day_of_week.charAt(0).toUpperCase()+je.day_of_week.slice(1),time:`${la(je.start_time)} - ${la(je.end_time)}`,subject:je.subject_name||je.activity_type_name,teacher:je.teacher_name,type:je.schedule_type,startTime:la(je.start_time),endTime:la(je.end_time),subjectId:je.subject_id,activityTypeId:je.activity_type_id,teacherId:je.teacher_id,sectionId:je.section_id,schoolYear:je.school_year,roomId:je.room_id,roomName:je.room_name,roomBuilding:je.room_building,roomFloor:je.room_floor}))):console.error("Failed to load schedules:",Ee.error)}catch(De){console.error("Error loading schedules:",De)}}async function c(De){is.confirm("Delete Assignment","<p>Are you sure you want to delete this schedule assignment?</p>",async()=>{try{const Ee=await lt.delete(`/api/schedules?id=${De.id}`);Ee.success?(s(Se,e(Se).filter(je=>je.id!==De.id)),s(Se,[...e(Se)]),setTimeout(()=>se(),0),ye.success(`Assignment for ${De.subject} has been deleted successfully`)):ye.error(Ee.error||"Failed to delete assignment")}catch(Ee){console.error("Error deleting assignment:",Ee),ye.error("Failed to delete assignment. Please try again.")}},()=>{})}function u(){s(B,!e(B)),e(B)||j()}function j(){s(S,[]),s(y,{startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""})}function K(){s(Ae,!e(Ae))}function ke(){s(re,!e(re))}function Pe(){s(Te,!e(Te))}function de(){s(Oe,!e(Oe))}function $e(){s(ea,!0),s(Ke,!1)}function te(){s(Ke,!0),s(ea,!1)}function T(De){gs(y,e(y).subjectId=De.id),s(Ae,!1)}function x(De){gs(y,e(y).activityTypeId=De.id),s(re,!1)}function $(De){gs(y,e(y).teacherId=De.id),s(Te,!1)}function Q(De){gs(y,e(y).scheduleType=De),s(Oe,!1),De==="subject"?gs(y,e(y).activityTypeId=null):gs(y,e(y).subjectId=null)}async function X(){if(!(e(ce).length>0)){s(Ce,!0);try{const De=e(U).find(L=>L.id===e(E)),Ee=De?De.grade_level:"",je=Ee?`/api/subjects?action=available-subjects&grade_level=${Ee}`:"/api/subjects?action=available-subjects",ma=await(await fetch(je)).json();ma.success&&s(ce,ma.data)}catch(De){console.error("Error loading subjects:",De)}finally{s(Ce,!1)}}}async function Le(){if(!(e(ve).length>0)){s(me,!0);try{const Ee=await(await fetch("/api/activity-types?action=available-activity-types")).json();Ee.success&&s(ve,Ee.data)}catch(De){console.error("Error loading activity types:",De)}finally{s(me,!1)}}}async function I(){if(!(e(le).length>0)){s(Me,!0);try{const Ee=await(await fetch("/api/users?action=teachers")).json();Ee.success&&s(le,Ee.data)}catch(De){console.error("Error loading teachers:",De)}finally{s(Me,!1)}}}async function ie(){if(!e(E)||e(S).length===0){ye.error("Please select a section and at least one day");return}if(!e(y).startTime||!e(y).endTime){ye.error("Please enter start and end times");return}if(e(y).scheduleType==="subject"&&!e(y).subjectId){ye.error("Please select a subject");return}if(e(y).scheduleType==="activity"&&!e(y).activityTypeId){ye.error("Please select an activity type");return}s(ue,!0);try{const De=e(S).map(async ma=>{const L=H.find(ne=>ne.id===ma)?.name.toLowerCase();try{return await lt.post("/api/schedules",{sectionId:e(E),dayOfWeek:L,startTime:e(y).startTime,endTime:e(y).endTime,scheduleType:e(y).scheduleType,subjectId:e(y).scheduleType==="subject"?e(y).subjectId:null,activityTypeId:e(y).scheduleType==="activity"?e(y).activityTypeId:null,teacherId:e(y).teacherId||null,schoolYear:A})}catch(ne){return console.error("API Error:",ne),{success:!1,error:ne.message||"Failed to create schedule"}}}),Ee=await Promise.all(De),je=Ee.filter(ma=>!ma.success),Da=Ee.filter(ma=>ma.success);if(Da.length>0&&await aa(),je.length===0)ye.success(`Schedule added successfully for ${e(S).length} day(s)`),j(),s(B,!1);else{Da.length>0&&ye.success(`Schedule added successfully for ${Da.length} day(s)`);const ma=je.filter(ne=>ne.conflictType==="teacher_conflict"),L=je.filter(ne=>ne.conflictType!=="teacher_conflict");ma.length>0&&ma.forEach(ne=>{ye.error(ne.error,8e3)}),L.length>0&&ye.error(`Failed to add schedule for ${L.length} day(s) due to time conflicts`),je.length>ma.length+L.length&&ye.error(`Failed to add schedule for ${je.length-ma.length-L.length} day(s)`)}}catch(De){console.error("Error submitting schedule:",De),ye.error("Failed to add schedule. Please try again.")}finally{s(ue,!1)}}Bt(async()=>{await M(),ae(),aa()}),Ai(()=>{se()});function se(){if(!e(N)||!e(E))return;const De=document.querySelectorAll(".scheduleassign-day-column");if(De.length===0)return;let Ee=0;De.forEach(je=>{const Da=je.querySelector(".scheduleassign-day-schedules");if(Da){const ma=Da.scrollHeight;Ee=Math.max(Ee,ma)}}),De.forEach(je=>{const Da=je.querySelector(".scheduleassign-empty-day"),ma=je.querySelector(".scheduleassign-day-schedules");Da&&ma&&(ma.children.length>1||ma.children.length===1&&!ma.querySelector(".scheduleassign-empty-day")||(Da.style.minHeight=`${Ee}px`))})}at(()=>e(y),()=>{e(y).startTime&&e(y).endTime?Be():(s(z,""),s(Ne,""))}),at(()=>(e(E),e(y),e(S)),()=>{e(E)&&e(y).startTime&&e(y).endTime&&e(S).length>0?ge():(s(Qe,""),s(we,!1),s(ze,[]))}),at(()=>(e(N),e(U)),()=>{s(_,e(N)?e(U).filter(De=>De.year===e(N)):[])}),at(()=>(e(_),e(P)),()=>{s(w,e(_).filter(De=>De.name.toLowerCase().includes(e(P).toLowerCase())||De.grade.toLowerCase().includes(e(P).toLowerCase())))}),at(()=>e(N),()=>{s(v,ee.find(De=>De.id===e(N)))}),at(()=>(e(U),e(E)),()=>{s(f,e(U).find(De=>De.id===e(E)))}),at(()=>(e(Se),e(N),e(E),e(f)),()=>{s(p,H.reduce((De,Ee)=>(De[Ee.id]=e(Se).filter(je=>{if(!e(N)||!e(E))return!1;const Da=je.year===e(N),ma=je.section===e(f)?.name,L=je.day===Ee.name;return Da&&ma&&L}).sort((je,Da)=>{const ma=Ie(je.startTime),L=Ie(Da.startTime);return ma-L}),De),{}))}),at(()=>e(N),()=>{s(g,!!e(N))}),at(()=>e(E),()=>{s(C,!!e(E))}),at(()=>e(B),()=>{e(B)&&(X(),Le(),I())}),ps(),cs();var Ge=Ap();R("click",Ts,fa);var Ve=r(t(Ge),2),Ze=t(Ve),Ye=t(Ze),ga=t(Ye),da=r(t(ga),2);let Oa;var Ga=t(da);let fe;var O=t(Ga);{var F=De=>{var Ee=Rm(),je=r(t(Ee),2),Da=t(je),ma=t(Da,!0);a(Da),a(je),a(Ee),b(()=>o(ma,(e(v),l(()=>e(v).name)))),i(De,Ee)},J=De=>{var Ee=Mm();i(De,Ee)};m(O,De=>{e(v)?De(F):De(J,!1)})}et(2),a(Ga);var _e=r(Ga,2);xa(_e,5,()=>ee,De=>De.id,(De,Ee)=>{var je=Om();let Da;var ma=r(t(je),2),L=t(ma),ne=t(L,!0);a(L);var oa=r(L,2),Ea=t(oa,!0);a(oa),a(ma),a(je),b(Xe=>{Da=Z(je,1,"scheduleassign-dropdown-item",null,Da,Xe),o(ne,(e(Ee),l(()=>e(Ee).name))),o(Ea,(e(Ee),l(()=>e(Ee).description)))},[()=>({selected:e(N)===e(Ee).id})]),R("click",je,()=>Re(e(Ee))),i(De,je)}),a(_e),a(da),a(ga);var qe=r(ga,2),ia=r(t(qe),2);let na;var Ra=t(ia);let Ue;var Fe=t(Ra);{var Ma=De=>{var Ee=Vm(),je=r(t(Ee),2),Da=t(je),ma=t(Da);a(Da),a(je),a(Ee),b(()=>o(ma,`${e(f),l(()=>e(f).grade)??""} Â· ${e(f),l(()=>e(f).name)??""}`)),i(De,Ee)},dt=De=>{var Ee=Um(),je=t(Ee,!0);a(Ee),b(()=>o(je,e(N)?"Select section":"Select year level first")),i(De,Ee)};m(Fe,De=>{e(f)?De(Ma):De(dt,!1)})}et(2),a(Ra);var ha=r(Ra,2),ka=t(ha),La=t(ka);Xa(La),et(2),a(ka);var Ya=r(ka,2);{var oe=De=>{var Ee=Ym();i(De,Ee)},Sa=De=>{var Ee=ja(),je=va(Ee);{var Da=L=>{var ne=ja(),oa=va(ne);xa(oa,1,()=>e(w),Ea=>Ea.id,(Ea,Xe)=>{var Ja=Wm();let pt;var ct=r(t(Ja),2),vt=t(ct),bt=t(vt);a(vt);var za=r(vt,2),ua=t(za);a(za),a(ct),a(Ja),b(Ta=>{pt=Z(Ja,1,"scheduleassign-dropdown-item",null,pt,Ta),o(bt,`${e(Xe),l(()=>e(Xe).grade)??""} Â· ${e(Xe),l(()=>e(Xe).name)??""}`),o(ua,`${e(Xe),l(()=>e(Xe).grade)??""} Section`)},[()=>({selected:e(E)===e(Xe).id})]),R("click",Ja,()=>He(e(Xe))),i(Ea,Ja)}),i(L,ne)},ma=L=>{var ne=Hm();i(L,ne)};m(je,L=>{e(w),l(()=>e(w).length>0)?L(Da):L(ma,!1)},!0)}i(De,Ee)};m(Ya,De=>{e(Y)?De(oe):De(Sa,!1)})}a(ha),a(ia),a(qe),a(Ye);var Ba=r(Ye,2);{var ht=De=>{var Ee=kp(),je=t(Ee),Da=t(je),ma=t(Da);let L;var ne=t(ma),oa=t(ne,!0);a(ne);var Ea=r(ne);a(ma),a(Da),a(je);var Xe=r(je,2);{var Ja=ct=>{var vt=_p(),bt=r(t(vt),2),za=t(bt),ua=t(za),Ta=r(t(ua),2),Na=t(Ta);let Tt;var Za=t(Na);{var nt=ca=>{var Aa=Qm(),ya=t(Aa),pa=t(ya,!0);a(ya);var Ia=r(ya,2),Va=t(Ia),Ca=t(Va,!0);a(Va),a(Ia),a(Aa),b(()=>{o(pa,(e(y),l(()=>e(y).scheduleType==="subject"?"book":"sports"))),o(Ca,(e(y),l(()=>e(y).scheduleType==="subject"?"Subject":"Activity")))}),i(ca,Aa)},Wa=ca=>{var Aa=Bm();i(ca,Aa)};m(Za,ca=>{e(y),l(()=>e(y).scheduleType)?ca(nt):ca(Wa,!1)})}et(2),a(Na);var ft=r(Na,2);let ut;var _t=t(ft);let qa;var W=r(_t,2);let he;a(ft),a(Ta),a(ua);var ta=r(ua,2);{var Pa=ca=>{var Aa=ep(),ya=r(t(Aa),2),pa=t(ya);let Ia;var Va=t(pa);{var Ca=Ua=>{const it=js(()=>(e(ce),e(y),l(()=>e(ce).find(Qt=>Qt.id===e(y).subjectId))));var mt=Jm(),Pt=r(t(mt),2),Ut=t(Pt),Rt=t(Ut,!0);a(Ut),a(Pt),a(mt),b(()=>o(Rt,(us(e(it)),l(()=>e(it)?.name)))),i(Ua,mt)},ot=Ua=>{var it=zm();i(Ua,it)};m(Va,Ua=>{e(y),l(()=>e(y).subjectId)?Ua(Ca):Ua(ot,!1)})}et(2),a(pa);var Ct=r(pa,2);let Dt;var Ot=t(Ct);{var rt=Ua=>{var it=Km();i(Ua,it)},At=Ua=>{var it=ja(),mt=va(it);{var Pt=Rt=>{var Qt=ja(),os=va(Qt);xa(os,1,()=>e(ce),vs=>vs.id,(vs,es)=>{var ss=Zm();let hs;var Ss=r(t(ss),2),bs=t(Ss),Es=t(bs,!0);a(bs),a(Ss),a(ss),b(Ns=>{hs=Z(ss,1,"scheduleassign-dropdown-option",null,hs,Ns),o(Es,(e(es),l(()=>e(es).name)))},[()=>({selected:e(y).subjectId===e(es).id})]),R("click",ss,()=>T(e(es))),i(vs,ss)}),i(Rt,Qt)},Ut=Rt=>{var Qt=Xm();i(Rt,Qt)};m(mt,Rt=>{e(ce),l(()=>e(ce).length>0)?Rt(Pt):Rt(Ut,!1)},!0)}i(Ua,it)};m(Ot,Ua=>{e(Ce)?Ua(rt):Ua(At,!1)})}a(Ct),a(ya),a(Aa),b((Ua,it)=>{Ia=Z(pa,1,"scheduleassign-dropdown-trigger",null,Ia,Ua),pa.disabled=e(Ce),Dt=Z(Ct,1,"scheduleassign-dropdown-menu",null,Dt,it)},[()=>({open:e(Ae),selected:e(y).subjectId}),()=>({open:e(Ae)})]),R("click",pa,K),i(ca,Aa)},st=ca=>{var Aa=np(),ya=r(t(Aa),2),pa=t(ya);let Ia;var Va=t(pa);{var Ca=Ua=>{const it=js(()=>(e(ve),e(y),l(()=>e(ve).find(Qt=>Qt.id===e(y).activityTypeId))));var mt=ap(),Pt=r(t(mt),2),Ut=t(Pt),Rt=t(Ut,!0);a(Ut),a(Pt),a(mt),b(()=>o(Rt,(us(e(it)),l(()=>e(it)?.name)))),i(Ua,mt)},ot=Ua=>{var it=tp();i(Ua,it)};m(Va,Ua=>{e(y),l(()=>e(y).activityTypeId)?Ua(Ca):Ua(ot,!1)})}et(2),a(pa);var Ct=r(pa,2);let Dt;var Ot=t(Ct);{var rt=Ua=>{var it=sp();i(Ua,it)},At=Ua=>{var it=ja(),mt=va(it);{var Pt=Rt=>{var Qt=ja(),os=va(Qt);xa(os,1,()=>e(ve),vs=>vs.id,(vs,es)=>{var ss=rp();let hs;var Ss=r(t(ss),2),bs=t(Ss),Es=t(bs,!0);a(bs),a(Ss),a(ss),b(Ns=>{hs=Z(ss,1,"scheduleassign-dropdown-option",null,hs,Ns),o(Es,(e(es),l(()=>e(es).name)))},[()=>({selected:e(y).activityTypeId===e(es).id})]),R("click",ss,()=>x(e(es))),i(vs,ss)}),i(Rt,Qt)},Ut=Rt=>{var Qt=ip();i(Rt,Qt)};m(mt,Rt=>{e(ve),l(()=>e(ve).length>0)?Rt(Pt):Rt(Ut,!1)},!0)}i(Ua,it)};m(Ot,Ua=>{e(me)?Ua(rt):Ua(At,!1)})}a(Ct),a(ya),a(Aa),b((Ua,it)=>{Ia=Z(pa,1,"scheduleassign-dropdown-trigger",null,Ia,Ua),pa.disabled=e(me),Dt=Z(Ct,1,"scheduleassign-dropdown-menu",null,Dt,it)},[()=>({open:e(re),selected:e(y).activityTypeId}),()=>({open:e(re)})]),R("click",pa,ke),i(ca,Aa)};m(ta,ca=>{e(y),l(()=>e(y).scheduleType==="subject")?ca(Pa):ca(st,!1)})}var Ha=r(ta,2);{var wa=ca=>{var Aa=up(),ya=r(t(Aa),2),pa=t(ya);let Ia;var Va=t(pa);{var Ca=Ua=>{const it=js(()=>(e(le),e(y),l(()=>e(le).find(Qt=>Qt.id===e(y).teacherId))));var mt=op(),Pt=r(t(mt),2),Ut=t(Pt),Rt=t(Ut);a(Ut),a(Pt),a(mt),b(()=>o(Rt,`${us(e(it)),l(()=>e(it)?.first_name)??""} ${us(e(it)),l(()=>e(it)?.last_name)??""}`)),i(Ua,mt)},ot=Ua=>{var it=lp();i(Ua,it)};m(Va,Ua=>{e(y),l(()=>e(y).teacherId)?Ua(Ca):Ua(ot,!1)})}et(2),a(pa);var Ct=r(pa,2);let Dt;var Ot=t(Ct);{var rt=Ua=>{var it=dp();i(Ua,it)},At=Ua=>{var it=ja(),mt=va(it);{var Pt=Rt=>{var Qt=ja(),os=va(Qt);xa(os,1,()=>e(le),vs=>vs.id,(vs,es)=>{var ss=cp();let hs;var Ss=r(t(ss),2),bs=t(Ss),Es=t(bs);a(bs),a(Ss),a(ss),b(Ns=>{hs=Z(ss,1,"scheduleassign-dropdown-option",null,hs,Ns),o(Es,`${e(es),l(()=>e(es).first_name)??""} ${e(es),l(()=>e(es).last_name)??""}`)},[()=>({selected:e(y).teacherId===e(es).id})]),R("click",ss,()=>$(e(es))),i(vs,ss)}),i(Rt,Qt)},Ut=Rt=>{var Qt=vp();i(Rt,Qt)};m(mt,Rt=>{e(le),l(()=>e(le).length>0)?Rt(Pt):Rt(Ut,!1)},!0)}i(Ua,it)};m(Ot,Ua=>{e(Me)?Ua(rt):Ua(At,!1)})}a(Ct),a(ya),a(Aa),b((Ua,it)=>{Ia=Z(pa,1,"scheduleassign-dropdown-trigger",null,Ia,Ua),pa.disabled=e(Me),Dt=Z(Ct,1,"scheduleassign-dropdown-menu",null,Dt,it)},[()=>({open:e(Te),selected:e(y).teacherId}),()=>({open:e(Te)})]),R("click",pa,Pe),i(ca,Aa)};m(Ha,ca=>{e(y),l(()=>e(y).scheduleType==="subject")&&ca(wa)})}a(za);var St=r(za,2),Nt=t(St),wt=t(Nt),Ka=t(wt);di(Ka,{label:"Start Time",placeholder:"Select start time",get value(){return e(y).startTime},set value(ca){gs(y,e(y).startTime=ca)},get isOpen(){return e(ea)},set isOpen(ca){s(ea,ca)},$$events:{change:ca=>gs(y,e(y).startTime=ca.detail.value),open:$e},$$legacy:!0}),a(wt);var Qa=r(wt,2),gt=t(Qa);di(gt,{label:"End Time",placeholder:"Select end time",get value(){return e(y).endTime},set value(ca){gs(y,e(y).endTime=ca)},get isOpen(){return e(Ke)},set isOpen(ca){s(Ke,ca)},$$events:{change:ca=>gs(y,e(y).endTime=ca.detail.value),open:te},$$legacy:!0}),a(Qa),a(Nt);var yt=r(Nt,2),Mt=t(yt);{var kt=ca=>{var Aa=ja(),ya=va(Aa);{var pa=Va=>{var Ca=mp(),ot=r(t(Ca),2),Ct=t(ot,!0);a(ot),a(Ca),b(()=>o(Ct,e(z))),i(Va,Ca)},Ia=Va=>{var Ca=ja(),ot=va(Ca);{var Ct=Dt=>{var Ot=pp(),rt=r(t(Ot),2),At=t(rt);a(rt),a(Ot),b(()=>o(At,`Duration: ${e(Ne)??""}`)),i(Dt,Ot)};m(ot,Dt=>{e(Ne)&&Dt(Ct)},!0)}i(Va,Ca)};m(ya,Va=>{e(z)?Va(pa):Va(Ia,!1)})}i(ca,Aa)};m(Mt,ca=>{e(y),l(()=>e(y).startTime&&e(y).endTime)&&ca(kt)})}a(yt);var xt=r(yt,2),Gt=t(xt);xa(Gt,5,()=>H,Jt,(ca,Aa)=>{var ya=fp(),pa=t(ya);Xa(pa);var Ia,Va=r(pa,2),Ca=t(Va,!0);a(Va),a(ya),b(()=>{Ia!==(Ia=(e(Aa),l(()=>e(Aa).id)))&&(pa.value=(pa.__value=(e(Aa),l(()=>e(Aa).id)))??""),o(Ca,(e(Aa),l(()=>e(Aa).name)))}),qi(k,[],pa,()=>(e(Aa),l(()=>e(Aa).id),e(S)),ot=>s(S,ot)),i(ca,ya)}),a(Gt),a(xt),a(St),a(bt);var Ft=r(bt,2),Lt=t(Ft);let Ht;var G=t(Lt),be=t(G,!0);a(G);var ra=r(G,2);{var $a=ca=>{var Aa=$t("Cannot Save - Conflicts Detected");i(ca,Aa)},pe=ca=>{var Aa=ja(),ya=va(Aa);{var pa=Va=>{var Ca=$t("Saving...");i(Va,Ca)},Ia=Va=>{var Ca=$t("Save Schedule");i(Va,Ca)};m(ya,Va=>{e(ue)?Va(pa):Va(Ia,!1)},!0)}i(ca,Aa)};m(ra,ca=>{e(we)?ca($a):ca(pe,!1)})}a(Lt),a(Ft),a(vt),b((ca,Aa,ya,pa,Ia)=>{Tt=Z(Na,1,"scheduleassign-dropdown-trigger",null,Tt,ca),ut=Z(ft,1,"scheduleassign-dropdown-menu",null,ut,Aa),qa=Z(_t,1,"scheduleassign-dropdown-option",null,qa,ya),he=Z(W,1,"scheduleassign-dropdown-option",null,he,pa),Ht=Z(Lt,1,"scheduleassign-save-schedule-btn",null,Ht,Ia),Lt.disabled=(e(ue),e(S),e(we),e(z),l(()=>e(ue)||e(S).length===0||e(we)||e(z))),o(be,e(we)?"block":"save")},[()=>({open:e(Oe),selected:e(y).scheduleType}),()=>({open:e(Oe)}),()=>({selected:e(y).scheduleType==="subject"}),()=>({selected:e(y).scheduleType==="activity"}),()=>({"has-conflicts":e(we)})]),R("click",Na,de),R("click",_t,()=>Q("subject")),R("click",W,()=>Q("activity")),R("click",Lt,ie),i(ct,vt)};m(Xe,ct=>{e(B)&&ct(Ja)})}var pt=r(Xe,2);xa(pt,5,()=>H,ct=>ct.id,(ct,vt)=>{var bt=xp(),za=t(bt),ua=t(za),Ta=t(ua,!0);a(ua),a(za);var Na=r(za,2),Tt=t(Na);{var Za=Wa=>{var ft=ja(),ut=va(ft);xa(ut,1,()=>(e(p),e(vt),l(()=>e(p)[e(vt).id])),_t=>_t.id,(_t,qa)=>{var W=wp(),he=t(W),ta=t(he),Pa=t(ta),st=t(Pa,!0);a(Pa);var Ha=r(Pa,2),wa=t(Ha);a(Ha),a(ta);var St=r(ta,2),Nt=t(St);a(St),a(he);var wt=r(he,2),Ka=t(wt);{var Qa=xt=>{var Gt=gp(),Ft=r(t(Gt),2),Lt=t(Ft,!0);a(Ft),a(Gt),b(()=>o(Lt,(e(qa),l(()=>e(qa).teacher)))),i(xt,Gt)};m(Ka,xt=>{e(qa),l(()=>e(qa).teacher)&&xt(Qa)})}var gt=r(Ka,2);{var yt=xt=>{var Gt=hp(),Ft=r(t(Gt),2),Lt=t(Ft);a(Ft),a(Gt),b(()=>o(Lt,`${e(qa),l(()=>e(qa).startTime)??""} - ${e(qa),l(()=>e(qa).endTime)??""}`)),i(xt,Gt)};m(gt,xt=>{e(qa),l(()=>e(qa).startTime&&e(qa).endTime)&&xt(yt)})}var Mt=r(gt,2);{var kt=xt=>{var Gt=yp(),Ft=r(t(Gt),2),Lt=t(Ft),Ht=r(Lt);{var G=be=>{var ra=bp(),$a=t(ra);a(ra),b(()=>o($a,`(${e(qa),l(()=>e(qa).roomBuilding)??""}${e(qa),l(()=>e(qa).roomFloor?`, Floor ${e(qa).roomFloor}`:"")??""})`)),i(be,ra)};m(Ht,be=>{e(qa),l(()=>e(qa).roomBuilding||e(qa).roomFloor)&&be(G)})}a(Ft),a(Gt),b(()=>o(Lt,`${e(qa),l(()=>e(qa).roomName)??""} `)),i(xt,Gt)};m(Mt,xt=>{e(qa),l(()=>e(qa).type==="subject"&&e(qa).roomName)&&xt(kt)})}a(wt),a(W),b(()=>{o(st,(e(qa),l(()=>e(qa).subject))),o(wa,`${e(qa),l(()=>e(qa).grade)??""} - ${e(qa),l(()=>e(qa).section)??""}`)}),R("click",Nt,()=>c(e(qa))),i(_t,W)}),i(Wa,ft)},nt=Wa=>{var ft=Sp();i(Wa,ft)};m(Tt,Wa=>{e(p),e(vt),l(()=>e(p)[e(vt).id]&&e(p)[e(vt).id].length>0)?Wa(Za):Wa(nt,!1)})}a(Na),a(bt),b(()=>o(Ta,(e(vt),l(()=>e(vt).name)))),i(ct,bt)}),a(pt),a(Ee),b(ct=>{L=Z(ma,1,"scheduleassign-add-schedule-card",null,L,ct),o(oa,e(B)?"close":"add"),o(Ea,` ${e(B)?"Cancel Schedule":"Add Schedule"}`)},[()=>({"cancel-mode":e(B)})]),R("click",ma,u),i(De,Ee)},Et=De=>{var Ee=Dp();i(De,Ee)};m(Ba,De=>{e(N)&&e(E)?De(ht):De(Et,!1)})}a(Ze),a(Ve),a(Ge),b((De,Ee,je,Da)=>{Oa=Z(da,1,"scheduleassign-custom-dropdown",null,Oa,De),fe=Z(Ga,1,"scheduleassign-dropdown-button",null,fe,Ee),na=Z(ia,1,"scheduleassign-custom-dropdown",null,na,je),Ue=Z(Ra,1,"scheduleassign-dropdown-button",null,Ue,Da),Ra.disabled=!e(N)},[()=>({open:e(q)}),()=>({selected:e(N)}),()=>({open:e(D),disabled:!e(N)}),()=>({selected:e(E),disabled:!e(N)})]),R("click",Ga,_a),R("click",Ra,Je),tt(La,()=>e(P),De=>s(P,De)),i(V,Ge),Wt()}const Xs="roomManagementData",Rr="availableSectionsData",ci=300*1e3;function Np(){const{subscribe:V,set:d,update:_}=Gs({rooms:[],availableSections:[],isLoading:!1,error:null,lastUpdated:null});return{subscribe:V,init:w=>{w&&w.rooms&&d({rooms:w.rooms,availableSections:w.availableSections||[],isLoading:!1,error:null,lastUpdated:w.lastUpdated})},setLoading:w=>{_(v=>({...v,isLoading:w,error:w?null:v.error}))},updateRooms:w=>{const v=Date.now(),f={rooms:w,lastUpdated:v,isLoading:!1,error:null};_(p=>({...p,...f}));try{localStorage.setItem(Xs,JSON.stringify({rooms:w,lastUpdated:v}))}catch(p){console.warn("Failed to cache rooms data:",p)}},updateSections:w=>{const v=Date.now();_(f=>({...f,availableSections:w,lastUpdated:v}));try{localStorage.setItem(Rr,JSON.stringify({sections:w,lastUpdated:v}))}catch(f){console.warn("Failed to cache sections data:",f)}},setError:w=>{_(v=>({...v,error:w,isLoading:!1}))},getCachedData:()=>{try{const w=localStorage.getItem(Xs),v=localStorage.getItem(Rr);if(!w)return null;const f=JSON.parse(w),p=v?JSON.parse(v):{sections:[]},g=Date.now(),C=g-(f.lastUpdated||0),k=g-(p.lastUpdated||0);return C<ci?{rooms:f.rooms||[],availableSections:k<ci?p.sections||[]:[],lastUpdated:f.lastUpdated}:null}catch(w){return console.warn("Failed to retrieve cached room data:",w),null}},clearCache:()=>{try{localStorage.removeItem(Xs),localStorage.removeItem(Rr)}catch(w){console.warn("Failed to clear room cache:",w)}},addRoom:w=>{_(v=>{const f=[w,...v.rooms];try{localStorage.setItem(Xs,JSON.stringify({rooms:f,lastUpdated:Date.now()}))}catch(p){console.warn("Failed to update cache after adding room:",p)}return{...v,rooms:f}})},removeRoom:w=>{_(v=>{const f=v.rooms.filter(p=>p.id!==w);try{localStorage.setItem(Xs,JSON.stringify({rooms:f,lastUpdated:Date.now()}))}catch(p){console.warn("Failed to update cache after removing room:",p)}return{...v,rooms:f}})},updateRoom:(w,v)=>{_(f=>{const p=f.rooms.map(g=>g.id===w?{...g,...v}:g);try{localStorage.setItem(Xs,JSON.stringify({rooms:p,lastUpdated:Date.now()}))}catch(g){console.warn("Failed to update cache after updating room:",g)}return{...f,rooms:p}})}}}const Fs=Np();var $p=n('<span class="material-symbols-outlined">add_ad</span> Create Room',1),Cp=n('<button type="button" class="adminroom-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),jp=n('<div class="admin-room-loading"><span class="room-loader"></span> <p>Loading rooms...</p></div>'),Ep=n("<p>No rooms found. Create your first room using the form above.</p>"),qp=n("<p>No rooms found matching your search.</p>"),Fp=n('<div class="admin-room-empty-state"><span class="material-symbols-outlined">meeting_room</span> <!></div>'),Lp=n('<button type="button" class="admin-room-unassign-button" title="Unassign Room"><span class="material-symbols-outlined">remove_circle</span></button>'),Ip=n('<a><button type="button" class="admin-room-assign-button"><span class="material-symbols-outlined"> </span></button></a>'),Pp=n('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">group</span> <span> </span></div>'),Gp=n('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">check_circle</span> <span>Available</span></div>'),Rp=n('<div class="admin-room-room-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),Mp=n('<div class="admin-room-edit-form-section"><div class="admin-room-edit-form-container"><div class="admin-room-edit-form-header"><h2 class="admin-room-edit-form-title">Edit Room</h2> <p class="admin-room-edit-form-subtitle">Update room information</p></div> <form class="admin-room-edit-form-content"><div class="admin-room-edit-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-room-name">Room Name *</label> <input type="text" id="edit-room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-building">Building *</label> <input type="text" id="edit-building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-floor">Floor *</label> <input type="text" id="edit-floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-edit-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-update-button"><!></button></div></form></div></div>'),Op=n('<div class="selected-option"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),Vp=n('<span class="placeholder">Select a section</span>'),Up=n('<button type="button"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),Yp=n('<div class="admin-room-assign-form-section"><div class="admin-room-assign-form-container"><div class="admin-room-assign-form-header"><h2 class="admin-room-assign-form-title">Assign Room</h2> <p class="admin-room-assign-form-subtitle">Select a section to assign this room to</p></div> <form class="admin-room-assign-form-content"><div class="admin-room-assign-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="assign-section-select">Select Section *</label> <div><button type="button" id="assign-section-select"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div> <div class="admin-room-assign-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-assign-submit-button"><!></button></div></form></div></div>'),Wp=n('<div><div class="admin-room-room-header"><div class="admin-room-room-title"><h3 class="admin-room-room-name"> </h3></div> <div class="admin-room-action-buttons"><!> <a><button type="button" class="admin-room-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="admin-room-remove-button" title="Remove Room"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="admin-room-room-details"><div class="admin-room-room-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <div class="admin-room-room-created"><span class="material-symbols-outlined">schedule</span> <span> </span></div> <!></div> <!> <!></div>'),Hp=n('<div class="admin-room-rooms-grid"></div>'),Qp=n('<div class="admin-room-creation-form-container"><div class="admin-room-creation-form-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Create New Room</h2> <p class="admin-room-section-subtitle">Fill in the details below to create a new room</p></div> <div class="admin-room-form-container"><form><div class="admin-room-form-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="room-name">Room Name *</label> <input type="text" id="room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="building">Building *</label> <input type="text" id="building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="floor">Floor *</label> <input type="text" id="floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-form-actions"><button type="submit" class="admin-room-create-button"><!></button></div></form></div></div> <div class="admin-room-rooms-list-section"><div class="admin-room-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-room-section-title">All Rooms</h2> <p class="admin-room-section-subtitle">All rooms in the system</p></div> <div class="adminroom-filters-container"><div class="adminroom-search-container"><div class="adminroom-search-input-wrapper"><span class="material-symbols-outlined adminroom-search-icon">search</span> <input type="text" placeholder="Search by room name, building, or floor..." class="adminroom-search-input"/> <!></div></div></div></div></div> <!></div></div>');function Bp(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(Fs,"$roomManagementStore",_),f=h(),p=h(),g=h(),C=h(),k=h();let N=h(!1),E=h(""),q=h(""),D=h(""),P=h(""),Y=h(null),ee=h(""),H=h(""),U=h(""),A=h(!1),M=h(null),ae=h(""),Se=h(!1),B=h(!1);async function ue(T=!1){try{T||Fs.setLoading(!0);const x=await lt.get("/api/rooms");if(x.success)Fs.updateRooms(x.data||[]);else throw new Error(x.message||"Failed to load rooms")}catch(x){console.error("Error loading rooms:",x),Fs.setError("Failed to load rooms. Please try again."),ye.error("Failed to load rooms. Please try again.")}}async function S(T=!1){try{const x=await lt.get("/api/sections?action=available-sections");if(x.success)Fs.updateSections(x.data||[]);else throw new Error(x.message||"Failed to load sections")}catch(x){console.error("Error loading sections:",x),T||ye.error("Failed to load sections. Please try again.")}}const y=T=>{is.confirm("Remove Room",`Are you sure you want to remove room ${T.name}? This action cannot be undone.`,async()=>{try{const x=await lt.delete("/api/rooms",{id:T.id});if(x.success)Fs.removeRoom(T.id),ye.success(x.message);else throw new Error(x.message||"Failed to remove room")}catch(x){console.error("Error removing room:",x),ye.error("Failed to remove room. Please try again.")}},()=>{})};async function ce(){if(!e(q)||!e(D)||!e(P)){ye.warning("Please fill in all required fields.");return}s(N,!0);try{const T=await lt.post("/api/rooms",{name:e(q),building:e(D),floor:e(P)});if(T.success)Fs.addRoom(T.data),ye.success(T.message),Ce();else throw new Error(T.message||"Failed to create room")}catch(T){console.error("Error creating room:",T),ye.error("Failed to create room. Please try again.")}finally{s(N,!1)}}async function ve(T){const x=e(f).find($=>$.id===T);x&&is.confirm("Unassign Room",`Are you sure you want to unassign room "${x.name}"? This will remove all section assignments from this room.`,async()=>{await le(T)},()=>{})}async function le(T){try{if(!e(f).find(Q=>Q.id===T))return;const $=await lt.patch("/api/rooms",{roomId:T,action:"unassign"});if($.success)await ue(),await S(),ye.success($.message);else throw new Error($.message||"Failed to unassign room")}catch(x){console.error("Error unassigning room:",x),ye.error("Failed to unassign room. Please try again.")}}function Ce(){s(q,""),s(D,""),s(P,"")}function me(T){T.target.closest(".custom-dropdown")||s(B,!1)}function Me(T){e(Y)===T.id?(s(Y,null),s(ee,""),s(H,""),s(U,"")):(e(M)===T.id&&(s(M,null),s(ae,""),s(B,!1)),s(Y,T.id),s(ee,T.name),s(H,T.building),s(U,T.floor))}async function Ae(){if(!e(ee)||!e(H)||!e(U)){ye.warning("Please fill in all required fields.");return}s(A,!0);try{const T=e(f).find($=>$.id===e(Y)),x=await lt.put("/api/rooms",{id:e(Y),name:e(ee),building:e(H),floor:e(U),status:T.status,assignedTo:T.assignedTo});if(x.success)Fs.updateRoom(e(Y),x.data),ye.success(x.message),s(Y,null),s(ee,""),s(H,""),s(U,"");else throw new Error(x.message||"Failed to update room")}catch(T){console.error("Error updating room:",T),ye.error("Failed to update room. Please try again.")}finally{s(A,!1)}}function re(T){e(M)===T.id?(s(M,null),s(ae,""),s(B,!1)):(e(Y)===T.id&&(s(Y,null),s(ee,""),s(H,""),s(U,"")),s(M,T.id),s(ae,""),s(B,!1))}function Te(){s(B,!e(B))}function Oe(T){s(ae,T.id||T._id?.toString()),s(B,!1)}async function ea(){if(!e(ae)){ye.warning("Please select a section.");return}s(Se,!0);try{const T=await lt.patch("/api/rooms",{roomId:e(M),sectionIds:[e(ae)],action:"assign"});if(T.success)await ue(),await S(),ye.success(T.message),s(M,null),s(ae,"");else throw new Error(T.message||"Failed to assign room")}catch(T){console.error("Error assigning room:",T),ye.error("Failed to assign room. Please try again.")}finally{s(Se,!1)}}Bt(()=>{const T=Fs.getCachedData();T&&Fs.init(T),ue(!!T),S(!!T);const x=setInterval(()=>{ue(!0),S(!0)},3e4);return()=>{clearInterval(x)}}),at(()=>(e(f),e(p),e(g),e(C),v()),()=>{(T=>{s(f,T.rooms),s(p,T.availableSections),s(g,T.isLoading),s(C,T.error)})(v())}),at(()=>(e(f),e(E)),()=>{s(k,e(f).filter(T=>T.name.toLowerCase().includes(e(E).toLowerCase())||T.building.toLowerCase().includes(e(E).toLowerCase())||T.floor.toLowerCase().includes(e(E).toLowerCase())))}),ps(),cs();var Ke=Qp();R("click",Ts,me);var z=t(Ke),Ne=r(t(z),2),Qe=t(Ne),we=t(Qe),ze=t(we),Be=r(t(ze),2);Xa(Be),a(ze);var We=r(ze,2),sa=r(t(We),2);Xa(sa),a(We);var xe=r(We,2),ge=r(t(xe),2);Xa(ge),a(xe),a(we);var Ie=r(we,2),fa=t(Ie),_a=t(fa);{var Je=T=>{var x=$t("Creating...");i(T,x)},Re=T=>{var x=$p();et(),i(T,x)};m(_a,T=>{e(N)?T(Je):T(Re,!1)})}a(fa),a(Ie),a(Qe),a(Ne),a(z);var He=r(z,2),la=t(He),aa=t(la),c=r(t(aa),2),u=t(c),j=t(u),K=r(t(j),2);Xa(K);var ke=r(K,2);{var Pe=T=>{var x=Cp();R("click",x,()=>s(E,"")),i(T,x)};m(ke,T=>{e(E)&&T(Pe)})}a(j),a(u),a(c),a(aa),a(la);var de=r(la,2);{var $e=T=>{var x=jp();i(T,x)},te=T=>{var x=ja(),$=va(x);{var Q=Le=>{var I=Fp(),ie=r(t(I),2);{var se=Ve=>{var Ze=Ep();i(Ve,Ze)},Ge=Ve=>{var Ze=qp();i(Ve,Ze)};m(ie,Ve=>{e(f),l(()=>e(f).length===0)?Ve(se):Ve(Ge,!1)})}a(I),i(Le,I)},X=Le=>{var I=Hp();xa(I,5,()=>e(k),ie=>ie.id,(ie,se)=>{var Ge=Wp();let Ve;var Ze=t(Ge),Ye=t(Ze),ga=t(Ye),da=t(ga,!0);a(ga),a(Ye);var Oa=r(Ye,2),Ga=t(Oa);{var fe=Ee=>{var je=Lp();R("click",je,()=>ve(e(se).id)),i(Ee,je)},O=Ee=>{var je=Ip(),Da=t(je),ma=t(Da),L=t(ma,!0);a(ma),a(Da),a(je),b(()=>{Fa(je,"href",`#admin-room-room-card-${e(se),l(()=>e(se).id)??""}`),Fa(Da,"title",(e(M),e(se),l(()=>e(M)===e(se).id?"Cancel Assign":"Assign Room"))),o(L,(e(M),e(se),l(()=>e(M)===e(se).id?"close":"add_circle")))}),R("click",Da,()=>re(e(se))),i(Ee,je)};m(Ga,Ee=>{e(se),l(()=>e(se).assignedSections&&e(se).assignedSections.length>0)?Ee(fe):Ee(O,!1)})}var F=r(Ga,2),J=t(F),_e=t(J),qe=t(_e,!0);a(_e),a(J),a(F);var ia=r(F,2);a(Oa),a(Ze);var na=r(Ze,2),Ra=t(na),Ue=r(t(Ra),2),Fe=t(Ue);a(Ue),a(Ra);var Ma=r(Ra,2);{var dt=Ee=>{var je=Pp(),Da=r(t(je),2),ma=t(Da);a(Da),a(je),b(L=>o(ma,`Assigned to: ${L??""}`),[()=>(e(se),l(()=>e(se).assignedSections.map(L=>L.name).join(", ")))]),i(Ee,je)},ha=Ee=>{var je=Gp();i(Ee,je)};m(Ma,Ee=>{e(se),l(()=>e(se).assignedSections&&e(se).assignedSections.length>0)?Ee(dt):Ee(ha,!1)})}var ka=r(Ma,2),La=r(t(ka),2),Ya=t(La);a(La),a(ka);var oe=r(ka,2);{var Sa=Ee=>{var je=Rp(),Da=r(t(je),2),ma=t(Da);a(Da),a(je),b(()=>o(ma,`Updated: ${e(se),l(()=>e(se).updatedDate)??""}`)),i(Ee,je)};m(oe,Ee=>{e(se),l(()=>e(se).updatedDate&&e(se).updatedDate!==e(se).createdDate)&&Ee(Sa)})}a(na);var Ba=r(na,2);{var ht=Ee=>{var je=Mp(),Da=t(je),ma=r(t(Da),2),L=t(ma),ne=t(L),oa=r(t(ne),2);Xa(oa),a(ne);var Ea=r(ne,2),Xe=r(t(Ea),2);Xa(Xe),a(Ea);var Ja=r(Ea,2),pt=r(t(Ja),2);Xa(pt),a(Ja),a(L);var ct=r(L,2),vt=t(ct),bt=r(vt,2),za=t(bt);{var ua=Na=>{var Tt=$t("Updating...");i(Na,Tt)},Ta=Na=>{var Tt=$t("Update");i(Na,Tt)};m(za,Na=>{e(A)?Na(ua):Na(Ta,!1)})}a(bt),a(ct),a(ma),a(Da),a(je),b(()=>bt.disabled=e(A)||!e(ee)||!e(H)||!e(U)),tt(oa,()=>e(ee),Na=>s(ee,Na)),tt(Xe,()=>e(H),Na=>s(H,Na)),tt(pt,()=>e(U),Na=>s(U,Na)),R("click",vt,()=>Me(e(se))),R("submit",ma,ks(Ae)),i(Ee,je)};m(Ba,Ee=>{e(Y),e(se),l(()=>e(Y)===e(se).id)&&Ee(ht)})}var Et=r(Ba,2);{var De=Ee=>{var je=Yp(),Da=t(je),ma=r(t(Da),2),L=t(ma),ne=t(L),oa=r(t(ne),2);let Ea;var Xe=t(oa);let Ja;var pt=t(Xe);{var ct=nt=>{const Wa=js(()=>(e(p),e(ae),l(()=>e(p).find(qa=>(qa.id||qa._id?.toString())===e(ae)))));var ft=ja(),ut=va(ft);{var _t=qa=>{var W=Op(),he=r(t(W),2),ta=t(he),Pa=t(ta,!0);a(ta);var st=r(ta,2),Ha=t(st);a(st),a(he),a(W),b(()=>{o(Pa,(us(e(Wa)),l(()=>e(Wa).name))),o(Ha,`Grade ${us(e(Wa)),l(()=>e(Wa).grade_level)??""} Section`)}),i(qa,W)};m(ut,qa=>{e(Wa)&&qa(_t)})}i(nt,ft)},vt=nt=>{var Wa=Vp();i(nt,Wa)};m(pt,nt=>{e(ae)?nt(ct):nt(vt,!1)})}et(2),a(Xe);var bt=r(Xe,2);xa(bt,5,()=>e(p),nt=>nt.id||nt._id,(nt,Wa)=>{var ft=Up();let ut;var _t=r(t(ft),2),qa=t(_t),W=t(qa,!0);a(qa);var he=r(qa,2),ta=t(he);a(he),a(_t),a(ft),b(Pa=>{ut=Z(ft,1,"dropdown-option",null,ut,Pa),o(W,(e(Wa),l(()=>e(Wa).name))),o(ta,`Grade ${e(Wa),l(()=>e(Wa).grade_level)??""} Section`)},[()=>({selected:e(ae)===(e(Wa).id||e(Wa)._id?.toString())})]),R("click",ft,xr(()=>Oe(e(Wa)))),i(nt,ft)}),a(bt),a(oa),a(ne),a(L);var za=r(L,2),ua=t(za),Ta=r(ua,2),Na=t(Ta);{var Tt=nt=>{var Wa=$t("Assigning");i(nt,Wa)},Za=nt=>{var Wa=$t("Assign");i(nt,Wa)};m(Na,nt=>{e(Se)?nt(Tt):nt(Za,!1)})}a(Ta),a(za),a(ma),a(Da),a(je),b((nt,Wa)=>{Ea=Z(oa,1,"custom-dropdown",null,Ea,nt),Ja=Z(Xe,1,"dropdown-trigger",null,Ja,Wa),Ta.disabled=e(Se)||!e(ae)},[()=>({open:e(B)}),()=>({selected:e(ae)})]),R("click",Xe,xr(Te)),R("click",ua,()=>re(e(se))),R("submit",ma,ks(ea)),i(Ee,je)};m(Et,Ee=>{e(M),e(se),l(()=>e(M)===e(se).id)&&Ee(De)})}a(Ge),b(Ee=>{Ve=Z(Ge,1,"admin-room-room-card",null,Ve,Ee),Fa(Ge,"id",`admin-room-room-card-${e(se),l(()=>e(se).id)??""}`),o(da,(e(se),l(()=>e(se).name))),Fa(F,"href",`#admin-room-room-card-${e(se),l(()=>e(se).id)??""}`),Fa(J,"title",(e(Y),e(se),l(()=>e(Y)===e(se).id?"Cancel Edit":"Edit Room"))),o(qe,(e(Y),e(se),l(()=>e(Y)===e(se).id?"close":"edit"))),o(Fe,`${e(se),l(()=>e(se).building)??""}, ${e(se),l(()=>e(se).floor)??""}`),o(Ya,`Created: ${e(se),l(()=>e(se).createdDate)??""}`)},[()=>({editing:e(Y)===e(se).id,assigning:e(M)===e(se).id})]),R("click",J,()=>Me(e(se))),R("click",ia,()=>y(e(se))),i(ie,Ge)}),a(I),i(Le,I)};m($,Le=>{e(k),l(()=>e(k).length===0)?Le(Q):Le(X,!1)},!0)}i(T,x)};m(de,T=>{e(g)?T($e):T(te,!1)})}a(He),a(Ke),b(()=>fa.disabled=e(N)||!e(q)||!e(D)||!e(P)),tt(Be,()=>e(q),T=>s(q,T)),tt(sa,()=>e(D),T=>s(D,T)),tt(ge,()=>e(P),T=>s(P,T)),R("submit",Qe,ks(ce)),tt(K,()=>e(E),T=>s(E,T)),i(V,Ke),Wt(),w()}const cr="sectionsCache",Jp=180*1e3,Ls=(()=>{const V=Gs([]),d=Gs(!1),_=Gs(null),w=()=>{try{const P=localStorage.getItem(cr);if(!P)return null;const Y=JSON.parse(P);return Date.now()-Y.timestamp>Jp?(localStorage.removeItem(cr),null):Y.sections}catch(P){return console.error("Error reading sections cache:",P),localStorage.removeItem(cr),null}},v=P=>{try{const Y={sections:P,timestamp:Date.now()};localStorage.setItem(cr,JSON.stringify(Y))}catch(Y){console.error("Error setting sections cache:",Y)}},f=()=>{try{localStorage.removeItem(cr)}catch(P){console.error("Error clearing sections cache:",P)}},p=()=>{const P=w();return P?(V.set(P),!0):!1},g=(P,Y=!1)=>{V.set(P),_.set(null),Y||d.set(!1),v(P)},C=(P,Y=!1)=>{Y||d.set(P)},k=P=>{_.set(P),d.set(!1)},N=async(P=!1)=>{try{C(!0,P);const Y=await fetch("/api/sections");if(!Y.ok)throw new Error(`HTTP error! status: ${Y.status}`);const ee=await Y.json();if(!ee.success||!ee.data)throw new Error("Invalid API response structure");const H=ee.data.map(U=>({...U,students:U.students||[],adviser:U.adviser||null}));g(H,P)}catch(Y){console.error("Error loading sections:",Y),k(Y.message)}finally{C(!1,!1)}},E=P=>{V.update(Y=>{const ee=[...Y,P];return v(ee),ee})},q=(P,Y)=>{V.update(ee=>{const H=ee.map(U=>U.id===P?{...U,...Y}:U);return v(H),H})},D=P=>{V.update(Y=>{const ee=Y.filter(H=>H.id!==P);return v(ee),ee})};return{sections:{subscribe:V.subscribe},isLoadingSections:{subscribe:d.subscribe},sectionsError:{subscribe:_.subscribe},initSections:p,loadSections:N,updateSections:g,setLoadingSections:C,setSectionsError:k,addSection:E,updateSection:q,removeSection:D,clearSectionsCache:f}})();var zp=n('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Kp=n('<span class="sectionmgmt-placeholder">Select grade level</span>'),Zp=n('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Xp=n('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),ef=n('<span class="sectionmgmt-placeholder">Select advisory teacher</span>'),af=n('<span class="sectionmgmt-placeholder">Select grade level first</span>'),tf=n('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading teachers...</p></div>'),sf=n('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available teachers found</span></div>'),rf=n('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),nf=n('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),of=n('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading students...</p></div>'),lf=n('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found for this grade level</span></div>'),df=n('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <div class="sectionmgmt-student-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),cf=n('<div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="students"/> <!></div> <div class="sectionmgmt-student-list"><!></div>',1),vf=n('<div class="sectionmgmt-placeholder-message"><span class="material-symbols-outlined">info</span> <span>Please select a grade level first to view available students.</span></div>'),uf=n('<span class="material-symbols-outlined">groups</span> Create Section',1),mf=n('<button type="button" class="adminform-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),pf=n('<div class="adminform-selected-option"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></div>'),ff=n('<span class="adminform-placeholder">Filter by grade</span>'),_f=n('<button type="button"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></button>'),gf=n('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading sections...</p></div>'),hf=n('<div class="sectionmgmt-section-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),bf=n('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),yf=n('<span class="sectionmgmt-placeholder">Select section adviser</span>'),wf=n('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Sf=n('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available advisers found</span></div>'),xf=n('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),kf=n('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <span class="material-symbols-outlined sectionmgmt-option-icon"> </span></button>'),Df=n('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found</span></div>'),Af=n('<div class="sectionmgmt-edit-form-section"><div class="sectionmgmt-edit-form-container" id="section-edit-form-container"><div class="sectionmgmt-edit-form-header"><h2 class="sectionmgmt-edit-form-title">Edit Section</h2> <p class="sectionmgmt-edit-form-subtitle">Update section information and manage students</p></div> <form class="sectionmgmt-edit-form-content"><div class="sectionmgmt-edit-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-name">Section Name</label> <input type="text" id="edit-section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-adviser">Section Adviser</label> <div><button type="button" id="edit-section-adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search advisers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!> <!></div></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-students"> </label> <div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="edit-students"/> <!></div> <div class="sectionmgmt-student-list"><!> <!></div></div> <div class="sectionmgmt-edit-form-actions"><button type="button" class="sectionmgmt-cancel-button">Cancel</button> <button type="submit" class="sectionmgmt-submit-button"><!></button></div></form></div></div>'),Tf=n('<div><div class="sectionmgmt-section-header-card"><div class="sectionmgmt-section-title"><h3 class="sectionmgmt-section-name"> </h3></div> <div class="sectionmgmt-action-buttons"><a><button type="button" class="sectionmgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="sectionmgmt-remove-button" title="Remove Section"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="sectionmgmt-section-details"><div class="sectionmgmt-section-adviser"><span class="material-symbols-outlined">person_book</span> <span> </span></div> <div class="sectionmgmt-section-students"><span class="material-symbols-outlined">group</span> <span> </span></div> <div class="sectionmgmt-section-room"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <div class="sectionmgmt-section-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div> <!></div>'),Nf=n("<p>No sections found</p>"),$f=n("<p>No sections found matching your search.</p>"),Cf=n('<div class="sectionmgmt-sections-empty"><span class="material-symbols-outlined">school</span> <!></div>'),jf=n("<!> <!>",1),Ef=n(`<div class="sectionmgmt-form-container"><div class="sectionmgmt-creation-form-section"><div class="sectionmgmt-section-header"><h2 class="sectionmgmt-section-title">Create New Section</h2> <p class="sectionmgmt-section-subtitle">Fill in the details below to create a new class section</p></div> <div class="sectionmgmt-form-container"><form><div class="sectionmgmt-basic-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="section-name">Section Name *</label> <input type="text" id="section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="school-year">School Year</label> <input type="text" id="school-year" class="sectionmgmt-form-input" readonly=""/></div></div> <div class="sectionmgmt-create-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="adviser">Advisory Teacher (Optional)</label> <div><button type="button" id="adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search teachers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only teachers without assigned sections are shown. Each teacher can only advise one
							section.</p></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="students">Students (Optional)</label> <!></div> <div class="sectionmgmt-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="sectionmgmt-recent-sections-section"><div class="sectionmgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="sectionmgmt-section-title">All Sections</h2> <p class="sectionmgmt-section-subtitle">All sections in the system</p></div> <div class="adminform-search-filter-container"><div class="adminform-search-container"><div class="adminform-search-input-wrapper"><span class="material-symbols-outlined adminform-search-icon">search</span> <input type="text" placeholder="Search by section name or grade level..." class="adminform-search-input"/> <!></div></div> <div class="adminform-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined adminform-dropdown-arrow">expand_more</span></button> <div class="adminform-dropdown-menu"></div></div></div></div></div></div> <div class="sectionmgmt-sections-grid"><!></div></div></div>`);function qf(V,d){Yt(d,!1);const[_,w]=fs(),v=()=>ns(e(g),"$isLoadingSections",_),f=()=>ns(e(p),"$sections",_),p=h(),g=h(),C=h(),k=h(),N=h(),E=h(),q=h(),D=h(),P=h(),Y=h(),ee=h(),H=h();let U=h(!1),A=h(""),M=h(""),ae=h(""),Se=h(null),B=h([]),ue=h(!1),S=h(!1),y=h(!1),ce=h(""),ve=h(""),le=h(""),Ce=h("all"),me=h(null),Me=h(""),Ae=h(null),re=h([]),Te=h(!1),Oe=h(!1),ea=h(""),Ke=h(""),z=h([]),Ne=h([]),Qe=h(!1),we=h(!1);async function ze(){try{const he=await(await fetch("/api/current-quarter")).json();he.success&&he.data?.currentSchoolYear&&s(ae,he.data.currentSchoolYear)}catch(W){console.error("Error fetching current school year:",W)}}Bt(async()=>{await ze();const W=Ls.initSections();await Ls.loadSections(W),await Be()});async function Be(W=null){try{s(Qe,!0);const he=W?`&teacherGradeLevel=${W}`:"",ta=await lt.get(`/api/sections?action=available-teachers&schoolYear=${e(ae)}${he}`);if(ta.success&&(s(z,ta.data.map(Pa=>{const st=e(N)&&e(N).length>0?e(N).some(Ha=>Ha.adviser_id===Pa.id):!1;return{id:Pa.id,name:Pa.full_name,employeeId:Pa.account_number,subject:Pa.subject_code||"No Subject",subject_grade_level:Pa.subject_grade_level,hasSection:st}})),e(N)&&e(N).length>0))for(const Pa of e(N))Pa.adviser_id&&!e(z).find(st=>st.id===Pa.adviser_id)&&e(z).push({id:Pa.adviser_id,name:Pa.adviser_name,employeeId:Pa.adviser_account_number||"N/A",subject:Pa.adviser_subject||"No Subject",subject_grade_level:Pa.grade_level,hasSection:!0})}catch(he){console.error("Error loading teachers:",he),ye.error("Failed to load available teachers")}finally{s(Qe,!1)}}async function We(W){try{s(we,!0);const he=await lt.get(`/api/sections?action=available-students&gradeLevel=${W}&schoolYear=${e(ae)}`);he.success&&s(Ne,he.data.map(ta=>({id:ta.id,name:ta.full_name,studentId:ta.account_number,grade:ta.grade_level,hasSection:!1})))}catch(he){console.error("Error loading students:",he),ye.error("Failed to load available students")}finally{s(we,!1)}}async function sa(W){try{const he=await lt.get(`/api/sections?action=section-students&sectionId=${W}`);return he.success?he.data.map(ta=>({id:ta.id,name:ta.full_name,studentId:ta.account_number,grade:ta.grade_level})):[]}catch(he){return console.error("Error loading section students:",he),[]}}function xe(W){e(re).findIndex(ta=>ta.id===W.id)>-1?s(re,e(re).filter(ta=>ta.id!==W.id)):s(re,[...e(re),W])}function ge(){if(e(re).length===e(H).length&&e(H).every(W=>e(re).some(he=>he.id===W.id)))s(re,e(re).filter(W=>!e(H).some(he=>he.id===W.id)));else{const W=e(H).filter(he=>!e(re).some(ta=>ta.id===he.id));s(re,[...e(re),...W])}}const Ie=[{id:"7",name:"Grade 7",description:"First Year Junior High School"},{id:"8",name:"Grade 8",description:"Second Year Junior High School"},{id:"9",name:"Grade 9",description:"Third Year Junior High School"},{id:"10",name:"Grade 10",description:"Fourth Year Junior High School"}],fa=[{id:"all",name:"All Sections",icon:"group"},{id:"7",name:"Grade 7",icon:"school"},{id:"8",name:"Grade 8",icon:"school"},{id:"9",name:"Grade 9",icon:"school"},{id:"10",name:"Grade 10",icon:"school"}];function _a(){s(ue,!e(ue)),s(S,!1)}function Je(){s(S,!e(S)),s(ue,!1)}function Re(){s(y,!e(y))}function He(W){s(M,W.id),s(ue,!1),s(B,[]),We(W.id),Be(W.id)}function la(W){s(Se,W),s(S,!1),s(ce,"")}function aa(W){s(Ce,W.id),s(y,!1)}function c(W){e(B).findIndex(ta=>ta.id===W.id)>-1?s(B,e(B).filter(ta=>ta.id!==W.id)):s(B,[...e(B),W])}function u(){if(e(B).length===e(P).length&&e(P).every(W=>e(B).some(he=>he.id===W.id)))s(B,e(B).filter(W=>!e(P).some(he=>he.id===W.id)));else{const W=e(P).filter(he=>!e(B).some(ta=>ta.id===he.id));s(B,[...e(B),...W])}}async function j(){if(!e(A)||!e(M)){ye.error("Please fill in section name and grade level.");return}s(U,!0);try{const W=await lt.post("/api/sections",{sectionName:e(A),gradeLevel:parseInt(e(M)),schoolYear:e(ae),adviserId:e(Se)?.id||null,studentIds:e(B).map(he=>he.id),roomId:null});W.success?(ye.success(W.message),s(A,""),s(M,""),s(Se,null),s(B,[]),s(ce,""),s(ve,""),s(Ne,[]),Ls.addSection(W.data),await Be()):ye.error(W.error||"Failed to create section")}catch(W){console.error("Error creating section:",W),ye.error("Failed to create section. Please try again.")}finally{s(U,!1)}}async function K(W){e(me)===W.id?(s(me,null),s(Me,""),s(Ae,null),s(re,[]),s(ea,""),s(Ke,""),s(Oe,!1)):(s(me,W.id),s(Me,W.name),s(Ae,e(z).find(he=>he.id===W.adviser_id)),!e(Ae)&&W.adviser_id&&(s(Ae,{id:W.adviser_id,name:"Loading...",employeeId:"",subject:"",hasSection:!0}),await Be(W.grade_level),s(Ae,e(z).find(he=>he.id===W.adviser_id)||e(Ae))),s(re,await sa(W.id)),s(T,[...e(re)]),s(Ke,""),await We(W.grade_level))}async function ke(){if(!e(Me)){ye.error("Please fill in section name.");return}s(Te,!0);try{const W={sectionId:e(me),sectionName:e(Me),adviserId:e(Ae)?.id||null,studentIds:e(re).map(ta=>ta.id||ta._id),roomId:null},he=await lt.put("/api/sections",W);he.success?(ye.success(he.message),s(me,null),s(Me,""),s(Ae,null),s(re,[]),s(ea,""),s(Ke,""),s(Oe,!1),Ls.updateSection(e(me),he.data),await Ls.loadSections(!0),await Be()):ye.error(he.error||"Failed to update section")}catch(W){console.error("Error updating section:",W),ye.error("Failed to update section. Please try again.")}finally{s(Te,!1)}}function Pe(){s(Oe,!e(Oe))}async function de(W){const he=W.id;s(Ae,W),s(Oe,!1),s(ea,""),await Be(),s(Ae,e(z).find(ta=>ta.id===he)||W)}function $e(W){is.confirm("Delete Section",`<p>Are you sure you want to permanently delete section <strong>"${W.name}"</strong> (Grade ${W.grade_level})?</p>
			<p class="sectionmgmt-warning">This action will:</p>
			<ul class="sectionmgmt-warning-list">
				<li>Permanently delete the section and all its data</li>
				<li>Remove all students from this section</li>
				<li>Free up the advisory teacher for other sections</li>
				<li>This action cannot be undone</li>
			</ul>`,()=>te(W),null,{size:"medium"})}async function te(W){try{const he=await lt.delete(`/api/sections?sectionId=${W._id}`);he.success?(ye.success("Section deleted successfully"),Ls.removeSection(W._id)):ye.error(he.error||"Failed to delete section")}catch(he){console.error("Error deleting section:",he),ye.error("An error occurred while deleting the section")}}let T=h([]);at(()=>(e(p),e(g),e(C),Ls),()=>{ti(s(p,Ls.sections),"$sections",_),ti(s(g,Ls.isLoadingSections),"$isLoadingSections",_),s(C,Ls.sectionsError)}),at(()=>v(),()=>{s(k,v())}),at(()=>f(),()=>{s(N,f())}),at(()=>e(M),()=>{s(E,Ie.find(W=>W.id===e(M)))}),at(()=>e(Ce),()=>{s(q,fa.find(W=>W.id===e(Ce)))}),at(()=>(e(z),e(ce)),()=>{s(D,e(z).filter(W=>!W.hasSection&&W.name.toLowerCase().includes(e(ce).toLowerCase())))}),at(()=>(e(M),e(B),e(Se)),()=>{e(M)&&(s(B,e(B).filter(W=>W.grade===e(M))),e(Se)&&e(Se).subject_grade_level&&e(Se).subject_grade_level!==parseInt(e(M))&&s(Se,null))}),at(()=>(e(Ne),e(M),e(ve),e(B)),()=>{s(P,e(Ne).filter(W=>{const he=W.grade===e(M),ta=W.name.toLowerCase().includes(e(ve).toLowerCase()),Pa=!W.hasSection,st=!e(B).some(Ha=>Ha.id===W.id);return he&&ta&&(Pa||!st)}).sort((W,he)=>{const ta=e(B).some(st=>st.id===W.id),Pa=e(B).some(st=>st.id===he.id);return ta&&!Pa?-1:!ta&&Pa?1:W.name.localeCompare(he.name)}))}),at(()=>(e(N),e(le),e(Ce)),()=>{s(Y,e(N).filter(W=>{const he=W.name.toLowerCase().includes(e(le).toLowerCase())||W.grade_level.toString().includes(e(le).toLowerCase()),ta=e(Ce)==="all"||W.grade_level.toString()===e(Ce);return he&&ta}))}),at(()=>(e(z),e(me),e(N),e(ea)),()=>{s(ee,e(z).filter(W=>{const he=e(me)&&e(N).find(wa=>wa.id===e(me))?.adviser_id,ta=!W.hasSection||W.id===he,st=(e(me)&&e(N).find(wa=>wa.id===e(me)))?.grade_level,Ha=!st||!W.subject_grade_level||W.subject_grade_level===st;return ta&&Ha&&W.name.toLowerCase().includes(e(ea).toLowerCase())}))}),at(()=>(e(N),e(me),e(Ne),e(T),e(Ke),e(re)),()=>{s(H,(()=>{e(N).find(he=>he.id===e(me));const W=[...e(Ne)];return e(T).forEach(he=>{W.some(ta=>ta.id===he.id)||W.push({...he,hasSection:!0})}),W.filter(he=>{const ta=he.name.toLowerCase().includes(e(Ke).toLowerCase()),Pa=e(re).some(wa=>wa.id===he.id),st=e(T).some(wa=>wa.id===he.id),Ha=!he.hasSection||Pa||st;return ta&&Ha}).sort((he,ta)=>{const Pa=e(re).some(Ha=>Ha.id===he.id),st=e(re).some(Ha=>Ha.id===ta.id);return Pa&&!st?-1:!Pa&&st?1:he.name.localeCompare(ta.name)})})())}),ps(),cs();var x=Ef(),$=t(x),Q=r(t($),2),X=t(Q),Le=t(X),I=t(Le),ie=r(t(I),2);Xa(ie),a(I);var se=r(I,2),Ge=r(t(se),2);Xa(Ge),a(se),a(Le);var Ve=r(Le,2),Ze=t(Ve),Ye=r(t(Ze),2);let ga;var da=t(Ye);let Oa;var Ga=t(da);{var fe=W=>{var he=zp(),ta=r(t(he),2),Pa=t(ta),st=t(Pa,!0);a(Pa),a(ta),a(he),b(()=>o(st,(e(E),l(()=>e(E).name)))),i(W,he)},O=W=>{var he=Kp();i(W,he)};m(Ga,W=>{e(E)?W(fe):W(O,!1)})}et(2),a(da);var F=r(da,2);xa(F,5,()=>Ie,W=>W.id,(W,he)=>{var ta=Zp();let Pa;var st=r(t(ta),2),Ha=t(st),wa=t(Ha,!0);a(Ha);var St=r(Ha,2),Nt=t(St,!0);a(St),a(st),a(ta),b(wt=>{Pa=Z(ta,1,"sectionmgmt-dropdown-option",null,Pa,wt),o(wa,(e(he),l(()=>e(he).name))),o(Nt,(e(he),l(()=>e(he).description)))},[()=>({selected:e(M)===e(he).id})]),R("click",ta,()=>He(e(he))),i(W,ta)}),a(F),a(Ye),a(Ze);var J=r(Ze,2),_e=r(t(J),2);let qe;var ia=t(_e);let na;var Ra=t(ia);{var Ue=W=>{var he=Xp(),ta=r(t(he),2),Pa=t(ta),st=t(Pa,!0);a(Pa),a(ta),a(he),b(()=>o(st,(e(Se),l(()=>e(Se).name)))),i(W,he)},Fe=W=>{var he=ja(),ta=va(he);{var Pa=Ha=>{var wa=ef();i(Ha,wa)},st=Ha=>{var wa=af();i(Ha,wa)};m(ta,Ha=>{e(M)?Ha(Pa):Ha(st,!1)},!0)}i(W,he)};m(Ra,W=>{e(Se)?W(Ue):W(Fe,!1)})}et(2),a(ia);var Ma=r(ia,2),dt=t(Ma),ha=t(dt);Xa(ha),et(2),a(dt);var ka=r(dt,2);{var La=W=>{var he=tf();i(W,he)},Ya=W=>{var he=ja(),ta=va(he);{var Pa=Ha=>{var wa=sf();i(Ha,wa)},st=Ha=>{var wa=ja(),St=va(wa);xa(St,1,()=>e(D),Nt=>Nt.id,(Nt,wt)=>{var Ka=rf();let Qa;var gt=r(t(Ka),2),yt=t(gt),Mt=t(yt,!0);a(yt);var kt=r(yt,2),xt=t(kt,!0);a(kt),a(gt),a(Ka),b(Gt=>{Qa=Z(Ka,1,"sectionmgmt-dropdown-option",null,Qa,Gt),o(Mt,(e(wt),l(()=>e(wt).name))),o(xt,(e(wt),l(()=>e(wt).employeeId)))},[()=>({selected:e(Se)?.id===e(wt).id})]),R("click",Ka,()=>la(e(wt))),i(Nt,Ka)}),i(Ha,wa)};m(ta,Ha=>{e(D),l(()=>e(D).length===0)?Ha(Pa):Ha(st,!1)},!0)}i(W,he)};m(ka,W=>{e(Qe)?W(La):W(Ya,!1)})}a(Ma),a(_e),et(2),a(J),a(Ve);var oe=r(Ve,2),Sa=r(t(oe),2);{var Ba=W=>{var he=cf(),ta=va(he),Pa=t(ta);Xa(Pa);var st=r(Pa,2);{var Ha=Ka=>{const Qa=js(()=>(e(P),e(B),l(()=>e(P).every(kt=>e(B).some(xt=>xt.id===kt.id)))));var gt=nf(),yt=t(gt),Mt=t(yt,!0);a(yt),a(gt),b(()=>{Fa(gt,"title",`${e(Qa)?"Deselect All":"Select All"} (${e(P),l(()=>e(P).length)??""})`),o(Mt,e(Qa)?"deselect":"select_all")}),R("click",gt,u),i(Ka,gt)};m(st,Ka=>{e(P),l(()=>e(P).length>0)&&Ka(Ha)})}a(ta);var wa=r(ta,2),St=t(wa);{var Nt=Ka=>{var Qa=of();i(Ka,Qa)},wt=Ka=>{var Qa=ja(),gt=va(Qa);{var yt=kt=>{var xt=lf();i(kt,xt)},Mt=kt=>{var xt=ja(),Gt=va(xt);xa(Gt,1,()=>e(P),Ft=>Ft.id,(Ft,Lt)=>{var Ht=df();let G;var be=t(Ht),ra=r(t(be),2),$a=t(ra);a(ra);var pe=r(ra,2),ca=t(pe);a(pe),a(be);var Aa=r(be,2),ya=t(Aa),pa=t(ya,!0);a(ya),a(Aa),a(Ht),b((Ia,Va)=>{G=Z(Ht,1,"sectionmgmt-student-item",null,G,Ia),o($a,`Grade ${e(Lt),l(()=>e(Lt).grade)??""} |`),o(ca,`${e(Lt),l(()=>e(Lt).name)??""} â¢ ${e(Lt),l(()=>e(Lt).studentId)??""}`),o(pa,Va)},[()=>({selected:e(B).some(Ia=>Ia.id===e(Lt).id)}),()=>(e(B),e(Lt),l(()=>e(B).some(Ia=>Ia.id===e(Lt).id)?"check_box":"check_box_outline_blank"))]),R("click",Ht,()=>c(e(Lt))),i(Ft,Ht)}),i(kt,xt)};m(gt,kt=>{e(P),l(()=>e(P).length===0)?kt(yt):kt(Mt,!1)},!0)}i(Ka,Qa)};m(St,Ka=>{e(we)?Ka(Nt):Ka(wt,!1)})}a(wa),tt(Pa,()=>e(ve),Ka=>s(ve,Ka)),i(W,he)},ht=W=>{var he=vf();i(W,he)};m(Sa,W=>{e(M)?W(Ba):W(ht,!1)})}a(oe);var Et=r(oe,2),De=t(Et);let Ee;var je=t(De);{var Da=W=>{var he=$t("Creating...");i(W,he)},ma=W=>{var he=uf();et(),i(W,he)};m(je,W=>{e(U)?W(Da):W(ma,!1)})}a(De),a(Et),a(X),a(Q),a($);var L=r($,2),ne=t(L),oa=t(ne),Ea=r(t(oa),2),Xe=t(Ea),Ja=t(Xe),pt=r(t(Ja),2);Xa(pt);var ct=r(pt,2);{var vt=W=>{var he=mf();R("click",he,()=>s(le,"")),i(W,he)};m(ct,W=>{e(le)&&W(vt)})}a(Ja),a(Xe);var bt=r(Xe,2),za=t(bt);let ua;var Ta=t(za);let Na;var Tt=t(Ta);{var Za=W=>{var he=pf(),ta=t(he),Pa=t(ta,!0);a(ta);var st=r(ta,2),Ha=t(st),wa=t(Ha,!0);a(Ha),a(st),a(he),b(()=>{o(Pa,(e(q),l(()=>e(q).icon))),o(wa,(e(q),l(()=>e(q).name)))}),i(W,he)},nt=W=>{var he=ff();i(W,he)};m(Tt,W=>{e(q)?W(Za):W(nt,!1)})}et(2),a(Ta);var Wa=r(Ta,2);xa(Wa,5,()=>fa,W=>W.id,(W,he)=>{var ta=_f();let Pa;var st=t(ta),Ha=t(st,!0);a(st);var wa=r(st,2),St=t(wa),Nt=t(St,!0);a(St),a(wa),a(ta),b(wt=>{Pa=Z(ta,1,"adminform-dropdown-option",null,Pa,wt),o(Ha,(e(he),l(()=>e(he).icon))),o(Nt,(e(he),l(()=>e(he).name)))},[()=>({selected:e(Ce)===e(he).id})]),R("click",ta,()=>aa(e(he))),i(W,ta)}),a(Wa),a(za),a(bt),a(Ea),a(oa),a(ne);var ft=r(ne,2),ut=t(ft);{var _t=W=>{var he=gf();i(W,he)},qa=W=>{var he=jf(),ta=va(he);xa(ta,1,()=>e(Y),Ha=>Ha.id,(Ha,wa)=>{var St=Tf();let Nt;var wt=t(St),Ka=t(wt),Qa=t(Ka),gt=t(Qa);a(Qa),a(Ka);var yt=r(Ka,2),Mt=t(yt),kt=t(Mt),xt=t(kt),Gt=t(xt,!0);a(xt),a(kt),a(Mt);var Ft=r(Mt,2);a(yt),a(wt);var Lt=r(wt,2),Ht=t(Lt),G=r(t(Ht),2),be=t(G,!0);a(G),a(Ht);var ra=r(Ht,2),$a=r(t(ra),2),pe=t($a);a($a),a(ra);var ca=r(ra,2),Aa=r(t(ca),2),ya=t(Aa,!0);a(Aa),a(ca);var pa=r(ca,2),Ia=r(t(pa),2),Va=t(Ia);a(Ia),a(pa);var Ca=r(pa,2);{var ot=Ot=>{var rt=hf(),At=r(t(rt),2),Ua=t(At);a(At),a(rt),b(it=>o(Ua,`Updated: ${it??""}`),[()=>(e(wa),l(()=>new Date(e(wa).updated_at).toLocaleDateString()))]),i(Ot,rt)};m(Ca,Ot=>{e(wa),l(()=>e(wa).updated_at&&e(wa).updated_at!==e(wa).created_at)&&Ot(ot)})}a(Lt);var Ct=r(Lt,2);{var Dt=Ot=>{var rt=Af(),At=t(rt),Ua=r(t(At),2),it=t(Ua),mt=t(it),Pt=r(t(mt),2);Xa(Pt),a(mt);var Ut=r(mt,2),Rt=r(t(Ut),2);let Qt;var os=t(Rt);let vs;var es=t(os);{var ss=It=>{var Vt=bf(),rs=r(t(Vt),2),_s=t(rs),xs=t(_s,!0);a(_s),a(rs),a(Vt),b(()=>o(xs,(e(Ae),l(()=>e(Ae).name)))),i(It,Vt)},hs=It=>{var Vt=yf();i(It,Vt)};m(es,It=>{e(Ae)?It(ss):It(hs,!1)})}et(2),a(os);var Ss=r(os,2),bs=t(Ss),Es=t(bs);Xa(Es),et(2),a(bs);var Ns=r(bs,2);xa(Ns,1,()=>e(ee),It=>It.id,(It,Vt)=>{var rs=wf();let _s;var xs=r(t(rs),2),$s=t(xs),Rs=t($s,!0);a($s);var qs=r($s,2),ir=t(qs,!0);a(qs),a(xs),a(rs),b(Ps=>{_s=Z(rs,1,"sectionmgmt-dropdown-option",null,_s,Ps),o(Rs,(e(Vt),l(()=>e(Vt).name))),o(ir,(e(Vt),l(()=>e(Vt).employeeId)))},[()=>({selected:e(Ae)?.id===e(Vt).id})]),R("click",rs,()=>de(e(Vt))),i(It,rs)});var Ar=r(Ns,2);{var ar=It=>{var Vt=Sf();i(It,Vt)};m(Ar,It=>{e(ee),l(()=>e(ee).length===0)&&It(ar)})}a(Ss),a(Rt),a(Ut),a(it);var Ys=r(it,2),tr=t(Ys),mr=t(tr);a(tr);var Ws=r(tr,2),sr=t(Ws);Xa(sr);var Tr=r(sr,2);{var Nr=It=>{const Vt=js(()=>(e(H),e(re),l(()=>e(H).every($s=>e(re).some(Rs=>Rs.id===$s.id)))));var rs=xf(),_s=t(rs),xs=t(_s,!0);a(_s),a(rs),b(()=>{Fa(rs,"title",`${e(Vt)?"Deselect All":"Select All"} (${e(H),l(()=>e(H).length)??""})`),o(xs,e(Vt)?"deselect":"select_all")}),R("click",rs,ge),i(It,rs)};m(Tr,It=>{e(H),l(()=>e(H).length>0)&&It(Nr)})}a(Ws);var zt=r(Ws,2),Kt=t(zt);xa(Kt,1,()=>e(H),It=>It.id,(It,Vt)=>{var rs=kf();let _s;var xs=t(rs),$s=r(t(xs),2),Rs=t($s,!0);a($s);var qs=r($s,2),ir=t(qs);a(qs),a(xs);var Ps=r(xs,2),fr=t(Ps,!0);a(Ps),a(rs),b((Vs,$r)=>{_s=Z(rs,1,"sectionmgmt-student-item",null,_s,Vs),o(Rs,(e(Vt),l(()=>e(Vt).name))),o(ir,`${e(Vt),l(()=>e(Vt).studentId)??""} â¢ Grade ${e(Vt),l(()=>e(Vt).grade)??""}`),o(fr,$r)},[()=>({selected:e(re).some(Vs=>Vs.id===e(Vt).id)}),()=>(e(re),e(Vt),l(()=>e(re).some(Vs=>Vs.id===e(Vt).id)?"check_box":"check_box_outline_blank"))]),R("click",rs,()=>xe(e(Vt))),i(It,rs)});var ds=r(Kt,2);{var ys=It=>{var Vt=Df();i(It,Vt)};m(ds,It=>{e(H),l(()=>e(H).length===0)&&It(ys)})}a(zt),a(Ys);var Hs=r(Ys,2),Qs=t(Hs),Bs=r(Qs,2),Js=t(Bs);{var rr=It=>{var Vt=$t("Updating...");i(It,Vt)},pr=It=>{var Vt=$t("Update");i(It,Vt)};m(Js,It=>{e(Te)?It(rr):It(pr,!1)})}a(Bs),a(Hs),a(Ua),a(At),a(rt),b((It,Vt)=>{Qt=Z(Rt,1,"sectionmgmt-custom-dropdown",null,Qt,It),vs=Z(os,1,"sectionmgmt-dropdown-trigger",null,vs,Vt),o(mr,`Students (${e(re),l(()=>e(re).length)??""} selected)`),Bs.disabled=e(Te)||!e(Me)},[()=>({open:e(Oe)}),()=>({selected:e(Ae)})]),tt(Pt,()=>e(Me),It=>s(Me,It)),R("click",os,Pe),tt(Es,()=>e(ea),It=>s(ea,It)),tt(sr,()=>e(Ke),It=>s(Ke,It)),R("click",Qs,()=>K(e(wa))),R("submit",Ua,ks(ke)),i(Ot,rt)};m(Ct,Ot=>{e(me),e(wa),l(()=>e(me)===e(wa).id)&&Ot(Dt)})}a(St),b((Ot,rt)=>{Nt=Z(St,1,"sectionmgmt-section-card",null,Nt,Ot),Fa(St,"id",`sectionmgmt-section-card-${e(wa),l(()=>e(wa).id)??""}`),o(gt,`${e(wa),l(()=>e(wa).name)??""} Â· Grade ${e(wa),l(()=>e(wa).grade_level)??""}`),Fa(Mt,"href",`#sectionmgmt-section-card-${e(wa),l(()=>e(wa).id)??""}`),Fa(kt,"title",(e(me),e(wa),l(()=>e(me)===e(wa).id?"Cancel Edit":"Edit Section"))),o(Gt,(e(me),e(wa),l(()=>e(me)===e(wa).id?"close":"edit"))),o(be,(e(wa),l(()=>e(wa).adviser_name||"No adviser"))),o(pe,`${e(wa),l(()=>e(wa).student_count)??""} students`),o(ya,(e(wa),l(()=>e(wa).room_name?`${e(wa).room_name} (${e(wa).room_building}, ${e(wa).room_floor})`:"No room assigned"))),o(Va,`Created: ${rt??""}`)},[()=>({editing:e(me)===e(wa).id}),()=>(e(wa),l(()=>new Date(e(wa).created_at).toLocaleDateString()))]),R("click",kt,()=>K(e(wa))),R("click",Ft,()=>$e(e(wa))),i(Ha,St)});var Pa=r(ta,2);{var st=Ha=>{var wa=Cf(),St=r(t(wa),2);{var Nt=Ka=>{var Qa=Nf();i(Ka,Qa)},wt=Ka=>{var Qa=$f();i(Ka,Qa)};m(St,Ka=>{e(N),l(()=>e(N).length===0)?Ka(Nt):Ka(wt,!1)})}a(wa),i(Ha,wa)};m(Pa,Ha=>{e(Y),l(()=>e(Y).length===0)&&Ha(st)})}i(W,he)};m(ut,W=>{e(k)?W(_t):W(qa,!1)})}a(ft),a(L),a(x),b((W,he,ta,Pa,st,Ha,wa)=>{ga=Z(Ye,1,"sectionmgmt-custom-dropdown",null,ga,W),Oa=Z(da,1,"sectionmgmt-dropdown-trigger",null,Oa,he),qe=Z(_e,1,"sectionmgmt-custom-dropdown",null,qe,ta),na=Z(ia,1,"sectionmgmt-dropdown-trigger",null,na,Pa),ia.disabled=!e(M),Ee=Z(De,1,"sectionmgmt-create-button",null,Ee,st),De.disabled=e(U)||!e(A)||!e(M),ua=Z(za,1,"adminform-custom-dropdown",null,ua,Ha),Na=Z(Ta,1,"adminform-dropdown-trigger adminform-filter-trigger",null,Na,wa)},[()=>({open:e(ue)}),()=>({selected:e(M)}),()=>({open:e(S)}),()=>({selected:e(Se)}),()=>({loading:e(U)}),()=>({open:e(y)}),()=>({selected:e(Ce)!=="all"})]),tt(ie,()=>e(A),W=>s(A,W)),tt(Ge,()=>e(ae),W=>s(ae,W)),R("click",da,_a),R("click",ia,Je),tt(ha,()=>e(ce),W=>s(ce,W)),R("submit",X,ks(j)),tt(pt,()=>e(le),W=>s(le,W)),R("click",Ta,Re),i(V,x),Wt(),w()}var Ff=n('<div class="scheduleassign-container"><div class="scheduleassign-header"><div class="scheduleassign-header-content"><h1 class="scheduleassign-page-title">Schedule Management</h1> <p class="scheduleassign-page-subtitle">Assign subjects and teachers to sections with specific time periods</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">schedule</span> Schedule</button> <button><span class="material-icons">groups</span> Section</button> <button><span class="material-icons">meeting_room</span> Room</button></div></div> <div class="schedule-content-container"><!> <!> <!></div></div>');function Lf(V){let d=h("schedule");function _(A){s(d,A)}var w=Ff(),v=t(w),f=r(t(v),2),p=t(f);let g;var C=r(p,2);let k;var N=r(C,2);let E;a(f),a(v);var q=r(v,2),D=t(q);{var P=A=>{Tp(A,{})};m(D,A=>{e(d)==="schedule"&&A(P)})}var Y=r(D,2);{var ee=A=>{qf(A,{})};m(Y,A=>{e(d)==="section"&&A(ee)})}var H=r(Y,2);{var U=A=>{Bp(A,{})};m(H,A=>{e(d)==="room"&&A(U)})}a(q),a(w),b((A,M,ae)=>{g=Z(p,1,"admin-tab-button",null,g,A),k=Z(C,1,"admin-tab-button",null,k,M),E=Z(N,1,"admin-tab-button",null,E,ae)},[()=>({active:e(d)==="schedule"}),()=>({active:e(d)==="section"}),()=>({active:e(d)==="room"})]),R("click",p,()=>_("schedule")),R("click",C,()=>_("section")),R("click",N,()=>_("room")),i(V,w)}var If=n('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Pf=n('<span class="adminsubject-placeholder">Select grade level</span>'),Gf=n('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Rf=n('<span class="material-symbols-outlined">add_circle</span> Create Subject',1),Mf=n('<button type="button" class="adminsubject-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Of=n('<div class="adminsubject-level-category-selected"><span class="material-symbols-outlined adminsubject-level-category-icon">school</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name"> </span></div></div>'),Vf=n('<span class="adminsubject-level-category-placeholder">All Grade Levels</span>'),Uf=n('<button type="button"><span class="material-symbols-outlined adminsubject-level-category-icon">school</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name"> </span> <span class="adminsubject-level-category-description"> </span></div></button>'),Yf=n('<div class="adminsubject-loading-container"><span class="subject-loader"></span> <p class="adminsubject-loading-text">Loading subjects...</p></div>'),Wf=n('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Hf=n('<span class="adminsubject-placeholder">Select grade level</span>'),Qf=n('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Bf=n('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container" id="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Subject</h2> <p class="adminsubject-edit-form-subtitle">Update subject information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-grade-level">Grade Level *</label> <div><button type="button" id="edit-grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectName" class="adminsubject-form-label">Subject Name *</label> <input id="editSubjectName" type="text" class="adminsubject-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectCode" class="adminsubject-form-label">Subject Code *</label> <input id="editSubjectCode" type="text" class="adminsubject-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="adminsubject-edit-form-actions"><button type="button" class="adminsubject-cancel-button">Cancel</button> <button type="submit" class="adminsubject-submit-button"><!></button></div></form></div></div>'),Jf=n('<div class="adminsubject-subject-card"><div class="adminsubject-subject-header"><div class="adminsubject-subject-title"><h3 class="adminsubject-subject-name"> </h3></div> <div class="adminsubject-action-buttons"><a><button type="button" class="adminsubject-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminsubject-remove-button" title="Remove Subject"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminsubject-subject-details"><div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),zf=n('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">search_off</span> <p>No subjects found matching your search.</p></div>'),Kf=n('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Subject</h2> <p class="admin-section-subtitle">Fill in the details below to create a new subject</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="admin-form-group admin-form-group-third"><label for="subjectName" class="admin-form-label">Subject Name *</label> <input id="subjectName" type="text" class="admin-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="admin-form-group admin-form-group-third"><label for="subjectCode" class="admin-form-label">Subject Code *</label> <input id="subjectCode" type="text" class="admin-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Subjects</h2> <p class="admin-section-subtitle">All subjects in the system</p></div> <div class="adminsubject-filters-container"><div class="adminsubject-search-container"><div class="adminsubject-search-input-wrapper"><span class="material-symbols-outlined adminsubject-search-icon">search</span> <input type="text" placeholder="Search by subject name or code" class="adminsubject-search-input"/> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined adminsubject-level-category-arrow">expand_more</span></button> <div class="adminsubject-level-category-menu"><button type="button"><span class="material-symbols-outlined adminsubject-level-category-icon">clear_all</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name">All Grade Levels</span></div></button> <!></div></div></div></div></div> <div class="adminsubject-subjects-grid"><!></div></div></div>'),Zf=n('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Xf=n('<span class="adminsubject-placeholder">Select icon</span>'),e_=n('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),a_=n('<span class="material-symbols-outlined">add_circle</span> Create Activity Type',1),t_=n('<button type="button" class="adminactivity-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),s_=n('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),r_=n('<span class="adminsubject-placeholder">Select icon</span>'),i_=n('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),n_=n('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Activity Type</h2> <p class="adminsubject-edit-form-subtitle">Update activity type information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-name">Activity Name *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-name" placeholder="e.g., Flag Ceremony" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-code">Activity Code *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-code" placeholder="e.g., FLAG" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-icon">Icon</label> <div><button type="button" id="edit-activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="adminsubject-edit-form-actions"><a><button type="button" class="adminsubject-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),o_=n('<div class="adminactivity-activity-card"><div class="adminactivity-activity-header"><div class="adminactivity-activity-title"><h3 class="adminactivity-activity-name"> </h3></div> <div class="adminactivity-action-buttons"><a><button type="button" class="adminactivity-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminactivity-remove-button" title="Remove Activity Type"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminactivity-activity-details"><div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">palette</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!></div>'),l_=n("<p>No activity types created yet.</p>"),d_=n("<p>No activity types found matching your search.</p>"),c_=n('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">event_note</span> <!></div>'),v_=n('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Activity Type</h2> <p class="admin-section-subtitle">Fill in the details below to create a new activity type</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-name">Activity Name *</label> <input id="activity-name" type="text" class="admin-form-input" placeholder="e.g., Flag Ceremony, Break Time" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-code">Activity Code *</label> <input id="activity-code" type="text" class="admin-form-input" placeholder="e.g., FLAG, BREAK" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-icon">Icon</label> <div><button type="button" id="activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Activities</h2> <p class="admin-section-subtitle">All activity types in the system</p></div> <div class="adminactivity-filters-container"><div class="adminactivity-search-container"><div class="adminactivity-search-input-wrapper"><span class="material-symbols-outlined adminactivity-search-icon">search</span> <input type="text" placeholder="Search by activity name or code" class="adminactivity-search-input"/> <!></div></div></div></div></div> <div class="adminactivity-activities-grid"><!></div></div></div>'),u_=n('<div class="admin-subject-creation-container"><div class="admin-subject-header"><div class="admin-header-content"><h1 class="admin-page-title">Subjects & Activities</h1> <p class="admin-page-subtitle">Manage subjects and activity types for the curriculum</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">subject</span> Subjects</button> <button><span class="material-icons">event</span> Activity Types</button></div></div> <!> <!></div>');function m_(V,d){Yt(d,!1);const _=h(),w=h(),v=h(),f=h(),p=h();let g=h(!1),C=h(""),k=h(""),N=h(""),E=h(!1),q=h(!1),D=h(""),P=h(""),Y=h(""),ee=h(null),H=h(""),U=h(""),A=h(""),M=h(!1),ae=h(!1),Se=h("subjects"),B=h([]),ue=h(!1),S=h(""),y=h(""),ce=h("event"),ve=h(!1),le=h(null),Ce=h(""),me=h(""),Me=h("event"),Ae=h(!1),re=h(!1),Te=h(!1),Oe=h([]);const ea=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],Ke=[{value:"event",name:"Event"},{value:"flag",name:"Flag"},{value:"coffee",name:"Coffee"},{value:"restaurant",name:"Restaurant"},{value:"groups",name:"Groups"},{value:"home",name:"Home"},{value:"book",name:"Book"},{value:"group_work",name:"Group Work"},{value:"schedule",name:"Schedule"}];async function z(){s(Te,!0);try{const I=await lt.get("/api/subjects");I.success?s(Oe,I.data):ye.error("Failed to load subjects: "+I.message)}catch(I){console.error("Error loading subjects:",I),ye.error("Failed to load subjects. Please try again.")}finally{s(Te,!1)}}async function Ne(){try{const I=await lt.get("/api/activity-types");I.success?s(B,I.data):ye.error("Failed to load activity types: "+I.message)}catch(I){console.error("Error loading activity types:",I),ye.error("Failed to load activity types. Please try again.")}}Bt(()=>{z(),Ne()});async function Qe(){if(!e(C)||!e(k).trim()||!e(N).trim()){ye.error("Please fill in all required fields");return}s(g,!0);try{const I=await lt.post("/api/subjects",{name:e(k).trim(),code:e(N).trim(),gradeLevel:e(C)});I.success?(s(Oe,[I.data,...e(Oe)]),s(C,""),s(k,""),s(N,""),ye.success(I.message)):ye.error(I.message)}catch(I){console.error("Error creating subject:",I),ye.error("Failed to create subject. Please try again.")}finally{s(g,!1)}}async function we(I){is.confirm("Remove Subject",`<p>Are you sure you want to remove the subject <strong>"${I.name}"</strong>?</p>`,async()=>{try{const ie=await lt.delete("/api/subjects",{id:I.id});ie.success?(s(Oe,e(Oe).filter(se=>se.id!==I.id)),ye.success(ie.message)):ye.error(ie.message)}catch(ie){console.error("Error removing subject:",ie),ye.error("Failed to remove subject. Please try again.")}},null,{size:"small"})}function ze(){s(ae,!e(ae))}function Be(I){s(A,I.value),s(ae,!1)}function We(){s(E,!e(E))}function sa(I){s(C,I.value),s(E,!1)}function xe(){s(q,!e(q))}function ge(I){I?s(P,I.value):s(P,""),s(q,!1)}function Ie(I){I.target.closest(".adminsubject-custom-dropdown")||(s(E,!1),s(ae,!1),s(ve,!1),s(re,!1)),I.target.closest(".adminsubject-level-category-filter")||s(q,!1)}function fa(){s(ve,!e(ve))}function _a(I){s(ce,I),s(ve,!1)}function Je(I){const ie=Ke.find(se=>se.value===I);return ie?ie.name:I}function Re(I){e(ee)===I.id?(s(ee,null),s(H,""),s(U,""),s(A,""),s(ae,!1)):(s(ee,I.id),s(H,I.name),s(U,I.code),s(A,parseInt(I.gradeLevel.replace("Grade ",""))))}async function He(){if(!e(H).trim()||!e(U).trim()||!e(A)){ye.error("Please fill in all required fields");return}s(M,!0);try{const I=await lt.put("/api/subjects",{id:e(ee),name:e(H).trim(),code:e(U).trim(),gradeLevel:e(A)});I.success?(s(Oe,e(Oe).map(ie=>ie.id===e(ee)?I.data:ie)),ye.success(I.message),s(ee,null),s(H,""),s(U,""),s(A,""),s(ae,!1)):ye.error(I.message)}catch(I){console.error("Error updating subject:",I),ye.error("Failed to update subject. Please try again.")}finally{s(M,!1)}}function la(I){e(le)===I.id?(s(le,null),s(Ce,""),s(me,""),s(Me,"event"),s(re,!1)):(s(le,I.id),s(Ce,I.name),s(me,I.code),s(Me,I.icon))}async function aa(){if(!e(Ce).trim()||!e(me).trim()){ye.error("Please fill in all required fields");return}s(Ae,!0);try{const I=await lt.put("/api/activity-types",{id:e(le),name:e(Ce).trim(),code:e(me).trim(),icon:e(Me)});I.success?(recentActivityTypes=recentActivityTypes.map(ie=>ie.id===e(le)?I.data:ie),ye.success(I.message),s(le,null),s(Ce,""),s(me,""),s(Me,"event"),s(re,!1)):ye.error(I.message)}catch(I){console.error("Error updating activity type:",I),ye.error("Failed to update activity type. Please try again.")}finally{s(Ae,!1)}}function c(){s(re,!e(re))}function u(I){s(Me,I),s(re,!1)}async function j(){if(!e(S).trim()||!e(y).trim()){ye.error("Please fill in all required fields");return}s(ue,!0);try{const I=await lt.post("/api/activity-types",{name:e(S).trim(),code:e(y).trim(),icon:e(ce)});I.success?(s(B,[I.data,...e(B)]),s(S,""),s(y,""),s(ce,"event"),ye.success("Activity type created successfully")):ye.error(I.message)}catch(I){console.error("Error creating activity type:",I),ye.error("Failed to create activity type. Please try again.")}finally{s(ue,!1)}}async function K(I){is.confirm("Remove Activity Type",`<p>Are you sure you want to remove the activity type <strong>"${I.name}"</strong>?</p>`,async()=>{try{const ie=await lt.delete("/api/activity-types",{id:I.id});ie.success?(s(B,e(B).filter(se=>se.id!==I.id)),ye.success(ie.message)):ye.error(ie.message)}catch(ie){console.error("Error removing activity type:",ie),ye.error("Failed to remove activity type. Please try again.")}},null,{size:"small"})}at(()=>e(C),()=>{s(_,ea.find(I=>I.value===e(C)))}),at(()=>e(P),()=>{s(w,ea.find(I=>I.value===e(P)))}),at(()=>(e(Oe),e(D),e(P)),()=>{s(v,e(Oe).filter(I=>{const ie=I.name.toLowerCase().includes(e(D).toLowerCase())||I.code.toLowerCase().includes(e(D).toLowerCase()),se=e(P)?I.gradeLevel===`Grade ${e(P)}`:!0;return ie&&se}))}),at(()=>(e(B),e(Y)),()=>{s(f,e(B).filter(I=>I.name.toLowerCase().includes(e(Y).toLowerCase())||I.code.toLowerCase().includes(e(Y).toLowerCase())))}),at(()=>e(A),()=>{s(p,ea.find(I=>I.value===e(A)))}),ps(),cs();var ke=u_();R("click",Ts,Ie);var Pe=t(ke),de=r(t(Pe),2),$e=t(de);let te;var T=r($e,2);let x;a(de),a(Pe);var $=r(Pe,2);{var Q=I=>{var ie=Kf(),se=t(ie),Ge=r(t(se),2),Ve=t(Ge),Ze=t(Ve),Ye=t(Ze),ga=r(t(Ye),2);let da;var Oa=t(ga);let Ga;var fe=t(Oa);{var O=ua=>{var Ta=If(),Na=r(t(Ta),2),Tt=t(Na),Za=t(Tt,!0);a(Tt),a(Na),a(Ta),b(()=>o(Za,(e(_),l(()=>e(_).label)))),i(ua,Ta)},F=ua=>{var Ta=Pf();i(ua,Ta)};m(fe,ua=>{e(_)?ua(O):ua(F,!1)})}et(2),a(Oa);var J=r(Oa,2);xa(J,5,()=>ea,ua=>ua.value,(ua,Ta)=>{var Na=Gf();let Tt;var Za=r(t(Na),2),nt=t(Za),Wa=t(nt,!0);a(nt);var ft=r(nt,2),ut=t(ft,!0);a(ft),a(Za),a(Na),b(_t=>{Tt=Z(Na,1,"adminsubject-dropdown-option",null,Tt,_t),o(Wa,(e(Ta),l(()=>e(Ta).label))),o(ut,(e(Ta),l(()=>e(Ta).description)))},[()=>({selected:e(C)===e(Ta).value})]),R("click",Na,()=>sa(e(Ta))),i(ua,Na)}),a(J),a(ga),a(Ye);var _e=r(Ye,2),qe=r(t(_e),2);Xa(qe),a(_e);var ia=r(_e,2),na=r(t(ia),2);Xa(na),a(ia),a(Ze);var Ra=r(Ze,2),Ue=t(Ra);let Fe;var Ma=t(Ue);{var dt=ua=>{var Ta=$t("Creating...");i(ua,Ta)},ha=ua=>{var Ta=Rf();et(),i(ua,Ta)};m(Ma,ua=>{e(g)?ua(dt):ua(ha,!1)})}a(Ue),a(Ra),a(Ve),a(Ge),a(se);var ka=r(se,2),La=t(ka),Ya=t(La),oe=r(t(Ya),2),Sa=t(oe),Ba=t(Sa),ht=r(t(Ba),2);Xa(ht);var Et=r(ht,2);{var De=ua=>{var Ta=Mf();R("click",Ta,()=>s(D,"")),i(ua,Ta)};m(Et,ua=>{e(D)&&ua(De)})}a(Ba),a(Sa);var Ee=r(Sa,2);let je;var Da=t(Ee);let ma;var L=t(Da);{var ne=ua=>{var Ta=Of(),Na=r(t(Ta),2),Tt=t(Na),Za=t(Tt,!0);a(Tt),a(Na),a(Ta),b(()=>o(Za,(e(w),l(()=>e(w).label)))),i(ua,Ta)},oa=ua=>{var Ta=Vf();i(ua,Ta)};m(L,ua=>{e(w)?ua(ne):ua(oa,!1)})}et(2),a(Da);var Ea=r(Da,2),Xe=t(Ea);let Ja;var pt=r(Xe,2);xa(pt,1,()=>ea,ua=>ua.value,(ua,Ta)=>{var Na=Uf();let Tt;var Za=r(t(Na),2),nt=t(Za),Wa=t(nt,!0);a(nt);var ft=r(nt,2),ut=t(ft,!0);a(ft),a(Za),a(Na),b(_t=>{Tt=Z(Na,1,"adminsubject-level-category-option",null,Tt,_t),o(Wa,(e(Ta),l(()=>e(Ta).label))),o(ut,(e(Ta),l(()=>e(Ta).description)))},[()=>({selected:e(P)===e(Ta).value})]),R("click",Na,()=>ge(e(Ta))),i(ua,Na)}),a(Ea),a(Ee),a(oe),a(Ya),a(La);var ct=r(La,2),vt=t(ct);{var bt=ua=>{var Ta=Yf();i(ua,Ta)},za=ua=>{var Ta=ja(),Na=va(Ta);xa(Na,1,()=>e(v),Tt=>Tt.id,(Tt,Za)=>{var nt=Jf(),Wa=t(nt),ft=t(Wa),ut=t(ft),_t=t(ut);a(ut),a(ft);var qa=r(ft,2),W=t(qa),he=t(W),ta=t(he),Pa=t(ta,!0);a(ta),a(he),a(W);var st=r(W,2);a(qa),a(Wa);var Ha=r(Wa,2),wa=t(Ha),St=r(t(wa),2),Nt=t(St,!0);a(St),a(wa);var wt=r(wa,2),Ka=r(t(wt),2),Qa=t(Ka);a(Ka),a(wt);var gt=r(wt,2),yt=r(t(gt),2),Mt=t(yt);a(yt),a(gt),a(Ha);var kt=r(Ha,2);{var xt=Gt=>{var Ft=Bf(),Lt=t(Ft),Ht=r(t(Lt),2),G=t(Ht),be=t(G),ra=r(t(be),2);let $a;var pe=t(ra);let ca;var Aa=t(pe);{var ya=mt=>{var Pt=Wf(),Ut=r(t(Pt),2),Rt=t(Ut),Qt=t(Rt,!0);a(Rt),a(Ut),a(Pt),b(()=>o(Qt,(e(p),l(()=>e(p).label)))),i(mt,Pt)},pa=mt=>{var Pt=Hf();i(mt,Pt)};m(Aa,mt=>{e(p)?mt(ya):mt(pa,!1)})}et(2),a(pe);var Ia=r(pe,2);xa(Ia,5,()=>ea,mt=>mt.value,(mt,Pt)=>{var Ut=Qf();let Rt;var Qt=r(t(Ut),2),os=t(Qt),vs=t(os,!0);a(os);var es=r(os,2),ss=t(es,!0);a(es),a(Qt),a(Ut),b(hs=>{Rt=Z(Ut,1,"adminsubject-dropdown-option",null,Rt,hs),o(vs,(e(Pt),l(()=>e(Pt).label))),o(ss,(e(Pt),l(()=>e(Pt).description)))},[()=>({selected:e(A)===e(Pt).value})]),R("click",Ut,()=>Be(e(Pt))),i(mt,Ut)}),a(Ia),a(ra),a(be);var Va=r(be,2),Ca=r(t(Va),2);Xa(Ca),a(Va);var ot=r(Va,2),Ct=r(t(ot),2);Xa(Ct),a(ot),a(G);var Dt=r(G,2),Ot=t(Dt),rt=r(Ot,2),At=t(rt);{var Ua=mt=>{var Pt=$t("Updating...");i(mt,Pt)},it=mt=>{var Pt=$t("Update Subject");i(mt,Pt)};m(At,mt=>{e(M)?mt(Ua):mt(it,!1)})}a(rt),a(Dt),a(Ht),a(Lt),a(Ft),b((mt,Pt,Ut)=>{$a=Z(ra,1,"adminsubject-custom-dropdown",null,$a,mt),ca=Z(pe,1,"adminsubject-dropdown-trigger",null,ca,Pt),rt.disabled=Ut},[()=>({open:e(ae)}),()=>({selected:e(A)}),()=>(e(M),e(H),e(U),e(A),l(()=>e(M)||!e(H).trim()||!e(U).trim()||!e(A)))]),R("click",pe,ze),tt(Ca,()=>e(H),mt=>s(H,mt)),tt(Ct,()=>e(U),mt=>s(U,mt)),R("click",Ot,()=>Re(e(Za))),R("submit",Ht,ks(He)),i(Gt,Ft)};m(kt,Gt=>{e(ee),e(Za),l(()=>e(ee)===e(Za).id)&&Gt(xt)})}a(nt),b(()=>{Fa(nt,"id",`adminsubject-subject-card-${e(Za),l(()=>e(Za).id)??""}`),o(_t,`${e(Za),l(()=>e(Za).name)??""} Â· ${e(Za),l(()=>e(Za).gradeLevel)??""}`),Fa(W,"href",`#adminsubject-subject-card-${e(Za),l(()=>e(Za).id)??""}`),Fa(he,"title",(e(ee),e(Za),l(()=>e(ee)===e(Za).id?"Cancel Edit":"Edit Subject"))),o(Pa,(e(ee),e(Za),l(()=>e(ee)===e(Za).id?"close":"edit"))),o(Nt,(e(Za),l(()=>e(Za).code))),o(Qa,`Created: ${e(Za),l(()=>e(Za).createdDate)??""}`),o(Mt,`Updated: ${e(Za),l(()=>e(Za).updatedDate)??""}`)}),R("click",he,()=>Re(e(Za))),R("click",st,()=>we(e(Za))),i(Tt,nt)},Tt=>{var Za=zf();i(Tt,Za)}),i(ua,Ta)};m(vt,ua=>{e(Te)?ua(bt):ua(za,!1)})}a(ct),a(ka),a(ie),b((ua,Ta,Na,Tt,Za,nt,Wa)=>{da=Z(ga,1,"adminsubject-custom-dropdown",null,da,ua),Ga=Z(Oa,1,"adminsubject-dropdown-trigger",null,Ga,Ta),qe.disabled=!e(C),Fe=Z(Ue,1,"admin-create-button",null,Fe,Na),Ue.disabled=Tt,je=Z(Ee,1,"adminsubject-level-category-filter adminsubject-level-category-dropdown",null,je,Za),ma=Z(Da,1,"adminsubject-level-category-trigger",null,ma,nt),Ja=Z(Xe,1,"adminsubject-level-category-option",null,Ja,Wa)},[()=>({open:e(E)}),()=>({selected:e(C)}),()=>({loading:e(g)}),()=>(e(g),e(C),e(k),l(()=>e(g)||!e(C)||!e(k).trim())),()=>({open:e(q)}),()=>({selected:e(P)}),()=>({selected:e(P)===""})]),R("click",Oa,We),tt(qe,()=>e(k),ua=>s(k,ua)),tt(na,()=>e(N),ua=>s(N,ua)),R("submit",Ve,ks(Qe)),tt(ht,()=>e(D),ua=>s(D,ua)),R("click",Da,xe),R("click",Xe,()=>ge(null)),i(I,ie)};m($,I=>{e(Se)==="subjects"&&I(Q)})}var X=r($,2);{var Le=I=>{var ie=v_(),se=t(ie),Ge=r(t(se),2),Ve=t(Ge),Ze=t(Ve),Ye=t(Ze),ga=r(t(Ye),2);Xa(ga),a(Ye);var da=r(Ye,2),Oa=r(t(da),2);Xa(Oa),a(da);var Ga=r(da,2),fe=r(t(Ga),2);let O;var F=t(fe);let J;var _e=t(F);{var qe=L=>{var ne=Zf(),oa=t(ne),Ea=t(oa,!0);a(oa);var Xe=r(oa,2),Ja=t(Xe),pt=t(Ja,!0);a(Ja),a(Xe),a(ne),b(ct=>{o(Ea,e(ce)),o(pt,ct)},[()=>(e(ce),l(()=>Je(e(ce))))]),i(L,ne)},ia=L=>{var ne=Xf();i(L,ne)};m(_e,L=>{e(ce)?L(qe):L(ia,!1)})}et(2),a(F);var na=r(F,2);xa(na,5,()=>Ke,L=>L.value,(L,ne)=>{var oa=e_();let Ea;var Xe=t(oa),Ja=t(Xe,!0);a(Xe);var pt=r(Xe,2),ct=t(pt),vt=t(ct,!0);a(ct),a(pt),a(oa),b(bt=>{Ea=Z(oa,1,"adminsubject-dropdown-option",null,Ea,bt),o(Ja,(e(ne),l(()=>e(ne).value))),o(vt,(e(ne),l(()=>e(ne).name)))},[()=>({selected:e(ce)===e(ne).value})]),R("click",oa,()=>_a(e(ne).value)),i(L,oa)}),a(na),a(fe),a(Ga),a(Ze);var Ra=r(Ze,2),Ue=t(Ra);let Fe;var Ma=t(Ue);{var dt=L=>{var ne=$t("Creating...");i(L,ne)},ha=L=>{var ne=a_();et(),i(L,ne)};m(Ma,L=>{e(ue)?L(dt):L(ha,!1)})}a(Ue),a(Ra),a(Ve),a(Ge),a(se);var ka=r(se,2),La=t(ka),Ya=t(La),oe=r(t(Ya),2),Sa=t(oe),Ba=t(Sa),ht=r(t(Ba),2);Xa(ht);var Et=r(ht,2);{var De=L=>{var ne=t_();R("click",ne,()=>s(Y,"")),i(L,ne)};m(Et,L=>{e(Y)&&L(De)})}a(Ba),a(Sa),a(oe),a(Ya),a(La);var Ee=r(La,2),je=t(Ee);{var Da=L=>{var ne=ja(),oa=va(ne);xa(oa,1,()=>e(f),Ea=>Ea.id,(Ea,Xe)=>{var Ja=o_(),pt=t(Ja),ct=t(pt),vt=t(ct),bt=t(vt,!0);a(vt),a(ct);var za=r(ct,2),ua=t(za),Ta=t(ua),Na=t(Ta),Tt=t(Na,!0);a(Na),a(Ta),a(ua);var Za=r(ua,2);a(za),a(pt);var nt=r(pt,2),Wa=t(nt),ft=r(t(Wa),2),ut=t(ft,!0);a(ft),a(Wa);var _t=r(Wa,2),qa=t(_t),W=t(qa,!0);a(qa);var he=r(qa,2),ta=t(he);a(he),a(_t);var Pa=r(_t,2),st=r(t(Pa),2),Ha=t(st);a(st),a(Pa);var wa=r(Pa,2),St=r(t(wa),2),Nt=t(St);a(St),a(wa),a(nt);var wt=r(nt,2);{var Ka=Qa=>{var gt=n_(),yt=t(gt),Mt=r(t(yt),2),kt=t(Mt),xt=t(kt),Gt=r(t(xt),2);Xa(Gt),a(xt);var Ft=r(xt,2),Lt=r(t(Ft),2);Xa(Lt),a(Ft);var Ht=r(Ft,2),G=r(t(Ht),2);let be;var ra=t(G);let $a;var pe=t(ra);{var ca=rt=>{var At=s_(),Ua=t(At),it=t(Ua,!0);a(Ua);var mt=r(Ua,2),Pt=t(mt),Ut=t(Pt,!0);a(Pt),a(mt),a(At),b(Rt=>{o(it,e(Me)),o(Ut,Rt)},[()=>(e(Me),l(()=>Je(e(Me))))]),i(rt,At)},Aa=rt=>{var At=r_();i(rt,At)};m(pe,rt=>{e(Me)?rt(ca):rt(Aa,!1)})}et(2),a(ra);var ya=r(ra,2);xa(ya,5,()=>Ke,rt=>rt.value,(rt,At)=>{var Ua=i_();let it;var mt=t(Ua),Pt=t(mt,!0);a(mt);var Ut=r(mt,2),Rt=t(Ut),Qt=t(Rt,!0);a(Rt),a(Ut),a(Ua),b(os=>{it=Z(Ua,1,"adminsubject-dropdown-option",null,it,os),o(Pt,(e(At),l(()=>e(At).value))),o(Qt,(e(At),l(()=>e(At).name)))},[()=>({selected:e(Me)===e(At).value})]),R("click",Ua,()=>u(e(At).value)),i(rt,Ua)}),a(ya),a(G),a(Ht),a(kt);var pa=r(kt,2),Ia=t(pa),Va=t(Ia);a(Ia);var Ca=r(Ia,2);let ot;var Ct=t(Ca);{var Dt=rt=>{var At=$t("Updating...");i(rt,At)},Ot=rt=>{var At=$t("Update Activity Type");i(rt,At)};m(Ct,rt=>{e(Ae)?rt(Dt):rt(Ot,!1)})}a(Ca),a(pa),a(Mt),a(yt),a(gt),b((rt,At,Ua,it)=>{be=Z(G,1,"adminsubject-custom-dropdown",null,be,rt),$a=Z(ra,1,"adminsubject-dropdown-trigger",null,$a,At),Fa(Ia,"href",`#adminactivity-activity-card-${e(Xe),l(()=>e(Xe).id)??""}`),ot=Z(Ca,1,"adminsubject-submit-button",null,ot,Ua),Ca.disabled=it},[()=>({open:e(re)}),()=>({selected:e(Me)}),()=>({loading:e(Ae)}),()=>(e(Ae),e(Ce),e(me),l(()=>e(Ae)||!e(Ce).trim()||!e(me).trim()))]),tt(Gt,()=>e(Ce),rt=>s(Ce,rt)),tt(Lt,()=>e(me),rt=>s(me,rt)),R("click",ra,c),R("click",Va,()=>la(e(Xe))),R("submit",Mt,ks(aa)),i(Qa,gt)};m(wt,Qa=>{e(le),e(Xe),l(()=>e(le)===e(Xe).id)&&Qa(Ka)})}a(Ja),b(Qa=>{Fa(Ja,"id",`adminactivity-activity-card-${e(Xe),l(()=>e(Xe).id)??""}`),o(bt,(e(Xe),l(()=>e(Xe).name))),Fa(ua,"href",`#adminactivity-activity-card-${e(Xe),l(()=>e(Xe).id)??""}`),Fa(Ta,"title",(e(le),e(Xe),l(()=>e(le)===e(Xe).id?"Cancel Edit":"Edit Activity Type"))),o(Tt,(e(le),e(Xe),l(()=>e(le)===e(Xe).id?"close":"edit"))),o(ut,(e(Xe),l(()=>e(Xe).code))),Zt(qa,`color: var(--${e(Xe),l(()=>e(Xe).color)??""}-500)`),o(W,(e(Xe),l(()=>e(Xe).icon))),o(ta,`Icon: ${e(Xe),l(()=>e(Xe).icon)??""}`),o(Ha,`Color: ${e(Xe),l(()=>e(Xe).color)??""}`),o(Nt,`Created: ${Qa??""}`)},[()=>l(()=>new Date().toLocaleDateString())]),R("click",Ta,()=>la(e(Xe))),R("click",Za,()=>K(e(Xe))),i(Ea,Ja)}),i(L,ne)},ma=L=>{var ne=c_(),oa=r(t(ne),2);{var Ea=Ja=>{var pt=l_();i(Ja,pt)},Xe=Ja=>{var pt=d_();i(Ja,pt)};m(oa,Ja=>{e(B),l(()=>e(B).length===0)?Ja(Ea):Ja(Xe,!1)})}a(ne),i(L,ne)};m(je,L=>{e(f),l(()=>e(f).length>0)?L(Da):L(ma,!1)})}a(Ee),a(ka),a(ie),b((L,ne,oa,Ea)=>{O=Z(fe,1,"adminsubject-custom-dropdown",null,O,L),J=Z(F,1,"adminsubject-dropdown-trigger",null,J,ne),Fe=Z(Ue,1,"admin-create-button",null,Fe,oa),Ue.disabled=Ea},[()=>({open:e(ve)}),()=>({selected:e(ce)}),()=>({loading:e(ue)}),()=>(e(ue),e(S),e(y),l(()=>e(ue)||!e(S).trim()||!e(y).trim()))]),tt(ga,()=>e(S),L=>s(S,L)),tt(Oa,()=>e(y),L=>s(y,L)),R("click",F,fa),R("submit",Ve,ks(j)),tt(ht,()=>e(Y),L=>s(Y,L)),i(I,ie)};m(X,I=>{e(Se)==="activities"&&I(Le)})}a(ke),b((I,ie)=>{te=Z($e,1,"admin-tab-button",null,te,I),x=Z(T,1,"admin-tab-button",null,x,ie)},[()=>({active:e(Se)==="subjects"}),()=>({active:e(Se)==="activities"})]),R("click",$e,()=>s(Se,"subjects")),R("click",T,()=>s(Se,"activities")),i(V,ke),Wt()}var p_=n('<span class="material-symbols-outlined">add_ad</span> Create Department',1),f_=n('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),__=n('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),g_=n('<span class="placeholder">Filter by type</span>'),h_=n('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),b_=n('<div class="dept-mgmt-loading"><span class="dept-loader"></span> <p>Loading departments...</p></div>'),y_=n('<div class="dept-mgmt-empty-state"><span class="material-symbols-outlined dept-mgmt-empty-icon">corporate_fare</span> <h3 class="dept-mgmt-empty-title"> </h3> <p class="dept-mgmt-empty-description"> </p></div>'),w_=n('<div class="dept-mgmt-edit-form-section"><div class="dept-mgmt-edit-form-container" id="admin-department-edit-form-container"><div class="dept-mgmt-edit-form-header"><h2 class="dept-mgmt-edit-form-title">Edit Department</h2> <p class="dept-mgmt-edit-form-subtitle">Update department information</p></div> <form class="dept-mgmt-edit-form-content"><div class="dept-mgmt-edit-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-name">Department Name *</label> <input type="text" id="edit-department-name" class="dept-mgmt-form-input" placeholder="Enter department name" required/></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-code">Department Code *</label> <input type="text" id="edit-department-code" class="dept-mgmt-form-input" placeholder="Enter department code" required/></div></div> <div class="dept-mgmt-edit-form-actions"><a><button type="button" class="dept-mgmt-cancel-button">Cancel</button></a> <button type="submit" class="dept-mgmt-update-button"><!></button></div></form></div></div>'),S_=n('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),x_=n('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">subject</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-subject-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),k_=n('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">subject</span> <span>No subjects found</span></div>'),D_=n('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),A_=n('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">person</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-teacher-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),T_=n('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No teachers found</span></div>'),N_=n('<div class="dept-mgmt-assign-form-section"><div class="dept-mgmt-assign-form-container"><div class="dept-mgmt-assign-form-header"><h2 class="dept-mgmt-assign-form-title">Assign Subjects & Teachers</h2> <p class="dept-mgmt-assign-form-subtitle">Select subjects and teachers for this department</p></div> <form class="dept-mgmt-assign-form-content"><div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="subjects"> </label> <div class="dept-mgmt-subject-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search subjects by name or code..." id="subjects"/> <!></div> <div class="dept-mgmt-subject-list"><!> <!></div> <p class="dept-mgmt-form-help">Select subjects that will be managed by this department.</p></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="teachers"> </label> <div class="dept-mgmt-teacher-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search teachers by name or account number..." id="teachers"/> <!></div> <div class="dept-mgmt-teacher-list"><!> <!></div> <p class="dept-mgmt-form-help">Select teachers who will be part of this department.</p></div></div> <div class="dept-mgmt-assign-actions"><button type="button" class="dept-mgmt-cancel-button">Cancel</button> <button type="submit" class="dept-mgmt-assign-submit-button"><!></button></div></form></div></div>'),$_=n('<div><div class="dept-mgmt-department-header"><div class="dept-mgmt-department-title"><h3 class="dept-mgmt-department-name"> </h3></div> <div class="dept-mgmt-action-buttons"><a><button type="button" class="dept-mgmt-assign-button"><span class="material-symbols-outlined"> </span></button></a> <a><button type="button" class="dept-mgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="dept-mgmt-remove-button" title="Remove Department"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="dept-mgmt-department-details"><div class="dept-mgmt-department-code"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="dept-mgmt-department-subjects"><span class="material-symbols-outlined">subject</span> <span> </span></div> <div class="dept-mgmt-department-teachers"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="dept-mgmt-department-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!> <!></div>'),C_=n('<div class="dept-mgmt-container"><div class="dept-mgmt-header"><div class="dept-mgmt-header-content"><h1 class="dept-mgmt-page-title">Department Management</h1> <p class="dept-mgmt-page-subtitle">Create and manage academic departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-create-section"><h2 class="dept-mgmt-section-title">Create New Department</h2> <p class="dept-mgmt-section-subtitle">Add a new academic department to organize subjects and teachers</p> <div class="dept-mgmt-create-form"><div class="dept-mgmt-form-row"><div class="dept-mgmt-form-group"><label for="departmentName" class="dept-mgmt-form-label">Department Name *</label> <input id="departmentName" type="text" placeholder="e.g., Mathematics Department" class="dept-mgmt-form-input"/></div> <div class="dept-mgmt-form-group"><label for="departmentCode" class="dept-mgmt-form-label">Department Code *</label> <input id="departmentCode" type="text" placeholder="e.g., MATH-DEPT" class="dept-mgmt-form-input"/></div></div> <div class="dept-mgmt-form-actions"><button type="submit" class="dept-mgmt-btn-primary"><!></button></div></div></div> <div class="dept-mgmt-departments-section"><div class="dept-mgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="dept-mgmt-section-title">All Departments</h2> <p class="dept-mgmt-section-subtitle">Manage existing departments, assign subjects and teachers</p></div> <div class="dept-mgmt-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search departments by name or code..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div></div></div> <div class="dept-mgmt-departments-grid"><!></div></div></div>');function j_(V,d){Yt(d,!1);const _=h(),w=h(),v=h(),f=h(),p=h();let g=h(!1),C=h([]),k=h([]),N=h(""),E=h(""),q=h(""),D=h([]),P=h([]),Y=h("all"),ee=h(!1),H=h(null),U=h(""),A=h(""),M=h(!1),ae=h(null),Se=h(!1),B=h([]),ue=h([]),S=h(""),y=h(""),ce=h(!1);const ve=[{id:"all",name:"All Departments",icon:"corporate_fare"},{id:"with_subjects",name:"With Subjects",icon:"book"},{id:"with_teachers",name:"With Teachers",icon:"person"},{id:"empty",name:"Empty Departments",icon:"folder_open"}];async function le(){s(ce,!0);try{const O=await lt.get("/api/departments?action=departments");O.success?s(D,O.data.map(F=>({id:F.id,name:F.name,code:F.code,subjects:F.subjects||[],teachers:F.teachers||[],createdAt:F.created_at?F.created_at.split("T")[0]:new Date().toISOString().split("T")[0]}))):ye.error("Failed to load departments")}catch(O){console.error("Error fetching departments:",O),ye.error("Failed to load departments")}finally{s(ce,!1)}}async function Ce(){try{const O=await lt.get("/api/departments?action=subjects");O.success?s(B,O.data.map(F=>({id:F.id,name:F.name,code:F.code,gradeLevel:`Grade ${F.grade_level}`}))):ye.error("Failed to load subjects")}catch(O){console.error("Error fetching subjects:",O),ye.error("Failed to load subjects")}finally{}}async function me(){try{const O=await lt.get("/api/departments?action=teachers");O.success?s(ue,O.data.map(F=>({id:F.id,name:F.full_name||`${F.first_name} ${F.last_name}`,accountNumber:F.account_number}))):ye.error("Failed to load teachers")}catch(O){console.error("Error fetching teachers:",O),ye.error("Failed to load teachers")}finally{}}Bt(async()=>{await Promise.all([le(),Ce(),me()]),Me()});function Me(O=e(D),F=e(Y),J=e(N)){let _e=[...O];F==="with_subjects"?_e=_e.filter(qe=>qe.subjects.length>0):F==="with_teachers"?_e=_e.filter(qe=>qe.teachers.length>0):F==="empty"&&(_e=_e.filter(qe=>qe.subjects.length===0&&qe.teachers.length===0)),J.trim()!==""&&(_e=_e.filter(qe=>qe.name.toLowerCase().includes(J.toLowerCase())||qe.code.toLowerCase().includes(J.toLowerCase()))),s(P,_e)}function Ae(){s(ee,!e(ee))}function re(O){s(Y,O.id),s(ee,!1)}async function Te(){if(!e(E).trim()||!e(q).trim()){ye.error("Please fill in all required fields");return}if(e(D).some(O=>O.code.toLowerCase()===e(q).toLowerCase())){ye.error("Department code already exists");return}s(g,!0);try{const O=await lt.post("/api/departments",{name:e(E).trim(),code:e(q).trim().toUpperCase()});O.success?(await le(),s(E,""),s(q,""),ye.success("Department created successfully")):ye.error(O.error||"Failed to create department")}catch(O){console.error("Error creating department:",O);const F=O.message||"Failed to create department. Please try again.";ye.error(F)}finally{s(g,!1)}}async function Oe(O){if(O.preventDefault(),!e(M)){s(M,!0);try{if(!e(U).trim()||!e(A).trim()){ye.error("Department name and code are required");return}if(e(A).trim().length>20){ye.error("Department code cannot exceed 20 characters");return}if(e(D).find(na=>na.code.toLowerCase()===e(A).trim().toLowerCase()&&na.id!==e(H))){ye.error("Department code already exists");return}const J=e(D).find(na=>na.id===e(H));if(!J)throw new Error("Department not found");const _e=J.teachers?J.teachers.map(na=>na.id):[],qe=J.subjects?J.subjects.map(na=>na.id):[],ia=await lt.put("/api/departments",{id:e(H),name:e(U).trim(),code:e(A).trim().toUpperCase(),teachers:_e,subjects:qe});ia.success?(await le(),s(H,null),s(U,""),s(A,""),ye.success("Department updated successfully")):ye.error(ia.error||"Failed to update department")}catch(F){console.error("Error updating department:",F);const J=F.message||"Failed to update department. Please try again.";ye.error(J)}finally{s(M,!1)}}}function ea(O){e(H)===O.id?(s(H,null),s(U,""),s(A,"")):(e(ae)===O.id&&(s(ae,null),s(C,[]),s(k,[]),s(S,""),s(y,"")),s(H,O.id),s(U,O.name),s(A,O.code))}function Ke(O){is.confirm("Remove Department",`<p>Are you sure you want to remove the department <strong>"${O.name}"</strong>?</p>
			 <p class="warning-text">This action will also remove all subject and teacher assignments.</p>`,async()=>{try{const F=await lt.delete("/api/departments",{id:O.id,name:O.name});F.success?(await le(),ye.success("Department removed successfully")):ye.error(F.error||"Failed to remove department")}catch(F){console.error("Error removing department:",F),ye.error("Failed to remove department. Please try again.")}},()=>{},{size:"small"})}function z(O){e(ae)===O.id?(s(ae,null),s(C,[]),s(k,[]),s(S,""),s(y,"")):(e(H)===O.id&&(s(H,null),s(U,""),s(A,"")),s(ae,O.id),s(C,O.subjects?O.subjects.map(F=>F.id):[]),s(k,O.teachers?O.teachers.map(F=>F.id):[]),s(S,""),s(y,""))}function Ne(O){e(C).findIndex(J=>J===O.id)>-1?s(C,e(C).filter(J=>J!==O.id)):s(C,[...e(C),O.id])}function Qe(O){e(k).findIndex(J=>J===O.id)>-1?s(k,e(k).filter(J=>J!==O.id)):s(k,[...e(k),O.id])}function we(){if(e(f).every(F=>e(C).some(J=>J===F.id)))s(C,e(C).filter(F=>!e(f).some(J=>J.id===F)));else{const F=e(f).filter(J=>!e(C).some(_e=>_e===J.id)).map(J=>J.id);s(C,[...e(C),...F])}}function ze(){if(e(p).every(F=>e(k).some(J=>J===F.id)))s(k,e(k).filter(F=>!e(p).some(J=>J.id===F)));else{const F=e(p).filter(J=>!e(k).some(_e=>_e===J.id)).map(J=>J.id);s(k,[...e(k),...F])}}async function Be(){s(Se,!0);try{const O=e(D).find(_e=>_e.id===e(ae));if(!O)throw new Error("Department not found");const F={id:e(ae),name:O.name,code:O.code,teachers:e(k),subjects:e(C)},J=await lt.put("/api/departments",F);if(!J.success)throw new Error(J.error||"Failed to update assignments");s(D,e(D).map(_e=>{if(_e.id===e(ae)){const qe=e(B).filter(na=>e(C).includes(na.id)),ia=e(ue).filter(na=>e(k).includes(na.id));return{..._e,subjects:qe,teachers:ia}}return _e})),ye.success("Department assignments updated successfully"),s(ae,null),s(C,[]),s(k,[])}catch(O){console.error("Error assigning department:",O),ye.error("Failed to update assignments. Please try again.")}finally{s(Se,!1)}}function We(O){return O.subjects||[]}function sa(O){return O.teachers||[]}function xe(O){}function ge(O){if(!O)return"";const F=O.split("-");return F.length===3?`${F[1]}-${F[2]}-${F[0]}`:O}at(()=>e(Y),()=>{s(_,ve.find(O=>O.id===e(Y)))}),at(()=>(e(D),e(Y),e(N)),()=>{e(D)&&Me(e(D),e(Y),e(N))}),at(()=>(e(B),e(S)),()=>{s(w,e(B).filter(O=>O.name.toLowerCase().includes(e(S).toLowerCase())||O.code.toLowerCase().includes(e(S).toLowerCase())))}),at(()=>(e(ue),e(y)),()=>{s(v,e(ue).filter(O=>O.name.toLowerCase().includes(e(y).toLowerCase())||O.accountNumber.toLowerCase().includes(e(y).toLowerCase())))}),at(()=>(e(w),e(C)),()=>{s(f,e(w).sort((O,F)=>{const J=e(C).some(qe=>qe===O.id),_e=e(C).some(qe=>qe===F.id);return J&&!_e?-1:!J&&_e?1:O.name.localeCompare(F.name)}))}),at(()=>(e(v),e(k)),()=>{s(p,e(v).sort((O,F)=>{const J=e(k).some(qe=>qe===O.id),_e=e(k).some(qe=>qe===F.id);return J&&!_e?-1:!J&&_e?1:O.name.localeCompare(F.name)}))}),ps(),cs();var Ie=C_();R("click",Ts,xe);var fa=r(t(Ie),2),_a=r(t(fa),4),Je=t(_a),Re=t(Je),He=r(t(Re),2);Xa(He),a(Re);var la=r(Re,2),aa=r(t(la),2);Xa(aa),a(la),a(Je);var c=r(Je,2),u=t(c),j=t(u);{var K=O=>{var F=$t("Creating...");i(O,F)},ke=O=>{var F=p_();et(),i(O,F)};m(j,O=>{e(g)?O(K):O(ke,!1)})}a(u),a(c),a(_a),a(fa);var Pe=r(fa,2),de=t(Pe),$e=t(de),te=r(t($e),2),T=t(te),x=t(T),$=r(t(x),2);Xa($);var Q=r($,2);{var X=O=>{var F=f_();R("click",F,()=>s(N,"")),i(O,F)};m(Q,O=>{e(N)&&O(X)})}a(x),a(T);var Le=r(T,2),I=t(Le);let ie;var se=t(I);let Ge;var Ve=t(se);{var Ze=O=>{var F=__(),J=t(F),_e=t(J,!0);a(J);var qe=r(J,2),ia=t(qe),na=t(ia,!0);a(ia),a(qe),a(F),b(()=>{o(_e,(e(_),l(()=>e(_).icon))),o(na,(e(_),l(()=>e(_).name)))}),i(O,F)},Ye=O=>{var F=g_();i(O,F)};m(Ve,O=>{e(_)?O(Ze):O(Ye,!1)})}et(2),a(se);var ga=r(se,2);xa(ga,5,()=>ve,O=>O.id,(O,F)=>{var J=h_();let _e;var qe=t(J),ia=t(qe,!0);a(qe);var na=r(qe,2),Ra=t(na),Ue=t(Ra,!0);a(Ra),a(na),a(J),b(Fe=>{_e=Z(J,1,"dropdown-option",null,_e,Fe),o(ia,(e(F),l(()=>e(F).icon))),o(Ue,(e(F),l(()=>e(F).name)))},[()=>({selected:e(Y)===e(F).id})]),R("click",J,()=>re(e(F))),i(O,J)}),a(ga),a(I),a(Le),a(te),a($e),a(de);var da=r(de,2),Oa=t(da);{var Ga=O=>{var F=b_();i(O,F)},fe=O=>{var F=ja(),J=va(F);{var _e=ia=>{var na=y_(),Ra=r(t(na),2),Ue=t(Ra,!0);a(Ra);var Fe=r(Ra,2),Ma=t(Fe,!0);a(Fe),a(na),b(()=>{o(Ue,e(N)?"No departments found":"No departments created yet"),o(Ma,e(N)?"Try adjusting your search terms":"Create your first department to get started")}),i(ia,na)},qe=ia=>{var na=ja(),Ra=va(na);xa(Ra,1,()=>e(P),Ue=>Ue.id,(Ue,Fe)=>{var Ma=$_();let dt;var ha=t(Ma),ka=t(ha),La=t(ka),Ya=t(La,!0);a(La),a(ka);var oe=r(ka,2),Sa=t(oe),Ba=t(Sa),ht=t(Ba),Et=t(ht,!0);a(ht),a(Ba),a(Sa);var De=r(Sa,2),Ee=t(De),je=t(Ee),Da=t(je,!0);a(je),a(Ee),a(De);var ma=r(De,2);a(oe),a(ha);var L=r(ha,2),ne=t(L),oa=r(t(ne),2),Ea=t(oa,!0);a(oa),a(ne);var Xe=r(ne,2),Ja=r(t(Xe),2),pt=t(Ja);a(Ja),a(Xe);var ct=r(Xe,2),vt=r(t(ct),2),bt=t(vt);a(vt),a(ct);var za=r(ct,2),ua=r(t(za),2),Ta=t(ua);a(ua),a(za),a(L);var Na=r(L,2);{var Tt=Wa=>{var ft=w_(),ut=t(ft),_t=r(t(ut),2),qa=t(_t),W=t(qa),he=r(t(W),2);Xa(he),a(W);var ta=r(W,2),Pa=r(t(ta),2);Xa(Pa),a(ta),a(qa);var st=r(qa,2),Ha=t(st),wa=t(Ha);a(Ha);var St=r(Ha,2),Nt=t(St);{var wt=Qa=>{var gt=$t("Updating...");i(Qa,gt)},Ka=Qa=>{var gt=$t("Update Department");i(Qa,gt)};m(Nt,Qa=>{e(M)?Qa(wt):Qa(Ka,!1)})}a(St),a(st),a(_t),a(ut),a(ft),b(()=>{Fa(Ha,"href",`#department-card-${e(Fe),l(()=>e(Fe).id)??""}`),St.disabled=e(M)||!e(U)||!e(A)}),tt(he,()=>e(U),Qa=>s(U,Qa)),tt(Pa,()=>e(A),Qa=>s(A,Qa)),R("click",wa,()=>ea(e(Fe))),R("submit",_t,ks(Oe)),i(Wa,ft)};m(Na,Wa=>{e(H),e(Fe),l(()=>e(H)===e(Fe).id)&&Wa(Tt)})}var Za=r(Na,2);{var nt=Wa=>{var ft=N_(),ut=t(ft),_t=r(t(ut),2),qa=t(_t),W=t(qa),he=t(W),ta=t(he);a(he);var Pa=r(he,2),st=t(Pa);Xa(st);var Ha=r(st,2);{var wa=ya=>{const pa=js(()=>(e(f),e(C),l(()=>e(f).every(ot=>e(C).some(Ct=>Ct===ot.id)))));var Ia=S_(),Va=t(Ia),Ca=t(Va,!0);a(Va),a(Ia),b(()=>{Fa(Ia,"title",`${e(pa)?"Deselect All":"Select All"} (${e(f),l(()=>e(f).length)??""})`),o(Ca,e(pa)?"deselect":"select_all")}),R("click",Ia,we),i(ya,Ia)};m(Ha,ya=>{e(f),l(()=>e(f).length>0)&&ya(wa)})}a(Pa);var St=r(Pa,2),Nt=t(St);xa(Nt,1,()=>e(f),ya=>ya.id,(ya,pa)=>{var Ia=x_();let Va;var Ca=t(Ia),ot=r(t(Ca),2),Ct=t(ot,!0);a(ot);var Dt=r(ot,2),Ot=t(Dt);a(Dt),a(Ca);var rt=r(Ca,2),At=t(rt),Ua=t(At,!0);a(At),a(rt),a(Ia),b((it,mt)=>{Va=Z(Ia,1,"dept-mgmt-subject-item",null,Va,it),o(Ct,(e(pa),l(()=>e(pa).name))),o(Ot,`${e(pa),l(()=>e(pa).code)??""} â¢ ${e(pa),l(()=>e(pa).gradeLevel)??""}`),o(Ua,mt)},[()=>({selected:e(C).some(it=>it===e(pa).id)}),()=>(e(C),e(pa),l(()=>e(C).some(it=>it===e(pa).id)?"check_box":"check_box_outline_blank"))]),R("click",Ia,()=>Ne(e(pa))),i(ya,Ia)});var wt=r(Nt,2);{var Ka=ya=>{var pa=k_();i(ya,pa)};m(wt,ya=>{e(f),l(()=>e(f).length===0)&&ya(Ka)})}a(St),et(2),a(W);var Qa=r(W,2),gt=t(Qa),yt=t(gt);a(gt);var Mt=r(gt,2),kt=t(Mt);Xa(kt);var xt=r(kt,2);{var Gt=ya=>{const pa=js(()=>(e(p),e(k),l(()=>e(p).every(ot=>e(k).some(Ct=>Ct===ot.id)))));var Ia=D_(),Va=t(Ia),Ca=t(Va,!0);a(Va),a(Ia),b(()=>{Fa(Ia,"title",`${e(pa)?"Deselect All":"Select All"} (${e(p),l(()=>e(p).length)??""})`),o(Ca,e(pa)?"deselect":"select_all")}),R("click",Ia,ze),i(ya,Ia)};m(xt,ya=>{e(p),l(()=>e(p).length>0)&&ya(Gt)})}a(Mt);var Ft=r(Mt,2),Lt=t(Ft);xa(Lt,1,()=>e(p),ya=>ya.id,(ya,pa)=>{var Ia=A_();let Va;var Ca=t(Ia),ot=r(t(Ca),2),Ct=t(ot,!0);a(ot);var Dt=r(ot,2),Ot=t(Dt,!0);a(Dt),a(Ca);var rt=r(Ca,2),At=t(rt),Ua=t(At,!0);a(At),a(rt),a(Ia),b((it,mt)=>{Va=Z(Ia,1,"dept-mgmt-teacher-item",null,Va,it),o(Ct,(e(pa),l(()=>e(pa).name))),o(Ot,(e(pa),l(()=>e(pa).accountNumber))),o(Ua,mt)},[()=>({selected:e(k).some(it=>it===e(pa).id)}),()=>(e(k),e(pa),l(()=>e(k).some(it=>it===e(pa).id)?"check_box":"check_box_outline_blank"))]),R("click",Ia,()=>Qe(e(pa))),i(ya,Ia)});var Ht=r(Lt,2);{var G=ya=>{var pa=T_();i(ya,pa)};m(Ht,ya=>{e(p),l(()=>e(p).length===0)&&ya(G)})}a(Ft),et(2),a(Qa),a(qa);var be=r(qa,2),ra=t(be),$a=r(ra,2),pe=t($a);{var ca=ya=>{var pa=$t("Assigning...");i(ya,pa)},Aa=ya=>{var pa=$t("Update");i(ya,pa)};m(pe,ya=>{e(Se)?ya(ca):ya(Aa,!1)})}a($a),a(be),a(_t),a(ut),a(ft),b(()=>{o(ta,`Select Subjects (${e(C),l(()=>e(C).length)??""} selected)`),o(yt,`Select Teachers (${e(k),l(()=>e(k).length)??""} selected)`),$a.disabled=e(Se)}),tt(st,()=>e(S),ya=>s(S,ya)),tt(kt,()=>e(y),ya=>s(y,ya)),R("click",ra,()=>z(e(Fe))),R("submit",_t,ks(Be)),i(Wa,ft)};m(Za,Wa=>{e(ae),e(Fe),l(()=>e(ae)===e(Fe).id)&&Wa(nt)})}a(Ma),b((Wa,ft,ut,_t)=>{dt=Z(Ma,1,"dept-mgmt-department-card",null,dt,Wa),Fa(Ma,"id",`department-card-${e(Fe),l(()=>e(Fe).id)??""}`),o(Ya,(e(Fe),l(()=>e(Fe).name))),Fa(Sa,"href",`#department-card-${e(Fe),l(()=>e(Fe).id)??""}`),Fa(Ba,"title",(e(ae),e(Fe),l(()=>e(ae)===e(Fe).id?"Cancel Assign":"Assign"))),o(Et,(e(ae),e(Fe),l(()=>e(ae)===e(Fe).id?"close":"add_circle"))),Fa(De,"href",`#department-card-${e(Fe),l(()=>e(Fe).id)??""}`),Fa(Ee,"title",(e(H),e(Fe),l(()=>e(H)===e(Fe).id?"Cancel Edit":"Edit Department"))),o(Da,(e(H),e(Fe),l(()=>e(H)===e(Fe).id?"close":"edit"))),o(Ea,(e(Fe),l(()=>e(Fe).code))),o(pt,`${ft??""} Subjects`),o(bt,`${ut??""} Teachers`),o(Ta,`Created: ${_t??""}`)},[()=>({editing:e(H)===e(Fe).id,assigning:e(ae)===e(Fe).id}),()=>(e(Fe),l(()=>We(e(Fe)).length)),()=>(e(Fe),l(()=>sa(e(Fe)).length)),()=>(e(Fe),l(()=>ge(e(Fe).createdAt)))]),R("click",Ba,()=>z(e(Fe))),R("click",Ee,()=>ea(e(Fe))),R("click",ma,()=>Ke(e(Fe))),i(Ue,Ma)}),i(ia,na)};m(J,ia=>{e(P),l(()=>e(P).length===0)?ia(_e):ia(qe,!1)},!0)}i(O,F)};m(Oa,O=>{e(ce)?O(Ga):O(fe,!1)})}a(da),a(Pe),a(Ie),b((O,F)=>{He.disabled=e(g),aa.disabled=e(g),u.disabled=e(g)||!e(E)||!e(q),ie=Z(I,1,"custom-dropdown",null,ie,O),Ge=Z(se,1,"dropdown-trigger filter-trigger",null,Ge,F)},[()=>({open:e(ee)}),()=>({selected:e(Y)!=="all"})]),tt(He,()=>e(E),O=>s(E,O)),tt(aa,()=>e(q),O=>s(q,O)),R("click",u,Te),tt($,()=>e(N),O=>s(N,O)),R("click",se,Ae),i(V,Ie),Wt()}var E_=n('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),q_=n('<span class="admindocreq-placeholder">All Statuses</span>'),F_=n('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),L_=n('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),I_=n('<span class="admindocreq-placeholder">All Document Types</span>'),P_=n('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),G_=n('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),R_=n('<span class="admindocreq-placeholder">All Grades</span>'),M_=n('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),O_=n('<span class="material-symbols-outlined">pause_circle</span> <span>On Hold</span>',1),V_=n('<span class="material-symbols-outlined">fact_check</span> <span>Verifying</span>',1),U_=n('<span class="material-symbols-outlined">sync</span> <span>For Processing</span>',1),Y_=n('<span class="material-symbols-outlined">hand_package</span> <span>For Pick up</span>',1),W_=n('<div><div class="docreq-request-header"><div class="docreq-request-info"><div class="docreq-student-info"><h3 class="docreq-student-name"> </h3></div></div> <div class="docreq-action-buttons"><div><!></div></div></div> <div class="docreq-request-details"><div class="docreq-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">description</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">payments</span> <span> </span></div></div></div>'),H_=n('<div class="admin-document-requests-container"><div class="admin-docreq-header"><div class="admin-header-content"><h1 class="admin-page-title">Document Requests</h1> <p class="admin-page-subtitle">Manage and process student document requests</p></div></div> <div class="docreq-status-cards-section"><div class="docreq-status-cards-grid"><div class="docreq-status-card docreq-status-onhold"><div class="docreq-status-icon"><span class="material-symbols-outlined">pause_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">On Hold</p></div></div> <div class="docreq-status-card docreq-status-verifying"><div class="docreq-status-icon"><span class="material-symbols-outlined">fact_check</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Verifying</p></div></div> <div class="docreq-status-card docreq-status-processing"><div class="docreq-status-icon"><span class="material-symbols-outlined">sync</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Processing</p></div></div> <div class="docreq-status-card docreq-status-pickup"><div class="docreq-status-icon"><span class="material-symbols-outlined">hand_package</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">For Pickup</p></div></div> <div class="docreq-status-card docreq-status-released"><div class="docreq-status-icon"><span class="material-symbols-outlined">check_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Released</p></div></div></div></div> <div class="admin-docreq-filters-section"><div class="admin-section-header"><h2 class="admin-section-title">Filter Requests</h2> <p class="admin-section-subtitle">Search and filter document requests</p></div> <div class="admindocreq-filters-container"><div class="admindocreq-search-container"><input type="text" placeholder="Search by student name, ID, or document type..." class="admindocreq-search-input"/> <span class="material-symbols-outlined admindocreq-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Statuses</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Document Types</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Grades</span></div></button> <!></div></div></div></div> <div class="admin-docreq-requests-section"><div class="docreq-section-header"><div class="docreq-section-header-content"><div class="docreq-section-title-group"><h2 class="docreq-section-title">Document Requests</h2> <p class="docreq-section-subtitle">Manage and review all student document requests</p></div></div></div> <div class="docreq-requests-grid"></div></div></div>');function Q_(V,d){Yt(d,!1);const _=h(),w=h(),v=h();let f=[{id:1,studentId:"STU-2024-001",gradeLevel:"Grade 10",studentName:"Johny Bravo",documentType:"Transcript",requestId:"REQ-002",submittedDate:"01/15/2024",payment:"â±120",status:"on_hold",isUrgent:!1},{id:2,studentId:"STU-2024-001",gradeLevel:"Grade 10",studentName:"Johny Bravo",documentType:"TOR",requestId:"REQ-002",submittedDate:"01/15/2024",payment:"â±120",status:"verifying",isUrgent:!1},{id:3,studentId:"STU-2024-001",gradeLevel:"Grade 10",studentName:"Johny Bravo",documentType:"Grade Slip",requestId:"REQ-002",submittedDate:"01/15/2024",payment:"â±120",status:"processing",isUrgent:!1},{id:4,studentId:"STU-2024-001",gradeLevel:"Grade 10",studentName:"Johny Bravo",documentType:"Good Moral",requestId:"REQ-002",submittedDate:"01/15/2024",payment:"â±120",status:"for_pickup",isUrgent:!1}],p=h(""),g=h(""),C=h(""),k=h(""),N=h(!1),E=h(!1),q=h(!1);const D=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],P=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}],Y=[{id:"pending",name:"Pending",description:"Awaiting review"},{id:"on_hold",name:"On Hold",description:"Temporarily suspended"},{id:"verifying",name:"Verifying",description:"Under verification"},{id:"processing",name:"Processing",description:"Currently being processed"},{id:"for_pickup",name:"For Pickup",description:"Ready for pickup"},{id:"released",name:"Released",description:"Successfully released"},{id:"completed",name:"Completed",description:"Ready for pickup/download"},{id:"rejected",name:"Rejected",description:"Request denied"},{id:"cancelled",name:"Cancelled",description:"Cancelled by student"}];function ee(){s(N,!e(N)),s(E,!1),s(q,!1)}function H(){s(E,!e(E)),s(N,!1),s(q,!1)}function U(){s(q,!e(q)),s(N,!1),s(E,!1)}function A(F){F?s(g,F.id):s(g,""),s(N,!1)}function M(F){F?s(C,F.id):s(C,""),s(E,!1)}function ae(F){F?s(k,F.value):s(k,""),s(q,!1)}function Se(F){F.target.closest(".admindocreq-status-filter")||s(N,!1),F.target.closest(".admindocreq-doctype-filter")||s(E,!1),F.target.closest(".admindocreq-grade-filter")||s(q,!1)}at(()=>e(g),()=>{s(_,Y.find(F=>F.id===e(g)))}),at(()=>e(C),()=>{s(w,P.find(F=>F.id===e(C)))}),at(()=>e(k),()=>{s(v,D.find(F=>F.value===e(k)))}),ps(),cs();var B=H_();R("click",Ts,Se);var ue=r(t(B),2),S=t(ue),y=t(S),ce=r(t(y),2),ve=t(ce),le=t(ve,!0);a(ve),et(2),a(ce),a(y);var Ce=r(y,2),me=r(t(Ce),2),Me=t(me),Ae=t(Me,!0);a(Me),et(2),a(me),a(Ce);var re=r(Ce,2),Te=r(t(re),2),Oe=t(Te),ea=t(Oe,!0);a(Oe),et(2),a(Te),a(re);var Ke=r(re,2),z=r(t(Ke),2),Ne=t(z),Qe=t(Ne,!0);a(Ne),et(2),a(z),a(Ke);var we=r(Ke,2),ze=r(t(we),2),Be=t(ze),We=t(Be,!0);a(Be),et(2),a(ze),a(we),a(S),a(ue);var sa=r(ue,2),xe=r(t(sa),2),ge=t(xe),Ie=t(ge);Xa(Ie),et(2),a(ge);var fa=r(ge,2);let _a;var Je=t(fa);let Re;var He=t(Je);{var la=F=>{var J=E_(),_e=r(t(J),2),qe=t(_e),ia=t(qe,!0);a(qe),a(_e),a(J),b(()=>o(ia,(e(_),l(()=>e(_).name)))),i(F,J)},aa=F=>{var J=q_();i(F,J)};m(He,F=>{e(_)?F(la):F(aa,!1)})}et(2),a(Je);var c=r(Je,2),u=t(c);let j;var K=r(u,2);xa(K,1,()=>Y,F=>F.id,(F,J)=>{var _e=F_();let qe;var ia=r(t(_e),2),na=t(ia),Ra=t(na,!0);a(na);var Ue=r(na,2),Fe=t(Ue,!0);a(Ue),a(ia),a(_e),b(Ma=>{qe=Z(_e,1,"admindocreq-dropdown-option",null,qe,Ma),o(Ra,(e(J),l(()=>e(J).name))),o(Fe,(e(J),l(()=>e(J).description)))},[()=>({selected:e(g)===e(J).id})]),R("click",_e,()=>A(e(J))),i(F,_e)}),a(c),a(fa);var ke=r(fa,2);let Pe;var de=t(ke);let $e;var te=t(de);{var T=F=>{var J=L_(),_e=r(t(J),2),qe=t(_e),ia=t(qe,!0);a(qe),a(_e),a(J),b(()=>o(ia,(e(w),l(()=>e(w).name)))),i(F,J)},x=F=>{var J=I_();i(F,J)};m(te,F=>{e(w)?F(T):F(x,!1)})}et(2),a(de);var $=r(de,2),Q=t($);let X;var Le=r(Q,2);xa(Le,1,()=>P,F=>F.id,(F,J)=>{var _e=P_();let qe;var ia=r(t(_e),2),na=t(ia),Ra=t(na,!0);a(na);var Ue=r(na,2),Fe=t(Ue,!0);a(Ue),a(ia),a(_e),b(Ma=>{qe=Z(_e,1,"admindocreq-dropdown-option",null,qe,Ma),o(Ra,(e(J),l(()=>e(J).name))),o(Fe,(e(J),l(()=>e(J).description)))},[()=>({selected:e(C)===e(J).id})]),R("click",_e,()=>M(e(J))),i(F,_e)}),a($),a(ke);var I=r(ke,2);let ie;var se=t(I);let Ge;var Ve=t(se);{var Ze=F=>{var J=G_(),_e=r(t(J),2),qe=t(_e),ia=t(qe,!0);a(qe),a(_e),a(J),b(()=>o(ia,(e(v),l(()=>e(v).label)))),i(F,J)},Ye=F=>{var J=R_();i(F,J)};m(Ve,F=>{e(v)?F(Ze):F(Ye,!1)})}et(2),a(se);var ga=r(se,2),da=t(ga);let Oa;var Ga=r(da,2);xa(Ga,1,()=>D,F=>F.value,(F,J)=>{var _e=M_();let qe;var ia=r(t(_e),2),na=t(ia),Ra=t(na,!0);a(na);var Ue=r(na,2),Fe=t(Ue,!0);a(Ue),a(ia),a(_e),b(Ma=>{qe=Z(_e,1,"admindocreq-dropdown-option",null,qe,Ma),o(Ra,(e(J),l(()=>e(J).label))),o(Fe,(e(J),l(()=>e(J).description)))},[()=>({selected:e(k)===e(J).value})]),R("click",_e,()=>ae(e(J))),i(F,_e)}),a(ga),a(I),a(xe),a(sa);var fe=r(sa,2),O=r(t(fe),2);xa(O,5,()=>f,F=>F.id,(F,J)=>{var _e=W_(),qe=t(_e),ia=t(qe),na=t(ia),Ra=t(na),Ue=t(Ra,!0);a(Ra),a(na),a(ia);var Fe=r(ia,2),Ma=t(Fe),dt=t(Ma);{var ha=ct=>{var vt=O_();et(2),i(ct,vt)},ka=ct=>{var vt=ja(),bt=va(vt);{var za=Ta=>{var Na=V_();et(2),i(Ta,Na)},ua=Ta=>{var Na=ja(),Tt=va(Na);{var Za=Wa=>{var ft=U_();et(2),i(Wa,ft)},nt=Wa=>{var ft=ja(),ut=va(ft);{var _t=qa=>{var W=Y_();et(2),i(qa,W)};m(ut,qa=>{e(J),l(()=>e(J).status==="for_pickup")&&qa(_t)},!0)}i(Wa,ft)};m(Tt,Wa=>{e(J),l(()=>e(J).status==="processing")?Wa(Za):Wa(nt,!1)},!0)}i(Ta,Na)};m(bt,Ta=>{e(J),l(()=>e(J).status==="verifying")?Ta(za):Ta(ua,!1)},!0)}i(ct,vt)};m(dt,ct=>{e(J),l(()=>e(J).status==="on_hold")?ct(ha):ct(ka,!1)})}a(Ma),a(Fe),a(qe);var La=r(qe,2),Ya=t(La),oe=r(t(Ya),2),Sa=t(oe,!0);a(oe),a(Ya);var Ba=r(Ya,2),ht=r(t(Ba),2),Et=t(ht,!0);a(ht),a(Ba);var De=r(Ba,2),Ee=r(t(De),2),je=t(Ee,!0);a(Ee),a(De);var Da=r(De,2),ma=r(t(Da),2),L=t(ma);a(ma),a(Da);var ne=r(Da,2),oa=r(t(ne),2),Ea=t(oa);a(oa),a(ne);var Xe=r(ne,2),Ja=r(t(Xe),2),pt=t(Ja,!0);a(Ja),a(Xe),a(La),a(_e),b(()=>{Z(_e,1,`docreq-request-card status-${e(J),l(()=>e(J).status)??""}-border`),o(Ue,(e(J),l(()=>e(J).studentName))),Z(Ma,1,`docreq-status-badge docreq-status-${e(J),l(()=>e(J).status)??""}`),o(Sa,(e(J),l(()=>e(J).studentId))),o(Et,(e(J),l(()=>e(J).gradeLevel))),o(je,(e(J),l(()=>e(J).documentType))),o(L,`ID: ${e(J),l(()=>e(J).requestId)??""}`),o(Ea,`Requested: ${e(J),l(()=>e(J).submittedDate)??""}`),o(pt,(e(J),l(()=>e(J).payment)))}),i(F,_e)}),a(O),a(fe),a(B),b((F,J,_e,qe,ia,na,Ra,Ue,Fe,Ma,dt,ha,ka,La)=>{o(le,F),o(Ae,J),o(ea,_e),o(Qe,qe),o(We,ia),_a=Z(fa,1,"admindocreq-status-filter admindocreq-custom-dropdown",null,_a,na),Re=Z(Je,1,"admindocreq-dropdown-trigger",null,Re,Ra),j=Z(u,1,"admindocreq-dropdown-option",null,j,Ue),Pe=Z(ke,1,"admindocreq-doctype-filter admindocreq-custom-dropdown",null,Pe,Fe),$e=Z(de,1,"admindocreq-dropdown-trigger",null,$e,Ma),X=Z(Q,1,"admindocreq-dropdown-option",null,X,dt),ie=Z(I,1,"admindocreq-grade-filter admindocreq-custom-dropdown",null,ie,ha),Ge=Z(se,1,"admindocreq-dropdown-trigger",null,Ge,ka),Oa=Z(da,1,"admindocreq-dropdown-option",null,Oa,La)},[()=>l(()=>f.filter(F=>F.status==="on_hold").length),()=>l(()=>f.filter(F=>F.status==="verifying").length),()=>l(()=>f.filter(F=>F.status==="processing").length),()=>l(()=>f.filter(F=>F.status==="for_pickup").length),()=>l(()=>f.filter(F=>F.status==="released").length),()=>({open:e(N)}),()=>({selected:e(g)}),()=>({selected:e(g)===""}),()=>({open:e(E)}),()=>({selected:e(C)}),()=>({selected:e(C)===""}),()=>({open:e(q)}),()=>({selected:e(k)}),()=>({selected:e(k)===""})]),tt(Ie,()=>e(p),F=>s(p,F)),R("click",Je,ee),R("click",u,()=>A(null)),R("click",de,H),R("click",Q,()=>M(null)),R("click",se,U),R("click",da,()=>ae(null)),i(V,B),Wt()}function B_(V,d,_,w,v){is.confirm("Change Password",`
			<div class="admin-settings-password-form">
				<div class="admin-settings-form-group">
					<label for="current-password">Current Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="new-password">New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,d,()=>{s(_,""),s(w,""),s(v,"")},{size:"medium"})}var J_=n('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),z_=n('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),K_=n('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),Z_=n('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),X_=n('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),eg=n('<span class="material-symbols-outlined">check</span> Apply Date Changes',1),ag=n('<div class="admin-settings-container"><div class="admin-settings-header"><div class="admin-settings-header-content"><h1 class="admin-settings-page-title">Admin Settings</h1> <p class="admin-settings-page-subtitle">Manage system settings and configurations</p></div></div> <div class="admin-settings-section"><div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Current School Year</h3> <p class="admin-settings-item-description">The active academic year for the system</p></div> <div class="admin-settings-item-value"><span class="admin-settings-current-year"> </span></div></div></div></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">School Year Dates</h3> <p class="admin-settings-item-description">Set the start and end dates for classes</p></div></div> <div class="admin-settings-dates-section"><div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="start-date" class="admin-settings-date-label">Start of Classes</label> <input id="start-date" type="date"/></div> <div class="admin-settings-date-item"><label for="end-date" class="admin-settings-date-label">End of Classes</label> <input id="end-date" type="date"/></div></div> <div class="admin-settings-quarters-section svelte-jysw9o"><h4 class="admin-settings-quarters-title svelte-jysw9o">Quarter Schedules</h4> <div class="admin-settings-quarters-row svelte-jysw9o"><div class="admin-settings-quarter-group quarter-1 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">1st Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q1-start" class="admin-settings-date-label">Start</label> <input id="q1-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q1-end" class="admin-settings-date-label">End</label> <input id="q1-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-2 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">2nd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q2-start" class="admin-settings-date-label">Start</label> <input id="q2-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q2-end" class="admin-settings-date-label">End</label> <input id="q2-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-3 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">3rd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q3-start" class="admin-settings-date-label">Start</label> <input id="q3-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q3-end" class="admin-settings-date-label">End</label> <input id="q3-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-4 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">4th Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q4-start" class="admin-settings-date-label">Start</label> <input id="q4-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q4-end" class="admin-settings-date-label">End</label> <input id="q4-end" type="date"/></div></div> <!></div></div></div> <!></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><!></button></div></div></div></div> <div class="admin-settings-section"><div class="admin-settings-section-header"><h2 class="admin-settings-section-title">Account Security</h2> <p class="admin-settings-section-subtitle">Manage your account password and security settings</p></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Password</h3> <p class="admin-settings-item-description">Change your account password for security</p></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div></div>');function tg(V,d){Yt(d,!0);let _=ba(!1),w=ba(!1),v=ba("2024-2025"),f=ba(""),p=ba("");function g(oe,Sa){if(!oe||!Sa)return"2024-2025";const Ba=new Date(oe),ht=new Date(Sa),Et=Ba.getFullYear(),De=ht.getFullYear();return De>Et?`${Et}-${De}`:`${Et}-${Et}`}let C=ba(""),k=ba(""),N=ba(""),E=ba(""),q=ba(""),D=ba(""),P=ba(""),Y=ba("");async function ee(){try{s(_,!0);const oe=await lt.get("/api/admin-settings");if(oe.success){let Ba=function(ht){if(!ht)return ht;const[Et,De,Ee]=ht.split("-");return`${Ee}-${Et}-${De}`};const Sa=oe.data;s(f,Ba(Sa.school_year_start_date)||"",!0),s(p,Ba(Sa.school_year_end_date)||"",!0),s(v,g(e(f),e(p)),!0),s(C,Ba(Sa.quarter_1_start_date)||"",!0),s(k,Ba(Sa.quarter_1_end_date)||"",!0),s(N,Ba(Sa.quarter_2_start_date)||"",!0),s(E,Ba(Sa.quarter_2_end_date)||"",!0),s(q,Ba(Sa.quarter_3_start_date)||"",!0),s(D,Ba(Sa.quarter_3_end_date)||"",!0),s(P,Ba(Sa.quarter_4_start_date)||"",!0),s(Y,Ba(Sa.quarter_4_end_date)||"",!0)}}catch(oe){console.error("Error loading admin settings:",oe),Xt("Failed to load admin settings")}finally{s(_,!1)}}async function H(){try{let oe=function(ht){if(!ht)return ht;const[Et,De,Ee]=ht.split("-");return`${De}-${Ee}-${Et}`};s(w,!0);const Sa={current_school_year:e(v),school_year_start_date:oe(e(f)),school_year_end_date:oe(e(p)),quarter_1_start_date:oe(e(C)),quarter_1_end_date:oe(e(k)),quarter_2_start_date:oe(e(N)),quarter_2_end_date:oe(e(E)),quarter_3_start_date:oe(e(q)),quarter_3_end_date:oe(e(D)),quarter_4_start_date:oe(e(P)),quarter_4_end_date:oe(e(Y))},Ba=await lt.put("/api/admin-settings",{settings:Sa});if(Ba.success)Os("Admin settings saved successfully");else throw new Error(Ba.error||"Failed to save settings")}catch(oe){console.error("Error saving admin settings:",oe),Xt("Failed to save admin settings")}finally{s(w,!1)}}let U=ba("");Is(()=>{if(e(f)&&e(p)){const oe=new Date(e(f)),Sa=new Date(e(p));oe>=Sa?s(U,"Start date must be before end date"):(s(U,""),s(v,g(e(f),e(p)),!0))}else s(U,"")});let A={quarter1:"",quarter2:"",quarter3:"",quarter4:""};Is(()=>{if(e(C)&&e(k)){const oe=new Date(e(C)),Sa=new Date(e(k));oe>=Sa?A.quarter1="1st Quarter start date must be before end date":A.quarter1=""}else A.quarter1="";if(e(N)&&e(E)){const oe=new Date(e(N)),Sa=new Date(e(E));oe>=Sa?A.quarter2="2nd Quarter start date must be before end date":A.quarter2=""}else A.quarter2="";if(e(q)&&e(D)){const oe=new Date(e(q)),Sa=new Date(e(D));oe>=Sa?A.quarter3="3rd Quarter start date must be before end date":A.quarter3=""}else A.quarter3="";if(e(P)&&e(Y)){const oe=new Date(e(P)),Sa=new Date(e(Y));oe>=Sa?A.quarter4="4th Quarter start date must be before end date":A.quarter4=""}else A.quarter4=""});async function M(){if(e(U)){console.error("Cannot apply changes: Date validation error");return}if(Object.values(A).some(Sa=>Sa!=="")){console.error("Cannot apply changes: Quarter validation errors");return}await H()}let ae=ba(""),Se=ba(""),B=ba(""),ue=ba(!1);function S(oe){const Sa=document.getElementById(oe),ht=Sa.nextElementSibling.querySelector(".password-eye-icon");Sa.type==="password"?(Sa.type="text",ht.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(Sa.type="password",ht.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=S);async function y(){const oe=document.getElementById("current-password"),Sa=document.getElementById("new-password"),Ba=document.getElementById("confirm-password");if(!oe||!Sa||!Ba){Xt("Password form inputs not found");return}const ht=oe.value,Et=Sa.value,De=Ba.value;if(!ht){Xt("Current password is required");return}if(!Et){Xt("New password is required");return}if(Et!==De){Xt("New passwords do not match");return}if(Et.length<8){Xt("Password must be at least 8 characters long");return}if(ht===Et){Xt("New password must be different from current password");return}try{s(ue,!0);const Ee=await lt.post("/api/change-password",{currentPassword:ht,newPassword:Et});Ee.success?(oe.value="",Sa.value="",Ba.value="",Os("Password changed successfully!"),is.close()):Xt(Ee.error||"Failed to change password")}catch(Ee){console.error("Password change error:",Ee),Xt(Ee.message||"Failed to change password")}finally{s(ue,!1)}}Bt(()=>{ee()});var ce=ag(),ve=r(t(ce),2),le=t(ve),Ce=t(le),me=t(Ce),Me=r(t(me),2),Ae=t(Me),re=t(Ae,!0);a(Ae),a(Me),a(me),a(Ce),a(le);var Te=r(le,2),Oe=t(Te),ea=r(t(Oe),2),Ke=t(ea),z=t(Ke),Ne=r(t(z),2);Xa(Ne);let Qe;a(z);var we=r(z,2),ze=r(t(we),2);Xa(ze);let Be;a(we),a(Ke);var We=r(Ke,2),sa=r(t(We),2),xe=t(sa),ge=r(t(xe),2),Ie=t(ge),fa=r(t(Ie),2);Xa(fa);let _a;a(Ie);var Je=r(Ie,2),Re=r(t(Je),2);Xa(Re);let He;a(Je),a(ge);var la=r(ge,2);{var aa=oe=>{var Sa=J_(),Ba=r(t(Sa));a(Sa),b(()=>o(Ba,` ${A.quarter1??""}`)),i(oe,Sa)};m(la,oe=>{A.quarter1&&oe(aa)})}a(xe);var c=r(xe,2),u=r(t(c),2),j=t(u),K=r(t(j),2);Xa(K);let ke;a(j);var Pe=r(j,2),de=r(t(Pe),2);Xa(de);let $e;a(Pe),a(u);var te=r(u,2);{var T=oe=>{var Sa=z_(),Ba=r(t(Sa));a(Sa),b(()=>o(Ba,` ${A.quarter2??""}`)),i(oe,Sa)};m(te,oe=>{A.quarter2&&oe(T)})}a(c);var x=r(c,2),$=r(t(x),2),Q=t($),X=r(t(Q),2);Xa(X);let Le;a(Q);var I=r(Q,2),ie=r(t(I),2);Xa(ie);let se;a(I),a($);var Ge=r($,2);{var Ve=oe=>{var Sa=K_(),Ba=r(t(Sa));a(Sa),b(()=>o(Ba,` ${A.quarter3??""}`)),i(oe,Sa)};m(Ge,oe=>{A.quarter3&&oe(Ve)})}a(x);var Ze=r(x,2),Ye=r(t(Ze),2),ga=t(Ye),da=r(t(ga),2);Xa(da);let Oa;a(ga);var Ga=r(ga,2),fe=r(t(Ga),2);Xa(fe);let O;a(Ga),a(Ye);var F=r(Ye,2);{var J=oe=>{var Sa=Z_(),Ba=r(t(Sa));a(Sa),b(()=>o(Ba,` ${A.quarter4??""}`)),i(oe,Sa)};m(F,oe=>{A.quarter4&&oe(J)})}a(Ze),a(sa),a(We);var _e=r(We,2);{var qe=oe=>{var Sa=X_(),Ba=r(t(Sa));a(Sa),b(()=>o(Ba,` ${e(U)??""}`)),i(oe,Sa)};m(_e,oe=>{e(U)&&oe(qe)})}a(ea);var ia=r(ea,2),na=t(ia);na.__click=M;var Ra=t(na);{var Ue=oe=>{var Sa=$t("Saving...");i(oe,Sa)},Fe=oe=>{var Sa=eg();et(),i(oe,Sa)};m(Ra,oe=>{e(w)?oe(Ue):oe(Fe,!1)})}a(na),a(ia),a(Oe),a(Te),a(ve);var Ma=r(ve,2),dt=r(t(Ma),2),ha=t(dt),ka=t(ha),La=r(t(ka),2),Ya=t(La);Ya.__click=[B_,y,ae,Se,B],a(La),a(ka),a(ha),a(dt),a(Ma),a(ce),b((oe,Sa,Ba,ht,Et,De,Ee,je,Da,ma)=>{o(re,e(v)),Qe=Z(Ne,1,"admin-settings-date-input",null,Qe,oe),Be=Z(ze,1,"admin-settings-date-input",null,Be,Sa),_a=Z(fa,1,"admin-settings-date-input quarter-1-input",null,_a,Ba),He=Z(Re,1,"admin-settings-date-input quarter-1-input",null,He,ht),ke=Z(K,1,"admin-settings-date-input quarter-2-input",null,ke,Et),$e=Z(de,1,"admin-settings-date-input quarter-2-input",null,$e,De),Le=Z(X,1,"admin-settings-date-input quarter-3-input",null,Le,Ee),se=Z(ie,1,"admin-settings-date-input quarter-3-input",null,se,je),Oa=Z(da,1,"admin-settings-date-input quarter-4-input",null,Oa,Da),O=Z(fe,1,"admin-settings-date-input quarter-4-input",null,O,ma),na.disabled=e(w)||e(_)||!!e(U)||A.quarter1||A.quarter2||A.quarter3||A.quarter4||!e(f)||!e(p)},[()=>({error:e(U)}),()=>({error:e(U)}),()=>({error:A.quarter1}),()=>({error:A.quarter1}),()=>({error:A.quarter2}),()=>({error:A.quarter2}),()=>({error:A.quarter3}),()=>({error:A.quarter3}),()=>({error:A.quarter4}),()=>({error:A.quarter4})]),tt(Ne,()=>e(f),oe=>s(f,oe)),tt(ze,()=>e(p),oe=>s(p,oe)),tt(fa,()=>e(C),oe=>s(C,oe)),tt(Re,()=>e(k),oe=>s(k,oe)),tt(K,()=>e(N),oe=>s(N,oe)),tt(de,()=>e(E),oe=>s(E,oe)),tt(X,()=>e(q),oe=>s(q,oe)),tt(ie,()=>e(D),oe=>s(D,oe)),tt(da,()=>e(P),oe=>s(P,oe)),tt(fe,()=>e(Y),oe=>s(Y,oe)),i(V,ce),Wt()}Ds(["click"]);var sg=n('<meta name="description" content="High School Student Information System"/>'),rg=n('<div><!> <main class="content-area"><!></main> <!></div>'),ig=n('<div><!> <main class="content-area"><!></main> <!></div>'),ng=n('<div><!> <main class="content-area"><!></main> <!></div>'),og=n('<div class="app-container"><!></div>');function pg(V,d){Yt(d,!0);let _=ba(void 0);Is(()=>ls.subscribe(y=>{s(_,y,!0)}));let w=ba("grades"),v=ba("schedule"),f=ba("dashboard"),p=ba(!1),g=ba(!1),C=ba(!1);function k(S){typeof S=="string"?s(w,S,!0):s(w,S.detail.section,!0)}function N(S){typeof S=="string"?s(v,S,!0):s(v,S.detail.section,!0),(typeof S=="string"?S:S.detail.section)!=="class-list"&&s(D,null)}function E(S){const{yearLevel:y,sectionName:ce,sectionId:ve}=S.detail;s(D,{yearLevel:y,sectionName:ce,sectionId:ve},!0),s(v,"class-list")}function q(){s(D,null),s(v,"students")}let D=ba(null);function P(S){s(f,S.detail.section,!0)}function Y(){s(f,"settings")}function ee(){s(p,!e(p))}function H(){s(g,!e(g))}function U(){s(C,!e(C))}async function A(){await ls.logout(),s(w,"grades"),s(v,"schedule"),s(f,"dashboard")}let M=jt(()=>e(_)?.isAuthenticated?e(_).userType==="student"?"Student Portal - High School":e(_).userType==="teacher"?"Teacher Portal - High School":e(_).userType==="admin"?"Admin Portal - High School":"High School Student Information System":"Login - High School Student Information System");var ae=og();Ti(S=>{var y=sg();b(()=>Ni.title=e(M)),i(S,y)});var Se=t(ae);{var B=S=>{hn(S,{})},ue=S=>{var y=ja(),ce=va(y);{var ve=Ce=>{var me=rg();let Me;var Ae=t(me);{let z=jt(()=>e(_).userData?.name||"Student"),Ne=jt(()=>e(_).userData?.firstName||"Student"),Qe=jt(()=>e(_).userData?.gender||"male"),we=jt(()=>e(_).userData?.accountNumber||"N/A"),ze=jt(()=>e(_).userData?.profileImage);Tn(Ae,{get studentName(){return e(z)},get firstName(){return e(Ne)},get gender(){return e(Qe)},get accountNumber(){return e(we)},get profileImage(){return e(ze)},onlogout:A,onToggleNavRail:ee,onnavigate:k})}var re=r(Ae,2),Te=t(re);{var Oe=z=>{io(z,{})},ea=z=>{var Ne=ja(),Qe=va(Ne);{var we=Be=>{Fo(Be,{})},ze=Be=>{var We=ja(),sa=va(We);{var xe=Ie=>{Jo(Ie,{})},ge=Ie=>{var fa=ja(),_a=va(fa);{var Je=He=>{dl(He,{})},Re=He=>{var la=ja(),aa=va(la);{var c=j=>{kl(j,{})},u=j=>{var K=ja(),ke=va(K);{var Pe=de=>{Hl(de,{})};m(ke,de=>{e(w)==="todo"&&de(Pe)},!0)}i(j,K)};m(aa,j=>{e(w)==="notifications"?j(c):j(u,!1)},!0)}i(He,la)};m(_a,He=>{e(w)==="documents"?He(Je):He(Re,!1)},!0)}i(Ie,fa)};m(sa,Ie=>{e(w)==="schedule"?Ie(xe):Ie(ge,!1)},!0)}i(Be,We)};m(Qe,Be=>{e(w)==="grades"?Be(we):Be(ze,!1)},!0)}i(z,Ne)};m(Te,z=>{e(w)==="profile"?z(Oe):z(ea,!1)})}a(re);var Ke=r(re,2);Rn(Ke,{get activeSection(){return e(w)},get isNavRailVisible(){return e(p)},onnavigate:k}),a(me),b(z=>Me=Z(me,1,"student-portal",null,Me,z),[()=>({"nav-rail-collapsed":!e(p)})]),i(Ce,me)},le=Ce=>{var me=ja(),Me=va(me);{var Ae=Te=>{var Oe=ig();let ea;var Ke=t(Oe);{let Be=jt(()=>e(_).userData?.name||"Teacher"),We=jt(()=>e(_).userData?.firstName||"Teacher"),sa=jt(()=>e(_).userData?.gender||"male"),xe=jt(()=>e(_).userData?.accountNumber||"N/A"),ge=jt(()=>e(_).userData?.profileImage);ad(Ke,{get teacherName(){return e(Be)},get firstName(){return e(We)},get gender(){return e(sa)},get accountNumber(){return e(xe)},get profileImage(){return e(ge)},onlogout:A,onToggleNavRail:H,onnavigate:N})}var z=r(Ke,2),Ne=t(z);{var Qe=Be=>{$d(Be,{})},we=Be=>{var We=ja(),sa=va(We);{var xe=Ie=>{Jd(Ie,{})},ge=Ie=>{var fa=ja(),_a=va(fa);{var Je=He=>{li(He,{onNavigateToClassList:E})},Re=He=>{var la=ja(),aa=va(la);{var c=j=>{Ic(j,{get selectedClass(){return e(D)},onBackToClassManagement:q})},u=j=>{var K=ja(),ke=va(K);{var Pe=$e=>{Kc($e,{})},de=$e=>{li($e,{onNavigateToClassList:E})};m(ke,$e=>{e(v)==="advisory"?$e(Pe):$e(de,!1)},!0)}i(j,K)};m(aa,j=>{e(v)==="class-list"&&e(D)?j(c):j(u,!1)},!0)}i(He,la)};m(_a,He=>{e(v)==="students"?He(Je):He(Re,!1)},!0)}i(Ie,fa)};m(sa,Ie=>{e(v)==="schedule"?Ie(xe):Ie(ge,!1)},!0)}i(Be,We)};m(Ne,Be=>{e(v)==="profile"?Be(Qe):Be(we,!1)})}a(z);var ze=r(z,2);od(ze,{get teacherActiveSection(){return e(v)},get teacherNavRailVisible(){return e(g)},onnavigate:N}),a(Oe),b(Be=>ea=Z(Oe,1,"teacher-portal",null,ea,Be),[()=>({"nav-rail-collapsed":!e(g)})]),i(Te,Oe)},re=Te=>{var Oe=ja(),ea=va(Oe);{var Ke=z=>{var Ne=ng();let Qe;var we=t(Ne);{let ge=jt(()=>e(_).userData?.name||"Admin"),Ie=jt(()=>e(_).userData?.firstName||"Admin"),fa=jt(()=>e(_).userData?.gender||"male"),_a=jt(()=>e(_).userData?.accountNumber||"N/A"),Je=jt(()=>e(_).userData?.profileImage);nv(we,{get adminName(){return e(ge)},get firstName(){return e(Ie)},get gender(){return e(fa)},get accountNumber(){return e(_a)},get profileImage(){return e(Je)},onlogout:A,onToggleNavRail:U,onNavigateToSettings:Y})}var ze=r(we,2),Be=t(ze);{var We=ge=>{Iv(ge,{})},sa=ge=>{var Ie=ja(),fa=va(Ie);{var _a=Re=>{Du(Re,{})},Je=Re=>{var He=ja(),la=va(He);{var aa=u=>{Qu(u,{})},c=u=>{var j=ja(),K=va(j);{var ke=de=>{_m(de,{})},Pe=de=>{var $e=ja(),te=va($e);{var T=$=>{Cm($,{})},x=$=>{var Q=ja(),X=va(Q);{var Le=ie=>{Lf(ie)},I=ie=>{var se=ja(),Ge=va(se);{var Ve=Ye=>{j_(Ye,{})},Ze=Ye=>{var ga=ja(),da=va(ga);{var Oa=fe=>{m_(fe,{})},Ga=fe=>{var O=ja(),F=va(O);{var J=qe=>{Q_(qe,{})},_e=qe=>{var ia=ja(),na=va(ia);{var Ra=Ue=>{tg(Ue,{})};m(na,Ue=>{e(f)==="settings"&&Ue(Ra)},!0)}i(qe,ia)};m(F,qe=>{e(f)==="document-requests"?qe(J):qe(_e,!1)},!0)}i(fe,O)};m(da,fe=>{e(f)==="subjects-and-activities"?fe(Oa):fe(Ga,!1)},!0)}i(Ye,ga)};m(Ge,Ye=>{e(f)==="department-management"?Ye(Ve):Ye(Ze,!1)},!0)}i(ie,se)};m(X,ie=>{e(f)==="schedule-management"?ie(Le):ie(I,!1)},!0)}i($,Q)};m(te,$=>{e(f)==="student-grades-list"?$(T):$(x,!1)},!0)}i(de,$e)};m(K,de=>{e(f)==="archived-students"?de(ke):de(Pe,!1)},!0)}i(u,j)};m(la,u=>{e(f)==="student-masterlist"?u(aa):u(c,!1)},!0)}i(Re,He)};m(fa,Re=>{e(f)==="account-creation"?Re(_a):Re(Je,!1)},!0)}i(ge,Ie)};m(Be,ge=>{e(f)==="dashboard"?ge(We):ge(sa,!1)})}a(ze);var xe=r(ze,2);Dv(xe,{get adminActiveSection(){return e(f)},get adminNavRailVisible(){return e(C)},onnavigate:P}),a(Ne),b(ge=>Qe=Z(Ne,1,"admin-portal",null,Qe,ge),[()=>({"nav-rail-collapsed":!e(C)})]),i(z,Ne)};m(ea,z=>{e(_).userType==="admin"&&z(Ke)},!0)}i(Te,Oe)};m(Me,Te=>{e(_).userType==="teacher"?Te(Ae):Te(re,!1)},!0)}i(Ce,me)};m(ce,Ce=>{e(_).userType==="student"?Ce(ve):Ce(le,!1)},!0)}i(S,y)};m(Se,S=>{e(_)?.isAuthenticated?S(ue,!1):S(B)})}a(ae),i(V,ae),Wt()}export{pg as component};
