const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../assets/odometer-theme-default.DMiGbRSv.css"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{h as Wr,aL as js,q as Pt,ae as Na,_ as Es,ad as Wt,Q as s,t as o,z as t,A as a,B as r,aV as Xa,l as e,w as g,C as l,aS as q,x as i,y as It,ah as Ut,R as ri,v as da,i as Ws,ag as Ta,O as p,aX as fs,aY as Ya,aZ as ds,m as Zt,aT as Fs,j as n,a_ as br,ai as kt,Z as qs,a$ as gr,b0 as ii,b1 as ni,aK as or,aR as oi,b2 as li,aU as di,b3 as ci}from"../chunks/CzqljEhS.js";import{i as m,p as xt,a as _s,c as bs,b as hr,d as Yr}from"../chunks/ByzzCBZf.js";import{d as vi,c as ls,f as Js,g as os,r as Ba,s as W,h as yr,a as Da,e as ma,t as ne,m as es,i as Xt,b as Za,j as ui,T as mi,k as pi}from"../chunks/ByMP2zVz.js";import{i as is}from"../chunks/BfPXC66o.js";import{_ as Hr}from"../chunks/D9Z9MdNV.js";const fi=!0;function ks(z,d,u,h){var b=z.__style;if(Wr||b!==d){var y=vi(d);(!Wr||y!==z.getAttribute("style"))&&(y==null?z.removeAttribute("style"):z.style.cssText=y),z.__style=d}return h}function wr(z){return function(...d){var u=d[0];return u.stopPropagation(),z?.apply(this,d)}}function As(z){return function(...d){var u=d[0];return u.preventDefault(),z?.apply(this,d)}}const Kr=fi,Zr=z=>{const d=/^[A-Z]{3}-\d{4}-\d{4}$/;return z?d.test(z)?"":"Please enter a valid ID Number (e.g., STU-2025-0001)":"ID Number is required"},Xr=z=>z?"":"Password is required",ei=()=>document.documentElement.getAttribute("data-theme")||"light",_i=z=>{document.documentElement.setAttribute("data-theme",z),localStorage.setItem("theme",z)},gi=()=>{const d=ei()==="dark"?"light":"dark";return _i(d),d},bi=async({accountNumber:z,password:d})=>{try{const h=await(await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountNumber:z,password:d})})).json();if(h.success){const b={id:h.user.id,name:h.user.name,firstName:h.user.firstName,gender:h.user.gender,accountNumber:h.user.accountNumber,accountType:h.user.accountType,isAuthenticated:!0};return ls.login(b.accountType,b),Js(`Login successful! Welcome back, ${b.name}.`),console.log("Login successful:",{accountNumber:z,userType:b.accountType}),b}else throw new Error(h.error||"Invalid credentials. Please try again.")}catch(u){const h=u.message||"Network error. Please try again.";throw os(h),new Error(h)}};function hi(z,d){const u=gi();s(d,u==="dark")}const yi=(z,d,u)=>{s(d,z.target.value,!0),e(u).idNumber&&s(u,{...e(u),idNumber:Zr(e(d))},!0)},wi=(z,d,u)=>{s(d,z.target.value,!0),e(u).password&&s(u,{...e(u),password:Xr(e(d))},!0)},Jr=(z,d)=>{z.key==="Enter"&&(z.preventDefault(),d(z))};var Si=o('<div class="error-text"> </div>'),xi=(z,d)=>{z.preventDefault(),z.stopPropagation(),s(d,!e(d))},ki=(z,d)=>{z.key==="Enter"&&(z.preventDefault(),z.stopPropagation(),s(d,!e(d)))},Ai=o('<div class="error-text"> </div>'),Di=(z,d)=>{z.key==="Enter"&&(z.preventDefault(),d(z))},Ti=o('<div class="login-loading-spinner"></div>'),Ni=o("<span>Login</span>"),ji=o('<div class="login-container"><button class="theme-toggle-btn" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="left-side"><div class="login-header"><h1 class="login-title">Login</h1> <h2 class="login-subtitle">Enter your account details</h2></div> <form class="login-form" novalidate="" autocomplete="off"><div class="form-field"><div><span class="leading-icon material-symbols-outlined">badge</span> <input type="text" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="idnumber-input">ID Number</label></div> <!></div> <div class="form-field"><div><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="password-input">Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div> <!></div> <button id="login-submit-btn" type="submit" class="custom-filled-button login-submit" aria-label="Sign in"><!></button> <button type="button" id="forgot-password-btn" class="custom-text-button forgot-password" aria-label="forgot-password">Forgot Password?</button></form></div> <div class="right-side"><div class="welcome-text"><h1 class="welcome-title">Welcome</h1> <p class="welcome-subtitle">Login to access your account</p></div></div></div>');function $i(z,d){Pt(d,!0);let u=Na(""),h=Na(""),b=Na(!1),y=Na(!1),S=Na(Es({idNumber:"",password:"",general:""})),_=Na(!1);Wt(()=>{const be=ei();s(_,be==="dark")});const E=async be=>{be.preventDefault(),s(S,{idNumber:"",password:"",general:""},!0);const _e=Zr(e(u)),fe=Xr(e(h));if(_e||fe){s(S,{idNumber:_e,password:fe,general:""},!0);return}s(b,!0);try{await bi({accountNumber:e(u),password:e(h)})}catch(ke){s(S,{...e(S),general:ke.message},!0)}finally{s(b,!1)}};var w=ji(),$=t(w);$.__click=[hi,_];var P=t($),V=t(P,!0);a(P),a($);var D=r($,2),L=r(t(D),2),T=t(L),se=t(T),pe=r(t(se),2);Ba(pe),pe.__input=[yi,u,S],pe.__keydown=[Jr,E],Xa(2),a(se);var N=r(se,2);{var G=be=>{var _e=Si(),fe=t(_e,!0);a(_e),g(()=>l(fe,e(S).idNumber)),i(be,_e)};m(N,be=>{e(S).idNumber&&be(G)})}a(T);var H=r(T,2),I=t(H),re=r(t(I),2);Ba(re),re.__input=[wi,h,S],re.__keydown=[Jr,E];var M=r(re,4);M.__click=[xi,y],M.__keydown=[ki,y];var C=t(M),R=t(C,!0);a(C),a(M),a(I);var B=r(I,2);{var de=be=>{var _e=Ai(),fe=t(_e,!0);a(_e),g(()=>l(fe,e(S).password)),i(be,_e)};m(B,be=>{e(S).password&&be(de)})}a(H);var xe=r(H,2);xe.__keydown=[Di,E];var ue=t(xe);{var X=be=>{var _e=Ti();i(be,_e)},qe=be=>{var _e=Ni();i(be,_e)};m(ue,be=>{e(b)?be(X):be(qe,!1)})}a(xe),Xa(2),a(L),a(D),Xa(2),a(w),g(()=>{l(V,e(_)?"light_mode":"dark_mode"),W(se,1,`custom-text-field ${e(S).idNumber?"error":""}`),yr(pe,e(u)),W(I,1,`custom-text-field ${e(S).password?"error":""}`),Da(re,"type",e(y)?"text":"password"),yr(re,e(h)),Da(M,"aria-label",e(y)?"Hide password":"Show password"),l(R,e(y)?"visibility":"visibility_off"),xe.disabled=e(b)}),q("submit",L,E),i(z,w),It()}js(["click","input","keydown"]);function Ci(z,d){s(d,!e(d))}function qi(z,d,u){s(d,!e(d)),u()}var Ei=o('<img alt="Profile" class="avatar-image"/>'),Fi=o('<div class="avatar-placeholder"> </div>'),Li=(z,d,u)=>{d(),u.onnavigate("profile")},Pi=async(z,d,u)=>{d(),await u.onlogout(),Js("Logged out successfully. See you next time!")},Ii=o('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Gi=o('<nav class="student-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">school</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function Mi(z,d){Pt(d,!0);let u=xt(d,"studentName",3,"John Does"),h=xt(d,"firstName",3,"John"),b=xt(d,"gender",3,"male"),y=xt(d,"accountNumber",3,"STU-2025-0001"),S=xt(d,"profileImage",3,null);function _(U){return U==="female"?"Ms.":"Mr."}let E=Ut(()=>`${_(b())} ${h()}`),w=Na(!0),$=Na(!1);function P(){s($,!1)}function V(U){e($)&&!U.target.closest(".user-profile-container")&&P()}Wt(()=>{const U=localStorage.getItem("theme");return s(w,U!=="light"),D(),document.addEventListener("click",V),()=>{document.removeEventListener("click",V)}});function D(){e(w)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function L(U){return U.split(" ").map(he=>he.charAt(0)).join("").toUpperCase().slice(0,2)}var T=Gi(),se=t(T),pe=t(se),N=t(pe);N.__click=function(...U){d.onToggleNavRail?.apply(this,U)};var G=r(N,2),H=r(t(G),2),I=t(H);a(H),a(G),a(pe);var re=r(pe,2),M=t(re);M.__click=[qi,w,D];var C=t(M),R=t(C,!0);a(C),a(M);var B=r(M,2),de=t(B);de.__click=[Ci,$];var xe=t(de),ue=t(xe),X=t(ue,!0);a(ue);var qe=r(ue,2),be=t(qe);a(qe),a(xe);var _e=r(xe,2),fe=t(_e);{var ke=U=>{var he=Ei();g(()=>Da(he,"src",S())),i(U,he)},Ve=U=>{var he=Fi(),Ze=t(he,!0);a(he),g(K=>l(Ze,K),[()=>L(h())]),i(U,he)};m(fe,U=>{S()?U(ke):U(Ve,!1)})}a(_e),a(de);var ye=r(de,2);{var Oe=U=>{var he=Ii(),Ze=t(he);Ze.__click=[Li,P,d];var K=r(Ze,2);K.__click=[Pi,P,d],a(he),i(U,he)};m(ye,U=>{e($)&&U(Oe)})}a(B),a(re),a(se),a(T),g(()=>{l(I,`Welcome, ${e(E)??""}`),l(R,e(w)?"light_mode":"dark_mode"),l(X,u()),l(be,`Account: ${y()??""}`)}),i(z,T),It()}js(["click"]);async function ps(z,d={}){const u=ri(ls),h={"Content-Type":"application/json",...d.headers};if(u.isAuthenticated&&u.userData){const y={id:u.userData.id,name:u.userData.name,account_number:u.userData.accountNumber,account_type:u.userData.account_type||u.userData.accountType};h["x-user-info"]=JSON.stringify(y),h["x-user-id"]=u.userData.id.toString(),h["x-user-account-number"]=u.userData.accountNumber,h["x-user-name"]=encodeURIComponent(u.userData.name)}const b={...d,headers:h};try{return await fetch(z,b)}catch(y){throw console.error("Fetch error:",y),y}}const Qa={get:async(z,d={})=>{const u=await ps(z,{...d,method:"GET"});if(!u.ok)throw new Error(`HTTP ${u.status}: ${u.statusText}`);return u.json()},post:async(z,d,u={})=>{const h=await ps(z,{...u,method:"POST",body:JSON.stringify(d)});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);return h.json()},put:async(z,d,u={})=>{const h=await ps(z,{...u,method:"PUT",body:JSON.stringify(d)});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);return h.json()},delete:async(z,d,u={})=>{const h=await ps(z,{...u,method:"DELETE",body:d?JSON.stringify(d):void 0});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);return h.json()},patch:async(z,d,u={})=>{const h=await ps(z,{...u,method:"PATCH",body:JSON.stringify(d)});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);return h.json()}};var Ri=(z,d,u)=>d(e(u).id),Oi=o('<span class="menu-notification-badge menu-rail-badge"> </span>'),Vi=o('<button><div class="rail-icon-container"><span class="material-symbols-outlined rail-icon"> </span> <!></div> <span class="rail-label"> </span></button>'),Ui=(z,d,u)=>d(e(u).id),Wi=o('<span class="menu-notification-badge menu-nav-badge"> </span>'),Yi=o('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),Hi=(z,d)=>d("todo"),Ji=(z,d,u)=>d(e(u).id),Bi=o('<span class="menu-notification-badge menu-nav-badge"> </span>'),Qi=o('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),zi=o(`<nav role="navigation" aria-label="Student portal navigation"><div class="rail-container"></div></nav> <nav class="bottom-navigation" role="	navigation" aria-label="Student portal navigation"><div class="nav-container"><!> <button aria-label="Todo List"><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon" style="font-variation-settings: 'FILL' 1; font-size: 28px;">checklist</span></div></button> <!></div></nav>`,1);function Ki(z,d){Pt(d,!0);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=xt(d,"activeSection",15,"grades"),S=xt(d,"isNavRailVisible",3,!0),_=Na(0);const E=[{id:"grades",label:"My Grades",icon:"grade"},{id:"schedule",label:"Schedule",icon:"schedule"},{id:"documents",label:"Documents",icon:"description"},{id:"notifications",label:"Notifications",icon:"notifications",hasBadge:!0},{id:"todo",label:"Todo List",icon:"checklist"}];async function w(){if(b().isAuthenticated)try{const re=await ps("/api/notifications?limit=1&offset=0");re.success&&s(_,re.data.unreadCount||0,!0)}catch(re){console.error("Error fetching notification count:",re)}}function $(I){y(I),d.onnavigate&&d.onnavigate({detail:{section:I}})}Wt(()=>{let I;I=ls.subscribe(M=>{M.isAuthenticated&&(w(),I&&I())});const re=setInterval(()=>{b().isAuthenticated&&w()},15e3);return()=>{clearInterval(re),I&&I()}});var P=zi(),V=da(P);let D;var L=t(V);ma(L,21,()=>E,I=>I.id,(I,re)=>{var M=Vi();let C;M.__click=[Ri,$,re];var R=t(M),B=t(R),de=t(B,!0);a(B);var xe=r(B,2);{var ue=be=>{var _e=Oi(),fe=t(_e,!0);a(_e),g(()=>l(fe,e(_)>99?"99+":e(_))),i(be,_e)};m(xe,be=>{e(re).hasBadge&&e(_)>0&&be(ue)})}a(R);var X=r(R,2),qe=t(X,!0);a(X),a(M),g(be=>{C=W(M,1,"rail-item",null,C,be),Da(M,"aria-label",e(re).label),Da(M,"aria-current",e(re).id===y()?"page":void 0),l(de,e(re).icon),l(qe,e(re).label)},[()=>({active:e(re).id===y()})]),i(I,M)}),a(L),a(V);var T=r(V,2),se=t(T),pe=t(se);ma(pe,17,()=>E.slice(0,2),I=>I.id,(I,re)=>{var M=Yi();let C;M.__click=[Ui,$,re];var R=t(M),B=t(R),de=t(B,!0);a(B);var xe=r(B,2);{var ue=X=>{var qe=Wi(),be=t(qe,!0);a(qe),g(()=>l(be,e(_)>99?"99+":e(_))),i(X,qe)};m(xe,X=>{e(re).hasBadge&&e(_)>0&&X(ue)})}a(R),a(M),g(X=>{C=W(M,1,"nav-item",null,C,X),Da(M,"aria-label",e(re).label),Da(M,"aria-current",e(re).id===y()?"page":void 0),l(de,e(re).icon)},[()=>({active:e(re).id===y()})]),i(I,M)});var N=r(pe,2);let G;N.__click=[Hi,$];var H=r(N,2);ma(H,17,()=>E.slice(2,4),I=>I.id,(I,re)=>{var M=Qi();let C;M.__click=[Ji,$,re];var R=t(M),B=t(R),de=t(B,!0);a(B);var xe=r(B,2);{var ue=X=>{var qe=Bi(),be=t(qe,!0);a(qe),g(()=>l(be,e(_)>99?"99+":e(_))),i(X,qe)};m(xe,X=>{e(re).hasBadge&&e(_)>0&&X(ue)})}a(R),a(M),g(X=>{C=W(M,1,"nav-item",null,C,X),Da(M,"aria-label",e(re).label),Da(M,"aria-current",e(re).id===y()?"page":void 0),l(de,e(re).icon)},[()=>({active:e(re).id===y()})]),i(I,M)}),a(se),a(T),g((I,re)=>{D=W(V,1,"navigation-rail",null,D,I),G=W(N,1,"nav-item",null,G,re),Da(N,"aria-current",y()==="todo"?"page":void 0)},[()=>({collapsed:!S()}),()=>({active:y()==="todo"})]),i(z,P),It(),h()}js(["click"]);function Zi(z,d){s(d,!e(d))}function Xi(z,d){s(d,!e(d))}function en(z,d){s(d,!e(d))}function an(z,d){es.confirm("Change Password",`
			<div class="student-profile-password-form">
				<div class="student-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,d,()=>{},{size:"medium"})}var tn=o('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),sn=o('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading student information...</p></div>'),rn=o('<div class="info-row row-five"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="info-content"><div class="info-label">Student ID</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person</span></div> <div class="info-content"><div class="info-label">Full Name</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">school</span></div> <div class="info-content"><div class="info-label">Year Level</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">group</span></div> <div class="info-content"><div class="info-label">Section</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="info-content"><div class="info-label">Total Subjects</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">email</span></div> <div class="info-content"><div class="info-label">Email</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">phone</span></div> <div class="info-content"><div class="info-label">Contact Number</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">family_restroom</span></div> <div class="info-content"><div class="info-label">Guardian</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-one"><div class="info-card address-card"><div class="info-icon"><span class="material-symbols-outlined">home</span></div> <div class="info-content"><div class="info-label">Address</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-two"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">cake</span></div> <div class="info-content"><div class="info-label">Birth Date</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Age</div> <div class="info-value"> </div></div></div></div>',1),nn=o('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading academic performance...</p></div>'),on=o('<div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Adviser</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">grade</span></div> <div class="info-content"><div class="info-label">General Average</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">leaderboard</span></div> <div class="info-content"><div class="info-label">Class Rank</div> <div class="info-value"> </div></div></div></div>'),ln=o('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading enrolled subjects...</p></div>'),dn=o('<div class="subject-card"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p class="teacher-name"> </p></div></div>'),cn=o('<div class="subjects-grid"></div>'),vn=o('<div class="subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects enrolled yet</p></div>'),un=o('<div class="profile-header"><div class="header-content"><h1 class="page-title">Student Profile</h1> <p class="page-subtitle">Personal Information & Academic Details</p></div></div> <div class="profile-info-section"><h2 class="section-title section-title-desktop">Student Information</h2> <button class="section-header-mobile" aria-label="Toggle student information"><h2 class="section-title">Student Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-academic-section"><h2 class="section-title section-title-desktop">Academic Performance</h2> <button class="section-header-mobile" aria-label="Toggle academic performance"><h2 class="section-title">Academic Performance</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-subjects-section"><h2 class="section-title section-title-desktop">Enrolled Subjects</h2> <button class="section-header-mobile" aria-label="Toggle enrolled subjects"><h2 class="section-title">Enrolled Subjects</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-security-section"><h2 class="section-title section-title-desktop">Account Security</h2> <div class="section-content"><div class="info-row row-one"><div class="info-card security-card"><div class="info-content-container"><div class="info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="info-content"><div class="info-label">Password</div> <div class="info-value">Change your account password for security</div></div></div> <div class="security-actions"><button class="security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),mn=o('<div class="profile-container"><!></div>');function pn(z,d){Pt(d,!0);let u=Na(void 0),h=Na(null),b=Na(null),y=Na(!0),S=Na(null);Ws(()=>ls.subscribe(re=>{s(u,re,!0)}));async function _(){try{if(s(y,!0),s(S,null),!e(u)?.userData?.id)throw new Error("User not authenticated");const I=await Qa.get("/api/accounts?type=student&limit=1000");if(!I.success)throw new Error(I.message||"Failed to fetch student data");console.log("API Response:",I),console.log("Auth State User Data:",e(u).userData),console.log("Looking for user ID:",e(u).userData.id),console.log("Looking for account number:",e(u).userData.accountNumber),console.log("Available accounts:",I.accounts.map(M=>({id:M.id,name:M.name,number:M.number})));const re=I.accounts.find(M=>M.id===e(u).userData.id||M.number===e(u).userData.accountNumber);if(!re)throw console.error("User not found in accounts list"),console.error("Auth user ID:",e(u).userData.id),console.error("Auth account number:",e(u).userData.accountNumber),console.error("Available account IDs:",I.accounts.map(M=>M.id)),console.error("Available account numbers:",I.accounts.map(M=>M.number)),new Error("Student data not found");s(h,re,!0),await E()}catch(I){console.error("Error fetching student data:",I),s(S,I.message,!0),ne.error(`Failed to load profile data: ${I.message}`)}finally{s(y,!1)}}async function E(){try{if(!e(u)?.userData?.id)return;const I=await Qa.get(`/api/student-profile?studentId=${e(u).userData.id}`);I.success?(s(b,I.data,!0),console.log("Student Profile Data:",e(b))):console.warn("Failed to fetch student profile data:",I.error)}catch(I){console.warn("Error fetching student profile data:",I)}}Ws(()=>{e(u)?.userData?.id&&_()});let w=Ut(()=>({id:e(h)?.number||e(u)?.userData?.accountNumber||"N/A",name:e(h)?.name||e(u)?.userData?.name||"Student Name",firstName:e(h)?.firstName||e(u)?.userData?.firstName||"",lastName:e(h)?.lastName||"",middleInitial:e(h)?.middleInitial||"",yearLevel:e(h)?.gradeLevel?`Grade ${e(h).gradeLevel}`:"Not assigned",section:e(b)?.section?.name||"Not assigned",email:e(h)?.email||"Not available",phone:e(h)?.contactNumber||"Not available",address:e(h)?.address||"Not available",birthDate:e(h)?.birthdate?new Date(e(h).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(h)?.age||"Not available",guardian:e(h)?.guardian||"Not available",gender:e(h)?.gender||e(u)?.userData?.gender||"male",academicSummary:{adviser:e(b)?.section?.adviser||"Not available",gpa:e(b)?.academicSummary?.generalAverage||"Not available",rank:e(b)?.academicSummary?.classRank||"Not available",totalStudents:e(b)?.academicSummary?.totalStudentsInSection||"Not available"},subjects:e(b)?.subjects||[]})),$=Ut(()=>e(w).subjects.length||"Not available"),P=Na(!0),V=Na(!1),D=Na(!0),L=Na(!1);function T(I){const re=document.getElementById(I),C=re.nextElementSibling.querySelector(".password-eye-icon");re.type==="password"?(re.type="text",C.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(re.type="password",C.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=T);async function se(){const I=document.getElementById("current-password"),re=document.getElementById("new-password"),M=document.getElementById("confirm-password");if(!I||!re||!M){os("Password form inputs not found");return}const C=I.value,R=re.value,B=M.value;if(!C){os("Current password is required");return}if(!R){os("New password is required");return}if(R!==B){os("New passwords do not match");return}if(R.length<8){os("Password must be at least 8 characters long");return}if(C===R){os("New password must be different from current password");return}try{s(L,!0);const de=await Qa.post("/api/change-password",{currentPassword:C,newPassword:R});de.success?(I.value="",re.value="",M.value="",Js("Password changed successfully!"),es.close()):os(de.error||"Failed to change password")}catch(de){console.error("Password change error:",de),os(de.message||"Failed to change password")}finally{s(L,!1)}}var pe=mn(),N=t(pe);{var G=I=>{var re=tn(),M=r(t(re),2),C=t(M);a(M);var R=r(M,2);R.__click=_,a(re),g(()=>l(C,`Failed to load profile data: ${e(S)??""}`)),i(I,re)},H=I=>{var re=un(),M=r(da(re),2),C=r(t(M),2);C.__click=[Zi,P];var R=r(t(C),2);let B;a(C);var de=r(C,2);let xe;var ue=t(de);{var X=J=>{var c=sn();i(J,c)},qe=J=>{var c=rn(),v=da(c),A=t(v),ee=r(t(A),2),Ce=r(t(ee),2),me=t(Ce,!0);a(Ce),a(ee),a(A);var te=r(A,2),Ke=r(t(te),2),f=r(t(Ke),2),k=t(f,!0);a(f),a(Ke),a(te);var oe=r(te,2),Te=r(t(oe),2),Ue=r(t(Te),2),F=t(Ue,!0);a(Ue),a(Te),a(oe);var Ae=r(oe,2),Qe=r(t(Ae),2),We=r(t(Qe),2),Xe=t(We,!0);a(We),a(Qe),a(Ae);var $a=r(Ae,2),xa=r(t($a),2),ie=r(t(xa),2),x=t(ie,!0);a(ie),a(xa),a($a),a(v);var le=r(v,2),Le=t(le),pa=r(t(Le),2),He=r(t(pa),2),sa=t(He,!0);a(He),a(pa),a(Le);var la=r(Le,2),Ee=r(t(la),2),O=r(t(Ee),2),Fe=t(O,!0);a(O),a(Ee),a(la);var ea=r(la,2),qa=r(t(ea),2),Ia=r(t(qa),2),st=t(Ia,!0);a(Ia),a(qa),a(ea),a(le);var ra=r(le,2),ae=t(ra),Re=r(t(ae),2),Y=r(t(Re),2),Se=t(Y,!0);a(Y),a(Re),a(ae),a(ra);var Je=r(ra,2),Be=t(Je),ge=r(t(Be),2),De=r(t(ge),2),ua=t(De,!0);a(De),a(ge),a(Be);var Pa=r(Be,2),et=r(t(Pa),2),Ea=r(t(et),2),ot=t(Ea,!0);a(Ea),a(et),a(Pa),a(Je),g(()=>{l(me,e(w).id),l(k,e(w).name),l(F,e(w).yearLevel),l(Xe,e(w).section),l(x,e($)),l(sa,e(w).email||"Not provided"),l(Fe,e(w).phone||"Not provided"),l(st,e(w).guardian||"Not provided"),l(Se,e(w).address||"Not provided"),l(ua,e(w).birthDate||"Not provided"),l(ot,e(w).age?`${e(w).age} years old`:"Not available")}),i(J,c)};m(ue,J=>{e(y)?J(X):J(qe,!1)})}a(de),a(M);var be=r(M,2),_e=r(t(be),2);_e.__click=[Xi,V];var fe=r(t(_e),2);let ke;a(_e);var Ve=r(_e,2);let ye;var Oe=t(Ve);{var U=J=>{var c=nn();i(J,c)},he=J=>{var c=on(),v=t(c),A=r(t(v),2),ee=r(t(A),2),Ce=t(ee,!0);a(ee),a(A),a(v);var me=r(v,2),te=r(t(me),2),Ke=r(t(te),2),f=t(Ke,!0);a(Ke),a(te),a(me);var k=r(me,2),oe=r(t(k),2),Te=r(t(oe),2),Ue=t(Te,!0);a(Te),a(oe),a(k),a(c),g(()=>{l(Ce,e(w).academicSummary.adviser),l(f,e(w).academicSummary.gpa!=="Not available"?`${e(w).academicSummary.gpa}%`:"Not available"),l(Ue,e(w).academicSummary.rank!=="Not available"&&e(w).academicSummary.totalStudents!=="Not available"?`${e(w).academicSummary.rank} of ${e(w).academicSummary.totalStudents}`:"Not available")}),i(J,c)};m(Oe,J=>{e(y)?J(U):J(he,!1)})}a(Ve),a(be);var Ze=r(be,2),K=r(t(Ze),2);K.__click=[en,D];var je=r(t(K),2);let we;a(K);var na=r(K,2);let ia;var Aa=t(na);{var ha=J=>{var c=ln();i(J,c)},Pe=J=>{var c=Ta(),v=da(c);{var A=Ce=>{var me=cn();ma(me,21,()=>e(w).subjects,te=>te.id,(te,Ke)=>{var f=dn(),k=t(f),oe=t(k);a(k);var Te=r(k,2),Ue=t(Te),F=t(Ue,!0);a(Ue);var Ae=r(Ue,2),Qe=t(Ae,!0);a(Ae),a(Te),a(f),g(()=>{ks(oe,`background-color: ${e(Ke).color??""}20; color: ${e(Ke).color??""}`),l(F,e(Ke).name),l(Qe,e(Ke).teacher)}),i(te,f)}),a(me),i(Ce,me)},ee=Ce=>{var me=vn();i(Ce,me)};m(v,Ce=>{e(w).subjects.length>0?Ce(A):Ce(ee,!1)},!0)}i(J,c)};m(Aa,J=>{e(y)?J(ha):J(Pe,!1)})}a(na),a(Ze);var ca=r(Ze,2),va=r(t(ca),2),Ie=t(va),Ge=t(Ie),Me=r(t(Ge),2),Z=t(Me);Z.__click=[an,se],a(Me),a(Ge),a(Ie),a(va),a(ca),g((J,c,v,A,ee,Ce)=>{B=W(R,1,"material-symbols-outlined collapse-icon",null,B,J),xe=W(de,1,"section-content",null,xe,c),ke=W(fe,1,"material-symbols-outlined collapse-icon",null,ke,v),ye=W(Ve,1,"section-content",null,ye,A),we=W(je,1,"material-symbols-outlined collapse-icon",null,we,ee),ia=W(na,1,"section-content",null,ia,Ce)},[()=>({rotated:e(P)}),()=>({collapsed:e(P)}),()=>({rotated:e(V)}),()=>({collapsed:e(V)}),()=>({rotated:e(D)}),()=>({collapsed:e(D)})]),i(I,re)};m(N,I=>{e(S)?I(G):I(H,!1)})}a(pe),i(z,pe),It()}js(["click"]);var Sr=function(){return Sr=Object.assign||function(z){for(var d,u=1,h=arguments.length;u<h;u++)for(var b in d=arguments[u])Object.prototype.hasOwnProperty.call(d,b)&&(z[b]=d[b]);return z},Sr.apply(this,arguments)},fn=(function(){function z(d,u,h){var b=this;this.endVal=u,this.options=h,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(y){b.startTime||(b.startTime=y);var S=y-b.startTime;b.remaining=b.duration-S,b.useEasing?b.countDown?b.frameVal=b.startVal-b.easingFn(S,0,b.startVal-b.endVal,b.duration):b.frameVal=b.easingFn(S,b.startVal,b.endVal-b.startVal,b.duration):b.frameVal=b.startVal+(b.endVal-b.startVal)*(S/b.duration);var _=b.countDown?b.frameVal<b.endVal:b.frameVal>b.endVal;b.frameVal=_?b.endVal:b.frameVal,b.frameVal=Number(b.frameVal.toFixed(b.options.decimalPlaces)),b.printValue(b.frameVal),S<b.duration?b.rAF=requestAnimationFrame(b.count):b.finalEndVal!==null?b.update(b.finalEndVal):b.options.onCompleteCallback&&b.options.onCompleteCallback()},this.formatNumber=function(y){var S,_,E,w,$=y<0?"-":"";S=Math.abs(y).toFixed(b.options.decimalPlaces);var P=(S+="").split(".");if(_=P[0],E=P.length>1?b.options.decimal+P[1]:"",b.options.useGrouping){w="";for(var V=3,D=0,L=0,T=_.length;L<T;++L)b.options.useIndianSeparators&&L===4&&(V=2,D=1),L!==0&&D%V==0&&(w=b.options.separator+w),D++,w=_[T-L-1]+w;_=w}return b.options.numerals&&b.options.numerals.length&&(_=_.replace(/[0-9]/g,(function(se){return b.options.numerals[+se]})),E=E.replace(/[0-9]/g,(function(se){return b.options.numerals[+se]}))),$+b.options.prefix+_+E+b.options.suffix},this.easeOutExpo=function(y,S,_,E){return _*(1-Math.pow(2,-10*y/E))*1024/1023+S},this.options=Sr(Sr({},this.defaults),h),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof d=="string"?document.getElementById(d):d,u=u??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(u),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,d):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return b.handleScroll(b)})),window.onscroll=function(){window.onScrollFns.forEach((function(y){return y()}))},this.handleScroll(this)))}return z.prototype.handleScroll=function(d){if(d&&window&&!d.once){var u=window.innerHeight+window.scrollY,h=d.el.getBoundingClientRect(),b=h.top+window.pageYOffset,y=h.top+h.height+window.pageYOffset;y<u&&y>window.scrollY&&d.paused?(d.paused=!1,setTimeout((function(){return d.start()}),d.options.scrollSpyDelay),d.options.scrollSpyOnce&&(d.once=!0)):(window.scrollY>y||b>u)&&!d.paused&&d.reset()}},z.prototype.determineDirectionAndSmartEasing=function(){var d=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>d;var u=d-this.startVal;if(Math.abs(u)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=d;var h=this.countDown?1:-1;this.endVal=d+h*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=d,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},z.prototype.start=function(d){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),d&&(this.options.onCompleteCallback=d),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},z.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},z.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},z.prototype.update=function(d){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(d),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},z.prototype.printValue=function(d){var u;if(this.el){var h=this.formattingFn(d);!((u=this.options.plugin)===null||u===void 0)&&u.render?this.options.plugin.render(this.el,h):this.el.tagName==="INPUT"?this.el.value=h:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=h:this.el.innerHTML=h}},z.prototype.ensureNumber=function(d){return typeof d=="number"&&!isNaN(d)},z.prototype.validateValue=function(d){var u=Number(d);return this.ensureNumber(u)?u:(this.error="[CountUp] invalid start or end value: ".concat(d),null)},z.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},z.prototype.parse=function(d){var u=function(S){return S.replace(/([.,'  ])/g,"\\$1")},h=u(this.options.separator),b=u(this.options.decimal),y=d.replace(new RegExp(h,"g"),"").replace(new RegExp(b,"g"),".");return parseFloat(y)},z})(),_n=o('<span class="countup-container svelte-3g4hm4"><!></span>');function Er(z,d){Pt(d,!1);let u=xt(d,"value",8,0),h=xt(d,"decimals",8,1),b=xt(d,"duration",8,2),y=xt(d,"useEasing",8,!0),S=xt(d,"useGrouping",8,!0),_=xt(d,"separator",8,","),E=xt(d,"decimal",8,"."),w=xt(d,"prefix",8,""),$=xt(d,"suffix",8,""),P=xt(d,"startVal",8,0),V=p(),D=p(),L=p(!1),T=p(!1);function se(H,I){return H.toFixed(I).replace(/\.0+$/,"")}Wt(()=>{e(V)&&(fs(V,e(V).textContent=`${w()}${se(P(),h())}${$()}`),s(L,!0),u()!==P()&&u()>0&&pe())});function pe(){if(!(!e(V)||!e(L)||e(T)))try{s(D,new fn(e(V),u(),{startVal:P(),decimalPlaces:h(),duration:b(),useEasing:y(),useGrouping:S(),separator:_(),decimal:E(),prefix:w(),suffix:$(),formattingFn:H=>H.toFixed(h()).replace(/\.0+$/,"")})),e(D).error?(console.error("CountUp error:",e(D).error),fs(V,e(V).textContent=`${w()}${se(u(),h())}${$()}`)):(e(D).start(),s(T,!0))}catch(H){console.error("Failed to initialize CountUp:",H),fs(V,e(V).textContent=`${w()}${se(u(),h())}${$()}`)}}Ya(()=>(e(L),Zt(u()),Zt(P()),e(T)),()=>{e(L)&&u()!==P()&&u()>0&&!e(T)&&pe()}),Ya(()=>(e(D),e(T),Zt(u()),Zt(P()),Zt(w()),Zt(h()),Zt($())),()=>{if(e(D)&&Kr&&e(T)&&u()!==P())try{e(D).update(u())}catch(H){console.error("CountUp update error:",H),fs(V,e(V).textContent=`${w()}${se(u(),h())}${$()}`)}}),ds(),is();var N=_n(),G=t(N);m(G,H=>{}),a(N),hr(N,H=>s(V,H),()=>e(V)),i(z,N),It()}var gn=o("<button> </button>"),bn=o('<div class="dropdown-menu-quarter"></div>'),hn=o('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),yn=o('<div class="loading-container"><div class="system-loader"></div> <p>Loading your grades...</p></div>'),wn=o('<div class="no-subjects"><span class="material-symbols-outlined">school</span> <p> </p> <small>Grades will appear here once they are verified by your teachers</small></div>'),Sn=o('<div class="progress-bar"><div></div></div>'),xn=o('<div class="progress-bar"></div>'),kn=o('<span class="unverified-indicator" title="Grade not yet verified">*</span>'),An=o("<div><!> <!></div>"),Dn=o('<div><span class="material-symbols-outlined">remove</span> <span class="no-grade-text">No Grade</span></div>'),Tn=o('<div><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p> </p> <!></div> <div class="grade-column"><!></div></div>'),Nn=o('<div class="subjects-grid"></div>'),jn=o('<div class="performance-card"><h2 class="performance-title">Overall Performance</h2> <div class="performance-content"><div class="performance-main"><div class="average-section"><div class="average-value"><div><!></div></div> <div class="average-label">Current Average</div></div> <div class="subjects-section-card"><div class="subjects-value"><div><!></div></div> <div class="subjects-label">Total Subjects</div></div></div></div></div> <div class="subjects-section"><h2 class="section-title">Subject Performance</h2> <!></div>',1),$n=o('<div class="grades-container"><div class="grades-header"><div class="header-content"><h1 class="page-title">My Grades</h1> <p class="page-subtitle">Academic Performance Overview</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function Cn(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=p(!0),S=p(null),_=p("1st Quarter"),E=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],w=p(!1),$=p([]),P=p(0),V=p(0),D=null;const L={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};function T(){s(w,!e(w))}async function se(ye){s(_,ye),s(w,!1),await re()}function pe(ye){e(w)&&!ye.target.closest(".custom-dropdown")&&s(w,!1)}function N(ye){return ye>=85?"var(--grade-excellent)":ye>=80?"var(--grade-good)":ye>=75?"var(--grade-satisfactory)":ye>=65?"var(--grade-needs-improvement)":"var(--grade-no-grade)"}function G(ye){const Oe=["blue","green","purple","yellow","orange"];return Oe[ye%Oe.length]}function H(ye){return ye>=85?"Excellent":ye>=80?"Good":ye>=75?"Satisfactory":ye>=65?"Needs Improvement":"No Grade"}function I(ye){return ye==null||ye===0?"grade-no-grade":ye>=85?"grade-excellent":ye>=80?"grade-good":ye>=75?"grade-satisfactory":(ye>=65,"grade-needs-improvement")}async function re(){try{if(s(y,!0),s(S,null),!b().userData?.id){s(S,"User not authenticated");return}const ye=L[e(_)],Oe=await Qa.get(`/api/student-grades/verified?student_id=${b().userData.id}&grading_period_id=${ye}`);Oe.success?(D=Oe.data.student,s($,Oe.data.subjects.map((U,he)=>({...U,color:N(U.numericGrade),cardColor:G(he),gradeIndicator:H(U.numericGrade),gradeColorClass:I(U.numericGrade)}))),s(P,Oe.data.totalSubjects),s(V,Oe.data.overallAverage)):s(S,Oe.error||"Failed to fetch grades")}catch(ye){console.error("Error fetching grades:",ye),s(S,"Failed to load grades. Please try again.")}finally{s(y,!1)}}Wt(()=>{b().userData?.id?re():(s(S,"Please log in to view your grades"),s(y,!1))}),Ya(()=>e($),()=>{s($,e($).map((ye,Oe)=>({...ye,color:N(ye.numericGrade),cardColor:G(Oe),gradeIndicator:H(ye.numericGrade)})))}),ds(),is();var M=$n();q("click",Fs,pe);var C=t(M),R=r(t(C),2),B=t(R),de=t(B),xe=r(t(de),2),ue=t(xe,!0);a(xe);var X=r(xe,2);let qe;a(de);var be=r(de,2);{var _e=ye=>{var Oe=bn();ma(Oe,5,()=>E,Xt,(U,he)=>{var Ze=gn();let K;var je=t(Ze,!0);a(Ze),g(we=>{K=W(Ze,1,"dropdown-item-quarter",null,K,we),l(je,e(he))},[()=>({active:e(he)===e(_)})]),q("click",Ze,()=>se(e(he))),i(U,Ze)}),a(Oe),i(ye,Oe)};m(be,ye=>{e(w)&&ye(_e)})}a(B),a(R),a(C);var fe=r(C,2);{var ke=ye=>{var Oe=hn(),U=r(t(Oe),2),he=t(U);a(U);var Ze=r(U,2);a(Oe),g(()=>l(he,`Error: ${e(S)??""}`)),q("click",Ze,re),i(ye,Oe)},Ve=ye=>{var Oe=jn(),U=da(Oe),he=r(t(U),2),Ze=t(he),K=t(Ze),je=t(K),we=t(je),na=t(we);Er(na,{get value(){return e(V)},decimals:1,duration:2.5}),a(we),a(je),Xa(2),a(K);var ia=r(K,2),Aa=t(ia),ha=t(Aa),Pe=t(ha);Er(Pe,{get value(){return e(P)},decimals:0,duration:2}),a(ha),a(Aa),Xa(2),a(ia),a(Ze),a(he),a(U);var ca=r(U,2),va=r(t(ca),2);{var Ie=Me=>{var Z=yn();i(Me,Z)},Ge=Me=>{var Z=Ta(),J=da(Z);{var c=A=>{var ee=wn(),Ce=r(t(ee),2),me=t(Ce);a(Ce),Xa(2),a(ee),g(()=>l(me,`No subjects found for ${e(_)??""}`)),i(A,ee)},v=A=>{var ee=Nn();ma(ee,5,()=>e($),Ce=>Ce.id,(Ce,me)=>{var te=Tn(),Ke=r(t(te),2),f=t(Ke),k=t(f,!0);a(f);var oe=r(f,2);let Te;var Ue=t(oe,!0);a(oe);var F=r(oe,2);{var Ae=ie=>{var x=Sn(),le=t(x);a(x),g(()=>{W(le,1,`progress-fill ${e(me),n(()=>e(me).gradeColorClass)??""}`),ks(le,`width: ${e(me),n(()=>e(me).numericGrade)??""}%`)}),i(ie,x)},Qe=ie=>{var x=xn();i(ie,x)};m(F,ie=>{e(me),n(()=>e(me).verified&&e(me).numericGrade>0)?ie(Ae):ie(Qe,!1)})}a(Ke);var We=r(Ke,2),Xe=t(We);{var $a=ie=>{var x=An(),le=t(x);Er(le,{get value(){return e(me),n(()=>e(me).numericGrade)},decimals:1,duration:1.5});var Le=r(le,2);{var pa=He=>{var sa=kn();i(He,sa)};m(Le,He=>{e(me),n(()=>!e(me).verified)&&He(pa)})}a(x),g(()=>W(x,1,`grade-large ${e(me),n(()=>e(me).gradeColorClass)??""}`)),i(ie,x)},xa=ie=>{var x=Dn();g(()=>W(x,1,`no-grade-large ${e(me),n(()=>e(me).gradeColorClass)??""}`)),i(ie,x)};m(Xe,ie=>{e(me),n(()=>e(me).numericGrade>0)?ie($a):ie(xa,!1)})}a(We),a(te),g(ie=>{W(te,1,`subject-card ${e(me),n(()=>e(me).cardColor)??""}`),l(k,(e(me),n(()=>e(me).name))),Te=W(oe,1,"teacher-name",null,Te,ie),l(Ue,(e(me),n(()=>e(me).teacher)))},[()=>({"no-teacher":e(me).teacher==="No teacher"})]),i(Ce,te)}),a(ee),i(A,ee)};m(J,A=>{e($),n(()=>e($).length===0)?A(c):A(v,!1)},!0)}i(Me,Z)};m(va,Me=>{e(y)?Me(Ie):Me(Ge,!1)})}a(ca),g(Me=>ks(je,`color: ${Me??""}`),[()=>(e(V),n(()=>N(e(V))))]),i(ye,Oe)};m(fe,ye=>{e(S)?ye(ke):ye(Ve,!1)})}a(M),g(ye=>{l(ue,e(_)),qe=W(X,1,"material-symbols-outlined dropdown-arrow",null,qe,ye)},[()=>({rotated:e(w)})]),q("click",de,T),i(z,M),It(),h()}var qn=o('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),En=o("<button> </button>"),Fn=o('<div class="schedule-dropdown-menu"></div>'),Ln=o('<div class="loading-message"><div class="system-loader"></div> <h3>Loading Schedule...</h3></div>'),Pn=o('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),In=o('<div class="class-teacher"><span class="material-symbols-outlined">person_book</span> <span> </span></div>'),Gn=o('<div><div class="class-header"><h3 class="class-name"> </h3> <span class="class-time"> </span></div> <div class="class-details"><div class="class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!></div></div>'),Mn=o('<div class="classes-list"></div>'),Rn=o('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),On=o('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-header"><h1 class="page-title">Schedule</h1> <p class="page-subtitle">Your weekly class schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="day-selector"></div> <div class="schedule-mobile-dropdown"><button class="schedule-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><h2> </h2> <!></div></div>');function Vn(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u),y=p(),S=p(),_=new Date,E=["January","February","March","April","May","June","July","August","September","October","November","December"],w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$=E[_.getMonth()],P=_.getDate(),V=w[_.getDay()],D={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},L=_.getDay();let T=p(D[L]||"Mon");const se=["blue","green","purple","yellow","orange"];function pe(Pe){return se[Pe%se.length]}let N=p([]),G=p(!0),H=p(null);function I(Pe){const ca={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},va={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},Ie={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return Pe.forEach(Ge=>{const Me=va[Ge.day_of_week.toLowerCase()];if(Me){const Z=re(Ge.start_time),J=re(Ge.end_time);let c,v;Ge.schedule_type==="subject"?(c=Ge.subject_name||"Unknown Subject",v=Ge.teacher_name||"No Teacher Assigned"):Ge.schedule_type==="activity"&&(c=Ge.activity_type_name||"Activity",v=Ge.teacher_name||"");const A={name:c,time:`${Z} - ${J}`,room:Ge.room_name||"TBA",teacher:v,scheduleType:Ge.schedule_type,color:pe(Ie[Me])};ca[Me].push(A),Ie[Me]++}}),ca}function re(Pe){const[ca,va]=Pe.split(":"),Ie=parseInt(ca),Ge=Ie>=12?"PM":"AM";return`${(Ie===0?12:Ie>12?Ie-12:Ie).toString().padStart(2,"0")}:${va} ${Ge}`}async function M(){try{s(G,!0),s(H,null);const Pe=b();if(!Pe.isAuthenticated||!Pe.userData?.id)throw new Error("User not authenticated");const va=await(await fetch(`/api/schedules?action=student-schedules&studentId=${Pe.userData.id}&schoolYear=2024-2025`)).json();if(!va.success)throw new Error(va.error||"Failed to fetch schedule data");s(N,I(va.data))}catch(Pe){console.error("Error fetching schedule data:",Pe),s(H,Pe.message),s(N,{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]})}finally{s(G,!1)}}Wt(()=>{M()});const C=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}],R={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"};let B=p(!1);function de(Pe){Pe.target.closest(".schedule-mobile-dropdown")||s(B,!1)}function xe(){s(B,!e(B))}function ue(Pe){s(T,Pe),s(B,!1)}Ya(()=>(e(N),e(T)),()=>{s(y,e(N)[e(T)]||[])}),Ya(()=>e(T),()=>{s(S,R[e(T)]||e(T))}),ds(),is();var X=On(),qe=r(t(X),2),be=t(qe),_e=t(be),fe=t(_e);a(_e),a(be);var ke=r(be,2);ma(ke,5,()=>C,Xt,(Pe,ca)=>{let va=()=>e(ca).day;var Ie=qn(),Ge=t(Ie),Me=t(Ge,!0);a(Ge);var Z=r(Ge,2),J=t(Z,!0);a(Z),a(Ie),g(()=>{W(Ie,1,`day-btn ${va()===e(T)?"active":""}`),l(Me,va()),l(J,(va(),n(()=>R[va()])))}),q("click",Ie,()=>ue(va())),i(Pe,Ie)}),a(ke);var Ve=r(ke,2),ye=t(Ve),Oe=t(ye),U=t(Oe,!0);a(Oe);var he=r(Oe,2);a(ye);var Ze=r(ye,2);{var K=Pe=>{var ca=Fn();ma(ca,5,()=>C,Xt,(va,Ie)=>{let Ge=()=>e(Ie).day;var Me=En(),Z=t(Me,!0);a(Me),g(()=>{W(Me,1,`schedule-dropdown-item ${Ge()===e(T)?"selected":""}`),l(Z,(Ge(),n(()=>R[Ge()])))}),q("click",Me,()=>ue(Ge())),i(va,Me)}),a(ca),i(Pe,ca)};m(Ze,Pe=>{e(B)&&Pe(K)})}a(Ve),a(qe);var je=r(qe,2),we=t(je),na=t(we);a(we);var ia=r(we,2);{var Aa=Pe=>{var ca=Ln();i(Pe,ca)},ha=Pe=>{var ca=Ta(),va=da(ca);{var Ie=Me=>{var Z=Pn(),J=r(t(Z),4),c=t(J,!0);a(J);var v=r(J,2);a(Z),g(()=>l(c,e(H))),q("click",v,M),i(Me,Z)},Ge=Me=>{var Z=Ta(),J=da(Z);{var c=A=>{var ee=Mn();ma(ee,5,()=>e(y),Xt,(Ce,me)=>{var te=Gn(),Ke=t(te),f=t(Ke),k=t(f,!0);a(f);var oe=r(f,2),Te=t(oe,!0);a(oe),a(Ke);var Ue=r(Ke,2),F=t(Ue),Ae=r(t(F),2),Qe=t(Ae,!0);a(Ae),a(F);var We=r(F,2);{var Xe=$a=>{var xa=In(),ie=r(t(xa),2),x=t(ie,!0);a(ie),a(xa),g(()=>l(x,(e(me),n(()=>e(me).teacher)))),i($a,xa)};m(We,$a=>{e(me),n(()=>e(me).teacher)&&$a(Xe)})}a(Ue),a(te),g(()=>{W(te,1,`class-card ${e(me),n(()=>e(me).color)??""}`),l(k,(e(me),n(()=>e(me).name))),l(Te,(e(me),n(()=>e(me).time))),l(Qe,(e(me),n(()=>e(me).scheduleType==="activity"?"No room":e(me).room)))}),i(Ce,te)}),a(ee),i(A,ee)},v=A=>{var ee=Rn(),Ce=r(t(ee),4),me=t(Ce);a(Ce),a(ee),g(()=>l(me,`You don't have any classes scheduled for ${e(S)??""}. Enjoy your free day!`)),i(A,ee)};m(J,A=>{e(y),n(()=>e(y).length>0)?A(c):A(v,!1)},!0)}i(Me,Z)};m(va,Me=>{e(H)?Me(Ie):Me(Ge,!1)},!0)}i(Pe,ca)};m(ia,Pe=>{e(G)?Pe(Aa):Pe(ha,!1)})}a(je),a(X),g(()=>{l(fe,`${V??""}, ${$??""} ${P??""}`),l(U,(e(T),n(()=>R[e(T)]||"Select Day"))),W(he,1,`material-symbols-outlined schedule-dropdown-icon ${e(B)?"open":""}`),l(na,`${e(S)??""} Classes`)}),q("click",ye,xe),q("click",X,de),q("keydown",X,de),i(z,X),It(),h()}var Un=o('<button><div class="doc-dropdown-item-content"><span class="doc-dropdown-item-name"> </span> <span class="doc-dropdown-item-desc"> </span></div></button>'),Wn=o('<div class="dropdown-menu-document"></div>'),Yn=o('<div class="request-form-section"><div class="form-container"><div class="form-header"><h2 class="form-title">New Document Request</h2> <p class="form-subtitle">Fill out the form below to request a document</p></div> <div class="form-content"><div class="form-group"><label class="form-label" for="document-type-dropdown"><span class="material-symbols-outlined form-icon">description</span> Document Type</label> <div class="custom-dropdown"><button id="document-type-dropdown" class="dropdown-toggle"><span><!></span> <span>expand_more</span></button> <!></div></div> <div class="form-group"><label class="form-label" for="description"><span class="material-symbols-outlined form-icon">edit_note</span> Purpose & Details</label> <textarea id="description" class="form-textarea enhanced" placeholder="Please describe the purpose of your request and any specific requirements..." rows="5"></textarea> <div class="form-help"><span class="material-symbols-outlined help-icon">info</span> Be specific about your needs to help us process your request efficiently</div></div> <div class="document-form-actions"><button class="document-cancel-button">Cancel</button> <button class="submit-button"><!></button></div></div></div></div>'),Hn=o('<div class="loading-message"><div class="system-loader"></div> Loading your document requests...</div>'),Jn=o('<div class="no-requests-message"><span class="material-symbols-outlined">description</span> <p>No document requests found</p> <p class="subtitle">Start by requesting your first document above</p></div>'),Bn=o('<div class="request-footer completed-footer"><span class="footer-info"> </span></div>'),Qn=o('<div class="request-footer processing-footer"><span class="footer-info"> </span></div>'),zn=o('<div class="request-footer pending-footer"><span class="footer-info">Awaiting review</span> <button class="cancel-request-button"><span class="material-symbols-outlined">close</span> Cancel</button></div>'),Kn=o('<div class="request-footer cancelled-footer"><span class="footer-info"> </span></div>'),Zn=o('<div class="request-footer rejected-footer"><span class="footer-info"> </span></div>'),Xn=o('<div><div class="request-main-content"><div class="request-status-icon"><span class="material-symbols-outlined"> </span></div> <div class="request-content"><div class="request-header"><div class="request-info"><h3 class="request-title"> </h3> <p class="request-date"> </p></div> <div> </div></div> <p class="request-description"> </p></div></div> <!></div>'),eo=o('<div class="request-history-grid"></div>'),ao=o('<div class="document-request-container" role="button" tabindex="0"><div class="document-header"><div class="header-content"><h1 class="page-title">Document Requests</h1> <p class="page-subtitle">Request new documents or check existing requests</p></div></div> <div class="quick-actions-section"><div class="quick-actions-header"><h2 class="section-title">Quick Actions</h2> <p class="section-subtitle">Request new documents or check existing requests</p></div> <button class="request-new-button"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="request-history-section"><h2 class="section-title">Request History</h2> <!></div></div>');function to(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=p(!1),S=p(""),_=p(""),E=p(!1),w=p(!1),$=p([]),P=p(!0),V=null;function D(fe){fe.target.closest(".custom-dropdown")||s(w,!1)}function L(){s(w,!e(w))}function T(fe){s(S,fe.id),s(w,!1)}const se=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}];async function pe(){try{if(s(P,!0),V=null,!b().userData?.id){V="User not authenticated";return}const fe=await Qa.get(`/api/document-requests?student_id=${b().userData.id}`);fe.success?s($,fe.data):V=fe.error||"Failed to fetch document requests"}catch(fe){console.error("Error fetching document requests:",fe),V="Failed to load document requests. Please try again."}finally{s(P,!1)}}Wt(()=>{b().userData?.id?pe():(V="Please log in to view your document requests",s(P,!1))});async function N(fe){try{const ke=await Qa.patch("/api/document-requests",{id:fe,action:"cancel"});ke.success?s($,e($).map(Ve=>Ve.id===fe?{...Ve,status:"cancelled",cancelledDate:ke.data.cancelledDate}:Ve)):console.error("Failed to cancel request:",ke.error)}catch(ke){console.error("Error cancelling request:",ke)}}function G(){s(y,!e(y)),e(y)?setTimeout(()=>{const fe=document.querySelector(".request-form-section");fe&&fe.scrollIntoView({behavior:"smooth",block:"center"})},100):(s(S,""),s(_,""),s(w,!1))}async function H(){if(!(!e(S)||!e(_).trim())){s(E,!0);try{const fe=await Qa.post("/api/document-requests",{student_id:b().userData.id,document_type:e(S),purpose:e(_)});fe.success?(s($,[fe.data,...e($)]),G()):V=fe.error||"Failed to submit document request"}catch(fe){console.error("Error submitting document request:",fe),V="Failed to submit document request. Please try again."}finally{s(E,!1)}}}function I(fe){switch(fe){case"completed":return"check_circle";case"processing":return"sync";case"pending":return"hourglass_empty";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}is();var re=ao(),M=r(t(re),2),C=r(t(M),2),R=t(C),B=t(R,!0);a(R);var de=r(R);a(C),a(M);var xe=r(M,2);{var ue=fe=>{var ke=Yn(),Ve=t(ke),ye=r(t(Ve),2),Oe=t(ye),U=r(t(Oe),2),he=t(U),Ze=t(he),K=t(Ze);{var je=J=>{var c=kt();g(v=>l(c,v),[()=>se.find(v=>v.id===e(S))?.name||"Select Document Type"]),i(J,c)},we=J=>{var c=kt("Choose the document you need");i(J,c)};m(K,J=>{e(S)?J(je):J(we,!1)})}a(Ze);var na=r(Ze,2);a(he);var ia=r(he,2);{var Aa=J=>{var c=Wn();ma(c,5,()=>se,Xt,(v,A)=>{var ee=Un(),Ce=t(ee),me=t(Ce),te=t(me,!0);a(me);var Ke=r(me,2),f=t(Ke,!0);a(Ke),a(Ce),a(ee),g(()=>{W(ee,1,`doc-dropdown-item ${e(A).id===e(S)?"selected":""}`),l(te,e(A).name),l(f,e(A).description)}),q("click",ee,()=>T(e(A))),i(v,ee)}),a(c),i(J,c)};m(ia,J=>{e(w)&&J(Aa)})}a(U),a(Oe);var ha=r(Oe,2),Pe=r(t(ha),2);br(Pe),Xa(2),a(ha);var ca=r(ha,2),va=t(ca),Ie=r(va,2),Ge=t(Ie);{var Me=J=>{var c=kt("Submitting...");i(J,c)},Z=J=>{var c=kt("Submit Request");i(J,c)};m(Ge,J=>{e(E)?J(Me):J(Z,!1)})}a(Ie),a(ca),a(ye),a(Ve),a(ke),g(J=>{W(na,1,`material-symbols-outlined dropdown-icon ${e(w)?"open":""}`),va.disabled=e(E),Ie.disabled=J},[()=>!e(S)||!e(_).trim()||e(E)]),q("click",he,L),Za(Pe,()=>e(_),J=>s(_,J)),q("click",va,G),q("click",Ie,H),i(fe,ke)};m(xe,fe=>{e(y)&&fe(ue)})}var X=r(xe,2),qe=r(t(X),2);{var be=fe=>{var ke=Hn();i(fe,ke)},_e=fe=>{var ke=Ta(),Ve=da(ke);{var ye=U=>{var he=Jn();i(U,he)},Oe=U=>{var he=eo();ma(he,7,()=>e($),Ze=>Ze.id,(Ze,K,je)=>{var we=Xn(),na=t(we),ia=t(na),Aa=t(ia),ha=t(Aa,!0);a(Aa),a(ia);var Pe=r(ia,2),ca=t(Pe),va=t(ca),Ie=t(va),Ge=t(Ie,!0);a(Ie);var Me=r(Ie,2),Z=t(Me);a(Me),a(va);var J=r(va,2),c=t(J,!0);a(J),a(ca);var v=r(ca,2),A=t(v,!0);a(v),a(Pe),a(na);var ee=r(na,2);{var Ce=te=>{var Ke=Bn(),f=t(Ke),k=t(f);a(f),a(Ke),g(()=>l(k,`Completed on ${e(K).completedDate??""}`)),i(te,Ke)},me=te=>{var Ke=Ta(),f=da(Ke);{var k=Te=>{var Ue=Qn(),F=t(Ue),Ae=t(F);a(F),a(Ue),g(()=>l(Ae,`Note: ${e(K).adminNote||"Processing your request"}`)),i(Te,Ue)},oe=Te=>{var Ue=Ta(),F=da(Ue);{var Ae=We=>{var Xe=zn(),$a=r(t(Xe),2);a(Xe),q("click",$a,()=>N(e(K).id)),i(We,Xe)},Qe=We=>{var Xe=Ta(),$a=da(Xe);{var xa=x=>{var le=Kn(),Le=t(le),pa=t(Le);a(Le),a(le),g(()=>l(pa,`Cancelled on ${e(K).cancelledDate??""}`)),i(x,le)},ie=x=>{var le=Ta(),Le=da(le);{var pa=He=>{var sa=Zn(),la=t(sa),Ee=t(la);a(la),a(sa),g(()=>l(Ee,`Reason: ${e(K).rejectionReason??""}`)),i(He,sa)};m(Le,He=>{e(K).status==="rejected"&&He(pa)},!0)}i(x,le)};m($a,x=>{e(K).status==="cancelled"?x(xa):x(ie,!1)},!0)}i(We,Xe)};m(F,We=>{e(K).status==="pending"?We(Ae):We(Qe,!1)},!0)}i(Te,Ue)};m(f,Te=>{e(K).status==="processing"?Te(k):Te(oe,!1)},!0)}i(te,Ke)};m(ee,te=>{e(K).status==="completed"?te(Ce):te(me,!1)})}a(we),g(te=>{W(we,1,`request-card ${e(K).status??""}`),ks(we,`--card-index: ${e(je)+1};`),l(ha,te),l(Ge,e(K).type),l(Z,`Requested on ${e(K).requestedDate??""}`),W(J,1,`student-status-badge status-${e(K).status??""}`),l(c,e(K).status==="completed"?"Completed":e(K).status==="processing"?"Processing":e(K).status==="pending"?"Pending":e(K).status==="rejected"?"Rejected":e(K).status==="cancelled"?"Cancelled":"Unknown"),l(A,e(K).purpose)},[()=>I(e(K).status)]),i(Ze,we)}),a(he),i(U,he)};m(Ve,U=>{e($).length===0?U(ye):U(Oe,!1)},!0)}i(fe,ke)};m(qe,fe=>{e(P)?fe(be):fe(_e,!1)})}a(X),a(re),g(()=>{C.disabled=e(P),l(B,e(y)?"remove":"add"),l(de,` ${e(y)?"Cancel Request":"Request New Document"}`)}),q("click",C,G),q("click",re,D),q("keydown",re,D),i(z,re),It(),h()}var so=o('<span class="count-badge"> </span>'),ro=o('<button><span class="material-symbols-outlined"> </span> <span> </span> <!></button>'),io=o('<div class="filter-dropdown-menu"></div>'),no=o('<button class="notifications-action-btn mark-all-read" title="Mark All Read"><span class="material-symbols-outlined">done_all</span></button>'),oo=o('<button class="notifications-action-btn clear-read" title="Clear Read"><span class="material-symbols-outlined">clear_all</span></button>'),lo=o('<div class="loading-state"><div class="system-loader"></div> <p>Loading notifications...</p></div>'),co=o('<div class="error-state"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Notifications</h3> <p> </p> <button class="retry-btn">Reload</button></div>'),vo=o('<div role="button" tabindex="0"><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><p class="notification-message"> </p> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),uo=o('<div class="notifications-list"></div>'),mo=o('<div class="no-notifications"><div class="no-notifications-icon"><span class="material-symbols-outlined"> </span></div> <h3> </h3> <p> </p></div>'),po=o('<div class="notification-container"><div class="notification-header"><div class="header-content"><h1 class="page-title">Notifications</h1> <p class="page-subtitle">Stay updated with your academic activities <span class="notification-badge"> </span></p></div></div> <div class="filter-actions-section"><div class="filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="actions-section"><!> <!></div></div> <div class="notifications-section"><!></div></div>');function fo(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u),y=p();let S=p([]),_=p(!0),E=p(null),w=p(0),$=0;const P=[{value:"all",label:"All Notifications",icon:"notifications"},{value:"unread",label:"Unread Only",icon:"mark_email_unread"},{value:"todo",label:"To-Do Due Dates",icon:"assignment"},{value:"grade",label:"Grades",icon:"grade"},{value:"document",label:"Document Requests",icon:"description"}];let V=p("all"),D=p(!1);async function L(){if(!b().isAuthenticated){s(E,"User not authenticated"),s(_,!1);return}s(_,!0),s(E,null);try{const v=new URLSearchParams;e(V)!=="all"&&v.append("type",e(V)),v.append("limit","50"),v.append("offset","0");const A=`/api/notifications?${v.toString()}`,ee=await ps(A);if(ee.success)s(S,ee.data.notifications),s(w,ee.data.unreadCount),$=ee.data.pagination.total;else throw new Error(ee.error||"Failed to fetch notifications")}catch(v){console.error("Error fetching notifications:",v),s(E,v.message),s(S,[]),s(w,0),$=0}finally{s(_,!1)}}async function T(c,v){try{const A=await ps("/api/notifications",{method:"PATCH",body:JSON.stringify({id:c,action:v?"mark_read":"mark_unread"})});if(!A.success)throw new Error(A.error||"Failed to update notification");s(S,e(S).map(ee=>ee.id===c?{...ee,isRead:v}:ee)),v?s(w,Math.max(0,e(w)-1)):s(w,e(w)+1)}catch(A){console.error("Error updating notification:",A),s(E,A.message)}}async function se(c){try{const v=await ps("/api/notifications",{method:"DELETE",body:JSON.stringify({id:c})});if(!v.success)throw new Error(v.error||"Failed to delete notification");const A=e(S).find(ee=>ee.id===c);s(S,e(S).filter(ee=>ee.id!==c)),$=Math.max(0,$-1),A&&!A.isRead&&s(w,Math.max(0,e(w)-1))}catch(v){console.error("Error deleting notification:",v),s(E,v.message)}}async function pe(){try{const c=await ps("/api/notifications",{method:"PATCH",body:JSON.stringify({action:"mark_all_read"})});if(!c.success)throw new Error(c.error||"Failed to mark all as read");s(S,e(S).map(v=>({...v,isRead:!0}))),s(w,0)}catch(c){console.error("Error marking all as read:",c),s(E,c.message)}}async function N(){try{const c=await ps("/api/notifications",{method:"DELETE",body:JSON.stringify({action:"delete_read"})});if(!c.success)throw new Error(c.error||"Failed to clear read notifications");const v=e(S).filter(A=>A.isRead).length;s(S,e(S).filter(A=>!A.isRead)),$=Math.max(0,$-v)}catch(c){console.error("Error clearing read notifications:",c),s(E,c.message)}}Wt(()=>{let c;c=ls.subscribe(v=>{v.isAuthenticated&&(L(),c&&c())})});function G(){s(D,!e(D))}function H(c){s(V,c),s(D,!1),L()}function I(c){c.target.closest(".filter-dropdown")||s(D,!1)}function re(c){const v=e(S).find(A=>A.id===c);v&&T(c,!v.isRead)}function M(c){se(c)}function C(){pe()}function R(){N()}function B(c){const v=new Date(c),A=new Date,ee=Math.floor((A-v)/(1e3*60*60));if(ee<1){const Ce=Math.floor((A-v)/6e4);return Ce<=1?"Just now":`${Ce} minutes ago`}else{if(ee<24)return`${ee} hour${ee>1?"s":""} ago`;{const Ce=Math.floor(ee/24);return Ce<7?`${Ce} day${Ce>1?"s":""} ago`:v.toLocaleDateString("en-US",{month:"short",day:"numeric",year:v.getFullYear()!==A.getFullYear()?"numeric":void 0})}}}function de(c){const v=P.find(A=>A.value===c);return v?v.label:"All Notifications"}function xe(c){const v=P.find(A=>A.value===c);return v?v.icon:"notifications"}Ya(()=>(e(V),e(S)),()=>{s(y,e(V)==="all"?e(S):e(V)==="unread"?e(S).filter(c=>!c.isRead):e(S).filter(c=>c.type===e(V)))}),ds(),is();var ue=po();q("click",Fs,I);var X=t(ue),qe=t(X),be=r(t(qe),2),_e=r(t(be)),fe=t(_e);a(_e),a(be),a(qe),a(X);var ke=r(X,2),Ve=t(ke),ye=t(Ve),Oe=t(ye),U=t(Oe),he=t(U),Ze=t(he,!0);a(he);var K=r(he,2),je=t(K,!0);a(K),a(U);var we=r(U,2);let na;a(Oe);var ia=r(Oe,2);{var Aa=c=>{var v=io();ma(v,5,()=>P,Xt,(A,ee)=>{var Ce=ro();let me;var te=t(Ce),Ke=t(te,!0);a(te);var f=r(te,2),k=t(f,!0);a(f);var oe=r(f,2);{var Te=Ue=>{var F=so(),Ae=t(F,!0);a(F),g(()=>l(Ae,e(w))),i(Ue,F)};m(oe,Ue=>{e(ee),n(()=>e(ee).value==="unread")&&Ue(Te)})}a(Ce),g(Ue=>{me=W(Ce,1,"filter-dropdown-item",null,me,Ue),l(Ke,(e(ee),n(()=>e(ee).icon))),l(k,(e(ee),n(()=>e(ee).label)))},[()=>({active:e(ee).value===e(V)})]),q("click",Ce,()=>H(e(ee).value)),i(A,Ce)}),a(v),i(c,v)};m(ia,c=>{e(D)&&c(Aa)})}a(ye),a(Ve);var ha=r(Ve,2),Pe=t(ha);{var ca=c=>{var v=no();q("click",v,C),i(c,v)};m(Pe,c=>{e(w)>0&&c(ca)})}var va=r(Pe,2);{var Ie=c=>{var v=oo();q("click",v,R),i(c,v)};m(va,c=>{e(S),n(()=>e(S).some(v=>v.isRead))&&c(Ie)})}a(ha),a(ke);var Ge=r(ke,2),Me=t(Ge);{var Z=c=>{var v=lo();i(c,v)},J=c=>{var v=Ta(),A=da(v);{var ee=me=>{var te=co(),Ke=r(t(te),4),f=t(Ke,!0);a(Ke);var k=r(Ke,2);a(te),g(()=>l(f,e(E))),q("click",k,L),i(me,te)},Ce=me=>{var te=Ta(),Ke=da(te);{var f=oe=>{var Te=uo();ma(Te,7,()=>e(y),Ue=>Ue.id,(Ue,F,Ae)=>{var Qe=vo(),We=t(Qe),Xe=t(We),$a=t(Xe,!0);a(Xe);var xa=r(Xe,2),ie=t(xa,!0);a(xa),a(We);var x=r(We,2),le=t(x),Le=t(le,!0);a(le);var pa=r(le,2),He=t(pa),sa=t(He),la=t(sa,!0);a(sa),a(He);var Ee=r(He,2);a(pa),a(x),a(Qe),g(O=>{W(Qe,1,`notification-card ${e(F),n(()=>e(F).isRead?"read":"unread")??""}`),ks(Qe,`--card-index: ${e(Ae)??""}`),l($a,(e(F),n(()=>e(F).title))),l(ie,O),l(Le,(e(F),n(()=>e(F).message))),Da(He,"title",(e(F),n(()=>e(F).isRead?"Mark as unread":"Mark as read"))),l(la,(e(F),n(()=>e(F).isRead?"mark_email_unread":"mark_email_read")))},[()=>(e(F),n(()=>B(e(F).timestamp)))]),q("click",He,wr(()=>re(e(F).id))),q("click",Ee,wr(()=>M(e(F).id))),q("click",Qe,()=>re(e(F).id)),q("keydown",Qe,O=>O.key==="Enter"&&re(e(F).id)),i(Ue,Qe)}),a(Te),i(oe,Te)},k=oe=>{var Te=mo(),Ue=t(Te),F=t(Ue),Ae=t(F,!0);a(F),a(Ue);var Qe=r(Ue,2),We=t(Qe,!0);a(Qe);var Xe=r(Qe,2),$a=t(Xe,!0);a(Xe),a(Te),g(xa=>{l(Ae,e(V)==="unread"?"mark_email_read":"notifications_off"),l(We,e(V)==="unread"?"All Caught Up!":"No Notifications"),l($a,xa)},[()=>(e(V),n(()=>e(V)==="unread"?"You have no unread notifications. Great job staying on top of things!":e(V)==="all"?"You don't have any notifications yet.":`No ${de(e(V)).toLowerCase()} notifications found.`))]),i(oe,Te)};m(Ke,oe=>{e(y),n(()=>e(y).length>0)?oe(f):oe(k,!1)},!0)}i(me,te)};m(A,me=>{e(E)?me(ee):me(Ce,!1)},!0)}i(c,v)};m(Me,c=>{e(_)?c(Z):c(J,!1)})}a(Ge),a(ue),g((c,v,A)=>{l(fe,`${e(w)??""} unread`),l(Ze,c),l(je,v),na=W(we,1,"material-symbols-outlined dropdown-arrow",null,na,A)},[()=>(e(V),n(()=>xe(e(V)))),()=>(e(V),n(()=>de(e(V)))),()=>({rotated:e(D)})]),q("click",Oe,G),i(z,ue),It(),h()}var _o=o('<button type="button"><span class="material-symbols-outlined"> </span> <span> </span></button>'),go=o('<div class="dropdown-menu-category"></div>'),bo=o('<button class="clear-date-btn" type="button" title="Clear date"><span class="material-symbols-outlined">close</span></button>'),ho=o('<div class="day-header"> </div>'),yo=o('<div class="empty-day"></div>'),wo=o('<button type="button"> </button>'),So=o('<div class="date-picker-dropdown"><div class="date-picker-header"><button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_left</span></button> <div class="month-year-display"><span class="month-name"> </span> <span class="year-name"> </span></div> <button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_right</span></button></div> <div class="calendar-grid"><!> <!> <!></div></div>'),xo=o('<div class="add-todo-section"><h2 class="section-title">Add New Task</h2> <div class="add-todo-form"><input type="text" placeholder="Enter task title..." class="todo-input"/> <textarea placeholder="Enter description (optional)..." class="todo-input todo-textarea" rows="3"></textarea> <div class="form-row"><div class="form-field"><label class="form-label" for="category-dropdown">Category</label> <div class="custom-dropdown"><button class="dropdown-toggle" id="category-dropdown" type="button"><div class="dropdown-toggle-content"><span class="material-symbols-outlined dropdown-icon-left"> </span> <span class="dropdown-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="form-field"><label class="form-label" for="due-date-picker">Due Date (optional)</label> <div class="custom-date-picker"><div class="date-picker-toggle-wrapper"><button class="date-picker-toggle" id="due-date-picker" type="button"><div class="date-picker-toggle-content"><span class="material-symbols-outlined date-picker-icon-left">calendar_today</span> <span class="date-picker-label"> </span></div> <div class="date-picker-actions"><!> <span>expand_more</span></div></button></div> <!></div></div></div> <button class="add-todo-btn"> </button></div></div>'),ko=o('<button class="clear-search-btn"><span class="material-symbols-outlined">close</span></button>'),Ao=o('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Do=o('<div class="filter-dropdown-menu"></div>'),To=o('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),No=o('<div class="filter-dropdown-menu"></div>'),jo=o('<div class="loading-state"><div class="system-loader"></div> <p>Loading todos...</p></div>'),$o=o('<div class="error-state"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-btn">Retry</button></div>'),Co=o('<p class="todo-description"> </p>'),qo=o('<div><div class="todo-checkbox"><input type="checkbox"/> <label class="checkbox-label"></label></div> <div class="todo-content"><h3> </h3> <!> <div class="todo-meta"><span class="todo-category"> </span> <span class="todo-due-date"> </span></div></div> <div class="todo-actions"><button class="action-btn todo-delete-btn" title="Delete task"><span class="material-symbols-outlined">delete</span></button></div></div>'),Eo=o('<div class="todos-list"></div>'),Fo=o('<div class="no-filtered-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">search_off</span></div> <h3>No Matching Tasks</h3> <p>No tasks match your current search or filter criteria.</p> <button class="clear-filters-btn">Clear all filters</button></div>'),Lo=o(`<div class="no-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">check_circle</span></div> <h3>No Tasks</h3> <p>You don't have any tasks yet. Add one above to get started!</p></div>`),Po=o('<div class="todo-container"><div class="todo-header"><div class="header-content"><h1 class="page-title">Todo List</h1> <p class="page-subtitle">Keep track of your tasks and assignments <span class="progress-badge"> </span></p></div></div> <div class="add-todo-button-section"><button class="add-todo-toggle-btn"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="search-filter-section"><div class="search-filter-row"><div class="todo-search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="todo-search-input" placeholder="Search todos by title or description..."/> <!></div> <div class="todo-filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div></div></div> <div class="todos-section"><!></div></div>');function Io(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u),y=p(),S=p(),_=p(),E=p(),w=p(),$=p();let P=p([]),V=p(!1),D=p(!1),L=p(null),T=p(""),se=p("all"),pe=p("all"),N=p(!1),G=p(!1),H=p(""),I=p(""),re=p("personal"),M=p(""),C=p(!1);const R=[{value:"all",label:"All Categories",icon:"category"},{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}],B=[{value:"all",label:"All Status",icon:"list"},{value:"pending",label:"Pending",icon:"pending"},{value:"completed",label:"Completed",icon:"check_circle"}],de=[{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}];let xe=p(!1),ue=p(!1);const X=new Date;let qe=p(X.getFullYear()),be=p(X.getMonth());const _e=["January","February","March","April","May","June","July","August","September","October","November","December"],fe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];async function ke(){try{if(s(D,!0),s(L,null),!b().userData?.id){s(L,"User not authenticated");return}const Ne=await Qa.get(`/api/student-todos?student_id=${b().userData.id}`);s(P,Ne.data||[])}catch(Ne){console.error("Error loading todos:",Ne),s(L,"Failed to load todos")}finally{s(D,!1)}}async function Ve(){if(e(H).trim())try{if(s(V,!0),s(L,null),!b().userData?.id){s(L,"User not authenticated"),ne.error("User not authenticated");return}const Ne={studentId:b().userData.id,title:e(H).trim(),description:e(I).trim(),category:e(re),dueDate:e(M)||null},Ye=await Qa.post("/api/student-todos",Ne);Ye.success?(s(P,[Ye.data,...e(P)]),s(H,""),s(I,""),s(re,"personal"),s(M,""),s(C,!1),ne.success("Task added successfully!")):(s(L,Ye.error||"Failed to add todo"),ne.error(Ye.error||"Failed to add todo"))}catch(Ne){console.error("Error adding todo:",Ne),s(L,"Failed to add todo"),ne.error("Failed to add todo. Please try again.")}finally{s(V,!1)}}async function ye(Ne,Ye){try{s(L,null);const Sa=await Qa.put("/api/student-todos",{id:Ne,studentId:b().userData.id,completed:!Ye});Sa.success?(s(P,e(P).map(ya=>ya.id===Ne?{...ya,completed:!Ye}:ya)),Ye?ne.success("Task marked as incomplete!"):ne.success("Task marked as completed!")):(s(L,Sa.error||"Failed to update todo"),ne.error(Sa.error||"Failed to update todo"))}catch(Sa){console.error("Error updating todo:",Sa),s(L,"Failed to update todo"),ne.error("Failed to update todo. Please try again.")}}async function Oe(Ne){try{s(L,null);const Ye=await Qa.delete("/api/student-todos",{id:Ne,studentId:b().userData.id});Ye.success?(s(P,e(P).filter(Sa=>Sa.id!==Ne)),ne.success("Task deleted successfully!")):(s(L,Ye.error||"Failed to delete todo"),ne.error(Ye.error||"Failed to delete todo"))}catch(Ye){console.error("Error deleting todo:",Ye),s(L,"Failed to delete todo"),ne.error("Failed to delete todo. Please try again.")}}function U(Ne){es.confirm("Delete Task",`Are you sure you want to delete "${Ne.title}"? This action cannot be undone.`,async()=>{await Oe(Ne.id)},()=>{})}function he(){s(C,!e(C)),e(C)||(s(H,""),s(I,""),s(re,"personal"),s(M,""),s(xe,!1),s(ue,!1))}function Ze(){s(N,!e(N))}function K(){s(G,!e(G))}function je(Ne){s(se,Ne),s(N,!1)}function we(Ne){s(pe,Ne),s(G,!1)}function na(Ne){const Ye=R.find(Sa=>Sa.value===Ne);return Ye?Ye.label:"All Categories"}function ia(Ne){const Ye=R.find(Sa=>Sa.value===Ne);return Ye?Ye.icon:"category"}function Aa(Ne){const Ye=B.find(Sa=>Sa.value===Ne);return Ye?Ye.label:"All Status"}function ha(Ne){const Ye=B.find(Sa=>Sa.value===Ne);return Ye?Ye.icon:"list"}function Pe(){s(xe,!e(xe))}function ca(Ne){s(re,Ne),s(xe,!1)}function va(Ne){Ne.target.closest(".custom-dropdown")||s(xe,!1),Ne.target.closest(".custom-date-picker")||s(ue,!1),Ne.target.closest(".filter-dropdown")||(s(N,!1),s(G,!1))}Wt(()=>(document.addEventListener("click",va),b().userData?.id&&ke(),()=>{document.removeEventListener("click",va)}));function Ie(Ne){const Ye=de.find(Sa=>Sa.value===Ne);return Ye?Ye.label:"Select Category"}function Ge(Ne){const Ye=de.find(Sa=>Sa.value===Ne);return Ye?Ye.icon:"category"}function Me(){if(s(ue,!e(ue)),e(ue))if(e(M)){const Ne=new Date(e(M)+"T00:00:00");s(qe,Ne.getFullYear()),s(be,Ne.getMonth()),Ne.getDate()}else{const Ne=new Date;s(qe,Ne.getFullYear()),s(be,Ne.getMonth())}}function Z(Ne){console.log("selectDate called with day:",Ne),console.log("selectedYear:",e(qe),"selectedMonth:",e(be));const Ye=e(qe),Sa=e(be)+1,ya=Ne.toString().padStart(2,"0"),aa=Sa.toString().padStart(2,"0");s(M,`${Ye}-${aa}-${ya}`),console.log("Created newTodoDueDate:",e(M)),s(ue,!1)}function J(){s(M,""),s(ue,!1)}function c(){e(be)===0?(s(be,11),gr(qe,-1)):gr(be,-1)}function v(){e(be)===11?(s(be,0),gr(qe)):gr(be)}function A(Ne,Ye){return new Date(Ne,Ye+1,0).getDate()}function ee(Ne,Ye){return new Date(Ne,Ye,1).getDay()}function Ce(Ne){const Ye=new Date;return Ne===Ye.getDate()&&e(be)===Ye.getMonth()&&e(qe)===Ye.getFullYear()}function me(Ne){if(!e(M))return!1;const Ye=new Date(e(M)+"T00:00:00");return Ne===Ye.getDate()&&e(be)===Ye.getMonth()&&e(qe)===Ye.getFullYear()}function te(Ne){if(console.log("formatDueDate called with:",Ne),!Ne||Ne==="No due date")return"No due date";if(Ne==="Today"||Ne==="Tomorrow"||Ne==="Next Week")return Ne;const Ye=Ne.split("-");if(Ye.length!==3)return Ne;const Sa=parseInt(Ye[0]),ya=parseInt(Ye[1])-1,aa=parseInt(Ye[2]);if(console.log("Parsed date components:",{year:Sa,month:ya+1,day:aa}),isNaN(Sa)||isNaN(ya)||isNaN(aa))return Ne;const ta=new Date,ga=ta.getFullYear(),za=ta.getMonth(),ja=ta.getDate();if(console.log("Today components:",{year:ga,month:za+1,day:ja}),Sa===ga&&ya===za&&aa===ja)return console.log("Returning: Today"),"Today";const ka=new Date(ta);ka.setDate(ka.getDate()+1);const Oa=ka.getFullYear(),lt=ka.getMonth(),vt=ka.getDate();if(console.log("Tomorrow components:",{year:Oa,month:lt+1,day:vt}),Sa===Oa&&ya===lt&&aa===vt)return console.log("Returning: Tomorrow"),"Tomorrow";const ft=new Date(Sa,ya,aa).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).replace(/^(\w+),/,"$1:");return console.log("Returning formatted date:",ft),ft}Ya(()=>(e(P),e(T),e(se),e(pe)),()=>{s(y,(()=>{let Ne=e(P);if(e(T).trim()){const Ye=e(T).toLowerCase().trim();Ne=Ne.filter(Sa=>Sa.title.toLowerCase().includes(Ye)||Sa.description&&Sa.description.toLowerCase().includes(Ye))}return e(se)!=="all"&&(Ne=Ne.filter(Ye=>Ye.category===e(se))),e(pe)!=="all"&&(e(pe)==="completed"?Ne=Ne.filter(Ye=>Ye.completed):e(pe)==="pending"&&(Ne=Ne.filter(Ye=>!Ye.completed))),Ne})())}),Ya(()=>e(M),()=>{s(S,e(M)?new Date(e(M)+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).replace(/^(\w+),/,"$1:"):"Select due date")}),Ya(()=>e(P),()=>{s(_,e(P).filter(Ne=>Ne.completed).length)}),Ya(()=>e(P),()=>{s(E,e(P).length)}),Ya(()=>e(y),()=>{s(w,e(y).filter(Ne=>Ne.completed).length)}),Ya(()=>e(y),()=>{s($,e(y).length)}),ds(),is();var Ke=Po();q("click",Fs,va);var f=t(Ke),k=t(f),oe=r(t(k),2),Te=r(t(oe)),Ue=t(Te);a(Te),a(oe),a(k),a(f);var F=r(f,2),Ae=t(F),Qe=t(Ae),We=t(Qe,!0);a(Qe);var Xe=r(Qe);a(Ae),a(F);var $a=r(F,2);{var xa=Ne=>{var Ye=xo(),Sa=r(t(Ye),2),ya=t(Sa);Ba(ya);var aa=r(ya,2);br(aa);var ta=r(aa,2),ga=t(ta),za=r(t(ga),2),ja=t(za),ka=t(ja),Oa=t(ka),lt=t(Oa,!0);a(Oa);var vt=r(Oa,2),it=t(vt,!0);a(vt),a(ka);var Rt=r(ka,2);a(ja);var ft=r(ja,2);{var $t=Ca=>{var Ra=go();ma(Ra,5,()=>de,Xt,(Wa,at)=>{var bt=_o(),j=t(bt),ve=t(j,!0);a(j);var ze=r(j,2),ba=t(ze,!0);a(ze),a(bt),g(()=>{W(bt,1,`dropdown-item ${e(at),e(re),n(()=>e(at).value===e(re)?"selected":"")??""}`),l(ve,(e(at),n(()=>e(at).icon))),l(ba,(e(at),n(()=>e(at).label)))}),q("click",bt,()=>ca(e(at).value)),i(Wa,bt)}),a(Ra),i(Ca,Ra)};m(ft,Ca=>{e(xe)&&Ca($t)})}a(za),a(ga);var Mt=r(ga,2),Q=r(t(Mt),2),$e=t(Q),oa=t($e),Fa=t(oa),tt=r(t(Fa),2),Ga=t(tt,!0);a(tt),a(Fa);var fa=r(Fa,2),_t=t(fa);{var pt=Ca=>{var Ra=bo();q("click",Ra,wr(J)),i(Ca,Ra)};m(_t,Ca=>{e(M)&&Ca(pt)})}var Ha=r(_t,2);a(fa),a(oa),a($e);var gt=r($e,2);{var At=Ca=>{var Ra=So(),Wa=t(Ra),at=t(Wa),bt=r(at,2),j=t(bt),ve=t(j,!0);a(j);var ze=r(j,2),ba=t(ze,!0);a(ze),a(bt);var ce=r(bt,2);a(Wa);var Va=r(Wa,2),dt=t(Va);ma(dt,1,()=>fe,Xt,(ct,rt)=>{var Ka=ho(),wa=t(Ka,!0);a(Ka),g(()=>l(wa,e(rt))),i(ct,Ka)});var _a=r(dt,2);ma(_a,1,()=>(e(qe),e(be),n(()=>Array(ee(e(qe),e(be))))),Xt,(ct,rt)=>{var Ka=yo();i(ct,Ka)});var Ma=r(_a,2);ma(Ma,1,()=>(e(qe),e(be),n(()=>Array(A(e(qe),e(be))))),Xt,(ct,rt,Ka)=>{const wa=qs(()=>Ka+1);var La=wo(),nt=t(La,!0);a(La),g((Ct,Nt)=>{W(La,1,`day-cell ${Ct??""} ${Nt??""}`),l(nt,e(wa))},[()=>(Zt(e(wa)),n(()=>Ce(e(wa))?"today":"")),()=>(Zt(e(wa)),n(()=>me(e(wa))?"selected":""))]),q("click",La,()=>Z(e(wa))),i(ct,La)}),a(Va),a(Ra),g(()=>{l(ve,(e(be),n(()=>_e[e(be)]))),l(ba,e(qe))}),q("click",at,c),q("click",ce,v),i(Ca,Ra)};m(gt,Ca=>{e(ue)&&Ca(At)})}a(Q),a(Mt),a(ta);var Lt=r(ta,2),Ja=t(Lt,!0);a(Lt),a(Sa),a(Ye),g((Ca,Ra,Wa)=>{l(lt,Ca),l(it,Ra),W(Rt,1,`material-symbols-outlined dropdown-icon ${e(xe)?"open":""}`),l(Ga,e(S)),W(Ha,1,`material-symbols-outlined dropdown-icon ${e(ue)?"open":""}`),Lt.disabled=Wa,l(Ja,e(V)?"Adding...":"Add Task")},[()=>(e(re),n(()=>Ge(e(re)))),()=>(e(re),n(()=>Ie(e(re)))),()=>(e(H),e(V),n(()=>!e(H).trim()||e(V)))]),Za(ya,()=>e(H),Ca=>s(H,Ca)),q("keydown",ya,Ca=>Ca.key==="Enter"&&Ve()),Za(aa,()=>e(I),Ca=>s(I,Ca)),q("click",ja,Pe),q("click",oa,Me),q("click",Lt,Ve),i(Ne,Ye)};m($a,Ne=>{e(C)&&Ne(xa)})}var ie=r($a,2),x=t(ie),le=t(x),Le=r(t(le),2);Ba(Le);var pa=r(Le,2);{var He=Ne=>{var Ye=ko();q("click",Ye,()=>s(T,"")),i(Ne,Ye)};m(pa,Ne=>{e(T)&&Ne(He)})}a(le);var sa=r(le,2),la=t(sa),Ee=t(la),O=t(Ee),Fe=t(O),ea=t(Fe,!0);a(Fe);var qa=r(Fe,2),Ia=t(qa,!0);a(qa),a(O);var st=r(O,2);let ra;a(Ee);var ae=r(Ee,2);{var Re=Ne=>{var Ye=Do();ma(Ye,5,()=>R,Xt,(Sa,ya)=>{var aa=Ao();let ta;var ga=t(aa),za=t(ga,!0);a(ga);var ja=r(ga,2),ka=t(ja,!0);a(ja),a(aa),g(Oa=>{ta=W(aa,1,"filter-dropdown-item",null,ta,Oa),l(za,(e(ya),n(()=>e(ya).icon))),l(ka,(e(ya),n(()=>e(ya).label)))},[()=>({active:e(ya).value===e(se)})]),q("click",aa,()=>je(e(ya).value)),i(Sa,aa)}),a(Ye),i(Ne,Ye)};m(ae,Ne=>{e(N)&&Ne(Re)})}a(la);var Y=r(la,2),Se=t(Y),Je=t(Se),Be=t(Je),ge=t(Be,!0);a(Be);var De=r(Be,2),ua=t(De,!0);a(De),a(Je);var Pa=r(Je,2);let et;a(Se);var Ea=r(Se,2);{var ot=Ne=>{var Ye=No();ma(Ye,5,()=>B,Xt,(Sa,ya)=>{var aa=To();let ta;var ga=t(aa),za=t(ga,!0);a(ga);var ja=r(ga,2),ka=t(ja,!0);a(ja),a(aa),g(Oa=>{ta=W(aa,1,"filter-dropdown-item",null,ta,Oa),l(za,(e(ya),n(()=>e(ya).icon))),l(ka,(e(ya),n(()=>e(ya).label)))},[()=>({active:e(ya).value===e(pe)})]),q("click",aa,()=>we(e(ya).value)),i(Sa,aa)}),a(Ye),i(Ne,Ye)};m(Ea,Ne=>{e(G)&&Ne(ot)})}a(Y),a(sa),a(x),a(ie);var mt=r(ie,2),St=t(mt);{var Tt=Ne=>{var Ye=jo();i(Ne,Ye)},Ft=Ne=>{var Ye=Ta(),Sa=da(Ye);{var ya=ta=>{var ga=$o(),za=r(t(ga),2),ja=t(za,!0);a(za);var ka=r(za,2);a(ga),g(()=>l(ja,e(L))),q("click",ka,ke),i(ta,ga)},aa=ta=>{var ga=Ta(),za=da(ga);{var ja=Oa=>{var lt=Eo();ma(lt,7,()=>e(y),vt=>vt.id,(vt,it,Rt)=>{var ft=qo();let $t;var Mt=t(ft),Q=t(Mt);Ba(Q);var $e=r(Q,2);a(Mt);var oa=r(Mt,2),Fa=t(oa);let tt;var Ga=t(Fa,!0);a(Fa);var fa=r(Fa,2);{var _t=Ra=>{var Wa=Co(),at=t(Wa,!0);a(Wa),g(()=>l(at,(e(it),n(()=>e(it).description)))),i(Ra,Wa)};m(fa,Ra=>{e(it),n(()=>e(it).description)&&Ra(_t)})}var pt=r(fa,2),Ha=t(pt),gt=t(Ha,!0);a(Ha);var At=r(Ha,2),Lt=t(At,!0);a(At),a(pt),a(oa);var Ja=r(oa,2),Ca=t(Ja);a(Ja),a(ft),g((Ra,Wa,at)=>{$t=W(ft,1,"todo-card",null,$t,Ra),ks(ft,`--card-index: ${e(Rt)+1};`),ui(Q,(e(it),n(()=>e(it).completed))),Da(Q,"id",`todo-${e(it),n(()=>e(it).id)??""}`),Q.disabled=e(D),Da($e,"for",`todo-${e(it),n(()=>e(it).id)??""}`),tt=W(Fa,1,"todo-title",null,tt,Wa),l(Ga,(e(it),n(()=>e(it).title))),l(gt,(e(it),n(()=>e(it).category))),l(Lt,at),Ca.disabled=e(D)},[()=>({completed:e(it).completed}),()=>({completed:e(it).completed}),()=>(e(it),n(()=>te(e(it).dueDate)))]),q("change",Q,()=>ye(e(it).id,e(it).completed)),q("click",Ca,()=>U(e(it))),i(vt,ft)}),a(lt),i(Oa,lt)},ka=Oa=>{var lt=Ta(),vt=da(lt);{var it=ft=>{var $t=Fo(),Mt=r(t($t),6);a($t),q("click",Mt,()=>{s(T,""),s(se,"all"),s(pe,"all")}),i(ft,$t)},Rt=ft=>{var $t=Lo();i(ft,$t)};m(vt,ft=>{e(P),n(()=>e(P).length>0)?ft(it):ft(Rt,!1)},!0)}i(Oa,lt)};m(za,Oa=>{e(y),n(()=>e(y).length>0)?Oa(ja):Oa(ka,!1)},!0)}i(ta,ga)};m(Sa,ta=>{e(L)?ta(ya):ta(aa,!1)},!0)}i(Ne,Ye)};m(St,Ne=>{e(D)?Ne(Tt):Ne(Ft,!1)})}a(mt),a(Ke),g((Ne,Ye,Sa,ya,aa,ta)=>{l(Ue,`${e(_)??""}/${e(E)??""} completed`),l(We,e(C)?"remove":"add"),l(Xe,` ${e(C)?"Cancel":"Add New Task"}`),l(ea,Ne),l(Ia,Ye),ra=W(st,1,"material-symbols-outlined dropdown-arrow",null,ra,Sa),l(ge,ya),l(ua,aa),et=W(Pa,1,"material-symbols-outlined dropdown-arrow",null,et,ta)},[()=>(e(se),n(()=>ia(e(se)))),()=>(e(se),n(()=>na(e(se)))),()=>({rotated:e(N)}),()=>(e(pe),n(()=>ha(e(pe)))),()=>(e(pe),n(()=>Aa(e(pe)))),()=>({rotated:e(G)})]),q("click",Ae,he),Za(Le,()=>e(T),Ne=>s(T,Ne)),q("click",Ee,Ze),q("click",Se,K),i(z,Ke),It(),h()}function Go(z,d){s(d,!e(d))}function Mo(z,d,u){s(d,!e(d)),u()}var Ro=o('<img alt="Profile" class="avatar-image"/>'),Oo=o('<div class="avatar-placeholder"> </div>'),Vo=(z,d,u)=>{d(),u.onNavigateToSettings()},Uo=async(z,d,u)=>{d(),await u.onlogout(),Js("Logged out successfully. See you next time!")},Wo=o('<div class="teacher-navbar-dropdown-menu"><button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Yo=o('<nav class="teacher-navbar" role="navigation" aria-label="Teacher navigation"><div class="teacher-navbar-container"><div class="teacher-navbar-left"><button class="teacher-navbar-icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">person_book</span> <span class="app-title"> </span></div></div> <div class="teacher-navbar-right"><button class="teacher-navbar-icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="teacher-navbar-user-profile"><div class="teacher-navbar-user-info"><span class="teacher-navbar-user-name"> </span> <span class="user-id"> </span></div> <div class="teacher-navbar-user-avatar"><!></div></button> <!></div></div></div></nav>');function Ho(z,d){Pt(d,!0);let u=xt(d,"teacherName",3,"John Does"),h=xt(d,"firstName",3,"John"),b=xt(d,"gender",3,"male"),y=xt(d,"accountNumber",3,"TCH-2025-0001"),S=xt(d,"profileImage",3,null);function _(U){return U==="female"?"Ms.":"Mr."}let E=Ut(()=>`${_(b())} ${h()}`),w=Na(!0),$=Na(!1);function P(){s($,!1)}function V(U){e($)&&!U.target.closest(".user-profile-container")&&P()}Wt(()=>{const U=localStorage.getItem("theme");return s(w,U!=="light"),D(),document.addEventListener("click",V),()=>{document.removeEventListener("click",V)}});function D(){e(w)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function L(U){return U.split(" ").map(he=>he.charAt(0)).join("").toUpperCase().slice(0,2)}var T=Yo(),se=t(T),pe=t(se),N=t(pe);N.__click=function(...U){d.onToggleNavRail?.apply(this,U)};var G=r(N,2),H=r(t(G),2),I=t(H);a(H),a(G),a(pe);var re=r(pe,2),M=t(re);M.__click=[Mo,w,D];var C=t(M),R=t(C,!0);a(C),a(M);var B=r(M,2),de=t(B);de.__click=[Go,$];var xe=t(de),ue=t(xe),X=t(ue,!0);a(ue);var qe=r(ue,2),be=t(qe);a(qe),a(xe);var _e=r(xe,2),fe=t(_e);{var ke=U=>{var he=Ro();g(()=>Da(he,"src",S())),i(U,he)},Ve=U=>{var he=Oo(),Ze=t(he,!0);a(he),g(K=>l(Ze,K),[()=>L(h())]),i(U,he)};m(fe,U=>{S()?U(ke):U(Ve,!1)})}a(_e),a(de);var ye=r(de,2);{var Oe=U=>{var he=Wo(),Ze=t(he);Ze.__click=[Vo,P,d];var K=r(Ze,2);K.__click=[Uo,P,d],a(he),i(U,he)};m(ye,U=>{e($)&&U(Oe)})}a(B),a(re),a(se),a(T),g(()=>{l(I,`Welcome, ${e(E)??""}`),l(R,e(w)?"light_mode":"dark_mode"),l(X,u()),l(be,`Account: ${y()??""}`)}),i(z,T),It()}js(["click"]);var Jo=(z,d,u)=>d(e(u).id),Bo=o('<button><div class="teacher-menu-rail-icon-container"><span class="material-symbols-outlined teacher-menu-rail-icon"> </span></div> <span class="teacher-menu-rail-label"> </span></button>'),Qo=(z,d,u)=>d(e(u).id),zo=o('<button><div class="teacher-menu-nav-icon-container"><span class="material-symbols-outlined teacher-menu-nav-icon"> </span></div></button>'),Ko=o('<nav role="navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-rail-container"></div></nav> <nav class="teacher-menu-bottom-navigation" role="navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-nav-container"></div></nav>',1);function Zo(z,d){Pt(d,!0);let u=xt(d,"teacherActiveSection",15,"schedule"),h=xt(d,"teacherNavRailVisible",3,!0);const b=[{id:"schedule",label:"Schedule",icon:"schedule"},{id:"students",label:"Class Management",icon:"group"},{id:"advisory",label:"Advisory Class",icon:"supervisor_account"}];function y(V){u(V),d.onnavigate&&d.onnavigate({detail:{section:V}})}var S=Ko(),_=da(S);let E;var w=t(_);ma(w,21,()=>b,V=>V.id,(V,D)=>{var L=Bo();let T;L.__click=[Jo,y,D];var se=t(L),pe=t(se),N=t(pe,!0);a(pe),a(se);var G=r(se,2),H=t(G,!0);a(G),a(L),g(I=>{T=W(L,1,"teacher-menu-rail-item",null,T,I),Da(L,"aria-label",e(D).label),Da(L,"aria-current",e(D).id===u()?"page":void 0),l(N,e(D).icon),l(H,e(D).label)},[()=>({active:e(D).id===u()})]),i(V,L)}),a(w),a(_);var $=r(_,2),P=t($);ma(P,21,()=>b,V=>V.id,(V,D)=>{var L=zo();let T;L.__click=[Qo,y,D];var se=t(L),pe=t(se),N=t(pe,!0);a(pe),a(se),a(L),g(G=>{T=W(L,1,"teacher-menu-nav-item",null,T,G),Da(L,"aria-label",e(D).label),Da(L,"aria-current",e(D).id===u()?"page":void 0),l(N,e(D).icon)},[()=>({active:e(D).id===u()})]),i(V,L)}),a(P),a($),g(V=>E=W(_,1,"teacher-menu-navigation-rail",null,E,V),[()=>({collapsed:!h()})]),i(z,S),It()}js(["click"]);var Xo=o('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),el=o("<button> </button>"),al=o('<div class="teacher-dropdown-menu"></div>'),tl=o('<div class="loading-message"><div class="system-loader"></div> <h3>Loading Schedule...</h3></div>'),sl=o('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),rl=o('<div class="schedule-class-location"><span class="material-symbols-outlined">schedule</span> <span>Available Time</span></div>'),il=o('<div class="schedule-class-teacher"><span class="material-symbols-outlined">book</span> <span> </span></div>'),nl=o('<div class="schedule-class-grade"><span class="material-symbols-outlined">school</span> <span> </span></div>'),ol=o('<div class="schedule-class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <!>',1),ll=o('<div><div class="class-header"><h3 class="schedule-class-name"> </h3> <span class="schedule-class-time"> </span></div> <div class="class-details"><!></div></div>'),dl=o('<div class="schedule-classes-grid"></div>'),cl=o('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),vl=o('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-schedule-header"><h1 class="schedule-page-title">Teaching Schedule</h1> <p class="schedule-page-subtitle">Your weekly teaching schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="schedule-day-selector"></div> <div class="teacher-mobile-dropdown"><button class="teacher-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><h2> </h2> <!></div></div>');function ul(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u),y=p(),S=p(),_=new Date,E=["January","February","March","April","May","June","July","August","September","October","November","December"],w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$=E[_.getMonth()],P=_.getDate(),V=w[_.getDay()],D={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},L=_.getDay();let T=p(D[L]||"Mon");const se=["blue","green","purple","yellow","orange"];function pe(Ie){return se[Ie%se.length]}let N=p([]),G=p(!0),H=p(null);function I(Ie){const Ge={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},Me={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},Z={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return Ie.forEach(J=>{const c=Me[J.day_of_week.toLowerCase()];if(c){const v=re(J.start_time),A=re(J.end_time);let ee,Ce;J.schedule_type==="subject"?(ee=J.section_name,Ce=J.subject_name||"Unknown Subject"):J.schedule_type==="activity"&&(ee=J.activity_type_name||"Activity",Ce=J.activity_type_name||"Activity");const me={name:ee,time:`${v} - ${A}`,room:J.room_name||"TBA",subject:Ce,gradeLevel:J.grade_level,scheduleType:J.schedule_type,color:pe(Z[c])};Ge[c].push(me),Z[c]++}}),Object.keys(Ge).forEach(J=>{const c=Ge[J],v=R(c),A=[...c,...v].sort((ee,Ce)=>{const me=M(ee.time.split(" - ")[0]),te=M(Ce.time.split(" - ")[0]);return me-te});Ge[J]=A}),Ge}function re(Ie){const[Ge,Me]=Ie.split(":"),Z=parseInt(Ge),J=Z>=12?"PM":"AM";return`${(Z===0?12:Z>12?Z-12:Z).toString().padStart(2,"0")}:${Me} ${J}`}function M(Ie){const[Ge,Me]=Ie.split(" "),[Z,J]=Ge.split(":").map(Number);let c=J;return Me==="PM"&&Z!==12?c+=(Z+12)*60:Me==="AM"&&Z===12?c+=0:c+=Z*60,c}function C(Ie){const Ge=Math.floor(Ie/60),Me=Ie%60,Z=Ge>=12?"PM":"AM";return`${(Ge===0?12:Ge>12?Ge-12:Ge).toString().padStart(2,"0")}:${Me.toString().padStart(2,"0")} ${Z}`}function R(Ie){if(Ie.length<=1)return[];const Ge=[...Ie].sort((Z,J)=>{const c=M(Z.time.split(" - ")[0]),v=M(J.time.split(" - ")[0]);return c-v}),Me=[];for(let Z=0;Z<Ge.length-1;Z++){const J=Ge[Z],c=Ge[Z+1],v=M(J.time.split(" - ")[1]),A=M(c.time.split(" - ")[0]);if(A>v){const ee=C(v),Ce=C(A);Me.push({name:"Vacant Time",time:`${ee} - ${Ce}`,room:"Available",subject:"Free Period",color:"gray",isVacant:!0})}}return Me}async function B(){try{s(G,!0),s(H,null);const Ie=b();if(!Ie.isAuthenticated||!Ie.userData?.id)throw new Error("User not authenticated");const Me=await(await fetch(`/api/schedules?action=teacher-schedules&teacherId=${Ie.userData.id}&schoolYear=2024-2025`)).json();if(!Me.success)throw new Error(Me.error||"Failed to fetch schedule data");s(N,I(Me.data))}catch(Ie){console.error("Error fetching schedule data:",Ie),s(H,Ie.message),s(N,{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]})}finally{s(G,!1)}}Wt(()=>{B()});const de={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"},xe=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}];let ue=p(!1);function X(Ie){Ie.target.closest(".teacher-mobile-dropdown")||s(ue,!1)}function qe(){s(ue,!e(ue))}function be(Ie){s(T,Ie),s(ue,!1)}Ya(()=>(e(N),e(T)),()=>{s(y,e(N)[e(T)]||[])}),Ya(()=>e(T),()=>{s(S,de[e(T)]||"Monday")}),ds(),is();var _e=vl(),fe=r(t(_e),2),ke=t(fe),Ve=t(ke),ye=t(Ve);a(Ve),a(ke);var Oe=r(ke,2);ma(Oe,5,()=>xe,Xt,(Ie,Ge)=>{let Me=()=>e(Ge).day;var Z=Xo(),J=t(Z),c=t(J,!0);a(J);var v=r(J,2),A=t(v,!0);a(v),a(Z),g(()=>{W(Z,1,`schedule-day-btn ${Me()===e(T)?"active":""}`),l(c,Me()),l(A,(Me(),n(()=>de[Me()])))}),q("click",Z,()=>be(Me())),i(Ie,Z)}),a(Oe);var U=r(Oe,2),he=t(U),Ze=t(he),K=t(Ze,!0);a(Ze);var je=r(Ze,2);a(he);var we=r(he,2);{var na=Ie=>{var Ge=al();ma(Ge,5,()=>xe,Xt,(Me,Z)=>{let J=()=>e(Z).day;var c=el(),v=t(c,!0);a(c),g(()=>{W(c,1,`teacher-dropdown-item ${J()===e(T)?"selected":""}`),l(v,(J(),n(()=>de[J()])))}),q("click",c,()=>be(J())),i(Me,c)}),a(Ge),i(Ie,Ge)};m(we,Ie=>{e(ue)&&Ie(na)})}a(U),a(fe);var ia=r(fe,2),Aa=t(ia),ha=t(Aa);a(Aa);var Pe=r(Aa,2);{var ca=Ie=>{var Ge=tl();i(Ie,Ge)},va=Ie=>{var Ge=Ta(),Me=da(Ge);{var Z=c=>{var v=sl(),A=r(t(v),4),ee=t(A,!0);a(A);var Ce=r(A,2);a(v),g(()=>l(ee,e(H))),q("click",Ce,B),i(c,v)},J=c=>{var v=Ta(),A=da(v);{var ee=me=>{var te=dl();ma(te,5,()=>e(y),Xt,(Ke,f)=>{var k=ll(),oe=t(k),Te=t(oe),Ue=t(Te,!0);a(Te);var F=r(Te,2),Ae=t(F,!0);a(F),a(oe);var Qe=r(oe,2),We=t(Qe);{var Xe=xa=>{var ie=rl();i(xa,ie)},$a=xa=>{var ie=ol(),x=da(ie),le=r(t(x),2),Le=t(le,!0);a(le),a(x);var pa=r(x,2);{var He=Ee=>{var O=il(),Fe=r(t(O),2),ea=t(Fe,!0);a(Fe),a(O),g(()=>l(ea,(e(f),n(()=>e(f).subject)))),i(Ee,O)};m(pa,Ee=>{e(f),n(()=>e(f).subject)&&Ee(He)})}var sa=r(pa,2);{var la=Ee=>{var O=nl(),Fe=r(t(O),2),ea=t(Fe);a(Fe),a(O),g(()=>l(ea,`Grade ${e(f),n(()=>e(f).gradeLevel)??""}`)),i(Ee,O)};m(sa,Ee=>{e(f),n(()=>e(f).gradeLevel&&e(f).scheduleType==="subject")&&Ee(la)})}g(()=>l(Le,(e(f),n(()=>e(f).room)))),i(xa,ie)};m(We,xa=>{e(f),n(()=>e(f).scheduleType==="vacant")?xa(Xe):xa($a,!1)})}a(Qe),a(k),g(()=>{W(k,1,`schedule-class-card ${e(f),n(()=>e(f).color)??""}`),l(Ue,(e(f),n(()=>e(f).name))),l(Ae,(e(f),n(()=>e(f).time)))}),i(Ke,k)}),a(te),i(me,te)},Ce=me=>{var te=cl(),Ke=r(t(te),4),f=t(Ke);a(Ke),a(te),g(()=>l(f,`You don't have any classes scheduled for ${e(S)??""}. Enjoy your free day!`)),i(me,te)};m(A,me=>{e(y),n(()=>e(y).length>0)?me(ee):me(Ce,!1)},!0)}i(c,v)};m(Me,c=>{e(H)?c(Z):c(J,!1)},!0)}i(Ie,Ge)};m(Pe,Ie=>{e(G)?Ie(ca):Ie(va,!1)})}a(ia),a(_e),g(()=>{l(ye,`${V??""}, ${$??""} ${P??""}`),l(K,(e(T),n(()=>de[e(T)]||"Select Day"))),W(je,1,`material-symbols-outlined teacher-dropdown-icon ${e(ue)?"open":""}`),l(ha,`${e(S)??""} Classes`)}),q("click",he,qe),q("click",_e,X),q("keydown",_e,X),i(z,_e),It(),h()}var ml=o('<div class="odometer-container svelte-1ve39fg"><!></div>');function ai(z,d){Pt(d,!1);let u=xt(d,"value",8,0),h=xt(d,"format",8,"d"),b=xt(d,"theme",8,"default"),y=xt(d,"duration",8,2e3),S=xt(d,"auto",8,!0);xt(d,"selector",8,null);let _=xt(d,"useCommaDecimal",8,!1),E=xt(d,"animation",8,"ease"),w=p(),$=p();Wt(async()=>{try{const D=(await Hr(async()=>{const{default:L}=await import("../chunks/7634Yfgp.js").then(T=>T.o);return{default:L}},[],import.meta.url)).default;await Hr(()=>Promise.resolve({}),__vite__mapDeps([0]),import.meta.url),s($,new D({el:e(w),format:h(),theme:b(),duration:y(),auto:S(),animation:E(),value:0})),_()&&new MutationObserver(()=>{const T=e(w).textContent;T&&T.includes(".")&&fs(w,e(w).textContent=T.replace(".",","))}).observe(e(w),{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>{e($)&&e($).update(u())},100)}catch(D){console.error("Failed to load odometer:",D)}}),Ya(()=>(e($),Zt(u())),()=>{e($)&&Kr&&e($).update(u())}),ds(),is();var P=ml(),V=t(P);m(V,D=>{}),a(P),hr(P,D=>s(w,D),()=>e(w)),i(z,P),It()}var pl=o('<div class="class-mgmt-stat-card"><div class="class-mgmt-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="class-mgmt-stat-value"><!></div> <div class="class-mgmt-stat-label"> </div></div></div>'),fl=o('<div class="loading-container"><div class="system-loader"></div> <p>Loading your teaching assignments...</p></div>'),_l=o('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),gl=o(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Teaching Assignments</h3> <p>You don't have any sections assigned for this school year.</p></div>`),bl=(z,d,u,h)=>d(e(u).yearLevel,e(h).name,e(h).id),hl=o('<span class="more-subjects"> </span>'),yl=o('<div class="section-subjects"> <!></div>'),wl=o('<button class="section-card"><div class="section-name"> </div> <!></button>'),Sl=o('<div class="year-level-container"><div class="year-level-header"><div class="year-level-info"><div class="year-level-icon"><span class="material-symbols-outlined">school</span></div> <div class="year-level-details"><h3 class="year-level-title"> </h3> <p class="year-level-summary"> </p></div></div></div> <div class="sections-grid"></div></div>'),xl=o('<div class="year-levels-grid"></div>'),kl=o('<div class="class-management-container"><div class="class-mgmt-page-header"><div class="header-content"><h1 class="class-mgmt-page-title">Class Management Dashboard</h1> <p class="class-mgmt-page-subtitle">Overview of your teaching assignments and student distribution</p></div></div> <div class="class-mgmt-stats-section"><div class="class-mgmt-stats-grid"></div></div> <div class="classes-section-container"><h2 class="class-mgmt-section-title">Year Levels & Sections</h2> <!></div></div>');function Br(z,d){Pt(d,!0);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=Na(Es({name:"Loading...",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0})),S=Na(Es([])),_=Na(!0),E=Na(null);function w(G,H,I){d.onNavigateToClassList&&d.onNavigateToClassList({detail:{yearLevel:G,sectionName:H,sectionId:I}})}let $=[{id:"year-levels",label:"Year Levels",getValue:()=>e(y).yearLevels.length,icon:"school",color:"var(--school-primary)"},{id:"sections",label:"Total Sections",getValue:()=>e(y).totalSections,icon:"class",color:"var(--school-secondary)"},{id:"students",label:"Total Students",getValue:()=>e(y).totalStudents,icon:"people",color:"var(--success)"},{id:"average",label:"Average Per Section",getValue:()=>e(y).averagePerSection,icon:"analytics",color:"var(--school-accent)"}];async function P(){try{s(_,!0),s(E,null);const G=b();if(!G.isAuthenticated||!G.userData?.id)throw new Error("User not authenticated");const H=G.userData.id,M=await(await fetch(`/api/teacher-sections?teacherId=${H}&schoolYear=2024-2025`)).json();if(!M.success)throw new Error(M.error||"Failed to fetch teacher sections");s(S,M.data.classData,!0),s(y,{name:G.userData.name||"Teacher",yearLevels:M.data.stats.yearLevels,totalSections:M.data.stats.totalSections,totalStudents:M.data.stats.totalStudents,averagePerSection:M.data.stats.averagePerSection},!0)}catch(G){console.error("Error fetching teacher sections:",G),s(E,G.message,!0),s(S,[],!0),s(y,{name:"Teacher",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0},!0)}finally{s(_,!1)}}Wt(()=>{P()});var V=kl(),D=r(t(V),2),L=t(D);ma(L,21,()=>$,G=>G.id,(G,H)=>{var I=pl(),re=t(I),M=t(re),C=t(M,!0);a(M),a(re);var R=r(re,2),B=t(R),de=t(B);{let X=Ut(()=>e(H).getValue());ai(de,{get value(){return e(X)},format:"d",duration:2e3,animation:"ease-out"})}a(B);var xe=r(B,2),ue=t(xe,!0);a(xe),a(R),a(I),g(()=>{ks(re,`background-color: ${e(H).color??""}20; color: ${e(H).color??""}`),l(C,e(H).icon),ks(B,`color: ${e(H).color??""}`),l(ue,e(H).label)}),i(G,I)}),a(L),a(D);var T=r(D,2),se=r(t(T),2);{var pe=G=>{var H=fl();i(G,H)},N=G=>{var H=Ta(),I=da(H);{var re=C=>{var R=_l(),B=r(t(R),2),de=t(B);a(B);var xe=r(B,2);xe.__click=P,a(R),g(()=>l(de,`Error: ${e(E)??""}`)),i(C,R)},M=C=>{var R=Ta(),B=da(R);{var de=ue=>{var X=gl();i(ue,X)},xe=ue=>{var X=xl();ma(X,21,()=>e(S),qe=>qe.yearLevel,(qe,be)=>{var _e=Sl(),fe=t(_e),ke=t(fe),Ve=r(t(ke),2),ye=t(Ve),Oe=t(ye,!0);a(ye);var U=r(ye,2),he=t(U);a(U),a(Ve),a(ke),a(fe);var Ze=r(fe,2);ma(Ze,21,()=>e(be).sections,K=>K.name,(K,je)=>{var we=wl();we.__click=[bl,w,be,je];var na=t(we),ia=t(na,!0);a(na);var Aa=r(na,2);{var ha=Pe=>{var ca=yl(),va=t(ca),Ie=r(va);{var Ge=Me=>{var Z=hl(),J=t(Z);a(Z),g(()=>l(J,`+${e(je).subjects.length-2} more`)),i(Me,Z)};m(Ie,Me=>{e(je).subjects.length>2&&Me(Ge)})}a(ca),g(Me=>l(va,`${Me??""} `),[()=>e(je).subjects.slice(0,2).join(", ")]),i(Pe,ca)};m(Aa,Pe=>{e(je).subjects&&e(je).subjects.length>0&&Pe(ha)})}a(we),g(()=>{Da(we,"aria-label",`View class list for ${e(je).name??""}`),l(ia,e(je).name)}),i(K,we)}),a(Ze),a(_e),g(K=>{l(Oe,e(be).gradeName),l(he,`${e(be).sections.length??""} section${e(be).sections.length!==1?"s":""} • ${K??""} students`)},[()=>e(be).sections.reduce((K,je)=>K+je.students,0)]),i(qe,_e)}),a(X),i(ue,X)};m(B,ue=>{e(S).length===0?ue(de):ue(xe,!1)},!0)}i(C,R)};m(I,C=>{e(E)?C(re):C(M,!1)},!0)}i(G,H)};m(se,G=>{e(_)?G(pe):G(N,!1)})}a(T),a(V),i(z,V),It(),h()}js(["click"]);async function Al(z,d,u,h,b,y,S,_,E,w,$,P){if(!d.sectionId||!d.subjectId){ne.error("Missing section or subject information");return}s(u,!0),s(h,""),s(b,!1);try{const V=y().map(T=>({student_id:T.accountNumber||T.account_number||T.id,writtenWork:T.writtenWork,performanceTasks:T.performanceTasks,quarterlyAssessment:T.quarterlyAssessment})),D=await ps("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:S(),grading_config:_(),grades:V})});if(!D.ok){const T=await D.json().catch(()=>({}));throw new Error(T.error||`HTTP ${D.status}: ${D.statusText}`)}const L=await D.json();s(b,!0),ne.success("Grades saved successfully"),s(E,w(),!0),s($,!1),s(P,!0),setTimeout(()=>{s(h,"")},3e3)}catch(V){console.error("Error saving grades:",V),s(b,!1),s(h,V.message||"Failed to save grades",!0),ne.error(e(h)),setTimeout(()=>{s(h,"")},5e3)}finally{s(u,!1)}}async function Dl(z,d,u,h,b,y,S,_,E,w,$){if(console.log("saveFinalGrades function called"),!d.sectionId||!d.subjectId){console.log("Missing section or subject information:",{sectionId:d.sectionId,subjectId:d.subjectId}),ne.error("Missing section or subject information");return}console.log("Starting final grades submission process"),s(u,!0),s(h,""),s(b,!1);try{const P=y().filter(se=>!se.isVerified),V=y().length-P.length;if(console.log(`Total students: ${y().length}, Unverified: ${P.length}, Verified: ${V}`),P.length===0){ne.warning("All student grades have already been verified by the adviser. No grades to send."),s(u,!1);return}const D=P.map(se=>{const pe=S(se.writtenWork,_().writtenWork.totals,"writtenWork"),N=S(se.performanceTasks,_().performanceTasks.totals,"performanceTasks"),G=S(se.quarterlyAssessment,_().quarterlyAssessment.totals,"quarterlyAssessment"),H=E(se),I={student_id:se.accountNumber||se.account_number||se.id,written_work_average:pe!==""?parseFloat(pe):null,performance_tasks_average:N!==""?parseFloat(N):null,quarterly_assessment_average:G!==""?parseFloat(G):null,final_grade:H!==""?parseFloat(H):null,written_work_items:se.writtenWork||[],performance_tasks_items:se.performanceTasks||[],quarterly_assessment_items:se.quarterlyAssessment||[]};return console.log("Preparing student data for submission:",{student_name:se.name,student_id:I.student_id,final_grade:I.final_grade}),I});console.log("Final grades data to submit:",{count:D.length,section_id:d.sectionId,subject_id:d.subjectId,teacher_id:w().userData.id}),console.log("Making API call to submit final grades");const L=await ps("/api/grades",{method:"POST",body:JSON.stringify({action:"submit_final_grades",section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:$(),teacher_id:w().userData.id,final_grades:D})});if(console.log("API response status:",L.status),!L.ok){const se=await L.json().catch(()=>({}));throw console.error("API error response:",se),new Error(se.error||`HTTP ${L.status}: ${L.statusText}`)}const T=await L.json();console.log("API success response:",T),s(b,!0),V>0?ne.success(`Final grades sent to adviser for ${P.length} students. ${V} verified students were skipped.`):ne.success("Final grades have been sent to the adviser successfully!"),setTimeout(()=>{s(h,"")},3e3)}catch(P){console.error("Error saving final grades:",P),s(b,!1),s(h,P.message||"Failed to save final grades",!0),ne.error(e(h)),setTimeout(()=>{s(h,"")},5e3)}finally{s(u,!1)}}async function Tl(z,d,u,h,b,y,S,_,E,w){try{ne.info("Refreshing grades from database...");const $=d(),P=$.isAuthenticated?$.userData?.id:null,V=new URLSearchParams({sectionId:u.sectionId.toString(),subjectId:u.subjectId.toString(),gradingPeriodId:h().toString()});P&&V.append("teacherId",P.toString());const D=await ps(`/api/class-students?${V}`);if(!D.ok)throw new Error(`HTTP ${D.status}: ${D.statusText}`);const L=await D.json();if(L.success&&L.data?.students)b(L.data.students.map(T=>({...T,writtenWork:T.grades?.written_work||[],performanceTasks:T.grades?.performance_tasks||[],quarterlyAssessment:T.grades?.quarterly_assessment||[],grades:T.grades,id:T.account_number||T.id,name:T.full_name||`${T.first_name} ${T.last_name}`,isVerified:T.grades?.verification?.verified||!1}))),y(),s(S,!0),s(_,!1),s(E,w(),!0),ne.success("Grades refreshed successfully");else throw new Error(L.error||"Failed to refresh grades")}catch($){console.error("Error refreshing grades:",$),ne.error("Failed to refresh grades. Please try again.")}}var Nl=o('<span class="material-symbols-outlined spinning">sync</span> <span>Saving...</span>',1),jl=o('<span class="material-symbols-outlined">check_circle</span> <span>Grades Saved</span>',1),$l=o('<span class="material-symbols-outlined">save</span> <span>Save Grades</span>',1),Cl=o('<span class="material-symbols-outlined spinning">sync</span> <span>Uploading...</span>',1),ql=o('<span class="material-symbols-outlined">upload</span> <span>Send to Adviser</span>',1),El=o('<div class="spreadsheet-loading-overlay"><div class="spreadsheet-loader"><div class="loader-spinner"></div> <p>Loading grading spreadsheet...</p></div></div>'),Fl=o('<div class="header-overlay"><span class="header-icon material-symbols-outlined">settings</span></div>'),Ll=o('<th><span class="header-text"> </span> <!></th>'),Pl=o('<input type="text" class="cell-input"/>'),Il=o('<span class="cell-content verified-cell"> </span>'),Gl=o('<span class="cell-content"> </span>'),Ml=o("<td><!></td>"),Rl=o("<tr></tr>"),Ol=o('<div class="spreadsheet-container"><table class="spreadsheet-table"><thead><tr></tr></thead><tbody></tbody></table></div>'),Vl=o('<div class="save-section"><div class="refresh-button-container"><button class="refresh-grades-button" title="Refresh grades from database"><span class="material-symbols-outlined">refresh</span> <span>Refresh</span></button></div> <div class="save-button-container"><button><!></button> <button class="final-grades-button" title="Upload final grades (averages and computed final grades) to database"><!></button></div></div> <div class="grading-spreadsheet"><!></div>',1);function Ul(z,d){Pt(d,!0);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=xt(d,"students",23,()=>[]),S=xt(d,"gradingPeriodId",3,1),_=xt(d,"gradingConfig",23,()=>({writtenWork:{count:3,weight:.3,totals:[]},performanceTasks:{count:3,weight:.5,totals:[]},quarterlyAssessment:{count:1,weight:.2,totals:[]}})),E=Na(!1),w=Na(!1),$=Na(""),P=Na(!1),V=null,D=null,L=Na(!1),T=Na(!0),se=Na(null),pe,N=Na(null),G=Na(!1),H=Na(""),I=Na(!0),re=Na(!1),M=Na(Es(new Set)),C=Na(Es([]));Es([]);function R(f){if(f==null||f==="")return"0";const k=parseFloat(f);return isNaN(k)?f:(k%1===0,k.toString())}function B(){return JSON.parse(JSON.stringify(y().map(f=>({id:f.id,writtenWork:Array.isArray(f.writtenWork)?[...f.writtenWork]:[],performanceTasks:Array.isArray(f.performanceTasks)?[...f.performanceTasks]:[],quarterlyAssessment:Array.isArray(f.quarterlyAssessment)?[...f.quarterlyAssessment]:[]}))))}function de(){if(!e(se))return!1;const f=B(),k=JSON.stringify(f)!==JSON.stringify(e(se));return s(L,k),s(T,!k),k}function xe(){const f=["Student ID","Student Name"];for(let k=1;k<=_().writtenWork.count;k++)f.push(he("writtenWork",k-1));f.push("WW Avg");for(let k=1;k<=_().performanceTasks.count;k++)f.push(he("performanceTasks",k-1));f.push("PT Avg");for(let k=1;k<=_().quarterlyAssessment.count;k++)f.push(he("quarterlyAssessment",k-1));f.push("QA Avg"),f.push("Final Grade"),s(C,[f],!0),y().forEach(k=>{if(!k||!k.id||!k.name){console.warn("Invalid student data:",k);return}const oe=[k.id,k.name],Te=k.writtenWork||[];for(let Ae=0;Ae<_().writtenWork.count;Ae++)oe.push(R(Te[Ae]));oe.push(ue(Te,_().writtenWork.totals,"writtenWork"));const Ue=k.performanceTasks||[];for(let Ae=0;Ae<_().performanceTasks.count;Ae++)oe.push(R(Ue[Ae]));oe.push(ue(Ue,_().performanceTasks.totals,"performanceTasks"));const F=k.quarterlyAssessment||[];for(let Ae=0;Ae<_().quarterlyAssessment.count;Ae++)oe.push(R(F[Ae]));oe.push(ue(F,_().quarterlyAssessment.totals,"quarterlyAssessment")),oe.push(X(k)),e(C).push(oe)}),s(se,B(),!0),s(T,!1),s(L,!1),s(I,!1)}function ue(f,k=null,oe=null){if(!f||!Array.isArray(f))return"";const Te=f.filter(F=>F!=null&&F!=="");if(Te.length===0)return"";console.log(`calculateAverage for ${oe}:`,{originalScores:f,validScores:Te,totals:k});let Ue=0;if(k&&k.length>0){let F=0,Ae=0;const Qe=Math.min(f.length,k.length);for(let Xe=0;Xe<Qe;Xe++){const $a=f[Xe];if($a!=null&&$a!==""){const xa=parseFloat($a),ie=k[Xe];if(ie&&ie>0){const x=xa/ie*100;F+=x,Ae++,console.log(`Score ${Xe}: ${xa}/${ie} = ${x}%`)}}}if(console.log(`Total percentage sum: ${F}, count: ${Ae}`),Ae===0)return"";const We=Math.round(F/Ae*100)/100;return console.log(`Final average: ${We}`),R(We)}else{Ue=Te.reduce((Ae,Qe)=>Ae+parseFloat(Qe),0);const F=Math.round(Ue/Te.length*100)/100;return R(F)}}function X(f){if(!f)return"";const k=ue(f.writtenWork,_().writtenWork.totals,"writtenWork"),oe=ue(f.performanceTasks,_().performanceTasks.totals,"performanceTasks"),Te=ue(f.quarterlyAssessment,_().quarterlyAssessment.totals,"quarterlyAssessment");if(k===""||oe===""||Te==="")return"";const Ue=parseFloat(k)||0,F=parseFloat(oe)||0,Ae=parseFloat(Te)||0,Qe=Ue*_().writtenWork.weight+F*_().performanceTasks.weight+Ae*_().quarterlyAssessment.weight,We=Math.round(Qe*100)/100;return R(We)}function qe(f,k,oe){if(k<2)return;const Te=f-1,Ue=y()[Te];if(console.log("Cell clicked:",{rowIndex:f,colIndex:k,studentIndex:Te,student:Ue?.name,isVerified:Ue?.isVerified}),Ue&&Ue.isVerified){ne.warning("This student's grades have been verified by the adviser and cannot be edited.");return}s(N,{row:f,col:k},!0),s(G,!1)}function be(f){if(!e(N)||e(G))return;const{row:k,col:oe}=e(N);if(f.key==="ArrowUp"||f.key==="ArrowDown"||f.key==="ArrowLeft"||f.key==="ArrowRight"){f.preventDefault(),_e(f.key);return}if(f.key==="Enter"){f.preventDefault(),_e("ArrowDown");return}if(f.key==="Tab"){f.preventDefault(),_e(f.shiftKey?"ArrowLeft":"ArrowRight");return}if(/^[0-9.]$/.test(f.key)&&!ke(oe)&&oe>1){const Te=k-1,Ue=y()[Te];if(console.log("Typing detected:",{key:f.key,row:k,col:oe,studentIndex:Te,student:Ue?.name,isVerified:Ue?.isVerified}),Ue&&Ue.isVerified){ne.warning("This student's grades have been verified by the adviser and cannot be edited.");return}f.preventDefault(),s(G,!0),s(H,f.key,!0),s(re,!1)}else if(f.key.length===1&&!ke(oe)&&oe>1){const Te=k-1,Ue=y()[Te];if(console.log("Other key detected:",{key:f.key,row:k,col:oe,studentIndex:Te,student:Ue?.name,isVerified:Ue?.isVerified}),Ue&&Ue.isVerified){ne.warning("This student's grades have been verified by the adviser and cannot be edited.");return}f.preventDefault(),s(G,!0),s(H,f.key,!0),s(re,!1)}}function _e(f){if(!e(N)||!e(C).length)return;const{row:k,col:oe}=e(N),Te=e(C).length-1,Ue=e(C)[0].length-1;let F=k,Ae=oe;switch(f){case"ArrowUp":F=Math.max(1,k-1);break;case"ArrowDown":F=Math.min(Te,k+1);break;case"ArrowLeft":Ae=Math.max(0,oe-1);break;case"ArrowRight":Ae=Math.min(Ue,oe+1);break}s(N,{row:F,col:Ae},!0),fe(F,Ae)}function fe(f,k){if(!pe)return;const oe=pe.querySelector(`tbody tr:nth-child(${f}) td:nth-child(${k+1})`);oe&&oe.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}function ke(f){const oe=e(C)[0][f];return oe?.includes("Avg")||oe==="Final Grade"}function Ve(f){return U(f)!==null}function ye(f){const oe=e(C)[0][f];return f<2?"student-info":oe==="Final Grade"||oe?.includes("Avg")?"calculated":oe?.startsWith("WW")?"written-work":oe?.startsWith("PT")?"performance-task":oe?.startsWith("QA")?"quarterly-assessment":"default"}function Oe(f,k){k.preventDefault(),k.stopPropagation(),Ve(f)&&ia(f)}function U(f){let k=2;for(let oe=0;oe<_().writtenWork.count;oe++){if(k===f)return{assessmentType:"writtenWork",columnIndex:oe};k++}k++;for(let oe=0;oe<_().performanceTasks.count;oe++){if(k===f)return{assessmentType:"performanceTasks",columnIndex:oe};k++}k++;for(let oe=0;oe<_().quarterlyAssessment.count;oe++){if(k===f)return{assessmentType:"quarterlyAssessment",columnIndex:oe};k++}return null}function he(f,k){const oe=Ze(f,k),Te=_()[f].totals[k]||100;return`${oe} - ${Te}`}function Ze(f,k){if(_()[f].columnNames&&_()[f].columnNames[k])return _()[f].columnNames[k];const oe=f==="writtenWork"?"WW":f==="performanceTasks"?"PT":"QA";return _()[f].columnPositions&&_()[f].columnPositions[k]!==void 0?`${oe}${_()[f].columnPositions[k]}`:`${oe}${k+1}`}function K(){if(!e(N)||e(N).row===0)return;const{row:f,col:k}=e(N),oe=f-1,Te=y()[oe];if(!Te)return;const Ue=U(k);if(!Ue)return;const{assessmentType:F,columnIndex:Ae}=Ue;let Qe=e(H).trim(),We=null,Xe=!0,$a="";if(Qe!==""){if(We=parseFloat(Qe),isNaN(We)||We<0)We=0,Xe=!1,$a=isNaN(parseFloat(Qe))?"Invalid input. Only numbers are allowed.":"Negative scores are not allowed.";else{const xa=_()[F].totals?.[Ae];xa&&We>xa&&(We=0,Xe=!1,$a=`Score cannot exceed the total score of ${xa}.`)}Xe?e(M).delete(`${f}-${k}`):(ne.error($a),e(M).add(`${f}-${k}`),setTimeout(()=>{e(M).delete(`${f}-${k}`),s(M,new Set(e(M)),!0)},3e3))}else We=null,e(M).delete(`${f}-${k}`);Te[F][Ae]=We,y([...y()]),xe(),de(),na()}function je(f,k,oe){if(e(N)&&e(G)){if(f.key==="Enter"){f.preventDefault();const Te=e(N).row,Ue=e(N).col;K(),s(G,!1),setTimeout(()=>{s(N,{row:Te,col:Ue},!0),_e("ArrowDown")},0);return}if(f.key==="Tab"){f.preventDefault();const Te=e(N).row,Ue=e(N).col;K(),s(G,!1),setTimeout(()=>{s(N,{row:Te,col:Ue},!0),_e(f.shiftKey?"ArrowLeft":"ArrowRight")},0);return}if(f.key==="ArrowUp"||f.key==="ArrowDown"||f.key==="ArrowLeft"||f.key==="ArrowRight"){f.preventDefault();const Te=e(N).row,Ue=e(N).col;K(),s(G,!1),setTimeout(()=>{s(N,{row:Te,col:Ue},!0),_e(f.key)},0);return}if(f.key==="Escape"){f.preventDefault(),s(G,!1),s(H,"");return}}}Wt(()=>{xe()});async function we(){if(!(e(E)||!y().length||!d.sectionId||!d.subjectId))try{const f=y().map(k=>({student_id:k.account_number||k.accountNumber||k.id,writtenWork:k.writtenWork,performanceTasks:k.performanceTasks,quarterlyAssessment:k.quarterlyAssessment}));await ps("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:d.sectionId,subject_id:d.subjectId,grading_period_id:S(),grading_config:_(),grades:f})})}catch(f){console.error("Auto-save failed:",f.message)}}function na(){D&&clearTimeout(D),D=setTimeout(()=>{we()},3e3)}Ws(()=>{const f=y().length,k=_(),oe=d.subjectId;n(()=>{(f>0||k||oe)&&xe()})}),Ws(()=>(V=setInterval(we,3e4),()=>{V&&clearInterval(V),D&&clearTimeout(D)}));function ia(f){const k=U(f);if(!k){ne.error("Cannot edit this column");return}const{assessmentType:oe,columnIndex:Te}=k,Ue=Ze(oe,Te),F=_()[oe].totals[Te]||100,Ae=_()[oe].gradeItemIds?.[Te];if(!Ae){ne.error("Cannot edit column: Grade item ID not found");return}es.form("Edit Column","Edit the column name and total score for this assessment:",{label:"Column Name",type:"text",placeholder:"Enter column name",value:Ue},{label:"Total Score",type:"number",placeholder:"Enter total score",value:F,min:1,max:1e3},async(Qe,We)=>{if(!Qe||!Qe.trim()){ne.error("Column name cannot be empty");return}const Xe=parseInt(We);if(isNaN(Xe)||Xe<1||Xe>1e3){ne.error("Total score must be between 1 and 1000");return}try{const $a=await ps("/api/grades/grade-items",{method:"PUT",body:JSON.stringify({grade_item_id:Ae,name:Qe.trim(),total_score:Xe})});_()[oe].columnNames||(_()[oe].columnNames=[]),_()[oe].columnNames[Te]=Qe.trim(),_()[oe].totals[Te]=Xe,_({..._()}),xe(),ne.success("Column updated successfully")}catch($a){console.error("Error updating column:",$a),ne.error("Failed to update column. Please try again.")}},()=>{},async()=>{try{const Qe=await ps("/api/grades/grade-items",{method:"DELETE",body:JSON.stringify({grade_item_id:Ae})});_()[oe].count-=1,_()[oe].columnNames&&_()[oe].columnNames.splice(Te,1),_()[oe].totals&&_()[oe].totals.splice(Te,1),_()[oe].columnPositions&&_()[oe].columnPositions.splice(Te,1),_()[oe].gradeItemIds&&_()[oe].gradeItemIds.splice(Te,1),_({..._()}),y(y().map(We=>{const Xe={...We};return oe==="writtenWork"&&Xe.writtenWork?Xe.writtenWork.splice(Te,1):oe==="performanceTasks"&&Xe.performanceTasks?Xe.performanceTasks.splice(Te,1):oe==="quarterlyAssessment"&&Xe.quarterlyAssessment&&Xe.quarterlyAssessment.splice(Te,1),Xe})),xe(),ne.success("Column deleted successfully")}catch(Qe){console.error("Error deleting column:",Qe),ne.error("Failed to delete column. Please try again.")}},{size:"small"})}var Aa=Vl();q("keydown",Fs,be);var ha=da(Aa),Pe=t(ha),ca=t(Pe);ca.__click=[Tl,b,d,S,y,xe,T,L,se,B],a(Pe);var va=r(Pe,2),Ie=t(va);let Ge;Ie.__click=[Al,d,E,$,P,y,S,_,se,B,L,T];var Me=t(Ie);{var Z=f=>{var k=Nl();Xa(2),i(f,k)},J=f=>{var k=Ta(),oe=da(k);{var Te=F=>{var Ae=jl();Xa(2),i(F,Ae)},Ue=F=>{var Ae=$l();Xa(2),i(F,Ae)};m(oe,F=>{e(T)&&!e(L)?F(Te):F(Ue,!1)},!0)}i(f,k)};m(Me,f=>{e(E)?f(Z):f(J,!1)})}a(Ie);var c=r(Ie,2);c.__click=[Dl,d,w,$,P,y,ue,_,X,b,S];var v=t(c);{var A=f=>{var k=Cl();Xa(2),i(f,k)},ee=f=>{var k=ql();Xa(2),i(f,k)};m(v,f=>{e(w)?f(A):f(ee,!1)})}a(c),a(va),a(ha);var Ce=r(ha,2),me=t(Ce);{var te=f=>{var k=El();i(f,k)},Ke=f=>{var k=Ol(),oe=t(k),Te=t(oe),Ue=t(Te);ma(Ue,21,()=>e(C)[0]||[],Xt,(Ae,Qe,We)=>{var Xe=Ll();let $a;Xe.__click=Le=>Oe(We,Le);var xa=t(Xe),ie=t(xa,!0);a(xa);var x=r(xa,2);{var le=Le=>{var pa=Fl();i(Le,pa)};m(x,Le=>{Ve(We)&&Le(le)})}a(Xe),g((Le,pa)=>{$a=W(Xe,1,"spreadsheet-header",null,$a,Le),Da(Xe,"title",pa),l(ie,e(Qe))},[()=>({"student-info":We<2,calculated:ke(We),"final-grade":ye(We)==="final-grade",clickable:Ve(We)}),()=>Ve(We)?"Click to set total scores":""]),i(Ae,Xe)}),a(Ue),a(Te);var F=r(Te);ma(F,21,()=>e(C).slice(1),Xt,(Ae,Qe,We)=>{var Xe=Rl();let $a;ma(Xe,21,()=>e(Qe),Xt,(xa,ie,x)=>{var le=Ml();let Le;le.__click=la=>qe(We+1,x);var pa=t(le);{var He=la=>{var Ee=Pl();Ba(Ee),Ee.__keydown=O=>je(O),ii(Ee),q("blur",Ee,()=>{K(),s(G,!1)}),Za(Ee,()=>e(H),O=>s(H,O)),i(la,Ee)},sa=la=>{var Ee=Ta(),O=da(Ee);{var Fe=qa=>{var Ia=Il(),st=t(Ia,!0);a(Ia),g(()=>l(st,e(ie))),i(qa,Ia)},ea=qa=>{var Ia=Gl(),st=t(Ia,!0);a(Ia),g(()=>l(st,e(ie))),i(qa,Ia)};m(O,qa=>{e(G)&&e(N)?.row===We+1&&e(N)?.col===x&&y()[We]?.isVerified?qa(Fe):qa(ea,!1)},!0)}i(la,Ee)};m(pa,la=>{e(G)&&e(N)?.row===We+1&&e(N)?.col===x&&!y()[We]?.isVerified?la(He):la(sa,!1)})}a(le),g(la=>Le=W(le,1,"spreadsheet-cell",null,Le,la),[()=>({selected:e(N)?.row===We+1&&e(N)?.col===x,editing:e(G)&&e(N)?.row===We+1&&e(N)?.col===x,"student-info":x<2,calculated:ke(x),"final-grade":ye(x)==="final-grade",editable:!ke(x)&&x>1,invalid:e(M).has(`${We+1}-${x}`)})]),i(xa,le)}),a(Xe),g(xa=>$a=W(Xe,1,"spreadsheet-row",null,$a,xa),[()=>({verified:y()[We]?.isVerified})]),i(Ae,Xe)}),a(F),a(oe),a(k),hr(k,Ae=>pe=Ae,()=>pe),i(f,k)};m(me,f=>{e(I)?f(te):f(Ke,!1)})}a(Ce),hr(Ce,f=>pe=f,()=>pe),g(f=>{Ge=W(Ie,1,"save-grades-button",null,Ge,f),Ie.disabled=e(E)||e(T)&&!e(L),Da(Ie,"title",e(T)&&!e(L)?"All grades are saved":"Save all grades to database"),c.disabled=e(w)},[()=>({saved:e(T)&&!e(L)})]),i(z,Aa),It(),h()}js(["click","keydown"]);var Wl=(z,d)=>d.onBackToClassManagement&&d.onBackToClassManagement(),Yl=o('<button><span class="material-symbols-outlined">book</span> </button>'),Hl=o('<div class="subject-tab-navigation"></div>'),Jl=(z,d)=>d("writtenWork"),Bl=(z,d)=>d("performanceTasks"),Ql=(z,d)=>d("quarterlyAssessment"),zl=o('<div class="loading-container"><div class="system-loader"></div> <p>Loading class data...</p></div>'),Kl=o('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Zl=o(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Students Found</h3> <p>This section doesn't have any enrolled students yet.</p></div>`),Xl=o('<div class="class-management-container"><div class="classlist-page-header"><div class="header-content"><div class="header-navigation"><button class="back-button"><span class="material-symbols-outlined">arrow_back</span> <span>Back to Class Management</span></button></div> <h1 class="classlist-page-title">Class Grading Sheet</h1> <p class="classlist-page-subtitle"> </p></div> <!></div> <div class="grading-config-section"><h2 class="config-title">Grading Configuration</h2> <div class="config-grid"><div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button" title="Add Column"><span class="material-symbols-outlined">add</span></button></div></div></div></div> <!></div></div> <!>',1);function ed(z,d){Pt(d,!0);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);let y=Na(!0),S=Na(null),_=Na(!1),E=Na(!1),w=Na(null),$=null,P=Na(0),V=Ut(()=>e(w)?.subjects?.[e(P)]||null);function D(x){s(P,x,!0),s(H,{writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}},!0),se(),N()}let L=Ut(()=>e(w)?{yearLevel:e(w).section.gradeLevel,sectionName:e(w).section.name,gradeName:`Grade ${e(w).section.gradeLevel}`,subject:e(V)?.name||"No Subject",section:`Grade ${e(w).section.gradeLevel} - ${e(w).section.name}`,quarter:"1st Quarter",totalStudents:e(w).totalStudents,adviser:e(w).section.adviser,room:e(w).section.room}:d.selectedClass?{yearLevel:d.selectedClass.yearLevel,sectionName:d.selectedClass.sectionName,gradeName:`Grade ${d.selectedClass.yearLevel}`,subject:"Loading...",section:`Grade ${d.selectedClass.yearLevel} - ${d.selectedClass.sectionName}`,quarter:"1st Quarter",totalStudents:0}:{yearLevel:7,sectionName:"Section A",gradeName:"Grade 7",subject:"Mathematics",section:"Grade 7 - Section A",quarter:"1st Quarter",totalStudents:0}),T=Na(Es([]));async function se(){if(!(!d.selectedClass||!e(V)))try{const x=await fetch(`/api/grades/grade-items?section_id=${d.selectedClass.sectionId}&subject_id=${e(V).id}&grading_period_id=1&teacher_id=${b().userData.id}`,{method:"GET",headers:{"Content-Type":"application/json","x-user-id":b().userData.id.toString(),"x-user-account-number":b().userData.accountNumber||"","x-user-name":encodeURIComponent(b().userData.name||"")}});if(!x.ok)throw new Error(`HTTP error! status: ${x.status}`);const Le=(await x.json()).data||{},pa={writtenWork:{count:Le.writtenWork?.length||0,weight:.3,label:"Written Work",totals:Le.writtenWork?.map(He=>He.totalScore)||[],columnNames:Le.writtenWork?.map(He=>He.name)||[],columnPositions:Le.writtenWork?.map((He,sa)=>sa+1)||[],gradeItemIds:Le.writtenWork?.map(He=>He.id)||[]},performanceTasks:{count:Le.performanceTasks?.length||0,weight:.5,label:"Performance Tasks",totals:Le.performanceTasks?.map(He=>He.totalScore)||[],columnNames:Le.performanceTasks?.map(He=>He.name)||[],columnPositions:Le.performanceTasks?.map((He,sa)=>sa+1)||[],gradeItemIds:Le.performanceTasks?.map(He=>He.id)||[]},quarterlyAssessment:{count:Le.quarterlyAssessment?.length||0,weight:.2,label:"Quarterly Assessment",totals:Le.quarterlyAssessment?.map(He=>He.totalScore)||[],columnNames:Le.quarterlyAssessment?.map(He=>He.name)||[],columnPositions:Le.quarterlyAssessment?.map((He,sa)=>sa+1)||[],gradeItemIds:Le.quarterlyAssessment?.map(He=>He.id)||[]}};s(H,pa,!0)}catch(x){console.error("Error fetching grading configuration:",x),de("Failed to load grading configuration","error")}}async function pe(){if(!e(_))try{if(s(y,!0),s(S,null),!d.selectedClass?.sectionId)throw new Error("No section selected");const x=b(),le=x.isAuthenticated?x.userData?.id:null,Le=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString(),schoolYear:"2024-2025"});le&&Le.append("teacherId",le.toString());const He=await(await fetch(`/api/class-students?${Le}`)).json();if(!He.success)throw new Error(He.error||"Failed to fetch section data");s(w,He.data,!0)}catch(x){console.error("Error fetching section data:",x),s(S,x.message,!0)}finally{s(y,!1)}}async function N(){if(!e(_))try{if(s(y,!0),s(S,null),!d.selectedClass?.sectionId)throw new Error("No section selected");const x=b(),le=x.isAuthenticated?x.userData?.id:null,Le=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString(),schoolYear:"2024-2025"});le&&Le.append("teacherId",le.toString()),e(V)?.id&&Le.append("subjectId",e(V).id.toString());const He=await(await fetch(`/api/class-students?${Le}`)).json();if(!He.success)throw new Error(He.error||"Failed to fetch class students");s(w,He.data,!0),s(T,He.data.students.map(sa=>({...sa,writtenWork:sa.grades?.written_work||[],performanceTasks:sa.grades?.performance_tasks||[],quarterlyAssessment:sa.grades?.quarterly_assessment||[],grades:sa.grades,id:sa.account_number||sa.id,name:sa.full_name||`${sa.first_name} ${sa.last_name}`,isVerified:sa.grades?.verification?.verified||!1})),!0)}catch(x){console.error("Error fetching class students:",x),s(S,x.message,!0),s(w,null),s(T,[],!0)}finally{s(y,!1)}}async function G(){if(!(e(_)||!d.selectedClass?.sectionId||!e(V)?.id))try{const x=b(),le=x.isAuthenticated?x.userData?.id:null,Le=new URLSearchParams({sectionId:d.selectedClass.sectionId.toString(),schoolYear:"2024-2025",verificationOnly:"true"});le&&Le.append("teacherId",le.toString()),e(V)?.id&&Le.append("subjectId",e(V).id.toString());const He=await(await fetch(`/api/class-students?${Le}`)).json();if(He.success&&He.data?.students){const sa=e(T).map(Ee=>{const O=He.data.students.find(Fe=>Fe.id===Ee.id);return O?{...Ee,isVerified:O.isVerified}:Ee});sa.some((Ee,O)=>Ee.isVerified!==e(T)[O]?.isVerified)&&s(T,sa,!0)}}catch(x){console.error("Error checking verification status:",x)}}let H=Na(Es({writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}})),I=Na(""),re=Na("error"),M=Na(!1);function C(x){}async function R(x){if(e(H)[x].count<10&&!e(E)&&!e(_))try{if(s(E,!0),!{writtenWork:1,performanceTasks:2,quarterlyAssessment:3}[x]){console.error("Invalid category:",x);return}if(!b().isAuthenticated||!b().userData?.id){console.error("User not authenticated");return}const pa={writtenWork:"WW",performanceTasks:"PT",quarterlyAssessment:"QA"},He=e(H)[x].count,sa=`${pa[x]} ${He+1}`,la=await fetch("/api/grades/grade-items",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":b().userData.id.toString(),"x-user-account-number":b().userData.accountNumber||"","x-user-name":encodeURIComponent(b().userData.name||"")},body:JSON.stringify({action:"create_grade_item",section_id:d.selectedClass?.sectionId||e(w)?.section?.id,subject_id:e(V)?.id||d.selectedClass?.subjectId||e(w)?.subjects?.[0]?.id,grading_period_id:1,teacher_id:b().userData.id,category:x,name:sa,total_score:100})});if(!la.ok){const ea=await la.json();console.error("Failed to add grade item:",ea.error);return}const Ee=await la.json();if(e(H)[x].count+=1,e(H)[x].gradeItemIds||(e(H)[x].gradeItemIds=[]),e(H)[x].gradeItemIds.push(Ee.data.id),e(H)[x].columnNames||(e(H)[x].columnNames=[]),e(H)[x].columnNames.push(Ee.data.name),!e(H)[x].columnPositions){e(H)[x].columnPositions=[];for(let ea=0;ea<e(H)[x].count-1;ea++)e(H)[x].columnPositions[ea]=ea+1}const O=e(H)[x].columnPositions||[];let Fe=1;for(;O.includes(Fe);)Fe++;e(H)[x].columnPositions.push(Fe),B()}catch(le){console.error("Error adding column:",le)}finally{s(E,!1)}}function B(){s(T,e(T).map(x=>x&&{...x,writtenWork:Array(e(H).writtenWork.count).fill(0).map((Le,pa)=>x.writtenWork?.[pa]||0),performanceTasks:Array(e(H).performanceTasks.count).fill(0).map((Le,pa)=>x.performanceTasks?.[pa]||0),quarterlyAssessment:Array(e(H).quarterlyAssessment.count).fill(0).map((Le,pa)=>x.quarterlyAssessment?.[pa]||0)}),!0)}function de(x,le="error"){s(M,!1),setTimeout(()=>{s(I,x,!0),s(re,le,!0),s(M,!0)},50)}Wt(async()=>{e(_)||(await pe(),await N(),await se(),$=setInterval(()=>{G()},3e4))}),ni(()=>{s(_,!0),s(y,!1),$&&(clearInterval($),$=null)});var xe=Xl();q("click",Fs,C);var ue=da(xe),X=t(ue),qe=t(X),be=t(qe),_e=t(be);_e.__click=[Wl,d],a(be);var fe=r(be,4),ke=t(fe);a(fe),a(qe);var Ve=r(qe,2);{var ye=x=>{var le=Hl();ma(le,21,()=>e(w).subjects,Xt,(Le,pa,He)=>{var sa=Yl();let la;sa.__click=()=>D(He);var Ee=r(t(sa));a(sa),g(O=>{la=W(sa,1,"subject-tab-button",null,la,O),l(Ee,` ${e(pa).name??""}`)},[()=>({active:e(P)===He})]),i(Le,sa)}),a(le),i(x,le)};m(Ve,x=>{e(w)?.subjects&&e(w).subjects.length>1&&x(ye)})}a(X);var Oe=r(X,2),U=r(t(Oe),2),he=t(U),Ze=t(he),K=t(Ze);a(Ze);var je=r(Ze,2),we=t(je),na=t(we),ia=t(na);{var Aa=x=>{var le=kt("Loading...");i(x,le)},ha=x=>{var le=kt();g(()=>l(le,`${e(H).writtenWork.count??""} Column${e(H).writtenWork.count!==1?"s":""}`)),i(x,le)};m(ia,x=>{e(y)?x(Aa):x(ha,!1)})}a(na),a(we);var Pe=r(we,2),ca=t(Pe);ca.__click=[Jl,R],a(Pe),a(je),a(he);var va=r(he,2),Ie=t(va),Ge=t(Ie);a(Ie);var Me=r(Ie,2),Z=t(Me),J=t(Z),c=t(J);{var v=x=>{var le=kt("Loading...");i(x,le)},A=x=>{var le=kt();g(()=>l(le,`${e(H).performanceTasks.count??""} Column${e(H).performanceTasks.count!==1?"s":""}`)),i(x,le)};m(c,x=>{e(y)?x(v):x(A,!1)})}a(J),a(Z);var ee=r(Z,2),Ce=t(ee);Ce.__click=[Bl,R],a(ee),a(Me),a(va);var me=r(va,2),te=t(me),Ke=t(te);a(te);var f=r(te,2),k=t(f),oe=t(k),Te=t(oe);{var Ue=x=>{var le=kt("Loading...");i(x,le)},F=x=>{var le=kt();g(()=>l(le,`${e(H).quarterlyAssessment.count??""} Column${e(H).quarterlyAssessment.count!==1?"s":""}`)),i(x,le)};m(Te,x=>{e(y)?x(Ue):x(F,!1)})}a(oe),a(k);var Ae=r(k,2),Qe=t(Ae);Qe.__click=[Ql,R],a(Ae),a(f),a(me),a(U);var We=r(U,2);{var Xe=x=>{var le=zl();i(x,le)},$a=x=>{var le=Ta(),Le=da(le);{var pa=sa=>{var la=Kl(),Ee=r(t(la),2),O=t(Ee);a(Ee);var Fe=r(Ee,2);Fe.__click=N,a(la),g(()=>l(O,`Error: ${e(S)??""}`)),i(sa,la)},He=sa=>{var la=Ta(),Ee=da(la);{var O=ea=>{var qa=Zl();i(ea,qa)},Fe=ea=>{{let qa=Ut(()=>d.selectedClass?.sectionId),Ia=Ut(()=>e(V)?.id);Ul(ea,{get sectionId(){return e(qa)},get subjectId(){return e(Ia)},gradingPeriodId:1,get students(){return e(T)},set students(st){s(T,st,!0)},get gradingConfig(){return e(H)},set gradingConfig(st){s(H,st,!0)}})}};m(Ee,ea=>{e(T).length===0?ea(O):ea(Fe,!1)},!0)}i(sa,la)};m(Le,sa=>{e(S)?sa(pa):sa(He,!1)},!0)}i(x,le)};m(We,x=>{e(y)?x(Xe):x($a,!1)})}a(Oe),a(ue);var xa=r(ue,2);{var ie=x=>{mi(x,{get message(){return e(I)},get type(){return e(re)},onClose:()=>s(M,!1)})};m(xa,x=>{e(M)&&x(ie)})}g((x,le,Le)=>{l(ke,`${e(L).section??""} • ${e(L).subject??""} • ${e(L).quarter??""}`),l(K,`Written Work (${x??""}%)`),ca.disabled=e(H).writtenWork.count>=10||e(E),l(Ge,`Performance Tasks (${le??""}%)`),Ce.disabled=e(H).performanceTasks.count>=10||e(E),l(Ke,`Quarterly Assessment (${Le??""}%)`),Qe.disabled=e(H).quarterlyAssessment.count>=10||e(E)},[()=>Math.round(e(H).writtenWork.weight*100),()=>Math.round(e(H).performanceTasks.weight*100),()=>Math.round(e(H).quarterlyAssessment.weight*100)]),i(z,xe),It(),h()}js(["click"]);var ad=o('<div class="advisory-stat-card"><div class="advisory-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="advisory-stat-value"><!> <!></div> <div class="advisory-stat-label"> </div></div></div>'),td=o('<div class="students-loading"><div class="dashboard-loader"></div> <p>Loading students and grades...</p></div>'),sd=o('<div class="students-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),rd=o('<div class="students-empty"><span class="material-symbols-outlined">school</span> <p>No students found in this advisory class</p></div>'),id=o('<div class="loading-spinner"></div> <div class="overlay-text">Processing...</div>',1),nd=o('<span class="material-symbols-outlined">verified</span> <div class="overlay-text">Verify</div>',1),od=o('<small class="submitted-date"> </small>'),ld=o('<small class="submitted-date not-submitted">Grades not submitted yet</small>'),dd=o('<div class="grade-score-display"> </div>'),cd=o('<div class="grade-score-display" style="color: #666;">N/A</div>'),vd=o('<button><div class="grade-overlay"><div class="overlay-content"><!></div></div> <div class="grade-item-header"><div class="grade-info"><div class="subject-name"> </div> <div class="subject-teacher"> </div> <!></div> <div class="grade-controls"><!></div></div></button>'),ud=o('<div class="student-grades"><div class="grades-header"><h4 class="grades-title">Subject Grades (1st Quarter)</h4> <div class="student-verification-controls"><button class="verify-btn"><span class="material-symbols-outlined">verified</span> Verify All</button></div></div> <div class="grades-grid"></div></div>'),md=o('<div><div class="student-header"><div class="student-header-content"><div class="student-title-section"><h3 class="student-title"> </h3></div> <div class="student-info-row"><div class="student-info-item"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined">assignment</span> <span> </span></div></div></div> <div class="student-average"><div class="average-score"> </div></div> <div class="expand-icon"><span class="material-symbols-outlined"> </span></div></div> <!></div>'),pd=o('<div class="advisory-class-container"><div class="advisory-page-header"><div class="header-content"><h1 class="advisory-page-title">Advisory Class Dashboard</h1> <div class="advisory-class-info"><div class="class-detail"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">meeting_room</span> <span> </span></div></div> <div class="verification-info"><span class="material-symbols-outlined">info</span> <div class="verification-text"><span>Use verification controls to approve grades for student portal visibility</span></div></div></div></div> <div class="advisory-stats-section"><div class="advisory-stats-grid"></div></div> <div class="students-section"><div class="section-header"><button class="refresh-btn"><span class="material-symbols-outlined">refresh</span> Refresh</button> <div class="bulk-controls"><button class="verify-all-btn"><span class="material-symbols-outlined">verified</span> Verify All Grades</button></div></div> <div class="advisory-students-grid"><!></div></div></div>');function fd(z,d){Pt(d,!0);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u);function y(K){if(!K)return null;const je=new Date(K),we=String(je.getMonth()+1).padStart(2,"0"),na=String(je.getDate()).padStart(2,"0"),ia=je.getFullYear();return`${we}-${na}-${ia}`}let S=Na(!0),_=Na(null),E=Na(Es({averageGrade:null})),w=Na(Es([])),$="2024-2025",P=Na(Es(new Set));async function V(){try{s(S,!0),s(_,null);const K=await Qa.get(`/api/teacher-advisory?teacher_id=${b().userData.id}&school_year=${$}&quarter=1`);K.success?(s(E,{...e(E),...K.data.advisoryData},!0),K.data.students&&s(w,K.data.students.map(je=>({id:je.id.toString(),name:je.name,full_name:je.name,studentNumber:je.student_number,gradeLevel:je.grade_level,gradesVerified:je.grades_verified,finalGrades:je.subjects.map(we=>({id:`${je.id}_${we.subject_id}`,subjectName:we.subject_name,subjectCode:we.subject_code,teacherName:we.teacher_name,finalGrade:we.averages.final_grade,verified:we.verified,verifiedAt:we.verified_at,submittedToAdviser:we.submitted_to_adviser})),grades:je.subjects.map(we=>({subject:we.subject_name,teacher:we.teacher_name,grade:we.averages.final_grade,quarter:"1st Quarter",verified:we.verified,submittedDate:we.submitted_at?y(we.submitted_at):null,submittedToAdviser:we.submitted_to_adviser,gradeItems:[]}))})),!0)):s(_,K.error||"Failed to fetch advisory data",!0)}catch(K){console.error("Error fetching advisory data:",K),s(_,"Failed to load advisory data. Please try again.")}finally{s(S,!1)}}Wt(()=>{b().userData?.id&&V()});const D=Ut(()=>e(w).map(K=>{if(!K.finalGrades||K.finalGrades.length===0)return{...K,average:0,verifiedGradesCount:0,pendingGradesCount:K.grades?.length||0};const we=K.finalGrades.reduce((ia,Aa)=>ia+(Aa.finalGrade||0),0)/K.finalGrades.length,na=K.finalGrades?.filter(ia=>ia.verified)||[];return{...K,average:Math.round(we*100)/100,verifiedGradesCount:na.length,pendingGradesCount:(K.finalGrades?.length||0)-na.length}}));Ws(()=>{if(e(E)&&e(D).length>0){const K=e(D).map(je=>je.average).filter(je=>je!==null&&je>0);K.length>0?e(E).averageGrade=Math.round(K.reduce((je,we)=>je+we,0)/K.length*100)/100:e(E).averageGrade=null}else e(E)&&(e(E).averageGrade=null)});async function L(K){if(!K||e(P).has(K))return;const[je,we]=K.split("_"),na=e(w).find(Pe=>Pe.id===je),ia=na?.finalGrades?.find(Pe=>Pe.id===K),Aa=ia?.subjectName||"Unknown Subject",ha=na?.full_name||"Unknown Student";if(ia?.finalGrade===null||ia?.finalGrade==="N/A"||ia?.finalGrade===""){ne.error(`Cannot verify ${Aa} grade for ${ha} - grade is N/A`);return}es.confirm("Verify Grade",`Are you sure you want to verify the ${Aa} grade for ${ha}?`,async()=>{e(P).add(K),s(P,new Set(e(P)),!0);try{const Pe=await Qa.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:je,section_id:e(E).section_id,teacher_id:b().userData.id,school_year:$,quarter:1,verified:!0});Pe.success?(s(w,e(w).map(ca=>{const va={...ca,finalGrades:ca.finalGrades?.map(Ge=>Ge.id===K?{...Ge,verified:!0}:Ge)||[]},Ie=va.finalGrades?.every(Ge=>Ge.verified)||!1;return va.gradesVerified=Ie,va}),!0),ne.success(`${Aa} grade verified for ${ha}`),e(P).delete(K),s(P,new Set(e(P)),!0)):(console.error("Failed to verify grade:",Pe.error),ne.error(Pe.error||"Failed to verify grade. Please try again."),e(P).delete(K),s(P,new Set(e(P)),!0))}catch(Pe){console.error("Error verifying grade:",Pe),ne.error("Failed to verify grade. Please try again."),e(P).delete(K),s(P,new Set(e(P)),!0)}},()=>{})}async function T(K){const je=e(w).find(ia=>ia.id===K),we=je?.full_name||"Unknown Student";if(je?.finalGrades?.some(ia=>ia.finalGrade===null||ia.finalGrade==="N/A"||ia.finalGrade==="")){ne.error(`Cannot verify all grades for ${we} - some grades are N/A`);return}es.confirm("Verify All Grades",`Are you sure you want to verify all grades for ${we}?`,async()=>{try{const ia=await Qa.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:K,section_id:e(E).section_id,teacher_id:b().userData.id,school_year:$,quarter:1,verified:!0});ia.success?(s(w,e(w).map(Aa=>Aa.id===K?{...Aa,gradesVerified:!0,finalGrades:Aa.finalGrades?.map(ha=>({...ha,verified:!0}))||[]}:Aa),!0),ne.success(`All grades verified for ${we}`)):(console.error("Failed to verify student grades:",ia.error),ne.error(ia.error||"Failed to verify student grades. Please try again."))}catch(ia){console.error("Error verifying student grades:",ia),ne.error("Failed to verify student grades. Please try again.")}},()=>{})}async function se(){const K=e(w).filter(je=>je.finalGrades?.some(we=>we.finalGrade===null||we.finalGrade==="N/A"||we.finalGrade===""));if(K.length>0){const je=K.map(we=>we.full_name).join(", ");ne.error(`Cannot verify all grades - the following students have N/A grades: ${je}`);return}es.confirm("Verify All Students","Are you sure you want to verify all grades for all students in this class?",async()=>{try{const je=await Qa.post("/api/teacher-advisory",{action:"verify_all_grades",section_id:e(E).section_id,teacher_id:b().userData.id,school_year:$,quarter:1,verified:!0});je.success?(s(w,e(w).map(we=>({...we,gradesVerified:!0,finalGrades:we.finalGrades?.map(na=>({...na,verified:!0}))||[],grades:we.grades.map(na=>({...na,verified:!0}))})),!0),ne.success("All student grades verified successfully")):(console.error("Failed to verify all students:",je.error),ne.error(je.error||"Failed to verify all students. Please try again."))}catch(je){console.error("Error verifying all students:",je),ne.error("Failed to verify all students. Please try again.")}},()=>{})}let pe=[{id:"students",label:"Total Students",getValue:()=>e(E)?.totalStudents||0,icon:"people",color:"var(--school-primary)"},{id:"subjects",label:"Subjects Tracked",getValue:()=>e(E)?.subjectsCount||0,icon:"book",color:"var(--school-secondary)"},{id:"average",label:"Class Average",getValue:()=>e(E)&&e(E).averageGrade!==null?`${e(E).averageGrade}`:"N/A",icon:"grade",color:"var(--school-accent)"}],N=Na(null);function G(K){s(N,e(N)?.id===K.id?null:K,!0)}function H(K){return K>=90?"var(--success)":K>=80?"var(--school-accent)":K>=75?"var(--warning)":"var(--error)"}var I=pd(),re=t(I),M=t(re),C=r(t(M),2),R=t(C),B=r(t(R),2),de=t(B,!0);a(B),a(R);var xe=r(R,2),ue=r(t(xe),2),X=t(ue,!0);a(ue),a(xe),a(C),Xa(2),a(M),a(re);var qe=r(re,2),be=t(qe);ma(be,21,()=>pe,K=>K.id,(K,je)=>{var we=ad(),na=t(we),ia=t(na),Aa=t(ia,!0);a(ia),a(na);var ha=r(na,2),Pe=t(ha),ca=t(Pe);{let Z=Ut(()=>e(je).getValue());ai(ca,{get value(){return e(Z)},format:"d",duration:2e3,animation:"ease-out"})}var va=r(ca,2);{var Ie=Z=>{};m(va,Z=>{e(je).id==="average"&&Z(Ie)})}a(Pe);var Ge=r(Pe,2),Me=t(Ge,!0);a(Ge),a(ha),a(we),g(()=>{ks(na,`background-color: ${e(je).color??""}20; color: ${e(je).color??""}`),l(Aa,e(je).icon),ks(Pe,`color: ${e(je).color??""}`),l(Me,e(je).label)}),i(K,we)}),a(be),a(qe);var _e=r(qe,2),fe=t(_e),ke=t(fe),Ve=r(ke,2),ye=t(Ve);a(Ve),a(fe);var Oe=r(fe,2),U=t(Oe);{var he=K=>{var je=td();i(K,je)},Ze=K=>{var je=Ta(),we=da(je);{var na=Aa=>{var ha=sd(),Pe=r(t(ha),2),ca=t(Pe);a(Pe),a(ha),g(()=>l(ca,`Error loading students: ${e(_)??""}`)),i(Aa,ha)},ia=Aa=>{var ha=Ta(),Pe=da(ha);{var ca=Ie=>{var Ge=rd();i(Ie,Ge)},va=Ie=>{var Ge=Ta(),Me=da(Ge);ma(Me,17,()=>e(D),Z=>Z.id,(Z,J)=>{var c=md();let v;var A=t(c),ee=t(A),Ce=t(ee),me=t(Ce),te=t(me);a(me),a(Ce);var Ke=r(Ce,2),f=t(Ke),k=r(t(f),2),oe=t(k);a(k),a(f);var Te=r(f,2),Ue=t(Te),F=t(Ue,!0);a(Ue);var Ae=r(Ue,2),Qe=t(Ae,!0);a(Ae),a(Te);var We=r(Te,2),Xe=r(t(We),2),$a=t(Xe);a(Xe),a(We),a(Ke),a(ee);var xa=r(ee,2),ie=t(xa),x=t(ie,!0);a(ie),a(xa);var le=r(xa,2),Le=t(le),pa=t(Le,!0);a(Le),a(le),a(A);var He=r(A,2);{var sa=la=>{var Ee=ud(),O=t(Ee),Fe=r(t(O),2),ea=t(Fe);a(Fe),a(O);var qa=r(O,2);ma(qa,21,()=>e(J).grades,Ia=>Ia.subject,(Ia,st)=>{const ra=Ut(()=>e(J).finalGrades?.find(ya=>ya.subjectName===e(st).subject));var ae=vd();let Re;var Y=t(ae),Se=t(Y),Je=t(Se);{var Be=ya=>{var aa=id();Xa(2),i(ya,aa)},ge=ya=>{var aa=nd();Xa(2),i(ya,aa)};m(Je,ya=>{e(P).has(e(ra)?.id)?ya(Be):ya(ge,!1)})}a(Se),a(Y);var De=r(Y,2),ua=t(De),Pa=t(ua),et=t(Pa,!0);a(Pa);var Ea=r(Pa,2),ot=t(Ea);a(Ea);var mt=r(Ea,2);{var St=ya=>{var aa=od(),ta=t(aa);a(aa),g(()=>l(ta,`Submitted: ${e(st).submittedDate||"N/A"}`)),i(ya,aa)},Tt=ya=>{var aa=ld();i(ya,aa)};m(mt,ya=>{e(ra)&&e(ra).submittedToAdviser&&e(ra).finalGrade!==null?ya(St):ya(Tt,!1)})}a(ua);var Ft=r(ua,2),Ne=t(Ft);{var Ye=ya=>{var aa=dd(),ta=t(aa,!0);a(aa),g(ga=>{ks(aa,`color: ${ga??""}`),l(ta,e(ra).finalGrade)},[()=>H(e(ra).finalGrade)]),i(ya,aa)},Sa=ya=>{var aa=cd();i(ya,aa)};m(Ne,ya=>{e(ra)&&e(ra).submittedToAdviser&&e(ra).finalGrade!==null?ya(Ye):ya(Sa,!1)})}a(Ft),a(De),a(ae),g((ya,aa)=>{Re=W(ae,1,`grade-item ${e(ra)?.verified?"verified":"unverified"}`,null,Re,ya),ae.disabled=aa,l(et,e(st).subject),l(ot,`by ${e(st).teacher??""}`)},[()=>({loading:e(P).has(e(ra)?.id)}),()=>e(P).has(e(ra)?.id)]),q("click",ae,()=>L(e(ra).id)),i(Ia,ae)}),a(qa),a(Ee),q("click",ea,wr(()=>T(e(J).id))),i(la,Ee)};m(He,la=>{e(N)?.id===e(J).id&&la(sa)})}a(c),g((la,Ee)=>{v=W(c,1,`advisory-student-card ${e(J).gradesVerified?"verified":"pending"}`,null,v,la),l(te,`${e(J).name??""} · Grade ${e(J).gradeLevel||"7"}`),l(oe,`Student #${e(J).studentNumber??""}`),l(F,e(J).gradesVerified?"verified":"pending"),l(Qe,e(J).gradesVerified?"Verified":"Pending"),l($a,`${e(J).verifiedGradesCount??""} Verified, ${e(J).pendingGradesCount??""} Pending`),ks(ie,`color: ${Ee??""}`),l(x,e(J).average!==null?e(J).average:"N/A"),l(pa,e(N)?.id===e(J).id?"expand_less":"expand_more")},[()=>({selected:e(N)?.id===e(J).id}),()=>e(J).average!==null?H(e(J).average):"#666"]),q("click",A,()=>G(e(J))),i(Z,c)}),i(Ie,Ge)};m(Pe,Ie=>{e(D).length===0?Ie(ca):Ie(va,!1)},!0)}i(Aa,ha)};m(we,Aa=>{e(_)?Aa(na):Aa(ia,!1)},!0)}i(K,je)};m(U,K=>{e(S)?K(he):K(Ze,!1)})}a(Oe),a(_e),a(I),g(()=>{l(de,e(E)?.sectionName||"Loading..."),l(X,e(E)?.roomName||"Loading...")}),q("click",ke,V),q("click",ye,se),i(z,I),It(),h()}function _d(z,d){s(d,!e(d))}function gd(z,d,u){s(d,!e(d)),u()}var bd=o('<img alt="Profile" class="avatar-image"/>'),hd=o('<div class="avatar-placeholder"> </div>'),yd=(z,d,u)=>{d(),u.onNavigateToSettings()},wd=async(z,d,u)=>{d(),await u.onlogout(),Js("Logged out successfully. See you next time!")},Sd=o('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),xd=o('<nav class="admin-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">admin_panel_settings</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function kd(z,d){Pt(d,!0);let u=xt(d,"adminName",3,"Admin User"),h=xt(d,"firstName",3,"Admin"),b=xt(d,"gender",3,"male"),y=xt(d,"accountNumber",3,"ADM-2025-0001"),S=xt(d,"profileImage",3,null);function _(U){return U==="female"?"Ms.":"Mr."}let E=Ut(()=>`${_(b())} ${h()}`),w=Na(!0),$=Na(!1);function P(){s($,!1)}function V(U){e($)&&!U.target.closest(".user-profile-container")&&P()}Wt(()=>{const U=localStorage.getItem("theme");return s(w,U!=="light"),D(),document.addEventListener("click",V),()=>{document.removeEventListener("click",V)}});function D(){e(w)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function L(U){return U.split(" ").map(he=>he.charAt(0)).join("").toUpperCase().slice(0,2)}var T=xd(),se=t(T),pe=t(se),N=t(pe);N.__click=function(...U){d.onToggleNavRail?.apply(this,U)};var G=r(N,2),H=r(t(G),2),I=t(H);a(H),a(G),a(pe);var re=r(pe,2),M=t(re);M.__click=[gd,w,D];var C=t(M),R=t(C,!0);a(C),a(M);var B=r(M,2),de=t(B);de.__click=[_d,$];var xe=t(de),ue=t(xe),X=t(ue,!0);a(ue);var qe=r(ue,2),be=t(qe);a(qe),a(xe);var _e=r(xe,2),fe=t(_e);{var ke=U=>{var he=bd();g(()=>Da(he,"src",S())),i(U,he)},Ve=U=>{var he=hd(),Ze=t(he,!0);a(he),g(K=>l(Ze,K),[()=>L(h())]),i(U,he)};m(fe,U=>{S()?U(ke):U(Ve,!1)})}a(_e),a(de);var ye=r(de,2);{var Oe=U=>{var he=Sd(),Ze=t(he);Ze.__click=[yd,P,d];var K=r(Ze,2);K.__click=[wd,P,d],a(he),i(U,he)};m(ye,U=>{e($)&&U(Oe)})}a(B),a(re),a(se),a(T),g(()=>{l(I,`Welcome, ${e(E)??""}`),l(R,e(w)?"light_mode":"dark_mode"),l(X,u()),l(be,`Account: ${y()??""}`)}),i(z,T),It()}js(["click"]);var Ad=(z,d,u)=>d(e(u).id),Dd=(z,d,u)=>d(e(u).id),Td=o('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),Nd=o('<div class="admin-menu-folder-contents"></div>'),jd=o('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button> <!>',1),$d=(z,d,u)=>d(e(u).id),Cd=o('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),qd=(z,d,u)=>d(e(u).id),Ed=o('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),Fd=(z,d,u)=>d(e(u).id),Ld=o('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),Pd=(z,d)=>d("management-folder"),Id=z=>z.stopPropagation(),Gd=(z,d)=>d("management-folder"),Md=(z,d,u,h)=>{d(e(u).id),h("management-folder")},Rd=o('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Od=o('<div class="admin-menu-mobile-folder-overlay"><div class="admin-menu-mobile-folder-content"><div class="admin-menu-mobile-folder-header"><h3>Management</h3> <button class="admin-menu-close-folder"><span class="material-symbols-outlined">close</span></button></div> <div class="admin-menu-mobile-folder-items"></div></div></div>'),Vd=o('<nav role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-rail-container"></div></nav> <nav class="admin-menu-bottom-navigation" role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-nav-container"><!> <!></div></nav>',1);function Ud(z,d){Pt(d,!0);let u=xt(d,"adminActiveSection",15,"dashboard"),h=xt(d,"adminNavRailVisible",3,!0),b=Na(!1);const y=[{id:"dashboard",label:"Dashboard",icon:"dashboard",type:"item"},{id:"management-folder",label:"Management",icon:"folder",type:"folder",expanded:e(b),items:[{id:"schedule-management",label:"Schedule",icon:"schedule"},{id:"department-management",label:"Department",icon:"corporate_fare"},{id:"subjects-and-activities",label:"Subjects & Activities",icon:"school"}]},{id:"account-creation",label:"Account Creation",icon:"person_add",type:"item"},{id:"document-requests",label:"Document Requests",icon:"description",type:"item"},{id:"student-masterlist",label:"Student Masterlist",icon:"groups",type:"item"},{id:"student-grades-list",label:"Student Grades List",icon:"grade",type:"item"},{id:"archived-students",label:"Archived Students",icon:"archive",type:"item"}];function S(N){u(N),d.onnavigate&&d.onnavigate({detail:{section:N}})}function _(N){N==="management-folder"&&s(b,!e(b))}function E(N){return N.items?.some(G=>G.id===u())||!1}var w=Vd(),$=da(w);let P;var V=t($);ma(V,21,()=>y,N=>N.id,(N,G)=>{var H=Ta(),I=da(H);{var re=C=>{var R=jd(),B=da(R);let de;B.__click=[Ad,_,G];var xe=t(B),ue=t(xe),X=t(ue,!0);a(ue),a(xe);var qe=r(xe,2),be=t(qe,!0);a(qe),a(B);var _e=r(B,2);{var fe=ke=>{var Ve=Nd();ma(Ve,21,()=>e(G).items,ye=>ye.id,(ye,Oe)=>{var U=Td();let he;U.__click=[Dd,S,Oe];var Ze=t(U),K=t(Ze),je=t(K,!0);a(K),a(Ze);var we=r(Ze,2),na=t(we,!0);a(we),a(U),g(ia=>{he=W(U,1,"admin-menu-rail-item admin-menu-sub-item",null,he,ia),Da(U,"aria-label",e(Oe).label),Da(U,"aria-current",e(Oe).id===u()?"page":void 0),l(je,e(Oe).icon),l(na,e(Oe).label)},[()=>({active:e(Oe).id===u()})]),i(ye,U)}),a(Ve),i(ke,Ve)};m(_e,ke=>{e(b)&&ke(fe)})}g(ke=>{de=W(B,1,"admin-menu-rail-item admin-menu-folder",null,de,ke),Da(B,"aria-label",e(G).label),Da(B,"aria-expanded",e(b)),l(X,e(b)?"folder_open":"folder"),l(be,e(G).label)},[()=>({active:E(e(G)),expanded:e(b)})]),i(C,R)},M=C=>{var R=Cd();let B;R.__click=[$d,S,G];var de=t(R),xe=t(de),ue=t(xe,!0);a(xe),a(de);var X=r(de,2),qe=t(X,!0);a(X),a(R),g(be=>{B=W(R,1,"admin-menu-rail-item",null,B,be),Da(R,"aria-label",e(G).label),Da(R,"aria-current",e(G).id===u()?"page":void 0),l(ue,e(G).icon),l(qe,e(G).label)},[()=>({active:e(G).id===u()})]),i(C,R)};m(I,C=>{e(G).type==="folder"?C(re):C(M,!1)})}i(N,H)}),a(V),a($);var D=r($,2),L=t(D),T=t(L);ma(T,17,()=>y,N=>N.id,(N,G)=>{var H=Ta(),I=da(H);{var re=C=>{var R=Ed();let B;R.__click=[qd,_,G];var de=t(R),xe=t(de),ue=t(xe,!0);a(xe),a(de),a(R),g(X=>{B=W(R,1,"admin-menu-nav-item admin-menu-folder",null,B,X),Da(R,"aria-label",e(G).label),Da(R,"aria-expanded",e(b)),l(ue,e(b)?"folder_open":"folder")},[()=>({active:E(e(G))})]),i(C,R)},M=C=>{var R=Ld();let B;R.__click=[Fd,S,G];var de=t(R),xe=t(de),ue=t(xe,!0);a(xe),a(de),a(R),g(X=>{B=W(R,1,"admin-menu-nav-item",null,B,X),Da(R,"aria-label",e(G).label),Da(R,"aria-current",e(G).id===u()?"page":void 0),l(ue,e(G).icon)},[()=>({active:e(G).id===u()})]),i(C,R)};m(I,C=>{e(G).type==="folder"?C(re):C(M,!1)})}i(N,H)});var se=r(T,2);{var pe=N=>{var G=Od();G.__click=[Pd,_];var H=t(G);H.__click=[Id];var I=t(H),re=r(t(I),2);re.__click=[Gd,_],a(I);var M=r(I,2);ma(M,21,()=>y.find(C=>C.id==="management-folder")?.items||[],C=>C.id,(C,R)=>{var B=Rd();let de;B.__click=[Md,S,R,_];var xe=t(B),ue=t(xe,!0);a(xe);var X=r(xe,2),qe=t(X,!0);a(X),a(B),g(be=>{de=W(B,1,"admin-menu-mobile-folder-item",null,de,be),l(ue,e(R).icon),l(qe,e(R).label)},[()=>({active:e(R).id===u()})]),i(C,B)}),a(M),a(H),a(G),i(N,G)};m(se,N=>{e(b)&&N(pe)})}a(L),a(D),g(N=>P=W($,1,"admin-menu-navigation-rail",null,P,N),[()=>({collapsed:!h()})]),i(z,w),It()}js(["click"]);function Wd(){const{subscribe:z,set:d,update:u}=or({data:[{id:"students",label:"Total Students",value:0,icon:"school",color:"blue"},{id:"teachers",label:"Total Teachers",value:0,icon:"person",color:"green"},{id:"sections",label:"Total Sections",value:0,icon:"class",color:"orange"},{id:"rooms",label:"Total Rooms",value:0,icon:"meeting_room",color:"purple"}],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:z,init:h=>{h&&u(b=>({...b,data:h,isInitialized:!0,isLoading:!1}))},setLoading:h=>{u(b=>({...b,isLoading:h&&!b.isInitialized}))},updateData:h=>{u(b=>({...b,data:h,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0}));try{localStorage.setItem("dashboard-stats-cache",JSON.stringify({data:h,timestamp:Date.now()}))}catch(b){console.warn("Failed to cache dashboard data:",b)}},setError:h=>{u(b=>({...b,error:h,isLoading:!1}))},getCachedData:()=>{try{const h=localStorage.getItem("dashboard-stats-cache");if(h){const{data:b,timestamp:y}=JSON.parse(h);if(Date.now()-y<300*1e3)return b}}catch(h){console.warn("Failed to retrieve cached dashboard data:",h)}return null},clearCache:()=>{try{localStorage.removeItem("dashboard-stats-cache")}catch(h){console.warn("Failed to clear dashboard cache:",h)}}}}const er=Wd();var Yd=o('<div class="stats-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Hd=o('<div><div class="stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><h3 class="stat-value"><!></h3> <p class="stat-label"> </p></div></div>'),Jd=o('<div class="stats-grid"></div>'),Bd=o('<div class="activities-loading"><div class="system-loader"></div> <p>Loading recent activities...</p></div>'),Qd=o('<div class="activities-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),zd=o('<div class="activities-empty"><span class="material-symbols-outlined">inbox</span> <p>No recent activities found</p></div>'),Kd=o('<p class="activity-user"> </p>'),Zd=o('<div class="activity-item"><div class="activity-icon"><span class="material-symbols-outlined"> </span></div> <div class="activity-content"><p class="activity-message"> </p> <!></div> <span class="activity-timestamp"> </span></div>'),Xd=o('<div class="dashboard-container"><div class="dashboard-header"><div class="header-content"><h1 class="page-title">Admin Dashboard</h1> <p class="page-subtitle">Overview of school management system statistics</p></div></div> <div class="stats-section"><div class="section-header"><h2 class="section-title">System Statistics</h2> <p class="dashboard-section-subtitle">Current overview of your school management system</p></div> <!></div> <div class="activities-section"><div class="section-header"><h2 class="section-title">Activity Logs</h2> <button class="refresh-button" title="Refresh activity logs"><span class="material-symbols-outlined">refresh</span> Refresh</button></div> <div class="activities-list"><!></div></div></div>');function ec(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(er,"$dashboardStore",u),y=p(),S=p(),_=p();let E=p([]),w=p(!1),$=p(null);async function P(R=!1){try{R||er.setLoading(!0);const B=await Qa.get("/api/dashboard");if(B.success){const de=[{id:"students",label:"Total Students",value:B.data.students.toLocaleString(),icon:"school",color:"primary"},{id:"teachers",label:"Total Teachers",value:B.data.teachers.toLocaleString(),icon:"person",color:"primary"},{id:"sections",label:"Total Sections",value:B.data.sections.toLocaleString(),icon:"class",color:"primary"},{id:"rooms",label:"Total Rooms",value:B.data.rooms.toLocaleString(),icon:"meeting_room",color:"primary"}];er.updateData(de)}else throw new Error(B.error||"Failed to fetch dashboard statistics")}catch(B){console.error("Error fetching dashboard statistics:",B),er.setError(B.message)}}async function V(R=!1){try{R||(s(w,!0),s($,null));const B=await Qa.get("/api/activity-logs");if(B.success)s(E,B.activities);else throw new Error(B.error||"Failed to fetch activities")}catch(B){console.error("Error fetching activities:",B),s($,B.message)}finally{s(w,!1)}}Wt(()=>{const R=er.getCachedData();R&&er.init(R),P(!!R),V(!1);const B=setInterval(()=>{P(!0),V(!0)},3e4);return()=>{clearInterval(B)}}),Ya(()=>(e(y),e(S),e(_),b()),()=>{(R=>{s(y,R.data),s(S,R.isLoading),s(_,R.error)})(b())}),ds(),is();var D=Xd(),L=r(t(D),2),T=r(t(L),2);{var se=R=>{var B=Yd(),de=r(t(B),2),xe=t(de);a(de);var ue=r(de,2);a(B),g(()=>l(xe,`Error loading statistics: ${e(_)??""}`)),q("click",ue,()=>P(!1)),i(R,B)},pe=R=>{var B=Jd();ma(B,5,()=>e(y),de=>de.id,(de,xe)=>{var ue=Hd(),X=t(ue),qe=t(X),be=t(qe,!0);a(qe),a(X);var _e=r(X,2),fe=t(_e),ke=t(fe);{var Ve=he=>{var Ze=kt("Loading...");i(he,Ze)},ye=he=>{var Ze=kt();g(()=>l(Ze,(e(xe),n(()=>e(xe).value)))),i(he,Ze)};m(ke,he=>{e(S)?he(Ve):he(ye,!1)})}a(fe);var Oe=r(fe,2),U=t(Oe,!0);a(Oe),a(_e),a(ue),g(()=>{W(ue,1,`stat-card stat-${e(xe),n(()=>e(xe).color)??""}`),l(be,(e(xe),n(()=>e(xe).icon))),l(U,(e(xe),n(()=>e(xe).label)))}),i(de,ue)}),a(B),i(R,B)};m(T,R=>{e(_)?R(se):R(pe,!1)})}a(L);var N=r(L,2),G=t(N),H=r(t(G),2);a(G);var I=r(G,2),re=t(I);{var M=R=>{var B=Bd();i(R,B)},C=R=>{var B=Ta(),de=da(B);{var xe=X=>{var qe=Qd(),be=r(t(qe),2),_e=t(be);a(be),a(qe),g(()=>l(_e,`Error loading activities: ${e($)??""}`)),i(X,qe)},ue=X=>{var qe=Ta(),be=da(qe);{var _e=ke=>{var Ve=zd();i(ke,Ve)},fe=ke=>{var Ve=Ta(),ye=da(Ve);ma(ye,1,()=>e(E),Oe=>Oe.id,(Oe,U)=>{var he=Zd(),Ze=t(he),K=t(Ze),je=t(K,!0);a(K),a(Ze);var we=r(Ze,2),na=t(we),ia=t(na,!0);a(na);var Aa=r(na,2);{var ha=va=>{var Ie=Kd(),Ge=t(Ie,!0);a(Ie),g(()=>l(Ge,(e(U),n(()=>e(U).performed_by)))),i(va,Ie)};m(Aa,va=>{e(U),n(()=>e(U).performed_by&&e(U).performed_by!=="System")&&va(ha)})}a(we);var Pe=r(we,2),ca=t(Pe,!0);a(Pe),a(he),g(()=>{l(je,(e(U),n(()=>e(U).icon))),l(ia,(e(U),n(()=>e(U).message))),l(ca,(e(U),n(()=>e(U).timestamp)))}),i(Oe,he)}),i(ke,Ve)};m(be,ke=>{e(E),n(()=>e(E).length===0)?ke(_e):ke(fe,!1)},!0)}i(X,qe)};m(de,X=>{e($)?X(xe):X(ue,!1)},!0)}i(R,B)};m(re,R=>{e(w)?R(M):R(C,!1)})}a(I),a(N),a(D),g(()=>H.disabled=e(w)),q("click",H,()=>V(!1)),i(z,D),It(),h()}var ac=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),tc=o('<span class="placeholder">Select account type</span>'),sc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),rc=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),ic=o('<span class="placeholder">Select gender</span>'),nc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),oc=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),lc=o('<span class="placeholder">Select grade level</span>'),dc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),cc=o('<div class="form-group"><label class="form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div>'),vc=o('<div class="form-group"><label class="form-label" for="email">Email Address *</label> <input type="email" id="email" class="form-input" placeholder="Enter email address" required/></div>'),uc=o(`<div class="additional-info-section"><h3 class="section-subtitle">Additional Information</h3> <p class="section-description">Required information for student accounts</p> <div class="form-row"><div class="form-group"><label class="form-label" for="birthdate">Birthdate *</label> <input type="date" id="birthdate" class="form-input" required/></div> <div class="form-group"><label class="form-label" for="age">Age</label> <input type="number" id="age" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label" for="address">Address *</label> <textarea id="address" class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label" for="guardian">Guardian/Parent Name *</label> <input type="text" id="guardian" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label" for="contact-number">Guardian's Contact Number *</label> <input type="tel" id="contact-number" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`),mc=o('<span class="auto-label">Loading preview...</span>'),pc=o('<span class="auto-number"> </span> <span class="auto-label">(Preview - will use lowest available)</span>',1),fc=o('<span class="auto-label">Will be auto-assigned (lowest available number)</span>'),_c=o('<span class="placeholder-number">Select account type first</span>'),gc=o('<span class="material-symbols-outlined">person_add</span> Create Account',1),bc=o('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),hc=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),yc=o('<span class="placeholder">Filter by type</span>'),wc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Sc=o('<div class="loading-container"><span class="account-loader"></span> <p class="loading-text">Loading accounts...</p></div>'),xc=o('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),kc=o('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Ac=o('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),Dc=o('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),Tc=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),Nc=o('<span class="placeholder">Select grade level</span>'),jc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),$c=o(`<div class="form-group"><label class="form-label">Grade Level</label> <div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="additional-info-section"><h4 class="section-subtitle">Additional Information</h4> <p class="section-description">Update student additional information</p> <div class="form-row"><div class="form-group"><label class="form-label">Birthdate *</label> <input type="date" class="form-input" required/></div> <div class="form-group"><label class="form-label">Age</label> <input type="number" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label">Address *</label> <textarea class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label">Guardian/Parent Name *</label> <input type="text" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label">Guardian's Contact Number *</label> <input type="tel" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`,1),Cc=o('<div class="edit-form-section"><div class="edit-form-container"><div class="edit-form-header"><h4 class="edit-form-title">Edit Account Information</h4> <p class="edit-form-subtitle">Update the name information for this account</p></div> <form class="edit-form-content"><div class="edit-name-fields-row"><div class="form-group"><label class="form-label">Last Name *</label> <input type="text" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label">First Name *</label> <input type="text" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label">M.I.</label> <input type="text" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <div class="edit-form-actions"><a><button type="button" class="account-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),qc=o('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"> </h3></div> <div class="account-action-buttons"><a><button type="button" class="account-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="account-remove-button" title="Remove Account"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="account-details"><div class="account-detail-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <!> <!> <!> <!> <div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),Ec=o('<button type="button" class="clear-search-button-inline">Clear search</button>'),Fc=o('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p> <!></div>'),Lc=o('<div class="account-creation-container"><div class="account-header"><div class="header-content"><h1 class="page-title">Account Creation</h1> <p class="page-subtitle">Create new student, teacher, and admin accounts for the system</p></div></div> <div class="creation-form-section"><div class="account-section-header"><h2 class="section-title">Create New Account</h2> <p class="section-subtitle">Fill in the details below to create a new account</p></div> <div class="form-container"><form><div class="account-type-gender-row"><div class="form-group"><label class="form-label" for="account-type">Account Type *</label> <div><button type="button" id="account-type"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="form-group"><label class="form-label" for="gender">Gender *</label> <div><button type="button" id="gender"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div> <div class="name-fields-row"><div class="form-group"><label class="form-label" for="last-name">Last Name *</label> <input type="text" id="last-name" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label" for="first-name">First Name *</label> <input type="text" id="first-name" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label" for="middle-initial">M.I.</label> <input type="text" id="middle-initial" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <!> <div class="form-group"><div class="form-label"> </div> <div class="number-display"><!></div> <p class="form-help">Account number will be automatically assigned using the lowest available number. Password will be set to the same as the account number.</p></div> <div class="form-actions"><button type="submit"><!></button></div></form></div></div> <div class="recent-accounts-section"><div class="account-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="section-title">Recent Account Creations</h2> <p class="section-subtitle">Recently created accounts in the system</p></div> <div class="search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search accounts by name or number..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div></div></div> <div class="accounts-grid"><!></div></div></div>');function Pc(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(ls,"$authStore",u),y=p(),S=p(),_=p(),E=p(),w=p(),$=p(),P=p();let V=p(!1),D=p(""),L=p(""),T=p(""),se=p(""),pe=p(""),N=p(""),G=p(""),H=p(""),I=p(""),re=p(""),M=p(""),C=p(0),R=p(!1),B=p(!1),de=p(!1),xe=p(!1),ue=p("all"),X=p(null),qe=p(""),be=p(""),_e=p(""),fe=p(""),ke=p(!1),Ve=p(!1),ye=p(""),Oe=p(""),U=p(""),he=p(""),Ze=p(0);function K(){const j=new Date;return j.setDate(j.getDate()-1),j.toISOString().split("T")[0]}function je(j){return j&&j.split(" ").map(ve=>ve.charAt(0).toUpperCase()+ve.slice(1).toLowerCase()).join(" ")}function we(j,ve,ze=!1){const ba=j.target.value,ce=ve==="middleInitial"?ba.toUpperCase():je(ba);ze?ve==="firstName"?s(qe,ce):ve==="lastName"?s(be,ce):ve==="middleInitial"&&s(_e,ce):ve==="firstName"?s(se,ce):ve==="lastName"?s(pe,ce):ve==="middleInitial"&&s(N,ce),j.target.value=ce}function na(j){if(!j)return!1;const ve=j.replace(/\D/g,"");return ve.startsWith("09")&&ve.length===11}function ia(j){return j.replace(/\D/g,"").slice(0,11)}function Aa(j,ve=!1){const ze=ia(j.target.value);ve?s(he,ze):s(M,ze),j.target.value=ze}function ha(j){if(!j||j.length<10)return!0;const ve=new Date(j),ze=ve.getFullYear(),ba=new Date,ce=ba.getFullYear();if(isNaN(ve.getTime())||ze<1900||ze>ce)return!1;const Va=new Date(ba.getFullYear(),ba.getMonth(),ba.getDate());return!(new Date(ve.getFullYear(),ve.getMonth(),ve.getDate())>=Va)}let Pe=p("");const ca=[{id:"student",name:"Student Account",description:"Create a new student account",icon:"school"},{id:"teacher",name:"Teacher Account",description:"Create a new teacher account",icon:"person"},{id:"admin",name:"Admin Account",description:"Create a new admin account",icon:"admin_panel_settings"}],va=[{id:"all",name:"All Accounts",icon:"group"},{id:"student",name:"Students",icon:"school"},{id:"teacher",name:"Teachers",icon:"person"},{id:"admin",name:"Admins",icon:"admin_panel_settings"}],Ie=[{id:"male",name:"Male",icon:"male"},{id:"female",name:"Female",icon:"female"}],Ge=[{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let Me=p([]),Z=p(!1);function J(j){j.target.closest(".custom-dropdown")||(s(R,!1),s(B,!1),s(de,!1),s(ke,!1),s(xe,!1))}async function c(j){const ve=b().userData;if(ve&&ve.accountNumber===j.number){ne.error("You cannot delete your own account while logged in.");return}es.confirm("Remove Account",`<p>Are you sure you want to remove the account for <strong>"${j.name}"</strong>?</p>`,async()=>{try{const ze=await Qa.delete("/api/accounts",{id:j.id});if(!ze.success)throw new Error(ze.message||"Failed to delete account");s(Me,e(Me).filter(ba=>ba.id!==j.id)),ne.success(`Account for "${j.name}" has been removed successfully`)}catch(ze){console.error("Error deleting account:",ze),ne.error(`Failed to delete account: ${ze.message}`)}},()=>{},{size:"small"})}function v(j){if(e(X)===j.id)s(X,null),s(qe,""),s(be,""),s(_e,""),s(fe,""),s(ye,""),s(Oe,""),s(U,""),s(he,""),s(Ze,0),s(ke,!1);else if(s(X,j.id),j.firstName&&j.lastName){if(s(qe,j.firstName),s(be,j.lastName),s(_e,j.middleInitial||""),s(fe,j.gradeLevel||""),j.birthdate){const ve=new Date(j.birthdate),ze=ve.getFullYear(),ba=String(ve.getMonth()+1).padStart(2,"0"),ce=String(ve.getDate()).padStart(2,"0");s(ye,`${ze}-${ba}-${ce}`)}else s(ye,"");s(Oe,j.address||""),s(U,j.guardian||""),s(he,j.contactNumber||"")}else{const ve=j.name.split(", ");if(ve.length>=2){s(be,ve[0]);const ba=ve[1].split(" ");s(qe,ba[0]),ba.length>1&&ba[1].endsWith(".")?s(_e,ba[1].replace(".","")):s(_e,"")}if(s(fe,j.gradeLevel||""),j.birthdate){const ze=new Date(j.birthdate),ba=ze.getFullYear(),ce=String(ze.getMonth()+1).padStart(2,"0"),Va=String(ze.getDate()).padStart(2,"0");s(ye,`${ba}-${ce}-${Va}`)}else s(ye,"");s(Oe,j.address||""),s(U,j.guardian||""),s(he,j.contactNumber||"")}}async function A(){if(!e(qe)||!e(be)){ne.error("Please fill in all required fields.");return}if(e(y)&&e(y).type.toLowerCase()==="student"){if(!e(ye)||!e(Oe)||!e(U)||!e(he)){ne.error("Please fill in all required student information fields.");return}if(!na(e(he))){ne.error("Invalid contact number.");return}}s(Ve,!0);try{const j={id:e(X),firstName:e(qe).trim(),lastName:e(be).trim(),middleInitial:e(_e)?e(_e).trim():null};e(y)&&e(y).type.toLowerCase()==="student"&&(j.gradeLevel=e(fe)||null,j.birthdate=e(ye)||null,j.address=e(Oe)?e(Oe).trim():null,j.guardian=e(U)?e(U).trim():null,j.contactNumber=e(he)?e(he).trim():null);const ve=await Qa.put("/api/accounts",j);ve.success?(s(Me,e(Me).map(ze=>ze.id===e(X)?ve.account:ze)),ne.success(ve.message),s(X,null),s(qe,""),s(be,""),s(_e,""),s(fe,""),s(ye,""),s(Oe,""),s(U,""),s(he,""),s(Ze,0)):ne.error(ve.error||"Failed to update account")}catch(j){console.error("Error updating account:",j),ne.error("Failed to update account. Please try again.")}finally{s(Ve,!1)}}function ee(){s(R,!e(R))}function Ce(j){s(D,j.id),s(R,!1),j.id!=="student"&&s(T,"")}function me(){s(B,!e(B))}function te(j){s(L,j.id),s(B,!1)}function Ke(){s(de,!e(de))}function f(j){s(T,j.id),s(de,!1)}function k(){s(ke,!e(ke))}function oe(j){s(fe,j.id),s(ke,!1)}function Te(){s(xe,!e(xe))}function Ue(j){s(ue,j.id),s(xe,!1)}async function F(){if(!e(D)||!e(L)||!e(se)||!e(pe)){ne.error("Please fill in all required fields.");return}if((e(D)==="student"||e(D)==="teacher")&&!e(G)){ne.error("Please enter an email address.");return}if(e(D)==="student"&&!e(T)){ne.error("Please select a grade level for the student account.");return}if(e(D)==="student"){if(!e(H)||!e(I)||!e(re)||!e(M)){ne.error("Please fill in all additional information fields for the student account.");return}if(!na(e(M))){ne.error("Invalid contact number.");return}}const j=e(D)==="student"?"Student":e(D)==="teacher"?"Teacher":"Admin",ve=`${e(se)} ${e(N)?e(N)+". ":""}${e(pe)}`;es.confirm("Confirm Account Creation",`<p>Are you sure you want to create a <strong>${j}</strong> account for <strong>"${ve}"</strong>?</p>`,async()=>{await Ae()},()=>{},{size:"small"})}async function Ae(){s(V,!0);try{const j=b().userData,ve=await Qa.post("/api/accounts",{accountType:e(D),gender:e(L),gradeLevel:e(T),firstName:e(se),lastName:e(pe),middleInitial:e(N),email:e(G),birthdate:e(D)==="student"?e(H):null,address:e(D)==="student"?e(I):null,guardian:e(D)==="student"?e(re):null,contactNumber:e(D)==="student"?e(M):null,createdBy:j?j.id:null});if(!ve.success)throw new Error(ve.message||"Failed to create account");s(Me,[ve.account,...e(Me)]);const ze=e(D)==="student"?"Student":e(D)==="teacher"?"Teacher":"Admin";ne.success(`${ze} account created successfully for ${ve.account.name}! Password is the same as account number: ${ve.account.number}`),s(D,""),s(L,""),s(T,""),s(se,""),s(pe,""),s(N,""),s(G,""),s(H,""),s(I,""),s(re,""),s(M,""),s(C,0)}catch(j){console.error("Error creating account:",j),ne.error(j.message||"Failed to create account. Please try again.")}finally{s(V,!1)}}let Qe=p(""),We=p(!1);async function Xe(j){if(!j){s(Qe,"");return}s(We,!0);try{const ve=await Qa.get(`/api/accounts/next-number?type=${j}`);s(Qe,ve.accountNumber)}catch(ve){console.error("Error fetching next account number:",ve),s(Qe,"Error loading preview")}finally{s(We,!1)}}async function $a(){s(Z,!0);try{const j=await Qa.get("/api/accounts");if(!j.success)throw new Error("Failed to load accounts");s(Me,j.accounts)}catch(j){console.error("Error loading accounts:",j),ne.error("Failed to load existing accounts")}finally{s(Z,!1)}}Wt(()=>{$a()}),Ya(()=>(e(X),e(Me)),()=>{s(y,e(X)?e(Me).find(j=>j.id===e(X)):null)}),Ya(()=>e(D),()=>{s(S,ca.find(j=>j.id===e(D)))}),Ya(()=>e(L),()=>{s(_,Ie.find(j=>j.id===e(L)))}),Ya(()=>e(T),()=>{s(E,Ge.find(j=>j.id===e(T)))}),Ya(()=>e(ue),()=>{s(w,va.find(j=>j.id===e(ue)))}),Ya(()=>e(fe),()=>{s($,Ge.find(j=>j.id===e(fe)))}),Ya(()=>e(H),()=>{if(e(H)){const j=new Date(e(H)),ve=new Date;let ze=ve.getFullYear()-j.getFullYear();const ba=ve.getMonth()-j.getMonth();(ba<0||ba===0&&ve.getDate()<j.getDate())&&ze--,s(C,ze>=0?ze:0)}else s(C,0)}),Ya(()=>e(ye),()=>{if(e(ye)){const j=new Date(e(ye)),ve=new Date;let ze=ve.getFullYear()-j.getFullYear();const ba=ve.getMonth()-j.getMonth();(ba<0||ba===0&&ve.getDate()<j.getDate())&&ze--,s(Ze,ze>=0?ze:0)}else s(Ze,0)}),Ya(()=>(e(Me),e(ue),e(Pe)),()=>{s(P,e(Me).filter(j=>{const ve=j.type.toLowerCase(),ze=e(ue)==="all"||ve===e(ue);if(!e(Pe).trim())return ze;const ba=e(Pe).toLowerCase().trim(),ce=j.name.toLowerCase().includes(ba),Va=j.number.toString().includes(ba);return ze&&(ce||Va)}))}),Ya(()=>e(D),()=>{e(D)&&Xe(e(D))}),ds(),is();var xa=Lc();q("click",Fs,J);var ie=r(t(xa),2),x=r(t(ie),2),le=t(x),Le=t(le),pa=t(Le),He=r(t(pa),2);let sa;var la=t(He);let Ee;var O=t(la);{var Fe=j=>{var ve=ac(),ze=t(ve),ba=t(ze,!0);a(ze);var ce=r(ze,2),Va=t(ce),dt=t(Va,!0);a(Va);var _a=r(Va,2),Ma=t(_a,!0);a(_a),a(ce),a(ve),g(()=>{l(ba,(e(S),n(()=>e(S).icon))),l(dt,(e(S),n(()=>e(S).name))),l(Ma,(e(S),n(()=>e(S).description)))}),i(j,ve)},ea=j=>{var ve=tc();i(j,ve)};m(O,j=>{e(S)?j(Fe):j(ea,!1)})}Xa(2),a(la);var qa=r(la,2);ma(qa,5,()=>ca,j=>j.id,(j,ve)=>{var ze=sc();let ba;var ce=t(ze),Va=t(ce,!0);a(ce);var dt=r(ce,2),_a=t(dt),Ma=t(_a,!0);a(_a);var ct=r(_a,2),rt=t(ct,!0);a(ct),a(dt),a(ze),g(Ka=>{ba=W(ze,1,"dropdown-option",null,ba,Ka),l(Va,(e(ve),n(()=>e(ve).icon))),l(Ma,(e(ve),n(()=>e(ve).name))),l(rt,(e(ve),n(()=>e(ve).description)))},[()=>({selected:e(D)===e(ve).id})]),q("click",ze,()=>Ce(e(ve))),i(j,ze)}),a(qa),a(He),a(pa);var Ia=r(pa,2),st=r(t(Ia),2);let ra;var ae=t(st);let Re;var Y=t(ae);{var Se=j=>{var ve=rc(),ze=t(ve),ba=t(ze,!0);a(ze);var ce=r(ze,2),Va=t(ce),dt=t(Va,!0);a(Va),a(ce),a(ve),g(()=>{l(ba,(e(_),n(()=>e(_).icon))),l(dt,(e(_),n(()=>e(_).name)))}),i(j,ve)},Je=j=>{var ve=ic();i(j,ve)};m(Y,j=>{e(_)?j(Se):j(Je,!1)})}Xa(2),a(ae);var Be=r(ae,2);ma(Be,5,()=>Ie,j=>j.id,(j,ve)=>{var ze=nc();let ba;var ce=t(ze),Va=t(ce,!0);a(ce);var dt=r(ce,2),_a=t(dt),Ma=t(_a,!0);a(_a),a(dt),a(ze),g(ct=>{ba=W(ze,1,"dropdown-option",null,ba,ct),l(Va,(e(ve),n(()=>e(ve).icon))),l(Ma,(e(ve),n(()=>e(ve).name)))},[()=>({selected:e(L)===e(ve).id})]),q("click",ze,()=>te(e(ve))),i(j,ze)}),a(Be),a(st),a(Ia);var ge=r(Ia,2);{var De=j=>{var ve=cc(),ze=r(t(ve),2);let ba;var ce=t(ze);let Va;var dt=t(ce);{var _a=rt=>{var Ka=oc(),wa=t(Ka),La=t(wa,!0);a(wa);var nt=r(wa,2),Ct=t(nt),Nt=t(Ct,!0);a(Ct),a(nt),a(Ka),g(()=>{l(La,(e(E),n(()=>e(E).icon))),l(Nt,(e(E),n(()=>e(E).name)))}),i(rt,Ka)},Ma=rt=>{var Ka=lc();i(rt,Ka)};m(dt,rt=>{e(E)?rt(_a):rt(Ma,!1)})}Xa(2),a(ce);var ct=r(ce,2);ma(ct,5,()=>Ge,rt=>rt.id,(rt,Ka)=>{var wa=dc();let La;var nt=t(wa),Ct=t(nt,!0);a(nt);var Nt=r(nt,2),Dt=t(Nt),Gt=t(Dt,!0);a(Dt),a(Nt),a(wa),g(ht=>{La=W(wa,1,"dropdown-option",null,La,ht),l(Ct,(e(Ka),n(()=>e(Ka).icon))),l(Gt,(e(Ka),n(()=>e(Ka).name)))},[()=>({selected:e(T)===e(Ka).id})]),q("click",wa,()=>f(e(Ka))),i(rt,wa)}),a(ct),a(ze),a(ve),g((rt,Ka)=>{ba=W(ze,1,"custom-dropdown",null,ba,rt),Va=W(ce,1,"dropdown-trigger",null,Va,Ka)},[()=>({open:e(de)}),()=>({selected:e(T)})]),q("click",ce,Ke),i(j,ve)};m(ge,j=>{e(D)==="student"&&j(De)})}a(Le);var ua=r(Le,2),Pa=t(ua),et=r(t(Pa),2);Ba(et),a(Pa);var Ea=r(Pa,2),ot=r(t(Ea),2);Ba(ot),a(Ea);var mt=r(Ea,2),St=r(t(mt),2);Ba(St),a(mt),a(ua);var Tt=r(ua,2);{var Ft=j=>{var ve=vc(),ze=r(t(ve),2);Ba(ze),a(ve),Za(ze,()=>e(G),ba=>s(G,ba)),i(j,ve)};m(Tt,j=>{(e(D)==="student"||e(D)==="teacher")&&j(Ft)})}var Ne=r(Tt,2);{var Ye=j=>{var ve=uc(),ze=r(t(ve),4),ba=t(ze),ce=r(t(ba),2);Ba(ce),a(ba);var Va=r(ba,2),dt=r(t(Va),2);Ba(dt),a(Va),a(ze);var _a=r(ze,2),Ma=r(t(_a),2);br(Ma),a(_a);var ct=r(_a,2),rt=t(ct),Ka=r(t(rt),2);Ba(Ka),a(rt);var wa=r(rt,2),La=r(t(wa),2);Ba(La),a(wa),a(ct),a(ve),g(nt=>{Da(ce,"max",nt),yr(dt,e(C))},[()=>n(K)]),Za(ce,()=>e(H),nt=>s(H,nt)),q("blur",ce,nt=>{e(H)&&!ha(e(H))&&(ne.error("Invalid date. Please enter a valid date."),s(H,""),nt.target.value="")}),Za(Ma,()=>e(I),nt=>s(I,nt)),Za(Ka,()=>e(re),nt=>s(re,nt)),Za(La,()=>e(M),nt=>s(M,nt)),q("input",La,nt=>Aa(nt,!1)),i(j,ve)};m(Ne,j=>{e(D)==="student"&&j(Ye)})}var Sa=r(Ne,2),ya=t(Sa),aa=t(ya,!0);a(ya);var ta=r(ya,2),ga=t(ta);{var za=j=>{var ve=Ta(),ze=da(ve);{var ba=Va=>{var dt=mc();i(Va,dt)},ce=Va=>{var dt=Ta(),_a=da(dt);{var Ma=rt=>{var Ka=pc(),wa=da(Ka),La=t(wa,!0);a(wa),Xa(2),g(()=>l(La,e(Qe))),i(rt,Ka)},ct=rt=>{var Ka=fc();i(rt,Ka)};m(_a,rt=>{e(Qe)?rt(Ma):rt(ct,!1)},!0)}i(Va,dt)};m(ze,Va=>{e(We)?Va(ba):Va(ce,!1)})}i(j,ve)},ja=j=>{var ve=_c();i(j,ve)};m(ga,j=>{e(D)?j(za):j(ja,!1)})}a(ta),Xa(2),a(Sa);var ka=r(Sa,2),Oa=t(ka);let lt;var vt=t(Oa);{var it=j=>{var ve=kt("Creating Account...");i(j,ve)},Rt=j=>{var ve=gc();Xa(),i(j,ve)};m(vt,j=>{e(V)?j(it):j(Rt,!1)})}a(Oa),a(ka),a(le),a(x),a(ie);var ft=r(ie,2),$t=t(ft),Mt=t($t),Q=r(t(Mt),2),$e=t(Q),oa=t($e),Fa=r(t(oa),2);Ba(Fa);var tt=r(Fa,2);{var Ga=j=>{var ve=bc();q("click",ve,()=>s(Pe,"")),i(j,ve)};m(tt,j=>{e(Pe)&&j(Ga)})}a(oa),a($e);var fa=r($e,2),_t=t(fa);let pt;var Ha=t(_t);let gt;var At=t(Ha);{var Lt=j=>{var ve=hc(),ze=t(ve),ba=t(ze,!0);a(ze);var ce=r(ze,2),Va=t(ce),dt=t(Va,!0);a(Va),a(ce),a(ve),g(()=>{l(ba,(e(w),n(()=>e(w).icon))),l(dt,(e(w),n(()=>e(w).name)))}),i(j,ve)},Ja=j=>{var ve=yc();i(j,ve)};m(At,j=>{e(w)?j(Lt):j(Ja,!1)})}Xa(2),a(Ha);var Ca=r(Ha,2);ma(Ca,5,()=>va,j=>j.id,(j,ve)=>{var ze=wc();let ba;var ce=t(ze),Va=t(ce,!0);a(ce);var dt=r(ce,2),_a=t(dt),Ma=t(_a,!0);a(_a),a(dt),a(ze),g(ct=>{ba=W(ze,1,"dropdown-option",null,ba,ct),l(Va,(e(ve),n(()=>e(ve).icon))),l(Ma,(e(ve),n(()=>e(ve).name)))},[()=>({selected:e(ue)===e(ve).id})]),q("click",ze,()=>Ue(e(ve))),i(j,ze)}),a(Ca),a(_t),a(fa),a(Q),a(Mt),a($t);var Ra=r($t,2),Wa=t(Ra);{var at=j=>{var ve=Sc();i(j,ve)},bt=j=>{var ve=Ta(),ze=da(ve);ma(ze,1,()=>e(P),ba=>ba.id,(ba,ce)=>{var Va=qc(),dt=t(Va),_a=t(dt),Ma=t(_a),ct=t(Ma);a(Ma),a(_a);var rt=r(_a,2),Ka=t(rt),wa=t(Ka),La=t(wa),nt=t(La,!0);a(La),a(wa),a(Ka);var Ct=r(Ka,2);a(rt),a(dt);var Nt=r(dt,2),Dt=t(Nt),Gt=t(Dt),ht=t(Gt,!0);a(Gt);var jt=r(Gt,2),Yt=t(jt,!0);a(jt),a(Dt);var as=r(Dt,2),ws=r(t(as),2),Ds=t(ws);a(ws),a(as);var Ls=r(as,2);{var Rs=Et=>{var Ot=xc(),zt=r(t(Ot),2),ss=t(zt);a(zt),a(Ot),g(()=>l(ss,`Grade ${e(ce),n(()=>e(ce).gradeLevel)??""}`)),i(Et,Ot)};m(Ls,Et=>{e(ce),n(()=>e(ce).type==="Student"&&e(ce).gradeLevel)&&Et(Rs)})}var Ts=r(Ls,2);{var ut=Et=>{var Ot=kc(),zt=r(t(Ot),2),ss=t(zt);a(zt),a(Ot),g(()=>l(ss,`Age: ${e(ce),n(()=>e(ce).age)??""}`)),i(Et,Ot)};m(Ts,Et=>{e(ce),n(()=>e(ce).type==="Student"&&e(ce).age)&&Et(ut)})}var wt=r(Ts,2);{var qt=Et=>{var Ot=Ac(),zt=r(t(Ot),2),ss=t(zt);a(zt),a(Ot),g(()=>l(ss,`Guardian: ${e(ce),n(()=>e(ce).guardian)??""}`)),i(Et,Ot)};m(wt,Et=>{e(ce),n(()=>e(ce).type==="Student"&&e(ce).guardian)&&Et(qt)})}var Qt=r(wt,2);{var ts=Et=>{var Ot=Dc(),zt=r(t(Ot),2),ss=t(zt);a(zt),a(Ot),g(()=>l(ss,`Contact: ${e(ce),n(()=>e(ce).contactNumber)??""}`)),i(Et,Ot)};m(Qt,Et=>{e(ce),n(()=>e(ce).type==="Student"&&e(ce).contactNumber)&&Et(ts)})}var Bt=r(Qt,2),rs=r(t(Bt),2),cs=t(rs);a(rs),a(Bt);var Ht=r(Bt,2),hs=r(t(Ht),2),gs=t(hs);a(hs),a(Ht),a(Nt);var Ss=r(Nt,2);{var Jt=Et=>{var Ot=Cc(),zt=t(Ot),ss=r(t(zt),2),Ps=t(ss),$s=t(Ps),tr=t($s),Vs=r(tr,2);Ba(Vs),a($s);var Bs=r($s,2),lr=t(Bs),Us=r(lr,2);Ba(Us),a(Bs);var dr=r(Bs,2),sr=t(dr),Ys=r(sr,2);Ba(Ys),a(dr),a(Ps);var cr=r(Ps,2);{var xr=Ua=>{var yt=$c(),Vt=da(yt),ns=t(Vt),vs=r(ns,2);let xs;var us=t(vs);let ms;var Os=t(us);{var Is=Kt=>{var ys=Tc(),Cs=t(ys),pr=t(Cs,!0);a(Cs);var Xs=r(Cs,2),fr=t(Xs),_r=t(fr,!0);a(fr),a(Xs),a(ys),g(()=>{l(pr,(e($),n(()=>e($).icon))),l(_r,(e($),n(()=>e($).name)))}),i(Kt,ys)},rr=Kt=>{var ys=Nc();i(Kt,ys)};m(Os,Kt=>{e($)?Kt(Is):Kt(rr,!1)})}Xa(2),a(us);var Ns=r(us,2);ma(Ns,5,()=>Ge,Kt=>Kt.id,(Kt,ys)=>{var Cs=jc();let pr;var Xs=t(Cs),fr=t(Xs,!0);a(Xs);var _r=r(Xs,2),Ur=t(_r),ti=t(Ur,!0);a(Ur),a(_r),a(Cs),g(si=>{pr=W(Cs,1,"dropdown-option",null,pr,si),l(fr,(e(ys),n(()=>e(ys).icon))),l(ti,(e(ys),n(()=>e(ys).name)))},[()=>({selected:e(fe)===e(ys).id})]),q("click",Cs,()=>oe(e(ys))),i(Kt,Cs)}),a(Ns),a(vs),a(Vt);var Ks=r(Vt,2),Zs=r(t(Ks),4),Tr=t(Zs),Lr=t(Tr),ir=r(Lr,2);Ba(ir),a(Tr);var Pr=r(Tr,2),Ir=t(Pr),Nr=r(Ir,2);Ba(Nr),a(Pr),a(Zs);var jr=r(Zs,2),Gr=t(jr),$r=r(Gr,2);br($r),a(jr);var Mr=r(jr,2),Cr=t(Mr),Rr=t(Cr),qr=r(Rr,2);Ba(qr),a(Cr);var Or=r(Cr,2),Vr=t(Or),mr=r(Vr,2);Ba(mr),a(Or),a(Mr),a(Ks),g((Kt,ys,Cs)=>{Da(ns,"for",`edit-grade-level-${e(ce),n(()=>e(ce).id)??""}`),xs=W(vs,1,"custom-dropdown",null,xs,Kt),ms=W(us,1,"dropdown-trigger",null,ms,ys),Da(us,"id",`edit-grade-level-${e(ce),n(()=>e(ce).id)??""}`),Da(Lr,"for",`edit-birthdate-${e(ce),n(()=>e(ce).id)??""}`),Da(ir,"id",`edit-birthdate-${e(ce),n(()=>e(ce).id)??""}`),Da(ir,"max",Cs),Da(Ir,"for",`edit-age-${e(ce),n(()=>e(ce).id)??""}`),Da(Nr,"id",`edit-age-${e(ce),n(()=>e(ce).id)??""}`),yr(Nr,e(Ze)),Da(Gr,"for",`edit-address-${e(ce),n(()=>e(ce).id)??""}`),Da($r,"id",`edit-address-${e(ce),n(()=>e(ce).id)??""}`),Da(Rr,"for",`edit-guardian-${e(ce),n(()=>e(ce).id)??""}`),Da(qr,"id",`edit-guardian-${e(ce),n(()=>e(ce).id)??""}`),Da(Vr,"for",`edit-contact-number-${e(ce),n(()=>e(ce).id)??""}`),Da(mr,"id",`edit-contact-number-${e(ce),n(()=>e(ce).id)??""}`)},[()=>({open:e(ke)}),()=>({selected:e(fe)}),()=>n(K)]),q("click",us,k),Za(ir,()=>e(ye),Kt=>s(ye,Kt)),q("blur",ir,Kt=>{e(ye)&&!ha(e(ye))&&(ne.error("Invalid date. Please enter a valid date."),s(ye,""),Kt.target.value="")}),Za($r,()=>e(Oe),Kt=>s(Oe,Kt)),Za(qr,()=>e(U),Kt=>s(U,Kt)),Za(mr,()=>e(he),Kt=>s(he,Kt)),q("input",mr,Kt=>Aa(Kt,!0)),i(Ua,yt)};m(cr,Ua=>{e(ce),n(()=>e(ce).type.toLowerCase()==="student")&&Ua(xr)})}var vr=r(cr,2),Qs=t(vr),ur=t(Qs);a(Qs);var Hs=r(Qs,2);let zs;var kr=t(Hs);{var Ar=Ua=>{var yt=kt("Updating...");i(Ua,yt)},Dr=Ua=>{var yt=kt("Update Account");i(Ua,yt)};m(kr,Ua=>{e(Ve)?Ua(Ar):Ua(Dr,!1)})}a(Hs),a(vr),a(ss),a(zt),a(Ot),g((Ua,yt)=>{Da(tr,"for",`edit-last-name-${e(ce),n(()=>e(ce).id)??""}`),Da(Vs,"id",`edit-last-name-${e(ce),n(()=>e(ce).id)??""}`),Da(lr,"for",`edit-first-name-${e(ce),n(()=>e(ce).id)??""}`),Da(Us,"id",`edit-first-name-${e(ce),n(()=>e(ce).id)??""}`),Da(sr,"for",`edit-middle-initial-${e(ce),n(()=>e(ce).id)??""}`),Da(Ys,"id",`edit-middle-initial-${e(ce),n(()=>e(ce).id)??""}`),Da(Qs,"href",`#account-card-${e(ce),n(()=>e(ce).id)??""}`),zs=W(Hs,1,"account-submit-button",null,zs,Ua),Hs.disabled=yt},[()=>({loading:e(Ve)}),()=>(e(Ve),e(qe),e(be),e(y),e(ye),e(Oe),e(U),e(he),n(()=>e(Ve)||!e(qe)||!e(be)||e(y)&&e(y).type.toLowerCase()==="student"&&(!e(ye)||!e(Oe)||!e(U)||!e(he))))]),Za(Vs,()=>e(be),Ua=>s(be,Ua)),q("input",Vs,Ua=>we(Ua,"lastName",!0)),Za(Us,()=>e(qe),Ua=>s(qe,Ua)),q("input",Us,Ua=>we(Ua,"firstName",!0)),Za(Ys,()=>e(_e),Ua=>s(_e,Ua)),q("input",Ys,Ua=>we(Ua,"middleInitial",!0)),q("click",ur,()=>v(e(ce))),q("submit",ss,As(A)),i(Et,Ot)};m(Ss,Et=>{e(X),e(ce),n(()=>e(X)===e(ce).id)&&Et(Jt)})}a(Va),g(()=>{Da(Va,"id",`account-card-${e(ce),n(()=>e(ce).id)??""}`),l(ct,`${e(ce),n(()=>e(ce).name)??""} · ${e(ce),n(()=>e(ce).type)??""}`),Da(Ka,"href",`#account-card-${e(ce),n(()=>e(ce).id)??""}`),Da(wa,"title",(e(X),e(ce),n(()=>e(X)===e(ce).id?"Cancel Edit":"Edit Account"))),l(nt,(e(X),e(ce),n(()=>e(X)===e(ce).id?"close":"edit"))),l(ht,(e(ce),n(()=>e(ce).type==="Student"?"school":e(ce).type==="Teacher"?"person":"admin_panel_settings"))),l(Yt,(e(ce),n(()=>e(ce).number))),l(Ds,`${e(ce),n(()=>e(ce).type)??""} Account`),l(cs,`Created: ${e(ce),n(()=>e(ce).createdDate)??""}`),l(gs,`Updated: ${e(ce),n(()=>e(ce).updatedDate)??""}`)}),q("click",wa,()=>v(e(ce))),q("click",Ct,()=>c(e(ce))),i(ba,Va)},ba=>{var ce=Fc(),Va=t(ce),dt=t(Va,!0);a(Va);var _a=r(Va,2),Ma=t(_a);{var ct=La=>{var nt=kt();g(()=>l(nt,`No accounts found matching "${e(Pe)??""}".`)),i(La,nt)},rt=La=>{var nt=kt();g(Ct=>l(nt,`No ${Ct??""} accounts found.`),[()=>(e(ue),e(w),n(()=>e(ue)==="all"?"":e(w)?.name.toLowerCase()||""))]),i(La,nt)};m(Ma,La=>{e(Pe)?La(ct):La(rt,!1)})}a(_a);var Ka=r(_a,2);{var wa=La=>{var nt=Ec();q("click",nt,()=>s(Pe,"")),i(La,nt)};m(Ka,La=>{e(Pe)&&La(wa)})}a(ce),g(()=>l(dt,e(Pe)?"search_off":"person_off")),i(ba,ce)}),i(j,ve)};m(Wa,j=>{e(Z)?j(at):j(bt,!1)})}a(Ra),a(ft),a(xa),g((j,ve,ze,ba,ce,Va,dt)=>{sa=W(He,1,"custom-dropdown",null,sa,j),Ee=W(la,1,"dropdown-trigger",null,Ee,ve),ra=W(st,1,"custom-dropdown",null,ra,ze),Re=W(ae,1,"dropdown-trigger",null,Re,ba),l(aa,e(D)==="student"?"Student Number":e(D)==="teacher"?"Teacher Number":e(D)==="admin"?"Admin Number":"Account Number"),lt=W(Oa,1,"account-create-button",null,lt,ce),Oa.disabled=e(V)||!e(D)||!e(L)||!e(se)||!e(pe)||(e(D)==="student"||e(D)==="teacher")&&!e(G)||e(D)==="student"&&(!e(H)||!e(I)||!e(re)||!e(M)),pt=W(_t,1,"custom-dropdown",null,pt,Va),gt=W(Ha,1,"dropdown-trigger filter-trigger",null,gt,dt)},[()=>({open:e(R)}),()=>({selected:e(D)}),()=>({open:e(B)}),()=>({selected:e(L)}),()=>({loading:e(V)}),()=>({open:e(xe)}),()=>({selected:e(ue)!=="all"})]),q("click",la,ee),q("click",ae,me),Za(et,()=>e(pe),j=>s(pe,j)),q("input",et,j=>we(j,"lastName")),Za(ot,()=>e(se),j=>s(se,j)),q("input",ot,j=>we(j,"firstName")),Za(St,()=>e(N),j=>s(N,j)),q("input",St,j=>we(j,"middleInitial")),q("submit",le,As(F)),Za(Fa,()=>e(Pe),j=>s(Pe,j)),q("click",Ha,Te),i(z,xa),It(),h()}var Ic=o('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Gc=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <span class="option-name"> </span></div>'),Mc=o('<span class="placeholder">All Grade Levels</span>'),Rc=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Oc=o('<div class="selected-option"><span class="option-name"> </span></div>'),Vc=o('<span class="placeholder">All Sections</span>'),Uc=o('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),Wc=o('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Yc=o('<div class="masterlist-loading-container"><span class="student-loader"></span> <p class="masterlist-loading-text">Loading students...</p></div>'),Hc=o('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),Jc=o('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Bc=o('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),Qc=o('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),zc=o('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),Kc=o('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),Zc=o('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Xc=o('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),ev=o('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Student"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),av=o('<div class="students-grid"></div>'),tv=o('<button type="button" class="clear-search-button-inline">Clear</button>'),sv=o('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p> <!></div>'),rv=o('<div class="student-masterlist-container"><div class="admin-student-header"><div class="header-content"><h1 class="page-title">Student Masterlist</h1> <p class="page-subtitle">View and manage all student records in the system</p></div></div> <div class="filters-section"><div class="search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="students-list-section"><!></div></div>');function iv(z,d){Pt(d,!1);const u=p(),h=p();let b=[],y=p([]),S=p(!0),_=p(""),E=p(""),w=p(""),$=p(!1),P=p(!1);const V=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let D=p([{id:"",name:"All Sections"}]);async function L(){s(S,!0);try{const c=await Qa.get("/api/accounts?type=student");if(!c.success)throw new Error("Failed to load students");b=c.accounts.map(v=>({id:v.id,name:v.name,number:v.number,email:v.email,gradeLevel:v.gradeLevel||"Not specified",section:v.section||"Not specified",birthdate:v.birthdate||"Not specified",address:v.address||"Not specified",guardian:v.guardian||"Not specified",contactNumber:v.contactNumber||"Not specified",status:v.status||"active"})),se()}catch(c){console.error("Error loading students:",c),ne.error("Failed to load students. Please try again."),b=[]}finally{s(S,!1)}}async function T(){try{const c=await Qa.get("/api/sections");if(c.success&&c.data){const v=c.data.map(A=>({id:A.name,name:A.name}));s(D,[{id:"",name:"All Sections"},...v])}}catch(c){console.error("Error loading sections:",c)}}function se(){s(y,b.filter(c=>{const v=!e(_)||c.name.toLowerCase().includes(e(_).toLowerCase())||c.email.toLowerCase().includes(e(_).toLowerCase())||c.number&&c.number.toLowerCase().includes(e(_).toLowerCase()),A=!e(E)||c.gradeLevel===e(E),ee=!e(w)||c.section===e(w);return v&&A&&ee}))}function pe(){s($,!e($)),s(P,!1)}function N(){s(P,!e(P)),s($,!1)}function G(c){s(E,c.id),s($,!1),se()}function H(c){s(w,c.id),s(P,!1),se()}function I(c){if(!c)return"N/A";const v=new Date,A=new Date(c);let ee=v.getFullYear()-A.getFullYear();const Ce=v.getMonth()-A.getMonth();return(Ce<0||Ce===0&&v.getDate()<A.getDate())&&ee--,ee}function re(c){return c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function M(){s(_,""),s(E,""),s(w,""),se()}function C(c){c.target.closest(".custom-dropdown")||(s($,!1),s(P,!1))}async function R(c,v){es.confirm("Archive Student",`Are you sure you want to archive ${v}? This action will move the student to the archived list.`,async()=>{try{const A=await Qa.patch("/api/accounts",{id:c,action:"archive"});A.success?(ne.success(A.message),await L()):ne.error(A.message||"Failed to archive student")}catch(A){console.error("Error archiving student:",A),ne.error("Failed to archive student. Please try again.")}},()=>{})}Wt(()=>(T(),L(),document.addEventListener("click",C),()=>{document.removeEventListener("click",C)})),Ya(()=>e(E),()=>{s(u,V.find(c=>c.id===e(E)))}),Ya(()=>(e(D),e(w)),()=>{s(h,e(D).find(c=>c.id===e(w)))}),Ya(()=>e(_),()=>{e(_)!==void 0&&se()}),ds(),is();var B=rv(),de=r(t(B),2),xe=t(de),ue=t(xe),X=t(ue),qe=r(t(X),2);Ba(qe);var be=r(qe,2);{var _e=c=>{var v=Ic();q("click",v,()=>s(_,"")),i(c,v)};m(be,c=>{e(_)&&c(_e)})}a(X),a(ue);var fe=r(ue,2),ke=t(fe),Ve=r(t(ke),2);let ye;var Oe=t(Ve),U=t(Oe);{var he=c=>{var v=Gc(),A=t(v),ee=t(A,!0);a(A);var Ce=r(A,2),me=t(Ce,!0);a(Ce),a(v),g(()=>{l(ee,(e(u),n(()=>e(u).icon))),l(me,(e(u),n(()=>e(u).name)))}),i(c,v)},Ze=c=>{var v=Mc();i(c,v)};m(U,c=>{e(u)&&e(E)?c(he):c(Ze,!1)})}Xa(2),a(Oe);var K=r(Oe,2);ma(K,5,()=>V,c=>c.id,(c,v)=>{var A=Rc();let ee;var Ce=t(A),me=t(Ce,!0);a(Ce);var te=r(Ce,2),Ke=t(te),f=t(Ke,!0);a(Ke),a(te),a(A),g(k=>{ee=W(A,1,"dropdown-option",null,ee,k),l(me,(e(v),n(()=>e(v).icon))),l(f,(e(v),n(()=>e(v).name)))},[()=>({selected:e(E)===e(v).id})]),q("click",A,()=>G(e(v))),i(c,A)}),a(K),a(Ve),a(ke);var je=r(ke,2),we=r(t(je),2);let na;var ia=t(we),Aa=t(ia);{var ha=c=>{var v=Oc(),A=t(v),ee=t(A,!0);a(A),a(v),g(()=>l(ee,(e(h),n(()=>e(h).name)))),i(c,v)},Pe=c=>{var v=Vc();i(c,v)};m(Aa,c=>{e(h)&&e(w)?c(ha):c(Pe,!1)})}Xa(2),a(ia);var ca=r(ia,2);ma(ca,5,()=>e(D),c=>c.id,(c,v)=>{var A=Uc();let ee;var Ce=t(A),me=t(Ce),te=t(me,!0);a(me),a(Ce),a(A),g(Ke=>{ee=W(A,1,"dropdown-option",null,ee,Ke),l(te,(e(v),n(()=>e(v).name)))},[()=>({selected:e(w)===e(v).id})]),q("click",A,()=>H(e(v))),i(c,A)}),a(ca),a(we),a(je);var va=r(je,2);{var Ie=c=>{var v=Wc();q("click",v,M),i(c,v)};m(va,c=>{(e(_)||e(E)||e(w))&&c(Ie)})}a(fe),a(xe),a(de);var Ge=r(de,2),Me=t(Ge);{var Z=c=>{var v=Yc();i(c,v)},J=c=>{var v=Ta(),A=da(v);{var ee=me=>{var te=av();ma(te,5,()=>e(y),Ke=>Ke.id,(Ke,f)=>{var k=ev(),oe=t(k),Te=t(oe),Ue=t(Te),F=t(Ue);{var Ae=ra=>{var ae=kt();g(()=>l(ae,(e(f),n(()=>e(f).number)))),i(ra,ae)};m(F,ra=>{e(f),n(()=>e(f).number)&&ra(Ae)})}var Qe=r(F);a(Ue),a(Te);var We=r(Te,2),Xe=t(We);a(We),a(oe);var $a=r(oe,2),xa=t($a);{var ie=ra=>{var ae=Hc(),Re=r(t(ae),2),Y=t(Re,!0);a(Re),a(ae),g(()=>l(Y,(e(f),n(()=>e(f).email)))),i(ra,ae)};m(xa,ra=>{e(f),n(()=>e(f).email)&&ra(ie)})}var x=r(xa,2);{var le=ra=>{var ae=Jc(),Re=r(t(ae),2),Y=t(Re,!0);a(Re),a(ae),g(Se=>l(Y,Se),[()=>(e(f),n(()=>V.find(Se=>Se.id===e(f).gradeLevel)?.name||e(f).gradeLevel))]),i(ra,ae)};m(x,ra=>{e(f),n(()=>e(f).gradeLevel&&e(f).gradeLevel!=="Not specified")&&ra(le)})}var Le=r(x,2);{var pa=ra=>{var ae=Bc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(Se=>l(Y,`Section: ${Se??""}`),[()=>(e(D),e(f),n(()=>e(D).find(Se=>Se.id===e(f).section)?.name||e(f).section))]),i(ra,ae)};m(Le,ra=>{e(f),n(()=>e(f).section&&e(f).section!=="Not specified")&&ra(pa)})}var He=r(Le,2);{var sa=ra=>{var ae=Qc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(Se=>l(Y,`Age: ${Se??""} years old`),[()=>(e(f),n(()=>I(e(f).birthdate)))]),i(ra,ae)};m(He,ra=>{e(f),n(()=>e(f).birthdate&&e(f).birthdate!=="Not specified")&&ra(sa)})}var la=r(He,2);{var Ee=ra=>{var ae=zc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(()=>l(Y,`Guardian: ${e(f),n(()=>e(f).guardian)??""}`)),i(ra,ae)};m(la,ra=>{e(f),n(()=>e(f).guardian&&e(f).guardian!=="Not specified")&&ra(Ee)})}var O=r(la,2);{var Fe=ra=>{var ae=Kc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(()=>l(Y,`Contact: ${e(f),n(()=>e(f).contactNumber)??""}`)),i(ra,ae)};m(O,ra=>{e(f),n(()=>e(f).contactNumber&&e(f).contactNumber!=="Not specified")&&ra(Fe)})}var ea=r(O,2);{var qa=ra=>{var ae=Zc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(()=>l(Y,`Address: ${e(f),n(()=>e(f).address)??""}`)),i(ra,ae)};m(ea,ra=>{e(f),n(()=>e(f).address&&e(f).address!=="Not specified")&&ra(qa)})}var Ia=r(ea,2);{var st=ra=>{var ae=Xc(),Re=r(t(ae),2),Y=t(Re);a(Re),a(ae),g(Se=>l(Y,`Birthdate: ${Se??""}`),[()=>(e(f),n(()=>re(e(f).birthdate)))]),i(ra,ae)};m(Ia,ra=>{e(f),n(()=>e(f).birthdate&&e(f).birthdate!=="Not specified")&&ra(st)})}a($a),a(k),g(()=>l(Qe,` · ${e(f),n(()=>e(f).name)??""}`)),q("click",Xe,()=>R(e(f).id,e(f).name)),i(Ke,k)}),a(te),i(me,te)},Ce=me=>{var te=sv(),Ke=t(te),f=t(Ke,!0);a(Ke);var k=r(Ke,2),oe=t(k);{var Te=Qe=>{var We=kt("No students found matching your search criteria.");i(Qe,We)},Ue=Qe=>{var We=kt("No students found in the system.");i(Qe,We)};m(oe,Qe=>{e(_)||e(E)||e(w)?Qe(Te):Qe(Ue,!1)})}a(k);var F=r(k,2);{var Ae=Qe=>{var We=tv();q("click",We,M),i(Qe,We)};m(F,Qe=>{(e(_)||e(E)||e(w))&&Qe(Ae)})}a(te),g(()=>l(f,e(_)||e(E)||e(w)?"search_off":"school")),i(me,te)};m(A,me=>{e(y),n(()=>e(y).length>0)?me(ee):me(Ce,!1)},!0)}i(c,v)};m(Me,c=>{e(S)?c(Z):c(J,!1)})}a(Ge),a(B),g((c,v)=>{ye=W(Ve,1,"custom-dropdown",null,ye,c),na=W(we,1,"custom-dropdown",null,na,v)},[()=>({open:e($)}),()=>({open:e(P)})]),Za(qe,()=>e(_),c=>s(_,c)),q("click",Oe,pe),q("click",ia,N),i(z,B),It()}var nv=o('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),ov=o('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),lv=o('<span class="aas-placeholder">All Grade Levels</span>'),dv=o('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),cv=o('<div class="aas-selected-option"><span class="aas-option-name"> </span></div>'),vv=o('<span class="aas-placeholder">All Sections</span>'),uv=o('<button type="button"><div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),mv=o('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),pv=o('<div class="aas-loading-container"><span class="aas-student-loader"></span> <p class="aas-loading-text">Loading archived students...</p></div>'),fv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),_v=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),gv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),bv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),hv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),yv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),wv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Sv=o('<div class="aas-account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),xv=o('<div class="aas-account-card"><div class="aas-account-card-header"><div class="aas-account-title"><h3 class="aas-account-name"><!> </h3> <div class="aas-archived-badge"><span class="material-symbols-outlined">archive</span> <span> </span></div></div> <div class="aas-action-buttons"><button type="button" class="aas-restore-button" title="Restore Student"><span class="material-symbols-outlined">unarchive</span></button></div></div> <div class="aas-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),kv=o('<div class="aas-students-grid"></div>'),Av=o('<button type="button" class="aas-clear-search-button-inline">Clear</button>'),Dv=o('<div class="aas-no-results"><span class="material-symbols-outlined aas-no-results-icon"> </span> <p><!></p> <!></div>'),Tv=o('<div class="aas-archived-students-container"><div class="aas-admin-student-header"><div class="aas-header-content"><h1 class="aas-page-title">Archived Students</h1> <p class="aas-page-subtitle">View and manage archived student records</p></div></div> <div class="filters-section"><div class="search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search archived students by name, email, or ID..."/> <!></div></div> <div class="filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <!></div></div></div> <div class="aas-students-list-section"><!></div></div>');function Nv(z,d){Pt(d,!1);const u=p(),h=p();let b=[],y=p([]),S=p(!0),_=p(""),E=p(""),w=p(""),$=p(!1),P=p(!1);const V=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let D=p([{id:"",name:"All Sections"}]);async function L(){s(S,!0);try{const v=await Qa.get("/api/archived-students");if(!v.students)throw new Error("No students data received");b=v.students.map(A=>({id:A.id,name:A.name,number:A.number,email:A.email,gradeLevel:A.gradeLevel||"Not specified",section:A.section||"Not specified",birthdate:A.birthdate||"Not specified",address:A.address||"Not specified",guardian:A.guardian||"Not specified",contactNumber:A.contactNumber||"Not specified",archivedDate:A.archivedDate||"Not specified"})),se()}catch(v){console.error("Error loading archived students:",v),ne.error("Failed to load archived students. Please try again."),b=[]}finally{s(S,!1)}}async function T(){try{const v=await Qa.get("/api/sections");if(v.success&&v.data){const A=v.data.map(ee=>({id:ee.name,name:ee.name}));s(D,[{id:"",name:"All Sections"},...A])}}catch(v){console.error("Error loading sections:",v)}}function se(){s(y,b.filter(v=>{const A=!e(_)||v.name.toLowerCase().includes(e(_).toLowerCase())||v.email.toLowerCase().includes(e(_).toLowerCase())||v.number&&v.number.toLowerCase().includes(e(_).toLowerCase()),ee=!e(E)||v.gradeLevel===e(E),Ce=!e(w)||v.section===e(w);return A&&ee&&Ce}))}function pe(){s($,!e($)),s(P,!1)}function N(){s(P,!e(P)),s($,!1)}function G(v){s(E,v.id),s($,!1),se()}function H(v){s(w,v.id),s(P,!1),se()}function I(v){if(!v)return"N/A";const A=new Date,ee=new Date(v);let Ce=A.getFullYear()-ee.getFullYear();const me=A.getMonth()-ee.getMonth();return(me<0||me===0&&A.getDate()<ee.getDate())&&Ce--,Ce}function re(v){return v?new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function M(v){return v?new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}async function C(v,A){es.confirm("Restore Student",`Are you sure you want to restore ${A}? This action will move the student back to the active list.`,async()=>{try{const ee=await Qa.put("/api/archived-students",{id:v});ne.success(ee.message||"Student restored successfully"),await L()}catch(ee){console.error("Error restoring student:",ee),ne.error(ee.message||"Failed to restore student. Please try again.")}},()=>{})}function R(){s(_,""),s(E,""),s(w,""),se()}function B(v){v.target.closest(".aas-custom-dropdown")||(s($,!1),s(P,!1))}Wt(()=>(T(),L(),document.addEventListener("click",B),()=>{document.removeEventListener("click",B)})),Ya(()=>e(E),()=>{s(u,V.find(v=>v.id===e(E)))}),Ya(()=>(e(D),e(w)),()=>{s(h,e(D).find(v=>v.id===e(w)))}),Ya(()=>e(_),()=>{e(_)!==void 0&&se()}),ds(),is();var de=Tv(),xe=r(t(de),2),ue=t(xe),X=t(ue),qe=t(X),be=r(t(qe),2);Ba(be);var _e=r(be,2);{var fe=v=>{var A=nv();q("click",A,()=>s(_,"")),i(v,A)};m(_e,v=>{e(_)&&v(fe)})}a(qe),a(X);var ke=r(X,2),Ve=t(ke),ye=r(t(Ve),2);let Oe;var U=t(ye),he=t(U);{var Ze=v=>{var A=ov(),ee=t(A),Ce=t(ee,!0);a(ee);var me=r(ee,2),te=t(me,!0);a(me),a(A),g(()=>{l(Ce,(e(u),n(()=>e(u).icon))),l(te,(e(u),n(()=>e(u).name)))}),i(v,A)},K=v=>{var A=lv();i(v,A)};m(he,v=>{e(u)&&e(E)?v(Ze):v(K,!1)})}Xa(2),a(U);var je=r(U,2);ma(je,5,()=>V,v=>v.id,(v,A)=>{var ee=dv();let Ce;var me=t(ee),te=t(me,!0);a(me);var Ke=r(me,2),f=t(Ke),k=t(f,!0);a(f),a(Ke),a(ee),g(oe=>{Ce=W(ee,1,"aas-dropdown-option",null,Ce,oe),l(te,(e(A),n(()=>e(A).icon))),l(k,(e(A),n(()=>e(A).name)))},[()=>({selected:e(E)===e(A).id})]),q("click",ee,()=>G(e(A))),i(v,ee)}),a(je),a(ye),a(Ve);var we=r(Ve,2),na=r(t(we),2);let ia;var Aa=t(na),ha=t(Aa);{var Pe=v=>{var A=cv(),ee=t(A),Ce=t(ee,!0);a(ee),a(A),g(()=>l(Ce,(e(h),n(()=>e(h).name)))),i(v,A)},ca=v=>{var A=vv();i(v,A)};m(ha,v=>{e(h)&&e(w)?v(Pe):v(ca,!1)})}Xa(2),a(Aa);var va=r(Aa,2);ma(va,5,()=>e(D),v=>v.id,(v,A)=>{var ee=uv();let Ce;var me=t(ee),te=t(me),Ke=t(te,!0);a(te),a(me),a(ee),g(f=>{Ce=W(ee,1,"aas-dropdown-option",null,Ce,f),l(Ke,(e(A),n(()=>e(A).name)))},[()=>({selected:e(w)===e(A).id})]),q("click",ee,()=>H(e(A))),i(v,ee)}),a(va),a(na),a(we);var Ie=r(we,2);{var Ge=v=>{var A=mv();q("click",A,R),i(v,A)};m(Ie,v=>{(e(_)||e(E)||e(w))&&v(Ge)})}a(ke),a(ue),a(xe);var Me=r(xe,2),Z=t(Me);{var J=v=>{var A=pv();i(v,A)},c=v=>{var A=Ta(),ee=da(A);{var Ce=te=>{var Ke=kv();ma(Ke,5,()=>e(y),f=>f.id,(f,k)=>{var oe=xv(),Te=t(oe),Ue=t(Te),F=t(Ue),Ae=t(F);{var Qe=Se=>{var Je=kt();g(()=>l(Je,(e(k),n(()=>e(k).number)))),i(Se,Je)};m(Ae,Se=>{e(k),n(()=>e(k).number)&&Se(Qe)})}var We=r(Ae);a(F);var Xe=r(F,2),$a=r(t(Xe),2),xa=t($a);a($a),a(Xe),a(Ue);var ie=r(Ue,2),x=t(ie);a(ie),a(Te);var le=r(Te,2),Le=t(le);{var pa=Se=>{var Je=fv(),Be=r(t(Je),2),ge=t(Be,!0);a(Be),a(Je),g(()=>l(ge,(e(k),n(()=>e(k).email)))),i(Se,Je)};m(Le,Se=>{e(k),n(()=>e(k).email)&&Se(pa)})}var He=r(Le,2);{var sa=Se=>{var Je=_v(),Be=r(t(Je),2),ge=t(Be,!0);a(Be),a(Je),g(De=>l(ge,De),[()=>(e(k),n(()=>V.find(De=>De.id===e(k).gradeLevel)?.name||e(k).gradeLevel))]),i(Se,Je)};m(He,Se=>{e(k),n(()=>e(k).gradeLevel&&e(k).gradeLevel!=="Not specified")&&Se(sa)})}var la=r(He,2);{var Ee=Se=>{var Je=gv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(De=>l(ge,`Section: ${De??""}`),[()=>(e(D),e(k),n(()=>e(D).find(De=>De.id===e(k).section)?.name||e(k).section))]),i(Se,Je)};m(la,Se=>{e(k),n(()=>e(k).section&&e(k).section!=="Not specified")&&Se(Ee)})}var O=r(la,2);{var Fe=Se=>{var Je=bv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(De=>l(ge,`Age: ${De??""} years old`),[()=>(e(k),n(()=>I(e(k).birthdate)))]),i(Se,Je)};m(O,Se=>{e(k),n(()=>e(k).birthdate&&e(k).birthdate!=="Not specified")&&Se(Fe)})}var ea=r(O,2);{var qa=Se=>{var Je=hv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(()=>l(ge,`Guardian: ${e(k),n(()=>e(k).guardian)??""}`)),i(Se,Je)};m(ea,Se=>{e(k),n(()=>e(k).guardian&&e(k).guardian!=="Not specified")&&Se(qa)})}var Ia=r(ea,2);{var st=Se=>{var Je=yv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(()=>l(ge,`Contact: ${e(k),n(()=>e(k).contactNumber)??""}`)),i(Se,Je)};m(Ia,Se=>{e(k),n(()=>e(k).contactNumber&&e(k).contactNumber!=="Not specified")&&Se(st)})}var ra=r(Ia,2);{var ae=Se=>{var Je=wv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(()=>l(ge,`Address: ${e(k),n(()=>e(k).address)??""}`)),i(Se,Je)};m(ra,Se=>{e(k),n(()=>e(k).address&&e(k).address!=="Not specified")&&Se(ae)})}var Re=r(ra,2);{var Y=Se=>{var Je=Sv(),Be=r(t(Je),2),ge=t(Be);a(Be),a(Je),g(De=>l(ge,`Birthdate: ${De??""}`),[()=>(e(k),n(()=>re(e(k).birthdate)))]),i(Se,Je)};m(Re,Se=>{e(k),n(()=>e(k).birthdate&&e(k).birthdate!=="Not specified")&&Se(Y)})}a(le),a(oe),g(Se=>{l(We,` · ${e(k),n(()=>e(k).name)??""}`),l(xa,`Archived ${Se??""}`)},[()=>(e(k),n(()=>M(e(k).archivedDate)))]),q("click",x,()=>C(e(k).id,e(k).name)),i(f,oe)}),a(Ke),i(te,Ke)},me=te=>{var Ke=Dv(),f=t(Ke),k=t(f,!0);a(f);var oe=r(f,2),Te=t(oe);{var Ue=We=>{var Xe=kt("No archived students found matching your search criteria.");i(We,Xe)},F=We=>{var Xe=kt("No archived students found in the system.");i(We,Xe)};m(Te,We=>{e(_)||e(E)||e(w)?We(Ue):We(F,!1)})}a(oe);var Ae=r(oe,2);{var Qe=We=>{var Xe=Av();q("click",Xe,R),i(We,Xe)};m(Ae,We=>{(e(_)||e(E)||e(w))&&We(Qe)})}a(Ke),g(()=>l(k,e(_)||e(E)||e(w)?"search_off":"archive")),i(te,Ke)};m(ee,te=>{e(y),n(()=>e(y).length>0)?te(Ce):te(me,!1)},!0)}i(v,A)};m(Z,v=>{e(S)?v(J):v(c,!1)})}a(Me),a(de),g((v,A)=>{Oe=W(ye,1,"aas-custom-dropdown",null,Oe,v),ia=W(na,1,"aas-custom-dropdown",null,ia,A)},[()=>({open:e($)}),()=>({open:e(P)})]),Za(be,()=>e(_),v=>s(_,v)),q("click",U,pe),q("click",Aa,N),i(z,de),It()}var jv=o('<button type="button" class="sgl-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),$v=o('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),Cv=o('<span class="sgl-placeholder">All Grade Levels</span>'),qv=o('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Ev=o('<div class="sgl-selected-option"><span class="sgl-option-name"> </span></div>'),Fv=o('<span class="sgl-placeholder">All Sections</span>'),Lv=o('<button type="button"><div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Pv=o('<button type="button" class="sgl-clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Iv=o('<div class="sgl-masterlist-loading-container"><span class="sgl-student-loader"></span> <p class="sgl-masterlist-loading-text">Loading student grades...</p></div>'),Gv=o('<div class="sgl-empty-state"><span class="material-symbols-outlined sgl-empty-icon">search_off</span> <h3 class="sgl-empty-title">No students found</h3> <p class="sgl-empty-description"><!></p></div>'),Mv=o('<tr><td class="sgl-student-id"> </td><td class="sgl-student-name"> </td><td class="sgl-year-level"> </td><td class="sgl-section"> </td><td class="sgl-gwa"> </td></tr>'),Rv=o('<div class="sgl-results-header"><p class="sgl-results-count"> </p></div> <div class="sgl-table-container"><table class="sgl-students-table"><thead><tr><th>Student ID</th><th>Name</th><th>Grade Level</th><th>Section</th><th>GWA</th></tr></thead><tbody></tbody></table></div>',1),Ov=o('<div class="sgl-student-grades-container"><div class="sgl-admin-student-header"><div class="sgl-header-content"><h1 class="sgl-page-title">Student Grades List</h1> <p class="sgl-page-subtitle">View and manage student academic performance records</p></div></div> <div class="sgl-filters-section"><div class="sgl-search-filter-container"><div class="sgl-search-container"><div class="sgl-search-input-wrapper"><span class="material-symbols-outlined sgl-search-icon">search</span> <input type="text" class="sgl-search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="sgl-filter-container"><div class="sgl-filter-group"><label class="sgl-filter-label">Grade Level</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label">Section</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <!></div></div></div> <div class="sgl-results-section"><!></div></div>');function Vv(z,d){Pt(d,!1);const u=p(),h=p();let b=p([]),y=p([]),S=[],_=p(!0),E=p(""),w=p(""),$=p(""),P=p(!1),V=p(!1);const D=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let L=p([{id:"",name:"All Sections"}]);async function T(){try{const c=await Qa.get("/api/sections");c.success&&(S=c.data,s(L,[{id:"",name:"All Sections"},...S.map(v=>({id:v.name,name:`Section ${v.name} (Grade ${v.grade_level})`}))]))}catch(c){console.error("Error loading sections:",c),ne.error("Failed to load sections")}}async function se(){s(_,!0);try{const c=await Qa.get("/api/students-bulk");if(!c.success)throw new Error("Failed to load students");s(b,c.students),pe()}catch(c){console.error("Error loading students:",c),ne.error("Failed to load students. Please try again."),s(b,[])}finally{s(_,!1)}}function pe(){s(y,e(b).filter(c=>{const v=!e(E)||c.name.toLowerCase().includes(e(E).toLowerCase())||c.id.toString().toLowerCase().includes(e(E).toLowerCase()),A=!e(w)||c.gradeLevel===e(w),ee=!e($)||c.section===e($);return v&&A&&ee}))}function N(){s(P,!e(P)),s(V,!1)}function G(){s(V,!e(V)),s(P,!1)}function H(c){s(w,c.id),s(P,!1),pe()}function I(c){s($,c.id),s(V,!1),pe()}function re(){pe()}function M(){s(E,""),s(w,""),s($,""),pe()}function C(c){return{7:"Grade 7",8:"Grade 8",9:"Grade 9",10:"Grade 10"}[c]||c}function R(c){c.target.closest(".sgl-custom-dropdown")||(s(P,!1),s(V,!1))}Wt(async()=>(await T(),await se(),document.addEventListener("click",R),()=>{document.removeEventListener("click",R)})),Ya(()=>e(w),()=>{s(u,D.find(c=>c.id===e(w)))}),Ya(()=>(e(L),e($)),()=>{s(h,e(L).find(c=>c.id===e($)))}),Ya(()=>e(E),()=>{e(E)!==void 0&&re()}),ds(),is();var B=Ov(),de=r(t(B),2),xe=t(de),ue=t(xe),X=t(ue),qe=r(t(X),2);Ba(qe);var be=r(qe,2);{var _e=c=>{var v=jv();q("click",v,()=>s(E,"")),i(c,v)};m(be,c=>{e(E)&&c(_e)})}a(X),a(ue);var fe=r(ue,2),ke=t(fe),Ve=r(t(ke),2);let ye;var Oe=t(Ve),U=t(Oe);{var he=c=>{var v=$v(),A=t(v),ee=t(A,!0);a(A);var Ce=r(A,2),me=t(Ce,!0);a(Ce),a(v),g(()=>{l(ee,(e(u),n(()=>e(u).icon))),l(me,(e(u),n(()=>e(u).name)))}),i(c,v)},Ze=c=>{var v=Cv();i(c,v)};m(U,c=>{e(u)&&e(w)?c(he):c(Ze,!1)})}Xa(2),a(Oe);var K=r(Oe,2);ma(K,5,()=>D,c=>c.id,(c,v)=>{var A=qv();let ee;var Ce=t(A),me=t(Ce,!0);a(Ce);var te=r(Ce,2),Ke=t(te),f=t(Ke,!0);a(Ke),a(te),a(A),g(k=>{ee=W(A,1,"sgl-dropdown-option",null,ee,k),l(me,(e(v),n(()=>e(v).icon))),l(f,(e(v),n(()=>e(v).name)))},[()=>({selected:e(w)===e(v).id})]),q("click",A,()=>H(e(v))),i(c,A)}),a(K),a(Ve),a(ke);var je=r(ke,2),we=r(t(je),2);let na;var ia=t(we),Aa=t(ia);{var ha=c=>{var v=Ev(),A=t(v),ee=t(A,!0);a(A),a(v),g(()=>l(ee,(e(h),n(()=>e(h).name)))),i(c,v)},Pe=c=>{var v=Fv();i(c,v)};m(Aa,c=>{e(h)&&e($)?c(ha):c(Pe,!1)})}Xa(2),a(ia);var ca=r(ia,2);ma(ca,5,()=>e(L),c=>c.id,(c,v)=>{var A=Lv();let ee;var Ce=t(A),me=t(Ce),te=t(me,!0);a(me),a(Ce),a(A),g(Ke=>{ee=W(A,1,"sgl-dropdown-option",null,ee,Ke),l(te,(e(v),n(()=>e(v).name)))},[()=>({selected:e($)===e(v).id})]),q("click",A,()=>I(e(v))),i(c,A)}),a(ca),a(we),a(je);var va=r(je,2);{var Ie=c=>{var v=Pv();q("click",v,M),i(c,v)};m(va,c=>{(e(E)||e(w)||e($))&&c(Ie)})}a(fe),a(xe),a(de);var Ge=r(de,2),Me=t(Ge);{var Z=c=>{var v=Iv();i(c,v)},J=c=>{var v=Ta(),A=da(v);{var ee=me=>{var te=Gv(),Ke=r(t(te),4),f=t(Ke);{var k=Te=>{var Ue=kt("Try adjusting your search criteria or filters.");i(Te,Ue)},oe=Te=>{var Ue=kt("No student records are available at the moment.");i(Te,Ue)};m(f,Te=>{e(E)||e(w)||e($)?Te(k):Te(oe,!1)})}a(Ke),a(te),i(me,te)},Ce=me=>{var te=Rv(),Ke=da(te),f=t(Ke),k=t(f);a(f),a(Ke);var oe=r(Ke,2),Te=t(oe),Ue=r(t(Te));ma(Ue,5,()=>e(y),F=>F.id,(F,Ae)=>{var Qe=Mv();let We;var Xe=t(Qe),$a=t(Xe,!0);a(Xe);var xa=r(Xe),ie=t(xa,!0);a(xa);var x=r(xa),le=t(x,!0);a(x);var Le=r(x),pa=t(Le,!0);a(Le);var He=r(Le),sa=t(He);a(He),a(Qe),g((la,Ee,O)=>{We=W(Qe,1,"sgl-student-row",null,We,la),l($a,(e(Ae),n(()=>e(Ae).id))),l(ie,(e(Ae),n(()=>e(Ae).name))),l(le,Ee),l(pa,(e(Ae),n(()=>e(Ae).section))),l(sa,`${O??""}%`)},[()=>({"low-gwa":e(Ae).gwa<75}),()=>(e(Ae),n(()=>C(e(Ae).gradeLevel))),()=>(e(Ae),n(()=>e(Ae).gwa.toFixed(1)))]),i(F,Qe)}),a(Ue),a(Te),a(oe),g(()=>l(k,`Showing ${e(y),n(()=>e(y).length)??""} of ${e(b),n(()=>e(b).length)??""} students`)),i(me,te)};m(A,me=>{e(y),n(()=>e(y).length===0)?me(ee):me(Ce,!1)},!0)}i(c,v)};m(Me,c=>{e(_)?c(Z):c(J,!1)})}a(Ge),a(B),g((c,v)=>{ye=W(Ve,1,"sgl-custom-dropdown",null,ye,c),na=W(we,1,"sgl-custom-dropdown",null,na,v)},[()=>({open:e(P)}),()=>({open:e(V)})]),Za(qe,()=>e(E),c=>s(E,c)),q("click",Oe,N),q("click",ia,G),i(z,B),It()}var Uv=o('<label class="time-input-label svelte-5q82b2"> </label>'),Wv=o('<span class="time-display svelte-5q82b2"> </span>'),Yv=o('<span class="time-placeholder svelte-5q82b2"> </span>'),Hv=o('<button type="button"> </button>'),Jv=o('<button type="button"> </button>'),Bv=o('<button type="button"> </button>'),Qv=o('<div class="time-dropdown-menu svelte-5q82b2"><div class="time-section svelte-5q82b2"><div class="time-section-header svelte-5q82b2">Hour</div> <div class="time-options svelte-5q82b2"></div></div> <div class="time-section svelte-5q82b2"><div class="time-section-header svelte-5q82b2">Minute</div> <div class="time-options svelte-5q82b2"></div></div> <div class="time-section svelte-5q82b2"><div class="time-section-header svelte-5q82b2">Period</div> <div class="time-options svelte-5q82b2"></div></div></div>'),zv=o('<div class="time-input-container svelte-5q82b2"><!> <button type="button"><!> <span class="material-symbols-outlined time-dropdown-arrow svelte-5q82b2">expand_more</span></button> <!></div>');function Qr(z,d){Pt(d,!1);const u=p();let h=xt(d,"value",8,""),b=xt(d,"placeholder",8,"Select time"),y=xt(d,"disabled",8,!1),S=xt(d,"label",8,"");const _=oi();let E=p(""),w=p(""),$=p("AM"),P=p(!1);const V=Array.from({length:12},(_e,fe)=>{const ke=fe+1;return{value:ke.toString().padStart(2,"0"),label:ke.toString()}}),D=[{value:"00",label:"00"},{value:"15",label:"15"},{value:"30",label:"30"},{value:"45",label:"45"}],L=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}];function T(_e){if(!_e){s(E,""),s(w,""),s($,"AM");return}const fe=_e.split(":");let ke=parseInt(fe[0]);const Ve=fe[1]||"00";ke===0?(s(E,"12"),s($,"AM")):ke<12?(s(E,ke.toString().padStart(2,"0")),s($,"AM")):ke===12?(s(E,"12"),s($,"PM")):(s(E,(ke-12).toString().padStart(2,"0")),s($,"PM")),s(w,Ve)}function se(){if(!e(E)||!e(w))return"";let _e=parseInt(e(E));return e($)==="AM"&&_e===12?_e=0:e($)==="PM"&&_e!==12&&(_e+=12),`${_e.toString().padStart(2,"0")}:${e(w)}`}function pe(){const _e=se();_e!==h()&&_("change",{value:_e})}function N(_e){s(E,_e),pe()}function G(_e){s(w,_e),pe()}function H(_e){s($,_e),pe()}function I(){y()||s(P,!e(P))}function re(_e){_e.target.closest(".time-input-container")||s(P,!1)}Ya(()=>Zt(h()),()=>{h()&&h()!==se()&&T(h())}),Ya(()=>(e(E),e(w),e($)),()=>{s(u,e(E)&&e(w)?`${e(E)}:${e(w)} ${e($)}`:"")}),ds(),is();var M=zv();q("click",Fs,re);var C=t(M);{var R=_e=>{var fe=Uv(),ke=t(fe,!0);a(fe),g(()=>l(ke,S())),i(_e,fe)};m(C,_e=>{S()&&_e(R)})}var B=r(C,2);let de;var xe=t(B);{var ue=_e=>{var fe=Wv(),ke=t(fe,!0);a(fe),g(()=>l(ke,e(u))),i(_e,fe)},X=_e=>{var fe=Yv(),ke=t(fe,!0);a(fe),g(()=>l(ke,b())),i(_e,fe)};m(xe,_e=>{e(u)?_e(ue):_e(X,!1)})}Xa(2),a(B);var qe=r(B,2);{var be=_e=>{var fe=Qv(),ke=t(fe),Ve=r(t(ke),2);ma(Ve,5,()=>V,Xt,(Ze,K)=>{var je=Hv();let we;var na=t(je,!0);a(je),g(ia=>{we=W(je,1,"time-option svelte-5q82b2",null,we,ia),l(na,(e(K),n(()=>e(K).label)))},[()=>({selected:e(E)===e(K).value})]),q("click",je,()=>N(e(K).value)),i(Ze,je)}),a(Ve),a(ke);var ye=r(ke,2),Oe=r(t(ye),2);ma(Oe,5,()=>D,Xt,(Ze,K)=>{var je=Jv();let we;var na=t(je,!0);a(je),g(ia=>{we=W(je,1,"time-option svelte-5q82b2",null,we,ia),l(na,(e(K),n(()=>e(K).label)))},[()=>({selected:e(w)===e(K).value})]),q("click",je,()=>G(e(K).value)),i(Ze,je)}),a(Oe),a(ye);var U=r(ye,2),he=r(t(U),2);ma(he,5,()=>L,Xt,(Ze,K)=>{var je=Bv();let we;var na=t(je,!0);a(je),g(ia=>{we=W(je,1,"time-option svelte-5q82b2",null,we,ia),l(na,(e(K),n(()=>e(K).label)))},[()=>({selected:e($)===e(K).value})]),q("click",je,()=>H(e(K).value)),i(Ze,je)}),a(he),a(U),a(fe),i(_e,fe)};m(qe,_e=>{e(P)&&_e(be)})}a(M),g(_e=>{de=W(B,1,"time-input-trigger svelte-5q82b2",null,de,_e),B.disabled=y()},[()=>({open:e(P),selected:e(u),disabled:y()})]),q("click",B,I),i(z,M),It()}var Kv=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span></div></div>'),Zv=o('<span class="placeholder">Select year level</span>'),Xv=o('<button type="button"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),eu=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span></div></div>'),au=o('<span class="placeholder"> </span>'),tu=o('<div class="admin-section-loading"><span class="section-loader"></span> <span>Loading sections...</span></div>'),su=o('<button type="button"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),ru=o('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text">No sections available</span></div>'),iu=o('<div class="scheduleassign-time-error"><span class="material-symbols-outlined">error</span> <span> </span></div>'),nu=o('<div class="scheduleassign-time-duration"><span class="material-symbols-outlined">schedule</span> <span> </span></div>'),ou=o('<label class="scheduleassign-day-checkbox"><input type="checkbox"/> <span class="scheduleassign-checkbox-label"> </span></label>'),lu=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon"> </span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),du=o('<span class="scheduleassign-placeholder">Select Schedule Type</span>'),cu=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),vu=o('<span class="scheduleassign-placeholder">Select Subject</span>'),uu=o('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading subjects...</span></div>'),mu=o('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),pu=o('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No subjects available</span></div>'),fu=o('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Subject</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),_u=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),gu=o('<span class="scheduleassign-placeholder">Select Activity Type</span>'),bu=o('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading activity types...</span></div>'),hu=o('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),yu=o('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No activity types available</span></div>'),wu=o('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Activity Type</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),Su=o('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),xu=o('<span class="scheduleassign-placeholder">Select Teacher</span>'),ku=o('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading teachers...</span></div>'),Au=o('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),Du=o('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No teachers available</span></div>'),Tu=o('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Teacher</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),Nu=o('<div class="scheduleassign-add-form" id="addScheduleForm"><h4 class="scheduleassign-form-title">Add New Schedule</h4> <div class="scheduleassign-form-inputs"><div class="scheduleassign-time-section"><div class="scheduleassign-time-row"><div class="scheduleassign-input-group"><!></div> <div class="scheduleassign-input-group"><!></div></div> <div class="scheduleassign-time-info-container"><!></div> <div class="scheduleassign-day-selection-section"><div class="scheduleassign-day-checkboxes"></div></div></div> <div class="scheduleassign-type-subject-row"><div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Schedule Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-schedule-type-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Subject</span></div></button> <button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Activity</span></div></button></div></div></div> <!> <!></div></div> <div class="scheduleassign-form-actions"><button type="button" class="scheduleassign-save-schedule-btn"><span class="material-symbols-outlined">save</span> </button></div></div>'),ju=o('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">person</span> <span class="scheduleassign-detail-text"> </span></div>'),$u=o('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">schedule</span> <span class="scheduleassign-detail-text"> </span></div>'),Cu=o('<span class="scheduleassign-room-details"> </span>'),qu=o('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">location_on</span> <span class="scheduleassign-detail-text"> <!></span></div>'),Eu=o('<div class="scheduleassign-assignment-card"><div class="scheduleassign-assignment-header"><div class="scheduleassign-assignment-info"><h4 class="scheduleassign-assignment-title"> </h4> <p class="scheduleassign-assignment-subtitle"> </p></div> <div class="scheduleassign-assignment-actions"><button type="button" class="scheduleassign-delete-button" title="Delete assignment"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="scheduleassign-assignment-details"><!> <!> <!></div></div>'),Fu=o('<div class="scheduleassign-empty-day"><span class="material-symbols-outlined empty-icon">event_available</span> <span class="empty-text">No schedules</span></div>'),Lu=o('<div class="scheduleassign-day-column"><div class="scheduleassign-day-header"><span class="day-name"> </span></div> <div class="scheduleassign-day-schedules"><!></div></div>'),Pu=o('<div class="scheduleassign-schedule-grid"><div class="scheduleassign-schedule-actions"><a href="#addScheduleForm" class="scheduleassign-add-schedule-link"><button type="button"><span class="material-symbols-outlined"> </span> </button></a></div> <!> <div class="scheduleassign-days-grid"></div></div>'),Iu=o('<div class="scheduleassign-empty-state-main"><span class="material-symbols-outlined empty-icon">calendar_month</span> <h3>Select Year Level and Section</h3> <p>Choose a year level and section to view the weekly schedule.</p></div>'),Gu=o('<div class="scheduleassign-form-section"><div class="scheduleassign-section-header"><h2 class="admin-section-title">Schedule Management</h2> <p class="scheduleassign-form-instruction">Select year level and section to view all schedule assignments.</p></div> <form><div class="scheduleassign-hierarchical-form"><div class="scheduleassign-selection-row"><div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-year">Year Level *</label> <div><button type="button" id="form-year"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"></div></div></div> <div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-section">Section *</label> <div><button type="button" id="form-section"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search sections..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div></div> <!></div></form></div>');function Mu(z,d){Pt(d,!1);const u=p(),h=p(),b=p(),y=p(),S=p(),_=p(),E=p(),w=[];let $=p(""),P=p(""),V=p(!1),D=p(!1),L=p(""),T=p(!1);const se=[{id:"grade-7",name:"Grade 7",description:"Junior High School - First Year"},{id:"grade-8",name:"Grade 8",description:"Junior High School - Second Year"},{id:"grade-9",name:"Grade 9",description:"Junior High School - Third Year"},{id:"grade-10",name:"Grade 10",description:"Junior High School - Fourth Year"}],pe=[{id:"monday",name:"Monday"},{id:"tuesday",name:"Tuesday"},{id:"wednesday",name:"Wednesday"},{id:"thursday",name:"Thursday"},{id:"friday",name:"Friday"}];let N=p([]);async function G(){s(T,!0);try{const Re=await(await fetch("/api/sections?action=available-sections")).json();Re.success&&s(N,Re.data.map(Y=>({id:Y._id,name:Y.name,grade:`Grade ${Y.grade_level}`,year:`grade-${Y.grade_level}`,grade_level:Y.grade_level,school_year:Y.school_year,status:Y.status})))}catch(ae){console.error("Error loading sections:",ae)}finally{s(T,!1)}}let H=p([]),I=p(!1),re=p(!1),M=p([]),C=p({startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""}),R=p([]),B=p([]),de=p([]),xe=p(!1),ue=p(!1),X=p(!1),qe=p(!1),be=p(!1),_e=p(!1),fe=p(!1),ke=p(""),Ve=p("");function ye(){const ae=e(C).startTime,Re=e(C).endTime;if(!ae||!Re){s(ke,""),s(Ve,"");return}const Y=Oe(ae),Se=Oe(Re);if(Se<=Y)s(ke,"End time must be after start time"),s(Ve,"");else{s(ke,"");const Je=Se-Y,Be=Math.floor(Je/60),ge=Je%60;Be>0&&ge>0?s(Ve,`${Be} hour${Be>1?"s":""} and ${ge} minute${ge>1?"s":""}`):Be>0?s(Ve,`${Be} hour${Be>1?"s":""}`):s(Ve,`${ge} minute${ge>1?"s":""}`)}}function Oe(ae){const[Re,Y]=ae.split(":").map(Number);return Re*60+Y}function U(ae){if(!ae)return 0;const[Re,Y]=ae.split(" "),[Se,Je]=Re.split(":").map(Number);let Be=Je;return Y==="PM"&&Se!==12?Be+=(Se+12)*60:Y==="AM"&&Se===12?Be+=0:Be+=Se*60,Be}function he(ae){ae.target.closest(".scheduleassign-custom-dropdown")||(s(V,!1),s(D,!1),s(qe,!1),s(be,!1),s(_e,!1))}function Ze(){s(V,!e(V))}function K(){e($)&&s(D,!e(D))}function je(ae){s($,ae?ae.id:""),s(P,""),s(V,!1)}function we(ae){s(P,ae?ae.id:""),s(D,!1),s(R,[]),fs(C,e(C).subjectId="")}function na(ae){if(!ae)return"";const Re=ae.split(":");let Y=parseInt(Re[0]);const Se=Re[1],Je=Y>=12?"PM":"AM";Y=Y%12,Y=Y||12;const Be=Se.startsWith("0")&&Se!=="00"?Se.substring(1):Se;return Be==="00"?`${Y}:00 ${Je}`:`${Y}:${Be} ${Je}`}async function ia(){try{const Re=await(await fetch("/api/schedules")).json();Re.success?s(H,Re.data.map(Y=>({id:Y.id,year:`grade-${Y.grade_level}`,grade:`Grade ${Y.grade_level}`,section:Y.section_name,day:Y.day_of_week.charAt(0).toUpperCase()+Y.day_of_week.slice(1),time:`${na(Y.start_time)} - ${na(Y.end_time)}`,subject:Y.subject_name||Y.activity_type_name,teacher:Y.teacher_name,type:Y.schedule_type,startTime:na(Y.start_time),endTime:na(Y.end_time),subjectId:Y.subject_id,activityTypeId:Y.activity_type_id,teacherId:Y.teacher_id,sectionId:Y.section_id,schoolYear:Y.school_year,roomId:Y.room_id,roomName:Y.room_name,roomBuilding:Y.room_building,roomFloor:Y.room_floor}))):console.error("Failed to load schedules:",Re.error)}catch(ae){console.error("Error loading schedules:",ae)}}async function Aa(ae){es.confirm("Delete Assignment","<p>Are you sure you want to delete this schedule assignment?</p>",async()=>{try{const Re=await Qa.delete(`/api/schedules?id=${ae.id}`);Re.success?(s(H,e(H).filter(Y=>Y.id!==ae.id)),s(H,[...e(H)]),setTimeout(()=>me(),0),ne.success(`Assignment for ${ae.subject} has been deleted successfully`)):ne.error(Re.error||"Failed to delete assignment")}catch(Re){console.error("Error deleting assignment:",Re),ne.error("Failed to delete assignment. Please try again.")}},()=>{})}function ha(){s(I,!e(I)),e(I)||Pe()}function Pe(){s(M,[]),s(C,{startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""})}function ca(){s(qe,!e(qe))}function va(){s(be,!e(be))}function Ie(){s(_e,!e(_e))}function Ge(){s(fe,!e(fe))}function Me(ae){fs(C,e(C).subjectId=ae.id),s(qe,!1)}function Z(ae){fs(C,e(C).activityTypeId=ae.id),s(be,!1)}function J(ae){fs(C,e(C).teacherId=ae.id),s(_e,!1)}function c(ae){fs(C,e(C).scheduleType=ae),s(fe,!1),ae==="subject"?fs(C,e(C).activityTypeId=null):fs(C,e(C).subjectId=null)}async function v(){if(!(e(R).length>0)){s(xe,!0);try{const ae=e(N).find(Be=>Be.id===e(P)),Re=ae?ae.grade_level:"",Y=Re?`/api/subjects?action=available-subjects&grade_level=${Re}`:"/api/subjects?action=available-subjects",Je=await(await fetch(Y)).json();Je.success&&s(R,Je.data)}catch(ae){console.error("Error loading subjects:",ae)}finally{s(xe,!1)}}}async function A(){if(!(e(B).length>0)){s(ue,!0);try{const Re=await(await fetch("/api/activity-types?action=available-activity-types")).json();Re.success&&s(B,Re.data)}catch(ae){console.error("Error loading activity types:",ae)}finally{s(ue,!1)}}}async function ee(){if(!(e(de).length>0)){s(X,!0);try{const Re=await(await fetch("/api/users?action=teachers")).json();Re.success&&s(de,Re.data)}catch(ae){console.error("Error loading teachers:",ae)}finally{s(X,!1)}}}async function Ce(){if(!e(P)||e(M).length===0){ne.error("Please select a section and at least one day");return}if(!e(C).startTime||!e(C).endTime){ne.error("Please enter start and end times");return}if(e(C).scheduleType==="subject"&&!e(C).subjectId){ne.error("Please select a subject");return}if(e(C).scheduleType==="activity"&&!e(C).activityTypeId){ne.error("Please select an activity type");return}s(re,!0);try{const ae=e(M).map(Be=>{const ge=pe.find(De=>De.id===Be)?.name.toLowerCase();return fetch("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sectionId:e(P),dayOfWeek:ge,startTime:e(C).startTime,endTime:e(C).endTime,scheduleType:e(C).scheduleType,subjectId:e(C).scheduleType==="subject"?e(C).subjectId:null,activityTypeId:e(C).scheduleType==="activity"?e(C).activityTypeId:null,teacherId:e(C).teacherId||null,schoolYear:"2024-2025"})})}),Re=await Promise.all(ae),Y=await Promise.all(Re.map(Be=>Be.json())),Se=Y.filter(Be=>!Be.success),Je=Y.filter(Be=>Be.success);if(Je.length>0&&await ia(),Se.length===0)ne.success(`Schedule added successfully for ${e(M).length} day(s)`),Pe(),s(I,!1);else{Je.length>0&&ne.success(`Schedule added successfully for ${Je.length} day(s)`);const Be=Se.filter(De=>De.conflictType==="teacher_conflict"),ge=Se.filter(De=>De.conflictType!=="teacher_conflict");Be.length>0&&Be.forEach(De=>{ne.error(De.error,8e3)}),ge.length>0&&ne.error(`Failed to add schedule for ${ge.length} day(s) due to time conflicts`),Se.length>Be.length+ge.length&&ne.error(`Failed to add schedule for ${Se.length-Be.length-ge.length} day(s)`)}}catch(ae){console.error("Error submitting schedule:",ae),ne.error("Failed to add schedule. Please try again.")}finally{s(re,!1)}}Wt(()=>{G(),ia()}),li(()=>{me()});function me(){if(!e($)||!e(P))return;const ae=document.querySelectorAll(".scheduleassign-day-column");if(ae.length===0)return;let Re=0;ae.forEach(Y=>{const Se=Y.querySelector(".scheduleassign-day-schedules");if(Se){const Je=Se.scrollHeight;Re=Math.max(Re,Je)}}),ae.forEach(Y=>{const Se=Y.querySelector(".scheduleassign-empty-day"),Je=Y.querySelector(".scheduleassign-day-schedules");Se&&Je&&(Je.children.length>1||Je.children.length===1&&!Je.querySelector(".scheduleassign-empty-day")||(Se.style.minHeight=`${Re}px`))})}Ya(()=>e(C),()=>{e(C).startTime&&e(C).endTime?ye():(s(ke,""),s(Ve,""))}),Ya(()=>(e($),e(N)),()=>{s(u,e($)?e(N).filter(ae=>ae.year===e($)):[])}),Ya(()=>(e(u),e(L)),()=>{s(h,e(u).filter(ae=>ae.name.toLowerCase().includes(e(L).toLowerCase())||ae.grade.toLowerCase().includes(e(L).toLowerCase())))}),Ya(()=>e($),()=>{s(b,se.find(ae=>ae.id===e($)))}),Ya(()=>(e(N),e(P)),()=>{s(y,e(N).find(ae=>ae.id===e(P)))}),Ya(()=>(e(H),e($),e(P),e(y)),()=>{s(S,pe.reduce((ae,Re)=>(ae[Re.id]=e(H).filter(Y=>{if(!e($)||!e(P))return!1;const Se=Y.year===e($),Je=Y.section===e(y)?.name,Be=Y.day===Re.name;return Se&&Je&&Be}).sort((Y,Se)=>{const Je=U(Y.startTime),Be=U(Se.startTime);return Je-Be}),ae),{}))}),Ya(()=>e($),()=>{s(_,!!e($))}),Ya(()=>e(P),()=>{s(E,!!e(P))}),Ya(()=>e(I),()=>{e(I)&&(v(),A(),ee())}),ds(),is();var te=Gu();q("click",Fs,he);var Ke=r(t(te),2),f=t(Ke),k=t(f),oe=t(k),Te=r(t(oe),2);let Ue;var F=t(Te);let Ae;var Qe=t(F);{var We=ae=>{var Re=Kv(),Y=r(t(Re),2),Se=t(Y),Je=t(Se,!0);a(Se),a(Y),a(Re),g(()=>l(Je,(e(b),n(()=>e(b).name)))),i(ae,Re)},Xe=ae=>{var Re=Zv();i(ae,Re)};m(Qe,ae=>{e(b)?ae(We):ae(Xe,!1)})}Xa(2),a(F);var $a=r(F,2);ma($a,5,()=>se,ae=>ae.id,(ae,Re)=>{var Y=Xv();let Se;var Je=r(t(Y),2),Be=t(Je),ge=t(Be,!0);a(Be);var De=r(Be,2),ua=t(De,!0);a(De),a(Je),a(Y),g(Pa=>{Se=W(Y,1,"scheduleassign-dropdown-item",null,Se,Pa),l(ge,(e(Re),n(()=>e(Re).name))),l(ua,(e(Re),n(()=>e(Re).description)))},[()=>({selected:e($)===e(Re).id})]),q("click",Y,()=>je(e(Re))),i(ae,Y)}),a($a),a(Te),a(oe);var xa=r(oe,2),ie=r(t(xa),2);let x;var le=t(ie);let Le;var pa=t(le);{var He=ae=>{var Re=eu(),Y=r(t(Re),2),Se=t(Y),Je=t(Se);a(Se),a(Y),a(Re),g(()=>l(Je,`${e(y),n(()=>e(y).grade)??""} · ${e(y),n(()=>e(y).name)??""}`)),i(ae,Re)},sa=ae=>{var Re=au(),Y=t(Re,!0);a(Re),g(()=>l(Y,e($)?"Select section":"Select year level first")),i(ae,Re)};m(pa,ae=>{e(y)?ae(He):ae(sa,!1)})}Xa(2),a(le);var la=r(le,2),Ee=t(la),O=t(Ee);Ba(O),Xa(2),a(Ee);var Fe=r(Ee,2);{var ea=ae=>{var Re=tu();i(ae,Re)},qa=ae=>{var Re=Ta(),Y=da(Re);{var Se=Be=>{var ge=Ta(),De=da(ge);ma(De,1,()=>e(h),ua=>ua.id,(ua,Pa)=>{var et=su();let Ea;var ot=r(t(et),2),mt=t(ot),St=t(mt);a(mt);var Tt=r(mt,2),Ft=t(Tt);a(Tt),a(ot),a(et),g(Ne=>{Ea=W(et,1,"scheduleassign-dropdown-item",null,Ea,Ne),l(St,`${e(Pa),n(()=>e(Pa).grade)??""} · ${e(Pa),n(()=>e(Pa).name)??""}`),l(Ft,`${e(Pa),n(()=>e(Pa).grade)??""} Section`)},[()=>({selected:e(P)===e(Pa).id})]),q("click",et,()=>we(e(Pa))),i(ua,et)}),i(Be,ge)},Je=Be=>{var ge=ru();i(Be,ge)};m(Y,Be=>{e(h),n(()=>e(h).length>0)?Be(Se):Be(Je,!1)},!0)}i(ae,Re)};m(Fe,ae=>{e(T)?ae(ea):ae(qa,!1)})}a(la),a(ie),a(xa),a(k);var Ia=r(k,2);{var st=ae=>{var Re=Pu(),Y=t(Re),Se=t(Y),Je=t(Se);let Be;var ge=t(Je),De=t(ge,!0);a(ge);var ua=r(ge);a(Je),a(Se),a(Y);var Pa=r(Y,2);{var et=ot=>{var mt=Nu(),St=r(t(mt),2),Tt=t(St),Ft=t(Tt),Ne=t(Ft),Ye=t(Ne);Qr(Ye,{label:"Start Time",placeholder:"Select start time",get value(){return e(C).startTime},set value(Ja){fs(C,e(C).startTime=Ja)},$$events:{change:Ja=>fs(C,e(C).startTime=Ja.detail.value)},$$legacy:!0}),a(Ne);var Sa=r(Ne,2),ya=t(Sa);Qr(ya,{label:"End Time",placeholder:"Select end time",get value(){return e(C).endTime},set value(Ja){fs(C,e(C).endTime=Ja)},$$events:{change:Ja=>fs(C,e(C).endTime=Ja.detail.value)},$$legacy:!0}),a(Sa),a(Ft);var aa=r(Ft,2),ta=t(aa);{var ga=Ja=>{var Ca=Ta(),Ra=da(Ca);{var Wa=bt=>{var j=iu(),ve=r(t(j),2),ze=t(ve,!0);a(ve),a(j),g(()=>l(ze,e(ke))),i(bt,j)},at=bt=>{var j=Ta(),ve=da(j);{var ze=ba=>{var ce=nu(),Va=r(t(ce),2),dt=t(Va);a(Va),a(ce),g(()=>l(dt,`Duration: ${e(Ve)??""}`)),i(ba,ce)};m(ve,ba=>{e(Ve)&&ba(ze)},!0)}i(bt,j)};m(Ra,bt=>{e(ke)?bt(Wa):bt(at,!1)})}i(Ja,Ca)};m(ta,Ja=>{e(C),n(()=>e(C).startTime&&e(C).endTime)&&Ja(ga)})}a(aa);var za=r(aa,2),ja=t(za);ma(ja,5,()=>pe,Xt,(Ja,Ca)=>{var Ra=ou(),Wa=t(Ra);Ba(Wa);var at,bt=r(Wa,2),j=t(bt,!0);a(bt),a(Ra),g(()=>{at!==(at=(e(Ca),n(()=>e(Ca).id)))&&(Wa.value=(Wa.__value=(e(Ca),n(()=>e(Ca).id)))??""),l(j,(e(Ca),n(()=>e(Ca).name)))}),pi(w,[],Wa,()=>(e(Ca),n(()=>e(Ca).id),e(M)),ve=>s(M,ve)),i(Ja,Ra)}),a(ja),a(za),a(Tt);var ka=r(Tt,2),Oa=t(ka),lt=r(t(Oa),2),vt=t(lt);let it;var Rt=t(vt);{var ft=Ja=>{var Ca=lu(),Ra=t(Ca),Wa=t(Ra,!0);a(Ra);var at=r(Ra,2),bt=t(at),j=t(bt,!0);a(bt),a(at),a(Ca),g(()=>{l(Wa,(e(C),n(()=>e(C).scheduleType==="subject"?"book":"sports"))),l(j,(e(C),n(()=>e(C).scheduleType==="subject"?"Subject":"Activity")))}),i(Ja,Ca)},$t=Ja=>{var Ca=du();i(Ja,Ca)};m(Rt,Ja=>{e(C),n(()=>e(C).scheduleType)?Ja(ft):Ja($t,!1)})}Xa(2),a(vt);var Mt=r(vt,2);let Q;var $e=t(Mt);let oa;var Fa=r($e,2);let tt;a(Mt),a(lt),a(Oa);var Ga=r(Oa,2);{var fa=Ja=>{var Ca=fu(),Ra=r(t(Ca),2),Wa=t(Ra);let at;var bt=t(Wa);{var j=_a=>{const Ma=qs(()=>(e(R),e(C),n(()=>e(R).find(La=>La.id===e(C).subjectId))));var ct=cu(),rt=r(t(ct),2),Ka=t(rt),wa=t(Ka,!0);a(Ka),a(rt),a(ct),g(()=>l(wa,(Zt(e(Ma)),n(()=>e(Ma)?.name)))),i(_a,ct)},ve=_a=>{var Ma=vu();i(_a,Ma)};m(bt,_a=>{e(C),n(()=>e(C).subjectId)?_a(j):_a(ve,!1)})}Xa(2),a(Wa);var ze=r(Wa,2);let ba;var ce=t(ze);{var Va=_a=>{var Ma=uu();i(_a,Ma)},dt=_a=>{var Ma=Ta(),ct=da(Ma);{var rt=wa=>{var La=Ta(),nt=da(La);ma(nt,1,()=>e(R),Ct=>Ct.id,(Ct,Nt)=>{var Dt=mu();let Gt;var ht=r(t(Dt),2),jt=t(ht),Yt=t(jt,!0);a(jt),a(ht),a(Dt),g(as=>{Gt=W(Dt,1,"scheduleassign-dropdown-option",null,Gt,as),l(Yt,(e(Nt),n(()=>e(Nt).name)))},[()=>({selected:e(C).subjectId===e(Nt).id})]),q("click",Dt,()=>Me(e(Nt))),i(Ct,Dt)}),i(wa,La)},Ka=wa=>{var La=pu();i(wa,La)};m(ct,wa=>{e(R),n(()=>e(R).length>0)?wa(rt):wa(Ka,!1)},!0)}i(_a,Ma)};m(ce,_a=>{e(xe)?_a(Va):_a(dt,!1)})}a(ze),a(Ra),a(Ca),g((_a,Ma)=>{at=W(Wa,1,"scheduleassign-dropdown-trigger",null,at,_a),Wa.disabled=e(xe),ba=W(ze,1,"scheduleassign-dropdown-menu",null,ba,Ma)},[()=>({open:e(qe),selected:e(C).subjectId}),()=>({open:e(qe)})]),q("click",Wa,ca),i(Ja,Ca)},_t=Ja=>{var Ca=wu(),Ra=r(t(Ca),2),Wa=t(Ra);let at;var bt=t(Wa);{var j=_a=>{const Ma=qs(()=>(e(B),e(C),n(()=>e(B).find(La=>La.id===e(C).activityTypeId))));var ct=_u(),rt=r(t(ct),2),Ka=t(rt),wa=t(Ka,!0);a(Ka),a(rt),a(ct),g(()=>l(wa,(Zt(e(Ma)),n(()=>e(Ma)?.name)))),i(_a,ct)},ve=_a=>{var Ma=gu();i(_a,Ma)};m(bt,_a=>{e(C),n(()=>e(C).activityTypeId)?_a(j):_a(ve,!1)})}Xa(2),a(Wa);var ze=r(Wa,2);let ba;var ce=t(ze);{var Va=_a=>{var Ma=bu();i(_a,Ma)},dt=_a=>{var Ma=Ta(),ct=da(Ma);{var rt=wa=>{var La=Ta(),nt=da(La);ma(nt,1,()=>e(B),Ct=>Ct.id,(Ct,Nt)=>{var Dt=hu();let Gt;var ht=r(t(Dt),2),jt=t(ht),Yt=t(jt,!0);a(jt),a(ht),a(Dt),g(as=>{Gt=W(Dt,1,"scheduleassign-dropdown-option",null,Gt,as),l(Yt,(e(Nt),n(()=>e(Nt).name)))},[()=>({selected:e(C).activityTypeId===e(Nt).id})]),q("click",Dt,()=>Z(e(Nt))),i(Ct,Dt)}),i(wa,La)},Ka=wa=>{var La=yu();i(wa,La)};m(ct,wa=>{e(B),n(()=>e(B).length>0)?wa(rt):wa(Ka,!1)},!0)}i(_a,Ma)};m(ce,_a=>{e(ue)?_a(Va):_a(dt,!1)})}a(ze),a(Ra),a(Ca),g((_a,Ma)=>{at=W(Wa,1,"scheduleassign-dropdown-trigger",null,at,_a),Wa.disabled=e(ue),ba=W(ze,1,"scheduleassign-dropdown-menu",null,ba,Ma)},[()=>({open:e(be),selected:e(C).activityTypeId}),()=>({open:e(be)})]),q("click",Wa,va),i(Ja,Ca)};m(Ga,Ja=>{e(C),n(()=>e(C).scheduleType==="subject")?Ja(fa):Ja(_t,!1)})}var pt=r(Ga,2);{var Ha=Ja=>{var Ca=Tu(),Ra=r(t(Ca),2),Wa=t(Ra);let at;var bt=t(Wa);{var j=_a=>{const Ma=qs(()=>(e(de),e(C),n(()=>e(de).find(La=>La.id===e(C).teacherId))));var ct=Su(),rt=r(t(ct),2),Ka=t(rt),wa=t(Ka);a(Ka),a(rt),a(ct),g(()=>l(wa,`${Zt(e(Ma)),n(()=>e(Ma)?.first_name)??""} ${Zt(e(Ma)),n(()=>e(Ma)?.last_name)??""}`)),i(_a,ct)},ve=_a=>{var Ma=xu();i(_a,Ma)};m(bt,_a=>{e(C),n(()=>e(C).teacherId)?_a(j):_a(ve,!1)})}Xa(2),a(Wa);var ze=r(Wa,2);let ba;var ce=t(ze);{var Va=_a=>{var Ma=ku();i(_a,Ma)},dt=_a=>{var Ma=Ta(),ct=da(Ma);{var rt=wa=>{var La=Ta(),nt=da(La);ma(nt,1,()=>e(de),Ct=>Ct.id,(Ct,Nt)=>{var Dt=Au();let Gt;var ht=r(t(Dt),2),jt=t(ht),Yt=t(jt);a(jt),a(ht),a(Dt),g(as=>{Gt=W(Dt,1,"scheduleassign-dropdown-option",null,Gt,as),l(Yt,`${e(Nt),n(()=>e(Nt).first_name)??""} ${e(Nt),n(()=>e(Nt).last_name)??""}`)},[()=>({selected:e(C).teacherId===e(Nt).id})]),q("click",Dt,()=>J(e(Nt))),i(Ct,Dt)}),i(wa,La)},Ka=wa=>{var La=Du();i(wa,La)};m(ct,wa=>{e(de),n(()=>e(de).length>0)?wa(rt):wa(Ka,!1)},!0)}i(_a,Ma)};m(ce,_a=>{e(X)?_a(Va):_a(dt,!1)})}a(ze),a(Ra),a(Ca),g((_a,Ma)=>{at=W(Wa,1,"scheduleassign-dropdown-trigger",null,at,_a),Wa.disabled=e(X),ba=W(ze,1,"scheduleassign-dropdown-menu",null,ba,Ma)},[()=>({open:e(_e),selected:e(C).teacherId}),()=>({open:e(_e)})]),q("click",Wa,Ie),i(Ja,Ca)};m(pt,Ja=>{e(C),n(()=>e(C).scheduleType==="subject")&&Ja(Ha)})}a(ka),a(St);var gt=r(St,2),At=t(gt),Lt=r(t(At));a(At),a(gt),a(mt),g((Ja,Ca,Ra,Wa)=>{it=W(vt,1,"scheduleassign-dropdown-trigger",null,it,Ja),Q=W(Mt,1,"scheduleassign-dropdown-menu",null,Q,Ca),oa=W($e,1,"scheduleassign-dropdown-option",null,oa,Ra),tt=W(Fa,1,"scheduleassign-dropdown-option",null,tt,Wa),At.disabled=(e(re),e(M),n(()=>e(re)||e(M).length===0)),l(Lt,` ${e(re)?"Saving...":"Save Schedule"}`)},[()=>({open:e(fe),selected:e(C).scheduleType}),()=>({open:e(fe)}),()=>({selected:e(C).scheduleType==="subject"}),()=>({selected:e(C).scheduleType==="activity"})]),q("click",vt,Ge),q("click",$e,()=>c("subject")),q("click",Fa,()=>c("activity")),q("click",At,Ce),i(ot,mt)};m(Pa,ot=>{e(I)&&ot(et)})}var Ea=r(Pa,2);ma(Ea,5,()=>pe,ot=>ot.id,(ot,mt)=>{var St=Lu(),Tt=t(St),Ft=t(Tt),Ne=t(Ft,!0);a(Ft),a(Tt);var Ye=r(Tt,2),Sa=t(Ye);{var ya=ta=>{var ga=Ta(),za=da(ga);ma(za,1,()=>(e(S),e(mt),n(()=>e(S)[e(mt).id])),ja=>ja.id,(ja,ka)=>{var Oa=Eu(),lt=t(Oa),vt=t(lt),it=t(vt),Rt=t(it,!0);a(it);var ft=r(it,2),$t=t(ft);a(ft),a(vt);var Mt=r(vt,2),Q=t(Mt);a(Mt),a(lt);var $e=r(lt,2),oa=t($e);{var Fa=pt=>{var Ha=ju(),gt=r(t(Ha),2),At=t(gt,!0);a(gt),a(Ha),g(()=>l(At,(e(ka),n(()=>e(ka).teacher)))),i(pt,Ha)};m(oa,pt=>{e(ka),n(()=>e(ka).teacher)&&pt(Fa)})}var tt=r(oa,2);{var Ga=pt=>{var Ha=$u(),gt=r(t(Ha),2),At=t(gt);a(gt),a(Ha),g(()=>l(At,`${e(ka),n(()=>e(ka).startTime)??""} - ${e(ka),n(()=>e(ka).endTime)??""}`)),i(pt,Ha)};m(tt,pt=>{e(ka),n(()=>e(ka).startTime&&e(ka).endTime)&&pt(Ga)})}var fa=r(tt,2);{var _t=pt=>{var Ha=qu(),gt=r(t(Ha),2),At=t(gt),Lt=r(At);{var Ja=Ca=>{var Ra=Cu(),Wa=t(Ra);a(Ra),g(()=>l(Wa,`(${e(ka),n(()=>e(ka).roomBuilding)??""}${e(ka),n(()=>e(ka).roomFloor?`, Floor ${e(ka).roomFloor}`:"")??""})`)),i(Ca,Ra)};m(Lt,Ca=>{e(ka),n(()=>e(ka).roomBuilding||e(ka).roomFloor)&&Ca(Ja)})}a(gt),a(Ha),g(()=>l(At,`${e(ka),n(()=>e(ka).roomName)??""} `)),i(pt,Ha)};m(fa,pt=>{e(ka),n(()=>e(ka).type==="subject"&&e(ka).roomName)&&pt(_t)})}a($e),a(Oa),g(()=>{l(Rt,(e(ka),n(()=>e(ka).subject))),l($t,`${e(ka),n(()=>e(ka).grade)??""} - ${e(ka),n(()=>e(ka).section)??""}`)}),q("click",Q,()=>Aa(e(ka))),i(ja,Oa)}),i(ta,ga)},aa=ta=>{var ga=Fu();i(ta,ga)};m(Sa,ta=>{e(S),e(mt),n(()=>e(S)[e(mt).id]&&e(S)[e(mt).id].length>0)?ta(ya):ta(aa,!1)})}a(Ye),a(St),g(()=>l(Ne,(e(mt),n(()=>e(mt).name)))),i(ot,St)}),a(Ea),a(Re),g(ot=>{Be=W(Je,1,"scheduleassign-add-schedule-card",null,Be,ot),l(De,e(I)?"close":"add"),l(ua,` ${e(I)?"Cancel Schedule":"Add Schedule"}`)},[()=>({"cancel-mode":e(I)})]),q("click",Je,ha),i(ae,Re)},ra=ae=>{var Re=Iu();i(ae,Re)};m(Ia,ae=>{e($)&&e(P)?ae(st):ae(ra,!1)})}a(f),a(Ke),a(te),g((ae,Re,Y,Se)=>{Ue=W(Te,1,"scheduleassign-custom-dropdown",null,Ue,ae),Ae=W(F,1,"scheduleassign-dropdown-button",null,Ae,Re),x=W(ie,1,"scheduleassign-custom-dropdown",null,x,Y),Le=W(le,1,"scheduleassign-dropdown-button",null,Le,Se),le.disabled=!e($)},[()=>({open:e(V)}),()=>({selected:e($)}),()=>({open:e(D),disabled:!e($)}),()=>({selected:e(P),disabled:!e($)})]),q("click",F,Ze),q("click",le,K),Za(O,()=>e(L),ae=>s(L,ae)),i(z,te),It()}const ar="roomManagementData",Fr="availableSectionsData",zr=300*1e3;function Ru(){const{subscribe:z,set:d,update:u}=or({rooms:[],availableSections:[],isLoading:!1,error:null,lastUpdated:null});return{subscribe:z,init:h=>{h&&h.rooms&&d({rooms:h.rooms,availableSections:h.availableSections||[],isLoading:!1,error:null,lastUpdated:h.lastUpdated})},setLoading:h=>{u(b=>({...b,isLoading:h,error:h?null:b.error}))},updateRooms:h=>{const b=Date.now(),y={rooms:h,lastUpdated:b,isLoading:!1,error:null};u(S=>({...S,...y}));try{localStorage.setItem(ar,JSON.stringify({rooms:h,lastUpdated:b}))}catch(S){console.warn("Failed to cache rooms data:",S)}},updateSections:h=>{const b=Date.now();u(y=>({...y,availableSections:h,lastUpdated:b}));try{localStorage.setItem(Fr,JSON.stringify({sections:h,lastUpdated:b}))}catch(y){console.warn("Failed to cache sections data:",y)}},setError:h=>{u(b=>({...b,error:h,isLoading:!1}))},getCachedData:()=>{try{const h=localStorage.getItem(ar),b=localStorage.getItem(Fr);if(!h)return null;const y=JSON.parse(h),S=b?JSON.parse(b):{sections:[]},_=Date.now(),E=_-(y.lastUpdated||0),w=_-(S.lastUpdated||0);return E<zr?{rooms:y.rooms||[],availableSections:w<zr?S.sections||[]:[],lastUpdated:y.lastUpdated}:null}catch(h){return console.warn("Failed to retrieve cached room data:",h),null}},clearCache:()=>{try{localStorage.removeItem(ar),localStorage.removeItem(Fr)}catch(h){console.warn("Failed to clear room cache:",h)}},addRoom:h=>{u(b=>{const y=[h,...b.rooms];try{localStorage.setItem(ar,JSON.stringify({rooms:y,lastUpdated:Date.now()}))}catch(S){console.warn("Failed to update cache after adding room:",S)}return{...b,rooms:y}})},removeRoom:h=>{u(b=>{const y=b.rooms.filter(S=>S.id!==h);try{localStorage.setItem(ar,JSON.stringify({rooms:y,lastUpdated:Date.now()}))}catch(S){console.warn("Failed to update cache after removing room:",S)}return{...b,rooms:y}})},updateRoom:(h,b)=>{u(y=>{const S=y.rooms.map(_=>_.id===h?{..._,...b}:_);try{localStorage.setItem(ar,JSON.stringify({rooms:S,lastUpdated:Date.now()}))}catch(_){console.warn("Failed to update cache after updating room:",_)}return{...y,rooms:S}})}}}const Gs=Ru();var Ou=o('<span class="material-symbols-outlined">add_ad</span> Create Room',1),Vu=o('<div class="admin-room-loading"><span class="room-loader"></span> <p>Loading rooms...</p></div>'),Uu=o('<div class="admin-room-empty-state"><span class="material-symbols-outlined">meeting_room</span> <p>No rooms found. Create your first room using the form above.</p></div>'),Wu=o('<button type="button" class="admin-room-unassign-button" title="Unassign Room"><span class="material-symbols-outlined">remove_circle</span></button>'),Yu=o('<a><button type="button" class="admin-room-assign-button"><span class="material-symbols-outlined"> </span></button></a>'),Hu=o('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">group</span> <span> </span></div>'),Ju=o('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">check_circle</span> <span>Available</span></div>'),Bu=o('<div class="admin-room-room-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),Qu=o('<div class="admin-room-edit-form-section"><div class="admin-room-edit-form-container"><div class="admin-room-edit-form-header"><h2 class="admin-room-edit-form-title">Edit Room</h2> <p class="admin-room-edit-form-subtitle">Update room information</p></div> <form class="admin-room-edit-form-content"><div class="admin-room-edit-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-room-name">Room Name *</label> <input type="text" id="edit-room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-building">Building *</label> <input type="text" id="edit-building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-floor">Floor *</label> <input type="text" id="edit-floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-edit-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-update-button"><!></button></div></form></div></div>'),zu=o('<div class="selected-option"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),Ku=o('<span class="placeholder">Select a section</span>'),Zu=o('<button type="button"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),Xu=o('<div class="admin-room-assign-form-section"><div class="admin-room-assign-form-container"><div class="admin-room-assign-form-header"><h2 class="admin-room-assign-form-title">Assign Room</h2> <p class="admin-room-assign-form-subtitle">Select a section to assign this room to</p></div> <form class="admin-room-assign-form-content"><div class="admin-room-assign-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="assign-section-select">Select Section *</label> <div><button type="button" id="assign-section-select"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div> <div class="admin-room-assign-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-assign-submit-button"><!></button></div></form></div></div>'),em=o('<div><div class="admin-room-room-header"><div class="admin-room-room-title"><h3 class="admin-room-room-name"> </h3></div> <div class="admin-room-action-buttons"><!> <a><button type="button" class="admin-room-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="admin-room-remove-button" title="Remove Room"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="admin-room-room-details"><div class="admin-room-room-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <div class="admin-room-room-created"><span class="material-symbols-outlined">schedule</span> <span> </span></div> <!></div> <!> <!></div>'),am=o('<div class="admin-room-rooms-grid"></div>'),tm=o('<div class="admin-room-creation-form-container"><div class="admin-room-creation-form-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Create New Room</h2> <p class="admin-room-section-subtitle">Fill in the details below to create a new room</p></div> <div class="admin-room-form-container"><form><div class="admin-room-form-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="room-name">Room Name *</label> <input type="text" id="room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="building">Building *</label> <input type="text" id="building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="floor">Floor *</label> <input type="text" id="floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-form-actions"><button type="submit" class="admin-room-create-button"><!></button></div></form></div></div> <div class="admin-room-rooms-list-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Existing Rooms</h2> <p class="admin-room-section-subtitle">Manage and view all rooms in the system</p></div> <!></div></div>');function sm(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(Gs,"$roomManagementStore",u),y=p(),S=p(),_=p(),E=p();let w=p(!1),$=p(""),P=p(""),V=p(""),D=p(null),L=p(""),T=p(""),se=p(""),pe=p(!1),N=p(null),G=p(""),H=p(!1),I=p(!1);async function re(Z=!1){try{Z||Gs.setLoading(!0);const J=await Qa.get("/api/rooms");if(J.success)Gs.updateRooms(J.data||[]);else throw new Error(J.message||"Failed to load rooms")}catch(J){console.error("Error loading rooms:",J),Gs.setError("Failed to load rooms. Please try again."),ne.error("Failed to load rooms. Please try again.")}}async function M(Z=!1){try{const J=await Qa.get("/api/sections?action=available-sections");if(J.success)Gs.updateSections(J.data||[]);else throw new Error(J.message||"Failed to load sections")}catch(J){console.error("Error loading sections:",J),Z||ne.error("Failed to load sections. Please try again.")}}const C=Z=>{es.confirm("Remove Room",`Are you sure you want to remove room ${Z.name}? This action cannot be undone.`,async()=>{try{const J=await Qa.delete("/api/rooms",{id:Z.id});if(J.success)Gs.removeRoom(Z.id),ne.success(J.message);else throw new Error(J.message||"Failed to remove room")}catch(J){console.error("Error removing room:",J),ne.error("Failed to remove room. Please try again.")}},()=>{})};async function R(){if(!e($)||!e(P)||!e(V)){ne.warning("Please fill in all required fields.");return}s(w,!0);try{const Z=await Qa.post("/api/rooms",{name:e($),building:e(P),floor:e(V)});if(Z.success)Gs.addRoom(Z.data),ne.success(Z.message),xe();else throw new Error(Z.message||"Failed to create room")}catch(Z){console.error("Error creating room:",Z),ne.error("Failed to create room. Please try again.")}finally{s(w,!1)}}async function B(Z){const J=e(y).find(c=>c.id===Z);J&&es.confirm("Unassign Room",`Are you sure you want to unassign room "${J.name}"? This will remove all section assignments from this room.`,async()=>{await de(Z)},()=>{})}async function de(Z){try{if(!e(y).find(v=>v.id===Z))return;const c=await Qa.patch("/api/rooms",{roomId:Z,action:"unassign"});if(c.success)await re(),await M(),ne.success(c.message);else throw new Error(c.message||"Failed to unassign room")}catch(J){console.error("Error unassigning room:",J),ne.error("Failed to unassign room. Please try again.")}}function xe(){s($,""),s(P,""),s(V,"")}function ue(Z){e(D)===Z.id?(s(D,null),s(L,""),s(T,""),s(se,"")):(e(N)===Z.id&&(s(N,null),s(G,""),s(I,!1)),s(D,Z.id),s(L,Z.name),s(T,Z.building),s(se,Z.floor))}async function X(){if(!e(L)||!e(T)||!e(se)){ne.warning("Please fill in all required fields.");return}s(pe,!0);try{const Z=e(y).find(c=>c.id===e(D)),J=await Qa.put("/api/rooms",{id:e(D),name:e(L),building:e(T),floor:e(se),status:Z.status,assignedTo:Z.assignedTo});if(J.success)Gs.updateRoom(e(D),J.data),ne.success(J.message),s(D,null),s(L,""),s(T,""),s(se,"");else throw new Error(J.message||"Failed to update room")}catch(Z){console.error("Error updating room:",Z),ne.error("Failed to update room. Please try again.")}finally{s(pe,!1)}}function qe(Z){e(N)===Z.id?(s(N,null),s(G,""),s(I,!1)):(e(D)===Z.id&&(s(D,null),s(L,""),s(T,""),s(se,"")),s(N,Z.id),s(G,""),s(I,!1))}function be(){s(I,!e(I))}function _e(Z){s(G,Z.id),s(I,!1)}async function fe(){if(!e(G)){ne.warning("Please select a section.");return}s(H,!0);try{const Z=await Qa.patch("/api/rooms",{roomId:e(N),sectionIds:[e(G)],action:"assign"});if(Z.success)await re(),await M(),ne.success(Z.message),s(N,null),s(G,"");else throw new Error(Z.message||"Failed to assign room")}catch(Z){console.error("Error assigning room:",Z),ne.error("Failed to assign room. Please try again.")}finally{s(H,!1)}}Wt(()=>{const Z=Gs.getCachedData();Z&&Gs.init(Z),re(!!Z),M(!!Z);const J=setInterval(()=>{re(!0),M(!0)},3e4);return()=>{clearInterval(J)}}),Ya(()=>(e(y),e(S),e(_),e(E),b()),()=>{(Z=>{s(y,Z.rooms),s(S,Z.availableSections),s(_,Z.isLoading),s(E,Z.error)})(b())}),ds(),is();var ke=tm(),Ve=t(ke),ye=r(t(Ve),2),Oe=t(ye),U=t(Oe),he=t(U),Ze=r(t(he),2);Ba(Ze),a(he);var K=r(he,2),je=r(t(K),2);Ba(je),a(K);var we=r(K,2),na=r(t(we),2);Ba(na),a(we),a(U);var ia=r(U,2),Aa=t(ia),ha=t(Aa);{var Pe=Z=>{var J=kt("Creating...");i(Z,J)},ca=Z=>{var J=Ou();Xa(),i(Z,J)};m(ha,Z=>{e(w)?Z(Pe):Z(ca,!1)})}a(Aa),a(ia),a(Oe),a(ye),a(Ve);var va=r(Ve,2),Ie=r(t(va),2);{var Ge=Z=>{var J=Vu();i(Z,J)},Me=Z=>{var J=Ta(),c=da(J);{var v=ee=>{var Ce=Uu();i(ee,Ce)},A=ee=>{var Ce=am();ma(Ce,5,()=>e(y),me=>me.id,(me,te)=>{var Ke=em();let f;var k=t(Ke),oe=t(k),Te=t(oe),Ue=t(Te,!0);a(Te),a(oe);var F=r(oe,2),Ae=t(F);{var Qe=Y=>{var Se=Wu();q("click",Se,()=>B(e(te).id)),i(Y,Se)},We=Y=>{var Se=Yu(),Je=t(Se),Be=t(Je),ge=t(Be,!0);a(Be),a(Je),a(Se),g(()=>{Da(Se,"href",`#admin-room-room-card-${e(te),n(()=>e(te).id)??""}`),Da(Je,"title",(e(N),e(te),n(()=>e(N)===e(te).id?"Cancel Assign":"Assign Room"))),l(ge,(e(N),e(te),n(()=>e(N)===e(te).id?"close":"add_circle")))}),q("click",Je,()=>qe(e(te))),i(Y,Se)};m(Ae,Y=>{e(te),n(()=>e(te).assignedSections&&e(te).assignedSections.length>0)?Y(Qe):Y(We,!1)})}var Xe=r(Ae,2),$a=t(Xe),xa=t($a),ie=t(xa,!0);a(xa),a($a),a(Xe);var x=r(Xe,2);a(F),a(k);var le=r(k,2),Le=t(le),pa=r(t(Le),2),He=t(pa);a(pa),a(Le);var sa=r(Le,2);{var la=Y=>{var Se=Hu(),Je=r(t(Se),2),Be=t(Je);a(Je),a(Se),g(ge=>l(Be,`Assigned to: ${ge??""}`),[()=>(e(te),n(()=>e(te).assignedSections.map(ge=>ge.name).join(", ")))]),i(Y,Se)},Ee=Y=>{var Se=Ju();i(Y,Se)};m(sa,Y=>{e(te),n(()=>e(te).assignedSections&&e(te).assignedSections.length>0)?Y(la):Y(Ee,!1)})}var O=r(sa,2),Fe=r(t(O),2),ea=t(Fe);a(Fe),a(O);var qa=r(O,2);{var Ia=Y=>{var Se=Bu(),Je=r(t(Se),2),Be=t(Je);a(Je),a(Se),g(()=>l(Be,`Updated: ${e(te),n(()=>e(te).updatedDate)??""}`)),i(Y,Se)};m(qa,Y=>{e(te),n(()=>e(te).updatedDate&&e(te).updatedDate!==e(te).createdDate)&&Y(Ia)})}a(le);var st=r(le,2);{var ra=Y=>{var Se=Qu(),Je=t(Se),Be=r(t(Je),2),ge=t(Be),De=t(ge),ua=r(t(De),2);Ba(ua),a(De);var Pa=r(De,2),et=r(t(Pa),2);Ba(et),a(Pa);var Ea=r(Pa,2),ot=r(t(Ea),2);Ba(ot),a(Ea),a(ge);var mt=r(ge,2),St=t(mt),Tt=r(St,2),Ft=t(Tt);{var Ne=Sa=>{var ya=kt("Updating...");i(Sa,ya)},Ye=Sa=>{var ya=kt("Update");i(Sa,ya)};m(Ft,Sa=>{e(pe)?Sa(Ne):Sa(Ye,!1)})}a(Tt),a(mt),a(Be),a(Je),a(Se),g(()=>Tt.disabled=e(pe)||!e(L)||!e(T)||!e(se)),Za(ua,()=>e(L),Sa=>s(L,Sa)),Za(et,()=>e(T),Sa=>s(T,Sa)),Za(ot,()=>e(se),Sa=>s(se,Sa)),q("click",St,()=>ue(e(te))),q("submit",Be,As(X)),i(Y,Se)};m(st,Y=>{e(D),e(te),n(()=>e(D)===e(te).id)&&Y(ra)})}var ae=r(st,2);{var Re=Y=>{var Se=Xu(),Je=t(Se),Be=r(t(Je),2),ge=t(Be),De=t(ge),ua=r(t(De),2);let Pa;var et=t(ua);let Ea;var ot=t(et);{var mt=ta=>{const ga=qs(()=>(e(S),e(G),n(()=>e(S).find(Oa=>Oa.id===e(G)))));var za=Ta(),ja=da(za);{var ka=Oa=>{var lt=zu(),vt=r(t(lt),2),it=t(vt),Rt=t(it,!0);a(it);var ft=r(it,2),$t=t(ft);a(ft),a(vt),a(lt),g(()=>{l(Rt,(Zt(e(ga)),n(()=>e(ga).name))),l($t,`Grade ${Zt(e(ga)),n(()=>e(ga).grade_level)??""} Section`)}),i(Oa,lt)};m(ja,Oa=>{e(ga)&&Oa(ka)})}i(ta,za)},St=ta=>{var ga=Ku();i(ta,ga)};m(ot,ta=>{e(G)?ta(mt):ta(St,!1)})}Xa(2),a(et);var Tt=r(et,2);ma(Tt,5,()=>e(S),ta=>ta.id,(ta,ga)=>{var za=Zu();let ja;var ka=r(t(za),2),Oa=t(ka),lt=t(Oa,!0);a(Oa);var vt=r(Oa,2),it=t(vt);a(vt),a(ka),a(za),g(Rt=>{ja=W(za,1,"dropdown-option",null,ja,Rt),l(lt,(e(ga),n(()=>e(ga).name))),l(it,`Grade ${e(ga),n(()=>e(ga).grade_level)??""} Section`)},[()=>({selected:e(G)===e(ga).id})]),q("click",za,()=>_e(e(ga))),i(ta,za)}),a(Tt),a(ua),a(De),a(ge);var Ft=r(ge,2),Ne=t(Ft),Ye=r(Ne,2),Sa=t(Ye);{var ya=ta=>{var ga=kt("Assigning");i(ta,ga)},aa=ta=>{var ga=kt("Assign");i(ta,ga)};m(Sa,ta=>{e(H)?ta(ya):ta(aa,!1)})}a(Ye),a(Ft),a(Be),a(Je),a(Se),g((ta,ga)=>{Pa=W(ua,1,"custom-dropdown",null,Pa,ta),Ea=W(et,1,"dropdown-trigger",null,Ea,ga),Ye.disabled=e(H)||!e(G)},[()=>({open:e(I)}),()=>({selected:e(G)})]),q("click",et,be),q("click",Ne,()=>qe(e(te))),q("submit",Be,As(fe)),i(Y,Se)};m(ae,Y=>{e(N),e(te),n(()=>e(N)===e(te).id)&&Y(Re)})}a(Ke),g(Y=>{f=W(Ke,1,"admin-room-room-card",null,f,Y),Da(Ke,"id",`admin-room-room-card-${e(te),n(()=>e(te).id)??""}`),l(Ue,(e(te),n(()=>e(te).name))),Da(Xe,"href",`#admin-room-room-card-${e(te),n(()=>e(te).id)??""}`),Da($a,"title",(e(D),e(te),n(()=>e(D)===e(te).id?"Cancel Edit":"Edit Room"))),l(ie,(e(D),e(te),n(()=>e(D)===e(te).id?"close":"edit"))),l(He,`${e(te),n(()=>e(te).building)??""}, ${e(te),n(()=>e(te).floor)??""}`),l(ea,`Created: ${e(te),n(()=>e(te).createdDate)??""}`)},[()=>({editing:e(D)===e(te).id,assigning:e(N)===e(te).id})]),q("click",$a,()=>ue(e(te))),q("click",x,()=>C(e(te))),i(me,Ke)}),a(Ce),i(ee,Ce)};m(c,ee=>{e(y),n(()=>e(y).length===0)?ee(v):ee(A,!1)},!0)}i(Z,J)};m(Ie,Z=>{e(_)?Z(Ge):Z(Me,!1)})}a(va),a(ke),g(()=>Aa.disabled=e(w)||!e($)||!e(P)||!e(V)),Za(Ze,()=>e($),Z=>s($,Z)),Za(je,()=>e(P),Z=>s(P,Z)),Za(na,()=>e(V),Z=>s(V,Z)),q("submit",Oe,As(R)),i(z,ke),It(),h()}const nr="sectionsCache",rm=180*1e3,Ms=(()=>{const z=or([]),d=or(!1),u=or(null),h=()=>{try{const L=localStorage.getItem(nr);if(!L)return null;const T=JSON.parse(L);return Date.now()-T.timestamp>rm?(localStorage.removeItem(nr),null):T.sections}catch(L){return console.error("Error reading sections cache:",L),localStorage.removeItem(nr),null}},b=L=>{try{const T={sections:L,timestamp:Date.now()};localStorage.setItem(nr,JSON.stringify(T))}catch(T){console.error("Error setting sections cache:",T)}},y=()=>{try{localStorage.removeItem(nr)}catch(L){console.error("Error clearing sections cache:",L)}},S=()=>{const L=h();return L?(z.set(L),!0):!1},_=(L,T=!1)=>{z.set(L),u.set(null),T||d.set(!1),b(L)},E=(L,T=!1)=>{T||d.set(L)},w=L=>{u.set(L),d.set(!1)},$=async(L=!1)=>{try{E(!0,L);const T=await fetch("/api/sections");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const se=await T.json();if(!se.success||!se.data)throw new Error("Invalid API response structure");const pe=se.data.map(N=>({...N,students:N.students||[],adviser:N.adviser||null}));_(pe,L)}catch(T){console.error("Error loading sections:",T),w(T.message)}finally{E(!1,!1)}},P=L=>{z.update(T=>{const se=[...T,L];return b(se),se})},V=(L,T)=>{z.update(se=>{const pe=se.map(N=>N.id===L?{...N,...T}:N);return b(pe),pe})},D=L=>{z.update(T=>{const se=T.filter(pe=>pe.id!==L);return b(se),se})};return{sections:{subscribe:z.subscribe},isLoadingSections:{subscribe:d.subscribe},sectionsError:{subscribe:u.subscribe},initSections:S,loadSections:$,updateSections:_,setLoadingSections:E,setSectionsError:w,addSection:P,updateSection:V,removeSection:D,clearSectionsCache:y}})();var im=o('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),nm=o('<span class="sectionmgmt-placeholder">Select grade level</span>'),om=o('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),lm=o('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),dm=o('<span class="sectionmgmt-placeholder">Select advisory teacher</span>'),cm=o('<span class="sectionmgmt-placeholder">Select grade level first</span>'),vm=o('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading teachers...</p></div>'),um=o('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available teachers found</span></div>'),mm=o('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),pm=o('<span class="sectionmgmt-placeholder">Add students to section</span>'),fm=o('<span class="sectionmgmt-placeholder">Select grade level first</span>'),_m=o('<button type="button" class="sectionmgmt-select-all-btn"><span class="material-symbols-outlined"> </span></button>'),gm=o('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading students...</p></div>'),bm=o('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found for this grade level</span></div>'),hm=o('<button type="button"><div class="sectionmgmt-student-checkbox"><span class="material-symbols-outlined"> </span></div> <span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),ym=o('<div class="sectionmgmt-selected-student-chip"><span class="sectionmgmt-student-name"> </span> <span class="sectionmgmt-student-id"> </span> <button type="button" class="sectionmgmt-remove-student"><span class="material-symbols-outlined">close</span></button></div>'),wm=o('<div class="sectionmgmt-selected-students"><div class="sectionmgmt-selected-students-header"><span class="sectionmgmt-selected-count"> </span></div> <div class="sectionmgmt-selected-students-list"></div></div>'),Sm=o('<span class="material-symbols-outlined">groups</span> Create Section',1),xm=o('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading sections...</p></div>'),km=o('<div class="sectionmgmt-section-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),Am=o('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Dm=o('<span class="sectionmgmt-placeholder">Select section adviser</span>'),Tm=o('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Nm=o('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available advisers found</span></div>'),jm=o('<button type="button" class="sectionmgmt-select-all-btn"><span class="material-symbols-outlined"> </span></button>'),$m=o('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon"> </span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Cm=o('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found</span></div>'),qm=o('<div class="sectionmgmt-selected-student-chip"><span class="sectionmgmt-student-name"> </span> <span class="sectionmgmt-student-id"> </span> <button type="button" class="sectionmgmt-remove-student"><span class="material-symbols-outlined">close</span></button></div>'),Em=o('<div class="sectionmgmt-selected-students"><div class="sectionmgmt-selected-students-header"><span class="sectionmgmt-selected-count"> </span></div> <div class="sectionmgmt-selected-students-list"></div></div>'),Fm=o('<div class="sectionmgmt-edit-form-section"><div class="sectionmgmt-edit-form-container" id="section-edit-form-container"><div class="sectionmgmt-edit-form-header"><h2 class="sectionmgmt-edit-form-title">Edit Section</h2> <p class="sectionmgmt-edit-form-subtitle">Update section information and manage students</p></div> <form class="sectionmgmt-edit-form-content"><div class="sectionmgmt-edit-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-name">Section Name</label> <input type="text" id="edit-section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-adviser">Section Adviser</label> <div><button type="button" id="edit-section-adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search advisers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!> <!></div></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-students"> </label> <div><button type="button" id="edit-students"><span class="sectionmgmt-placeholder"> </span> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><!> <input type="text" class="sectionmgmt-search-input" placeholder="Search students..."/> <span>search</span></div> <!> <!></div></div> <!></div> <div class="sectionmgmt-edit-form-actions"><button type="button" class="sectionmgmt-cancel-button">Cancel</button> <button type="submit" class="sectionmgmt-submit-button"><!></button></div></form></div></div>'),Lm=o('<div><div class="sectionmgmt-section-header-card"><div class="sectionmgmt-section-title"><h3 class="sectionmgmt-section-name"> </h3></div> <div class="sectionmgmt-action-buttons"><a><button type="button" class="sectionmgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="sectionmgmt-remove-button" title="Remove Section"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="sectionmgmt-section-details"><div class="sectionmgmt-section-adviser"><span class="material-symbols-outlined">person_book</span> <span> </span></div> <div class="sectionmgmt-section-students"><span class="material-symbols-outlined">group</span> <span> </span></div> <div class="sectionmgmt-section-room"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <div class="sectionmgmt-section-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div> <!></div>'),Pm=o('<div class="sectionmgmt-sections-empty"><span class="material-symbols-outlined">school</span> <p>No sections found</p></div>'),Im=o("<!> <!>",1),Gm=o('<div class="sectionmgmt-form-container"><div class="sectionmgmt-creation-form-section"><div class="sectionmgmt-section-header"><h2 class="sectionmgmt-section-title">Create New Section</h2> <p class="sectionmgmt-section-subtitle">Fill in the details below to create a new class section</p></div> <div class="sectionmgmt-form-container"><form><div class="sectionmgmt-basic-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="section-name">Section Name *</label> <input type="text" id="section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="school-year">School Year</label> <input type="text" id="school-year" class="sectionmgmt-form-input" readonly=""/></div></div> <div class="sectionmgmt-create-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="adviser">Advisory Teacher (Optional)</label> <div><button type="button" id="adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search teachers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only teachers without assigned sections are shown. Each teacher can only advise one section.</p></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="students">Students (Optional)</label> <div><button type="button" id="students"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><!> <input type="text" class="sectionmgmt-search-input" placeholder="Search students..."/> <span>search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only students without assigned sections are shown. Select students for the chosen grade level.</p> <!></div> <div class="sectionmgmt-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="sectionmgmt-recent-sections-section"><div class="sectionmgmt-section-header"><div class="sectionmgmt-title-with-refresh"><h2 class="sectionmgmt-section-title">All Sections</h2></div> <p class="sectionmgmt-section-subtitle">Recently created sections in the system</p></div> <div class="sectionmgmt-sections-grid"><!></div></div></div>');function Mm(z,d){Pt(d,!1);const[u,h]=bs(),b=()=>_s(e(_),"$isLoadingSections",u),y=()=>_s(e(S),"$sections",u),S=p(),_=p(),E=p(),w=p(),$=p(),P=p(),V=p(),D=p(),L=p(),T=p();let se=p(!1),pe=p(""),N=p(""),G=p("2024-2025"),H=p(null),I=p([]),re=p(!1),M=p(!1),C=p(!1),R=p(""),B=p(""),de=p(null),xe=p(""),ue=p(null),X=p([]),qe=p(!1),be=p(!1),_e=p(!1),fe=p(""),ke=p(""),Ve=p([]),ye=p([]),Oe=p(!1),U=p(!1);Wt(async()=>{const Q=Ms.initSections();await Ms.loadSections(Q),await he()});async function he(Q=null){try{s(Oe,!0);const $e=Q?`&teacherGradeLevel=${Q}`:"",oa=await Qa.get(`/api/sections?action=available-teachers&schoolYear=${e(G)}${$e}`);if(oa.success&&(s(Ve,oa.data.map(Fa=>{const tt=e($)&&e($).length>0?e($).some(Ga=>Ga.adviser_id===Fa.id):!1;return{id:Fa.id,name:Fa.full_name,employeeId:Fa.account_number,subject:Fa.subject_code||"No Subject",subject_grade_level:Fa.subject_grade_level,hasSection:tt}})),e($)&&e($).length>0))for(const Fa of e($))Fa.adviser_id&&!e(Ve).find(tt=>tt.id===Fa.adviser_id)&&e(Ve).push({id:Fa.adviser_id,name:Fa.adviser_name,employeeId:Fa.adviser_account_number||"N/A",subject:Fa.adviser_subject||"No Subject",subject_grade_level:Fa.grade_level,hasSection:!0})}catch($e){console.error("Error loading teachers:",$e),ne.error("Failed to load available teachers")}finally{s(Oe,!1)}}async function Ze(Q){try{s(U,!0);const $e=await Qa.get(`/api/sections?action=available-students&gradeLevel=${Q}&schoolYear=${e(G)}`);$e.success&&s(ye,$e.data.map(oa=>({id:oa.id,name:oa.full_name,studentId:oa.account_number,grade:oa.grade_level,hasSection:!1})))}catch($e){console.error("Error loading students:",$e),ne.error("Failed to load available students")}finally{s(U,!1)}}async function K(Q){try{const $e=await Qa.get(`/api/sections?action=section-students&sectionId=${Q}`);return $e.success?$e.data.map(oa=>({id:oa.id,name:oa.full_name,studentId:oa.account_number,grade:oa.grade_level})):[]}catch($e){return console.error("Error loading section students:",$e),[]}}function je(){s(_e,!e(_e)),s(be,!1)}function we(Q){e(X).findIndex(oa=>oa.id===Q.id)>-1?s(X,e(X).filter(oa=>oa.id!==Q.id)):s(X,[...e(X),Q])}function na(Q){s(X,e(X).filter($e=>$e.id!==Q.id))}function ia(){if(e(X).length===e(T).length&&e(T).every(Q=>e(X).some($e=>$e.id===Q.id)))s(X,e(X).filter(Q=>!e(T).some($e=>$e.id===Q.id)));else{const Q=e(T).filter($e=>!e(X).some(oa=>oa.id===$e.id));s(X,[...e(X),...Q])}}const Aa=[{id:"7",name:"Grade 7",description:"First Year Junior High School"},{id:"8",name:"Grade 8",description:"Second Year Junior High School"},{id:"9",name:"Grade 9",description:"Third Year Junior High School"},{id:"10",name:"Grade 10",description:"Fourth Year Junior High School"}];function ha(){s(re,!e(re)),s(M,!1),s(C,!1)}function Pe(){s(M,!e(M)),s(re,!1),s(C,!1)}function ca(){s(C,!e(C)),s(re,!1),s(M,!1)}function va(Q){s(N,Q.id),s(re,!1),s(I,[]),Ze(Q.id),he(Q.id)}function Ie(Q){s(H,Q),s(M,!1),s(R,"")}function Ge(Q){e(I).findIndex(oa=>oa.id===Q.id)>-1?s(I,e(I).filter(oa=>oa.id!==Q.id)):s(I,[...e(I),Q])}function Me(Q){s(I,e(I).filter($e=>$e.id!==Q))}function Z(){if(e(I).length===e(D).length&&e(D).every(Q=>e(I).some($e=>$e.id===Q.id)))s(I,e(I).filter(Q=>!e(D).some($e=>$e.id===Q.id)));else{const Q=e(D).filter($e=>!e(I).some(oa=>oa.id===$e.id));s(I,[...e(I),...Q])}}async function J(){if(!e(pe)||!e(N)){ne.error("Please fill in section name and grade level.");return}s(se,!0);try{const Q=await Qa.post("/api/sections",{sectionName:e(pe),gradeLevel:parseInt(e(N)),schoolYear:e(G),adviserId:e(H)?.id||null,studentIds:e(I).map($e=>$e.id),roomId:null});Q.success?(ne.success(Q.message),s(pe,""),s(N,""),s(H,null),s(I,[]),s(R,""),s(B,""),s(ye,[]),Ms.addSection(Q.data),await he()):ne.error(Q.error||"Failed to create section")}catch(Q){console.error("Error creating section:",Q),ne.error("Failed to create section. Please try again.")}finally{s(se,!1)}}async function c(Q){e(de)===Q.id?(s(de,null),s(xe,""),s(ue,null),s(X,[]),s(fe,""),s(ke,""),s(be,!1),s(_e,!1)):(s(de,Q.id),s(xe,Q.name),s(ue,e(Ve).find($e=>$e.id===Q.adviser_id)),!e(ue)&&Q.adviser_id&&(s(ue,{id:Q.adviser_id,name:"Loading...",employeeId:"",subject:"",hasSection:!0}),await he(Q.grade_level),s(ue,e(Ve).find($e=>$e.id===Q.adviser_id)||e(ue))),s(X,await K(Q.id)),s(te,[...e(X)]),s(ke,""),await Ze(Q.grade_level))}async function v(){if(!e(xe)||!e(ue)){ne.error("Please fill in all required fields.");return}s(qe,!0);try{const Q={sectionId:e(de),sectionName:e(xe),adviserId:e(ue).id,studentIds:e(X).map(oa=>oa.id||oa._id),roomId:null},$e=await Qa.put("/api/sections",Q);$e.success?(ne.success($e.message),s(de,null),s(xe,""),s(ue,null),s(X,[]),s(fe,""),s(ke,""),s(be,!1),s(_e,!1),Ms.updateSection(e(de),$e.data),await Ms.loadSections(!0),await he()):ne.error($e.error||"Failed to update section")}catch(Q){console.error("Error updating section:",Q),ne.error("Failed to update section. Please try again.")}finally{s(qe,!1)}}function A(){s(be,!e(be)),s(_e,!1)}async function ee(Q){const $e=Q.id;s(ue,Q),s(be,!1),s(fe,""),await he(),s(ue,e(Ve).find(oa=>oa.id===$e)||Q)}function Ce(Q){es.confirm("Delete Section",`<p>Are you sure you want to permanently delete section <strong>"${Q.name}"</strong> (Grade ${Q.grade_level})?</p>
			<p class="sectionmgmt-warning">This action will:</p>
			<ul class="sectionmgmt-warning-list">
				<li>Permanently delete the section and all its data</li>
				<li>Remove all students from this section</li>
				<li>Free up the advisory teacher for other sections</li>
				<li>This action cannot be undone</li>
			</ul>`,()=>me(Q),null,{size:"medium"})}async function me(Q){try{const $e=await Qa.delete(`/api/sections?sectionId=${Q._id}`);$e.success?(ne.success("Section deleted successfully"),Ms.removeSection(Q._id)):ne.error($e.error||"Failed to delete section")}catch($e){console.error("Error deleting section:",$e),ne.error("An error occurred while deleting the section")}}let te=p([]);Ya(()=>(e(S),e(_),e(E),Ms),()=>{Yr(s(S,Ms.sections),"$sections",u),Yr(s(_,Ms.isLoadingSections),"$isLoadingSections",u),s(E,Ms.sectionsError)}),Ya(()=>b(),()=>{s(w,b())}),Ya(()=>y(),()=>{s($,y())}),Ya(()=>e(N),()=>{s(P,Aa.find(Q=>Q.id===e(N)))}),Ya(()=>(e(Ve),e(R)),()=>{s(V,e(Ve).filter(Q=>!Q.hasSection&&Q.name.toLowerCase().includes(e(R).toLowerCase())))}),Ya(()=>(e(ye),e(N),e(B)),()=>{s(D,e(ye).filter(Q=>!Q.hasSection&&Q.grade===e(N)&&Q.name.toLowerCase().includes(e(B).toLowerCase())))}),Ya(()=>(e(N),e(I),e(H)),()=>{e(N)&&(s(I,e(I).filter(Q=>Q.grade===e(N))),e(H)&&e(H).subject_grade_level&&e(H).subject_grade_level!==parseInt(e(N))&&s(H,null))}),Ya(()=>(e(Ve),e(de),e($),e(fe)),()=>{s(L,e(Ve).filter(Q=>{const $e=e(de)&&e($).find(fa=>fa.id===e(de))?.adviser_id,oa=!Q.hasSection||Q.id===$e,tt=(e(de)&&e($).find(fa=>fa.id===e(de)))?.grade_level,Ga=!tt||!Q.subject_grade_level||Q.subject_grade_level===tt;return oa&&Ga&&Q.name.toLowerCase().includes(e(fe).toLowerCase())}))}),Ya(()=>(e(ye),e(te),e(X),e(ke)),()=>{s(T,(()=>{const Q=[...e(ye)];return e(te).forEach($e=>{Q.some(oa=>oa.id===$e.id)||Q.push({...$e,hasSection:!0})}),Q.filter($e=>{const oa=!$e.hasSection||e(X).some(tt=>tt.id===$e.id)||e(te).some(tt=>tt.id===$e.id),Fa=$e.name.toLowerCase().includes(e(ke).toLowerCase());return oa&&Fa})})())}),ds(),is();var Ke=Gm(),f=t(Ke),k=r(t(f),2),oe=t(k),Te=t(oe),Ue=t(Te),F=r(t(Ue),2);Ba(F),a(Ue);var Ae=r(Ue,2),Qe=r(t(Ae),2);Ba(Qe),a(Ae),a(Te);var We=r(Te,2),Xe=t(We),$a=r(t(Xe),2);let xa;var ie=t($a);let x;var le=t(ie);{var Le=Q=>{var $e=im(),oa=r(t($e),2),Fa=t(oa),tt=t(Fa,!0);a(Fa),a(oa),a($e),g(()=>l(tt,(e(P),n(()=>e(P).name)))),i(Q,$e)},pa=Q=>{var $e=nm();i(Q,$e)};m(le,Q=>{e(P)?Q(Le):Q(pa,!1)})}Xa(2),a(ie);var He=r(ie,2);ma(He,5,()=>Aa,Q=>Q.id,(Q,$e)=>{var oa=om();let Fa;var tt=r(t(oa),2),Ga=t(tt),fa=t(Ga,!0);a(Ga);var _t=r(Ga,2),pt=t(_t,!0);a(_t),a(tt),a(oa),g(Ha=>{Fa=W(oa,1,"sectionmgmt-dropdown-option",null,Fa,Ha),l(fa,(e($e),n(()=>e($e).name))),l(pt,(e($e),n(()=>e($e).description)))},[()=>({selected:e(N)===e($e).id})]),q("click",oa,()=>va(e($e))),i(Q,oa)}),a(He),a($a),a(Xe);var sa=r(Xe,2),la=r(t(sa),2);let Ee;var O=t(la);let Fe;var ea=t(O);{var qa=Q=>{var $e=lm(),oa=r(t($e),2),Fa=t(oa),tt=t(Fa,!0);a(Fa),a(oa),a($e),g(()=>l(tt,(e(H),n(()=>e(H).name)))),i(Q,$e)},Ia=Q=>{var $e=Ta(),oa=da($e);{var Fa=Ga=>{var fa=dm();i(Ga,fa)},tt=Ga=>{var fa=cm();i(Ga,fa)};m(oa,Ga=>{e(N)?Ga(Fa):Ga(tt,!1)},!0)}i(Q,$e)};m(ea,Q=>{e(H)?Q(qa):Q(Ia,!1)})}Xa(2),a(O);var st=r(O,2),ra=t(st),ae=t(ra);Ba(ae),Xa(2),a(ra);var Re=r(ra,2);{var Y=Q=>{var $e=vm();i(Q,$e)},Se=Q=>{var $e=Ta(),oa=da($e);{var Fa=Ga=>{var fa=um();i(Ga,fa)},tt=Ga=>{var fa=Ta(),_t=da(fa);ma(_t,1,()=>e(V),pt=>pt.id,(pt,Ha)=>{var gt=mm();let At;var Lt=r(t(gt),2),Ja=t(Lt),Ca=t(Ja,!0);a(Ja);var Ra=r(Ja,2),Wa=t(Ra,!0);a(Ra),a(Lt),a(gt),g(at=>{At=W(gt,1,"sectionmgmt-dropdown-option",null,At,at),l(Ca,(e(Ha),n(()=>e(Ha).name))),l(Wa,(e(Ha),n(()=>e(Ha).employeeId)))},[()=>({selected:e(H)?.id===e(Ha).id})]),q("click",gt,()=>Ie(e(Ha))),i(pt,gt)}),i(Ga,fa)};m(oa,Ga=>{e(V),n(()=>e(V).length===0)?Ga(Fa):Ga(tt,!1)},!0)}i(Q,$e)};m(Re,Q=>{e(Oe)?Q(Y):Q(Se,!1)})}a(st),a(la),Xa(2),a(sa),a(We);var Je=r(We,2),Be=r(t(Je),2);let ge;var De=t(Be);let ua;var Pa=t(De);{var et=Q=>{var $e=pm();i(Q,$e)},Ea=Q=>{var $e=fm();i(Q,$e)};m(Pa,Q=>{e(N)?Q(et):Q(Ea,!1)})}Xa(2),a(De);var ot=r(De,2),mt=t(ot),St=t(mt);{var Tt=Q=>{const $e=qs(()=>(e(D),e(I),n(()=>e(D).every(Ga=>e(I).some(fa=>fa.id===Ga.id)))));var oa=_m(),Fa=t(oa),tt=t(Fa,!0);a(Fa),a(oa),g(()=>{Da(oa,"title",`${e($e)?"Unselect All":"Select All"} (${e(D),n(()=>e(D).length)??""})`),l(tt,e($e)?"deselect":"select_all")}),q("click",oa,Z),i(Q,oa)};m(St,Q=>{e(D),n(()=>e(D).length>0)&&Q(Tt)})}var Ft=r(St,2);Ba(Ft);var Ne=r(Ft,2);let Ye;a(mt);var Sa=r(mt,2);{var ya=Q=>{var $e=gm();i(Q,$e)},aa=Q=>{var $e=Ta(),oa=da($e);{var Fa=Ga=>{var fa=bm();i(Ga,fa)},tt=Ga=>{var fa=Ta(),_t=da(fa);ma(_t,1,()=>e(D),pt=>pt.id,(pt,Ha)=>{var gt=hm();let At;var Lt=t(gt),Ja=t(Lt),Ca=t(Ja,!0);a(Ja),a(Lt);var Ra=r(Lt,4),Wa=t(Ra),at=t(Wa,!0);a(Wa);var bt=r(Wa,2),j=t(bt);a(bt),a(Ra),a(gt),g((ve,ze)=>{At=W(gt,1,"sectionmgmt-dropdown-option sectionmgmt-student-option",null,At,ve),l(Ca,ze),l(at,(e(Ha),n(()=>e(Ha).name))),l(j,`Grade ${e(Ha),n(()=>e(Ha).grade)??""} • ${e(Ha),n(()=>e(Ha).studentId)??""}`)},[()=>({selected:e(I).some(ve=>ve.id===e(Ha).id)}),()=>(e(I),e(Ha),n(()=>e(I).some(ve=>ve.id===e(Ha).id)?"check_box":"check_box_outline_blank"))]),q("click",gt,()=>Ge(e(Ha))),i(pt,gt)}),i(Ga,fa)};m(oa,Ga=>{e(D),n(()=>e(D).length===0)?Ga(Fa):Ga(tt,!1)},!0)}i(Q,$e)};m(Sa,Q=>{e(U)?Q(ya):Q(aa,!1)})}a(ot),a(Be);var ta=r(Be,4);{var ga=Q=>{var $e=wm(),oa=t($e),Fa=t(oa),tt=t(Fa);a(Fa),a(oa);var Ga=r(oa,2);ma(Ga,5,()=>e(I),fa=>fa.id,(fa,_t)=>{var pt=ym(),Ha=t(pt),gt=t(Ha,!0);a(Ha);var At=r(Ha,2),Lt=t(At,!0);a(At);var Ja=r(At,2);a(pt),g(()=>{l(gt,(e(_t),n(()=>e(_t).name))),l(Lt,(e(_t),n(()=>e(_t).studentId))),Da(Ja,"aria-label",`Remove ${e(_t),n(()=>e(_t).name)??""}`)}),q("click",Ja,()=>Me(e(_t).id)),i(fa,pt)}),a(Ga),a($e),g(()=>l(tt,`${e(I),n(()=>e(I).length)??""} student${e(I),n(()=>e(I).length!==1?"s":"")??""} selected`)),i(Q,$e)};m(ta,Q=>{e(I),n(()=>e(I).length>0)&&Q(ga)})}a(Je);var za=r(Je,2),ja=t(za);let ka;var Oa=t(ja);{var lt=Q=>{var $e=kt("Creating...");i(Q,$e)},vt=Q=>{var $e=Sm();Xa(),i(Q,$e)};m(Oa,Q=>{e(se)?Q(lt):Q(vt,!1)})}a(ja),a(za),a(oe),a(k),a(f);var it=r(f,2),Rt=r(t(it),2),ft=t(Rt);{var $t=Q=>{var $e=xm();i(Q,$e)},Mt=Q=>{var $e=Im(),oa=da($e);ma(oa,1,()=>e($),Ga=>Ga.id,(Ga,fa)=>{var _t=Lm();let pt;var Ha=t(_t),gt=t(Ha),At=t(gt),Lt=t(At);a(At),a(gt);var Ja=r(gt,2),Ca=t(Ja),Ra=t(Ca),Wa=t(Ra),at=t(Wa,!0);a(Wa),a(Ra),a(Ca);var bt=r(Ca,2);a(Ja),a(Ha);var j=r(Ha,2),ve=t(j),ze=r(t(ve),2),ba=t(ze,!0);a(ze),a(ve);var ce=r(ve,2),Va=r(t(ce),2),dt=t(Va);a(Va),a(ce);var _a=r(ce,2),Ma=r(t(_a),2),ct=t(Ma,!0);a(Ma),a(_a);var rt=r(_a,2),Ka=r(t(rt),2),wa=t(Ka);a(Ka),a(rt);var La=r(rt,2);{var nt=Dt=>{var Gt=km(),ht=r(t(Gt),2),jt=t(ht);a(ht),a(Gt),g(Yt=>l(jt,`Updated: ${Yt??""}`),[()=>(e(fa),n(()=>new Date(e(fa).updated_at).toLocaleDateString()))]),i(Dt,Gt)};m(La,Dt=>{e(fa),n(()=>e(fa).updated_at&&e(fa).updated_at!==e(fa).created_at)&&Dt(nt)})}a(j);var Ct=r(j,2);{var Nt=Dt=>{var Gt=Fm(),ht=t(Gt),jt=r(t(ht),2),Yt=t(jt),as=t(Yt),ws=r(t(as),2);Ba(ws),a(as);var Ds=r(as,2),Ls=r(t(Ds),2);let Rs;var Ts=t(Ls);let ut;var wt=t(Ts);{var qt=Ua=>{var yt=Am(),Vt=r(t(yt),2),ns=t(Vt),vs=t(ns,!0);a(ns),a(Vt),a(yt),g(()=>l(vs,(e(ue),n(()=>e(ue).name)))),i(Ua,yt)},Qt=Ua=>{var yt=Dm();i(Ua,yt)};m(wt,Ua=>{e(ue)?Ua(qt):Ua(Qt,!1)})}Xa(2),a(Ts);var ts=r(Ts,2),Bt=t(ts),rs=t(Bt);Ba(rs),Xa(2),a(Bt);var cs=r(Bt,2);ma(cs,1,()=>e(L),Ua=>Ua.id,(Ua,yt)=>{var Vt=Tm();let ns;var vs=r(t(Vt),2),xs=t(vs),us=t(xs,!0);a(xs);var ms=r(xs,2),Os=t(ms,!0);a(ms),a(vs),a(Vt),g(Is=>{ns=W(Vt,1,"sectionmgmt-dropdown-option",null,ns,Is),l(us,(e(yt),n(()=>e(yt).name))),l(Os,(e(yt),n(()=>e(yt).employeeId)))},[()=>({selected:e(ue)?.id===e(yt).id})]),q("click",Vt,()=>ee(e(yt))),i(Ua,Vt)});var Ht=r(cs,2);{var hs=Ua=>{var yt=Nm();i(Ua,yt)};m(Ht,Ua=>{e(L),n(()=>e(L).length===0)&&Ua(hs)})}a(ts),a(Ls),a(Ds),a(Yt);var gs=r(Yt,2),Ss=t(gs),Jt=t(Ss);a(Ss);var Et=r(Ss,2);let Ot;var zt=t(Et);let ss;var Ps=t(zt),$s=t(Ps,!0);a(Ps),Xa(2),a(zt);var tr=r(zt,2),Vs=t(tr),Bs=t(Vs);{var lr=Ua=>{const yt=qs(()=>(e(T),e(X),n(()=>e(T).every(xs=>e(X).some(us=>us.id===xs.id)))));var Vt=jm(),ns=t(Vt),vs=t(ns,!0);a(ns),a(Vt),g(()=>{Da(Vt,"title",`${e(yt)?"Unselect All":"Select All"} (${e(T),n(()=>e(T).length)??""})`),l(vs,e(yt)?"deselect":"select_all")}),q("click",Vt,ia),i(Ua,Vt)};m(Bs,Ua=>{e(T),n(()=>e(T).length>0)&&Ua(lr)})}var Us=r(Bs,2);Ba(Us);var dr=r(Us,2);let sr;a(Vs);var Ys=r(Vs,2);ma(Ys,1,()=>e(T),Ua=>Ua.id,(Ua,yt)=>{var Vt=$m();let ns;var vs=t(Vt),xs=t(vs,!0);a(vs);var us=r(vs,2),ms=t(us),Os=t(ms,!0);a(ms);var Is=r(ms,2),rr=t(Is);a(Is),a(us),a(Vt),g((Ns,Ks)=>{ns=W(Vt,1,"sectionmgmt-dropdown-option",null,ns,Ns),l(xs,Ks),l(Os,(e(yt),n(()=>e(yt).name))),l(rr,`${e(yt),n(()=>e(yt).studentId)??""} • Grade ${e(yt),n(()=>e(yt).grade)??""}`)},[()=>({selected:e(X).some(Ns=>Ns.id===e(yt).id)}),()=>(e(X),e(yt),n(()=>e(X).some(Ns=>Ns.id===e(yt).id)?"check_box":"check_box_outline_blank"))]),q("click",Vt,()=>we(e(yt))),i(Ua,Vt)});var cr=r(Ys,2);{var xr=Ua=>{var yt=Cm();i(Ua,yt)};m(cr,Ua=>{e(T),n(()=>e(T).length===0)&&Ua(xr)})}a(tr),a(Et);var vr=r(Et,2);{var Qs=Ua=>{var yt=Em(),Vt=t(yt),ns=t(Vt),vs=t(ns);a(ns),a(Vt);var xs=r(Vt,2);ma(xs,5,()=>e(X),us=>us.id,(us,ms)=>{var Os=qm(),Is=t(Os),rr=t(Is,!0);a(Is);var Ns=r(Is,2),Ks=t(Ns,!0);a(Ns);var Zs=r(Ns,2);a(Os),g(()=>{l(rr,(e(ms),n(()=>e(ms).name))),l(Ks,(e(ms),n(()=>e(ms).studentId))),Da(Zs,"aria-label",`Remove ${e(ms),n(()=>e(ms).name)??""}`)}),q("click",Zs,()=>na(e(ms))),i(us,Os)}),a(xs),a(yt),g(()=>l(vs,`${e(X),n(()=>e(X).length)??""} student${e(X),n(()=>e(X).length!==1?"s":"")??""} selected`)),i(Ua,yt)};m(vr,Ua=>{e(X),n(()=>e(X).length>0)&&Ua(Qs)})}a(gs);var ur=r(gs,2),Hs=t(ur),zs=r(Hs,2),kr=t(zs);{var Ar=Ua=>{var yt=kt("Updating...");i(Ua,yt)},Dr=Ua=>{var yt=kt("Update");i(Ua,yt)};m(kr,Ua=>{e(qe)?Ua(Ar):Ua(Dr,!1)})}a(zs),a(ur),a(jt),a(ht),a(Gt),g((Ua,yt,Vt,ns,vs)=>{Rs=W(Ls,1,"sectionmgmt-custom-dropdown",null,Rs,Ua),ut=W(Ts,1,"sectionmgmt-dropdown-trigger",null,ut,yt),l(Jt,`Students (${e(X),n(()=>e(X).length)??""} selected)`),Ot=W(Et,1,"sectionmgmt-custom-dropdown",null,Ot,Vt),ss=W(zt,1,"sectionmgmt-dropdown-trigger",null,ss,ns),l($s,(e(X),n(()=>e(X).length>0?`${e(X).length} students selected`:"Select students"))),sr=W(dr,1,"material-symbols-outlined",null,sr,vs),zs.disabled=e(qe)||!e(xe)||!e(ue)},[()=>({open:e(be)}),()=>({selected:e(ue)}),()=>({open:e(_e)}),()=>({selected:e(X).length>0}),()=>({"sectionmgmt-search-icon-edit":e(T).length>0,"sectionmgmt-search-icon":e(T).length===0})]),Za(ws,()=>e(xe),Ua=>s(xe,Ua)),q("click",Ts,A),Za(rs,()=>e(fe),Ua=>s(fe,Ua)),q("click",zt,je),Za(Us,()=>e(ke),Ua=>s(ke,Ua)),q("click",Hs,()=>c(e(fa))),q("submit",jt,As(v)),i(Dt,Gt)};m(Ct,Dt=>{e(de),e(fa),n(()=>e(de)===e(fa).id)&&Dt(Nt)})}a(_t),g((Dt,Gt)=>{pt=W(_t,1,"sectionmgmt-section-card",null,pt,Dt),Da(_t,"id",`sectionmgmt-section-card-${e(fa),n(()=>e(fa).id)??""}`),l(Lt,`${e(fa),n(()=>e(fa).name)??""} · Grade ${e(fa),n(()=>e(fa).grade_level)??""}`),Da(Ca,"href",`#sectionmgmt-section-card-${e(fa),n(()=>e(fa).id)??""}`),Da(Ra,"title",(e(de),e(fa),n(()=>e(de)===e(fa).id?"Cancel Edit":"Edit Section"))),l(at,(e(de),e(fa),n(()=>e(de)===e(fa).id?"close":"edit"))),l(ba,(e(fa),n(()=>e(fa).adviser_name||"No adviser"))),l(dt,`${e(fa),n(()=>e(fa).student_count)??""} students`),l(ct,(e(fa),n(()=>e(fa).room_name?`${e(fa).room_name} (${e(fa).room_building}, ${e(fa).room_floor})`:"No room assigned"))),l(wa,`Created: ${Gt??""}`)},[()=>({editing:e(de)===e(fa).id}),()=>(e(fa),n(()=>new Date(e(fa).created_at).toLocaleDateString()))]),q("click",Ra,()=>c(e(fa))),q("click",bt,()=>Ce(e(fa))),i(Ga,_t)});var Fa=r(oa,2);{var tt=Ga=>{var fa=Pm();i(Ga,fa)};m(Fa,Ga=>{e($),n(()=>e($).length===0)&&Ga(tt)})}i(Q,$e)};m(ft,Q=>{e(w)?Q($t):Q(Mt,!1)})}a(Rt),a(it),a(Ke),g((Q,$e,oa,Fa,tt,Ga,fa,_t)=>{xa=W($a,1,"sectionmgmt-custom-dropdown",null,xa,Q),x=W(ie,1,"sectionmgmt-dropdown-trigger",null,x,$e),Ee=W(la,1,"sectionmgmt-custom-dropdown",null,Ee,oa),Fe=W(O,1,"sectionmgmt-dropdown-trigger",null,Fe,Fa),O.disabled=!e(N),ge=W(Be,1,"sectionmgmt-custom-dropdown",null,ge,tt),ua=W(De,1,"sectionmgmt-dropdown-trigger",null,ua,Ga),De.disabled=!e(N),Ye=W(Ne,1,"material-symbols-outlined",null,Ye,fa),ka=W(ja,1,"sectionmgmt-create-button",null,ka,_t),ja.disabled=e(se)||!e(pe)||!e(N)},[()=>({open:e(re)}),()=>({selected:e(N)}),()=>({open:e(M)}),()=>({selected:e(H)}),()=>({open:e(C)}),()=>({selected:e(I).length>0}),()=>({"sectionmgmt-search-icon-create":e(D).length>0,"sectionmgmt-search-icon":e(D).length===0}),()=>({loading:e(se)})]),Za(F,()=>e(pe),Q=>s(pe,Q)),Za(Qe,()=>e(G),Q=>s(G,Q)),q("click",ie,ha),q("click",O,Pe),Za(ae,()=>e(R),Q=>s(R,Q)),q("click",De,ca),Za(Ft,()=>e(B),Q=>s(B,Q)),q("submit",oe,As(J)),i(z,Ke),It(),h()}var Rm=o('<div class="scheduleassign-container"><div class="scheduleassign-header"><div class="scheduleassign-header-content"><h1 class="scheduleassign-page-title">Schedule Management</h1> <p class="scheduleassign-page-subtitle">Assign subjects and teachers to sections with specific time periods</p></div> <div class="admin-tab-navigation"><button R=""><span class="material-icons">schedule</span> Schedule</button> <button><span class="material-icons">groups</span> Section</button> <button><span class="material-icons">meeting_room</span> Room</button></div></div> <div class="schedule-content-container"><!> <!> <!></div></div>');function Om(z){let d=p("schedule");function u(G){s(d,G)}var h=Rm(),b=t(h),y=r(t(b),2),S=t(y);let _;var E=r(S,2);let w;var $=r(E,2);let P;a(y),a(b);var V=r(b,2),D=t(V);{var L=G=>{Mu(G,{})};m(D,G=>{e(d)==="schedule"&&G(L)})}var T=r(D,2);{var se=G=>{Mm(G,{})};m(T,G=>{e(d)==="section"&&G(se)})}var pe=r(T,2);{var N=G=>{sm(G,{})};m(pe,G=>{e(d)==="room"&&G(N)})}a(V),a(h),g((G,H,I)=>{_=W(S,1,"admin-tab-button",null,_,G),w=W(E,1,"admin-tab-button",null,w,H),P=W($,1,"admin-tab-button",null,P,I)},[()=>({active:e(d)==="schedule"}),()=>({active:e(d)==="section"}),()=>({active:e(d)==="room"})]),q("click",S,()=>u("schedule")),q("click",E,()=>u("section")),q("click",$,()=>u("room")),i(z,h)}var Vm=o('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Um=o('<span class="adminsubject-placeholder">Select grade level</span>'),Wm=o('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Ym=o('<span class="material-symbols-outlined">add_circle</span> Create Subject',1),Hm=o('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Jm=o('<span class="adminsubject-placeholder">All Grades</span>'),Bm=o('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Qm=o('<div class="adminsubject-loading-container"><span class="subject-loader"></span> <p class="adminsubject-loading-text">Loading subjects...</p></div>'),zm=o('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Km=o('<span class="adminsubject-placeholder">Select grade level</span>'),Zm=o('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Xm=o('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container" id="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Subject</h2> <p class="adminsubject-edit-form-subtitle">Update subject information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-grade-level">Grade Level *</label> <div><button type="button" id="edit-grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectName" class="adminsubject-form-label">Subject Name *</label> <input id="editSubjectName" type="text" class="adminsubject-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectCode" class="adminsubject-form-label">Subject Code *</label> <input id="editSubjectCode" type="text" class="adminsubject-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="adminsubject-edit-form-actions"><button type="button" class="adminsubject-cancel-button">Cancel</button> <button type="submit" class="adminsubject-submit-button"><!></button></div></form></div></div>'),ep=o('<div class="adminsubject-subject-card"><div class="adminsubject-subject-header"><div class="adminsubject-subject-title"><h3 class="adminsubject-subject-name"> </h3></div> <div class="adminsubject-action-buttons"><a><button type="button" class="adminsubject-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminsubject-remove-button" title="Remove Subject"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminsubject-subject-details"><div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),ap=o('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">search_off</span> <p>No subjects found matching your search.</p></div>'),tp=o('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Subject</h2> <p class="admin-section-subtitle">Fill in the details below to create a new subject</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="admin-form-group admin-form-group-third"><label for="subjectName" class="admin-form-label">Subject Name *</label> <input id="subjectName" type="text" class="admin-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="admin-form-group admin-form-group-third"><label for="subjectCode" class="admin-form-label">Subject Code *</label> <input id="subjectCode" type="text" class="admin-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><h2 class="admin-section-title">Recent Subjects</h2> <p class="admin-section-subtitle">Subjects created recently</p></div> <div class="adminsubject-filters-container"><div class="adminsubject-search-container"><input type="text" placeholder="Search by subject name or code..." class="adminsubject-search-input"/> <span class="material-symbols-outlined adminsubject-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"><button type="button"><span class="material-symbols-outlined adminsubject-option-icon">clear_all</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name">All Grades</span></div></button> <!></div></div></div> <div class="adminsubject-subjects-grid"><!></div></div></div>'),sp=o('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),rp=o('<span class="adminsubject-placeholder">Select icon</span>'),ip=o('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),np=o('<span class="material-symbols-outlined">add_circle</span> Create Activity Type',1),op=o('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),lp=o('<span class="adminsubject-placeholder">Select icon</span>'),dp=o('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),cp=o('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Activity Type</h2> <p class="adminsubject-edit-form-subtitle">Update activity type information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-name">Activity Name *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-name" placeholder="e.g., Flag Ceremony" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-code">Activity Code *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-code" placeholder="e.g., FLAG" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-icon">Icon</label> <div><button type="button" id="edit-activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="adminsubject-edit-form-actions"><a><button type="button" class="adminsubject-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),vp=o('<div class="adminactivity-activity-card"><div class="adminactivity-activity-header"><div class="adminactivity-activity-title"><h3 class="adminactivity-activity-name"> </h3></div> <div class="adminactivity-action-buttons"><a><button type="button" class="adminactivity-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminactivity-remove-button" title="Remove Activity Type"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminactivity-activity-details"><div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">palette</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!></div>'),up=o('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">event_note</span> <p>No activity types created yet.</p></div>'),mp=o('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Activity Type</h2> <p class="admin-section-subtitle">Fill in the details below to create a new activity type</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-name">Activity Name *</label> <input id="activity-name" type="text" class="admin-form-input" placeholder="e.g., Flag Ceremony, Break Time" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-code">Activity Code *</label> <input id="activity-code" type="text" class="admin-form-input" placeholder="e.g., FLAG, BREAK" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-icon">Icon</label> <div><button type="button" id="activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><h2 class="admin-section-title">Recent Activity Types</h2> <p class="admin-section-subtitle">Activity types created recently</p></div> <div class="adminactivity-activities-grid"><!></div></div></div>'),pp=o('<div class="admin-subject-creation-container"><div class="admin-subject-header"><div class="admin-header-content"><h1 class="admin-page-title">Subjects & Activities</h1> <p class="admin-page-subtitle">Manage subjects and activity types for the curriculum</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">subject</span> Subjects</button> <button><span class="material-icons">event</span> Activity Types</button></div></div> <!> <!></div>');function fp(z,d){Pt(d,!1);const u=p(),h=p(),b=p(),y=p();let S=p(!1),_=p(""),E=p(""),w=p(""),$=p(!1),P=p(!1),V=p(""),D=p(""),L=p(null),T=p(""),se=p(""),pe=p(""),N=p(!1),G=p(!1),H=p("subjects"),I=p([]),re=p(!1),M=p(""),C=p(""),R=p("event"),B=p(!1),de=p(null),xe=p(""),ue=p(""),X=p("event"),qe=p(!1),be=p(!1),_e=p(!1),fe=p([]);const ke=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],Ve=[{value:"event",name:"Event"},{value:"flag",name:"Flag"},{value:"coffee",name:"Coffee"},{value:"restaurant",name:"Restaurant"},{value:"groups",name:"Groups"},{value:"home",name:"Home"},{value:"book",name:"Book"},{value:"group_work",name:"Group Work"},{value:"schedule",name:"Schedule"}];async function ye(){s(_e,!0);try{const F=await Qa.get("/api/subjects");F.success?s(fe,F.data):ne.error("Failed to load subjects: "+F.message)}catch(F){console.error("Error loading subjects:",F),ne.error("Failed to load subjects. Please try again.")}finally{s(_e,!1)}}async function Oe(){try{const F=await Qa.get("/api/activity-types");F.success?s(I,F.data):ne.error("Failed to load activity types: "+F.message)}catch(F){console.error("Error loading activity types:",F),ne.error("Failed to load activity types. Please try again.")}}Wt(()=>{ye(),Oe()});async function U(){if(!e(_)||!e(E).trim()||!e(w).trim()){ne.error("Please fill in all required fields");return}s(S,!0);try{const F=await Qa.post("/api/subjects",{name:e(E).trim(),code:e(w).trim(),gradeLevel:e(_)});F.success?(s(fe,[F.data,...e(fe)]),s(_,""),s(E,""),s(w,""),ne.success(F.message)):ne.error(F.message)}catch(F){console.error("Error creating subject:",F),ne.error("Failed to create subject. Please try again.")}finally{s(S,!1)}}async function he(F){es.confirm("Remove Subject",`<p>Are you sure you want to remove the subject <strong>"${F.name}"</strong>?</p>`,async()=>{try{const Ae=await Qa.delete("/api/subjects",{id:F.id});Ae.success?(s(fe,e(fe).filter(Qe=>Qe.id!==F.id)),ne.success(Ae.message)):ne.error(Ae.message)}catch(Ae){console.error("Error removing subject:",Ae),ne.error("Failed to remove subject. Please try again.")}},null,{size:"small"})}function Ze(){s(G,!e(G))}function K(F){s(pe,F.value),s(G,!1)}function je(){s($,!e($))}function we(F){s(_,F.value),s($,!1)}function na(){s(P,!e(P))}function ia(F){F?s(D,F.value):s(D,""),s(P,!1)}function Aa(F){F.target.closest(".adminsubject-custom-dropdown")||(s($,!1),s(G,!1),s(B,!1),s(be,!1)),F.target.closest(".adminsubject-grade-filter")||s(P,!1)}function ha(){s(B,!e(B))}function Pe(F){s(R,F),s(B,!1)}function ca(F){const Ae=Ve.find(Qe=>Qe.value===F);return Ae?Ae.name:F}function va(F){e(L)===F.id?(s(L,null),s(T,""),s(se,""),s(pe,""),s(G,!1)):(s(L,F.id),s(T,F.name),s(se,F.code),s(pe,parseInt(F.gradeLevel.replace("Grade ",""))))}async function Ie(){if(!e(T).trim()||!e(se).trim()||!e(pe)){ne.error("Please fill in all required fields");return}s(N,!0);try{const F=await Qa.put("/api/subjects",{id:e(L),name:e(T).trim(),code:e(se).trim(),gradeLevel:e(pe)});F.success?(s(fe,e(fe).map(Ae=>Ae.id===e(L)?F.data:Ae)),ne.success(F.message),s(L,null),s(T,""),s(se,""),s(pe,""),s(G,!1)):ne.error(F.message)}catch(F){console.error("Error updating subject:",F),ne.error("Failed to update subject. Please try again.")}finally{s(N,!1)}}function Ge(F){e(de)===F.id?(s(de,null),s(xe,""),s(ue,""),s(X,"event"),s(be,!1)):(s(de,F.id),s(xe,F.name),s(ue,F.code),s(X,F.icon))}async function Me(){if(!e(xe).trim()||!e(ue).trim()){ne.error("Please fill in all required fields");return}s(qe,!0);try{const F=await Qa.put("/api/activity-types",{id:e(de),name:e(xe).trim(),code:e(ue).trim(),icon:e(X)});F.success?(recentActivityTypes=recentActivityTypes.map(Ae=>Ae.id===e(de)?F.data:Ae),ne.success(F.message),s(de,null),s(xe,""),s(ue,""),s(X,"event"),s(be,!1)):ne.error(F.message)}catch(F){console.error("Error updating activity type:",F),ne.error("Failed to update activity type. Please try again.")}finally{s(qe,!1)}}function Z(){s(be,!e(be))}function J(F){s(X,F),s(be,!1)}async function c(){if(!e(M).trim()||!e(C).trim()){ne.error("Please fill in all required fields");return}s(re,!0);try{const F=await Qa.post("/api/activity-types",{name:e(M).trim(),code:e(C).trim(),icon:e(R)});F.success?(s(I,[F.data,...e(I)]),s(M,""),s(C,""),s(R,"event"),ne.success("Activity type created successfully")):ne.error(F.message)}catch(F){console.error("Error creating activity type:",F),ne.error("Failed to create activity type. Please try again.")}finally{s(re,!1)}}async function v(F){es.confirm("Remove Activity Type",`<p>Are you sure you want to remove the activity type <strong>"${F.name}"</strong>?</p>`,async()=>{try{const Ae=await Qa.delete("/api/activity-types",{id:F.id});Ae.success?(s(I,e(I).filter(Qe=>Qe.id!==F.id)),ne.success(Ae.message)):ne.error(Ae.message)}catch(Ae){console.error("Error removing activity type:",Ae),ne.error("Failed to remove activity type. Please try again.")}},null,{size:"small"})}Ya(()=>e(_),()=>{s(u,ke.find(F=>F.value===e(_)))}),Ya(()=>e(D),()=>{s(h,ke.find(F=>F.value===e(D)))}),Ya(()=>(e(fe),e(V),e(D)),()=>{s(b,e(fe).filter(F=>{const Ae=F.name.toLowerCase().includes(e(V).toLowerCase())||F.code.toLowerCase().includes(e(V).toLowerCase()),Qe=e(D)?F.gradeLevel===`Grade ${e(D)}`:!0;return Ae&&Qe}))}),Ya(()=>e(pe),()=>{s(y,ke.find(F=>F.value===e(pe)))}),ds(),is();var A=pp();q("click",Fs,Aa);var ee=t(A),Ce=r(t(ee),2),me=t(Ce);let te;var Ke=r(me,2);let f;a(Ce),a(ee);var k=r(ee,2);{var oe=F=>{var Ae=tp(),Qe=t(Ae),We=r(t(Qe),2),Xe=t(We),$a=t(Xe),xa=t($a),ie=r(t(xa),2);let x;var le=t(ie);let Le;var pa=t(le);{var He=aa=>{var ta=Vm(),ga=r(t(ta),2),za=t(ga),ja=t(za,!0);a(za),a(ga),a(ta),g(()=>l(ja,(e(u),n(()=>e(u).label)))),i(aa,ta)},sa=aa=>{var ta=Um();i(aa,ta)};m(pa,aa=>{e(u)?aa(He):aa(sa,!1)})}Xa(2),a(le);var la=r(le,2);ma(la,5,()=>ke,aa=>aa.value,(aa,ta)=>{var ga=Wm();let za;var ja=r(t(ga),2),ka=t(ja),Oa=t(ka,!0);a(ka);var lt=r(ka,2),vt=t(lt,!0);a(lt),a(ja),a(ga),g(it=>{za=W(ga,1,"adminsubject-dropdown-option",null,za,it),l(Oa,(e(ta),n(()=>e(ta).label))),l(vt,(e(ta),n(()=>e(ta).description)))},[()=>({selected:e(_)===e(ta).value})]),q("click",ga,()=>we(e(ta))),i(aa,ga)}),a(la),a(ie),a(xa);var Ee=r(xa,2),O=r(t(Ee),2);Ba(O),a(Ee);var Fe=r(Ee,2),ea=r(t(Fe),2);Ba(ea),a(Fe),a($a);var qa=r($a,2),Ia=t(qa);let st;var ra=t(Ia);{var ae=aa=>{var ta=kt("Creating...");i(aa,ta)},Re=aa=>{var ta=Ym();Xa(),i(aa,ta)};m(ra,aa=>{e(S)?aa(ae):aa(Re,!1)})}a(Ia),a(qa),a(Xe),a(We),a(Qe);var Y=r(Qe,2),Se=r(t(Y),2),Je=t(Se),Be=t(Je);Ba(Be),Xa(2),a(Je);var ge=r(Je,2);let De;var ua=t(ge);let Pa;var et=t(ua);{var Ea=aa=>{var ta=Hm(),ga=r(t(ta),2),za=t(ga),ja=t(za,!0);a(za),a(ga),a(ta),g(()=>l(ja,(e(h),n(()=>e(h).label)))),i(aa,ta)},ot=aa=>{var ta=Jm();i(aa,ta)};m(et,aa=>{e(h)?aa(Ea):aa(ot,!1)})}Xa(2),a(ua);var mt=r(ua,2),St=t(mt);let Tt;var Ft=r(St,2);ma(Ft,1,()=>ke,aa=>aa.value,(aa,ta)=>{var ga=Bm();let za;var ja=r(t(ga),2),ka=t(ja),Oa=t(ka,!0);a(ka);var lt=r(ka,2),vt=t(lt,!0);a(lt),a(ja),a(ga),g(it=>{za=W(ga,1,"adminsubject-dropdown-option",null,za,it),l(Oa,(e(ta),n(()=>e(ta).label))),l(vt,(e(ta),n(()=>e(ta).description)))},[()=>({selected:e(D)===e(ta).value})]),q("click",ga,()=>ia(e(ta))),i(aa,ga)}),a(mt),a(ge),a(Se);var Ne=r(Se,2),Ye=t(Ne);{var Sa=aa=>{var ta=Qm();i(aa,ta)},ya=aa=>{var ta=Ta(),ga=da(ta);ma(ga,1,()=>e(b),za=>za.id,(za,ja)=>{var ka=ep(),Oa=t(ka),lt=t(Oa),vt=t(lt),it=t(vt);a(vt),a(lt);var Rt=r(lt,2),ft=t(Rt),$t=t(ft),Mt=t($t),Q=t(Mt,!0);a(Mt),a($t),a(ft);var $e=r(ft,2);a(Rt),a(Oa);var oa=r(Oa,2),Fa=t(oa),tt=r(t(Fa),2),Ga=t(tt,!0);a(tt),a(Fa);var fa=r(Fa,2),_t=r(t(fa),2),pt=t(_t);a(_t),a(fa);var Ha=r(fa,2),gt=r(t(Ha),2),At=t(gt);a(gt),a(Ha),a(oa);var Lt=r(oa,2);{var Ja=Ca=>{var Ra=Xm(),Wa=t(Ra),at=r(t(Wa),2),bt=t(at),j=t(bt),ve=r(t(j),2);let ze;var ba=t(ve);let ce;var Va=t(ba);{var dt=ht=>{var jt=zm(),Yt=r(t(jt),2),as=t(Yt),ws=t(as,!0);a(as),a(Yt),a(jt),g(()=>l(ws,(e(y),n(()=>e(y).label)))),i(ht,jt)},_a=ht=>{var jt=Km();i(ht,jt)};m(Va,ht=>{e(y)?ht(dt):ht(_a,!1)})}Xa(2),a(ba);var Ma=r(ba,2);ma(Ma,5,()=>ke,ht=>ht.value,(ht,jt)=>{var Yt=Zm();let as;var ws=r(t(Yt),2),Ds=t(ws),Ls=t(Ds,!0);a(Ds);var Rs=r(Ds,2),Ts=t(Rs,!0);a(Rs),a(ws),a(Yt),g(ut=>{as=W(Yt,1,"adminsubject-dropdown-option",null,as,ut),l(Ls,(e(jt),n(()=>e(jt).label))),l(Ts,(e(jt),n(()=>e(jt).description)))},[()=>({selected:e(pe)===e(jt).value})]),q("click",Yt,()=>K(e(jt))),i(ht,Yt)}),a(Ma),a(ve),a(j);var ct=r(j,2),rt=r(t(ct),2);Ba(rt),a(ct);var Ka=r(ct,2),wa=r(t(Ka),2);Ba(wa),a(Ka),a(bt);var La=r(bt,2),nt=t(La),Ct=r(nt,2),Nt=t(Ct);{var Dt=ht=>{var jt=kt("Updating...");i(ht,jt)},Gt=ht=>{var jt=kt("Update Subject");i(ht,jt)};m(Nt,ht=>{e(N)?ht(Dt):ht(Gt,!1)})}a(Ct),a(La),a(at),a(Wa),a(Ra),g((ht,jt,Yt)=>{ze=W(ve,1,"adminsubject-custom-dropdown",null,ze,ht),ce=W(ba,1,"adminsubject-dropdown-trigger",null,ce,jt),Ct.disabled=Yt},[()=>({open:e(G)}),()=>({selected:e(pe)}),()=>(e(N),e(T),e(se),e(pe),n(()=>e(N)||!e(T).trim()||!e(se).trim()||!e(pe)))]),q("click",ba,Ze),Za(rt,()=>e(T),ht=>s(T,ht)),Za(wa,()=>e(se),ht=>s(se,ht)),q("click",nt,()=>va(e(ja))),q("submit",at,As(Ie)),i(Ca,Ra)};m(Lt,Ca=>{e(L),e(ja),n(()=>e(L)===e(ja).id)&&Ca(Ja)})}a(ka),g(()=>{Da(ka,"id",`adminsubject-subject-card-${e(ja),n(()=>e(ja).id)??""}`),l(it,`${e(ja),n(()=>e(ja).name)??""} · ${e(ja),n(()=>e(ja).gradeLevel)??""}`),Da(ft,"href",`#adminsubject-subject-card-${e(ja),n(()=>e(ja).id)??""}`),Da($t,"title",(e(L),e(ja),n(()=>e(L)===e(ja).id?"Cancel Edit":"Edit Subject"))),l(Q,(e(L),e(ja),n(()=>e(L)===e(ja).id?"close":"edit"))),l(Ga,(e(ja),n(()=>e(ja).code))),l(pt,`Created: ${e(ja),n(()=>e(ja).createdDate)??""}`),l(At,`Updated: ${e(ja),n(()=>e(ja).updatedDate)??""}`)}),q("click",$t,()=>va(e(ja))),q("click",$e,()=>he(e(ja))),i(za,ka)},za=>{var ja=ap();i(za,ja)}),i(aa,ta)};m(Ye,aa=>{e(_e)?aa(Sa):aa(ya,!1)})}a(Ne),a(Y),a(Ae),g((aa,ta,ga,za,ja,ka,Oa)=>{x=W(ie,1,"adminsubject-custom-dropdown",null,x,aa),Le=W(le,1,"adminsubject-dropdown-trigger",null,Le,ta),O.disabled=!e(_),st=W(Ia,1,"admin-create-button",null,st,ga),Ia.disabled=za,De=W(ge,1,"adminsubject-grade-filter adminsubject-custom-dropdown",null,De,ja),Pa=W(ua,1,"adminsubject-dropdown-trigger",null,Pa,ka),Tt=W(St,1,"adminsubject-dropdown-option",null,Tt,Oa)},[()=>({open:e($)}),()=>({selected:e(_)}),()=>({loading:e(S)}),()=>(e(S),e(_),e(E),n(()=>e(S)||!e(_)||!e(E).trim())),()=>({open:e(P)}),()=>({selected:e(D)}),()=>({selected:e(D)===""})]),q("click",le,je),Za(O,()=>e(E),aa=>s(E,aa)),Za(ea,()=>e(w),aa=>s(w,aa)),q("submit",Xe,As(U)),Za(Be,()=>e(V),aa=>s(V,aa)),q("click",ua,na),q("click",St,()=>ia(null)),i(F,Ae)};m(k,F=>{e(H)==="subjects"&&F(oe)})}var Te=r(k,2);{var Ue=F=>{var Ae=mp(),Qe=t(Ae),We=r(t(Qe),2),Xe=t(We),$a=t(Xe),xa=t($a),ie=r(t(xa),2);Ba(ie),a(xa);var x=r(xa,2),le=r(t(x),2);Ba(le),a(x);var Le=r(x,2),pa=r(t(Le),2);let He;var sa=t(pa);let la;var Ee=t(sa);{var O=De=>{var ua=sp(),Pa=t(ua),et=t(Pa,!0);a(Pa);var Ea=r(Pa,2),ot=t(Ea),mt=t(ot,!0);a(ot),a(Ea),a(ua),g(St=>{l(et,e(R)),l(mt,St)},[()=>(e(R),n(()=>ca(e(R))))]),i(De,ua)},Fe=De=>{var ua=rp();i(De,ua)};m(Ee,De=>{e(R)?De(O):De(Fe,!1)})}Xa(2),a(sa);var ea=r(sa,2);ma(ea,5,()=>Ve,De=>De.value,(De,ua)=>{var Pa=ip();let et;var Ea=t(Pa),ot=t(Ea,!0);a(Ea);var mt=r(Ea,2),St=t(mt),Tt=t(St,!0);a(St),a(mt),a(Pa),g(Ft=>{et=W(Pa,1,"adminsubject-dropdown-option",null,et,Ft),l(ot,(e(ua),n(()=>e(ua).value))),l(Tt,(e(ua),n(()=>e(ua).name)))},[()=>({selected:e(R)===e(ua).value})]),q("click",Pa,()=>Pe(e(ua).value)),i(De,Pa)}),a(ea),a(pa),a(Le),a($a);var qa=r($a,2),Ia=t(qa);let st;var ra=t(Ia);{var ae=De=>{var ua=kt("Creating...");i(De,ua)},Re=De=>{var ua=np();Xa(),i(De,ua)};m(ra,De=>{e(re)?De(ae):De(Re,!1)})}a(Ia),a(qa),a(Xe),a(We),a(Qe);var Y=r(Qe,2),Se=r(t(Y),2),Je=t(Se);{var Be=De=>{var ua=Ta(),Pa=da(ua);ma(Pa,1,()=>e(I),et=>et.id,(et,Ea)=>{var ot=vp(),mt=t(ot),St=t(mt),Tt=t(St),Ft=t(Tt,!0);a(Tt),a(St);var Ne=r(St,2),Ye=t(Ne),Sa=t(Ye),ya=t(Sa),aa=t(ya,!0);a(ya),a(Sa),a(Ye);var ta=r(Ye,2);a(Ne),a(mt);var ga=r(mt,2),za=t(ga),ja=r(t(za),2),ka=t(ja,!0);a(ja),a(za);var Oa=r(za,2),lt=t(Oa),vt=t(lt,!0);a(lt);var it=r(lt,2),Rt=t(it);a(it),a(Oa);var ft=r(Oa,2),$t=r(t(ft),2),Mt=t($t);a($t),a(ft);var Q=r(ft,2),$e=r(t(Q),2),oa=t($e);a($e),a(Q),a(ga);var Fa=r(ga,2);{var tt=Ga=>{var fa=cp(),_t=t(fa),pt=r(t(_t),2),Ha=t(pt),gt=t(Ha),At=r(t(gt),2);Ba(At),a(gt);var Lt=r(gt,2),Ja=r(t(Lt),2);Ba(Ja),a(Lt);var Ca=r(Lt,2),Ra=r(t(Ca),2);let Wa;var at=t(Ra);let bt;var j=t(at);{var ve=wa=>{var La=op(),nt=t(La),Ct=t(nt,!0);a(nt);var Nt=r(nt,2),Dt=t(Nt),Gt=t(Dt,!0);a(Dt),a(Nt),a(La),g(ht=>{l(Ct,e(X)),l(Gt,ht)},[()=>(e(X),n(()=>ca(e(X))))]),i(wa,La)},ze=wa=>{var La=lp();i(wa,La)};m(j,wa=>{e(X)?wa(ve):wa(ze,!1)})}Xa(2),a(at);var ba=r(at,2);ma(ba,5,()=>Ve,wa=>wa.value,(wa,La)=>{var nt=dp();let Ct;var Nt=t(nt),Dt=t(Nt,!0);a(Nt);var Gt=r(Nt,2),ht=t(Gt),jt=t(ht,!0);a(ht),a(Gt),a(nt),g(Yt=>{Ct=W(nt,1,"adminsubject-dropdown-option",null,Ct,Yt),l(Dt,(e(La),n(()=>e(La).value))),l(jt,(e(La),n(()=>e(La).name)))},[()=>({selected:e(X)===e(La).value})]),q("click",nt,()=>J(e(La).value)),i(wa,nt)}),a(ba),a(Ra),a(Ca),a(Ha);var ce=r(Ha,2),Va=t(ce),dt=t(Va);a(Va);var _a=r(Va,2);let Ma;var ct=t(_a);{var rt=wa=>{var La=kt("Updating...");i(wa,La)},Ka=wa=>{var La=kt("Update Activity Type");i(wa,La)};m(ct,wa=>{e(qe)?wa(rt):wa(Ka,!1)})}a(_a),a(ce),a(pt),a(_t),a(fa),g((wa,La,nt,Ct)=>{Wa=W(Ra,1,"adminsubject-custom-dropdown",null,Wa,wa),bt=W(at,1,"adminsubject-dropdown-trigger",null,bt,La),Da(Va,"href",`#adminactivity-activity-card-${e(Ea),n(()=>e(Ea).id)??""}`),Ma=W(_a,1,"adminsubject-submit-button",null,Ma,nt),_a.disabled=Ct},[()=>({open:e(be)}),()=>({selected:e(X)}),()=>({loading:e(qe)}),()=>(e(qe),e(xe),e(ue),n(()=>e(qe)||!e(xe).trim()||!e(ue).trim()))]),Za(At,()=>e(xe),wa=>s(xe,wa)),Za(Ja,()=>e(ue),wa=>s(ue,wa)),q("click",at,Z),q("click",dt,()=>Ge(e(Ea))),q("submit",pt,As(Me)),i(Ga,fa)};m(Fa,Ga=>{e(de),e(Ea),n(()=>e(de)===e(Ea).id)&&Ga(tt)})}a(ot),g(Ga=>{Da(ot,"id",`adminactivity-activity-card-${e(Ea),n(()=>e(Ea).id)??""}`),l(Ft,(e(Ea),n(()=>e(Ea).name))),Da(Ye,"href",`#adminactivity-activity-card-${e(Ea),n(()=>e(Ea).id)??""}`),Da(Sa,"title",(e(de),e(Ea),n(()=>e(de)===e(Ea).id?"Cancel Edit":"Edit Activity Type"))),l(aa,(e(de),e(Ea),n(()=>e(de)===e(Ea).id?"close":"edit"))),l(ka,(e(Ea),n(()=>e(Ea).code))),ks(lt,`color: var(--${e(Ea),n(()=>e(Ea).color)??""}-500)`),l(vt,(e(Ea),n(()=>e(Ea).icon))),l(Rt,`Icon: ${e(Ea),n(()=>e(Ea).icon)??""}`),l(Mt,`Color: ${e(Ea),n(()=>e(Ea).color)??""}`),l(oa,`Created: ${Ga??""}`)},[()=>n(()=>new Date().toLocaleDateString())]),q("click",Sa,()=>Ge(e(Ea))),q("click",ta,()=>v(e(Ea))),i(et,ot)}),i(De,ua)},ge=De=>{var ua=up();i(De,ua)};m(Je,De=>{e(I),n(()=>e(I).length>0)?De(Be):De(ge,!1)})}a(Se),a(Y),a(Ae),g((De,ua,Pa,et)=>{He=W(pa,1,"adminsubject-custom-dropdown",null,He,De),la=W(sa,1,"adminsubject-dropdown-trigger",null,la,ua),st=W(Ia,1,"admin-create-button",null,st,Pa),Ia.disabled=et},[()=>({open:e(B)}),()=>({selected:e(R)}),()=>({loading:e(re)}),()=>(e(re),e(M),e(C),n(()=>e(re)||!e(M).trim()||!e(C).trim()))]),Za(ie,()=>e(M),De=>s(M,De)),Za(le,()=>e(C),De=>s(C,De)),q("click",sa,ha),q("submit",Xe,As(c)),i(F,Ae)};m(Te,F=>{e(H)==="activities"&&F(Ue)})}a(A),g((F,Ae)=>{te=W(me,1,"admin-tab-button",null,te,F),f=W(Ke,1,"admin-tab-button",null,f,Ae)},[()=>({active:e(H)==="subjects"}),()=>({active:e(H)==="activities"})]),q("click",me,()=>s(H,"subjects")),q("click",Ke,()=>s(H,"activities")),i(z,A),It()}var _p=o('<span class="material-symbols-outlined">add_ad</span> Create Department',1),gp=o('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),bp=o('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),hp=o('<span class="placeholder">Filter by type</span>'),yp=o('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),wp=o('<div class="dept-mgmt-loading"><span class="dept-loader"></span> <p>Loading departments...</p></div>'),Sp=o('<div class="dept-mgmt-empty-state"><span class="material-symbols-outlined dept-mgmt-empty-icon">corporate_fare</span> <h3 class="dept-mgmt-empty-title"> </h3> <p class="dept-mgmt-empty-description"> </p></div>'),xp=o('<div class="dept-mgmt-edit-form-section"><div class="dept-mgmt-edit-form-container" id="admin-department-edit-form-container"><div class="dept-mgmt-edit-form-header"><h2 class="dept-mgmt-edit-form-title">Edit Department</h2> <p class="dept-mgmt-edit-form-subtitle">Update department information</p></div> <form class="dept-mgmt-edit-form-content"><div class="dept-mgmt-edit-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-name">Department Name *</label> <input type="text" id="edit-department-name" class="dept-mgmt-form-input" placeholder="Enter department name" required/></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-code">Department Code *</label> <input type="text" id="edit-department-code" class="dept-mgmt-form-input" placeholder="Enter department code" required/></div></div> <div class="dept-mgmt-edit-form-actions"><a><button type="button" class="dept-mgmt-cancel-button">Cancel</button></a> <button type="submit" class="dept-mgmt-update-button"><!></button></div></form></div></div>'),kp=o('<button type="button" class="dept-mgmt-select-all-btn"><span class="material-symbols-outlined"> </span></button>'),Ap=o('<button type="button"><div class="dept-mgmt-subject-checkbox"><span class="material-symbols-outlined"> </span></div> <span class="material-symbols-outlined dept-mgmt-option-icon">subject</span> <div class="dept-mgmt-option-content"><span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div></button>'),Dp=o('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">subject</span> <span>No subjects found</span></div>'),Tp=o('<div class="dept-mgmt-selected-subject-chip"><span class="dept-mgmt-subject-name"> </span> <span class="dept-mgmt-subject-code"> </span> <button type="button" class="dept-mgmt-remove-subject"><span class="material-symbols-outlined">close</span></button></div>'),Np=o('<div class="dept-mgmt-selected-subjects"><div class="dept-mgmt-selected-subjects-header"><span class="dept-mgmt-selected-count"> </span></div> <div class="dept-mgmt-selected-subjects-list"></div></div>'),jp=o('<button type="button" class="dept-mgmt-select-all-btn"><span class="material-symbols-outlined"> </span></button>'),$p=o('<button type="button"><div class="dept-mgmt-teacher-checkbox"><span class="material-symbols-outlined"> </span></div> <span class="material-symbols-outlined dept-mgmt-option-icon">person</span> <div class="dept-mgmt-option-content"><span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div></button>'),Cp=o('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No teachers found</span></div>'),qp=o('<div class="dept-mgmt-selected-teacher-chip"><span class="dept-mgmt-teacher-name"> </span> <span class="dept-mgmt-teacher-subject"> </span> <button type="button" class="dept-mgmt-remove-teacher"><span class="material-symbols-outlined">close</span></button></div>'),Ep=o('<div class="dept-mgmt-selected-teachers"><div class="dept-mgmt-selected-teachers-header"><span class="dept-mgmt-selected-count"> </span></div> <div class="dept-mgmt-selected-teachers-list"></div></div>'),Fp=o('<div class="dept-mgmt-assign-form-section"><div class="dept-mgmt-assign-form-container"><div class="dept-mgmt-assign-form-header"><h2 class="dept-mgmt-assign-form-title">Assign Subjects & Teachers</h2> <p class="dept-mgmt-assign-form-subtitle">Select subjects and teachers for this department</p></div> <form class="dept-mgmt-assign-form-content"><div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="subjects">Select Subjects</label> <div><button type="button" id="subjects"><span class="dept-mgmt-placeholder">Add subjects to department</span> <span class="material-symbols-outlined dept-mgmt-dropdown-arrow">expand_more</span></button> <div class="dept-mgmt-dropdown-menu"><div class="dept-mgmt-search-container"><!> <input type="text" class="dept-mgmt-search-input" placeholder="Search subjects..."/> <span>search</span></div> <!> <!></div></div> <p class="dept-mgmt-form-help">Select subjects that will be managed by this department.</p> <!></div></div> <div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="teachers">Select Teachers</label> <div><button type="button" id="teachers"><span class="dept-mgmt-placeholder">Add teachers to department</span> <span class="material-symbols-outlined dept-mgmt-dropdown-arrow">expand_more</span></button> <div class="dept-mgmt-dropdown-menu"><div class="dept-mgmt-search-container"><!> <input type="text" class="dept-mgmt-search-input" placeholder="Search teachers..."/> <span>search</span></div> <!> <!></div></div> <p class="dept-mgmt-form-help">Select teachers who will be part of this department.</p> <!></div></div> <div class="dept-mgmt-assign-actions"><button type="button" class="dept-mgmt-cancel-button">Cancel</button> <button type="submit" class="dept-mgmt-assign-submit-button"><!></button></div></form></div></div>'),Lp=o('<div><div class="dept-mgmt-department-header"><div class="dept-mgmt-department-title"><h3 class="dept-mgmt-department-name"> </h3></div> <div class="dept-mgmt-action-buttons"><a><button type="button" class="dept-mgmt-assign-button"><span class="material-symbols-outlined"> </span></button></a> <a><button type="button" class="dept-mgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="dept-mgmt-remove-button" title="Remove Department"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="dept-mgmt-department-details"><div class="dept-mgmt-department-code"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="dept-mgmt-department-subjects"><span class="material-symbols-outlined">subject</span> <span> </span></div> <div class="dept-mgmt-department-teachers"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="dept-mgmt-department-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!> <!></div>'),Pp=o('<div class="dept-mgmt-container"><div class="dept-mgmt-header"><div class="dept-mgmt-header-content"><h1 class="dept-mgmt-page-title">Department Management</h1> <p class="dept-mgmt-page-subtitle">Create and manage academic departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-create-section"><h2 class="dept-mgmt-section-title">Create New Department</h2> <p class="dept-mgmt-section-subtitle">Add a new academic department to organize subjects and teachers</p> <div class="dept-mgmt-create-form"><div class="dept-mgmt-form-row"><div class="dept-mgmt-form-group"><label for="departmentName" class="dept-mgmt-form-label">Department Name *</label> <input id="departmentName" type="text" placeholder="e.g., Mathematics Department" class="dept-mgmt-form-input"/></div> <div class="dept-mgmt-form-group"><label for="departmentCode" class="dept-mgmt-form-label">Department Code *</label> <input id="departmentCode" type="text" placeholder="e.g., MATH-DEPT" class="dept-mgmt-form-input"/></div></div> <div class="dept-mgmt-form-actions"><button type="submit" class="dept-mgmt-btn-primary"><!></button></div></div></div> <div class="dept-mgmt-departments-section"><div class="dept-mgmt-section-header"><div class="section-title-group"><h2 class="dept-mgmt-section-title">All Departments</h2> <p class="dept-mgmt-section-subtitle">Manage existing departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search departments by name or code..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div> <div class="dept-mgmt-departments-grid"><!></div></div></div>');function Ip(z,d){Pt(d,!1);const u=p(),h=p(),b=p();let y=p(!1),S=p([]),_=p([]),E=p(""),w=p(""),$=p(""),P=p([]),V=p([]),D=p("all"),L=p(!1),T=p(null),se=p(""),pe=p(""),N=p(!1),G=p(null),H=p(!1),I=p([]),re=p([]),M=p(!1),C=p(!1),R=p(""),B=p(""),de=p(!1);const xe=[{id:"all",name:"All Departments",icon:"corporate_fare"},{id:"with_subjects",name:"With Subjects",icon:"book"},{id:"with_teachers",name:"With Teachers",icon:"person"},{id:"empty",name:"Empty Departments",icon:"folder_open"}];async function ue(){s(de,!0);try{const O=await Qa.get("/api/departments?action=departments");O.success?s(P,O.data.map(Fe=>({id:Fe.id,name:Fe.name,code:Fe.code,subjects:Fe.subjects||[],teachers:Fe.teachers||[],createdAt:Fe.created_at?Fe.created_at.split("T")[0]:new Date().toISOString().split("T")[0]}))):ne.error("Failed to load departments")}catch(O){console.error("Error fetching departments:",O),ne.error("Failed to load departments")}finally{s(de,!1)}}async function X(){try{const O=await Qa.get("/api/departments?action=subjects");O.success?s(I,O.data.map(Fe=>({id:Fe.id,name:Fe.name,code:Fe.code,gradeLevel:`Grade ${Fe.grade_level}`}))):ne.error("Failed to load subjects")}catch(O){console.error("Error fetching subjects:",O),ne.error("Failed to load subjects")}finally{}}async function qe(){try{const O=await Qa.get("/api/departments?action=teachers");O.success?s(re,O.data.map(Fe=>({id:Fe.id,name:Fe.full_name||`${Fe.first_name} ${Fe.last_name}`,accountNumber:Fe.account_number}))):ne.error("Failed to load teachers")}catch(O){console.error("Error fetching teachers:",O),ne.error("Failed to load teachers")}finally{}}Wt(async()=>{await Promise.all([ue(),X(),qe()]),be()});function be(O=e(P),Fe=e(D),ea=e(E)){let qa=[...O];Fe==="with_subjects"?qa=qa.filter(Ia=>Ia.subjects.length>0):Fe==="with_teachers"?qa=qa.filter(Ia=>Ia.teachers.length>0):Fe==="empty"&&(qa=qa.filter(Ia=>Ia.subjects.length===0&&Ia.teachers.length===0)),ea.trim()!==""&&(qa=qa.filter(Ia=>Ia.name.toLowerCase().includes(ea.toLowerCase())||Ia.code.toLowerCase().includes(ea.toLowerCase()))),s(V,qa)}function _e(){s(L,!e(L))}function fe(O){s(D,O.id),s(L,!1)}async function ke(){if(!e(w).trim()||!e($).trim()){ne.error("Please fill in all required fields");return}if(e(P).some(O=>O.code.toLowerCase()===e($).toLowerCase())){ne.error("Department code already exists");return}s(y,!0);try{const O=await Qa.post("/api/departments",{name:e(w).trim(),code:e($).trim().toUpperCase()});O.success?(await ue(),s(w,""),s($,""),ne.success("Department created successfully")):ne.error(O.error||"Failed to create department")}catch(O){console.error("Error creating department:",O);const Fe=O.message||"Failed to create department. Please try again.";ne.error(Fe)}finally{s(y,!1)}}async function Ve(O){if(O.preventDefault(),!e(N)){s(N,!0);try{if(!e(se).trim()||!e(pe).trim()){ne.error("Department name and code are required");return}if(e(pe).trim().length>20){ne.error("Department code cannot exceed 20 characters");return}if(e(P).find(ra=>ra.code.toLowerCase()===e(pe).trim().toLowerCase()&&ra.id!==e(T))){ne.error("Department code already exists");return}const ea=e(P).find(ra=>ra.id===e(T));if(!ea)throw new Error("Department not found");const qa=ea.teachers?ea.teachers.map(ra=>ra.id):[],Ia=ea.subjects?ea.subjects.map(ra=>ra.id):[],st=await Qa.put("/api/departments",{id:e(T),name:e(se).trim(),code:e(pe).trim().toUpperCase(),teachers:qa,subjects:Ia});st.success?(await ue(),s(T,null),s(se,""),s(pe,""),ne.success("Department updated successfully")):ne.error(st.error||"Failed to update department")}catch(Fe){console.error("Error updating department:",Fe);const ea=Fe.message||"Failed to update department. Please try again.";ne.error(ea)}finally{s(N,!1)}}}function ye(O){e(T)===O.id?(s(T,null),s(se,""),s(pe,"")):(e(G)===O.id&&(s(G,null),s(S,[]),s(_,[]),s(M,!1),s(C,!1),s(R,""),s(B,"")),s(T,O.id),s(se,O.name),s(pe,O.code))}function Oe(O){es.confirm("Remove Department",`<p>Are you sure you want to remove the department <strong>"${O.name}"</strong>?</p>
			 <p class="warning-text">This action will also remove all subject and teacher assignments.</p>`,async()=>{try{const Fe=await Qa.delete("/api/departments",{id:O.id,name:O.name});Fe.success?(await ue(),ne.success("Department removed successfully")):ne.error(Fe.error||"Failed to remove department")}catch(Fe){console.error("Error removing department:",Fe),ne.error("Failed to remove department. Please try again.")}},()=>{},{size:"small"})}function U(O){e(G)===O.id?(s(G,null),s(S,[]),s(_,[]),s(M,!1),s(C,!1),s(R,""),s(B,"")):(e(T)===O.id&&(s(T,null),s(se,""),s(pe,"")),s(G,O.id),s(S,O.subjects?O.subjects.map(Fe=>Fe.id):[]),s(_,O.teachers?O.teachers.map(Fe=>Fe.id):[]),s(M,!1),s(C,!1),s(R,""),s(B,""))}function he(){s(M,!e(M)),e(M)&&s(C,!1)}function Ze(){s(C,!e(C)),e(C)&&s(M,!1)}function K(O){e(S).findIndex(ea=>ea===O.id)>-1?s(S,e(S).filter(ea=>ea!==O.id)):s(S,[...e(S),O.id])}function je(O){e(_).findIndex(ea=>ea===O.id)>-1?s(_,e(_).filter(ea=>ea!==O.id)):s(_,[...e(_),O.id])}function we(){if(e(h).every(Fe=>e(S).some(ea=>ea===Fe.id)))s(S,e(S).filter(Fe=>!e(h).some(ea=>ea.id===Fe)));else{const Fe=e(h).filter(ea=>!e(S).some(qa=>qa===ea.id)).map(ea=>ea.id);s(S,[...e(S),...Fe])}}function na(){if(e(b).every(Fe=>e(_).some(ea=>ea===Fe.id)))s(_,e(_).filter(Fe=>!e(b).some(ea=>ea.id===Fe)));else{const Fe=e(b).filter(ea=>!e(_).some(qa=>qa===ea.id)).map(ea=>ea.id);s(_,[...e(_),...Fe])}}function ia(O){s(S,e(S).filter(Fe=>Fe!==O))}function Aa(O){s(_,e(_).filter(Fe=>Fe!==O))}async function ha(){s(H,!0);try{const O=e(P).find(qa=>qa.id===e(G));if(!O)throw new Error("Department not found");const Fe={id:e(G),name:O.name,code:O.code,teachers:e(_),subjects:e(S)},ea=await Qa.put("/api/departments",Fe);if(!ea.success)throw new Error(ea.error||"Failed to update assignments");s(P,e(P).map(qa=>{if(qa.id===e(G)){const Ia=e(I).filter(ra=>e(S).includes(ra.id)),st=e(re).filter(ra=>e(_).includes(ra.id));return{...qa,subjects:Ia,teachers:st}}return qa})),ne.success("Department assignments updated successfully"),s(G,null),s(S,[]),s(_,[])}catch(O){console.error("Error assigning department:",O),ne.error("Failed to update assignments. Please try again.")}finally{s(H,!1)}}function Pe(O){return O.subjects||[]}function ca(O){return O.teachers||[]}function va(O){}function Ie(O){if(!O)return"";const Fe=O.split("-");return Fe.length===3?`${Fe[1]}-${Fe[2]}-${Fe[0]}`:O}Ya(()=>e(D),()=>{s(u,xe.find(O=>O.id===e(D)))}),Ya(()=>(e(P),e(D),e(E)),()=>{e(P)&&be(e(P),e(D),e(E))}),Ya(()=>(e(I),e(R)),()=>{s(h,e(I).filter(O=>O.name.toLowerCase().includes(e(R).toLowerCase())||O.code.toLowerCase().includes(e(R).toLowerCase())))}),Ya(()=>(e(re),e(B)),()=>{s(b,e(re).filter(O=>O.name.toLowerCase().includes(e(B).toLowerCase())||O.accountNumber.toLowerCase().includes(e(B).toLowerCase())))}),ds(),is();var Ge=Pp();q("click",Fs,va);var Me=r(t(Ge),2),Z=r(t(Me),4),J=t(Z),c=t(J),v=r(t(c),2);Ba(v),a(c);var A=r(c,2),ee=r(t(A),2);Ba(ee),a(A),a(J);var Ce=r(J,2),me=t(Ce),te=t(me);{var Ke=O=>{var Fe=kt("Creating...");i(O,Fe)},f=O=>{var Fe=_p();Xa(),i(O,Fe)};m(te,O=>{e(y)?O(Ke):O(f,!1)})}a(me),a(Ce),a(Z),a(Me);var k=r(Me,2),oe=r(t(k),2),Te=t(oe),Ue=t(Te),F=r(t(Ue),2);Ba(F);var Ae=r(F,2);{var Qe=O=>{var Fe=gp();q("click",Fe,()=>s(E,"")),i(O,Fe)};m(Ae,O=>{e(E)&&O(Qe)})}a(Ue),a(Te);var We=r(Te,2),Xe=t(We);let $a;var xa=t(Xe);let ie;var x=t(xa);{var le=O=>{var Fe=bp(),ea=t(Fe),qa=t(ea,!0);a(ea);var Ia=r(ea,2),st=t(Ia),ra=t(st,!0);a(st),a(Ia),a(Fe),g(()=>{l(qa,(e(u),n(()=>e(u).icon))),l(ra,(e(u),n(()=>e(u).name)))}),i(O,Fe)},Le=O=>{var Fe=hp();i(O,Fe)};m(x,O=>{e(u)?O(le):O(Le,!1)})}Xa(2),a(xa);var pa=r(xa,2);ma(pa,5,()=>xe,O=>O.id,(O,Fe)=>{var ea=yp();let qa;var Ia=t(ea),st=t(Ia,!0);a(Ia);var ra=r(Ia,2),ae=t(ra),Re=t(ae,!0);a(ae),a(ra),a(ea),g(Y=>{qa=W(ea,1,"dropdown-option",null,qa,Y),l(st,(e(Fe),n(()=>e(Fe).icon))),l(Re,(e(Fe),n(()=>e(Fe).name)))},[()=>({selected:e(D)===e(Fe).id})]),q("click",ea,()=>fe(e(Fe))),i(O,ea)}),a(pa),a(Xe),a(We),a(oe);var He=r(oe,2),sa=t(He);{var la=O=>{var Fe=wp();i(O,Fe)},Ee=O=>{var Fe=Ta(),ea=da(Fe);{var qa=st=>{var ra=Sp(),ae=r(t(ra),2),Re=t(ae,!0);a(ae);var Y=r(ae,2),Se=t(Y,!0);a(Y),a(ra),g(()=>{l(Re,e(E)?"No departments found":"No departments created yet"),l(Se,e(E)?"Try adjusting your search terms":"Create your first department to get started")}),i(st,ra)},Ia=st=>{var ra=Ta(),ae=da(ra);ma(ae,1,()=>e(V),Re=>Re.id,(Re,Y)=>{var Se=Lp();let Je;var Be=t(Se),ge=t(Be),De=t(ge),ua=t(De,!0);a(De),a(ge);var Pa=r(ge,2),et=t(Pa),Ea=t(et),ot=t(Ea),mt=t(ot,!0);a(ot),a(Ea),a(et);var St=r(et,2),Tt=t(St),Ft=t(Tt),Ne=t(Ft,!0);a(Ft),a(Tt),a(St);var Ye=r(St,2);a(Pa),a(Be);var Sa=r(Be,2),ya=t(Sa),aa=r(t(ya),2),ta=t(aa,!0);a(aa),a(ya);var ga=r(ya,2),za=r(t(ga),2),ja=t(za);a(za),a(ga);var ka=r(ga,2),Oa=r(t(ka),2),lt=t(Oa);a(Oa),a(ka);var vt=r(ka,2),it=r(t(vt),2),Rt=t(it);a(it),a(vt),a(Sa);var ft=r(Sa,2);{var $t=$e=>{var oa=xp(),Fa=t(oa),tt=r(t(Fa),2),Ga=t(tt),fa=t(Ga),_t=r(t(fa),2);Ba(_t),a(fa);var pt=r(fa,2),Ha=r(t(pt),2);Ba(Ha),a(pt),a(Ga);var gt=r(Ga,2),At=t(gt),Lt=t(At);a(At);var Ja=r(At,2),Ca=t(Ja);{var Ra=at=>{var bt=kt("Updating...");i(at,bt)},Wa=at=>{var bt=kt("Update Department");i(at,bt)};m(Ca,at=>{e(N)?at(Ra):at(Wa,!1)})}a(Ja),a(gt),a(tt),a(Fa),a(oa),g(()=>{Da(At,"href",`#department-card-${e(Y),n(()=>e(Y).id)??""}`),Ja.disabled=e(N)||!e(se)||!e(pe)}),Za(_t,()=>e(se),at=>s(se,at)),Za(Ha,()=>e(pe),at=>s(pe,at)),q("click",Lt,()=>ye(e(Y))),q("submit",tt,As(Ve)),i($e,oa)};m(ft,$e=>{e(T),e(Y),n(()=>e(T)===e(Y).id)&&$e($t)})}var Mt=r(ft,2);{var Q=$e=>{var oa=Fp(),Fa=t(oa),tt=r(t(Fa),2),Ga=t(tt),fa=t(Ga),_t=r(t(fa),2);let pt;var Ha=t(_t);let gt;var At=r(Ha,2),Lt=t(At),Ja=t(Lt);{var Ca=ut=>{const wt=qs(()=>(e(h),e(S),n(()=>e(h).every(Bt=>e(S).some(rs=>rs===Bt.id)))));var qt=kp(),Qt=t(qt),ts=t(Qt,!0);a(Qt),a(qt),g(()=>{Da(qt,"title",`${e(wt)?"Unselect All":"Select All"} (${e(h),n(()=>e(h).length)??""})`),l(ts,e(wt)?"deselect":"select_all")}),q("click",qt,we),i(ut,qt)};m(Ja,ut=>{e(h),n(()=>e(h).length>0)&&ut(Ca)})}var Ra=r(Ja,2);Ba(Ra);var Wa=r(Ra,2);let at;a(Lt);var bt=r(Lt,2);ma(bt,1,()=>e(h),ut=>ut.id,(ut,wt)=>{var qt=Ap();let Qt;var ts=t(qt),Bt=t(ts),rs=t(Bt,!0);a(Bt),a(ts);var cs=r(ts,4),Ht=t(cs),hs=t(Ht,!0);a(Ht);var gs=r(Ht,2),Ss=t(gs);a(gs),a(cs),a(qt),g((Jt,Et)=>{Qt=W(qt,1,"dept-mgmt-dropdown-option dept-mgmt-subject-option",null,Qt,Jt),l(rs,Et),l(hs,(e(wt),n(()=>e(wt).name))),l(Ss,`${e(wt),n(()=>e(wt).code)??""} • ${e(wt),n(()=>e(wt).gradeLevel)??""}`)},[()=>({selected:e(S).some(Jt=>Jt===e(wt).id)}),()=>(e(S),e(wt),n(()=>e(S).some(Jt=>Jt===e(wt).id)?"check_box":"check_box_outline_blank"))]),q("click",qt,()=>K(e(wt))),i(ut,qt)});var j=r(bt,2);{var ve=ut=>{var wt=Dp();i(ut,wt)};m(j,ut=>{e(h),n(()=>e(h).length===0)&&ut(ve)})}a(At),a(_t);var ze=r(_t,4);{var ba=ut=>{var wt=Np(),qt=t(wt),Qt=t(qt),ts=t(Qt);a(Qt),a(qt);var Bt=r(qt,2);ma(Bt,5,()=>e(S),rs=>rs,(rs,cs)=>{const Ht=qs(()=>(e(I),e(cs),n(()=>e(I).find(Jt=>Jt.id===e(cs)))));var hs=Ta(),gs=da(hs);{var Ss=Jt=>{var Et=Tp(),Ot=t(Et),zt=t(Ot,!0);a(Ot);var ss=r(Ot,2),Ps=t(ss,!0);a(ss);var $s=r(ss,2);a(Et),g(()=>{l(zt,(Zt(e(Ht)),n(()=>e(Ht).name))),l(Ps,(Zt(e(Ht)),n(()=>e(Ht).code))),Da($s,"aria-label",`Remove ${Zt(e(Ht)),n(()=>e(Ht).name)??""}`)}),q("click",$s,()=>ia(e(cs))),i(Jt,Et)};m(gs,Jt=>{e(Ht)&&Jt(Ss)})}i(rs,hs)}),a(Bt),a(wt),g(()=>l(ts,`${e(S),n(()=>e(S).length)??""} subject${e(S),n(()=>e(S).length!==1?"s":"")??""} selected`)),i(ut,wt)};m(ze,ut=>{e(S),n(()=>e(S).length>0)&&ut(ba)})}a(fa),a(Ga);var ce=r(Ga,2),Va=t(ce),dt=r(t(Va),2);let _a;var Ma=t(dt);let ct;var rt=r(Ma,2),Ka=t(rt),wa=t(Ka);{var La=ut=>{const wt=qs(()=>(e(b),e(_),n(()=>e(b).every(Bt=>e(_).some(rs=>rs===Bt.id)))));var qt=jp(),Qt=t(qt),ts=t(Qt,!0);a(Qt),a(qt),g(()=>{Da(qt,"title",`${e(wt)?"Unselect All":"Select All"} (${e(b),n(()=>e(b).length)??""})`),l(ts,e(wt)?"deselect":"select_all")}),q("click",qt,na),i(ut,qt)};m(wa,ut=>{e(b),n(()=>e(b).length>0)&&ut(La)})}var nt=r(wa,2);Ba(nt);var Ct=r(nt,2);let Nt;a(Ka);var Dt=r(Ka,2);ma(Dt,1,()=>e(b),ut=>ut.id,(ut,wt)=>{var qt=$p();let Qt;var ts=t(qt),Bt=t(ts),rs=t(Bt,!0);a(Bt),a(ts);var cs=r(ts,4),Ht=t(cs),hs=t(Ht,!0);a(Ht);var gs=r(Ht,2),Ss=t(gs,!0);a(gs),a(cs),a(qt),g((Jt,Et)=>{Qt=W(qt,1,"dept-mgmt-dropdown-option dept-mgmt-teacher-option",null,Qt,Jt),l(rs,Et),l(hs,(e(wt),n(()=>e(wt).name))),l(Ss,(e(wt),n(()=>e(wt).accountNumber)))},[()=>({selected:e(_).some(Jt=>Jt===e(wt).id)}),()=>(e(_),e(wt),n(()=>e(_).some(Jt=>Jt===e(wt).id)?"check_box":"check_box_outline_blank"))]),q("click",qt,()=>je(e(wt))),i(ut,qt)});var Gt=r(Dt,2);{var ht=ut=>{var wt=Cp();i(ut,wt)};m(Gt,ut=>{e(b),n(()=>e(b).length===0)&&ut(ht)})}a(rt),a(dt);var jt=r(dt,4);{var Yt=ut=>{var wt=Ep(),qt=t(wt),Qt=t(qt),ts=t(Qt);a(Qt),a(qt);var Bt=r(qt,2);ma(Bt,5,()=>e(_),rs=>rs,(rs,cs)=>{const Ht=qs(()=>(e(re),e(cs),n(()=>e(re).find(Jt=>Jt.id===e(cs)))));var hs=Ta(),gs=da(hs);{var Ss=Jt=>{var Et=qp(),Ot=t(Et),zt=t(Ot,!0);a(Ot);var ss=r(Ot,2),Ps=t(ss,!0);a(ss);var $s=r(ss,2);a(Et),g(()=>{l(zt,(Zt(e(Ht)),n(()=>e(Ht).name))),l(Ps,(Zt(e(Ht)),n(()=>e(Ht).accountNumber))),Da($s,"aria-label",`Remove ${Zt(e(Ht)),n(()=>e(Ht).name)??""}`)}),q("click",$s,()=>Aa(e(cs))),i(Jt,Et)};m(gs,Jt=>{e(Ht)&&Jt(Ss)})}i(rs,hs)}),a(Bt),a(wt),g(()=>l(ts,`${e(_),n(()=>e(_).length)??""} teacher${e(_),n(()=>e(_).length!==1?"s":"")??""} selected`)),i(ut,wt)};m(jt,ut=>{e(_),n(()=>e(_).length>0)&&ut(Yt)})}a(Va),a(ce);var as=r(ce,2),ws=t(as),Ds=r(ws,2),Ls=t(Ds);{var Rs=ut=>{var wt=kt("Assigning...");i(ut,wt)},Ts=ut=>{var wt=kt("Update");i(ut,wt)};m(Ls,ut=>{e(H)?ut(Rs):ut(Ts,!1)})}a(Ds),a(as),a(tt),a(Fa),a(oa),g((ut,wt,qt,Qt,ts,Bt)=>{pt=W(_t,1,"dept-mgmt-custom-dropdown",null,pt,ut),gt=W(Ha,1,"dept-mgmt-dropdown-trigger",null,gt,wt),at=W(Wa,1,"material-symbols-outlined",null,at,qt),_a=W(dt,1,"dept-mgmt-custom-dropdown",null,_a,Qt),ct=W(Ma,1,"dept-mgmt-dropdown-trigger",null,ct,ts),Nt=W(Ct,1,"material-symbols-outlined",null,Nt,Bt),Ds.disabled=e(H)},[()=>({open:e(M)}),()=>({selected:e(S).length>0}),()=>({"dept-mgmt-search-icon-create":e(h).length>0,"dept-mgmt-search-icon":e(h).length===0}),()=>({open:e(C)}),()=>({selected:e(_).length>0}),()=>({"dept-mgmt-search-icon-create":e(b).length>0,"dept-mgmt-search-icon":e(b).length===0})]),q("click",Ha,he),Za(Ra,()=>e(R),ut=>s(R,ut)),q("click",Ma,Ze),Za(nt,()=>e(B),ut=>s(B,ut)),q("click",ws,()=>U(e(Y))),q("submit",tt,As(ha)),i($e,oa)};m(Mt,$e=>{e(G),e(Y),n(()=>e(G)===e(Y).id)&&$e(Q)})}a(Se),g(($e,oa,Fa,tt)=>{Je=W(Se,1,"dept-mgmt-department-card",null,Je,$e),Da(Se,"id",`department-card-${e(Y),n(()=>e(Y).id)??""}`),l(ua,(e(Y),n(()=>e(Y).name))),Da(et,"href",`#department-card-${e(Y),n(()=>e(Y).id)??""}`),Da(Ea,"title",(e(G),e(Y),n(()=>e(G)===e(Y).id?"Cancel Assign":"Assign"))),l(mt,(e(G),e(Y),n(()=>e(G)===e(Y).id?"close":"add_circle"))),Da(St,"href",`#department-card-${e(Y),n(()=>e(Y).id)??""}`),Da(Tt,"title",(e(T),e(Y),n(()=>e(T)===e(Y).id?"Cancel Edit":"Edit Department"))),l(Ne,(e(T),e(Y),n(()=>e(T)===e(Y).id?"close":"edit"))),l(ta,(e(Y),n(()=>e(Y).code))),l(ja,`${oa??""} Subjects`),l(lt,`${Fa??""} Teachers`),l(Rt,`Created: ${tt??""}`)},[()=>({editing:e(T)===e(Y).id,assigning:e(G)===e(Y).id}),()=>(e(Y),n(()=>Pe(e(Y)).length)),()=>(e(Y),n(()=>ca(e(Y)).length)),()=>(e(Y),n(()=>Ie(e(Y).createdAt)))]),q("click",Ea,()=>U(e(Y))),q("click",Tt,()=>ye(e(Y))),q("click",Ye,()=>Oe(e(Y))),i(Re,Se)}),i(st,ra)};m(ea,st=>{e(V),n(()=>e(V).length===0)?st(qa):st(Ia,!1)},!0)}i(O,Fe)};m(sa,O=>{e(de)?O(la):O(Ee,!1)})}a(He),a(k),a(Ge),g((O,Fe)=>{v.disabled=e(y),ee.disabled=e(y),me.disabled=e(y)||!e(w)||!e($),$a=W(Xe,1,"custom-dropdown",null,$a,O),ie=W(xa,1,"dropdown-trigger filter-trigger",null,ie,Fe)},[()=>({open:e(L)}),()=>({selected:e(D)!=="all"})]),Za(v,()=>e(w),O=>s(w,O)),Za(ee,()=>e($),O=>s($,O)),q("click",me,ke),Za(F,()=>e(E),O=>s(E,O)),q("click",xa,_e),i(z,Ge),It()}var Gp=o('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),Mp=o('<span class="admindocreq-placeholder">All Statuses</span>'),Rp=o('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),Op=o('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),Vp=o('<span class="admindocreq-placeholder">All Document Types</span>'),Up=o('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),Wp=o('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),Yp=o('<span class="admindocreq-placeholder">All Grades</span>'),Hp=o('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),Jp=o('<div class="admindocreq-loading"><div class="system-loader"></div> <p>Loading document requests...</p></div>'),Bp=o('<div class="admindocreq-error"><span class="material-symbols-outlined admindocreq-error-icon">error</span> <p> </p> <button class="admindocreq-retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Qp=o('<div class="admindocreq-request-priority"><span class="material-symbols-outlined">info</span> <span> </span></div>'),zp=o('<div class="admindocreq-request-actions"><button class="admindocreq-approve-button"><span class="material-symbols-outlined">check_circle</span> Approve</button> <button class="admindocreq-reject-button"><span class="material-symbols-outlined">cancel</span> Reject</button></div>'),Kp=o('<span class="admindocreq-footer-info"> </span>'),Zp=o('<div class="admindocreq-request-actions processing-footer"><!> <button class="admindocreq-complete-button"><span class="material-symbols-outlined">task_alt</span> Mark Complete</button></div>'),Xp=o('<div class="admindocreq-request-actions completed-footer"><span class="admindocreq-footer-info"> </span> <button class="admindocreq-action-btn remove-btn" title="Remove request"><span class="material-symbols-outlined">delete</span></button></div>'),ef=o('<div class="admindocreq-request-actions rejected-footer"><span class="admindocreq-footer-info"> </span></div>'),af=o('<div class="admindocreq-request-actions cancelled-footer"><span class="admindocreq-footer-info"> </span> <button class="admindocreq-action-btn remove-btn" title="Remove request"><span class="material-symbols-outlined">delete</span></button></div>'),tf=o('<div><div class="admindocreq-request-header"><div class="admindocreq-request-info"><div class="admindocreq-student-info"><h3 class="admindocreq-student-name"> </h3></div></div> <div class="admindocreq-action-buttons"><div><span class="material-symbols-outlined"> </span> </div></div></div> <div class="admindocreq-request-content"><div class="admindocreq-document-info"><div class="admindocreq-document-type"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="admindocreq-request-date"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div></div> <!></div>'),sf=o('<div class="admindocreq-no-results"><span class="material-symbols-outlined admindocreq-no-results-icon">search_off</span> <p>No document requests found matching your search criteria.</p></div>'),rf=o('<div class="admindocreq-requests-grid"></div>'),nf=o('<div class="admin-document-requests-container"><div class="admin-docreq-header"><div class="admin-header-content"><h1 class="admin-page-title">Document Requests</h1> <p class="admin-page-subtitle">Manage and process student document requests</p></div></div> <div class="admin-docreq-filters-section"><div class="admin-section-header"><h2 class="admin-section-title">Filter Requests</h2> <p class="admin-section-subtitle">Search and filter document requests</p></div> <div class="admindocreq-filters-container"><div class="admindocreq-search-container"><input type="text" placeholder="Search by student name, ID, or document type..." class="admindocreq-search-input"/> <span class="material-symbols-outlined admindocreq-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Statuses</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Document Types</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Grades</span></div></button> <!></div></div></div></div> <div class="admin-docreq-requests-section"><div class="admin-section-header"><h2 class="admin-section-title"> </h2> <p class="admin-section-subtitle">Manage student document requests</p></div> <!></div></div>');function of(z,d){Pt(d,!1);const u=p(),h=p(),b=p(),y=p();let S=p(""),_=p(""),E=p(""),w=p(""),$=p([]),P=p(!0),V=p(null),D=p(!1),L=p(!1),T=p(!1);const se=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],pe=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}],N=[{id:"pending",name:"Pending",description:"Awaiting review"},{id:"processing",name:"Processing",description:"Currently being processed"},{id:"completed",name:"Completed",description:"Ready for pickup/download"},{id:"rejected",name:"Rejected",description:"Request denied"},{id:"cancelled",name:"Cancelled",description:"Cancelled by student"}];async function G(){s(P,!0),s(V,null);try{const ie=await Qa.get("/api/document-requests?admin_view=true");s($,ie.data||[])}catch(ie){console.error("Error loading document requests:",ie),s(V,ie.message)}finally{s(P,!1)}}Wt(()=>{G()});function H(){s(D,!e(D))}function I(){s(L,!e(L))}function re(){s(T,!e(T))}function M(ie){ie?s(_,ie.id):s(_,""),s(D,!1)}function C(ie){ie?s(E,ie.id):s(E,""),s(L,!1)}function R(ie){ie?s(w,ie.value):s(w,""),s(T,!1)}async function B(ie){es.prompt("Approve Document Request","Please provide an approval note (optional):","Enter approval note...",async x=>{try{const le=await Qa.patch("/api/document-requests",{id:ie,action:"approve",admin_note:x&&x.trim()?x.trim():null});le.success?(s($,e($).map(Le=>Le.id===ie&&Le.status==="pending"?{...Le,status:"processing",approvalNote:x&&x.trim()?x.trim():"Approved without additional notes"}:Le)),ne.success("Request approved and moved to processing")):ne.error(le.error||"Failed to approve request")}catch(le){ne.error("Failed to approve request"),console.error("Error approving request:",le)}},()=>{},{size:"medium",allowEmpty:!0})}async function de(ie){es.prompt("Reject Document Request","Please provide a reason for rejecting this document request:","Enter rejection reason...",async x=>{if(!x||!x.trim()){ne.error("Please provide a rejection reason");return}try{const le=await Qa.patch("/api/document-requests",{id:ie,action:"reject",rejection_reason:x.trim()});le.success?(s($,e($).map(Le=>Le.id===ie&&Le.status==="pending"?{...Le,status:"rejected",rejectionReason:x.trim()}:Le)),ne.success("Request rejected successfully")):ne.error(le.error||"Failed to reject request")}catch(le){ne.error("Failed to reject request"),console.error("Error rejecting request:",le)}},()=>{},{size:"medium"})}async function xe(ie){try{const x=await Qa.patch("/api/document-requests",{id:ie,action:"complete"});x.success?(s($,e($).map(le=>le.id===ie&&le.status==="processing"?{...le,status:"completed",completedDate:new Date().toLocaleDateString("en-US")}:le)),ne.success("Request marked as completed")):ne.error(x.error||"Failed to complete request")}catch(x){ne.error("Failed to complete request"),console.error("Error completing request:",x)}}async function ue(ie){es.confirm("Remove Document Request","Are you sure you want to permanently remove this document request? This action cannot be undone.",async()=>{try{const x=await Qa.delete("/api/document-requests",{id:ie});x.success?(s($,e($).filter(le=>le.id!==ie)),ne.success("Document request removed successfully")):ne.error(x.error||"Failed to remove request")}catch(x){ne.error("Failed to remove request"),console.error("Error removing request:",x)}},()=>{})}function X(ie){ie.target.closest(".admindocreq-status-filter")||s(D,!1),ie.target.closest(".admindocreq-doctype-filter")||s(L,!1),ie.target.closest(".admindocreq-grade-filter")||s(T,!1)}function qe(ie){switch(ie){case"completed":return"check_circle";case"processing":return"sync";case"pending":return"hourglass_empty";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}Ya(()=>e(_),()=>{s(u,N.find(ie=>ie.id===e(_)))}),Ya(()=>e(E),()=>{s(h,pe.find(ie=>ie.id===e(E)))}),Ya(()=>e(w),()=>{s(b,se.find(ie=>ie.value===e(w)))}),Ya(()=>(e($),e(S),e(_),e(E),e(w)),()=>{s(y,e($).filter(ie=>{const x=ie.studentName.toLowerCase().includes(e(S).toLowerCase())||ie.studentId.toLowerCase().includes(e(S).toLowerCase())||ie.documentType.toLowerCase().includes(e(S).toLowerCase()),le=e(_)?ie.status===e(_):!0,Le=e(E)?ie.documentType.toLowerCase()===pe.find(He=>He.id===e(E))?.name.toLowerCase():!0,pa=e(w)?ie.gradeLevel===`Grade ${e(w)}`:!0;return x&&le&&Le&&pa}))}),ds(),is();var be=nf();q("click",Fs,X);var _e=r(t(be),2),fe=r(t(_e),2),ke=t(fe),Ve=t(ke);Ba(Ve),Xa(2),a(ke);var ye=r(ke,2);let Oe;var U=t(ye);let he;var Ze=t(U);{var K=ie=>{var x=Gp(),le=r(t(x),2),Le=t(le),pa=t(Le,!0);a(Le),a(le),a(x),g(()=>l(pa,(e(u),n(()=>e(u).name)))),i(ie,x)},je=ie=>{var x=Mp();i(ie,x)};m(Ze,ie=>{e(u)?ie(K):ie(je,!1)})}Xa(2),a(U);var we=r(U,2),na=t(we);let ia;var Aa=r(na,2);ma(Aa,1,()=>N,ie=>ie.id,(ie,x)=>{var le=Rp();let Le;var pa=r(t(le),2),He=t(pa),sa=t(He,!0);a(He);var la=r(He,2),Ee=t(la,!0);a(la),a(pa),a(le),g(O=>{Le=W(le,1,"admindocreq-dropdown-option",null,Le,O),l(sa,(e(x),n(()=>e(x).name))),l(Ee,(e(x),n(()=>e(x).description)))},[()=>({selected:e(_)===e(x).id})]),q("click",le,()=>M(e(x))),i(ie,le)}),a(we),a(ye);var ha=r(ye,2);let Pe;var ca=t(ha);let va;var Ie=t(ca);{var Ge=ie=>{var x=Op(),le=r(t(x),2),Le=t(le),pa=t(Le,!0);a(Le),a(le),a(x),g(()=>l(pa,(e(h),n(()=>e(h).name)))),i(ie,x)},Me=ie=>{var x=Vp();i(ie,x)};m(Ie,ie=>{e(h)?ie(Ge):ie(Me,!1)})}Xa(2),a(ca);var Z=r(ca,2),J=t(Z);let c;var v=r(J,2);ma(v,1,()=>pe,ie=>ie.id,(ie,x)=>{var le=Up();let Le;var pa=r(t(le),2),He=t(pa),sa=t(He,!0);a(He);var la=r(He,2),Ee=t(la,!0);a(la),a(pa),a(le),g(O=>{Le=W(le,1,"admindocreq-dropdown-option",null,Le,O),l(sa,(e(x),n(()=>e(x).name))),l(Ee,(e(x),n(()=>e(x).description)))},[()=>({selected:e(E)===e(x).id})]),q("click",le,()=>C(e(x))),i(ie,le)}),a(Z),a(ha);var A=r(ha,2);let ee;var Ce=t(A);let me;var te=t(Ce);{var Ke=ie=>{var x=Wp(),le=r(t(x),2),Le=t(le),pa=t(Le,!0);a(Le),a(le),a(x),g(()=>l(pa,(e(b),n(()=>e(b).label)))),i(ie,x)},f=ie=>{var x=Yp();i(ie,x)};m(te,ie=>{e(b)?ie(Ke):ie(f,!1)})}Xa(2),a(Ce);var k=r(Ce,2),oe=t(k);let Te;var Ue=r(oe,2);ma(Ue,1,()=>se,ie=>ie.value,(ie,x)=>{var le=Hp();let Le;var pa=r(t(le),2),He=t(pa),sa=t(He,!0);a(He);var la=r(He,2),Ee=t(la,!0);a(la),a(pa),a(le),g(O=>{Le=W(le,1,"admindocreq-dropdown-option",null,Le,O),l(sa,(e(x),n(()=>e(x).label))),l(Ee,(e(x),n(()=>e(x).description)))},[()=>({selected:e(w)===e(x).value})]),q("click",le,()=>R(e(x))),i(ie,le)}),a(k),a(A),a(fe),a(_e);var F=r(_e,2),Ae=t(F),Qe=t(Ae),We=t(Qe);a(Qe),Xa(2),a(Ae);var Xe=r(Ae,2);{var $a=ie=>{var x=Jp();i(ie,x)},xa=ie=>{var x=Ta(),le=da(x);{var Le=He=>{var sa=Bp(),la=r(t(sa),2),Ee=t(la,!0);a(la);var O=r(la,2);a(sa),g(()=>l(Ee,e(V))),q("click",O,G),i(He,sa)},pa=He=>{var sa=rf();ma(sa,5,()=>e(y),la=>la.id,(la,Ee)=>{var O=tf(),Fe=t(O),ea=t(Fe),qa=t(ea),Ia=t(qa),st=t(Ia);a(Ia),a(qa),a(ea);var ra=r(ea,2),ae=t(ra),Re=t(ae),Y=t(Re,!0);a(Re);var Se=r(Re);a(ae),a(ra),a(Fe);var Je=r(Fe,2),Be=t(Je),ge=t(Be),De=r(t(ge),2),ua=t(De);a(De),a(ge);var Pa=r(ge,2),et=r(t(Pa),2),Ea=t(et);a(et),a(Pa);var ot=r(Pa,2);{var mt=Ne=>{var Ye=Qp(),Sa=r(t(Ye),2),ya=t(Sa);a(Sa),a(Ye),g(()=>l(ya,`Purpose: ${e(Ee),n(()=>e(Ee).purpose)??""}`)),i(Ne,Ye)};m(ot,Ne=>{e(Ee),n(()=>e(Ee).purpose)&&Ne(mt)})}a(Be),a(Je);var St=r(Je,2);{var Tt=Ne=>{var Ye=zp(),Sa=t(Ye),ya=r(Sa,2);a(Ye),q("click",Sa,()=>B(e(Ee).id)),q("click",ya,()=>de(e(Ee).id)),i(Ne,Ye)},Ft=Ne=>{var Ye=Ta(),Sa=da(Ye);{var ya=ta=>{var ga=Zp(),za=t(ga);{var ja=Oa=>{var lt=Kp(),vt=t(lt);a(lt),g(()=>l(vt,`Note: ${e(Ee),n(()=>e(Ee).adminNote)??""}`)),i(Oa,lt)};m(za,Oa=>{e(Ee),n(()=>e(Ee).adminNote)&&Oa(ja)})}var ka=r(za,2);a(ga),q("click",ka,()=>xe(e(Ee).id)),i(ta,ga)},aa=ta=>{var ga=Ta(),za=da(ga);{var ja=Oa=>{var lt=Xp(),vt=t(lt),it=t(vt);a(vt);var Rt=r(vt,2);a(lt),g(()=>l(it,`Completed on ${e(Ee),n(()=>e(Ee).completedDate||"N/A")??""}`)),q("click",Rt,()=>ue(e(Ee).id)),i(Oa,lt)},ka=Oa=>{var lt=Ta(),vt=da(lt);{var it=ft=>{var $t=ef(),Mt=t($t),Q=t(Mt);a(Mt),a($t),g(()=>l(Q,`Reason: ${e(Ee),n(()=>e(Ee).rejectionReason)??""}`)),i(ft,$t)},Rt=ft=>{var $t=Ta(),Mt=da($t);{var Q=$e=>{var oa=af(),Fa=t(oa),tt=t(Fa);a(Fa);var Ga=r(Fa,2);a(oa),g(()=>l(tt,`Cancelled on ${e(Ee),n(()=>e(Ee).cancelledDate||"N/A")??""}`)),q("click",Ga,()=>ue(e(Ee).id)),i($e,oa)};m(Mt,$e=>{e(Ee),n(()=>e(Ee).status==="cancelled")&&$e(Q)},!0)}i(ft,$t)};m(vt,ft=>{e(Ee),n(()=>e(Ee).status==="rejected")?ft(it):ft(Rt,!1)},!0)}i(Oa,lt)};m(za,Oa=>{e(Ee),n(()=>e(Ee).status==="completed")?Oa(ja):Oa(ka,!1)},!0)}i(ta,ga)};m(Sa,ta=>{e(Ee),n(()=>e(Ee).status==="processing")?ta(ya):ta(aa,!1)},!0)}i(Ne,Ye)};m(St,Ne=>{e(Ee),n(()=>e(Ee).status==="pending")?Ne(Tt):Ne(Ft,!1)})}a(O),g((Ne,Ye)=>{W(O,1,`admindocreq-request-card status-${e(Ee),n(()=>e(Ee).status)??""}-border`),l(st,`${e(Ee),n(()=>e(Ee).studentName)??""} · ${e(Ee),n(()=>e(Ee).type)??""}`),W(ae,1,`admindocreq-status-badge admindocreq-status-${e(Ee),n(()=>e(Ee).status)??""}`),l(Y,Ne),l(Se,` ${Ye??""}`),l(ua,`${e(Ee),n(()=>e(Ee).studentId)??""} • ${e(Ee),n(()=>e(Ee).gradeLevel)??""}`),l(Ea,`Requested: ${e(Ee),n(()=>e(Ee).requestedDate)??""}`)},[()=>(e(Ee),n(()=>qe(e(Ee).status))),()=>(e(Ee),n(()=>e(Ee).status.charAt(0).toUpperCase()+e(Ee).status.slice(1)))]),i(la,O)},la=>{var Ee=sf();i(la,Ee)}),a(sa),i(He,sa)};m(le,He=>{e(V)?He(Le):He(pa,!1)},!0)}i(ie,x)};m(Xe,ie=>{e(P)?ie($a):ie(xa,!1)})}a(F),a(be),g((ie,x,le,Le,pa,He,sa,la,Ee)=>{Oe=W(ye,1,"admindocreq-status-filter admindocreq-custom-dropdown",null,Oe,ie),he=W(U,1,"admindocreq-dropdown-trigger",null,he,x),ia=W(na,1,"admindocreq-dropdown-option",null,ia,le),Pe=W(ha,1,"admindocreq-doctype-filter admindocreq-custom-dropdown",null,Pe,Le),va=W(ca,1,"admindocreq-dropdown-trigger",null,va,pa),c=W(J,1,"admindocreq-dropdown-option",null,c,He),ee=W(A,1,"admindocreq-grade-filter admindocreq-custom-dropdown",null,ee,sa),me=W(Ce,1,"admindocreq-dropdown-trigger",null,me,la),Te=W(oe,1,"admindocreq-dropdown-option",null,Te,Ee),l(We,`Document Requests (${e(y),n(()=>e(y).length)??""})`)},[()=>({open:e(D)}),()=>({selected:e(_)}),()=>({selected:e(_)===""}),()=>({open:e(L)}),()=>({selected:e(E)}),()=>({selected:e(E)===""}),()=>({open:e(T)}),()=>({selected:e(w)}),()=>({selected:e(w)===""})]),Za(Ve,()=>e(S),ie=>s(S,ie)),q("click",U,H),q("click",na,()=>M(null)),q("click",ca,I),q("click",J,()=>C(null)),q("click",Ce,re),q("click",oe,()=>R(null)),i(z,be),It()}function lf(z,d,u,h,b){es.confirm("Change Password",`
			<div class="admin-settings-password-form">
				<div class="admin-settings-form-group">
					<label for="current-password">Current Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="new-password">New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,d,()=>{s(u,""),s(h,""),s(b,"")},{size:"medium"})}var df=o('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),cf=o('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),vf=o('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),uf=o('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),mf=o('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),pf=o('<span class="material-symbols-outlined">check</span> Apply Date Changes',1),ff=o('<div class="admin-settings-container"><div class="admin-settings-header"><div class="admin-settings-header-content"><h1 class="admin-settings-page-title">Admin Settings</h1> <p class="admin-settings-page-subtitle">Manage system settings and configurations</p></div></div> <div class="admin-settings-section"><div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Current School Year</h3> <p class="admin-settings-item-description">The active academic year for the system</p></div> <div class="admin-settings-item-value"><span class="admin-settings-current-year"> </span></div></div></div></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">School Year Dates</h3> <p class="admin-settings-item-description">Set the start and end dates for classes</p></div></div> <div class="admin-settings-dates-section"><div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="start-date" class="admin-settings-date-label">Start of Classes</label> <input id="start-date" type="date"/></div> <div class="admin-settings-date-item"><label for="end-date" class="admin-settings-date-label">End of Classes</label> <input id="end-date" type="date"/></div></div> <div class="admin-settings-quarters-section svelte-jysw9o"><h4 class="admin-settings-quarters-title svelte-jysw9o">Quarter Schedules</h4> <div class="admin-settings-quarters-row svelte-jysw9o"><div class="admin-settings-quarter-group quarter-1 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">1st Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q1-start" class="admin-settings-date-label">Start</label> <input id="q1-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q1-end" class="admin-settings-date-label">End</label> <input id="q1-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-2 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">2nd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q2-start" class="admin-settings-date-label">Start</label> <input id="q2-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q2-end" class="admin-settings-date-label">End</label> <input id="q2-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-3 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">3rd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q3-start" class="admin-settings-date-label">Start</label> <input id="q3-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q3-end" class="admin-settings-date-label">End</label> <input id="q3-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-4 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">4th Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q4-start" class="admin-settings-date-label">Start</label> <input id="q4-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q4-end" class="admin-settings-date-label">End</label> <input id="q4-end" type="date"/></div></div> <!></div></div></div> <!></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><!></button></div></div></div></div> <div class="admin-settings-section"><div class="admin-settings-section-header"><h2 class="admin-settings-section-title">Account Security</h2> <p class="admin-settings-section-subtitle">Manage your account password and security settings</p></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Password</h3> <p class="admin-settings-item-description">Change your account password for security</p></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div></div>');function _f(z,d){Pt(d,!0);let u=Na(!1),h=Na(!1),b=Na("2024-2025"),y=Na(""),S=Na(""),_=Na(""),E=Na(""),w=Na(""),$=Na(""),P=Na(""),V=Na(""),D=Na(""),L=Na("");async function T(){try{s(u,!0);const ge=await Qa.get("/api/admin-settings");if(ge.success){let ua=function(Pa){if(!Pa)return Pa;const[et,Ea,ot]=Pa.split("-");return`${ot}-${et}-${Ea}`};const De=ge.data;s(b,De.current_school_year||"2024-2025",!0),s(y,ua(De.school_year_start_date)||"",!0),s(S,ua(De.school_year_end_date)||"",!0),s(_,ua(De.quarter_1_start_date)||"",!0),s(E,ua(De.quarter_1_end_date)||"",!0),s(w,ua(De.quarter_2_start_date)||"",!0),s($,ua(De.quarter_2_end_date)||"",!0),s(P,ua(De.quarter_3_start_date)||"",!0),s(V,ua(De.quarter_3_end_date)||"",!0),s(D,ua(De.quarter_4_start_date)||"",!0),s(L,ua(De.quarter_4_end_date)||"",!0)}}catch(ge){console.error("Error loading admin settings:",ge),os("Failed to load admin settings")}finally{s(u,!1)}}async function se(){try{let ge=function(Pa){if(!Pa)return Pa;const[et,Ea,ot]=Pa.split("-");return`${Ea}-${ot}-${et}`};s(h,!0);const De={current_school_year:e(b),school_year_start_date:ge(e(y)),school_year_end_date:ge(e(S)),quarter_1_start_date:ge(e(_)),quarter_1_end_date:ge(e(E)),quarter_2_start_date:ge(e(w)),quarter_2_end_date:ge(e($)),quarter_3_start_date:ge(e(P)),quarter_3_end_date:ge(e(V)),quarter_4_start_date:ge(e(D)),quarter_4_end_date:ge(e(L))},ua=await Qa.put("/api/admin-settings",{settings:De});if(ua.success)Js("Admin settings saved successfully");else throw new Error(ua.error||"Failed to save settings")}catch(ge){console.error("Error saving admin settings:",ge),os("Failed to save admin settings")}finally{s(h,!1)}}let pe=Na("");Ws(()=>{if(e(y)&&e(S)){const ge=new Date(e(y)),De=new Date(e(S));ge>=De?s(pe,"Start date must be before end date"):s(pe,"")}else s(pe,"")});let N={quarter1:"",quarter2:"",quarter3:"",quarter4:""};Ws(()=>{if(e(_)&&e(E)){const ge=new Date(e(_)),De=new Date(e(E));ge>=De?N.quarter1="1st Quarter start date must be before end date":N.quarter1=""}else N.quarter1="";if(e(w)&&e($)){const ge=new Date(e(w)),De=new Date(e($));ge>=De?N.quarter2="2nd Quarter start date must be before end date":N.quarter2=""}else N.quarter2="";if(e(P)&&e(V)){const ge=new Date(e(P)),De=new Date(e(V));ge>=De?N.quarter3="3rd Quarter start date must be before end date":N.quarter3=""}else N.quarter3="";if(e(D)&&e(L)){const ge=new Date(e(D)),De=new Date(e(L));ge>=De?N.quarter4="4th Quarter start date must be before end date":N.quarter4=""}else N.quarter4=""});async function G(){if(e(pe)){console.error("Cannot apply changes: Date validation error");return}if(Object.values(N).some(De=>De!=="")){console.error("Cannot apply changes: Quarter validation errors");return}await se()}let H=Na(""),I=Na(""),re=Na(""),M=Na(!1);function C(ge){const De=document.getElementById(ge),Pa=De.nextElementSibling.querySelector(".password-eye-icon");De.type==="password"?(De.type="text",Pa.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(De.type="password",Pa.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=C);async function R(){const ge=document.getElementById("current-password"),De=document.getElementById("new-password"),ua=document.getElementById("confirm-password");if(!ge||!De||!ua){os("Password form inputs not found");return}const Pa=ge.value,et=De.value,Ea=ua.value;if(!Pa){os("Current password is required");return}if(!et){os("New password is required");return}if(et!==Ea){os("New passwords do not match");return}if(et.length<8){os("Password must be at least 8 characters long");return}if(Pa===et){os("New password must be different from current password");return}try{s(M,!0);const ot=await Qa.post("/api/change-password",{currentPassword:Pa,newPassword:et});ot.success?(ge.value="",De.value="",ua.value="",Js("Password changed successfully!"),es.close()):os(ot.error||"Failed to change password")}catch(ot){console.error("Password change error:",ot),os(ot.message||"Failed to change password")}finally{s(M,!1)}}Wt(()=>{T()});var B=ff(),de=r(t(B),2),xe=t(de),ue=t(xe),X=t(ue),qe=r(t(X),2),be=t(qe),_e=t(be,!0);a(be),a(qe),a(X),a(ue),a(xe);var fe=r(xe,2),ke=t(fe),Ve=r(t(ke),2),ye=t(Ve),Oe=t(ye),U=r(t(Oe),2);Ba(U);let he;a(Oe);var Ze=r(Oe,2),K=r(t(Ze),2);Ba(K);let je;a(Ze),a(ye);var we=r(ye,2),na=r(t(we),2),ia=t(na),Aa=r(t(ia),2),ha=t(Aa),Pe=r(t(ha),2);Ba(Pe);let ca;a(ha);var va=r(ha,2),Ie=r(t(va),2);Ba(Ie);let Ge;a(va),a(Aa);var Me=r(Aa,2);{var Z=ge=>{var De=df(),ua=r(t(De));a(De),g(()=>l(ua,` ${N.quarter1??""}`)),i(ge,De)};m(Me,ge=>{N.quarter1&&ge(Z)})}a(ia);var J=r(ia,2),c=r(t(J),2),v=t(c),A=r(t(v),2);Ba(A);let ee;a(v);var Ce=r(v,2),me=r(t(Ce),2);Ba(me);let te;a(Ce),a(c);var Ke=r(c,2);{var f=ge=>{var De=cf(),ua=r(t(De));a(De),g(()=>l(ua,` ${N.quarter2??""}`)),i(ge,De)};m(Ke,ge=>{N.quarter2&&ge(f)})}a(J);var k=r(J,2),oe=r(t(k),2),Te=t(oe),Ue=r(t(Te),2);Ba(Ue);let F;a(Te);var Ae=r(Te,2),Qe=r(t(Ae),2);Ba(Qe);let We;a(Ae),a(oe);var Xe=r(oe,2);{var $a=ge=>{var De=vf(),ua=r(t(De));a(De),g(()=>l(ua,` ${N.quarter3??""}`)),i(ge,De)};m(Xe,ge=>{N.quarter3&&ge($a)})}a(k);var xa=r(k,2),ie=r(t(xa),2),x=t(ie),le=r(t(x),2);Ba(le);let Le;a(x);var pa=r(x,2),He=r(t(pa),2);Ba(He);let sa;a(pa),a(ie);var la=r(ie,2);{var Ee=ge=>{var De=uf(),ua=r(t(De));a(De),g(()=>l(ua,` ${N.quarter4??""}`)),i(ge,De)};m(la,ge=>{N.quarter4&&ge(Ee)})}a(xa),a(na),a(we);var O=r(we,2);{var Fe=ge=>{var De=mf(),ua=r(t(De));a(De),g(()=>l(ua,` ${e(pe)??""}`)),i(ge,De)};m(O,ge=>{e(pe)&&ge(Fe)})}a(Ve);var ea=r(Ve,2),qa=t(ea);qa.__click=G;var Ia=t(qa);{var st=ge=>{var De=kt("Saving...");i(ge,De)},ra=ge=>{var De=pf();Xa(),i(ge,De)};m(Ia,ge=>{e(h)?ge(st):ge(ra,!1)})}a(qa),a(ea),a(ke),a(fe),a(de);var ae=r(de,2),Re=r(t(ae),2),Y=t(Re),Se=t(Y),Je=r(t(Se),2),Be=t(Je);Be.__click=[lf,R,H,I,re],a(Je),a(Se),a(Y),a(Re),a(ae),a(B),g((ge,De,ua,Pa,et,Ea,ot,mt,St,Tt)=>{l(_e,e(b)),he=W(U,1,"admin-settings-date-input",null,he,ge),je=W(K,1,"admin-settings-date-input",null,je,De),ca=W(Pe,1,"admin-settings-date-input quarter-1-input",null,ca,ua),Ge=W(Ie,1,"admin-settings-date-input quarter-1-input",null,Ge,Pa),ee=W(A,1,"admin-settings-date-input quarter-2-input",null,ee,et),te=W(me,1,"admin-settings-date-input quarter-2-input",null,te,Ea),F=W(Ue,1,"admin-settings-date-input quarter-3-input",null,F,ot),We=W(Qe,1,"admin-settings-date-input quarter-3-input",null,We,mt),Le=W(le,1,"admin-settings-date-input quarter-4-input",null,Le,St),sa=W(He,1,"admin-settings-date-input quarter-4-input",null,sa,Tt),qa.disabled=e(h)||e(u)||!!e(pe)||N.quarter1||N.quarter2||N.quarter3||N.quarter4||!e(y)||!e(S)},[()=>({error:e(pe)}),()=>({error:e(pe)}),()=>({error:N.quarter1}),()=>({error:N.quarter1}),()=>({error:N.quarter2}),()=>({error:N.quarter2}),()=>({error:N.quarter3}),()=>({error:N.quarter3}),()=>({error:N.quarter4}),()=>({error:N.quarter4})]),Za(U,()=>e(y),ge=>s(y,ge)),Za(K,()=>e(S),ge=>s(S,ge)),Za(Pe,()=>e(_),ge=>s(_,ge)),Za(Ie,()=>e(E),ge=>s(E,ge)),Za(A,()=>e(w),ge=>s(w,ge)),Za(me,()=>e($),ge=>s($,ge)),Za(Ue,()=>e(P),ge=>s(P,ge)),Za(Qe,()=>e(V),ge=>s(V,ge)),Za(le,()=>e(D),ge=>s(D,ge)),Za(He,()=>e(L),ge=>s(L,ge)),i(z,B),It()}js(["click"]);var gf=o('<meta name="description" content="High School Student Information System"/>'),bf=o('<div><!> <main class="content-area"><!></main> <!></div>'),hf=o('<div><!> <main class="content-area"><!></main> <!></div>'),yf=o('<div><!> <main class="content-area"><!></main> <!></div>'),wf=o('<div class="app-container"><!></div>');function Nf(z,d){Pt(d,!0);let u=Na(void 0);Ws(()=>ls.subscribe(B=>{s(u,B,!0)}));let h=Na("grades"),b=Na("schedule"),y=Na("dashboard"),S=Na(!1),_=Na(!1),E=Na(!1);function w(R){typeof R=="string"?s(h,R,!0):s(h,R.detail.section,!0)}function $(R){s(b,R.detail.section,!0),R.detail.section!=="class-list"&&s(D,null)}function P(R){const{yearLevel:B,sectionName:de,sectionId:xe}=R.detail;s(D,{yearLevel:B,sectionName:de,sectionId:xe},!0),s(b,"class-list")}function V(){s(D,null),s(b,"students")}let D=Na(null);function L(R){s(y,R.detail.section,!0)}function T(){s(y,"settings")}function se(){s(S,!e(S))}function pe(){s(_,!e(_))}function N(){s(E,!e(E))}async function G(){await ls.logout(),s(h,"grades"),s(b,"schedule"),s(y,"dashboard")}let H=Ut(()=>e(u)?.isAuthenticated?e(u).userType==="student"?"Student Portal - High School":e(u).userType==="teacher"?"Teacher Portal - High School":e(u).userType==="admin"?"Admin Portal - High School":"High School Student Information System":"Login - High School Student Information System");var I=wf();di(R=>{var B=gf();g(()=>ci.title=e(H)),i(R,B)});var re=t(I);{var M=R=>{$i(R,{})},C=R=>{var B=Ta(),de=da(B);{var xe=X=>{var qe=bf();let be;var _e=t(qe);{let U=Ut(()=>e(u).userData?.name||"Student"),he=Ut(()=>e(u).userData?.firstName||"Student"),Ze=Ut(()=>e(u).userData?.gender||"male"),K=Ut(()=>e(u).userData?.accountNumber||"N/A"),je=Ut(()=>e(u).userData?.profileImage);Mi(_e,{get studentName(){return e(U)},get firstName(){return e(he)},get gender(){return e(Ze)},get accountNumber(){return e(K)},get profileImage(){return e(je)},onlogout:G,onToggleNavRail:se,onnavigate:w})}var fe=r(_e,2),ke=t(fe);{var Ve=U=>{pn(U,{})},ye=U=>{var he=Ta(),Ze=da(he);{var K=we=>{Cn(we,{})},je=we=>{var na=Ta(),ia=da(na);{var Aa=Pe=>{Vn(Pe,{})},ha=Pe=>{var ca=Ta(),va=da(ca);{var Ie=Me=>{to(Me,{})},Ge=Me=>{var Z=Ta(),J=da(Z);{var c=A=>{fo(A,{})},v=A=>{var ee=Ta(),Ce=da(ee);{var me=te=>{Io(te,{})};m(Ce,te=>{e(h)==="todo"&&te(me)},!0)}i(A,ee)};m(J,A=>{e(h)==="notifications"?A(c):A(v,!1)},!0)}i(Me,Z)};m(va,Me=>{e(h)==="documents"?Me(Ie):Me(Ge,!1)},!0)}i(Pe,ca)};m(ia,Pe=>{e(h)==="schedule"?Pe(Aa):Pe(ha,!1)},!0)}i(we,na)};m(Ze,we=>{e(h)==="grades"?we(K):we(je,!1)},!0)}i(U,he)};m(ke,U=>{e(h)==="profile"?U(Ve):U(ye,!1)})}a(fe);var Oe=r(fe,2);Ki(Oe,{get activeSection(){return e(h)},get isNavRailVisible(){return e(S)},onnavigate:w}),a(qe),g(U=>be=W(qe,1,"student-portal",null,be,U),[()=>({"nav-rail-collapsed":!e(S)})]),i(X,qe)},ue=X=>{var qe=Ta(),be=da(qe);{var _e=ke=>{var Ve=hf();let ye;var Oe=t(Ve);{let we=Ut(()=>e(u).userData?.name||"Teacher"),na=Ut(()=>e(u).userData?.firstName||"Teacher"),ia=Ut(()=>e(u).userData?.gender||"male"),Aa=Ut(()=>e(u).userData?.accountNumber||"N/A"),ha=Ut(()=>e(u).userData?.profileImage);Ho(Oe,{get teacherName(){return e(we)},get firstName(){return e(na)},get gender(){return e(ia)},get accountNumber(){return e(Aa)},get profileImage(){return e(ha)},onlogout:G,onToggleNavRail:pe})}var U=r(Oe,2),he=t(U);{var Ze=we=>{ul(we,{})},K=we=>{var na=Ta(),ia=da(na);{var Aa=Pe=>{Br(Pe,{onNavigateToClassList:P})},ha=Pe=>{var ca=Ta(),va=da(ca);{var Ie=Me=>{ed(Me,{get selectedClass(){return e(D)},onBackToClassManagement:V})},Ge=Me=>{var Z=Ta(),J=da(Z);{var c=A=>{fd(A,{})},v=A=>{Br(A,{onNavigateToClassList:P})};m(J,A=>{e(b)==="advisory"?A(c):A(v,!1)},!0)}i(Me,Z)};m(va,Me=>{e(b)==="class-list"&&e(D)?Me(Ie):Me(Ge,!1)},!0)}i(Pe,ca)};m(ia,Pe=>{e(b)==="students"?Pe(Aa):Pe(ha,!1)},!0)}i(we,na)};m(he,we=>{e(b)==="schedule"?we(Ze):we(K,!1)})}a(U);var je=r(U,2);Zo(je,{get teacherActiveSection(){return e(b)},get teacherNavRailVisible(){return e(_)},onnavigate:$}),a(Ve),g(we=>ye=W(Ve,1,"teacher-portal",null,ye,we),[()=>({"nav-rail-collapsed":!e(_)})]),i(ke,Ve)},fe=ke=>{var Ve=Ta(),ye=da(Ve);{var Oe=U=>{var he=yf();let Ze;var K=t(he);{let ha=Ut(()=>e(u).userData?.name||"Admin"),Pe=Ut(()=>e(u).userData?.firstName||"Admin"),ca=Ut(()=>e(u).userData?.gender||"male"),va=Ut(()=>e(u).userData?.accountNumber||"N/A"),Ie=Ut(()=>e(u).userData?.profileImage);kd(K,{get adminName(){return e(ha)},get firstName(){return e(Pe)},get gender(){return e(ca)},get accountNumber(){return e(va)},get profileImage(){return e(Ie)},onlogout:G,onToggleNavRail:N,onNavigateToSettings:T})}var je=r(K,2),we=t(je);{var na=ha=>{ec(ha,{})},ia=ha=>{var Pe=Ta(),ca=da(Pe);{var va=Ge=>{Pc(Ge,{})},Ie=Ge=>{var Me=Ta(),Z=da(Me);{var J=v=>{iv(v,{})},c=v=>{var A=Ta(),ee=da(A);{var Ce=te=>{Nv(te,{})},me=te=>{var Ke=Ta(),f=da(Ke);{var k=Te=>{Vv(Te,{})},oe=Te=>{var Ue=Ta(),F=da(Ue);{var Ae=We=>{Om(We)},Qe=We=>{var Xe=Ta(),$a=da(Xe);{var xa=x=>{Ip(x,{})},ie=x=>{var le=Ta(),Le=da(le);{var pa=sa=>{fp(sa,{})},He=sa=>{var la=Ta(),Ee=da(la);{var O=ea=>{of(ea,{})},Fe=ea=>{var qa=Ta(),Ia=da(qa);{var st=ra=>{_f(ra,{})};m(Ia,ra=>{e(y)==="settings"&&ra(st)},!0)}i(ea,qa)};m(Ee,ea=>{e(y)==="document-requests"?ea(O):ea(Fe,!1)},!0)}i(sa,la)};m(Le,sa=>{e(y)==="subjects-and-activities"?sa(pa):sa(He,!1)},!0)}i(x,le)};m($a,x=>{e(y)==="department-management"?x(xa):x(ie,!1)},!0)}i(We,Xe)};m(F,We=>{e(y)==="schedule-management"?We(Ae):We(Qe,!1)},!0)}i(Te,Ue)};m(f,Te=>{e(y)==="student-grades-list"?Te(k):Te(oe,!1)},!0)}i(te,Ke)};m(ee,te=>{e(y)==="archived-students"?te(Ce):te(me,!1)},!0)}i(v,A)};m(Z,v=>{e(y)==="student-masterlist"?v(J):v(c,!1)},!0)}i(Ge,Me)};m(ca,Ge=>{e(y)==="account-creation"?Ge(va):Ge(Ie,!1)},!0)}i(ha,Pe)};m(we,ha=>{e(y)==="dashboard"?ha(na):ha(ia,!1)})}a(je);var Aa=r(je,2);Ud(Aa,{get adminActiveSection(){return e(y)},get adminNavRailVisible(){return e(E)},onnavigate:L}),a(he),g(ha=>Ze=W(he,1,"admin-portal",null,Ze,ha),[()=>({"nav-rail-collapsed":!e(E)})]),i(U,he)};m(ye,U=>{e(u).userType==="admin"&&U(Oe)},!0)}i(ke,Ve)};m(be,ke=>{e(u).userType==="teacher"?ke(_e):ke(fe,!1)},!0)}i(X,qe)};m(de,X=>{e(u).userType==="student"?X(xe):X(ue,!1)},!0)}i(R,B)};m(re,R=>{e(u)?.isAuthenticated?R(C,!1):R(M)})}a(I),i(z,I),It()}export{Nf as component};
