import"../chunks/DsnmJJEf.js";import{h as Ko,a as yd,b2 as wd,b3 as xd,b4 as Sd,b as kd,c as Dd,d as Ad,e as Cd,s as Td,f as Ed,U as Fd,p as $d,aS as Cs,q as qa,ae as at,_ as Os,ad as Ua,T as d,t as _,z as n,A as i,B as v,l as e,w as O,C as w,x as p,y as Ga,v as Ue,b0 as zt,aZ as De,ag as mt,aR as Qs,V as ho,ah as Lt,i as Ss,Q as V,b5 as Ws,b6 as Ft,b7 as Is,m as js,b8 as ai,af as yn,b9 as mr,ai as _a,a_ as tr,j as k,ba as Oi,Z as $r,bb as Nd,aY as Pd,bc as Ld,b1 as Md,bd as Id}from"../chunks/Dzme5HSP.js";import{i as $,p as Pa,a as Ja,s as ks,b as Us,d as Jo}from"../chunks/BxRcuCIW.js";import{d as ws,o as Vr,r as ia,s as ge,p as Mi,a as Vt,c as ca,e as Tt,i as Ha,t as Fe,b as is,m as ns,u as vs,k as Ya,j as Xa,q as Vs,l as Bs,v as zs,n as Rd,g as ea,h as jd,w as Od,T as qd,x as Gd,f as Qn}from"../chunks/CadbDdOh.js";import{i as Ps}from"../chunks/Bk8Jy4_Z.js";const Vd=!0;function Ms(s,t,a){Ko&&yd();var r=s,o=Fd,l,c,u=null,f=wd()?xd:Sd;function m(){l&&$d(l),u!==null&&(u.lastChild.remove(),r.before(u),u=null),l=c}kd(()=>{if(f(o,o=t())){var h=r,g=Td();g&&(u=document.createDocumentFragment(),u.append(h=Dd())),c=Ad(()=>a(h)),g?Cd.add_callback(m):m()}}),Ko&&(r=Ed)}function co(s){return function(...t){var a=t[0];return a.stopPropagation(),s?.apply(this,t)}}function sr(s){return function(...t){var a=t[0];return a.preventDefault(),s?.apply(this,t)}}const Xo=Vd,Dc=s=>{const t=/^[A-Z]{3}-\d{4}-\d{4}$/;return s?t.test(s)?"":"Please enter a valid ID Number (e.g., STU-2025-0001)":"ID Number is required"},Ac=s=>s?"":"Password is required",Cc=()=>document.documentElement.getAttribute("data-theme")||"light",Bd=s=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},zd=()=>{const t=Cc()==="dark"?"light":"dark";return Bd(t),t},Wd=()=>{if(typeof window>"u")return!1;const s=navigator.userAgent||navigator.vendor||window.opera;return!!(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile|tablet/i.test(s)||window.innerWidth<=768&&("ontouchstart"in window||navigator.maxTouchPoints>0))},Hd=async({accountNumber:s,password:t})=>{try{const r=await(await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountNumber:s,password:t})})).json();if(r.success){if(r.user.accountType==="admin"&&Wd())throw new Error("Admin access is restricted to desktop devices only. Please use a PC to access the admin portal.");const o={id:r.user.id,name:r.user.name,firstName:r.user.firstName,gender:r.user.gender,accountNumber:r.user.accountNumber,accountType:r.user.accountType,isAuthenticated:!0};return ws.login(o.accountType,o),Vr(`Login successful! Welcome back, ${o.name}`),console.log("Login successful:",{accountNumber:s,userType:o.accountType}),o}else{const o=new Error(r.error||"Invalid credentials. Please try again.");throw o.attemptsLeft=r.attemptsLeft,o.isLocked=r.isLocked,o}}catch(a){if(a.message==="Failed to fetch"||a instanceof TypeError)throw new Error("Connection failed. Please check your internet connection and try again.");const r=new Error(a.message||"Network error. Please try again.");throw a.attemptsLeft!==void 0&&(r.attemptsLeft=a.attemptsLeft),a.isLocked!==void 0&&(r.isLocked=a.isLocked),r}};function Ud(s,t){const a=zd();d(t,a==="dark")}const Yd=(s,t,a)=>{d(t,s.target.value,!0),e(a).idNumber&&d(a,{...e(a),idNumber:Dc(e(t))},!0)},Qd=(s,t,a)=>{d(t,s.target.value,!0),e(a).password&&d(a,{...e(a),password:Ac(e(t))},!0)},Zo=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),t(s))};async function Kd(s,t,a,r,o){d(t,""),d(a,["","","","","",""],!0),d(r,5),await o({preventDefault:()=>{}})}var Jd=_('<div class="error-text"> </div>'),Xd=(s,t)=>{s.preventDefault(),s.stopPropagation(),d(t,!e(t))},Zd=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),s.stopPropagation(),d(t,!e(t)))},eu=_('<div class="error-text"> </div>'),tu=_('<div class="error-message-item"> </div>'),au=_('<div class="error-message-item"> </div>'),su=_('<div class="error-message-item"> </div>'),ru=_('<div class="error-message-item" style="color: #ff9800; font-weight: 500;"> </div>'),iu=_('<div class="login-error-container"><span class="material-symbols-outlined">error</span> <div class="error-messages"><!> <!> <!> <!></div></div>'),nu=_('<div class="login-loading-spinner"></div>'),ou=_("<span>Login Locked</span>"),lu=_("<span>Login</span>"),cu=_('<div class="login-header"><h1 class="login-title">Login</h1> <h2 class="login-subtitle">Enter your account details</h2></div> <form class="login-form" novalidate="" autocomplete="off"><div class="form-field"><div><span class="leading-icon material-symbols-outlined">badge</span> <input type="text" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="idnumber-input">ID Number</label></div> <!></div> <div class="form-field"><div><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="password-input">Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div> <!></div> <!> <button id="login-submit-btn" type="submit" class="custom-filled-button login-submit" aria-label="Sign in"><!></button> <button type="button" id="forgot-password-btn" class="custom-text-button forgot-password" aria-label="forgot-password">Forgot Password</button></form>',1),du=_('<div class="success-message-box"><span class="material-symbols-outlined">check_circle</span> <span> </span></div>'),uu=_('<div class="error-message-box"><span class="material-symbols-outlined">error</span> <span> </span></div>'),vu=_('<div class="login-loading-spinner"></div>'),fu=_('<span class="material-symbols-outlined">send</span> <span>Send Code</span>',1),pu=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">email</span> <input id="forgot-password-email" type="email" autocomplete="email" class="text-input" placeholder=" " required/> <label for="forgot-password-email" class="text-label">Email Address</label></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),mu=_('<input type="text" maxlength="1" inputmode="numeric" autocomplete="off" class="code-box" required/>'),hu=_('<div class="info-text"> </div>'),gu=_('<div class="verification-loading"><div class="login-loading-spinner"></div> <span>Verifying code...</span></div>'),_u=_('<div class="login-loading-spinner"></div>'),bu=_('<span class="material-symbols-outlined">refresh</span> <span>Resend Code</span>',1),yu=_('<form class="login-form"><div class="form-field"><div class="code-boxes-container"></div> <!> <!></div> <button type="button" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),wu=(s,t)=>{s.preventDefault(),d(t,!e(t))},xu=(s,t)=>{s.preventDefault(),d(t,!e(t))},Su=_('<div class="login-loading-spinner"></div>'),ku=_("<span>Reset Password</span>"),Du=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock</span> <input id="reset-new-password" autocomplete="new-password" class="text-input" placeholder=" " required/> <label for="reset-new-password" class="text-label">New Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock_reset</span> <input id="reset-confirm-password" autocomplete="new-password" class="text-input" placeholder=" " required/> <label for="reset-confirm-password" class="text-label">Confirm Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),Au=_('<div class="login-header"><h1 class="login-title"> </h1> <h2 class="login-subtitle"> </h2></div> <!> <!> <!> <!> <!>',1),Cu=_('<div class="login-container"><button class="theme-toggle-btn" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="left-side"><!></div> <div class="right-side"><div class="welcome-text"><h1 class="welcome-title"> </h1> <p class="welcome-subtitle"> </p></div></div></div>');function Tu(s,t){qa(t,!0);let a=at(""),r=at(""),o=at(!1),l=at(!1),c=at(Os({idNumber:"",password:"",general:""})),u=at(null),f=at(!1),m=at(!1),h=at(1),g=at(""),b=at(""),y=at(""),x=at(Os(["","","","","",""])),A=at(""),C=at(""),E=at(!1),F=at(!1),S=at(""),q=at(5),I=at(!1);const j="forgotPasswordState";function M(){if(!(typeof window>"u"))try{const we={showForgotPassword:e(m),forgotPasswordStep:e(h),email:e(g),resetToken:e(b),verificationCode:e(y),codeDigits:e(x),attemptsRemaining:e(q)};sessionStorage.setItem(j,JSON.stringify(we))}catch(we){console.warn("Failed to save forgot password state:",we)}}function Z(){if(!(typeof window>"u"))try{const we=sessionStorage.getItem(j);if(we){const tt=JSON.parse(we);d(m,tt.showForgotPassword||!1,!0),d(h,tt.forgotPasswordStep||1,!0),d(g,tt.email||"",!0),d(b,tt.resetToken||"",!0),d(y,tt.verificationCode||"",!0),d(x,tt.codeDigits||["","","","","",""],!0),d(q,tt.attemptsRemaining||5,!0)}}catch(we){console.warn("Failed to load forgot password state:",we)}}function Q(){if(!(typeof window>"u"))try{sessionStorage.removeItem(j)}catch(we){console.warn("Failed to clear forgot password state:",we)}}Ua(()=>{const we=Cc();d(I,we==="dark"),Z()});const W=async we=>{we.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(u,null),d(f,!1);const tt=Dc(e(a)),ct=Ac(e(r));if(tt||ct){d(c,{idNumber:tt,password:ct,general:""},!0);return}d(o,!0);try{const xe=await Hd({accountNumber:e(a),password:e(r)})}catch(xe){d(c,{...e(c),general:xe.message},!0),xe.attemptsLeft!==void 0&&d(u,xe.attemptsLeft,!0),xe.isLocked&&(d(f,!0),d(u,0))}finally{d(o,!1)}};function H(){d(m,!e(m)),e(m)?M():(d(h,1),d(g,""),d(b,""),d(y,""),d(x,["","","","","",""],!0),d(A,""),d(C,""),d(c,{idNumber:"",password:"",general:""},!0),d(S,""),d(q,5),Q())}function U(we,tt){const xe=tt.target.value.replace(/\D/g,"");if(xe.length>0)if(e(x)[we]=xe[xe.length-1],d(y,e(x).join(""),!0),we<5&&xe){const Se=document.getElementById(`code-digit-${we+1}`);Se&&Se.focus()}else we===5&&e(x).every(Se=>Se!=="")&&te({preventDefault:()=>{}});else e(x)[we]="",d(y,e(x).join(""),!0)}function X(we,tt){if(tt.key==="Backspace"&&!e(x)[we]&&we>0){const ct=document.getElementById(`code-digit-${we-1}`);ct&&ct.focus()}}function B(we){we.preventDefault();const tt=we.clipboardData.getData("text").replace(/\D/g,"").slice(0,6);if(tt.length>0){const ct=tt.split("");d(x,[...ct,...Array(6-ct.length).fill("")],!0),d(y,e(x).join(""),!0);const xe=Math.min(ct.length,5),Se=document.getElementById(`code-digit-${xe}`);Se&&Se.focus(),tt.length===6&&te({preventDefault:()=>{}})}}function oe(we){return we?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(we)?"":"Please enter a valid email address":"Email address is required"}function K(we){return we?/^\d{6}$/.test(we)?"":"Code must be 6 digits":"Verification code is required"}function de(we){return we?we.length<6?"Password must be at least 6 characters":"":"Password is required"}async function ae(we){we.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(S,"");const tt=oe(e(g));if(tt){d(c,{...e(c),general:tt},!0);return}d(o,!0);try{const ct=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(g).toLowerCase().trim()})}),xe=await ct.json();if(!ct.ok)throw new Error(xe.error||"Failed to send reset code");d(b,xe.resetToken,!0),d(S,"A verification code has been sent to your email address."),d(h,2),M()}catch(ct){d(c,{...e(c),general:ct.message},!0)}finally{d(o,!1)}}async function te(we){we.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(S,"");const tt=K(e(y));if(tt){d(c,{...e(c),general:tt},!0);return}d(o,!0);try{const ct=await fetch("/api/forgot-password/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(b),code:e(y)})}),xe=await ct.json();if(!ct.ok)throw xe.attemptsRemaining!==void 0&&d(q,xe.attemptsRemaining,!0),new Error(xe.error||"Invalid verification code");d(S,"Code verified! Please enter your new password."),d(h,3),M()}catch(ct){d(c,{...e(c),general:ct.message},!0),M()}finally{d(o,!1)}}async function Ce(we){we.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(S,"");const tt=de(e(A));if(tt){d(c,{...e(c),general:tt},!0);return}if(e(A)!==e(C)){d(c,{...e(c),general:"Passwords do not match"},!0);return}d(o,!0);try{const ct=await fetch("/api/forgot-password/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(b),code:e(y),newPassword:e(A)})}),xe=await ct.json();if(!ct.ok)throw new Error(xe.error||"Failed to reset password");d(S,"Password reset successfully! Redirecting to login..."),Q(),setTimeout(()=>{H()},2e3)}catch(ct){d(c,{...e(c),general:ct.message},!0)}finally{d(o,!1)}}var Ae=Cu(),Re=n(Ae);Re.__click=[Ud,I];var Me=n(Re),Ge=n(Me,!0);i(Me),i(Re);var be=v(Re,2),ke=n(be);{var Ve=we=>{var tt=cu(),ct=v(Ue(tt),2),xe=n(ct),Se=n(xe),We=v(n(Se),2);ia(We),We.__input=[Yd,a,c],We.__keydown=[Zo,W],zt(2),i(Se);var Ze=v(Se,2);{var ee=se=>{var $e=Jd(),he=n($e,!0);i($e),O(()=>w(he,e(c).idNumber)),p(se,$e)};$(Ze,se=>{e(c).idNumber&&se(ee)})}i(xe);var ue=v(xe,2),fe=n(ue),T=v(n(fe),2);ia(T),T.__input=[Qd,r,c],T.__keydown=[Zo,W];var P=v(T,4);P.__click=[Xd,l],P.__keydown=[Zd,l];var le=n(P),R=n(le,!0);i(le),i(P),i(fe);var G=v(fe,2);{var ie=se=>{var $e=eu(),he=n($e,!0);i($e),O(()=>w(he,e(c).password)),p(se,$e)};$(G,se=>{e(c).password&&se(ie)})}i(ue);var _e=v(ue,2);{var Y=se=>{var $e=iu(),he=v(n($e),2),qe=n(he);{var et=wt=>{var St=tu(),$t=n(St,!0);i(St),O(()=>w($t,e(c).idNumber)),p(wt,St)};$(qe,wt=>{e(c).idNumber&&wt(et)})}var Le=v(qe,2);{var Qe=wt=>{var St=au(),$t=n(St,!0);i(St),O(()=>w($t,e(c).password)),p(wt,St)};$(Le,wt=>{e(c).password&&wt(Qe)})}var st=v(Le,2);{var ht=wt=>{var St=su(),$t=n(St,!0);i(St),O(()=>w($t,e(c).general)),p(wt,St)};$(st,wt=>{e(c).general&&wt(ht)})}var _t=v(st,2);{var xt=wt=>{var St=ru(),$t=n(St);i(St),O(()=>w($t,`${e(u)??""} attempt${e(u)!==1?"s":""} remaining before login lockout`)),p(wt,St)};$(_t,wt=>{e(u)!==null&&e(u)>0&&!e(f)&&wt(xt)})}i(he),i($e),p(se,$e)};$(_e,se=>{(e(c).idNumber||e(c).password||e(c).general)&&se(Y)})}var N=v(_e,2),D=n(N);{var L=se=>{var $e=nu();p(se,$e)},z=se=>{var $e=mt(),he=Ue($e);{var qe=Le=>{var Qe=ou();p(Le,Qe)},et=Le=>{var Qe=lu();p(Le,Qe)};$(he,Le=>{e(f)?Le(qe):Le(et,!1)},!0)}p(se,$e)};$(D,se=>{e(o)?se(L):se(z,!1)})}i(N);var ve=v(N,2);ve.__click=H,i(ct),O(()=>{ge(Se,1,`custom-text-field ${e(c).idNumber?"error":""}`),Mi(We,e(a)),ge(fe,1,`custom-text-field ${e(c).password?"error":""}`),Vt(T,"type",e(l)?"text":"password"),Mi(T,e(r)),Vt(P,"aria-label",e(l)?"Hide password":"Show password"),w(R,e(l)?"visibility":"visibility_off"),N.disabled=e(o)||e(f)}),De("submit",ct,W),p(we,tt)},it=we=>{var tt=Au(),ct=Ue(tt),xe=n(ct),Se=n(xe,!0);i(xe);var We=v(xe,2),Ze=n(We,!0);i(We),i(ct);var ee=v(ct,2);{var ue=Y=>{var N=du(),D=v(n(N),2),L=n(D,!0);i(D),i(N),O(()=>w(L,e(S))),p(Y,N)};$(ee,Y=>{e(S)&&Y(ue)})}var fe=v(ee,2);{var T=Y=>{var N=uu(),D=v(n(N),2),L=n(D,!0);i(D),i(N),O(()=>w(L,e(c).general)),p(Y,N)};$(fe,Y=>{e(c).general&&Y(T)})}var P=v(fe,2);{var le=Y=>{var N=pu(),D=n(N),L=n(D),z=v(n(L),2);ia(z),zt(2),i(L),i(D);var ve=v(D,2),se=n(ve);{var $e=et=>{var Le=vu();p(et,Le)},he=et=>{var Le=fu();zt(2),p(et,Le)};$(se,et=>{e(o)?et($e):et(he,!1)})}i(ve);var qe=v(ve,2);qe.__click=H,i(N),O(()=>ve.disabled=e(o)),De("submit",N,ae),ca(z,()=>e(g),et=>d(g,et)),p(Y,N)};$(P,Y=>{e(h)===1&&Y(le)})}var R=v(P,2);{var G=Y=>{var N=yu(),D=n(N),L=n(D);Tt(L,21,()=>e(x),Ha,(st,ht,_t)=>{var xt=mu();ia(xt),Vt(xt,"id",`code-digit-${_t}`),xt.__input=wt=>U(_t,wt),xt.__keydown=wt=>X(_t,wt),O(()=>{Mi(xt,e(ht)),xt.disabled=e(o)}),De("paste",xt,function(...wt){(_t===0?B:null)?.apply(this,wt)}),p(st,xt)}),i(L);var z=v(L,2);{var ve=st=>{var ht=hu(),_t=n(ht);i(ht),O(()=>w(_t,`Attempts remaining: ${e(q)??""}`)),p(st,ht)};$(z,st=>{e(q)<5&&st(ve)})}var se=v(z,2);{var $e=st=>{var ht=gu();p(st,ht)};$(se,st=>{e(o)&&st($e)})}i(D);var he=v(D,2);he.__click=[Kd,y,x,q,ae];var qe=n(he);{var et=st=>{var ht=_u();p(st,ht)},Le=st=>{var ht=bu();zt(2),p(st,ht)};$(qe,st=>{e(o)?st(et):st(Le,!1)})}i(he);var Qe=v(he,2);Qe.__click=H,i(N),O(()=>he.disabled=e(o)),De("submit",N,st=>{st.preventDefault()}),p(Y,N)};$(R,Y=>{e(h)===2&&Y(G)})}var ie=v(R,2);{var _e=Y=>{var N=Du(),D=n(N),L=n(D),z=v(n(L),2);ia(z);var ve=v(z,4);ve.__click=[wu,E];var se=n(ve),$e=n(se,!0);i(se),i(ve),i(L),i(D);var he=v(D,2),qe=n(he),et=v(n(qe),2);ia(et);var Le=v(et,4);Le.__click=[xu,F];var Qe=n(Le),st=n(Qe,!0);i(Qe),i(Le),i(qe),i(he);var ht=v(he,2),_t=n(ht);{var xt=$t=>{var Nt=Su();p($t,Nt)},wt=$t=>{var Nt=ku();p($t,Nt)};$(_t,$t=>{e(o)?$t(xt):$t(wt,!1)})}i(ht);var St=v(ht,2);St.__click=H,i(N),O(()=>{Vt(z,"type",e(E)?"text":"password"),Vt(ve,"aria-label",e(E)?"Hide password":"Show password"),w($e,e(E)?"visibility":"visibility_off"),Vt(et,"type",e(F)?"text":"password"),Vt(Le,"aria-label",e(F)?"Hide password":"Show password"),w(st,e(F)?"visibility":"visibility_off"),ht.disabled=e(o)}),De("submit",N,Ce),ca(z,()=>e(A),$t=>d(A,$t)),ca(et,()=>e(C),$t=>d(C,$t)),p(Y,N)};$(ie,Y=>{e(h)===3&&Y(_e)})}O(()=>{w(Se,e(h)===1?"Forgot Password?":e(h)===2?"Verify Code":"Reset Password"),w(Ze,e(h)===1?"Enter your email to receive a verification code":e(h)===2?"Enter the 6-digit code sent to your email":"Create a new password for your account")}),p(we,tt)};$(ke,we=>{e(m)?we(it,!1):we(Ve)})}i(be);var Be=v(be,2),He=n(Be),Ne=n(He),Je=n(Ne,!0);i(Ne);var lt=v(Ne,2),Pe=n(lt,!0);i(lt),i(He),i(Be),i(Ae),O(()=>{w(Ge,e(I)?"light_mode":"dark_mode"),w(Je,e(m)?"Password Reset":"Welcome"),w(Pe,e(m)?"Recover your account securely":"Login to access your account")}),p(s,Ae),Ga()}Cs(["click","input","keydown"]);const Eu=300*1e3,el="student_notifications_";function Fu(){const s={notifications:[],unreadCount:0,totalCount:0,currentFilter:"all",isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Qs(s);function o(){const j=ho(ws);if(!j?.isAuthenticated||!j.userData)return{};const M={id:j.userData.id,name:j.userData.name,account_number:j.userData.accountNumber,account_type:j.userData.account_type||j.userData.accountType};return{"x-user-info":JSON.stringify(M)}}function l(j,M){return`${el}${j}_${M}`}function c(j){return!j||!j.timestamp?!1:Date.now()-j.timestamp<Eu}function u(j,M){try{const Z=l(j,M),Q=localStorage.getItem(Z);if(Q)return JSON.parse(Q).data}catch(Z){console.warn("Failed to retrieve cached student notifications data:",Z)}return null}function f(j,M){try{const Z=l(j,M),Q=localStorage.getItem(Z);if(Q){const W=JSON.parse(Q);if(c(W))return W.data}}catch(Z){console.warn("Failed to retrieve cached student notifications data:",Z)}return null}function m(j,M,Z){try{const Q=l(j,M),W={data:Z,timestamp:Date.now()};localStorage.setItem(Q,JSON.stringify(W))}catch(Q){console.warn("Failed to cache student notifications data:",Q)}}function h(j){return Array.isArray(j)?j.map(M=>({id:M.id,title:M.title,message:M.message,type:M.type,timestamp:M.created_at||M.timestamp,isRead:M.is_read||M.isRead||!1,adminNote:M.admin_note||M.adminNote||null,rejectionReason:M.rejection_reason||M.rejectionReason||null,metadata:M.metadata||{}})):[]}function g(j){const M=j.filter(Q=>!Q.isRead).length,Z=j.length;return{unreadCount:M,totalCount:Z}}async function b(j,M="all",Z=!1){try{r(oe=>({...oe,isLoading:!Z,isRefreshing:Z,error:null,currentStudentId:j,currentFilter:M}));const Q=new URLSearchParams({studentId:j,filter:M}),H=await(await fetch(`/api/student-notifications?${Q.toString()}`,{headers:o()})).json();if(!H.success)throw new Error(H.error||"Failed to fetch notifications");const U=h(H.data||[]),X=g(U),B={notifications:U,unreadCount:X.unreadCount,totalCount:X.totalCount,currentFilter:M,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString(),currentStudentId:j};r(oe=>({...oe,...B})),m(j,M,{notifications:U,unreadCount:X.unreadCount,totalCount:X.totalCount,lastUpdated:B.lastUpdated})}catch(Q){console.error("Error loading student notifications:",Q);const W=u(j,M);W?(r(H=>({...H,notifications:W.notifications||[],unreadCount:W.unreadCount||0,totalCount:W.totalCount||0,lastUpdated:W.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Fe.error("No internet connection. Showing offline data.")):r(H=>({...H,isLoading:!1,isRefreshing:!1,error:Q.message,notifications:[],unreadCount:0,totalCount:0}))}}async function y(j,M,Z){try{const W=await(await fetch("/api/student-notifications",{method:"PATCH",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:j,notificationId:M,isRead:Z})})).json();if(!W.success)throw new Error(W.error||"Failed to update notification status");r(H=>{const U=H.notifications.map(B=>B.id===M?{...B,isRead:Z}:B),X=g(U);return m(j,H.currentFilter,{notifications:U,unreadCount:X.unreadCount,totalCount:X.totalCount,lastUpdated:new Date().toISOString()}),{...H,notifications:U,unreadCount:X.unreadCount}})}catch(Q){console.error("Error updating notification status:",Q),Fe.error("Failed to update notification status")}}async function x(j,M){try{const Q=await(await fetch("/api/student-notifications",{method:"DELETE",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:j,notificationId:M})})).json();if(!Q.success)throw new Error(Q.error||"Failed to delete notification");r(W=>{const H=W.notifications.filter(X=>X.id!==M),U=g(H);return m(j,W.currentFilter,{notifications:H,unreadCount:U.unreadCount,totalCount:U.totalCount,lastUpdated:new Date().toISOString()}),{...W,notifications:H,unreadCount:U.unreadCount,totalCount:U.totalCount}})}catch(Z){throw console.error("Error deleting notification:",Z),Fe.error("Failed to delete notification"),Z}}async function A(j){try{const Z=await(await fetch("/api/student-notifications",{method:"PATCH",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:j,markAllAsRead:!0})})).json();if(!Z.success)throw new Error(Z.error||"Failed to mark all as read");r(Q=>{const W=Q.notifications.map(H=>({...H,isRead:!0}));return m(j,Q.currentFilter,{notifications:W,unreadCount:0,totalCount:Q.totalCount,lastUpdated:new Date().toISOString()}),{...Q,notifications:W,unreadCount:0}}),Fe.success("All notifications marked as read")}catch(M){console.error("Error marking all as read:",M),Fe.error("Failed to mark all as read")}}async function C(j){try{const Z=await(await fetch("/api/student-notifications",{method:"DELETE",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:j,clearAllRead:!0})})).json();if(!Z.success)throw new Error(Z.error||"Failed to clear read notifications");r(Q=>{const W=Q.notifications.filter(U=>!U.isRead),H=g(W);return m(j,Q.currentFilter,{notifications:W,unreadCount:H.unreadCount,totalCount:H.totalCount,lastUpdated:new Date().toISOString()}),{...Q,notifications:W,totalCount:H.totalCount}})}catch(M){throw console.error("Error clearing read notifications:",M),Fe.error("Failed to clear read notifications"),M}}function E(j){r(M=>({...M,currentFilter:j}))}function F(j,M="all"){const Z=f(j,M);return Z?(r(Q=>({...Q,...Z,currentStudentId:j,currentFilter:M,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(Q=>({...Q,currentStudentId:j,currentFilter:M,isLoading:!0,isRefreshing:!1,error:null})),!1)}function S(j,M="all"){try{const Z=l(j,M);localStorage.removeItem(Z)}catch(Z){console.warn("Failed to clear student notifications cache:",Z)}return r(Z=>({...s,currentStudentId:j,currentFilter:M,isLoading:!0})),I.loadNotifications(j,M,!1)}function q(j){try{const M=Object.keys(localStorage),Z=`${el}${j}_`;M.forEach(Q=>{Q.startsWith(Z)&&localStorage.removeItem(Q)})}catch(M){console.warn("Failed to clear all notification cache:",M)}}const I={subscribe:t,init:F,setFilter:E,loadNotifications:b,updateNotificationStatus:y,deleteNotification:x,markAllAsRead:A,clearAllRead:C,forceRefresh:S,clearAllCache:q,getCachedData:(j,M)=>u(j,M)};return I}const xr=Fu();function $u(s,t){d(t,!e(t))}function Nu(s,t,a){d(t,!e(t)),a()}var Pu=(s,t)=>t.onnavigate("notifications"),Lu=_('<span class="navbar-notification-badge"> </span>'),Mu=_('<img alt="Profile" class="avatar-image"/>'),Iu=_('<div class="avatar-placeholder"> </div>'),Ru=(s,t,a)=>{t(),a.onnavigate("profile")},ju=async(s,t,a)=>{t(),await a.onlogout(),Vr("Logged out successfully. See you next time!")},Ou=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),qu=_('<nav class="student-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">school</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <button class="icon-button notifications-button" aria-label="Notifications"><span class="material-symbols-outlined">notifications</span> <!></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function Gu(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(xr,"$studentNotificationStore",a),l=()=>Ja(ws,"$authStore",a);let c=Pa(t,"studentName",3,"John Does"),u=Pa(t,"firstName",3,"John"),f=Pa(t,"gender",3,"male"),m=Pa(t,"accountNumber",3,"STU-2025-0001"),h=Pa(t,"profileImage",3,null),g=Lt(()=>o().unreadCount);function b(Pe){return Pe==="female"?"Ms.":"Mr."}function y(Pe){if(!Pe)return"";if(Pe.includes(","))return Pe.split(",")[0].trim();const we=Pe.trim().split(" ");return we.length>1?we[we.length-1]:we[0]}let x=Lt(()=>`${b(f())} ${y(c())}`),A=at(!0),C=at(!1);function E(){d(C,!1)}function F(Pe){e(C)&&!Pe.target.closest(".user-profile-container")&&E()}async function S(){const Pe=l();if(!(!Pe.isAuthenticated||!Pe.userData?.id))try{await xr.loadNotifications(Pe.userData.id,"all",!0)}catch(we){console.error("Error fetching notification count:",we)}}Ua(()=>{const Pe=localStorage.getItem("theme");d(A,Pe!=="light"),q(),document.addEventListener("click",F);let we;we=ws.subscribe(ct=>{ct.isAuthenticated&&(S(),we&&we())});const tt=setInterval(()=>{l().isAuthenticated&&S()},1e4);return()=>{document.removeEventListener("click",F),clearInterval(tt),we&&we()}});function q(){e(A)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"),I("#121212")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"),I("#FFFFFF"))}function I(Pe){let we=document.querySelector('meta[name="theme-color"]:not([media])');we||(we=document.createElement("meta"),we.setAttribute("name","theme-color"),document.head.appendChild(we)),we.setAttribute("content",Pe)}function j(Pe){return Pe.split(" ").map(we=>we.charAt(0)).join("").toUpperCase().slice(0,2)}var M=qu(),Z=n(M),Q=n(Z),W=n(Q);W.__click=function(...Pe){t.onToggleNavRail?.apply(this,Pe)};var H=v(W,2),U=v(n(H),2),X=n(U);i(U),i(H),i(Q);var B=v(Q,2),oe=n(B);oe.__click=[Nu,A,q];var K=n(oe),de=n(K,!0);i(K),i(oe);var ae=v(oe,2);ae.__click=[Pu,t];var te=v(n(ae),2);{var Ce=Pe=>{var we=Lu(),tt=n(we,!0);i(we),O(()=>w(tt,e(g)>99?"99+":e(g))),p(Pe,we)};$(te,Pe=>{e(g)>0&&Pe(Ce)})}i(ae);var Ae=v(ae,2),Re=n(Ae);Re.__click=[$u,C];var Me=n(Re),Ge=n(Me),be=n(Ge,!0);i(Ge);var ke=v(Ge,2),Ve=n(ke);i(ke),i(Me);var it=v(Me,2),Be=n(it);{var He=Pe=>{var we=Mu();O(()=>Vt(we,"src",h())),p(Pe,we)},Ne=Pe=>{var we=Iu(),tt=n(we,!0);i(we),O(ct=>w(tt,ct),[()=>j(u())]),p(Pe,we)};$(Be,Pe=>{h()?Pe(He):Pe(Ne,!1)})}i(it),i(Re);var Je=v(Re,2);{var lt=Pe=>{var we=Ou(),tt=n(we);tt.__click=[Ru,E,t];var ct=v(tt,2);ct.__click=[ju,E,t],i(we),p(Pe,we)};$(Je,Pe=>{e(C)&&Pe(lt)})}i(Ae),i(B),i(Z),i(M),O(()=>{w(X,`Welcome, ${e(x)??""}`),w(de,e(A)?"light_mode":"dark_mode"),w(be,c()),w(Ve,`Account: ${m()??""}`)}),p(s,M),Ga(),r()}Cs(["click"]);var Vu=(s,t,a)=>t(e(a).id),Bu=_('<button><div class="rail-icon-container"><span class="material-symbols-outlined rail-icon"> </span></div> <span class="rail-label"> </span></button>'),zu=(s,t,a)=>t(e(a).id),Wu=_('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span></div></button>'),Hu=_('<nav aria-label="Student portal navigation"><div class="rail-container"></div></nav> <nav class="bottom-navigation" aria-label="Student portal navigation"><div class="nav-container"></div></nav>',1);function Uu(s,t){qa(t,!0);let a=Pa(t,"activeSection",15,"grades"),r=Pa(t,"isNavRailVisible",3,!0);const o=[{id:"grades",label:"My Grades",icon:"grade"},{id:"ranking",label:"Class Ranking",icon:"leaderboard"},{id:"schedule",label:"Schedule",icon:"schedule"},{id:"documents",label:"Documents",icon:"description"},{id:"todo",label:"Todo List",icon:"checklist"}];function l(b){a(b),t.onnavigate&&t.onnavigate({detail:{section:b}})}var c=Hu(),u=Ue(c);let f;var m=n(u);Tt(m,21,()=>o,b=>b.id,(b,y)=>{var x=Bu();let A;x.__click=[Vu,l,y];var C=n(x),E=n(C),F=n(E,!0);i(E),i(C);var S=v(C,2),q=n(S,!0);i(S),i(x),O(I=>{A=ge(x,1,"rail-item",null,A,I),Vt(x,"aria-label",e(y).label),Vt(x,"aria-current",e(y).id===a()?"page":void 0),w(F,e(y).icon),w(q,e(y).label)},[()=>({active:e(y).id===a()})]),p(b,x)}),i(m),i(u);var h=v(u,2),g=n(h);Tt(g,21,()=>o,b=>b.id,(b,y)=>{var x=Wu();let A;x.__click=[zu,l,y];var C=n(x),E=n(C),F=n(E,!0);i(E),i(C),i(x),O(S=>{A=ge(x,1,"nav-item",null,A,S),Vt(x,"aria-label",e(y).label),Vt(x,"aria-current",e(y).id===a()?"page":void 0),w(F,e(y).icon)},[()=>({active:e(y).id===a()})]),p(b,x)}),i(g),i(h),O(b=>f=ge(u,1,"navigation-rail",null,f,b),[()=>({collapsed:!r()})]),p(s,c),Ga()}Cs(["click"]);const Yu=300*1e3,Qu="student_profile_";function Ku(){const s={studentData:null,studentProfileData:null,studentSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Qs(s);function o(x){return`${Qu}${x}`}function l(x){return!x||!x.timestamp?!1:Date.now()-x.timestamp<Yu}function c(x){try{const A=o(x),C=localStorage.getItem(A);if(C)return JSON.parse(C).data}catch(A){console.warn("Failed to retrieve cached student profile data:",A)}return null}function u(x){try{const A=o(x),C=localStorage.getItem(A);if(C){const E=JSON.parse(C);if(l(E))return E.data}}catch(A){console.warn("Failed to retrieve cached student profile data:",A)}return null}function f(x,A){try{const C=o(x),E={data:A,timestamp:Date.now()};localStorage.setItem(C,JSON.stringify(E))}catch(C){console.warn("Failed to cache student profile data:",C)}}async function m(x,A=!1){try{r(j=>({...j,isLoading:!A,isRefreshing:A,error:null,currentStudentId:x}));const C=await is(`/api/student-profile?studentId=${x}`);if(!C.ok)throw new Error("Failed to fetch student profile data");const E=await C.json();if(!E.success)throw new Error(E.error||"Failed to fetch student profile data");const F=E.data;let S=null;try{const j=await is(`/api/users?id=${x}`);if(j.ok){const M=await j.json();M.success&&M.user&&(S={id:M.user.id||x,number:M.user.account_number,name:M.user.full_name,firstName:M.user.first_name,lastName:M.user.last_name,middleInitial:M.user.middle_initial||"",email:M.user.email,contactNumber:M.user.contact_number,address:M.user.address,birthdate:M.user.birth_date,age:M.user.age,guardian:M.user.guardian,gender:M.user.gender,gradeLevel:F?.section?.gradeLevel||M.user.grade_level})}}catch(j){console.warn("Failed to fetch basic student data:",j)}if(S||(S={id:x,number:x,name:"Student",gradeLevel:F?.section?.gradeLevel||"Not assigned"}),!F?.subjects||F.subjects.length===0)try{const M=await(await is("/api/current-quarter")).json(),Z=M.data?.currentQuarter||2,Q=M.data?.currentSchoolYear||"2025-2026",W=await is(`/api/student-grades?student_id=${x}&quarter=${Z}&school_year=${Q}`);if(W.ok){const H=await W.json();if(H.success&&H.data.grades){const U=H.data.grades.map(X=>({id:X.subject_id,name:X.name,code:X.code||"",teacher:X.teacher,color:h(X.name)}));F?F.subjects=U:F={section:{id:null,name:"No section assigned",gradeLevel:S.grade_level||"Not assigned",adviser:"No adviser"},subjects:U,academicSummary:{generalAverage:H.data.statistics.overallAverage||"Not available",classRank:"Not available",totalStudentsInSection:0,totalSubjectsEnrolled:U.length,totalSubjectsWithGrades:H.data.statistics.countedSubjects||0}}}}}catch(j){console.warn("Failed to fetch subjects from grades API:",j)}let q=[];try{const Z=(await(await is("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",Q=await is(`/api/student-sections?studentId=${x}&schoolYear=${Z}`);if(Q.ok){const W=await Q.json();W.success&&(q=W.data.classData||[])}}catch(j){console.warn("Failed to fetch student sections:",j)}const I={studentData:S,studentProfileData:F,studentSections:q,lastUpdated:new Date().toISOString()};r(j=>({...j,...I,isLoading:!1,isRefreshing:!1,error:null})),f(x,I)}catch(C){console.error("Error loading student profile:",C);const E=c(x);E?(r(F=>({...F,studentData:E.studentData,studentProfileData:E.studentProfileData,studentSections:E.studentSections||[],lastUpdated:E.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Fe.error("No internet connection. Showing offline data.")):r(F=>({...F,isLoading:!1,isRefreshing:!1,error:C.message}))}}function h(x){const A={Mathematics:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Math:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Science:["#059669","#10B981","#34D399","#047857"],English:["#DC2626","#EF4444","#F87171","#B91C1C"],"Physical Education":["#EA580C","#F97316","#FB923C","#C2410C"],MAPEH:["#EA580C","#F97316","#FB923C","#C2410C"],PE:["#EA580C","#F97316","#FB923C","#C2410C"],Filipino:["#7C2D12","#A16207","#D97706","#92400E"],"Araling Panlipunan":["#B45309","#D97706","#F59E0B","#A16207"],History:["#B45309","#D97706","#F59E0B","#A16207"],Computer:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Technology:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Arts:["#C026D3","#D946EF","#E879F9","#A21CAF"],Music:["#EC4899","#F472B6","#F9A8D4","#DB2777"],Health:["#16A34A","#22C55E","#4ADE80","#15803D"],Values:["#0891B2","#06B6D4","#22D3EE","#0E7490"],Research:["#7C2D12","#A16207","#D97706","#92400E"],TLE:["#9333EA","#A855F7","#C084FC","#7E22CE"],ESP:["#0891B2","#06B6D4","#22D3EE","#0E7490"]},C=["#EF4444","#F97316","#F59E0B","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899","#F43F5E","#E11D48","#BE123C","#9F1239","#881337"];function E(I){let j=0;for(let M=0;M<I.length;M++){const Z=I.charCodeAt(M);j=(j<<5)-j+Z,j=j&j}return Math.abs(j)}const F=x.toLowerCase().trim();for(const[I,j]of Object.entries(A))if(F.includes(I.toLowerCase())){const Z=E(x)%j.length;return j[Z]}const q=E(x)%C.length;return C[q]}function g(x){const A=u(x);return A?(r(C=>({...C,...A,currentStudentId:x,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(C=>({...C,currentStudentId:x,isLoading:!0,isRefreshing:!1,error:null})),!1)}function b(x){try{const A=o(x);localStorage.removeItem(A)}catch(A){console.warn("Failed to clear student profile cache:",A)}return r(A=>({...s,currentStudentId:x,isLoading:!0})),y.loadProfile(x,!1)}const y={subscribe:t,init:g,loadProfile:m,forceRefresh:b,getCachedData:x=>c(x)};return y}const xi=Ku();function Ju(s,t){d(t,!e(t))}function Xu(s,t){d(t,!e(t))}function Zu(s,t){d(t,!e(t))}function ev(s,t){ns.confirm("Change Password",`
			<div class="student-profile-password-form">
				<div class="student-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var tv=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),av=_('<div class="silent-refresh-indicator"><span class="refresh-spinner"></span></div>'),sv=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading student information...</p></div>'),rv=_('<div class="info-row row-five"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="info-content"><div class="info-label">Student ID</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person</span></div> <div class="info-content"><div class="info-label">Full Name</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">school</span></div> <div class="info-content"><div class="info-label">Year Level</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">group</span></div> <div class="info-content"><div class="info-label">Section</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="info-content"><div class="info-label">Total Subjects</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">email</span></div> <div class="info-content"><div class="info-label">Email</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">phone</span></div> <div class="info-content"><div class="info-label">Contact Number</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">family_restroom</span></div> <div class="info-content"><div class="info-label">Guardian</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-one"><div class="info-card address-card"><div class="info-icon"><span class="material-symbols-outlined">home</span></div> <div class="info-content"><div class="info-label">Address</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-two"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">cake</span></div> <div class="info-content"><div class="info-label">Birth Date</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Age</div> <div class="info-value"> </div></div></div></div>',1),iv=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading academic performance...</p></div>'),nv=_('<div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Adviser</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">grade</span></div> <div class="info-content"><div class="info-label">General Average</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">leaderboard</span></div> <div class="info-content"><div class="info-label">Class Rank</div> <div class="info-value"> </div></div></div></div>'),ov=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading enrolled subjects...</p></div>'),lv=_('<div class="subject-card"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p class="teacher-name"> </p></div></div>'),cv=_('<div class="subjects-grid"></div>'),dv=_('<div class="subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects enrolled yet</p></div>'),uv=_('<div class="profile-header"><div class="header-content"><h1 class="page-title">Student Profile</h1> <p class="page-subtitle">Personal Information & Academic Details</p></div> <div class="header-actions"><!> <button class="student-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="profile-info-section"><h2 class="section-title section-title-desktop">Student Information</h2> <button class="section-header-mobile" aria-label="Toggle student information"><h2 class="section-title">Student Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-academic-section"><h2 class="section-title section-title-desktop">Academic Performance</h2> <button class="section-header-mobile" aria-label="Toggle academic performance"><h2 class="section-title">Academic Performance</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-subjects-section"><h2 class="section-title section-title-desktop">Enrolled Subjects</h2> <button class="section-header-mobile" aria-label="Toggle enrolled subjects"><h2 class="section-title">Enrolled Subjects</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-security-section"><h2 class="section-title section-title-desktop">Account Security</h2> <div class="section-content"><div class="info-row row-one"><div class="info-card security-card"><div class="info-content-container"><div class="info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="info-content"><div class="info-label">Password</div> <div class="info-value">Change your account password for security</div></div></div> <div class="security-actions"><button class="security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),vv=_('<div class="profile-container"><!></div>');function fv(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(xi,"$studentProfileStore",a);let l=at(void 0);Ss(()=>ws.subscribe(W=>{d(l,W,!0)}));let c=Lt(o),u=Lt(()=>e(c).studentData),f=Lt(()=>e(c).studentProfileData),m=Lt(()=>e(c).isLoading),h=Lt(()=>e(c).isRefreshing),g=Lt(()=>e(c).error);function b(){e(l)?.userData?.id&&xi.forceRefresh(e(l).userData.id)}Ss(()=>{e(l)?.userData?.id&&(xi.init(e(l).userData.id)||xi.loadProfile(e(l).userData.id,!1))}),Ua(()=>{const Q=setInterval(()=>{e(l)?.userData?.id&&xi.loadProfile(e(l).userData.id,!0)},3e5);return()=>clearInterval(Q)});let y=Lt(()=>({id:e(u)?.number||e(l)?.userData?.accountNumber||"N/A",name:e(u)?.name||e(l)?.userData?.name||"Student Name",firstName:e(u)?.firstName||e(l)?.userData?.firstName||"",lastName:e(u)?.lastName||"",middleInitial:e(u)?.middleInitial||"",yearLevel:e(u)?.gradeLevel?`Grade ${e(u).gradeLevel}`:"Not assigned",section:e(f)?.section?.name||"Not assigned",email:e(u)?.email||"Not available",phone:e(u)?.contactNumber||"Not available",address:e(u)?.address||"Not available",birthDate:e(u)?.birthdate?new Date(e(u).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(u)?.age||"Not available",guardian:e(u)?.guardian||"Not available",gender:e(u)?.gender||e(l)?.userData?.gender||"male",academicSummary:{adviser:e(f)?.section?.adviser||"Not available",gpa:e(f)?.academicSummary?.generalAverage||"Not available",rank:e(f)?.academicSummary?.classRank||"Not available",totalStudents:e(f)?.academicSummary?.totalStudentsInSection||"Not available"},subjects:e(f)?.subjects||[]})),x=Lt(()=>e(y).subjects.length||"Not available"),A=at(!0),C=at(!1),E=at(!0),F=at(!1);function S(Q){const W=document.getElementById(Q),U=W.nextElementSibling.querySelector(".password-eye-icon");W.type==="password"?(W.type="text",U.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(W.type="password",U.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=S);async function q(){const Q=document.getElementById("current-password"),W=document.getElementById("new-password"),H=document.getElementById("confirm-password");if(!Q||!W||!H){vs("Password form inputs not found");return}const U=Q.value,X=W.value,B=H.value;if(!U){vs("Current password is required");return}if(!X){vs("New password is required");return}if(X!==B){vs("New passwords do not match");return}if(X.length<8){vs("Password must be at least 8 characters long");return}if(U===X){vs("New password must be different from current password");return}try{d(F,!0);const oe=await api.post("/api/change-password",{currentPassword:U,newPassword:X});oe.success?(Q.value="",W.value="",H.value="",Vr("Password changed successfully!"),ns.close()):vs(oe.error||"Failed to change password")}catch(oe){console.error("Password change error:",oe),vs(oe.message||"Failed to change password")}finally{d(F,!1)}}var I=vv(),j=n(I);{var M=Q=>{var W=tv(),H=v(n(W),2),U=n(H);i(H);var X=v(H,2);X.__click=b,i(W),O(()=>w(U,`Failed to load profile data: ${e(g)??""}`)),p(Q,W)},Z=Q=>{var W=uv(),H=Ue(W),U=v(n(H),2),X=n(U);{var B=G=>{var ie=av();p(G,ie)};$(X,G=>{e(h)&&G(B)})}var oe=v(X,2);oe.__click=b,i(U),i(H);var K=v(H,2),de=v(n(K),2);de.__click=[Ju,A];var ae=v(n(de),2);let te;i(de);var Ce=v(de,2);let Ae;var Re=n(Ce);{var Me=G=>{var ie=sv();p(G,ie)},Ge=G=>{var ie=rv(),_e=Ue(ie),Y=n(_e),N=v(n(Y),2),D=v(n(N),2),L=n(D,!0);i(D),i(N),i(Y);var z=v(Y,2),ve=v(n(z),2),se=v(n(ve),2),$e=n(se,!0);i(se),i(ve),i(z);var he=v(z,2),qe=v(n(he),2),et=v(n(qe),2),Le=n(et,!0);i(et),i(qe),i(he);var Qe=v(he,2),st=v(n(Qe),2),ht=v(n(st),2),_t=n(ht,!0);i(ht),i(st),i(Qe);var xt=v(Qe,2),wt=v(n(xt),2),St=v(n(wt),2),$t=n(St,!0);i(St),i(wt),i(xt),i(_e);var Nt=v(_e,2),Ut=n(Nt),kt=v(n(Ut),2),jt=v(n(kt),2),Wt=n(jt,!0);i(jt),i(kt),i(Ut);var Kt=v(Ut,2),aa=v(n(Kt),2),Yt=v(n(aa),2),pe=n(Yt,!0);i(Yt),i(aa),i(Kt);var Ke=v(Kt,2),yt=v(n(Ke),2),Te=v(n(yt),2),ze=n(Te,!0);i(Te),i(yt),i(Ke),i(Nt);var dt=v(Nt,2),rt=n(dt),vt=v(n(rt),2),Rt=v(n(vt),2),Zt=n(Rt,!0);i(Rt),i(vt),i(rt),i(dt);var ma=v(dt,2),ft=n(ma),ut=v(n(ft),2),me=v(n(ut),2),re=n(me,!0);i(me),i(ut),i(ft);var J=v(ft,2),je=v(n(J),2),Ie=v(n(je),2),ot=n(Ie,!0);i(Ie),i(je),i(J),i(ma),O(()=>{w(L,e(y).id),w($e,e(y).name),w(Le,e(y).yearLevel),w(_t,e(y).section),w($t,e(x)),w(Wt,e(y).email||"Not provided"),w(pe,e(y).phone||"Not provided"),w(ze,e(y).guardian||"Not provided"),w(Zt,e(y).address||"Not provided"),w(re,e(y).birthDate||"Not provided"),w(ot,e(y).age?`${e(y).age} years old`:"Not available")}),p(G,ie)};$(Re,G=>{e(m)?G(Me):G(Ge,!1)})}i(Ce),i(K);var be=v(K,2),ke=v(n(be),2);ke.__click=[Xu,C];var Ve=v(n(ke),2);let it;i(ke);var Be=v(ke,2);let He;var Ne=n(Be);{var Je=G=>{var ie=iv();p(G,ie)},lt=G=>{var ie=nv(),_e=n(ie),Y=v(n(_e),2),N=v(n(Y),2),D=n(N,!0);i(N),i(Y),i(_e);var L=v(_e,2),z=v(n(L),2),ve=v(n(z),2),se=n(ve,!0);i(ve),i(z),i(L);var $e=v(L,2),he=v(n($e),2),qe=v(n(he),2),et=n(qe,!0);i(qe),i(he),i($e),i(ie),O(()=>{w(D,e(y).academicSummary.adviser),w(se,e(y).academicSummary.gpa!=="Not available"?`${e(y).academicSummary.gpa}`:"Not available"),w(et,e(y).academicSummary.rank!=="Not available"&&e(y).academicSummary.totalStudents!=="Not available"?`${e(y).academicSummary.rank} of ${e(y).academicSummary.totalStudents}`:"Not available")}),p(G,ie)};$(Ne,G=>{e(m)?G(Je):G(lt,!1)})}i(Be),i(be);var Pe=v(be,2),we=v(n(Pe),2);we.__click=[Zu,E];var tt=v(n(we),2);let ct;i(we);var xe=v(we,2);let Se;var We=n(xe);{var Ze=G=>{var ie=ov();p(G,ie)},ee=G=>{var ie=mt(),_e=Ue(ie);{var Y=D=>{var L=cv();Tt(L,21,()=>e(y).subjects,z=>z.id,(z,ve)=>{var se=lv(),$e=n(se),he=n($e);i($e);var qe=v($e,2),et=n(qe),Le=n(et,!0);i(et);var Qe=v(et,2),st=n(Qe,!0);i(Qe),i(qe),i(se),O(()=>{Ya(se,`border-color: ${e(ve).color??""};`),Ya(he,`background-color: ${e(ve).color??""}20; color: ${e(ve).color??""}`),w(Le,e(ve).name),w(st,e(ve).teacher)}),p(z,se)}),i(L),p(D,L)},N=D=>{var L=dv();p(D,L)};$(_e,D=>{e(y).subjects.length>0?D(Y):D(N,!1)},!0)}p(G,ie)};$(We,G=>{e(m)?G(Ze):G(ee,!1)})}i(xe),i(Pe);var ue=v(Pe,2),fe=v(n(ue),2),T=n(fe),P=n(T),le=v(n(P),2),R=n(le);R.__click=[ev,q],i(le),i(P),i(T),i(fe),i(ue),O((G,ie,_e,Y,N,D)=>{oe.disabled=e(m),te=ge(ae,1,"material-symbols-outlined collapse-icon",null,te,G),Ae=ge(Ce,1,"section-content",null,Ae,ie),it=ge(Ve,1,"material-symbols-outlined collapse-icon",null,it,_e),He=ge(Be,1,"section-content",null,He,Y),ct=ge(tt,1,"material-symbols-outlined collapse-icon",null,ct,N),Se=ge(xe,1,"section-content",null,Se,D)},[()=>({rotated:e(A)}),()=>({collapsed:e(A)}),()=>({rotated:e(C)}),()=>({collapsed:e(C)}),()=>({rotated:e(E)}),()=>({collapsed:e(E)})]),p(Q,W)};$(j,Q=>{e(g)?Q(M):Q(Z,!1)})}i(I),p(s,I),Ga(),r()}Cs(["click"]);var wn=function(){return wn=Object.assign||function(s){for(var t,a=1,r=arguments.length;a<r;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o]);return s},wn.apply(this,arguments)},pv=(function(){function s(t,a,r){var o=this;this.endVal=a,this.options=r,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(l){o.startTime||(o.startTime=l);var c=l-o.startTime;o.remaining=o.duration-c,o.useEasing?o.countDown?o.frameVal=o.startVal-o.easingFn(c,0,o.startVal-o.endVal,o.duration):o.frameVal=o.easingFn(c,o.startVal,o.endVal-o.startVal,o.duration):o.frameVal=o.startVal+(o.endVal-o.startVal)*(c/o.duration);var u=o.countDown?o.frameVal<o.endVal:o.frameVal>o.endVal;o.frameVal=u?o.endVal:o.frameVal,o.frameVal=Number(o.frameVal.toFixed(o.options.decimalPlaces)),o.printValue(o.frameVal),c<o.duration?o.rAF=requestAnimationFrame(o.count):o.finalEndVal!==null?o.update(o.finalEndVal):o.options.onCompleteCallback&&o.options.onCompleteCallback()},this.formatNumber=function(l){var c,u,f,m,h=l<0?"-":"";c=Math.abs(l).toFixed(o.options.decimalPlaces);var g=(c+="").split(".");if(u=g[0],f=g.length>1?o.options.decimal+g[1]:"",o.options.useGrouping){m="";for(var b=3,y=0,x=0,A=u.length;x<A;++x)o.options.useIndianSeparators&&x===4&&(b=2,y=1),x!==0&&y%b==0&&(m=o.options.separator+m),y++,m=u[A-x-1]+m;u=m}return o.options.numerals&&o.options.numerals.length&&(u=u.replace(/[0-9]/g,(function(C){return o.options.numerals[+C]})),f=f.replace(/[0-9]/g,(function(C){return o.options.numerals[+C]}))),h+o.options.prefix+u+f+o.options.suffix},this.easeOutExpo=function(l,c,u,f){return u*(1-Math.pow(2,-10*l/f))*1024/1023+c},this.options=wn(wn({},this.defaults),r),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof t=="string"?document.getElementById(t):t,a=a??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(a),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,t):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return o.handleScroll(o)})),window.onscroll=function(){window.onScrollFns.forEach((function(l){return l()}))},this.handleScroll(this)))}return s.prototype.handleScroll=function(t){if(t&&window&&!t.once){var a=window.innerHeight+window.scrollY,r=t.el.getBoundingClientRect(),o=r.top+window.pageYOffset,l=r.top+r.height+window.pageYOffset;l<a&&l>window.scrollY&&t.paused?(t.paused=!1,setTimeout((function(){return t.start()}),t.options.scrollSpyDelay),t.options.scrollSpyOnce&&(t.once=!0)):(window.scrollY>l||o>a)&&!t.paused&&t.reset()}},s.prototype.determineDirectionAndSmartEasing=function(){var t=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>t;var a=t-this.startVal;if(Math.abs(a)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=t;var r=this.countDown?1:-1;this.endVal=t+r*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=t,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},s.prototype.start=function(t){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),t&&(this.options.onCompleteCallback=t),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},s.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},s.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},s.prototype.update=function(t){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(t),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},s.prototype.printValue=function(t){var a;if(this.el){var r=this.formattingFn(t);!((a=this.options.plugin)===null||a===void 0)&&a.render?this.options.plugin.render(this.el,r):this.el.tagName==="INPUT"?this.el.value=r:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=r:this.el.innerHTML=r}},s.prototype.ensureNumber=function(t){return typeof t=="number"&&!isNaN(t)},s.prototype.validateValue=function(t){var a=Number(t);return this.ensureNumber(a)?a:(this.error="[CountUp] invalid start or end value: ".concat(t),null)},s.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},s.prototype.parse=function(t){var a=function(c){return c.replace(/([.,' ])/g,"\\$1")},r=a(this.options.separator),o=a(this.options.decimal),l=t.replace(new RegExp(r,"g"),"").replace(new RegExp(o,"g"),".");return parseFloat(l)},s})(),mv=_('<span class="countup-container svelte-185m73z"><!></span>');function Jr(s,t){qa(t,!1);let a=Pa(t,"value",8,0),r=Pa(t,"decimals",8,1),o=Pa(t,"duration",8,2),l=Pa(t,"useEasing",8,!0),c=Pa(t,"useGrouping",8,!0),u=Pa(t,"separator",8,","),f=Pa(t,"decimal",8,"."),m=Pa(t,"prefix",8,""),h=Pa(t,"suffix",8,""),g=Pa(t,"startVal",8,0),b=Pa(t,"colorTransition",8,!1),y=Pa(t,"getGradeColor",8,null),x=V(),A=V(),C=V(!1),E=V(!1),F=V(""),S=null;function q(Q,W){return Q.toFixed(W).replace(/\.0+$/,"")}Ua(()=>(e(x)&&(Ws(x,e(x).textContent=`${m()}${q(g(),r())}${h()}`),b()&&y()&&d(F,y()(65)),d(C,!0),a()!==g()&&a()>0&&j()),()=>{S&&cancelAnimationFrame(S)}));function I(Q){if(!b()||!y()||!Xo)return;const H=Date.now()-Q,U=Math.min(H/(o()*1e3),1);let X=0;a()>=85?X=3:a()>=80?X=2:a()>=75?X=1:X=0;const B=Math.min(U*1.6,1),oe=Math.min(Math.floor(B*(X+1)),X),de=[65,75,80,85][oe];d(F,y()(de)),U<1?S=requestAnimationFrame(()=>I(Q)):d(F,y()(a()))}function j(){if(!(!e(x)||!e(C)||e(E)))try{d(A,new pv(e(x),a(),{startVal:g(),decimalPlaces:r(),duration:o(),useEasing:l(),useGrouping:c(),separator:u(),decimal:f(),prefix:m(),suffix:h(),formattingFn:Q=>Q.toFixed(r()).replace(/\.0+$/,"")})),e(A).error?(console.error("CountUp error:",e(A).error),Ws(x,e(x).textContent=`${m()}${q(a(),r())}${h()}`),b()&&y()&&d(F,y()(a()))):(e(A).start(),d(E,!0),b()&&y()&&I(Date.now()))}catch(Q){console.error("Failed to initialize CountUp:",Q),Ws(x,e(x).textContent=`${m()}${q(a(),r())}${h()}`),b()&&y()&&d(F,y()(a()))}}Ft(()=>(e(C),js(a()),js(g()),e(E)),()=>{e(C)&&a()!==g()&&a()>0&&!e(E)&&j()}),Ft(()=>(e(A),e(E),js(a()),js(g()),js(m()),js(r()),js(h())),()=>{if(e(A)&&Xo&&e(E)&&a()!==g())try{e(A).update(a())}catch(Q){console.error("CountUp update error:",Q),Ws(x,e(x).textContent=`${m()}${q(a(),r())}${h()}`)}}),Is(),Ps();var M=mv(),Z=n(M);$(Z,Q=>{}),i(M),Us(M,Q=>d(x,Q),()=>e(x)),O(()=>Ya(M,b()&&e(F)?`color: ${e(F)}`:"")),p(s,M),Ga()}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Wi(s){return s+.5|0}const Rr=(s,t,a)=>Math.max(Math.min(s,a),t);function Ni(s){return Rr(Wi(s*2.55),0,255)}function qr(s){return Rr(Wi(s*255),0,255)}function Er(s){return Rr(Wi(s/2.55)/100,0,1)}function tl(s){return Rr(Wi(s*100),0,100)}const or={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},uo=[..."0123456789ABCDEF"],hv=s=>uo[s&15],gv=s=>uo[(s&240)>>4]+uo[s&15],rn=s=>(s&240)>>4===(s&15),_v=s=>rn(s.r)&&rn(s.g)&&rn(s.b)&&rn(s.a);function bv(s){var t=s.length,a;return s[0]==="#"&&(t===4||t===5?a={r:255&or[s[1]]*17,g:255&or[s[2]]*17,b:255&or[s[3]]*17,a:t===5?or[s[4]]*17:255}:(t===7||t===9)&&(a={r:or[s[1]]<<4|or[s[2]],g:or[s[3]]<<4|or[s[4]],b:or[s[5]]<<4|or[s[6]],a:t===9?or[s[7]]<<4|or[s[8]]:255})),a}const yv=(s,t)=>s<255?t(s):"";function wv(s){var t=_v(s)?hv:gv;return s?"#"+t(s.r)+t(s.g)+t(s.b)+yv(s.a,t):void 0}const xv=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Tc(s,t,a){const r=t*Math.min(a,1-a),o=(l,c=(l+s/30)%12)=>a-r*Math.max(Math.min(c-3,9-c,1),-1);return[o(0),o(8),o(4)]}function Sv(s,t,a){const r=(o,l=(o+s/60)%6)=>a-a*t*Math.max(Math.min(l,4-l,1),0);return[r(5),r(3),r(1)]}function kv(s,t,a){const r=Tc(s,1,.5);let o;for(t+a>1&&(o=1/(t+a),t*=o,a*=o),o=0;o<3;o++)r[o]*=1-t-a,r[o]+=t;return r}function Dv(s,t,a,r,o){return s===o?(t-a)/r+(t<a?6:0):t===o?(a-s)/r+2:(s-t)/r+4}function go(s){const a=s.r/255,r=s.g/255,o=s.b/255,l=Math.max(a,r,o),c=Math.min(a,r,o),u=(l+c)/2;let f,m,h;return l!==c&&(h=l-c,m=u>.5?h/(2-l-c):h/(l+c),f=Dv(a,r,o,h,l),f=f*60+.5),[f|0,m||0,u]}function _o(s,t,a,r){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,a,r)).map(qr)}function bo(s,t,a){return _o(Tc,s,t,a)}function Av(s,t,a){return _o(kv,s,t,a)}function Cv(s,t,a){return _o(Sv,s,t,a)}function Ec(s){return(s%360+360)%360}function Tv(s){const t=xv.exec(s);let a=255,r;if(!t)return;t[5]!==r&&(a=t[6]?Ni(+t[5]):qr(+t[5]));const o=Ec(+t[2]),l=+t[3]/100,c=+t[4]/100;return t[1]==="hwb"?r=Av(o,l,c):t[1]==="hsv"?r=Cv(o,l,c):r=bo(o,l,c),{r:r[0],g:r[1],b:r[2],a}}function Ev(s,t){var a=go(s);a[0]=Ec(a[0]+t),a=bo(a),s.r=a[0],s.g=a[1],s.b=a[2]}function Fv(s){if(!s)return;const t=go(s),a=t[0],r=tl(t[1]),o=tl(t[2]);return s.a<255?`hsla(${a}, ${r}%, ${o}%, ${Er(s.a)})`:`hsl(${a}, ${r}%, ${o}%)`}const al={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},sl={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function $v(){const s={},t=Object.keys(sl),a=Object.keys(al);let r,o,l,c,u;for(r=0;r<t.length;r++){for(c=u=t[r],o=0;o<a.length;o++)l=a[o],u=u.replace(l,al[l]);l=parseInt(sl[c],16),s[u]=[l>>16&255,l>>8&255,l&255]}return s}let nn;function Nv(s){nn||(nn=$v(),nn.transparent=[0,0,0,0]);const t=nn[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Pv=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Lv(s){const t=Pv.exec(s);let a=255,r,o,l;if(t){if(t[7]!==r){const c=+t[7];a=t[8]?Ni(c):Rr(c*255,0,255)}return r=+t[1],o=+t[3],l=+t[5],r=255&(t[2]?Ni(r):Rr(r,0,255)),o=255&(t[4]?Ni(o):Rr(o,0,255)),l=255&(t[6]?Ni(l):Rr(l,0,255)),{r,g:o,b:l,a}}}function Mv(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${Er(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const Kn=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,li=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function Iv(s,t,a){const r=li(Er(s.r)),o=li(Er(s.g)),l=li(Er(s.b));return{r:qr(Kn(r+a*(li(Er(t.r))-r))),g:qr(Kn(o+a*(li(Er(t.g))-o))),b:qr(Kn(l+a*(li(Er(t.b))-l))),a:s.a+a*(t.a-s.a)}}function on(s,t,a){if(s){let r=go(s);r[t]=Math.max(0,Math.min(r[t]+r[t]*a,t===0?360:1)),r=bo(r),s.r=r[0],s.g=r[1],s.b=r[2]}}function Fc(s,t){return s&&Object.assign(t||{},s)}function rl(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=qr(s[3]))):(t=Fc(s,{r:0,g:0,b:0,a:1}),t.a=qr(t.a)),t}function Rv(s){return s.charAt(0)==="r"?Lv(s):Tv(s)}class qi{constructor(t){if(t instanceof qi)return t;const a=typeof t;let r;a==="object"?r=rl(t):a==="string"&&(r=bv(t)||Nv(t)||Rv(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=Fc(this._rgb);return t&&(t.a=Er(t.a)),t}set rgb(t){this._rgb=rl(t)}rgbString(){return this._valid?Mv(this._rgb):void 0}hexString(){return this._valid?wv(this._rgb):void 0}hslString(){return this._valid?Fv(this._rgb):void 0}mix(t,a){if(t){const r=this.rgb,o=t.rgb;let l;const c=a===l?.5:a,u=2*c-1,f=r.a-o.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;l=1-m,r.r=255&m*r.r+l*o.r+.5,r.g=255&m*r.g+l*o.g+.5,r.b=255&m*r.b+l*o.b+.5,r.a=c*r.a+(1-c)*o.a,this.rgb=r}return this}interpolate(t,a){return t&&(this._rgb=Iv(this._rgb,t._rgb,a)),this}clone(){return new qi(this.rgb)}alpha(t){return this._rgb.a=qr(t),this}clearer(t){const a=this._rgb;return a.a*=1-t,this}greyscale(){const t=this._rgb,a=Wi(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=a,this}opaquer(t){const a=this._rgb;return a.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return on(this._rgb,2,t),this}darken(t){return on(this._rgb,2,-t),this}saturate(t){return on(this._rgb,1,t),this}desaturate(t){return on(this._rgb,1,-t),this}rotate(t){return Ev(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ar(){}const jv=(()=>{let s=0;return()=>s++})();function ds(s){return s==null}function $s(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ka(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function ur(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function gr(s,t){return ur(s)?s:t}function Qa(s,t){return typeof s>"u"?t:s}const Ov=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/t,$c=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function hs(s,t,a){if(s&&typeof s.call=="function")return s.apply(a,t)}function as(s,t,a,r){let o,l,c;if($s(s))for(l=s.length,o=0;o<l;o++)t.call(a,s[o],o);else if(Ka(s))for(c=Object.keys(s),l=c.length,o=0;o<l;o++)t.call(a,s[c[o]],c[o])}function xn(s,t){let a,r,o,l;if(!s||!t||s.length!==t.length)return!1;for(a=0,r=s.length;a<r;++a)if(o=s[a],l=t[a],o.datasetIndex!==l.datasetIndex||o.index!==l.index)return!1;return!0}function Sn(s){if($s(s))return s.map(Sn);if(Ka(s)){const t=Object.create(null),a=Object.keys(s),r=a.length;let o=0;for(;o<r;++o)t[a[o]]=Sn(s[a[o]]);return t}return s}function Nc(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function qv(s,t,a,r){if(!Nc(s))return;const o=t[s],l=a[s];Ka(o)&&Ka(l)?Gi(o,l,r):t[s]=Sn(l)}function Gi(s,t,a){const r=$s(t)?t:[t],o=r.length;if(!Ka(s))return s;a=a||{};const l=a.merger||qv;let c;for(let u=0;u<o;++u){if(c=r[u],!Ka(c))continue;const f=Object.keys(c);for(let m=0,h=f.length;m<h;++m)l(f[m],s,c,a)}return s}function Ii(s,t){return Gi(s,t,{merger:Gv})}function Gv(s,t,a){if(!Nc(s))return;const r=t[s],o=a[s];Ka(r)&&Ka(o)?Ii(r,o):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=Sn(o))}const il={"":s=>s,x:s=>s.x,y:s=>s.y};function Vv(s){const t=s.split("."),a=[];let r="";for(const o of t)r+=o,r.endsWith("\\")?r=r.slice(0,-1)+".":(a.push(r),r="");return a}function Bv(s){const t=Vv(s);return a=>{for(const r of t){if(r==="")break;a=a&&a[r]}return a}}function ei(s,t){return(il[t]||(il[t]=Bv(t)))(s)}function yo(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Vi=s=>typeof s<"u",Br=s=>typeof s=="function",nl=(s,t)=>{if(s.size!==t.size)return!1;for(const a of s)if(!t.has(a))return!1;return!0};function zv(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const cs=Math.PI,Es=2*cs,kn=Number.POSITIVE_INFINITY,Wv=cs/180,Ns=cs/2,Ur=cs/4,ol=cs*2/3,Pc=Math.log10,Gr=Math.sign;function gn(s,t,a){return Math.abs(s-t)<a}function ll(s){const t=Math.round(s);s=gn(s,t,s/1e3)?t:s;const a=Math.pow(10,Math.floor(Pc(s))),r=s/a;return(r<=1?1:r<=2?2:r<=5?5:10)*a}function Hv(s){const t=[],a=Math.sqrt(s);let r;for(r=1;r<a;r++)s%r===0&&(t.push(r),t.push(s/r));return a===(a|0)&&t.push(a),t.sort((o,l)=>o-l).pop(),t}function Uv(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function Dn(s){return!Uv(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function Yv(s,t){const a=Math.round(s);return a-t<=s&&a+t>=s}function Qv(s,t,a){let r,o,l;for(r=0,o=s.length;r<o;r++)l=s[r][a],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function Fr(s){return s*(cs/180)}function Kv(s){return s*(180/cs)}function cl(s){if(!ur(s))return;let t=1,a=0;for(;Math.round(s*t)/t!==s;)t*=10,a++;return a}function Lc(s,t){const a=t.x-s.x,r=t.y-s.y,o=Math.sqrt(a*a+r*r);let l=Math.atan2(r,a);return l<-.5*cs&&(l+=Es),{angle:l,distance:o}}function Jv(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function kr(s){return(s%Es+Es)%Es}function An(s,t,a,r){const o=kr(s),l=kr(t),c=kr(a),u=kr(l-o),f=kr(c-o),m=kr(o-l),h=kr(o-c);return o===l||o===c||r&&l===c||u>f&&m<h}function er(s,t,a){return Math.max(t,Math.min(a,s))}function Xv(s){return er(s,-32768,32767)}function Xr(s,t,a,r=1e-6){return s>=Math.min(t,a)-r&&s<=Math.max(t,a)+r}function wo(s,t,a){a=a||(c=>s[c]<t);let r=s.length-1,o=0,l;for(;r-o>1;)l=o+r>>1,a(l)?o=l:r=l;return{lo:o,hi:r}}const vo=(s,t,a,r)=>wo(s,a,r?o=>{const l=s[o][t];return l<a||l===a&&s[o+1][t]===a}:o=>s[o][t]<a),Zv=(s,t,a)=>wo(s,a,r=>s[r][t]>=a);function ef(s,t,a){let r=0,o=s.length;for(;r<o&&s[r]<t;)r++;for(;o>r&&s[o-1]>a;)o--;return r>0||o<s.length?s.slice(r,o):s}const Mc=["push","pop","shift","splice","unshift"];function tf(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Mc.forEach(a=>{const r="_onData"+yo(a),o=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!1,value(...l){const c=o.apply(this,l);return s._chartjs.listeners.forEach(u=>{typeof u[r]=="function"&&u[r](...l)}),c}})})}function dl(s,t){const a=s._chartjs;if(!a)return;const r=a.listeners,o=r.indexOf(t);o!==-1&&r.splice(o,1),!(r.length>0)&&(Mc.forEach(l=>{delete s[l]}),delete s._chartjs)}function Ic(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const Rc=(function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame})();function jc(s,t){let a=[],r=!1;return function(...o){a=o,r||(r=!0,Rc.call(window,()=>{r=!1,s.apply(t,a)}))}}function af(s,t){let a;return function(...r){return t?(clearTimeout(a),a=setTimeout(s,t,r)):s.apply(this,r),t}}const xo=s=>s==="start"?"left":s==="end"?"right":"center",Hs=(s,t,a)=>s==="start"?t:s==="end"?a:(t+a)/2,sf=(s,t,a,r)=>s===(r?"left":"right")?a:s==="center"?(t+a)/2:t,ln=s=>s===0||s===1,ul=(s,t,a)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*Es/a)),vl=(s,t,a)=>Math.pow(2,-10*s)*Math.sin((s-t)*Es/a)+1,Ri={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*Ns)+1,easeOutSine:s=>Math.sin(s*Ns),easeInOutSine:s=>-.5*(Math.cos(cs*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>ln(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>ln(s)?s:ul(s,.075,.3),easeOutElastic:s=>ln(s)?s:vl(s,.075,.3),easeInOutElastic(s){return ln(s)?s:s<.5?.5*ul(s*2,.1125,.45):.5+.5*vl(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-Ri.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?Ri.easeInBounce(s*2)*.5:Ri.easeOutBounce(s*2-1)*.5+.5};function Oc(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function fl(s){return Oc(s)?s:new qi(s)}function Jn(s){return Oc(s)?s:new qi(s).saturate(.5).darken(.1).hexString()}const rf=["x","y","borderWidth","radius","tension"],nf=["color","borderColor","backgroundColor"];function of(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:nf},numbers:{type:"number",properties:rf}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function lf(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const pl=new Map;function cf(s,t){t=t||{};const a=s+JSON.stringify(t);let r=pl.get(a);return r||(r=new Intl.NumberFormat(s,t),pl.set(a,r)),r}function So(s,t,a){return cf(t,a).format(s)}const df={values(s){return $s(s)?s:""+s},numeric(s,t,a){if(s===0)return"0";const r=this.chart.options.locale;let o,l=s;if(a.length>1){const m=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(m<1e-4||m>1e15)&&(o="scientific"),l=uf(s,a)}const c=Pc(Math.abs(l)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:o,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),So(s,r,f)}};function uf(s,t){let a=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(a)>=1&&s!==Math.floor(s)&&(a=s-Math.floor(s)),a}var qc={formatters:df};function vf(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,a)=>a.lineWidth,tickColor:(t,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:qc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const ti=Object.create(null),fo=Object.create(null);function ji(s,t){if(!t)return s;const a=t.split(".");for(let r=0,o=a.length;r<o;++r){const l=a[r];s=s[l]||(s[l]=Object.create(null))}return s}function Xn(s,t,a){return typeof t=="string"?Gi(ji(s,t),a):Gi(ji(s,""),t)}class ff{constructor(t,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,o)=>Jn(o.backgroundColor),this.hoverBorderColor=(r,o)=>Jn(o.borderColor),this.hoverColor=(r,o)=>Jn(o.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(a)}set(t,a){return Xn(this,t,a)}get(t){return ji(this,t)}describe(t,a){return Xn(fo,t,a)}override(t,a){return Xn(ti,t,a)}route(t,a,r,o){const l=ji(this,t),c=ji(this,r),u="_"+a;Object.defineProperties(l,{[u]:{value:l[a],writable:!0},[a]:{enumerable:!0,get(){const f=this[u],m=c[o];return Ka(f)?Object.assign({},m,f):Qa(f,m)},set(f){this[u]=f}}})}apply(t){t.forEach(a=>a(this))}}var As=new ff({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[of,lf,vf]);function pf(s){return!s||ds(s.size)||ds(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function ml(s,t,a,r,o){let l=t[o];return l||(l=t[o]=s.measureText(o).width,a.push(o)),l>r&&(r=l),r}function Yr(s,t,a){const r=s.currentDevicePixelRatio,o=a!==0?Math.max(a/2,.5):0;return Math.round((t-o)*r)/r+o}function hl(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function gl(s,t,a,r){Gc(s,t,a,r,null)}function Gc(s,t,a,r,o){let l,c,u,f,m,h,g,b;const y=t.pointStyle,x=t.rotation,A=t.radius;let C=(x||0)*Wv;if(y&&typeof y=="object"&&(l=y.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){s.save(),s.translate(a,r),s.rotate(C),s.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),s.restore();return}if(!(isNaN(A)||A<=0)){switch(s.beginPath(),y){default:o?s.ellipse(a,r,o/2,A,0,0,Es):s.arc(a,r,A,0,Es),s.closePath();break;case"triangle":h=o?o/2:A,s.moveTo(a+Math.sin(C)*h,r-Math.cos(C)*A),C+=ol,s.lineTo(a+Math.sin(C)*h,r-Math.cos(C)*A),C+=ol,s.lineTo(a+Math.sin(C)*h,r-Math.cos(C)*A),s.closePath();break;case"rectRounded":m=A*.516,f=A-m,c=Math.cos(C+Ur)*f,g=Math.cos(C+Ur)*(o?o/2-m:f),u=Math.sin(C+Ur)*f,b=Math.sin(C+Ur)*(o?o/2-m:f),s.arc(a-g,r-u,m,C-cs,C-Ns),s.arc(a+b,r-c,m,C-Ns,C),s.arc(a+g,r+u,m,C,C+Ns),s.arc(a-b,r+c,m,C+Ns,C+cs),s.closePath();break;case"rect":if(!x){f=Math.SQRT1_2*A,h=o?o/2:f,s.rect(a-h,r-f,2*h,2*f);break}C+=Ur;case"rectRot":g=Math.cos(C)*(o?o/2:A),c=Math.cos(C)*A,u=Math.sin(C)*A,b=Math.sin(C)*(o?o/2:A),s.moveTo(a-g,r-u),s.lineTo(a+b,r-c),s.lineTo(a+g,r+u),s.lineTo(a-b,r+c),s.closePath();break;case"crossRot":C+=Ur;case"cross":g=Math.cos(C)*(o?o/2:A),c=Math.cos(C)*A,u=Math.sin(C)*A,b=Math.sin(C)*(o?o/2:A),s.moveTo(a-g,r-u),s.lineTo(a+g,r+u),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c);break;case"star":g=Math.cos(C)*(o?o/2:A),c=Math.cos(C)*A,u=Math.sin(C)*A,b=Math.sin(C)*(o?o/2:A),s.moveTo(a-g,r-u),s.lineTo(a+g,r+u),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c),C+=Ur,g=Math.cos(C)*(o?o/2:A),c=Math.cos(C)*A,u=Math.sin(C)*A,b=Math.sin(C)*(o?o/2:A),s.moveTo(a-g,r-u),s.lineTo(a+g,r+u),s.moveTo(a+b,r-c),s.lineTo(a-b,r+c);break;case"line":c=o?o/2:Math.cos(C)*A,u=Math.sin(C)*A,s.moveTo(a-c,r-u),s.lineTo(a+c,r+u);break;case"dash":s.moveTo(a,r),s.lineTo(a+Math.cos(C)*(o?o/2:A),r+Math.sin(C)*A);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function Vc(s,t,a){return a=a||.5,!t||s&&s.x>t.left-a&&s.x<t.right+a&&s.y>t.top-a&&s.y<t.bottom+a}function ko(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function Do(s){s.restore()}function mf(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),ds(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function hf(s,t,a,r,o){if(o.strikethrough||o.underline){const l=s.measureText(r),c=t-l.actualBoundingBoxLeft,u=t+l.actualBoundingBoxRight,f=a-l.actualBoundingBoxAscent,m=a+l.actualBoundingBoxDescent,h=o.strikethrough?(f+m)/2:m;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=o.decorationWidth||2,s.moveTo(c,h),s.lineTo(u,h),s.stroke()}}function gf(s,t){const a=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=a}function Bi(s,t,a,r,o,l={}){const c=$s(t)?t:[t],u=l.strokeWidth>0&&l.strokeColor!=="";let f,m;for(s.save(),s.font=o.string,mf(s,l),f=0;f<c.length;++f)m=c[f],l.backdrop&&gf(s,l.backdrop),u&&(l.strokeColor&&(s.strokeStyle=l.strokeColor),ds(l.strokeWidth)||(s.lineWidth=l.strokeWidth),s.strokeText(m,a,r,l.maxWidth)),s.fillText(m,a,r,l.maxWidth),hf(s,a,r,m,l),r+=Number(o.lineHeight);s.restore()}function Cn(s,t){const{x:a,y:r,w:o,h:l,radius:c}=t;s.arc(a+c.topLeft,r+c.topLeft,c.topLeft,1.5*cs,cs,!0),s.lineTo(a,r+l-c.bottomLeft),s.arc(a+c.bottomLeft,r+l-c.bottomLeft,c.bottomLeft,cs,Ns,!0),s.lineTo(a+o-c.bottomRight,r+l),s.arc(a+o-c.bottomRight,r+l-c.bottomRight,c.bottomRight,Ns,0,!0),s.lineTo(a+o,r+c.topRight),s.arc(a+o-c.topRight,r+c.topRight,c.topRight,0,-Ns,!0),s.lineTo(a+c.topLeft,r)}const _f=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,bf=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function yf(s,t){const a=(""+s).match(_f);if(!a||a[1]==="normal")return t*1.2;switch(s=+a[2],a[3]){case"px":return s;case"%":s/=100;break}return t*s}const wf=s=>+s||0;function Ao(s,t){const a={},r=Ka(t),o=r?Object.keys(t):t,l=Ka(s)?r?c=>Qa(s[c],s[t[c]]):c=>s[c]:()=>s;for(const c of o)a[c]=wf(l(c));return a}function Bc(s){return Ao(s,{top:"y",right:"x",bottom:"y",left:"x"})}function vi(s){return Ao(s,["topLeft","topRight","bottomLeft","bottomRight"])}function vr(s){const t=Bc(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Ys(s,t){s=s||{},t=t||As.font;let a=Qa(s.size,t.size);typeof a=="string"&&(a=parseInt(a,10));let r=Qa(s.style,t.style);r&&!(""+r).match(bf)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const o={family:Qa(s.family,t.family),lineHeight:yf(Qa(s.lineHeight,t.lineHeight),a),size:a,style:r,weight:Qa(s.weight,t.weight),string:""};return o.string=pf(o),o}function cn(s,t,a,r){let o,l,c;for(o=0,l=s.length;o<l;++o)if(c=s[o],c!==void 0&&c!==void 0)return c}function xf(s,t,a){const{min:r,max:o}=s,l=$c(t,(o-r)/2),c=(u,f)=>a&&u===0?0:u+f;return{min:c(r,-Math.abs(l)),max:c(o,l)}}function mi(s,t){return Object.assign(Object.create(s),t)}function Co(s,t=[""],a,r,o=()=>s[0]){const l=a||s;typeof r>"u"&&(r=Uc("_fallback",s));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:l,_fallback:r,_getTarget:o,override:u=>Co([u,...s],t,l,r)};return new Proxy(c,{deleteProperty(u,f){return delete u[f],delete u._keys,delete s[0][f],!0},get(u,f){return Wc(u,f,()=>Ff(f,t,s,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(u,f){return bl(u).includes(f)},ownKeys(u){return bl(u)},set(u,f,m){const h=u._storage||(u._storage=o());return u[f]=h[f]=m,delete u._keys,!0}})}function pi(s,t,a,r){const o={_cacheable:!1,_proxy:s,_context:t,_subProxy:a,_stack:new Set,_descriptors:zc(s,r),setContext:l=>pi(s,l,a,r),override:l=>pi(s.override(l),t,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete s[c],!0},get(l,c,u){return Wc(l,c,()=>kf(l,c,u))},getOwnPropertyDescriptor(l,c){return l._descriptors.allKeys?Reflect.has(s,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,c)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(l,c){return Reflect.has(s,c)},ownKeys(){return Reflect.ownKeys(s)},set(l,c,u){return s[c]=u,delete l[c],!0}})}function zc(s,t={scriptable:!0,indexable:!0}){const{_scriptable:a=t.scriptable,_indexable:r=t.indexable,_allKeys:o=t.allKeys}=s;return{allKeys:o,scriptable:a,indexable:r,isScriptable:Br(a)?a:()=>a,isIndexable:Br(r)?r:()=>r}}const Sf=(s,t)=>s?s+yo(t):t,To=(s,t)=>Ka(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Wc(s,t,a){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const r=a();return s[t]=r,r}function kf(s,t,a){const{_proxy:r,_context:o,_subProxy:l,_descriptors:c}=s;let u=r[t];return Br(u)&&c.isScriptable(t)&&(u=Df(t,u,s,a)),$s(u)&&u.length&&(u=Af(t,u,s,c.isIndexable)),To(t,u)&&(u=pi(u,o,l&&l[t],c)),u}function Df(s,t,a,r){const{_proxy:o,_context:l,_subProxy:c,_stack:u}=a;if(u.has(s))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+s);u.add(s);let f=t(l,c||r);return u.delete(s),To(s,f)&&(f=Eo(o._scopes,o,s,f)),f}function Af(s,t,a,r){const{_proxy:o,_context:l,_subProxy:c,_descriptors:u}=a;if(typeof l.index<"u"&&r(s))return t[l.index%t.length];if(Ka(t[0])){const f=t,m=o._scopes.filter(h=>h!==f);t=[];for(const h of f){const g=Eo(m,o,s,h);t.push(pi(g,l,c&&c[s],u))}}return t}function Hc(s,t,a){return Br(s)?s(t,a):s}const Cf=(s,t)=>s===!0?t:typeof s=="string"?ei(t,s):void 0;function Tf(s,t,a,r,o){for(const l of t){const c=Cf(a,l);if(c){s.add(c);const u=Hc(c._fallback,a,o);if(typeof u<"u"&&u!==a&&u!==r)return u}else if(c===!1&&typeof r<"u"&&a!==r)return null}return!1}function Eo(s,t,a,r){const o=t._rootScopes,l=Hc(t._fallback,a,r),c=[...s,...o],u=new Set;u.add(r);let f=_l(u,c,a,l||a,r);return f===null||typeof l<"u"&&l!==a&&(f=_l(u,c,l,f,r),f===null)?!1:Co(Array.from(u),[""],o,l,()=>Ef(t,a,r))}function _l(s,t,a,r,o){for(;a;)a=Tf(s,t,a,r,o);return a}function Ef(s,t,a){const r=s._getTarget();t in r||(r[t]={});const o=r[t];return $s(o)&&Ka(a)?a:o||{}}function Ff(s,t,a,r){let o;for(const l of t)if(o=Uc(Sf(l,s),a),typeof o<"u")return To(s,o)?Eo(a,r,s,o):o}function Uc(s,t){for(const a of t){if(!a)continue;const r=a[s];if(typeof r<"u")return r}}function bl(s){let t=s._keys;return t||(t=s._keys=$f(s._scopes)),t}function $f(s){const t=new Set;for(const a of s)for(const r of Object.keys(a).filter(o=>!o.startsWith("_")))t.add(r);return Array.from(t)}function Fo(){return typeof window<"u"&&typeof document<"u"}function $o(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Tn(s,t,a){let r;return typeof s=="string"?(r=parseInt(s,10),s.indexOf("%")!==-1&&(r=r/100*t.parentNode[a])):r=s,r}const Nn=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function Nf(s,t){return Nn(s).getPropertyValue(t)}const Pf=["top","right","bottom","left"];function Zr(s,t,a){const r={};a=a?"-"+a:"";for(let o=0;o<4;o++){const l=Pf[o];r[l]=parseFloat(s[t+"-"+l+a])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Lf=(s,t,a)=>(s>0||t>0)&&(!a||!a.shadowRoot);function Mf(s,t){const a=s.touches,r=a&&a.length?a[0]:s,{offsetX:o,offsetY:l}=r;let c=!1,u,f;if(Lf(o,l,s.target))u=o,f=l;else{const m=t.getBoundingClientRect();u=r.clientX-m.left,f=r.clientY-m.top,c=!0}return{x:u,y:f,box:c}}function Kr(s,t){if("native"in s)return s;const{canvas:a,currentDevicePixelRatio:r}=t,o=Nn(a),l=o.boxSizing==="border-box",c=Zr(o,"padding"),u=Zr(o,"border","width"),{x:f,y:m,box:h}=Mf(s,a),g=c.left+(h&&u.left),b=c.top+(h&&u.top);let{width:y,height:x}=t;return l&&(y-=c.width+u.width,x-=c.height+u.height),{x:Math.round((f-g)/y*a.width/r),y:Math.round((m-b)/x*a.height/r)}}function If(s,t,a){let r,o;if(t===void 0||a===void 0){const l=s&&$o(s);if(!l)t=s.clientWidth,a=s.clientHeight;else{const c=l.getBoundingClientRect(),u=Nn(l),f=Zr(u,"border","width"),m=Zr(u,"padding");t=c.width-m.width-f.width,a=c.height-m.height-f.height,r=Tn(u.maxWidth,l,"clientWidth"),o=Tn(u.maxHeight,l,"clientHeight")}}return{width:t,height:a,maxWidth:r||kn,maxHeight:o||kn}}const jr=s=>Math.round(s*10)/10;function Rf(s,t,a,r){const o=Nn(s),l=Zr(o,"margin"),c=Tn(o.maxWidth,s,"clientWidth")||kn,u=Tn(o.maxHeight,s,"clientHeight")||kn,f=If(s,t,a);let{width:m,height:h}=f;if(o.boxSizing==="content-box"){const b=Zr(o,"border","width"),y=Zr(o,"padding");m-=y.width+b.width,h-=y.height+b.height}return m=Math.max(0,m-l.width),h=Math.max(0,r?m/r:h-l.height),m=jr(Math.min(m,c,f.maxWidth)),h=jr(Math.min(h,u,f.maxHeight)),m&&!h&&(h=jr(m/2)),(t!==void 0||a!==void 0)&&r&&f.height&&h>f.height&&(h=f.height,m=jr(Math.floor(h*r))),{width:m,height:h}}function yl(s,t,a){const r=t||1,o=jr(s.height*r),l=jr(s.width*r);s.height=jr(s.height),s.width=jr(s.width);const c=s.canvas;return c.style&&(a||!c.style.height&&!c.style.width)&&(c.style.height=`${s.height}px`,c.style.width=`${s.width}px`),s.currentDevicePixelRatio!==r||c.height!==o||c.width!==l?(s.currentDevicePixelRatio=r,c.height=o,c.width=l,s.ctx.setTransform(r,0,0,r,0,0),!0):!1}const jf=(function(){let s=!1;try{const t={get passive(){return s=!0,!1}};Fo()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s})();function wl(s,t){const a=Nf(s,t),r=a&&a.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const Of=function(s,t){return{x(a){return s+s+t-a},setWidth(a){t=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,r){return a-r},leftForLtr(a,r){return a-r}}},qf=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function fi(s,t,a){return s?Of(t,a):qf()}function Yc(s,t){let a,r;(t==="ltr"||t==="rtl")&&(a=s.canvas.style,r=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",t,"important"),s.prevTextDirection=r)}function Qc(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function dn(s,t,a){return s.options.clip?s[a]:t[a]}function Gf(s,t){const{xScale:a,yScale:r}=s;return a&&r?{left:dn(a,t,"left"),right:dn(a,t,"right"),top:dn(r,t,"top"),bottom:dn(r,t,"bottom")}:t}function Vf(s,t){const a=t._clip;if(a.disabled)return!1;const r=Gf(t,s.chartArea);return{left:a.left===!1?0:r.left-(a.left===!0?0:a.left),right:a.right===!1?s.width:r.right+(a.right===!0?0:a.right),top:a.top===!1?0:r.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?s.height:r.bottom+(a.bottom===!0?0:a.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Bf{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,a,r,o){const l=a.listeners[o],c=a.duration;l.forEach(u=>u({chart:t,initial:a.initial,numSteps:c,currentStep:Math.min(r-a.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=Rc.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let a=0;this._charts.forEach((r,o)=>{if(!r.running||!r.items.length)return;const l=r.items;let c=l.length-1,u=!1,f;for(;c>=0;--c)f=l[c],f._active?(f._total>r.duration&&(r.duration=f._total),f.tick(t),u=!0):(l[c]=l[l.length-1],l.pop());u&&(o.draw(),this._notify(o,r,t,"progress")),l.length||(r.running=!1,this._notify(o,r,t,"complete"),r.initial=!1),a+=l.length}),this._lastDate=t,a===0&&(this._running=!1)}_getAnims(t){const a=this._charts;let r=a.get(t);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(t,r)),r}listen(t,a,r){this._getAnims(t).listeners[a].push(r)}add(t,a){!a||!a.length||this._getAnims(t).items.push(...a)}has(t){return this._getAnims(t).items.length>0}start(t){const a=this._charts.get(t);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((r,o)=>Math.max(r,o._duration),0),this._refresh())}running(t){if(!this._running)return!1;const a=this._charts.get(t);return!(!a||!a.running||!a.items.length)}stop(t){const a=this._charts.get(t);if(!a||!a.items.length)return;const r=a.items;let o=r.length-1;for(;o>=0;--o)r[o].cancel();a.items=[],this._notify(t,a,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Cr=new Bf;const xl="transparent",zf={boolean(s,t,a){return a>.5?t:s},color(s,t,a){const r=fl(s||xl),o=r.valid&&fl(t||xl);return o&&o.valid?o.mix(r,a).hexString():t},number(s,t,a){return s+(t-s)*a}};class Wf{constructor(t,a,r,o){const l=a[r];o=cn([t.to,o,l,t.from]);const c=cn([t.from,l,o]);this._active=!0,this._fn=t.fn||zf[t.type||typeof c],this._easing=Ri[t.easing]||Ri.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=a,this._prop=r,this._from=c,this._to=o,this._promises=void 0}active(){return this._active}update(t,a,r){if(this._active){this._notify(!1);const o=this._target[this._prop],l=r-this._start,c=this._duration-l;this._start=r,this._duration=Math.floor(Math.max(c,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=cn([t.to,a,o,t.from]),this._from=cn([t.from,o,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const a=t-this._start,r=this._duration,o=this._prop,l=this._from,c=this._loop,u=this._to;let f;if(this._active=l!==u&&(c||a<r),!this._active){this._target[o]=u,this._notify(!0);return}if(a<0){this._target[o]=l;return}f=a/r%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[o]=this._fn(l,u,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((a,r)=>{t.push({res:a,rej:r})})}_notify(t){const a=t?"res":"rej",r=this._promises||[];for(let o=0;o<r.length;o++)r[o][a]()}}class Kc{constructor(t,a){this._chart=t,this._properties=new Map,this.configure(a)}configure(t){if(!Ka(t))return;const a=Object.keys(As.animation),r=this._properties;Object.getOwnPropertyNames(t).forEach(o=>{const l=t[o];if(!Ka(l))return;const c={};for(const u of a)c[u]=l[u];($s(l.properties)&&l.properties||[o]).forEach(u=>{(u===o||!r.has(u))&&r.set(u,c)})})}_animateOptions(t,a){const r=a.options,o=Uf(t,r);if(!o)return[];const l=this._createAnimations(o,r);return r.$shared&&Hf(t.options.$animations,r).then(()=>{t.options=r},()=>{}),l}_createAnimations(t,a){const r=this._properties,o=[],l=t.$animations||(t.$animations={}),c=Object.keys(a),u=Date.now();let f;for(f=c.length-1;f>=0;--f){const m=c[f];if(m.charAt(0)==="$")continue;if(m==="options"){o.push(...this._animateOptions(t,a));continue}const h=a[m];let g=l[m];const b=r.get(m);if(g)if(b&&g.active()){g.update(b,h,u);continue}else g.cancel();if(!b||!b.duration){t[m]=h;continue}l[m]=g=new Wf(b,t,m,h),o.push(g)}return o}update(t,a){if(this._properties.size===0){Object.assign(t,a);return}const r=this._createAnimations(t,a);if(r.length)return Cr.add(this._chart,r),!0}}function Hf(s,t){const a=[],r=Object.keys(t);for(let o=0;o<r.length;o++){const l=s[r[o]];l&&l.active()&&a.push(l.wait())}return Promise.all(a)}function Uf(s,t){if(!t)return;let a=s.options;if(!a){s.options=t;return}return a.$shared&&(s.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function Sl(s,t){const a=s&&s.options||{},r=a.reverse,o=a.min===void 0?t:0,l=a.max===void 0?t:0;return{start:r?l:o,end:r?o:l}}function Yf(s,t,a){if(a===!1)return!1;const r=Sl(s,a),o=Sl(t,a);return{top:o.end,right:r.end,bottom:o.start,left:r.start}}function Qf(s){let t,a,r,o;return Ka(s)?(t=s.top,a=s.right,r=s.bottom,o=s.left):t=a=r=o=s,{top:t,right:a,bottom:r,left:o,disabled:s===!1}}function Jc(s,t){const a=[],r=s._getSortedDatasetMetas(t);let o,l;for(o=0,l=r.length;o<l;++o)a.push(r[o].index);return a}function kl(s,t,a,r={}){const o=s.keys,l=r.mode==="single";let c,u,f,m;if(t===null)return;let h=!1;for(c=0,u=o.length;c<u;++c){if(f=+o[c],f===a){if(h=!0,r.all)continue;break}m=s.values[f],ur(m)&&(l||t===0||Gr(t)===Gr(m))&&(t+=m)}return!h&&!r.all?0:t}function Kf(s,t){const{iScale:a,vScale:r}=t,o=a.axis==="x"?"x":"y",l=r.axis==="x"?"x":"y",c=Object.keys(s),u=new Array(c.length);let f,m,h;for(f=0,m=c.length;f<m;++f)h=c[f],u[f]={[o]:h,[l]:s[h]};return u}function Zn(s,t){const a=s&&s.options.stacked;return a||a===void 0&&t.stack!==void 0}function Jf(s,t,a){return`${s.id}.${t.id}.${a.stack||a.type}`}function Xf(s){const{min:t,max:a,minDefined:r,maxDefined:o}=s.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:o?a:Number.POSITIVE_INFINITY}}function Zf(s,t,a){const r=s[t]||(s[t]={});return r[a]||(r[a]={})}function Dl(s,t,a,r){for(const o of t.getMatchingVisibleMetas(r).reverse()){const l=s[o.index];if(a&&l>0||!a&&l<0)return o.index}return null}function Al(s,t){const{chart:a,_cachedMeta:r}=s,o=a._stacks||(a._stacks={}),{iScale:l,vScale:c,index:u}=r,f=l.axis,m=c.axis,h=Jf(l,c,r),g=t.length;let b;for(let y=0;y<g;++y){const x=t[y],{[f]:A,[m]:C}=x,E=x._stacks||(x._stacks={});b=E[m]=Zf(o,h,A),b[u]=C,b._top=Dl(b,c,!0,r.type),b._bottom=Dl(b,c,!1,r.type);const F=b._visualValues||(b._visualValues={});F[u]=C}}function eo(s,t){const a=s.scales;return Object.keys(a).filter(r=>a[r].axis===t).shift()}function ep(s,t){return mi(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function tp(s,t,a){return mi(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:a,index:t,mode:"default",type:"data"})}function Si(s,t){const a=s.controller.index,r=s.vScale&&s.vScale.axis;if(r){t=t||s._parsed;for(const o of t){const l=o._stacks;if(!l||l[r]===void 0||l[r][a]===void 0)return;delete l[r][a],l[r]._visualValues!==void 0&&l[r]._visualValues[a]!==void 0&&delete l[r]._visualValues[a]}}}const to=s=>s==="reset"||s==="none",Cl=(s,t)=>t?s:Object.assign({},s),ap=(s,t,a)=>s&&!t.hidden&&t._stacked&&{keys:Jc(a,!0),values:null};class No{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,a){this.chart=t,this._ctx=t.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Zn(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Si(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,a=this._cachedMeta,r=this.getDataset(),o=(g,b,y,x)=>g==="x"?b:g==="r"?x:y,l=a.xAxisID=Qa(r.xAxisID,eo(t,"x")),c=a.yAxisID=Qa(r.yAxisID,eo(t,"y")),u=a.rAxisID=Qa(r.rAxisID,eo(t,"r")),f=a.indexAxis,m=a.iAxisID=o(f,l,c,u),h=a.vAxisID=o(f,c,l,u);a.xScale=this.getScaleForId(l),a.yScale=this.getScaleForId(c),a.rScale=this.getScaleForId(u),a.iScale=this.getScaleForId(m),a.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const a=this._cachedMeta;return t===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&dl(this._data,this),t._stacked&&Si(t)}_dataCheck(){const t=this.getDataset(),a=t.data||(t.data=[]),r=this._data;if(Ka(a)){const o=this._cachedMeta;this._data=Kf(a,o)}else if(r!==a){if(r){dl(r,this);const o=this._cachedMeta;Si(o),o._parsed=[]}a&&Object.isExtensible(a)&&tf(a,this),this._syncList=[],this._data=a}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const a=this._cachedMeta,r=this.getDataset();let o=!1;this._dataCheck();const l=a._stacked;a._stacked=Zn(a.vScale,a),a.stack!==r.stack&&(o=!0,Si(a),a.stack=r.stack),this._resyncElements(t),(o||l!==a._stacked)&&(Al(this,a._parsed),a._stacked=Zn(a.vScale,a))}configure(){const t=this.chart.config,a=t.datasetScopeKeys(this._type),r=t.getOptionScopes(this.getDataset(),a,!0);this.options=t.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,a){const{_cachedMeta:r,_data:o}=this,{iScale:l,_stacked:c}=r,u=l.axis;let f=t===0&&a===o.length?!0:r._sorted,m=t>0&&r._parsed[t-1],h,g,b;if(this._parsing===!1)r._parsed=o,r._sorted=!0,b=o;else{$s(o[t])?b=this.parseArrayData(r,o,t,a):Ka(o[t])?b=this.parseObjectData(r,o,t,a):b=this.parsePrimitiveData(r,o,t,a);const y=()=>g[u]===null||m&&g[u]<m[u];for(h=0;h<a;++h)r._parsed[h+t]=g=b[h],f&&(y()&&(f=!1),m=g);r._sorted=f}c&&Al(this,b)}parsePrimitiveData(t,a,r,o){const{iScale:l,vScale:c}=t,u=l.axis,f=c.axis,m=l.getLabels(),h=l===c,g=new Array(o);let b,y,x;for(b=0,y=o;b<y;++b)x=b+r,g[b]={[u]:h||l.parse(m[x],x),[f]:c.parse(a[x],x)};return g}parseArrayData(t,a,r,o){const{xScale:l,yScale:c}=t,u=new Array(o);let f,m,h,g;for(f=0,m=o;f<m;++f)h=f+r,g=a[h],u[f]={x:l.parse(g[0],h),y:c.parse(g[1],h)};return u}parseObjectData(t,a,r,o){const{xScale:l,yScale:c}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(o);let h,g,b,y;for(h=0,g=o;h<g;++h)b=h+r,y=a[b],m[h]={x:l.parse(ei(y,u),b),y:c.parse(ei(y,f),b)};return m}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,a,r){const o=this.chart,l=this._cachedMeta,c=a[t.axis],u={keys:Jc(o,!0),values:a._stacks[t.axis]._visualValues};return kl(u,c,l.index,{mode:r})}updateRangeFromParsed(t,a,r,o){const l=r[a.axis];let c=l===null?NaN:l;const u=o&&r._stacks[a.axis];o&&u&&(o.values=u,c=kl(o,l,this._cachedMeta.index)),t.min=Math.min(t.min,c),t.max=Math.max(t.max,c)}getMinMax(t,a){const r=this._cachedMeta,o=r._parsed,l=r._sorted&&t===r.iScale,c=o.length,u=this._getOtherScale(t),f=ap(a,r,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:g}=Xf(u);let b,y;function x(){y=o[b];const A=y[u.axis];return!ur(y[t.axis])||h>A||g<A}for(b=0;b<c&&!(!x()&&(this.updateRangeFromParsed(m,t,y,f),l));++b);if(l){for(b=c-1;b>=0;--b)if(!x()){this.updateRangeFromParsed(m,t,y,f);break}}return m}getAllParsedValues(t){const a=this._cachedMeta._parsed,r=[];let o,l,c;for(o=0,l=a.length;o<l;++o)c=a[o][t.axis],ur(c)&&r.push(c);return r}getMaxOverflow(){return!1}getLabelAndValue(t){const a=this._cachedMeta,r=a.iScale,o=a.vScale,l=this.getParsed(t);return{label:r?""+r.getLabelForValue(l[r.axis]):"",value:o?""+o.getLabelForValue(l[o.axis]):""}}_update(t){const a=this._cachedMeta;this.update(t||"default"),a._clip=Qf(Qa(this.options.clip,Yf(a.xScale,a.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,a=this.chart,r=this._cachedMeta,o=r.data||[],l=a.chartArea,c=[],u=this._drawStart||0,f=this._drawCount||o.length-u,m=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(t,l,u,f),h=u;h<u+f;++h){const g=o[h];g.hidden||(g.active&&m?c.push(g):g.draw(t,l))}for(h=0;h<c.length;++h)c[h].draw(t,l)}getStyle(t,a){const r=a?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(t||0,r)}getContext(t,a,r){const o=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const c=this._cachedMeta.data[t];l=c.$context||(c.$context=tp(this.getContext(),t,c)),l.parsed=this.getParsed(t),l.raw=o.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=ep(this.chart.getContext(),this.index)),l.dataset=o,l.index=l.datasetIndex=this.index;return l.active=!!a,l.mode=r,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,a){return this._resolveElementOptions(this.dataElementType.id,a,t)}_resolveElementOptions(t,a="default",r){const o=a==="active",l=this._cachedDataOpts,c=t+"-"+a,u=l[c],f=this.enableOptionSharing&&Vi(r);if(u)return Cl(u,f);const m=this.chart.config,h=m.datasetElementScopeKeys(this._type,t),g=o?[`${t}Hover`,"hover",t,""]:[t,""],b=m.getOptionScopes(this.getDataset(),h),y=Object.keys(As.elements[t]),x=()=>this.getContext(r,o,a),A=m.resolveNamedOptions(b,y,x,g);return A.$shared&&(A.$shared=f,l[c]=Object.freeze(Cl(A,f))),A}_resolveAnimations(t,a,r){const o=this.chart,l=this._cachedDataOpts,c=`animation-${a}`,u=l[c];if(u)return u;let f;if(o.options.animation!==!1){const h=this.chart.config,g=h.datasetAnimationScopeKeys(this._type,a),b=h.getOptionScopes(this.getDataset(),g);f=h.createResolver(b,this.getContext(t,r,a))}const m=new Kc(o,f&&f.animations);return f&&f._cacheable&&(l[c]=Object.freeze(m)),m}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,a){return!a||to(t)||this.chart._animationsDisabled}_getSharedOptions(t,a){const r=this.resolveDataElementOptions(t,a),o=this._sharedOptions,l=this.getSharedOptions(r),c=this.includeOptions(a,l)||l!==o;return this.updateSharedOptions(l,a,r),{sharedOptions:l,includeOptions:c}}updateElement(t,a,r,o){to(o)?Object.assign(t,r):this._resolveAnimations(a,o).update(t,r)}updateSharedOptions(t,a,r){t&&!to(a)&&this._resolveAnimations(void 0,a).update(t,r)}_setStyle(t,a,r,o){t.active=o;const l=this.getStyle(a,o);this._resolveAnimations(a,r,o).update(t,{options:!o&&this.getSharedOptions(l)||l})}removeHoverStyle(t,a,r){this._setStyle(t,r,"active",!1)}setHoverStyle(t,a,r){this._setStyle(t,r,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const a=this._data,r=this._cachedMeta.data;for(const[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];const o=r.length,l=a.length,c=Math.min(l,o);c&&this.parse(0,c),l>o?this._insertElements(o,l-o,t):l<o&&this._removeElements(l,o-l)}_insertElements(t,a,r=!0){const o=this._cachedMeta,l=o.data,c=t+a;let u;const f=m=>{for(m.length+=a,u=m.length-1;u>=c;u--)m[u]=m[u-a]};for(f(l),u=t;u<c;++u)l[u]=new this.dataElementType;this._parsing&&f(o._parsed),this.parse(t,a),r&&this.updateElements(l,t,a,"reset")}updateElements(t,a,r,o){}_removeElements(t,a){const r=this._cachedMeta;if(this._parsing){const o=r._parsed.splice(t,a);r._stacked&&Si(r,o)}r.data.splice(t,a)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[a,r,o]=t;this[a](r,o)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,a){a&&this._sync(["_removeElements",t,a]);const r=arguments.length-2;r&&this._sync(["_insertElements",t,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function sp(s,t){if(!s._cache.$bar){const a=s.getMatchingVisibleMetas(t);let r=[];for(let o=0,l=a.length;o<l;o++)r=r.concat(a[o].controller.getAllParsedValues(s));s._cache.$bar=Ic(r.sort((o,l)=>o-l))}return s._cache.$bar}function rp(s){const t=s.iScale,a=sp(t,s.type);let r=t._length,o,l,c,u;const f=()=>{c===32767||c===-32768||(Vi(u)&&(r=Math.min(r,Math.abs(c-u)||r)),u=c)};for(o=0,l=a.length;o<l;++o)c=t.getPixelForValue(a[o]),f();for(u=void 0,o=0,l=t.ticks.length;o<l;++o)c=t.getPixelForTick(o),f();return r}function ip(s,t,a,r){const o=a.barThickness;let l,c;return ds(o)?(l=t.min*a.categoryPercentage,c=a.barPercentage):(l=o*r,c=1),{chunk:l/r,ratio:c,start:t.pixels[s]-l/2}}function np(s,t,a,r){const o=t.pixels,l=o[s];let c=s>0?o[s-1]:null,u=s<o.length-1?o[s+1]:null;const f=a.categoryPercentage;c===null&&(c=l-(u===null?t.end-t.start:u-l)),u===null&&(u=l+l-c);const m=l-(l-Math.min(c,u))/2*f;return{chunk:Math.abs(u-c)/2*f/r,ratio:a.barPercentage,start:m}}function op(s,t,a,r){const o=a.parse(s[0],r),l=a.parse(s[1],r),c=Math.min(o,l),u=Math.max(o,l);let f=c,m=u;Math.abs(c)>Math.abs(u)&&(f=u,m=c),t[a.axis]=m,t._custom={barStart:f,barEnd:m,start:o,end:l,min:c,max:u}}function Xc(s,t,a,r){return $s(s)?op(s,t,a,r):t[a.axis]=a.parse(s,r),t}function Tl(s,t,a,r){const o=s.iScale,l=s.vScale,c=o.getLabels(),u=o===l,f=[];let m,h,g,b;for(m=a,h=a+r;m<h;++m)b=t[m],g={},g[o.axis]=u||o.parse(c[m],m),f.push(Xc(b,g,l,m));return f}function ao(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function lp(s,t,a){return s!==0?Gr(s):(t.isHorizontal()?1:-1)*(t.min>=a?1:-1)}function cp(s){let t,a,r,o,l;return s.horizontal?(t=s.base>s.x,a="left",r="right"):(t=s.base<s.y,a="bottom",r="top"),t?(o="end",l="start"):(o="start",l="end"),{start:a,end:r,reverse:t,top:o,bottom:l}}function dp(s,t,a,r){let o=t.borderSkipped;const l={};if(!o){s.borderSkipped=l;return}if(o===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:f,top:m,bottom:h}=cp(s);o==="middle"&&a&&(s.enableBorderRadius=!0,(a._top||0)===r?o=m:(a._bottom||0)===r?o=h:(l[El(h,c,u,f)]=!0,o=m)),l[El(o,c,u,f)]=!0,s.borderSkipped=l}function El(s,t,a,r){return r?(s=up(s,t,a),s=Fl(s,a,t)):s=Fl(s,t,a),s}function up(s,t,a){return s===t?a:s===a?t:s}function Fl(s,t,a){return s==="start"?t:s==="end"?a:s}function vp(s,{inflateAmount:t},a){s.inflateAmount=t==="auto"?a===1?.33:0:t}class Pn extends No{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,a,r,o){return Tl(t,a,r,o)}parseArrayData(t,a,r,o){return Tl(t,a,r,o)}parseObjectData(t,a,r,o){const{iScale:l,vScale:c}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=l.axis==="x"?u:f,h=c.axis==="x"?u:f,g=[];let b,y,x,A;for(b=r,y=r+o;b<y;++b)A=a[b],x={},x[l.axis]=l.parse(ei(A,m),b),g.push(Xc(ei(A,h),x,c,b));return g}updateRangeFromParsed(t,a,r,o){super.updateRangeFromParsed(t,a,r,o);const l=r._custom;l&&a===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const a=this._cachedMeta,{iScale:r,vScale:o}=a,l=this.getParsed(t),c=l._custom,u=ao(c)?"["+c.start+", "+c.end+"]":""+o.getLabelForValue(l[o.axis]);return{label:""+r.getLabelForValue(l[r.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,t)}updateElements(t,a,r,o){const l=o==="reset",{index:c,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),h=this._getRuler(),{sharedOptions:g,includeOptions:b}=this._getSharedOptions(a,o);for(let y=a;y<a+r;y++){const x=this.getParsed(y),A=l||ds(x[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(y),C=this._calculateBarIndexPixels(y,h),E=(x._stacks||{})[u.axis],F={horizontal:m,base:A.base,enableBorderRadius:!E||ao(x._custom)||c===E._top||c===E._bottom,x:m?A.head:C.center,y:m?C.center:A.head,height:m?C.size:Math.abs(A.size),width:m?Math.abs(A.size):C.size};b&&(F.options=g||this.resolveDataElementOptions(y,t[y].active?"active":o));const S=F.options||t[y].options;dp(F,S,E,c),vp(F,S,h.ratio),this.updateElement(t[y],y,F,o)}}_getStacks(t,a){const{iScale:r}=this._cachedMeta,o=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),l=r.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(a),f=u&&u[r.axis],m=h=>{const g=h._parsed.find(y=>y[r.axis]===f),b=g&&g[h.vScale.axis];if(ds(b)||isNaN(b))return!0};for(const h of o)if(!(a!==void 0&&m(h))&&((l===!1||c.indexOf(h.stack)===-1||l===void 0&&h.stack===void 0)&&c.push(h.stack),h.index===t))break;return c.length||c.push(void 0),c}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(t).filter(r=>t[r].axis===a).shift()}_getAxis(){const t={},a=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)t[Qa(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,a)]=!0;return Object.keys(t)}_getStackIndex(t,a,r){const o=this._getStacks(t,r),l=a!==void 0?o.indexOf(a):-1;return l===-1?o.length-1:l}_getRuler(){const t=this.options,a=this._cachedMeta,r=a.iScale,o=[];let l,c;for(l=0,c=a.data.length;l<c;++l)o.push(r.getPixelForValue(this.getParsed(l)[r.axis],l));const u=t.barThickness;return{min:u||rp(a),pixels:o,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:t.grouped,ratio:u?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:a,_stacked:r,index:o},options:{base:l,minBarLength:c}}=this,u=l||0,f=this.getParsed(t),m=f._custom,h=ao(m);let g=f[a.axis],b=0,y=r?this.applyStack(a,f,r):g,x,A;y!==g&&(b=y-g,y=g),h&&(g=m.barStart,y=m.barEnd-m.barStart,g!==0&&Gr(g)!==Gr(m.barEnd)&&(b=0),b+=g);const C=!ds(l)&&!h?l:b;let E=a.getPixelForValue(C);if(this.chart.getDataVisibility(t)?x=a.getPixelForValue(b+y):x=E,A=x-E,Math.abs(A)<c){A=lp(A,a,u)*c,g===u&&(E-=A/2);const F=a.getPixelForDecimal(0),S=a.getPixelForDecimal(1),q=Math.min(F,S),I=Math.max(F,S);E=Math.max(Math.min(E,I),q),x=E+A,r&&!h&&(f._stacks[a.axis]._visualValues[o]=a.getValueForPixel(x)-a.getValueForPixel(E))}if(E===a.getPixelForValue(u)){const F=Gr(A)*a.getLineWidthForValue(u)/2;E+=F,A-=F}return{size:A,base:E,head:x,center:x+A/2}}_calculateBarIndexPixels(t,a){const r=a.scale,o=this.options,l=o.skipNull,c=Qa(o.maxBarThickness,1/0);let u,f;const m=this._getAxisCount();if(a.grouped){const h=l?this._getStackCount(t):a.stackCount,g=o.barThickness==="flex"?np(t,a,o,h*m):ip(t,a,o,h*m),b=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,y=this._getAxis().indexOf(Qa(b,this.getFirstScaleIdForIndexAxis())),x=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0)+y;u=g.start+g.chunk*x+g.chunk/2,f=Math.min(c,g.chunk*g.ratio)}else u=r.getPixelForValue(this.getParsed(t)[r.axis],t),f=Math.min(c,a.min*a.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const t=this._cachedMeta,a=t.vScale,r=t.data,o=r.length;let l=0;for(;l<o;++l)this.getParsed(l)[a.axis]!==null&&!r[l].hidden&&r[l].draw(this._ctx)}}function fp(s,t,a){let r=1,o=1,l=0,c=0;if(t<Es){const u=s,f=u+t,m=Math.cos(u),h=Math.sin(u),g=Math.cos(f),b=Math.sin(f),y=(S,q,I)=>An(S,u,f,!0)?1:Math.max(q,q*a,I,I*a),x=(S,q,I)=>An(S,u,f,!0)?-1:Math.min(q,q*a,I,I*a),A=y(0,m,g),C=y(Ns,h,b),E=x(cs,m,g),F=x(cs+Ns,h,b);r=(A-E)/2,o=(C-F)/2,l=-(A+E)/2,c=-(C+F)/2}return{ratioX:r,ratioY:o,offsetX:l,offsetY:c}}class pp extends No{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const a=t.data,{labels:{pointStyle:r,textAlign:o,color:l,useBorderRadius:c,borderRadius:u}}=t.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((f,m)=>{const g=t.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:g.backgroundColor,fontColor:l,hidden:!t.getDataVisibility(m),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:o,pointStyle:r,borderRadius:c&&(u||g.borderRadius),index:m}}):[]}},onClick(t,a,r){r.chart.toggleDataVisibility(a.index),r.chart.update()}}}};constructor(t,a){super(t,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,a){const r=this.getDataset().data,o=this._cachedMeta;if(this._parsing===!1)o._parsed=r;else{let l=f=>+r[f];if(Ka(r[t])){const{key:f="value"}=this._parsing;l=m=>+ei(r[m],f)}let c,u;for(c=t,u=t+a;c<u;++c)o._parsed[c]=l(c)}}_getRotation(){return Fr(this.options.rotation-90)}_getCircumference(){return Fr(this.options.circumference)}_getRotationExtents(){let t=Es,a=-Es;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const o=this.chart.getDatasetMeta(r).controller,l=o._getRotation(),c=o._getCircumference();t=Math.min(t,l),a=Math.max(a,l+c)}return{rotation:t,circumference:a-t}}update(t){const a=this.chart,{chartArea:r}=a,o=this._cachedMeta,l=o.data,c=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,u=Math.max((Math.min(r.width,r.height)-c)/2,0),f=Math.min(Ov(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:h,rotation:g}=this._getRotationExtents(),{ratioX:b,ratioY:y,offsetX:x,offsetY:A}=fp(g,h,f),C=(r.width-c)/b,E=(r.height-c)/y,F=Math.max(Math.min(C,E)/2,0),S=$c(this.options.radius,F),q=Math.max(S*f,0),I=(S-q)/this._getVisibleDatasetWeightTotal();this.offsetX=x*S,this.offsetY=A*S,o.total=this.calculateTotal(),this.outerRadius=S-I*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-I*m,0),this.updateElements(l,0,l.length,t)}_circumference(t,a){const r=this.options,o=this._cachedMeta,l=this._getCircumference();return a&&r.animation.animateRotate||!this.chart.getDataVisibility(t)||o._parsed[t]===null||o.data[t].hidden?0:this.calculateCircumference(o._parsed[t]*l/Es)}updateElements(t,a,r,o){const l=o==="reset",c=this.chart,u=c.chartArea,m=c.options.animation,h=(u.left+u.right)/2,g=(u.top+u.bottom)/2,b=l&&m.animateScale,y=b?0:this.innerRadius,x=b?0:this.outerRadius,{sharedOptions:A,includeOptions:C}=this._getSharedOptions(a,o);let E=this._getRotation(),F;for(F=0;F<a;++F)E+=this._circumference(F,l);for(F=a;F<a+r;++F){const S=this._circumference(F,l),q=t[F],I={x:h+this.offsetX,y:g+this.offsetY,startAngle:E,endAngle:E+S,circumference:S,outerRadius:x,innerRadius:y};C&&(I.options=A||this.resolveDataElementOptions(F,q.active?"active":o)),E+=S,this.updateElement(q,F,I,o)}}calculateTotal(){const t=this._cachedMeta,a=t.data;let r=0,o;for(o=0;o<a.length;o++){const l=t._parsed[o];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(o)&&!a[o].hidden&&(r+=Math.abs(l))}return r}calculateCircumference(t){const a=this._cachedMeta.total;return a>0&&!isNaN(t)?Es*(Math.abs(t)/a):0}getLabelAndValue(t){const a=this._cachedMeta,r=this.chart,o=r.data.labels||[],l=So(a._parsed[t],r.options.locale);return{label:o[t]||"",value:l}}getMaxBorderWidth(t){let a=0;const r=this.chart;let o,l,c,u,f;if(!t){for(o=0,l=r.data.datasets.length;o<l;++o)if(r.isDatasetVisible(o)){c=r.getDatasetMeta(o),t=c.data,u=c.controller;break}}if(!t)return 0;for(o=0,l=t.length;o<l;++o)f=u.resolveDataElementOptions(o),f.borderAlign!=="inner"&&(a=Math.max(a,f.borderWidth||0,f.hoverBorderWidth||0));return a}getMaxOffset(t){let a=0;for(let r=0,o=t.length;r<o;++r){const l=this.resolveDataElementOptions(r);a=Math.max(a,l.offset||0,l.hoverOffset||0)}return a}_getRingWeightOffset(t){let a=0;for(let r=0;r<t;++r)this.chart.isDatasetVisible(r)&&(a+=this._getRingWeight(r));return a}_getRingWeight(t){return Math.max(Qa(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}function Qr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Po{static override(t){Object.assign(Po.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Qr()}parse(){return Qr()}format(){return Qr()}add(){return Qr()}diff(){return Qr()}startOf(){return Qr()}endOf(){return Qr()}}var mp={_date:Po};function hp(s,t,a,r){const{controller:o,data:l,_sorted:c}=s,u=o._cachedMeta.iScale,f=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(u&&t===u.axis&&t!=="r"&&c&&l.length){const m=u._reversePixels?Zv:vo;if(r){if(o._sharedOptions){const h=l[0],g=typeof h.getRange=="function"&&h.getRange(t);if(g){const b=m(l,t,a-g),y=m(l,t,a+g);return{lo:b.lo,hi:y.hi}}}}else{const h=m(l,t,a);if(f){const{vScale:g}=o._cachedMeta,{_parsed:b}=s,y=b.slice(0,h.lo+1).reverse().findIndex(A=>!ds(A[g.axis]));h.lo-=Math.max(0,y);const x=b.slice(h.hi).findIndex(A=>!ds(A[g.axis]));h.hi+=Math.max(0,x)}return h}}return{lo:0,hi:l.length-1}}function Ln(s,t,a,r,o){const l=s.getSortedVisibleDatasetMetas(),c=a[t];for(let u=0,f=l.length;u<f;++u){const{index:m,data:h}=l[u],{lo:g,hi:b}=hp(l[u],t,c,o);for(let y=g;y<=b;++y){const x=h[y];x.skip||r(x,m,y)}}}function gp(s){const t=s.indexOf("x")!==-1,a=s.indexOf("y")!==-1;return function(r,o){const l=t?Math.abs(r.x-o.x):0,c=a?Math.abs(r.y-o.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(c,2))}}function so(s,t,a,r,o){const l=[];return!o&&!s.isPointInArea(t)||Ln(s,a,t,function(u,f,m){!o&&!Vc(u,s.chartArea,0)||u.inRange(t.x,t.y,r)&&l.push({element:u,datasetIndex:f,index:m})},!0),l}function _p(s,t,a,r){let o=[];function l(c,u,f){const{startAngle:m,endAngle:h}=c.getProps(["startAngle","endAngle"],r),{angle:g}=Lc(c,{x:t.x,y:t.y});An(g,m,h)&&o.push({element:c,datasetIndex:u,index:f})}return Ln(s,a,t,l),o}function bp(s,t,a,r,o,l){let c=[];const u=gp(a);let f=Number.POSITIVE_INFINITY;function m(h,g,b){const y=h.inRange(t.x,t.y,o);if(r&&!y)return;const x=h.getCenterPoint(o);if(!(!!l||s.isPointInArea(x))&&!y)return;const C=u(t,x);C<f?(c=[{element:h,datasetIndex:g,index:b}],f=C):C===f&&c.push({element:h,datasetIndex:g,index:b})}return Ln(s,a,t,m),c}function ro(s,t,a,r,o,l){return!l&&!s.isPointInArea(t)?[]:a==="r"&&!r?_p(s,t,a,o):bp(s,t,a,r,o,l)}function $l(s,t,a,r,o){const l=[],c=a==="x"?"inXRange":"inYRange";let u=!1;return Ln(s,a,t,(f,m,h)=>{f[c]&&f[c](t[a],o)&&(l.push({element:f,datasetIndex:m,index:h}),u=u||f.inRange(t.x,t.y,o))}),r&&!u?[]:l}var yp={modes:{index(s,t,a,r){const o=Kr(t,s),l=a.axis||"x",c=a.includeInvisible||!1,u=a.intersect?so(s,o,l,r,c):ro(s,o,l,!1,r,c),f=[];return u.length?(s.getSortedVisibleDatasetMetas().forEach(m=>{const h=u[0].index,g=m.data[h];g&&!g.skip&&f.push({element:g,datasetIndex:m.index,index:h})}),f):[]},dataset(s,t,a,r){const o=Kr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;let u=a.intersect?so(s,o,l,r,c):ro(s,o,l,!1,r,c);if(u.length>0){const f=u[0].datasetIndex,m=s.getDatasetMeta(f).data;u=[];for(let h=0;h<m.length;++h)u.push({element:m[h],datasetIndex:f,index:h})}return u},point(s,t,a,r){const o=Kr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return so(s,o,l,r,c)},nearest(s,t,a,r){const o=Kr(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return ro(s,o,l,a.intersect,r,c)},x(s,t,a,r){const o=Kr(t,s);return $l(s,o,"x",a.intersect,r)},y(s,t,a,r){const o=Kr(t,s);return $l(s,o,"y",a.intersect,r)}}};const Zc=["left","top","right","bottom"];function ki(s,t){return s.filter(a=>a.pos===t)}function Nl(s,t){return s.filter(a=>Zc.indexOf(a.pos)===-1&&a.box.axis===t)}function Di(s,t){return s.sort((a,r)=>{const o=t?r:a,l=t?a:r;return o.weight===l.weight?o.index-l.index:o.weight-l.weight})}function wp(s){const t=[];let a,r,o,l,c,u;for(a=0,r=(s||[]).length;a<r;++a)o=s[a],{position:l,options:{stack:c,stackWeight:u=1}}=o,t.push({index:a,box:o,pos:l,horizontal:o.isHorizontal(),weight:o.weight,stack:c&&l+c,stackWeight:u});return t}function xp(s){const t={};for(const a of s){const{stack:r,pos:o,stackWeight:l}=a;if(!r||!Zc.includes(o))continue;const c=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=l}return t}function Sp(s,t){const a=xp(s),{vBoxMaxWidth:r,hBoxMaxHeight:o}=t;let l,c,u;for(l=0,c=s.length;l<c;++l){u=s[l];const{fullSize:f}=u.box,m=a[u.stack],h=m&&u.stackWeight/m.weight;u.horizontal?(u.width=h?h*r:f&&t.availableWidth,u.height=o):(u.width=r,u.height=h?h*o:f&&t.availableHeight)}return a}function kp(s){const t=wp(s),a=Di(t.filter(m=>m.box.fullSize),!0),r=Di(ki(t,"left"),!0),o=Di(ki(t,"right")),l=Di(ki(t,"top"),!0),c=Di(ki(t,"bottom")),u=Nl(t,"x"),f=Nl(t,"y");return{fullSize:a,leftAndTop:r.concat(l),rightAndBottom:o.concat(f).concat(c).concat(u),chartArea:ki(t,"chartArea"),vertical:r.concat(o).concat(f),horizontal:l.concat(c).concat(u)}}function Pl(s,t,a,r){return Math.max(s[a],t[a])+Math.max(s[r],t[r])}function ed(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function Dp(s,t,a,r){const{pos:o,box:l}=a,c=s.maxPadding;if(!Ka(o)){a.size&&(s[o]-=a.size);const g=r[a.stack]||{size:0,count:1};g.size=Math.max(g.size,a.horizontal?l.height:l.width),a.size=g.size/g.count,s[o]+=a.size}l.getPadding&&ed(c,l.getPadding());const u=Math.max(0,t.outerWidth-Pl(c,s,"left","right")),f=Math.max(0,t.outerHeight-Pl(c,s,"top","bottom")),m=u!==s.w,h=f!==s.h;return s.w=u,s.h=f,a.horizontal?{same:m,other:h}:{same:h,other:m}}function Ap(s){const t=s.maxPadding;function a(r){const o=Math.max(t[r]-s[r],0);return s[r]+=o,o}s.y+=a("top"),s.x+=a("left"),a("right"),a("bottom")}function Cp(s,t){const a=t.maxPadding;function r(o){const l={left:0,top:0,right:0,bottom:0};return o.forEach(c=>{l[c]=Math.max(t[c],a[c])}),l}return r(s?["left","right"]:["top","bottom"])}function Pi(s,t,a,r){const o=[];let l,c,u,f,m,h;for(l=0,c=s.length,m=0;l<c;++l){u=s[l],f=u.box,f.update(u.width||t.w,u.height||t.h,Cp(u.horizontal,t));const{same:g,other:b}=Dp(t,a,u,r);m|=g&&o.length,h=h||b,f.fullSize||o.push(u)}return m&&Pi(o,t,a,r)||h}function un(s,t,a,r,o){s.top=a,s.left=t,s.right=t+r,s.bottom=a+o,s.width=r,s.height=o}function Ll(s,t,a,r){const o=a.padding;let{x:l,y:c}=t;for(const u of s){const f=u.box,m=r[u.stack]||{placed:0,weight:1},h=u.stackWeight/m.weight||1;if(u.horizontal){const g=t.w*h,b=m.size||f.height;Vi(m.start)&&(c=m.start),f.fullSize?un(f,o.left,c,a.outerWidth-o.right-o.left,b):un(f,t.left+m.placed,c,g,b),m.start=c,m.placed+=g,c=f.bottom}else{const g=t.h*h,b=m.size||f.width;Vi(m.start)&&(l=m.start),f.fullSize?un(f,l,o.top,b,a.outerHeight-o.bottom-o.top):un(f,l,t.top+m.placed,b,g),m.start=l,m.placed+=g,l=f.right}}t.x=l,t.y=c}var cr={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(a){t.draw(a)}}]},s.boxes.push(t)},removeBox(s,t){const a=s.boxes?s.boxes.indexOf(t):-1;a!==-1&&s.boxes.splice(a,1)},configure(s,t,a){t.fullSize=a.fullSize,t.position=a.position,t.weight=a.weight},update(s,t,a,r){if(!s)return;const o=vr(s.options.layout.padding),l=Math.max(t-o.width,0),c=Math.max(a-o.height,0),u=kp(s.boxes),f=u.vertical,m=u.horizontal;as(s.boxes,A=>{typeof A.beforeLayout=="function"&&A.beforeLayout()});const h=f.reduce((A,C)=>C.box.options&&C.box.options.display===!1?A:A+1,0)||1,g=Object.freeze({outerWidth:t,outerHeight:a,padding:o,availableWidth:l,availableHeight:c,vBoxMaxWidth:l/2/h,hBoxMaxHeight:c/2}),b=Object.assign({},o);ed(b,vr(r));const y=Object.assign({maxPadding:b,w:l,h:c,x:o.left,y:o.top},o),x=Sp(f.concat(m),g);Pi(u.fullSize,y,g,x),Pi(f,y,g,x),Pi(m,y,g,x)&&Pi(f,y,g,x),Ap(y),Ll(u.leftAndTop,y,g,x),y.x+=y.w,y.y+=y.h,Ll(u.rightAndBottom,y,g,x),s.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},as(u.chartArea,A=>{const C=A.box;Object.assign(C,s.chartArea),C.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class td{acquireContext(t,a){}releaseContext(t){return!1}addEventListener(t,a,r){}removeEventListener(t,a,r){}getDevicePixelRatio(){return 1}getMaximumSize(t,a,r,o){return a=Math.max(0,a||t.width),r=r||t.height,{width:a,height:Math.max(0,o?Math.floor(a/o):r)}}isAttached(t){return!0}updateConfig(t){}}class Tp extends td{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const _n="$chartjs",Ep={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ml=s=>s===null||s==="";function Fp(s,t){const a=s.style,r=s.getAttribute("height"),o=s.getAttribute("width");if(s[_n]={initial:{height:r,width:o,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",Ml(o)){const l=wl(s,"width");l!==void 0&&(s.width=l)}if(Ml(r))if(s.style.height==="")s.height=s.width/(t||2);else{const l=wl(s,"height");l!==void 0&&(s.height=l)}return s}const ad=jf?{passive:!0}:!1;function $p(s,t,a){s&&s.addEventListener(t,a,ad)}function Np(s,t,a){s&&s.canvas&&s.canvas.removeEventListener(t,a,ad)}function Pp(s,t){const a=Ep[s.type]||s.type,{x:r,y:o}=Kr(s,t);return{type:a,chart:t,native:s,x:r!==void 0?r:null,y:o!==void 0?o:null}}function En(s,t){for(const a of s)if(a===t||a.contains(t))return!0}function Lp(s,t,a){const r=s.canvas,o=new MutationObserver(l=>{let c=!1;for(const u of l)c=c||En(u.addedNodes,r),c=c&&!En(u.removedNodes,r);c&&a()});return o.observe(document,{childList:!0,subtree:!0}),o}function Mp(s,t,a){const r=s.canvas,o=new MutationObserver(l=>{let c=!1;for(const u of l)c=c||En(u.removedNodes,r),c=c&&!En(u.addedNodes,r);c&&a()});return o.observe(document,{childList:!0,subtree:!0}),o}const zi=new Map;let Il=0;function sd(){const s=window.devicePixelRatio;s!==Il&&(Il=s,zi.forEach((t,a)=>{a.currentDevicePixelRatio!==s&&t()}))}function Ip(s,t){zi.size||window.addEventListener("resize",sd),zi.set(s,t)}function Rp(s){zi.delete(s),zi.size||window.removeEventListener("resize",sd)}function jp(s,t,a){const r=s.canvas,o=r&&$o(r);if(!o)return;const l=jc((u,f)=>{const m=o.clientWidth;a(u,f),m<o.clientWidth&&a()},window),c=new ResizeObserver(u=>{const f=u[0],m=f.contentRect.width,h=f.contentRect.height;m===0&&h===0||l(m,h)});return c.observe(o),Ip(s,l),c}function io(s,t,a){a&&a.disconnect(),t==="resize"&&Rp(s)}function Op(s,t,a){const r=s.canvas,o=jc(l=>{s.ctx!==null&&a(Pp(l,s))},s);return $p(r,t,o),o}class qp extends td{acquireContext(t,a){const r=t&&t.getContext&&t.getContext("2d");return r&&r.canvas===t?(Fp(t,a),r):null}releaseContext(t){const a=t.canvas;if(!a[_n])return!1;const r=a[_n].initial;["height","width"].forEach(l=>{const c=r[l];ds(c)?a.removeAttribute(l):a.setAttribute(l,c)});const o=r.style||{};return Object.keys(o).forEach(l=>{a.style[l]=o[l]}),a.width=a.width,delete a[_n],!0}addEventListener(t,a,r){this.removeEventListener(t,a);const o=t.$proxies||(t.$proxies={}),c={attach:Lp,detach:Mp,resize:jp}[a]||Op;o[a]=c(t,a,r)}removeEventListener(t,a){const r=t.$proxies||(t.$proxies={}),o=r[a];if(!o)return;({attach:io,detach:io,resize:io}[a]||Np)(t,a,o),r[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,a,r,o){return Rf(t,a,r,o)}isAttached(t){const a=t&&$o(t);return!!(a&&a.isConnected)}}function Gp(s){return!Fo()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?Tp:qp}class si{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:a,y:r}=this.getProps(["x","y"],t);return{x:a,y:r}}hasValue(){return Dn(this.x)&&Dn(this.y)}getProps(t,a){const r=this.$animations;if(!a||!r)return this;const o={};return t.forEach(l=>{o[l]=r[l]&&r[l].active()?r[l]._to:this[l]}),o}}function Vp(s,t){const a=s.options.ticks,r=Bp(s),o=Math.min(a.maxTicksLimit||r,r),l=a.major.enabled?Wp(t):[],c=l.length,u=l[0],f=l[c-1],m=[];if(c>o)return Hp(t,m,l,c/o),m;const h=zp(l,t,o);if(c>0){let g,b;const y=c>1?Math.round((f-u)/(c-1)):null;for(vn(t,m,h,ds(y)?0:u-y,u),g=0,b=c-1;g<b;g++)vn(t,m,h,l[g],l[g+1]);return vn(t,m,h,f,ds(y)?t.length:f+y),m}return vn(t,m,h),m}function Bp(s){const t=s.options.offset,a=s._tickSize(),r=s._length/a+(t?0:1),o=s._maxLength/a;return Math.floor(Math.min(r,o))}function zp(s,t,a){const r=Up(s),o=t.length/a;if(!r)return Math.max(o,1);const l=Hv(r);for(let c=0,u=l.length-1;c<u;c++){const f=l[c];if(f>o)return f}return Math.max(o,1)}function Wp(s){const t=[];let a,r;for(a=0,r=s.length;a<r;a++)s[a].major&&t.push(a);return t}function Hp(s,t,a,r){let o=0,l=a[0],c;for(r=Math.ceil(r),c=0;c<s.length;c++)c===l&&(t.push(s[c]),o++,l=a[o*r])}function vn(s,t,a,r,o){const l=Qa(r,0),c=Math.min(Qa(o,s.length),s.length);let u=0,f,m,h;for(a=Math.ceil(a),o&&(f=o-r,a=f/Math.floor(f/a)),h=l;h<0;)u++,h=Math.round(l+u*a);for(m=Math.max(l,0);m<c;m++)m===h&&(t.push(s[m]),u++,h=Math.round(l+u*a))}function Up(s){const t=s.length;let a,r;if(t<2)return!1;for(r=s[0],a=1;a<t;++a)if(s[a]-s[a-1]!==r)return!1;return r}const Yp=s=>s==="left"?"right":s==="right"?"left":s,Rl=(s,t,a)=>t==="top"||t==="left"?s[t]+a:s[t]-a,jl=(s,t)=>Math.min(t||s,s);function Ol(s,t){const a=[],r=s.length/t,o=s.length;let l=0;for(;l<o;l+=r)a.push(s[Math.floor(l)]);return a}function Qp(s,t,a){const r=s.ticks.length,o=Math.min(t,r-1),l=s._startPixel,c=s._endPixel,u=1e-6;let f=s.getPixelForTick(o),m;if(!(a&&(r===1?m=Math.max(f-l,c-f):t===0?m=(s.getPixelForTick(1)-f)/2:m=(f-s.getPixelForTick(o-1))/2,f+=o<t?m:-m,f<l-u||f>c+u)))return f}function Kp(s,t){as(s,a=>{const r=a.gc,o=r.length/2;let l;if(o>t){for(l=0;l<o;++l)delete a.data[r[l]];r.splice(0,o)}})}function Ai(s){return s.drawTicks?s.tickLength:0}function ql(s,t){if(!s.display)return 0;const a=Ys(s.font,t),r=vr(s.padding);return($s(s.text)?s.text.length:1)*a.lineHeight+r.height}function Jp(s,t){return mi(s,{scale:t,type:"scale"})}function Xp(s,t,a){return mi(s,{tick:a,index:t,type:"tick"})}function Zp(s,t,a){let r=xo(s);return(a&&t!=="right"||!a&&t==="right")&&(r=Yp(r)),r}function em(s,t,a,r){const{top:o,left:l,bottom:c,right:u,chart:f}=s,{chartArea:m,scales:h}=f;let g=0,b,y,x;const A=c-o,C=u-l;if(s.isHorizontal()){if(y=Hs(r,l,u),Ka(a)){const E=Object.keys(a)[0],F=a[E];x=h[E].getPixelForValue(F)+A-t}else a==="center"?x=(m.bottom+m.top)/2+A-t:x=Rl(s,a,t);b=u-l}else{if(Ka(a)){const E=Object.keys(a)[0],F=a[E];y=h[E].getPixelForValue(F)-C+t}else a==="center"?y=(m.left+m.right)/2-C+t:y=Rl(s,a,t);x=Hs(r,c,o),g=a==="left"?-Ns:Ns}return{titleX:y,titleY:x,maxWidth:b,rotation:g}}class hi extends si{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,a){return t}getUserBounds(){let{_userMin:t,_userMax:a,_suggestedMin:r,_suggestedMax:o}=this;return t=gr(t,Number.POSITIVE_INFINITY),a=gr(a,Number.NEGATIVE_INFINITY),r=gr(r,Number.POSITIVE_INFINITY),o=gr(o,Number.NEGATIVE_INFINITY),{min:gr(t,r),max:gr(a,o),minDefined:ur(t),maxDefined:ur(a)}}getMinMax(t){let{min:a,max:r,minDefined:o,maxDefined:l}=this.getUserBounds(),c;if(o&&l)return{min:a,max:r};const u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)c=u[f].controller.getMinMax(this,t),o||(a=Math.min(a,c.min)),l||(r=Math.max(r,c.max));return a=l&&a>r?r:a,r=o&&a>r?a:r,{min:gr(a,gr(r,a)),max:gr(r,gr(a,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){hs(this.options.beforeUpdate,[this])}update(t,a,r){const{beginAtZero:o,grace:l,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=a,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=xf(this,l,o),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?Ol(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=Vp(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,a,r;this.isHorizontal()?(a=this.left,r=this.right):(a=this.top,r=this.bottom,t=!t),this._startPixel=a,this._endPixel=r,this._reversePixels=t,this._length=r-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){hs(this.options.afterUpdate,[this])}beforeSetDimensions(){hs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){hs(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),hs(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){hs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const a=this.options.ticks;let r,o,l;for(r=0,o=t.length;r<o;r++)l=t[r],l.label=hs(a.callback,[l.value,r,t],this)}afterTickToLabelConversion(){hs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){hs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,a=t.ticks,r=jl(this.ticks.length,t.ticks.maxTicksLimit),o=a.minRotation||0,l=a.maxRotation;let c=o,u,f,m;if(!this._isVisible()||!a.display||o>=l||r<=1||!this.isHorizontal()){this.labelRotation=o;return}const h=this._getLabelSizes(),g=h.widest.width,b=h.highest.height,y=er(this.chart.width-g,0,this.maxWidth);u=t.offset?this.maxWidth/r:y/(r-1),g+6>u&&(u=y/(r-(t.offset?.5:1)),f=this.maxHeight-Ai(t.grid)-a.padding-ql(t.title,this.chart.options.font),m=Math.sqrt(g*g+b*b),c=Kv(Math.min(Math.asin(er((h.highest.height+6)/u,-1,1)),Math.asin(er(f/m,-1,1))-Math.asin(er(b/m,-1,1)))),c=Math.max(o,Math.min(l,c))),this.labelRotation=c}afterCalculateLabelRotation(){hs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){hs(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:a,options:{ticks:r,title:o,grid:l}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const f=ql(o,a.options.font);if(u?(t.width=this.maxWidth,t.height=Ai(l)+f):(t.height=this.maxHeight,t.width=Ai(l)+f),r.display&&this.ticks.length){const{first:m,last:h,widest:g,highest:b}=this._getLabelSizes(),y=r.padding*2,x=Fr(this.labelRotation),A=Math.cos(x),C=Math.sin(x);if(u){const E=r.mirror?0:C*g.width+A*b.height;t.height=Math.min(this.maxHeight,t.height+E+y)}else{const E=r.mirror?0:A*g.width+C*b.height;t.width=Math.min(this.maxWidth,t.width+E+y)}this._calculatePadding(m,h,C,A)}}this._handleMargins(),u?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,a,r,o){const{ticks:{align:l,padding:c},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let b=0,y=0;f?m?(b=o*t.width,y=r*a.height):(b=r*t.height,y=o*a.width):l==="start"?y=a.width:l==="end"?b=t.width:l!=="inner"&&(b=t.width/2,y=a.width/2),this.paddingLeft=Math.max((b-h+c)*this.width/(this.width-h),0),this.paddingRight=Math.max((y-g+c)*this.width/(this.width-g),0)}else{let h=a.height/2,g=t.height/2;l==="start"?(h=0,g=t.height):l==="end"&&(h=a.height,g=0),this.paddingTop=h+c,this.paddingBottom=g+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){hs(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:a}=this.options;return a==="top"||a==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let a,r;for(a=0,r=t.length;a<r;a++)ds(t[a].label)&&(t.splice(a,1),r--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const a=this.options.ticks.sampleSize;let r=this.ticks;a<r.length&&(r=Ol(r,a)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,a,r){const{ctx:o,_longestTextCache:l}=this,c=[],u=[],f=Math.floor(a/jl(a,r));let m=0,h=0,g,b,y,x,A,C,E,F,S,q,I;for(g=0;g<a;g+=f){if(x=t[g].label,A=this._resolveTickFontOptions(g),o.font=C=A.string,E=l[C]=l[C]||{data:{},gc:[]},F=A.lineHeight,S=q=0,!ds(x)&&!$s(x))S=ml(o,E.data,E.gc,S,x),q=F;else if($s(x))for(b=0,y=x.length;b<y;++b)I=x[b],!ds(I)&&!$s(I)&&(S=ml(o,E.data,E.gc,S,I),q+=F);c.push(S),u.push(q),m=Math.max(S,m),h=Math.max(q,h)}Kp(l,a);const j=c.indexOf(m),M=u.indexOf(h),Z=Q=>({width:c[Q]||0,height:u[Q]||0});return{first:Z(0),last:Z(a-1),widest:Z(j),highest:Z(M),widths:c,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,a){return NaN}getValueForPixel(t){}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const a=this._startPixel+t*this._length;return Xv(this._alignToPixels?Yr(this.chart,a,0):a)}getDecimalForPixel(t){const a=(t-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:a}=this;return t<0&&a<0?a:t>0&&a>0?t:0}getContext(t){const a=this.ticks||[];if(t>=0&&t<a.length){const r=a[t];return r.$context||(r.$context=Xp(this.getContext(),t,r))}return this.$context||(this.$context=Jp(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,a=Fr(this.labelRotation),r=Math.abs(Math.cos(a)),o=Math.abs(Math.sin(a)),l=this._getLabelSizes(),c=t.autoSkipPadding||0,u=l?l.widest.width+c:0,f=l?l.highest.height+c:0;return this.isHorizontal()?f*r>u*o?u/r:f/o:f*o<u*r?f/r:u/o}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const a=this.axis,r=this.chart,o=this.options,{grid:l,position:c,border:u}=o,f=l.offset,m=this.isHorizontal(),g=this.ticks.length+(f?1:0),b=Ai(l),y=[],x=u.setContext(this.getContext()),A=x.display?x.width:0,C=A/2,E=function(K){return Yr(r,K,A)};let F,S,q,I,j,M,Z,Q,W,H,U,X;if(c==="top")F=E(this.bottom),M=this.bottom-b,Q=F-C,H=E(t.top)+C,X=t.bottom;else if(c==="bottom")F=E(this.top),H=t.top,X=E(t.bottom)-C,M=F+C,Q=this.top+b;else if(c==="left")F=E(this.right),j=this.right-b,Z=F-C,W=E(t.left)+C,U=t.right;else if(c==="right")F=E(this.left),W=t.left,U=E(t.right)-C,j=F+C,Z=this.left+b;else if(a==="x"){if(c==="center")F=E((t.top+t.bottom)/2+.5);else if(Ka(c)){const K=Object.keys(c)[0],de=c[K];F=E(this.chart.scales[K].getPixelForValue(de))}H=t.top,X=t.bottom,M=F+C,Q=M+b}else if(a==="y"){if(c==="center")F=E((t.left+t.right)/2);else if(Ka(c)){const K=Object.keys(c)[0],de=c[K];F=E(this.chart.scales[K].getPixelForValue(de))}j=F-C,Z=j-b,W=t.left,U=t.right}const B=Qa(o.ticks.maxTicksLimit,g),oe=Math.max(1,Math.ceil(g/B));for(S=0;S<g;S+=oe){const K=this.getContext(S),de=l.setContext(K),ae=u.setContext(K),te=de.lineWidth,Ce=de.color,Ae=ae.dash||[],Re=ae.dashOffset,Me=de.tickWidth,Ge=de.tickColor,be=de.tickBorderDash||[],ke=de.tickBorderDashOffset;q=Qp(this,S,f),q!==void 0&&(I=Yr(r,q,te),m?j=Z=W=U=I:M=Q=H=X=I,y.push({tx1:j,ty1:M,tx2:Z,ty2:Q,x1:W,y1:H,x2:U,y2:X,width:te,color:Ce,borderDash:Ae,borderDashOffset:Re,tickWidth:Me,tickColor:Ge,tickBorderDash:be,tickBorderDashOffset:ke}))}return this._ticksLength=g,this._borderValue=F,y}_computeLabelItems(t){const a=this.axis,r=this.options,{position:o,ticks:l}=r,c=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:h,mirror:g}=l,b=Ai(r.grid),y=b+h,x=g?-h:y,A=-Fr(this.labelRotation),C=[];let E,F,S,q,I,j,M,Z,Q,W,H,U,X="middle";if(o==="top")j=this.bottom-x,M=this._getXAxisLabelAlignment();else if(o==="bottom")j=this.top+x,M=this._getXAxisLabelAlignment();else if(o==="left"){const oe=this._getYAxisLabelAlignment(b);M=oe.textAlign,I=oe.x}else if(o==="right"){const oe=this._getYAxisLabelAlignment(b);M=oe.textAlign,I=oe.x}else if(a==="x"){if(o==="center")j=(t.top+t.bottom)/2+y;else if(Ka(o)){const oe=Object.keys(o)[0],K=o[oe];j=this.chart.scales[oe].getPixelForValue(K)+y}M=this._getXAxisLabelAlignment()}else if(a==="y"){if(o==="center")I=(t.left+t.right)/2-y;else if(Ka(o)){const oe=Object.keys(o)[0],K=o[oe];I=this.chart.scales[oe].getPixelForValue(K)}M=this._getYAxisLabelAlignment(b).textAlign}a==="y"&&(f==="start"?X="top":f==="end"&&(X="bottom"));const B=this._getLabelSizes();for(E=0,F=u.length;E<F;++E){S=u[E],q=S.label;const oe=l.setContext(this.getContext(E));Z=this.getPixelForTick(E)+l.labelOffset,Q=this._resolveTickFontOptions(E),W=Q.lineHeight,H=$s(q)?q.length:1;const K=H/2,de=oe.color,ae=oe.textStrokeColor,te=oe.textStrokeWidth;let Ce=M;c?(I=Z,M==="inner"&&(E===F-1?Ce=this.options.reverse?"left":"right":E===0?Ce=this.options.reverse?"right":"left":Ce="center"),o==="top"?m==="near"||A!==0?U=-H*W+W/2:m==="center"?U=-B.highest.height/2-K*W+W:U=-B.highest.height+W/2:m==="near"||A!==0?U=W/2:m==="center"?U=B.highest.height/2-K*W:U=B.highest.height-H*W,g&&(U*=-1),A!==0&&!oe.showLabelBackdrop&&(I+=W/2*Math.sin(A))):(j=Z,U=(1-H)*W/2);let Ae;if(oe.showLabelBackdrop){const Re=vr(oe.backdropPadding),Me=B.heights[E],Ge=B.widths[E];let be=U-Re.top,ke=0-Re.left;switch(X){case"middle":be-=Me/2;break;case"bottom":be-=Me;break}switch(M){case"center":ke-=Ge/2;break;case"right":ke-=Ge;break;case"inner":E===F-1?ke-=Ge:E>0&&(ke-=Ge/2);break}Ae={left:ke,top:be,width:Ge+Re.width,height:Me+Re.height,color:oe.backdropColor}}C.push({label:q,font:Q,textOffset:U,options:{rotation:A,color:de,strokeColor:ae,strokeWidth:te,textAlign:Ce,textBaseline:X,translation:[I,j],backdrop:Ae}})}return C}_getXAxisLabelAlignment(){const{position:t,ticks:a}=this.options;if(-Fr(this.labelRotation))return t==="top"?"left":"right";let o="center";return a.align==="start"?o="left":a.align==="end"?o="right":a.align==="inner"&&(o="inner"),o}_getYAxisLabelAlignment(t){const{position:a,ticks:{crossAlign:r,mirror:o,padding:l}}=this.options,c=this._getLabelSizes(),u=t+l,f=c.widest.width;let m,h;return a==="left"?o?(h=this.right+l,r==="near"?m="left":r==="center"?(m="center",h+=f/2):(m="right",h+=f)):(h=this.right-u,r==="near"?m="right":r==="center"?(m="center",h-=f/2):(m="left",h=this.left)):a==="right"?o?(h=this.left+l,r==="near"?m="right":r==="center"?(m="center",h-=f/2):(m="left",h-=f)):(h=this.left+u,r==="near"?m="left":r==="center"?(m="center",h+=f/2):(m="right",h=this.right)):m="right",{textAlign:m,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:a},left:r,top:o,width:l,height:c}=this;a&&(t.save(),t.fillStyle=a,t.fillRect(r,o,l,c),t.restore())}getLineWidthForValue(t){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const o=this.ticks.findIndex(l=>l.value===t);return o>=0?a.setContext(this.getContext(o)).lineWidth:0}drawGrid(t){const a=this.options.grid,r=this.ctx,o=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,c;const u=(f,m,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(f.x,f.y),r.lineTo(m.x,m.y),r.stroke(),r.restore())};if(a.display)for(l=0,c=o.length;l<c;++l){const f=o[l];a.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),a.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:a,options:{border:r,grid:o}}=this,l=r.setContext(this.getContext()),c=r.display?l.width:0;if(!c)return;const u=o.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let m,h,g,b;this.isHorizontal()?(m=Yr(t,this.left,c)-c/2,h=Yr(t,this.right,u)+u/2,g=b=f):(g=Yr(t,this.top,c)-c/2,b=Yr(t,this.bottom,u)+u/2,m=h=f),a.save(),a.lineWidth=l.width,a.strokeStyle=l.color,a.beginPath(),a.moveTo(m,g),a.lineTo(h,b),a.stroke(),a.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,o=this._computeLabelArea();o&&ko(r,o);const l=this.getLabelItems(t);for(const c of l){const u=c.options,f=c.font,m=c.label,h=c.textOffset;Bi(r,m,0,h,f,u)}o&&Do(r)}drawTitle(){const{ctx:t,options:{position:a,title:r,reverse:o}}=this;if(!r.display)return;const l=Ys(r.font),c=vr(r.padding),u=r.align;let f=l.lineHeight/2;a==="bottom"||a==="center"||Ka(a)?(f+=c.bottom,$s(r.text)&&(f+=l.lineHeight*(r.text.length-1))):f+=c.top;const{titleX:m,titleY:h,maxWidth:g,rotation:b}=em(this,f,a,u);Bi(t,r.text,0,0,l,{color:r.color,maxWidth:g,rotation:b,textAlign:Zp(u,a,o),textBaseline:"middle",translation:[m,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,a=t.ticks&&t.ticks.z||0,r=Qa(t.grid&&t.grid.z,-1),o=Qa(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==hi.prototype.draw?[{z:a,draw:l=>{this.draw(l)}}]:[{z:r,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:o,draw:()=>{this.drawBorder()}},{z:a,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const a=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",o=[];let l,c;for(l=0,c=a.length;l<c;++l){const u=a[l];u[r]===this.id&&(!t||u.type===t)&&o.push(u)}return o}_resolveTickFontOptions(t){const a=this.options.ticks.setContext(this.getContext(t));return Ys(a.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class fn{constructor(t,a,r){this.type=t,this.scope=a,this.override=r,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const a=Object.getPrototypeOf(t);let r;sm(a)&&(r=this.register(a));const o=this.items,l=t.id,c=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in o||(o[l]=t,tm(t,c,r),this.override&&As.override(t.id,t.overrides)),c}get(t){return this.items[t]}unregister(t){const a=this.items,r=t.id,o=this.scope;r in a&&delete a[r],o&&r in As[o]&&(delete As[o][r],this.override&&delete ti[r])}}function tm(s,t,a){const r=Gi(Object.create(null),[a?As.get(a):{},As.get(t),s.defaults]);As.set(t,r),s.defaultRoutes&&am(t,s.defaultRoutes),s.descriptors&&As.describe(t,s.descriptors)}function am(s,t){Object.keys(t).forEach(a=>{const r=a.split("."),o=r.pop(),l=[s].concat(r).join("."),c=t[a].split("."),u=c.pop(),f=c.join(".");As.route(l,o,f,u)})}function sm(s){return"id"in s&&"defaults"in s}class rm{constructor(){this.controllers=new fn(No,"datasets",!0),this.elements=new fn(si,"elements"),this.plugins=new fn(Object,"plugins"),this.scales=new fn(hi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,a,r){[...a].forEach(o=>{const l=r||this._getRegistryForType(o);r||l.isForType(o)||l===this.plugins&&o.id?this._exec(t,l,o):as(o,c=>{const u=r||this._getRegistryForType(c);this._exec(t,u,c)})})}_exec(t,a,r){const o=yo(t);hs(r["before"+o],[],r),a[t](r),hs(r["after"+o],[],r)}_getRegistryForType(t){for(let a=0;a<this._typedRegistries.length;a++){const r=this._typedRegistries[a];if(r.isForType(t))return r}return this.plugins}_get(t,a,r){const o=a.get(t);if(o===void 0)throw new Error('"'+t+'" is not a registered '+r+".");return o}}var Sr=new rm;class im{constructor(){this._init=void 0}notify(t,a,r,o){if(a==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const l=o?this._descriptors(t).filter(o):this._descriptors(t),c=this._notify(l,t,a,r);return a==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),c}_notify(t,a,r,o){o=o||{};for(const l of t){const c=l.plugin,u=c[r],f=[a,o,l.options];if(hs(u,f,c)===!1&&o.cancelable)return!1}return!0}invalidate(){ds(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),a}_createDescriptors(t,a){const r=t&&t.config,o=Qa(r.options&&r.options.plugins,{}),l=nm(r);return o===!1&&!a?[]:lm(t,l,o,a)}_notifyStateChanges(t){const a=this._oldCache||[],r=this._cache,o=(l,c)=>l.filter(u=>!c.some(f=>u.plugin.id===f.plugin.id));this._notify(o(a,r),t,"stop"),this._notify(o(r,a),t,"start")}}function nm(s){const t={},a=[],r=Object.keys(Sr.plugins.items);for(let l=0;l<r.length;l++)a.push(Sr.getPlugin(r[l]));const o=s.plugins||[];for(let l=0;l<o.length;l++){const c=o[l];a.indexOf(c)===-1&&(a.push(c),t[c.id]=!0)}return{plugins:a,localIds:t}}function om(s,t){return!t&&s===!1?null:s===!0?{}:s}function lm(s,{plugins:t,localIds:a},r,o){const l=[],c=s.getContext();for(const u of t){const f=u.id,m=om(r[f],o);m!==null&&l.push({plugin:u,options:cm(s.config,{plugin:u,local:a[f]},m,c)})}return l}function cm(s,{plugin:t,local:a},r,o){const l=s.pluginScopeKeys(t),c=s.getOptionScopes(r,l);return a&&t.defaults&&c.push(t.defaults),s.createResolver(c,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function po(s,t){const a=As.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||a.indexAxis||"x"}function dm(s,t){let a=s;return s==="_index_"?a=t:s==="_value_"&&(a=t==="x"?"y":"x"),a}function um(s,t){return s===t?"_index_":"_value_"}function Gl(s){if(s==="x"||s==="y"||s==="r")return s}function vm(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function mo(s,...t){if(Gl(s))return s;for(const a of t){const r=a.axis||vm(a.position)||s.length>1&&Gl(s[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function Vl(s,t,a){if(a[t+"AxisID"]===s)return{axis:t}}function fm(s,t){if(t.data&&t.data.datasets){const a=t.data.datasets.filter(r=>r.xAxisID===s||r.yAxisID===s);if(a.length)return Vl(s,"x",a[0])||Vl(s,"y",a[0])}return{}}function pm(s,t){const a=ti[s.type]||{scales:{}},r=t.scales||{},o=po(s.type,t),l=Object.create(null);return Object.keys(r).forEach(c=>{const u=r[c];if(!Ka(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=mo(c,u,fm(c,s),As.scales[u.type]),m=um(f,o),h=a.scales||{};l[c]=Ii(Object.create(null),[{axis:f},u,h[f],h[m]])}),s.data.datasets.forEach(c=>{const u=c.type||s.type,f=c.indexAxis||po(u,t),h=(ti[u]||{}).scales||{};Object.keys(h).forEach(g=>{const b=dm(g,f),y=c[b+"AxisID"]||b;l[y]=l[y]||Object.create(null),Ii(l[y],[{axis:b},r[y],h[g]])})}),Object.keys(l).forEach(c=>{const u=l[c];Ii(u,[As.scales[u.type],As.scale])}),l}function rd(s){const t=s.options||(s.options={});t.plugins=Qa(t.plugins,{}),t.scales=pm(s,t)}function id(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function mm(s){return s=s||{},s.data=id(s.data),rd(s),s}const Bl=new Map,nd=new Set;function pn(s,t){let a=Bl.get(s);return a||(a=t(),Bl.set(s,a),nd.add(a)),a}const Ci=(s,t,a)=>{const r=ei(t,a);r!==void 0&&s.add(r)};class hm{constructor(t){this._config=mm(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=id(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),rd(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return pn(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,a){return pn(`${t}.transition.${a}`,()=>[[`datasets.${t}.transitions.${a}`,`transitions.${a}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,a){return pn(`${t}-${a}`,()=>[[`datasets.${t}.elements.${a}`,`datasets.${t}`,`elements.${a}`,""]])}pluginScopeKeys(t){const a=t.id,r=this.type;return pn(`${r}-plugin-${a}`,()=>[[`plugins.${a}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,a){const r=this._scopeCache;let o=r.get(t);return(!o||a)&&(o=new Map,r.set(t,o)),o}getOptionScopes(t,a,r){const{options:o,type:l}=this,c=this._cachedScopes(t,r),u=c.get(a);if(u)return u;const f=new Set;a.forEach(h=>{t&&(f.add(t),h.forEach(g=>Ci(f,t,g))),h.forEach(g=>Ci(f,o,g)),h.forEach(g=>Ci(f,ti[l]||{},g)),h.forEach(g=>Ci(f,As,g)),h.forEach(g=>Ci(f,fo,g))});const m=Array.from(f);return m.length===0&&m.push(Object.create(null)),nd.has(a)&&c.set(a,m),m}chartOptionScopes(){const{options:t,type:a}=this;return[t,ti[a]||{},As.datasets[a]||{},{type:a},As,fo]}resolveNamedOptions(t,a,r,o=[""]){const l={$shared:!0},{resolver:c,subPrefixes:u}=zl(this._resolverCache,t,o);let f=c;if(_m(c,a)){l.$shared=!1,r=Br(r)?r():r;const m=this.createResolver(t,r,u);f=pi(c,r,m)}for(const m of a)l[m]=f[m];return l}createResolver(t,a,r=[""],o){const{resolver:l}=zl(this._resolverCache,t,r);return Ka(a)?pi(l,a,void 0,o):l}}function zl(s,t,a){let r=s.get(t);r||(r=new Map,s.set(t,r));const o=a.join();let l=r.get(o);return l||(l={resolver:Co(t,a),subPrefixes:a.filter(u=>!u.toLowerCase().includes("hover"))},r.set(o,l)),l}const gm=s=>Ka(s)&&Object.getOwnPropertyNames(s).some(t=>Br(s[t]));function _m(s,t){const{isScriptable:a,isIndexable:r}=zc(s);for(const o of t){const l=a(o),c=r(o),u=(c||l)&&s[o];if(l&&(Br(u)||gm(u))||c&&$s(u))return!0}return!1}var bm="4.5.1";const ym=["top","bottom","left","right","chartArea"];function Wl(s,t){return s==="top"||s==="bottom"||ym.indexOf(s)===-1&&t==="x"}function Hl(s,t){return function(a,r){return a[s]===r[s]?a[t]-r[t]:a[s]-r[s]}}function Ul(s){const t=s.chart,a=t.options.animation;t.notifyPlugins("afterRender"),hs(a&&a.onComplete,[s],t)}function wm(s){const t=s.chart,a=t.options.animation;hs(a&&a.onProgress,[s],t)}function od(s){return Fo()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const bn={},Yl=s=>{const t=od(s);return Object.values(bn).filter(a=>a.canvas===t).pop()};function xm(s,t,a){const r=Object.keys(s);for(const o of r){const l=+o;if(l>=t){const c=s[o];delete s[o],(a>0||l>t)&&(s[l+a]=c)}}}function Sm(s,t,a,r){return!a||s.type==="mouseout"?null:r?t:s}class dr{static defaults=As;static instances=bn;static overrides=ti;static registry=Sr;static version=bm;static getChart=Yl;static register(...t){Sr.add(...t),Ql()}static unregister(...t){Sr.remove(...t),Ql()}constructor(t,a){const r=this.config=new hm(a),o=od(t),l=Yl(o);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const c=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Gp(o)),this.platform.updateConfig(r);const u=this.platform.acquireContext(o,c.aspectRatio),f=u&&u.canvas,m=f&&f.height,h=f&&f.width;if(this.id=jv(),this.ctx=u,this.canvas=f,this.width=h,this.height=m,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new im,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=af(g=>this.update(g),c.resizeDelay||0),this._dataChanges=[],bn[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}Cr.listen(this,"complete",Ul),Cr.listen(this,"progress",wm),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:a},width:r,height:o,_aspectRatio:l}=this;return ds(t)?a&&l?l:o?r/o:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Sr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():yl(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return hl(this.canvas,this.ctx),this}stop(){return Cr.stop(this),this}resize(t,a){Cr.running(this)?this._resizeBeforeDraw={width:t,height:a}:this._resize(t,a)}_resize(t,a){const r=this.options,o=this.canvas,l=r.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(o,t,a,l),u=r.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,yl(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),hs(r.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};as(a,(r,o)=>{r.id=o})}buildOrUpdateScales(){const t=this.options,a=t.scales,r=this.scales,o=Object.keys(r).reduce((c,u)=>(c[u]=!1,c),{});let l=[];a&&(l=l.concat(Object.keys(a).map(c=>{const u=a[c],f=mo(c,u),m=f==="r",h=f==="x";return{options:u,dposition:m?"chartArea":h?"bottom":"left",dtype:m?"radialLinear":h?"category":"linear"}}))),as(l,c=>{const u=c.options,f=u.id,m=mo(f,u),h=Qa(u.type,c.dtype);(u.position===void 0||Wl(u.position,m)!==Wl(c.dposition))&&(u.position=c.dposition),o[f]=!0;let g=null;if(f in r&&r[f].type===h)g=r[f];else{const b=Sr.getScale(h);g=new b({id:f,type:h,ctx:this.ctx,chart:this}),r[g.id]=g}g.init(u,t)}),as(o,(c,u)=>{c||delete r[u]}),as(r,c=>{cr.configure(this,c,c.options),cr.addBox(this,c)})}_updateMetasets(){const t=this._metasets,a=this.data.datasets.length,r=t.length;if(t.sort((o,l)=>o.index-l.index),r>a){for(let o=a;o<r;++o)this._destroyDatasetMeta(o);t.splice(a,r-a)}this._sortedMetasets=t.slice(0).sort(Hl("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:a}}=this;t.length>a.length&&delete this._stacks,t.forEach((r,o)=>{a.filter(l=>l===r._dataset).length===0&&this._destroyDatasetMeta(o)})}buildOrUpdateControllers(){const t=[],a=this.data.datasets;let r,o;for(this._removeUnreferencedMetasets(),r=0,o=a.length;r<o;r++){const l=a[r];let c=this.getDatasetMeta(r);const u=l.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(r),c=this.getDatasetMeta(r)),c.type=u,c.indexAxis=l.indexAxis||po(u,this.options),c.order=l.order||0,c.index=r,c.label=""+l.label,c.visible=this.isDatasetVisible(r),c.controller)c.controller.updateIndex(r),c.controller.linkScales();else{const f=Sr.getController(u),{datasetElementType:m,dataElementType:h}=As.datasets[u];Object.assign(f,{dataElementType:Sr.getElement(h),datasetElementType:m&&Sr.getElement(m)}),c.controller=new f(this,r),t.push(c.controller)}}return this._updateMetasets(),t}_resetElements(){as(this.data.datasets,(t,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const a=this.config;a.update();const r=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),o=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let m=0,h=this.data.datasets.length;m<h;m++){const{controller:g}=this.getDatasetMeta(m),b=!o&&l.indexOf(g)===-1;g.buildOrUpdateElements(b),c=Math.max(+g.getMaxOverflow(),c)}c=this._minPadding=r.layout.autoPadding?c:0,this._updateLayout(c),o||as(l,m=>{m.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Hl("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){as(this.scales,t=>{cr.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,a=new Set(Object.keys(this._listeners)),r=new Set(t.events);(!nl(a,r)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,a=this._getUniformDataChanges()||[];for(const{method:r,start:o,count:l}of a){const c=r==="_removeElements"?-l:l;xm(t,o,c)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const a=this.data.datasets.length,r=l=>new Set(t.filter(c=>c[0]===l).map((c,u)=>u+","+c.splice(1).join(","))),o=r(0);for(let l=1;l<a;l++)if(!nl(o,r(l)))return;return Array.from(o).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;cr.update(this,this.width,this.height,t);const a=this.chartArea,r=a.width<=0||a.height<=0;this._layers=[],as(this.boxes,o=>{r&&o.position==="chartArea"||(o.configure&&o.configure(),this._layers.push(...o._layers()))},this),this._layers.forEach((o,l)=>{o._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let a=0,r=this.data.datasets.length;a<r;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,r=this.data.datasets.length;a<r;++a)this._updateDataset(a,Br(t)?t({datasetIndex:a}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,a){const r=this.getDatasetMeta(t),o={meta:r,index:t,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",o)!==!1&&(r.controller._update(a),o.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",o))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Cr.has(this)?this.attached&&!Cr.running(this)&&Cr.start(this):(this.draw(),Ul({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:r,height:o}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,o)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(t=0;t<a.length&&a[t].z<=0;++t)a[t].draw(this.chartArea);for(this._drawDatasets();t<a.length;++t)a[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const a=this._sortedMetasets,r=[];let o,l;for(o=0,l=a.length;o<l;++o){const c=a[o];(!t||c.visible)&&r.push(c)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let a=t.length-1;a>=0;--a)this._drawDataset(t[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const a=this.ctx,r={meta:t,index:t.index,cancelable:!0},o=Vf(this,t);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(o&&ko(a,o),t.controller.draw(),o&&Do(a),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return Vc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,a,r,o){const l=yp.modes[a];return typeof l=="function"?l(this,t,r,o):[]}getDatasetMeta(t){const a=this.data.datasets[t],r=this._metasets;let o=r.filter(l=>l&&l._dataset===a).pop();return o||(o={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:t,_dataset:a,_parsed:[],_sorted:!1},r.push(o)),o}getContext(){return this.$context||(this.$context=mi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const a=this.data.datasets[t];if(!a)return!1;const r=this.getDatasetMeta(t);return typeof r.hidden=="boolean"?!r.hidden:!a.hidden}setDatasetVisibility(t,a){const r=this.getDatasetMeta(t);r.hidden=!a}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,a,r){const o=r?"show":"hide",l=this.getDatasetMeta(t),c=l.controller._resolveAnimations(void 0,o);Vi(a)?(l.data[a].hidden=!r,this.update()):(this.setDatasetVisibility(t,r),c.update(l,{visible:r}),this.update(u=>u.datasetIndex===t?o:void 0))}hide(t,a){this._updateVisibility(t,a,!1)}show(t,a){this._updateVisibility(t,a,!0)}_destroyDatasetMeta(t){const a=this._metasets[t];a&&a.controller&&a.controller._destroy(),delete this._metasets[t]}_stop(){let t,a;for(this.stop(),Cr.remove(this),t=0,a=this.data.datasets.length;t<a;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:a}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),hl(t,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete bn[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,a=this.platform,r=(l,c)=>{a.addEventListener(this,l,c),t[l]=c},o=(l,c,u)=>{l.offsetX=c,l.offsetY=u,this._eventHandler(l)};as(this.options.events,l=>r(l,o))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,a=this.platform,r=(f,m)=>{a.addEventListener(this,f,m),t[f]=m},o=(f,m)=>{t[f]&&(a.removeEventListener(this,f,m),delete t[f])},l=(f,m)=>{this.canvas&&this.resize(f,m)};let c;const u=()=>{o("attach",u),this.attached=!0,this.resize(),r("resize",l),r("detach",c)};c=()=>{this.attached=!1,o("resize",l),this._stop(),this._resize(0,0),r("attach",u)},a.isAttached(this.canvas)?u():c()}unbindEvents(){as(this._listeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._listeners={},as(this._responsiveListeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,a,r){const o=r?"set":"remove";let l,c,u,f;for(a==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+o+"DatasetHoverStyle"]()),u=0,f=t.length;u<f;++u){c=t[u];const m=c&&this.getDatasetMeta(c.datasetIndex).controller;m&&m[o+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const a=this._active||[],r=t.map(({datasetIndex:l,index:c})=>{const u=this.getDatasetMeta(l);if(!u)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:u.data[c],index:c}});!xn(r,a)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,a))}notifyPlugins(t,a,r){return this._plugins.notify(this,t,a,r)}isPluginEnabled(t){return this._plugins._cache.filter(a=>a.plugin.id===t).length===1}_updateHoverStyles(t,a,r){const o=this.options.hover,l=(f,m)=>f.filter(h=>!m.some(g=>h.datasetIndex===g.datasetIndex&&h.index===g.index)),c=l(a,t),u=r?t:l(t,a);c.length&&this.updateHoverStyle(c,o.mode,!1),u.length&&o.mode&&this.updateHoverStyle(u,o.mode,!0)}_eventHandler(t,a){const r={event:t,replay:a,cancelable:!0,inChartArea:this.isPointInArea(t)},o=c=>(c.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",r,o)===!1)return;const l=this._handleEvent(t,a,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,o),(l||r.changed)&&this.render(),this}_handleEvent(t,a,r){const{_active:o=[],options:l}=this,c=a,u=this._getActiveElements(t,o,r,c),f=zv(t),m=Sm(t,this._lastEvent,r,f);r&&(this._lastEvent=null,hs(l.onHover,[t,u,this],this),f&&hs(l.onClick,[t,u,this],this));const h=!xn(u,o);return(h||a)&&(this._active=u,this._updateHoverStyles(u,o,a)),this._lastEvent=m,h}_getActiveElements(t,a,r,o){if(t.type==="mouseout")return[];if(!r)return a;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,o)}}function Ql(){return as(dr.instances,s=>s._plugins.invalidate())}function km(s,t,a){const{startAngle:r,x:o,y:l,outerRadius:c,innerRadius:u,options:f}=t,{borderWidth:m,borderJoinStyle:h}=f,g=Math.min(m/c,kr(r-a));if(s.beginPath(),s.arc(o,l,c-m/2,r+g/2,a-g/2),u>0){const b=Math.min(m/u,kr(r-a));s.arc(o,l,u+m/2,a-b/2,r+b/2,!0)}else{const b=Math.min(m/2,c*kr(r-a));if(h==="round")s.arc(o,l,b,a-cs/2,r+cs/2,!0);else if(h==="bevel"){const y=2*b*b,x=-y*Math.cos(a+cs/2)+o,A=-y*Math.sin(a+cs/2)+l,C=y*Math.cos(r+cs/2)+o,E=y*Math.sin(r+cs/2)+l;s.lineTo(x,A),s.lineTo(C,E)}}s.closePath(),s.moveTo(0,0),s.rect(0,0,s.canvas.width,s.canvas.height),s.clip("evenodd")}function Dm(s,t,a){const{startAngle:r,pixelMargin:o,x:l,y:c,outerRadius:u,innerRadius:f}=t;let m=o/u;s.beginPath(),s.arc(l,c,u,r-m,a+m),f>o?(m=o/f,s.arc(l,c,f,a+m,r-m,!0)):s.arc(l,c,o,a+Ns,r-Ns),s.closePath(),s.clip()}function Am(s){return Ao(s,["outerStart","outerEnd","innerStart","innerEnd"])}function Cm(s,t,a,r){const o=Am(s.options.borderRadius),l=(a-t)/2,c=Math.min(l,r*t/2),u=f=>{const m=(a-Math.min(l,f))*r/2;return er(f,0,Math.min(l,m))};return{outerStart:u(o.outerStart),outerEnd:u(o.outerEnd),innerStart:er(o.innerStart,0,c),innerEnd:er(o.innerEnd,0,c)}}function ci(s,t,a,r){return{x:a+s*Math.cos(t),y:r+s*Math.sin(t)}}function Fn(s,t,a,r,o,l){const{x:c,y:u,startAngle:f,pixelMargin:m,innerRadius:h}=t,g=Math.max(t.outerRadius+r+a-m,0),b=h>0?h+r+a+m:0;let y=0;const x=o-f;if(r){const oe=h>0?h-r:0,K=g>0?g-r:0,de=(oe+K)/2,ae=de!==0?x*de/(de+r):x;y=(x-ae)/2}const A=Math.max(.001,x*g-a/cs)/g,C=(x-A)/2,E=f+C+y,F=o-C-y,{outerStart:S,outerEnd:q,innerStart:I,innerEnd:j}=Cm(t,b,g,F-E),M=g-S,Z=g-q,Q=E+S/M,W=F-q/Z,H=b+I,U=b+j,X=E+I/H,B=F-j/U;if(s.beginPath(),l){const oe=(Q+W)/2;if(s.arc(c,u,g,Q,oe),s.arc(c,u,g,oe,W),q>0){const te=ci(Z,W,c,u);s.arc(te.x,te.y,q,W,F+Ns)}const K=ci(U,F,c,u);if(s.lineTo(K.x,K.y),j>0){const te=ci(U,B,c,u);s.arc(te.x,te.y,j,F+Ns,B+Math.PI)}const de=(F-j/b+(E+I/b))/2;if(s.arc(c,u,b,F-j/b,de,!0),s.arc(c,u,b,de,E+I/b,!0),I>0){const te=ci(H,X,c,u);s.arc(te.x,te.y,I,X+Math.PI,E-Ns)}const ae=ci(M,E,c,u);if(s.lineTo(ae.x,ae.y),S>0){const te=ci(M,Q,c,u);s.arc(te.x,te.y,S,E-Ns,Q)}}else{s.moveTo(c,u);const oe=Math.cos(Q)*g+c,K=Math.sin(Q)*g+u;s.lineTo(oe,K);const de=Math.cos(W)*g+c,ae=Math.sin(W)*g+u;s.lineTo(de,ae)}s.closePath()}function Tm(s,t,a,r,o){const{fullCircles:l,startAngle:c,circumference:u}=t;let f=t.endAngle;if(l){Fn(s,t,a,r,f,o);for(let m=0;m<l;++m)s.fill();isNaN(u)||(f=c+(u%Es||Es))}return Fn(s,t,a,r,f,o),s.fill(),f}function Em(s,t,a,r,o){const{fullCircles:l,startAngle:c,circumference:u,options:f}=t,{borderWidth:m,borderJoinStyle:h,borderDash:g,borderDashOffset:b,borderRadius:y}=f,x=f.borderAlign==="inner";if(!m)return;s.setLineDash(g||[]),s.lineDashOffset=b,x?(s.lineWidth=m*2,s.lineJoin=h||"round"):(s.lineWidth=m,s.lineJoin=h||"bevel");let A=t.endAngle;if(l){Fn(s,t,a,r,A,o);for(let C=0;C<l;++C)s.stroke();isNaN(u)||(A=c+(u%Es||Es))}x&&Dm(s,t,A),f.selfJoin&&A-c>=cs&&y===0&&h!=="miter"&&km(s,t,A),l||(Fn(s,t,a,r,A,o),s.stroke())}class Fm extends si{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,a,r){const o=this.getProps(["x","y"],r),{angle:l,distance:c}=Lc(o,{x:t,y:a}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:h,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),b=(this.options.spacing+this.options.borderWidth)/2,y=Qa(g,f-u),x=An(l,u,f)&&u!==f,A=y>=Es||x,C=Xr(c,m+b,h+b);return A&&C}getCenterPoint(t){const{x:a,y:r,startAngle:o,endAngle:l,innerRadius:c,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,h=(o+l)/2,g=(c+u+m+f)/2;return{x:a+Math.cos(h)*g,y:r+Math.sin(h)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:a,circumference:r}=this,o=(a.offset||0)/4,l=(a.spacing||0)/2,c=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=r>Es?Math.floor(r/Es):0,r===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const u=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(u)*o,Math.sin(u)*o);const f=1-Math.sin(Math.min(cs,r||0)),m=o*f;t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,Tm(t,this,m,l,c),Em(t,this,m,l,c),t.restore()}}function ld(s,t){const{x:a,y:r,base:o,width:l,height:c}=s.getProps(["x","y","base","width","height"],t);let u,f,m,h,g;return s.horizontal?(g=c/2,u=Math.min(a,o),f=Math.max(a,o),m=r-g,h=r+g):(g=l/2,u=a-g,f=a+g,m=Math.min(r,o),h=Math.max(r,o)),{left:u,top:m,right:f,bottom:h}}function Or(s,t,a,r){return s?0:er(t,a,r)}function $m(s,t,a){const r=s.options.borderWidth,o=s.borderSkipped,l=Bc(r);return{t:Or(o.top,l.top,0,a),r:Or(o.right,l.right,0,t),b:Or(o.bottom,l.bottom,0,a),l:Or(o.left,l.left,0,t)}}function Nm(s,t,a){const{enableBorderRadius:r}=s.getProps(["enableBorderRadius"]),o=s.options.borderRadius,l=vi(o),c=Math.min(t,a),u=s.borderSkipped,f=r||Ka(o);return{topLeft:Or(!f||u.top||u.left,l.topLeft,0,c),topRight:Or(!f||u.top||u.right,l.topRight,0,c),bottomLeft:Or(!f||u.bottom||u.left,l.bottomLeft,0,c),bottomRight:Or(!f||u.bottom||u.right,l.bottomRight,0,c)}}function Pm(s){const t=ld(s),a=t.right-t.left,r=t.bottom-t.top,o=$m(s,a/2,r/2),l=Nm(s,a/2,r/2);return{outer:{x:t.left,y:t.top,w:a,h:r,radius:l},inner:{x:t.left+o.l,y:t.top+o.t,w:a-o.l-o.r,h:r-o.t-o.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,l.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(o.b,o.r))}}}}function no(s,t,a,r){const o=t===null,l=a===null,u=s&&!(o&&l)&&ld(s,r);return u&&(o||Xr(t,u.left,u.right))&&(l||Xr(a,u.top,u.bottom))}function Lm(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function Mm(s,t){s.rect(t.x,t.y,t.w,t.h)}function oo(s,t,a={}){const r=s.x!==a.x?-t:0,o=s.y!==a.y?-t:0,l=(s.x+s.w!==a.x+a.w?t:0)-r,c=(s.y+s.h!==a.y+a.h?t:0)-o;return{x:s.x+r,y:s.y+o,w:s.w+l,h:s.h+c,radius:s.radius}}class Mn extends si{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:a,options:{borderColor:r,backgroundColor:o}}=this,{inner:l,outer:c}=Pm(this),u=Lm(c.radius)?Cn:Mm;t.save(),(c.w!==l.w||c.h!==l.h)&&(t.beginPath(),u(t,oo(c,a,l)),t.clip(),u(t,oo(l,-a,c)),t.fillStyle=r,t.fill("evenodd")),t.beginPath(),u(t,oo(l,a)),t.fillStyle=o,t.fill(),t.restore()}inRange(t,a,r){return no(this,t,a,r)}inXRange(t,a){return no(this,t,null,a)}inYRange(t,a){return no(this,null,t,a)}getCenterPoint(t){const{x:a,y:r,base:o,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(a+o)/2:a,y:l?r:(r+o)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}const Kl=(s,t)=>{let{boxHeight:a=t,boxWidth:r=t}=s;return s.usePointStyle&&(a=Math.min(a,t),r=s.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:a,itemHeight:Math.max(t,a)}},Im=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class Jl extends si{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a,r){this.maxWidth=t,this.maxHeight=a,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let a=hs(t.generateLabels,[this.chart],this)||[];t.filter&&(a=a.filter(r=>t.filter(r,this.chart.data))),t.sort&&(a=a.sort((r,o)=>t.sort(r,o,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:t,ctx:a}=this;if(!t.display){this.width=this.height=0;return}const r=t.labels,o=Ys(r.font),l=o.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Kl(r,l);let m,h;a.font=o.string,this.isHorizontal()?(m=this.maxWidth,h=this._fitRows(c,l,u,f)+10):(h=this.maxHeight,m=this._fitCols(c,o,u,f)+10),this.width=Math.min(m,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,a,r,o){const{ctx:l,maxWidth:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],h=o+u;let g=t;l.textAlign="left",l.textBaseline="middle";let b=-1,y=-h;return this.legendItems.forEach((x,A)=>{const C=r+a/2+l.measureText(x.text).width;(A===0||m[m.length-1]+C+2*u>c)&&(g+=h,m[m.length-(A>0?0:1)]=0,y+=h,b++),f[A]={left:0,top:y,row:b,width:C,height:o},m[m.length-1]+=C+u}),g}_fitCols(t,a,r,o){const{ctx:l,maxHeight:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],h=c-t;let g=u,b=0,y=0,x=0,A=0;return this.legendItems.forEach((C,E)=>{const{itemWidth:F,itemHeight:S}=Rm(r,a,l,C,o);E>0&&y+S+2*u>h&&(g+=b+u,m.push({width:b,height:y}),x+=b+u,A++,b=y=0),f[E]={left:x,top:y,col:A,width:F,height:S},b=Math.max(b,F),y+=S+u}),g+=b,m.push({width:b,height:y}),g}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:r,labels:{padding:o},rtl:l}}=this,c=fi(l,this.left,this.width);if(this.isHorizontal()){let u=0,f=Hs(r,this.left+o,this.right-this.lineWidths[u]);for(const m of a)u!==m.row&&(u=m.row,f=Hs(r,this.left+o,this.right-this.lineWidths[u])),m.top+=this.top+t+o,m.left=c.leftForLtr(c.x(f),m.width),f+=m.width+o}else{let u=0,f=Hs(r,this.top+t+o,this.bottom-this.columnSizes[u].height);for(const m of a)m.col!==u&&(u=m.col,f=Hs(r,this.top+t+o,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+o,m.left=c.leftForLtr(c.x(m.left),m.width),f+=m.height+o}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;ko(t,this),this._draw(),Do(t)}}_draw(){const{options:t,columnSizes:a,lineWidths:r,ctx:o}=this,{align:l,labels:c}=t,u=As.color,f=fi(t.rtl,this.left,this.width),m=Ys(c.font),{padding:h}=c,g=m.size,b=g/2;let y;this.drawTitle(),o.textAlign=f.textAlign("left"),o.textBaseline="middle",o.lineWidth=.5,o.font=m.string;const{boxWidth:x,boxHeight:A,itemHeight:C}=Kl(c,g),E=function(j,M,Z){if(isNaN(x)||x<=0||isNaN(A)||A<0)return;o.save();const Q=Qa(Z.lineWidth,1);if(o.fillStyle=Qa(Z.fillStyle,u),o.lineCap=Qa(Z.lineCap,"butt"),o.lineDashOffset=Qa(Z.lineDashOffset,0),o.lineJoin=Qa(Z.lineJoin,"miter"),o.lineWidth=Q,o.strokeStyle=Qa(Z.strokeStyle,u),o.setLineDash(Qa(Z.lineDash,[])),c.usePointStyle){const W={radius:A*Math.SQRT2/2,pointStyle:Z.pointStyle,rotation:Z.rotation,borderWidth:Q},H=f.xPlus(j,x/2),U=M+b;Gc(o,W,H,U,c.pointStyleWidth&&x)}else{const W=M+Math.max((g-A)/2,0),H=f.leftForLtr(j,x),U=vi(Z.borderRadius);o.beginPath(),Object.values(U).some(X=>X!==0)?Cn(o,{x:H,y:W,w:x,h:A,radius:U}):o.rect(H,W,x,A),o.fill(),Q!==0&&o.stroke()}o.restore()},F=function(j,M,Z){Bi(o,Z.text,j,M+C/2,m,{strikethrough:Z.hidden,textAlign:f.textAlign(Z.textAlign)})},S=this.isHorizontal(),q=this._computeTitleHeight();S?y={x:Hs(l,this.left+h,this.right-r[0]),y:this.top+h+q,line:0}:y={x:this.left+h,y:Hs(l,this.top+q+h,this.bottom-a[0].height),line:0},Yc(this.ctx,t.textDirection);const I=C+h;this.legendItems.forEach((j,M)=>{o.strokeStyle=j.fontColor,o.fillStyle=j.fontColor;const Z=o.measureText(j.text).width,Q=f.textAlign(j.textAlign||(j.textAlign=c.textAlign)),W=x+b+Z;let H=y.x,U=y.y;f.setWidth(this.width),S?M>0&&H+W+h>this.right&&(U=y.y+=I,y.line++,H=y.x=Hs(l,this.left+h,this.right-r[y.line])):M>0&&U+I>this.bottom&&(H=y.x=H+a[y.line].width+h,y.line++,U=y.y=Hs(l,this.top+q+h,this.bottom-a[y.line].height));const X=f.x(H);if(E(X,U,j),H=sf(Q,H+x+b,S?H+W:this.right,t.rtl),F(f.x(H),U,j),S)y.x+=W+h;else if(typeof j.text!="string"){const B=m.lineHeight;y.y+=cd(j,B)+h}else y.y+=I}),Qc(this.ctx,t.textDirection)}drawTitle(){const t=this.options,a=t.title,r=Ys(a.font),o=vr(a.padding);if(!a.display)return;const l=fi(t.rtl,this.left,this.width),c=this.ctx,u=a.position,f=r.size/2,m=o.top+f;let h,g=this.left,b=this.width;if(this.isHorizontal())b=Math.max(...this.lineWidths),h=this.top+m,g=Hs(t.align,g,this.right-b);else{const x=this.columnSizes.reduce((A,C)=>Math.max(A,C.height),0);h=m+Hs(t.align,this.top,this.bottom-x-t.labels.padding-this._computeTitleHeight())}const y=Hs(u,g,g+b);c.textAlign=l.textAlign(xo(u)),c.textBaseline="middle",c.strokeStyle=a.color,c.fillStyle=a.color,c.font=r.string,Bi(c,a.text,y,h,r)}_computeTitleHeight(){const t=this.options.title,a=Ys(t.font),r=vr(t.padding);return t.display?a.lineHeight+r.height:0}_getLegendItemAt(t,a){let r,o,l;if(Xr(t,this.left,this.right)&&Xr(a,this.top,this.bottom)){for(l=this.legendHitBoxes,r=0;r<l.length;++r)if(o=l[r],Xr(t,o.left,o.left+o.width)&&Xr(a,o.top,o.top+o.height))return this.legendItems[r]}return null}handleEvent(t){const a=this.options;if(!qm(t.type,a))return;const r=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const o=this._hoveredItem,l=Im(o,r);o&&!l&&hs(a.onLeave,[t,o,this],this),this._hoveredItem=r,r&&!l&&hs(a.onHover,[t,r,this],this)}else r&&hs(a.onClick,[t,r,this],this)}}function Rm(s,t,a,r,o){const l=jm(r,s,t,a),c=Om(o,r,t.lineHeight);return{itemWidth:l,itemHeight:c}}function jm(s,t,a,r){let o=s.text;return o&&typeof o!="string"&&(o=o.reduce((l,c)=>l.length>c.length?l:c)),t+a.size/2+r.measureText(o).width}function Om(s,t,a){let r=s;return typeof t.text!="string"&&(r=cd(t,a)),r}function cd(s,t){const a=s.text?s.text.length:0;return t*a}function qm(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var Hi={id:"legend",_element:Jl,start(s,t,a){const r=s.legend=new Jl({ctx:s.ctx,options:a,chart:s});cr.configure(s,r,a),cr.addBox(s,r)},stop(s){cr.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,a){const r=s.legend;cr.configure(s,r,a),r.options=a},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,a){const r=t.datasetIndex,o=a.chart;o.isDatasetVisible(r)?(o.hide(r),t.hidden=!0):(o.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:a,pointStyle:r,textAlign:o,color:l,useBorderRadius:c,borderRadius:u}}=s.legend.options;return s._getSortedDatasetMetas().map(f=>{const m=f.controller.getStyle(a?0:void 0),h=vr(m.borderWidth);return{text:t[f.index].label,fillStyle:m.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:m.borderColor,pointStyle:r||m.pointStyle,rotation:m.rotation,textAlign:o||m.textAlign,borderRadius:c&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class dd extends si{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=a;const o=$s(r.text)?r.text.length:1;this._padding=vr(r.padding);const l=o*Ys(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:a,left:r,bottom:o,right:l,options:c}=this,u=c.align;let f=0,m,h,g;return this.isHorizontal()?(h=Hs(u,r,l),g=a+t,m=l-r):(c.position==="left"?(h=r+t,g=Hs(u,o,a),f=cs*-.5):(h=l-t,g=Hs(u,a,o),f=cs*.5),m=o-a),{titleX:h,titleY:g,maxWidth:m,rotation:f}}draw(){const t=this.ctx,a=this.options;if(!a.display)return;const r=Ys(a.font),l=r.lineHeight/2+this._padding.top,{titleX:c,titleY:u,maxWidth:f,rotation:m}=this._drawArgs(l);Bi(t,a.text,0,0,r,{color:a.color,maxWidth:f,rotation:m,textAlign:xo(a.align),textBaseline:"middle",translation:[c,u]})}}function Gm(s,t){const a=new dd({ctx:s.ctx,options:t,chart:s});cr.configure(s,a,t),cr.addBox(s,a),s.titleBlock=a}var Ui={id:"title",_element:dd,start(s,t,a){Gm(s,a)},stop(s){const t=s.titleBlock;cr.removeBox(s,t),delete s.titleBlock},beforeUpdate(s,t,a){const r=s.titleBlock;cr.configure(s,r,a),r.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Li={average(s){if(!s.length)return!1;let t,a,r=new Set,o=0,l=0;for(t=0,a=s.length;t<a;++t){const u=s[t].element;if(u&&u.hasValue()){const f=u.tooltipPosition();r.add(f.x),o+=f.y,++l}}return l===0||r.size===0?!1:{x:[...r].reduce((u,f)=>u+f)/r.size,y:o/l}},nearest(s,t){if(!s.length)return!1;let a=t.x,r=t.y,o=Number.POSITIVE_INFINITY,l,c,u;for(l=0,c=s.length;l<c;++l){const f=s[l].element;if(f&&f.hasValue()){const m=f.getCenterPoint(),h=Jv(t,m);h<o&&(o=h,u=f)}}if(u){const f=u.tooltipPosition();a=f.x,r=f.y}return{x:a,y:r}}};function wr(s,t){return t&&($s(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function Tr(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function Vm(s,t){const{element:a,datasetIndex:r,index:o}=t,l=s.getDatasetMeta(r).controller,{label:c,value:u}=l.getLabelAndValue(o);return{chart:s,label:c,parsed:l.getParsed(o),raw:s.data.datasets[r].data[o],formattedValue:u,dataset:l.getDataset(),dataIndex:o,datasetIndex:r,element:a}}function Xl(s,t){const a=s.chart.ctx,{body:r,footer:o,title:l}=s,{boxWidth:c,boxHeight:u}=t,f=Ys(t.bodyFont),m=Ys(t.titleFont),h=Ys(t.footerFont),g=l.length,b=o.length,y=r.length,x=vr(t.padding);let A=x.height,C=0,E=r.reduce((q,I)=>q+I.before.length+I.lines.length+I.after.length,0);if(E+=s.beforeBody.length+s.afterBody.length,g&&(A+=g*m.lineHeight+(g-1)*t.titleSpacing+t.titleMarginBottom),E){const q=t.displayColors?Math.max(u,f.lineHeight):f.lineHeight;A+=y*q+(E-y)*f.lineHeight+(E-1)*t.bodySpacing}b&&(A+=t.footerMarginTop+b*h.lineHeight+(b-1)*t.footerSpacing);let F=0;const S=function(q){C=Math.max(C,a.measureText(q).width+F)};return a.save(),a.font=m.string,as(s.title,S),a.font=f.string,as(s.beforeBody.concat(s.afterBody),S),F=t.displayColors?c+2+t.boxPadding:0,as(r,q=>{as(q.before,S),as(q.lines,S),as(q.after,S)}),F=0,a.font=h.string,as(s.footer,S),a.restore(),C+=x.width,{width:C,height:A}}function Bm(s,t){const{y:a,height:r}=t;return a<r/2?"top":a>s.height-r/2?"bottom":"center"}function zm(s,t,a,r){const{x:o,width:l}=r,c=a.caretSize+a.caretPadding;if(s==="left"&&o+l+c>t.width||s==="right"&&o-l-c<0)return!0}function Wm(s,t,a,r){const{x:o,width:l}=a,{width:c,chartArea:{left:u,right:f}}=s;let m="center";return r==="center"?m=o<=(u+f)/2?"left":"right":o<=l/2?m="left":o>=c-l/2&&(m="right"),zm(m,s,t,a)&&(m="center"),m}function Zl(s,t,a){const r=a.yAlign||t.yAlign||Bm(s,a);return{xAlign:a.xAlign||t.xAlign||Wm(s,t,a,r),yAlign:r}}function Hm(s,t){let{x:a,width:r}=s;return t==="right"?a-=r:t==="center"&&(a-=r/2),a}function Um(s,t,a){let{y:r,height:o}=s;return t==="top"?r+=a:t==="bottom"?r-=o+a:r-=o/2,r}function ec(s,t,a,r){const{caretSize:o,caretPadding:l,cornerRadius:c}=s,{xAlign:u,yAlign:f}=a,m=o+l,{topLeft:h,topRight:g,bottomLeft:b,bottomRight:y}=vi(c);let x=Hm(t,u);const A=Um(t,f,m);return f==="center"?u==="left"?x+=m:u==="right"&&(x-=m):u==="left"?x-=Math.max(h,b)+o:u==="right"&&(x+=Math.max(g,y)+o),{x:er(x,0,r.width-t.width),y:er(A,0,r.height-t.height)}}function mn(s,t,a){const r=vr(a.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-r.right:s.x+r.left}function tc(s){return wr([],Tr(s))}function Ym(s,t,a){return mi(s,{tooltip:t,tooltipItems:a,type:"tooltip"})}function ac(s,t){const a=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return a?s.override(a):s}const ud={beforeTitle:Ar,title(s){if(s.length>0){const t=s[0],a=t.chart.data.labels,r=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return a[t.dataIndex]}return""},afterTitle:Ar,beforeBody:Ar,beforeLabel:Ar,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const a=s.formattedValue;return ds(a)||(t+=a),t},labelColor(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:Ar,afterBody:Ar,beforeFooter:Ar,footer:Ar,afterFooter:Ar};function Xs(s,t,a,r){const o=s[t].call(a,r);return typeof o>"u"?ud[t].call(a,r):o}class sc extends si{static positioners=Li;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const a=this.chart,r=this.options.setContext(this.getContext()),o=r.enabled&&a.options.animation&&r.animations,l=new Kc(this.chart,o);return o._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=Ym(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,a){const{callbacks:r}=a,o=Xs(r,"beforeTitle",this,t),l=Xs(r,"title",this,t),c=Xs(r,"afterTitle",this,t);let u=[];return u=wr(u,Tr(o)),u=wr(u,Tr(l)),u=wr(u,Tr(c)),u}getBeforeBody(t,a){return tc(Xs(a.callbacks,"beforeBody",this,t))}getBody(t,a){const{callbacks:r}=a,o=[];return as(t,l=>{const c={before:[],lines:[],after:[]},u=ac(r,l);wr(c.before,Tr(Xs(u,"beforeLabel",this,l))),wr(c.lines,Xs(u,"label",this,l)),wr(c.after,Tr(Xs(u,"afterLabel",this,l))),o.push(c)}),o}getAfterBody(t,a){return tc(Xs(a.callbacks,"afterBody",this,t))}getFooter(t,a){const{callbacks:r}=a,o=Xs(r,"beforeFooter",this,t),l=Xs(r,"footer",this,t),c=Xs(r,"afterFooter",this,t);let u=[];return u=wr(u,Tr(o)),u=wr(u,Tr(l)),u=wr(u,Tr(c)),u}_createItems(t){const a=this._active,r=this.chart.data,o=[],l=[],c=[];let u=[],f,m;for(f=0,m=a.length;f<m;++f)u.push(Vm(this.chart,a[f]));return t.filter&&(u=u.filter((h,g,b)=>t.filter(h,g,b,r))),t.itemSort&&(u=u.sort((h,g)=>t.itemSort(h,g,r))),as(u,h=>{const g=ac(t.callbacks,h);o.push(Xs(g,"labelColor",this,h)),l.push(Xs(g,"labelPointStyle",this,h)),c.push(Xs(g,"labelTextColor",this,h))}),this.labelColors=o,this.labelPointStyles=l,this.labelTextColors=c,this.dataPoints=u,u}update(t,a){const r=this.options.setContext(this.getContext()),o=this._active;let l,c=[];if(!o.length)this.opacity!==0&&(l={opacity:0});else{const u=Li[r.position].call(this,o,this._eventPosition);c=this._createItems(r),this.title=this.getTitle(c,r),this.beforeBody=this.getBeforeBody(c,r),this.body=this.getBody(c,r),this.afterBody=this.getAfterBody(c,r),this.footer=this.getFooter(c,r);const f=this._size=Xl(this,r),m=Object.assign({},u,f),h=Zl(this.chart,r,m),g=ec(r,m,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,l={opacity:1,x:g.x,y:g.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(t,a,r,o){const l=this.getCaretPosition(t,r,o);a.lineTo(l.x1,l.y1),a.lineTo(l.x2,l.y2),a.lineTo(l.x3,l.y3)}getCaretPosition(t,a,r){const{xAlign:o,yAlign:l}=this,{caretSize:c,cornerRadius:u}=r,{topLeft:f,topRight:m,bottomLeft:h,bottomRight:g}=vi(u),{x:b,y}=t,{width:x,height:A}=a;let C,E,F,S,q,I;return l==="center"?(q=y+A/2,o==="left"?(C=b,E=C-c,S=q+c,I=q-c):(C=b+x,E=C+c,S=q-c,I=q+c),F=C):(o==="left"?E=b+Math.max(f,h)+c:o==="right"?E=b+x-Math.max(m,g)-c:E=this.caretX,l==="top"?(S=y,q=S-c,C=E-c,F=E+c):(S=y+A,q=S+c,C=E+c,F=E-c),I=S),{x1:C,x2:E,x3:F,y1:S,y2:q,y3:I}}drawTitle(t,a,r){const o=this.title,l=o.length;let c,u,f;if(l){const m=fi(r.rtl,this.x,this.width);for(t.x=mn(this,r.titleAlign,r),a.textAlign=m.textAlign(r.titleAlign),a.textBaseline="middle",c=Ys(r.titleFont),u=r.titleSpacing,a.fillStyle=r.titleColor,a.font=c.string,f=0;f<l;++f)a.fillText(o[f],m.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+u,f+1===l&&(t.y+=r.titleMarginBottom-u)}}_drawColorBox(t,a,r,o,l){const c=this.labelColors[r],u=this.labelPointStyles[r],{boxHeight:f,boxWidth:m}=l,h=Ys(l.bodyFont),g=mn(this,"left",l),b=o.x(g),y=f<h.lineHeight?(h.lineHeight-f)/2:0,x=a.y+y;if(l.usePointStyle){const A={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},C=o.leftForLtr(b,m)+m/2,E=x+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,gl(t,A,C,E),t.strokeStyle=c.borderColor,t.fillStyle=c.backgroundColor,gl(t,A,C,E)}else{t.lineWidth=Ka(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,t.strokeStyle=c.borderColor,t.setLineDash(c.borderDash||[]),t.lineDashOffset=c.borderDashOffset||0;const A=o.leftForLtr(b,m),C=o.leftForLtr(o.xPlus(b,1),m-2),E=vi(c.borderRadius);Object.values(E).some(F=>F!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,Cn(t,{x:A,y:x,w:m,h:f,radius:E}),t.fill(),t.stroke(),t.fillStyle=c.backgroundColor,t.beginPath(),Cn(t,{x:C,y:x+1,w:m-2,h:f-2,radius:E}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(A,x,m,f),t.strokeRect(A,x,m,f),t.fillStyle=c.backgroundColor,t.fillRect(C,x+1,m-2,f-2))}t.fillStyle=this.labelTextColors[r]}drawBody(t,a,r){const{body:o}=this,{bodySpacing:l,bodyAlign:c,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:h}=r,g=Ys(r.bodyFont);let b=g.lineHeight,y=0;const x=fi(r.rtl,this.x,this.width),A=function(Z){a.fillText(Z,x.x(t.x+y),t.y+b/2),t.y+=b+l},C=x.textAlign(c);let E,F,S,q,I,j,M;for(a.textAlign=c,a.textBaseline="middle",a.font=g.string,t.x=mn(this,C,r),a.fillStyle=r.bodyColor,as(this.beforeBody,A),y=u&&C!=="right"?c==="center"?m/2+h:m+2+h:0,q=0,j=o.length;q<j;++q){for(E=o[q],F=this.labelTextColors[q],a.fillStyle=F,as(E.before,A),S=E.lines,u&&S.length&&(this._drawColorBox(a,t,q,x,r),b=Math.max(g.lineHeight,f)),I=0,M=S.length;I<M;++I)A(S[I]),b=g.lineHeight;as(E.after,A)}y=0,b=g.lineHeight,as(this.afterBody,A),t.y-=l}drawFooter(t,a,r){const o=this.footer,l=o.length;let c,u;if(l){const f=fi(r.rtl,this.x,this.width);for(t.x=mn(this,r.footerAlign,r),t.y+=r.footerMarginTop,a.textAlign=f.textAlign(r.footerAlign),a.textBaseline="middle",c=Ys(r.footerFont),a.fillStyle=r.footerColor,a.font=c.string,u=0;u<l;++u)a.fillText(o[u],f.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+r.footerSpacing}}drawBackground(t,a,r,o){const{xAlign:l,yAlign:c}=this,{x:u,y:f}=t,{width:m,height:h}=r,{topLeft:g,topRight:b,bottomLeft:y,bottomRight:x}=vi(o.cornerRadius);a.fillStyle=o.backgroundColor,a.strokeStyle=o.borderColor,a.lineWidth=o.borderWidth,a.beginPath(),a.moveTo(u+g,f),c==="top"&&this.drawCaret(t,a,r,o),a.lineTo(u+m-b,f),a.quadraticCurveTo(u+m,f,u+m,f+b),c==="center"&&l==="right"&&this.drawCaret(t,a,r,o),a.lineTo(u+m,f+h-x),a.quadraticCurveTo(u+m,f+h,u+m-x,f+h),c==="bottom"&&this.drawCaret(t,a,r,o),a.lineTo(u+y,f+h),a.quadraticCurveTo(u,f+h,u,f+h-y),c==="center"&&l==="left"&&this.drawCaret(t,a,r,o),a.lineTo(u,f+g),a.quadraticCurveTo(u,f,u+g,f),a.closePath(),a.fill(),o.borderWidth>0&&a.stroke()}_updateAnimationTarget(t){const a=this.chart,r=this.$animations,o=r&&r.x,l=r&&r.y;if(o||l){const c=Li[t.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=Xl(this,t),f=Object.assign({},c,this._size),m=Zl(a,t,f),h=ec(t,f,m,a);(o._to!==h.x||l._to!==h.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const a=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(a);const o={width:this.width,height:this.height},l={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const c=vr(a.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&u&&(t.save(),t.globalAlpha=r,this.drawBackground(l,t,o,a),Yc(t,a.textDirection),l.y+=c.top,this.drawTitle(l,t,a),this.drawBody(l,t,a),this.drawFooter(l,t,a),Qc(t,a.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,a){const r=this._active,o=t.map(({datasetIndex:u,index:f})=>{const m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),l=!xn(r,o),c=this._positionChanged(o,a);(l||c)&&(this._active=o,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,a,r=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const o=this.options,l=this._active||[],c=this._getActiveElements(t,l,a,r),u=this._positionChanged(c,t),f=a||!xn(c,l)||u;return f&&(this._active=c,(o.enabled||o.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,a))),f}_getActiveElements(t,a,r,o){const l=this.options;if(t.type==="mouseout")return[];if(!o)return a.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(t,l.mode,l,r);return l.reverse&&c.reverse(),c}_positionChanged(t,a){const{caretX:r,caretY:o,options:l}=this,c=Li[l.position].call(this,t,a);return c!==!1&&(r!==c.x||o!==c.y)}}var Yi={id:"tooltip",_element:sc,positioners:Li,afterInit(s,t,a){a&&(s.tooltip=new sc({chart:s,options:a}))},beforeUpdate(s,t,a){s.tooltip&&s.tooltip.initialize(a)},reset(s,t,a){s.tooltip&&s.tooltip.initialize(a)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const a={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",a)}},afterEvent(s,t){if(s.tooltip){const a=t.replay;s.tooltip.handleEvent(t.event,a,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ud},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Qm=(s,t,a,r)=>(typeof t=="string"?(a=s.push(t)-1,r.unshift({index:a,label:t})):isNaN(t)&&(a=null),a);function Km(s,t,a,r){const o=s.indexOf(t);if(o===-1)return Qm(s,t,a,r);const l=s.lastIndexOf(t);return o!==l?a:o}const Jm=(s,t)=>s===null?null:er(Math.round(s),0,t);function rc(s){const t=this.getLabels();return s>=0&&s<t.length?t[s]:s}class In extends hi{static id="category";static defaults={ticks:{callback:rc}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const a=this._addedLabels;if(a.length){const r=this.getLabels();for(const{index:o,label:l}of a)r[o]===l&&r.splice(o,1);this._addedLabels=[]}super.init(t)}parse(t,a){if(ds(t))return null;const r=this.getLabels();return a=isFinite(a)&&r[a]===t?a:Km(r,t,Qa(a,t),this._addedLabels),Jm(a,r.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:a}=this.getUserBounds();let{min:r,max:o}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(r=0),a||(o=this.getLabels().length-1)),this.min=r,this.max=o}buildTicks(){const t=this.min,a=this.max,r=this.options.offset,o=[];let l=this.getLabels();l=t===0&&a===l.length-1?l:l.slice(t,a+1),this._valueRange=Math.max(l.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let c=t;c<=a;c++)o.push({value:c});return o}getLabelForValue(t){return rc.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function Xm(s,t){const a=[],{bounds:o,step:l,min:c,max:u,precision:f,count:m,maxTicks:h,maxDigits:g,includeBounds:b}=s,y=l||1,x=h-1,{min:A,max:C}=t,E=!ds(c),F=!ds(u),S=!ds(m),q=(C-A)/(g+1);let I=ll((C-A)/x/y)*y,j,M,Z,Q;if(I<1e-14&&!E&&!F)return[{value:A},{value:C}];Q=Math.ceil(C/I)-Math.floor(A/I),Q>x&&(I=ll(Q*I/x/y)*y),ds(f)||(j=Math.pow(10,f),I=Math.ceil(I*j)/j),o==="ticks"?(M=Math.floor(A/I)*I,Z=Math.ceil(C/I)*I):(M=A,Z=C),E&&F&&l&&Yv((u-c)/l,I/1e3)?(Q=Math.round(Math.min((u-c)/I,h)),I=(u-c)/Q,M=c,Z=u):S?(M=E?c:M,Z=F?u:Z,Q=m-1,I=(Z-M)/Q):(Q=(Z-M)/I,gn(Q,Math.round(Q),I/1e3)?Q=Math.round(Q):Q=Math.ceil(Q));const W=Math.max(cl(I),cl(M));j=Math.pow(10,ds(f)?W:f),M=Math.round(M*j)/j,Z=Math.round(Z*j)/j;let H=0;for(E&&(b&&M!==c?(a.push({value:c}),M<c&&H++,gn(Math.round((M+H*I)*j)/j,c,ic(c,q,s))&&H++):M<c&&H++);H<Q;++H){const U=Math.round((M+H*I)*j)/j;if(F&&U>u)break;a.push({value:U})}return F&&b&&Z!==u?a.length&&gn(a[a.length-1].value,u,ic(u,q,s))?a[a.length-1].value=u:a.push({value:u}):(!F||Z===u)&&a.push({value:Z}),a}function ic(s,t,{horizontal:a,minRotation:r}){const o=Fr(r),l=(a?Math.sin(o):Math.cos(o))||.001,c=.75*t*(""+s).length;return Math.min(t/l,c)}class Zm extends hi{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,a){return ds(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:a,maxDefined:r}=this.getUserBounds();let{min:o,max:l}=this;const c=f=>o=a?o:f,u=f=>l=r?l:f;if(t){const f=Gr(o),m=Gr(l);f<0&&m<0?u(0):f>0&&m>0&&c(0)}if(o===l){let f=l===0?1:Math.abs(l*.05);u(l+f),t||c(o-f)}this.min=o,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:a,stepSize:r}=t,o;return r?(o=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,o>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${o} ticks. Limiting to 1000.`),o=1e3)):(o=this.computeTickLimit(),a=a||11),a&&(o=Math.min(a,o)),o}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,a=t.ticks;let r=this.getTickLimit();r=Math.max(2,r);const o={maxTicks:r,bounds:t.bounds,min:t.min,max:t.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},l=this._range||this,c=Xm(o,l);return t.bounds==="ticks"&&Qv(c,this,"value"),t.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const t=this.ticks;let a=this.min,r=this.max;if(super.configure(),this.options.offset&&t.length){const o=(r-a)/Math.max(t.length-1,1)/2;a-=o,r+=o}this._startValue=a,this._endValue=r,this._valueRange=r-a}getLabelForValue(t){return So(t,this.chart.options.locale,this.options.ticks.format)}}class Rn extends Zm{static id="linear";static defaults={ticks:{callback:qc.formatters.numeric}};determineDataLimits(){const{min:t,max:a}=this.getMinMax(!0);this.min=ur(t)?t:0,this.max=ur(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),a=t?this.width:this.height,r=Fr(this.options.ticks.minRotation),o=(t?Math.sin(r):Math.cos(r))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,l.lineHeight/o))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const jn={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Zs=Object.keys(jn);function nc(s,t){return s-t}function oc(s,t){if(ds(t))return null;const a=s._adapter,{parser:r,round:o,isoWeekday:l}=s._parseOpts;let c=t;return typeof r=="function"&&(c=r(c)),ur(c)||(c=typeof r=="string"?a.parse(c,r):a.parse(c)),c===null?null:(o&&(c=o==="week"&&(Dn(l)||l===!0)?a.startOf(c,"isoWeek",l):a.startOf(c,o)),+c)}function lc(s,t,a,r){const o=Zs.length;for(let l=Zs.indexOf(s);l<o-1;++l){const c=jn[Zs[l]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((a-t)/(u*c.size))<=r)return Zs[l]}return Zs[o-1]}function eh(s,t,a,r,o){for(let l=Zs.length-1;l>=Zs.indexOf(a);l--){const c=Zs[l];if(jn[c].common&&s._adapter.diff(o,r,c)>=t-1)return c}return Zs[a?Zs.indexOf(a):0]}function th(s){for(let t=Zs.indexOf(s)+1,a=Zs.length;t<a;++t)if(jn[Zs[t]].common)return Zs[t]}function cc(s,t,a){if(!a)s[t]=!0;else if(a.length){const{lo:r,hi:o}=wo(a,t),l=a[r]>=t?a[r]:a[o];s[l]=!0}}function ah(s,t,a,r){const o=s._adapter,l=+o.startOf(t[0].value,r),c=t[t.length-1].value;let u,f;for(u=l;u<=c;u=+o.add(u,1,r))f=a[u],f>=0&&(t[f].major=!0);return t}function dc(s,t,a){const r=[],o={},l=t.length;let c,u;for(c=0;c<l;++c)u=t[c],o[u]=c,r.push({value:u,major:!1});return l===0||!a?r:ah(s,r,o,a)}class uc extends hi{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,a={}){const r=t.time||(t.time={}),o=this._adapter=new mp._date(t.adapters.date);o.init(a),Ii(r.displayFormats,o.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(t),this._normalized=a.normalized}parse(t,a){return t===void 0?null:oc(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,a=this._adapter,r=t.time.unit||"day";let{min:o,max:l,minDefined:c,maxDefined:u}=this.getUserBounds();function f(m){!c&&!isNaN(m.min)&&(o=Math.min(o,m.min)),!u&&!isNaN(m.max)&&(l=Math.max(l,m.max))}(!c||!u)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),o=ur(o)&&!isNaN(o)?o:+a.startOf(Date.now(),r),l=ur(l)&&!isNaN(l)?l:+a.endOf(Date.now(),r)+1,this.min=Math.min(o,l-1),this.max=Math.max(o+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return t.length&&(a=t[0],r=t[t.length-1]),{min:a,max:r}}buildTicks(){const t=this.options,a=t.time,r=t.ticks,o=r.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&o.length&&(this.min=this._userMin||o[0],this.max=this._userMax||o[o.length-1]);const l=this.min,c=this.max,u=ef(o,l,c);return this._unit=a.unit||(r.autoSkip?lc(a.minUnit,this.min,this.max,this._getLabelCapacity(l)):eh(this,u.length,a.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:th(this._unit),this.initOffsets(o),t.reverse&&u.reverse(),dc(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let a=0,r=0,o,l;this.options.offset&&t.length&&(o=this.getDecimalForValue(t[0]),t.length===1?a=1-o:a=(this.getDecimalForValue(t[1])-o)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?r=l:r=(l-this.getDecimalForValue(t[t.length-2]))/2);const c=t.length<3?.5:.25;a=er(a,0,c),r=er(r,0,c),this._offsets={start:a,end:r,factor:1/(a+1+r)}}_generate(){const t=this._adapter,a=this.min,r=this.max,o=this.options,l=o.time,c=l.unit||lc(l.minUnit,a,r,this._getLabelCapacity(a)),u=Qa(o.ticks.stepSize,1),f=c==="week"?l.isoWeekday:!1,m=Dn(f)||f===!0,h={};let g=a,b,y;if(m&&(g=+t.startOf(g,"isoWeek",f)),g=+t.startOf(g,m?"day":c),t.diff(r,a,c)>1e5*u)throw new Error(a+" and "+r+" are too far apart with stepSize of "+u+" "+c);const x=o.ticks.source==="data"&&this.getDataTimestamps();for(b=g,y=0;b<r;b=+t.add(b,u,c),y++)cc(h,b,x);return(b===r||o.bounds==="ticks"||y===1)&&cc(h,b,x),Object.keys(h).sort(nc).map(A=>+A)}getLabelForValue(t){const a=this._adapter,r=this.options.time;return r.tooltipFormat?a.format(t,r.tooltipFormat):a.format(t,r.displayFormats.datetime)}format(t,a){const o=this.options.time.displayFormats,l=this._unit,c=a||o[l];return this._adapter.format(t,c)}_tickFormatFunction(t,a,r,o){const l=this.options,c=l.ticks.callback;if(c)return hs(c,[t,a,r],this);const u=l.time.displayFormats,f=this._unit,m=this._majorUnit,h=f&&u[f],g=m&&u[m],b=r[a],y=m&&g&&b&&b.major;return this._adapter.format(t,o||(y?g:h))}generateTickLabels(t){let a,r,o;for(a=0,r=t.length;a<r;++a)o=t[a],o.label=this._tickFormatFunction(o.value,a,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const a=this._offsets,r=this.getDecimalForValue(t);return this.getPixelForDecimal((a.start+r)*a.factor)}getValueForPixel(t){const a=this._offsets,r=this.getDecimalForPixel(t)/a.factor-a.end;return this.min+r*(this.max-this.min)}_getLabelSize(t){const a=this.options.ticks,r=this.ctx.measureText(t).width,o=Fr(this.isHorizontal()?a.maxRotation:a.minRotation),l=Math.cos(o),c=Math.sin(o),u=this._resolveTickFontOptions(0).size;return{w:r*l+u*c,h:r*c+u*l}}_getLabelCapacity(t){const a=this.options.time,r=a.displayFormats,o=r[a.unit]||r.millisecond,l=this._tickFormatFunction(t,0,dc(this,[t],this._majorUnit),o),c=this._getLabelSize(l),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let t=this._cache.data||[],a,r;if(t.length)return t;const o=this.getMatchingVisibleMetas();if(this._normalized&&o.length)return this._cache.data=o[0].controller.getAllParsedValues(this);for(a=0,r=o.length;a<r;++a)t=t.concat(o[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let a,r;if(t.length)return t;const o=this.getLabels();for(a=0,r=o.length;a<r;++a)t.push(oc(this,o[a]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Ic(t.sort(nc))}}function hn(s,t,a){let r=0,o=s.length-1,l,c,u,f;a?(t>=s[r].pos&&t<=s[o].pos&&({lo:r,hi:o}=vo(s,"pos",t)),{pos:l,time:u}=s[r],{pos:c,time:f}=s[o]):(t>=s[r].time&&t<=s[o].time&&({lo:r,hi:o}=vo(s,"time",t)),{time:l,pos:u}=s[r],{time:c,pos:f}=s[o]);const m=c-l;return m?u+(f-u)*(t-l)/m:u}class K3 extends uc{static id="timeseries";static defaults=uc.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(t);this._minPos=hn(a,this.min),this._tableRange=hn(a,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:a,max:r}=this,o=[],l=[];let c,u,f,m,h;for(c=0,u=t.length;c<u;++c)m=t[c],m>=a&&m<=r&&o.push(m);if(o.length<2)return[{time:a,pos:0},{time:r,pos:1}];for(c=0,u=o.length;c<u;++c)h=o[c+1],f=o[c-1],m=o[c],Math.round((h+f)/2)!==m&&l.push({time:m,pos:c/(u-1)});return l}_generate(){const t=this.min,a=this.max;let r=super.getDataTimestamps();return(!r.includes(t)||!r.length)&&r.splice(0,0,t),(!r.includes(a)||r.length===1)&&r.push(a),r.sort((o,l)=>o-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const a=this.getDataTimestamps(),r=this.getLabelTimestamps();return a.length&&r.length?t=this.normalize(a.concat(r)):t=a.length?a:r,t=this._cache.all=t,t}getDecimalForValue(t){return(hn(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const a=this._offsets,r=this.getDecimalForPixel(t)/a.factor-a.end;return hn(this._table,r*this._tableRange+this._minPos,!0)}}var sh=_('<div class="chart-empty svelte-nvktxc"><span class="material-symbols-outlined svelte-nvktxc">show_chart</span> <p class="svelte-nvktxc">No assessment data available</p></div>'),rh=_('<canvas class="svelte-nvktxc"></canvas>'),ih=_('<div class="chart-container svelte-nvktxc"><!></div>');function nh(s,t){qa(t,!0),dr.register(Pn,Mn,In,Rn,Yi,Hi,Ui);let a=Pa(t,"subjects",19,()=>[]),r=at(void 0),o;function l(){if(!e(r)||!a()||a().length===0)return;o&&o.destroy();const g=a().filter(E=>E.numericGrade>0&&E.verified);if(g.length===0)return;const b=g.map(E=>E.name),y=g.map(E=>E.writtenWork||0),x=g.map(E=>E.performanceTasks||0),A=g.map(E=>E.quarterlyAssessment||0),C=e(r).getContext("2d");o=new dr(C,{type:"bar",data:{labels:b,datasets:[{label:"Written Work",data:y,backgroundColor:"rgba(33, 150, 243, 1.0)",borderColor:"rgb(33, 150, 243)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9},{label:"Performance Tasks",data:x,backgroundColor:"rgba(156, 39, 176, 1.0)",borderColor:"rgb(156, 39, 176)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9},{label:"Quarterly Assessment",data:A,backgroundColor:"rgba(255, 152, 0, 1.0)",borderColor:"rgb(255, 152, 0)",borderWidth:2,borderRadius:6,barPercentage:.8,categoryPercentage:.9}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"top",labels:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:15,font:{size:13,weight:"600"},usePointStyle:!0,pointStyle:"circle",boxWidth:10,boxHeight:10}},title:{display:!0,text:"Assessment Type Performance Comparison",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{backgroundColor:"rgba(30, 30, 30, 0.95)",padding:16,cornerRadius:12,titleFont:{size:15,weight:"600",family:"'Inter', 'Segoe UI', sans-serif"},bodyFont:{size:14,weight:"500",family:"'Inter', 'Segoe UI', sans-serif"},titleColor:"#ffffff",bodyColor:"#e0e0e0",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!0,usePointStyle:!0,pointStyle:"circle",boxWidth:8,boxHeight:8,boxPadding:6,titleMarginBottom:10,bodySpacing:8,multiKeyBackground:"transparent",callbacks:{label(E){const F=E.dataset.label||"",S=E.parsed.y;let q="",I="";return S>=85?(q="Excellent",I=""):S>=80?(q="Good",I=""):S>=75?(q="Satisfactory",I=""):S>0&&(q="Needs Improvement",I=""),q?`${F}: ${S.toFixed(1)}% ${I} ${q}`:`${F}: ${S.toFixed(1)}%`}}}},scales:{y:{beginAtZero:!0,max:100,grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim(),lineWidth:1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:8,callback(E){return E+"%"}},title:{display:!0,text:"Grade (%)",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"600"}}},x:{grid:{display:!1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},maxRotation:0,minRotation:0,autoSkip:!1}}}}})}function c(){o&&l()}Ua(()=>{a()&&a().length>0&&l();const g=new MutationObserver(b=>{b.forEach(y=>{y.type==="attributes"&&y.attributeName==="data-theme"&&c()})});return g.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{g.disconnect()}}),ai(()=>{o&&o.destroy()}),Ss(()=>{a()&&e(r)&&l()});var u=ih(),f=n(u);{var m=g=>{var b=sh();p(g,b)},h=g=>{var b=rh();Us(b,y=>d(r,y),()=>e(r)),p(g,b)};$(f,g=>{a().filter(b=>b.numericGrade>0&&b.verified).length===0?g(m):g(h,!1)})}i(u),p(s,u),Ga()}var oh=_('<div class="chart-empty svelte-nvktxc"><span class="material-symbols-outlined svelte-nvktxc">analytics</span> <p class="svelte-nvktxc">No grade data available</p></div>'),lh=_('<canvas class="svelte-nvktxc"></canvas>'),ch=_('<div class="chart-container svelte-nvktxc"><!></div>');function dh(s,t){qa(t,!0),dr.register(Pn,Mn,In,Rn,Yi,Hi,Ui);let a=Pa(t,"subjects",19,()=>[]),r=at(void 0),o;function l(){if(!e(r)||!a()||a().length===0)return;o&&o.destroy();const g=a().filter(I=>I.numericGrade>0&&I.verified);if(g.length===0)return;const b=g.map(I=>I.name),y=g.map(I=>I.numericGrade),x=y.map(I=>I>=85?"rgba(76, 175, 80, 1.0)":I>=80?"rgba(33, 150, 243, 1.0)":I>=75?"rgba(255, 152, 0, 1.0)":"rgba(244, 67, 54, 1.0)"),A=y.map(I=>I>=85?"rgb(76, 175, 80)":I>=80?"rgb(33, 150, 243)":I>=75?"rgb(255, 152, 0)":"rgb(244, 67, 54)"),C=g.length;let E,F,S;C<=3?(E=50,F=.6,S=.7):C<=6?(E=40,F=.7,S=.75):C<=10?(E=30,F=.8,S=.85):(E=20,F=.9,S=.9);const q=e(r).getContext("2d");o=new dr(q,{type:"bar",data:{labels:b,datasets:[{label:"Grade",data:y,backgroundColor:x,borderColor:A,borderWidth:2,borderRadius:8,maxBarThickness:E,categoryPercentage:F,barPercentage:S}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Subject Performance Overview",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{backgroundColor:"rgba(30, 30, 30, 0.95)",padding:16,cornerRadius:12,titleFont:{size:15,weight:"600",family:"'Inter', 'Segoe UI', sans-serif"},bodyFont:{size:14,weight:"500",family:"'Inter', 'Segoe UI', sans-serif"},titleColor:"#ffffff",bodyColor:"#e0e0e0",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,displayColors:!1,titleMarginBottom:8,bodySpacing:6,callbacks:{label(I){const j=I.parsed.x;let M="",Z="";return j>=85?(M="Excellent",Z=""):j>=80?(M="Good",Z=""):j>=75?(M="Satisfactory",Z=""):(M="Needs Improvement",Z=""),`${Z} ${j.toFixed(1)}% - ${M}`}}}},scales:{x:{beginAtZero:!0,max:100,grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim(),lineWidth:1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:8,callback(I){return I+"%"}},title:{display:!0,text:"Grade (%)",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"600"}}},y:{grid:{display:!1},ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim(),font:{size:12,weight:"500"},padding:10}}}}})}function c(){o&&l()}Ua(()=>{a()&&a().length>0&&l();const g=new MutationObserver(b=>{b.forEach(y=>{y.type==="attributes"&&y.attributeName==="data-theme"&&c()})});return g.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{g.disconnect()}}),ai(()=>{o&&o.destroy()}),Ss(()=>{a()&&e(r)&&l()});var u=ch(),f=n(u);{var m=g=>{var b=oh();p(g,b)},h=g=>{var b=lh();Us(b,y=>d(r,y),()=>e(r)),p(g,b)};$(f,g=>{a().filter(b=>b.numericGrade>0&&b.verified).length===0?g(m):g(h,!1)})}i(u),p(s,u),Ga()}function uh(s,t){mr(t)}function vh(s,t,a){e(t)>1&&(mr(t,-1),yn().then(()=>{setTimeout(()=>{const r=e(t)-1,o=a[r];o&&o.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}))}function fh(s,t,a){d(t,1),yn().then(()=>{setTimeout(()=>{const r=document.querySelector(".ai-analysis-section");if(r)r.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"});else{const o=a[0];o&&o.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},100)})}var ph=_('<div class="analysis-loading svelte-103w4k3"><div class="system-loader"></div> <p>Generating your personalized analysis...</p></div>'),mh=_('<div class="analysis-error svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">error</span> <div class="error-content svelte-103w4k3"><h4 class="svelte-103w4k3">Unable to Generate Analysis</h4> <p class="svelte-103w4k3"> </p></div></div>'),hh=_('<div class="analysis-section svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">psychology</span> <span>Overview</span></div> <p class="section-text svelte-103w4k3"> </p></div>'),gh=_('<div class="change-item svelte-103w4k3"><div class="change-header svelte-103w4k3"><span class="change-subject svelte-103w4k3"> </span> <span> </span></div> <p class="change-observation svelte-103w4k3"> </p></div>'),_h=_('<div class="notable-changes svelte-103w4k3"><h4 class="subsection-title svelte-103w4k3">Notable Changes:</h4> <!></div>'),bh=_('<div class="analysis-section quarter-comparison svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3"><!></span> <span>Progress from Last Quarter</span> <span> </span></div> <p class="section-text svelte-103w4k3"> </p> <!></div>'),yh=_('<div class="item-row svelte-103w4k3"><div class="item-top svelte-103w4k3"><span class="item-name svelte-103w4k3"> </span> <span class="item-value svelte-103w4k3"> </span></div> <p class="item-text svelte-103w4k3"> </p></div>'),wh=_('<div class="analysis-section svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">emoji_events</span> <span>Strengths</span></div> <!></div>'),xh=_('<div class="item-row svelte-103w4k3"><div class="item-top svelte-103w4k3"><span class="item-name svelte-103w4k3"> </span> <span class="item-value svelte-103w4k3"> </span></div> <p class="item-text svelte-103w4k3"> </p> <p class="item-note svelte-103w4k3"> </p></div>'),Sh=_('<div class="analysis-section svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">trending_up</span> <span>Areas for Growth</span></div> <!></div>'),kh=_('<div class="assessment-item svelte-103w4k3"><div class="assessment-top svelte-103w4k3"><span class="assessment-name svelte-103w4k3">Written Work</span> <span class="assessment-value svelte-103w4k3"> </span></div> <p class="assessment-text svelte-103w4k3"> </p></div>'),Dh=_('<div class="assessment-item svelte-103w4k3"><div class="assessment-top svelte-103w4k3"><span class="assessment-name svelte-103w4k3">Performance Tasks</span> <span class="assessment-value svelte-103w4k3"> </span></div> <p class="assessment-text svelte-103w4k3"> </p></div>'),Ah=_('<div class="assessment-item svelte-103w4k3"><div class="assessment-top svelte-103w4k3"><span class="assessment-name svelte-103w4k3">Quarterly Assessment</span> <span class="assessment-value svelte-103w4k3"> </span></div> <p class="assessment-text svelte-103w4k3"> </p></div>'),Ch=_('<div class="analysis-section svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">analytics</span> <span>Assessment Breakdown</span></div> <div class="assessment-row svelte-103w4k3"><!> <!> <!></div> <div class="charts-section svelte-103w4k3"><!> <!></div></div>'),Th=_('<div class="item-row action-row svelte-103w4k3"><h4 class="action-name svelte-103w4k3"> </h4> <p class="item-text svelte-103w4k3"> </p> <p class="item-note svelte-103w4k3"> </p></div>'),Eh=_('<div class="analysis-section svelte-103w4k3"><div class="section-title svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">checklist</span> <span>Action Plan</span></div> <!></div>'),Fh=_('<button class="show-more-btn svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">close</span> <span>Close All</span></button>'),$h=_('<button class="show-more-btn svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">expand_less</span> <span>Show Less</span></button>'),Nh=_('<button class="show-more-btn svelte-103w4k3"><span class="material-symbols-outlined svelte-103w4k3">expand_more</span> <span>Show More</span></button>'),Ph=_('<!> <!> <!> <!>  <!> <!> <div class="ai-action-buttons svelte-103w4k3"><!> <!></div>',1),Lh=_('<div class="ai-analysis-display svelte-103w4k3"><!></div>');function Mh(s,t){qa(t,!0);let a=Pa(t,"analysisData",3,null),r=Pa(t,"isLoading",3,!1),o=Pa(t,"error",3,null),l=Pa(t,"subjects",19,()=>[]),c=at(0),u=Os([]),f=at(0);Ss(()=>{r()&&d(c,0)}),Ss(()=>{a()&&!r()&&e(c)===0&&yn().then(()=>{setTimeout(()=>{d(c,1)},50)})}),Ss(()=>{e(c)>e(f)&&e(c)>1&&yn().then(()=>{setTimeout(()=>{const A=e(c)-1,C=u[A];C&&C.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}),d(f,e(c),!0)});let m=Lt(()=>a()?1+(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+(a().actionPlan&&a().actionPlan.length>0?1:0):0),h=Lt(()=>e(c)>=e(m));var g=Lh(),b=n(g);{var y=A=>{var C=ph();p(A,C)},x=A=>{var C=mt(),E=Ue(C);{var F=q=>{var I=mh(),j=v(n(I),2),M=v(n(j),2),Z=n(M,!0);i(M),i(j),i(I),O(()=>w(Z,o())),p(q,I)},S=q=>{var I=mt(),j=Ue(I);{var M=Z=>{const Q=Lt(()=>(a().quarterComparison?1:0)+2+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1),W=Lt(()=>(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1);var H=Ph(),U=Ue(H);{var X=Be=>{var He=hh(),Ne=v(n(He),2),Je=n(Ne,!0);i(Ne),i(He),Us(He,lt=>u[0]=lt,()=>u?.[0]),O(()=>w(Je,a().overallInsight)),Xa(1,He,()=>Bs,()=>({y:-20,duration:400,easing:Vs})),Xa(2,He,()=>zs,()=>({duration:200})),p(Be,He)};$(U,Be=>{e(c)>=1&&Be(X)})}var B=v(U,2);{var oe=Be=>{var He=bh(),Ne=n(He),Je=n(Ne),lt=n(Je);{var Pe=ee=>{var ue=_a("trending_up");p(ee,ue)},we=ee=>{var ue=mt(),fe=Ue(ue);{var T=le=>{var R=_a("trending_down");p(le,R)},P=le=>{var R=_a("trending_flat");p(le,R)};$(fe,le=>{a().quarterComparison.overallTrend==="declined"?le(T):le(P,!1)},!0)}p(ee,ue)};$(lt,ee=>{a().quarterComparison.overallTrend==="improved"?ee(Pe):ee(we,!1)})}i(Je);var tt=v(Je,4),ct=n(tt);i(tt),i(Ne);var xe=v(Ne,2),Se=n(xe,!0);i(xe);var We=v(xe,2);{var Ze=ee=>{var ue=_h(),fe=v(n(ue),2);Tt(fe,17,()=>a().quarterComparison.notableChanges,Ha,(T,P,le)=>{var R=gh(),G=n(R),ie=n(G),_e=n(ie,!0);i(ie);var Y=v(ie,2),N=n(Y);i(Y),i(G);var D=v(G,2),L=n(D,!0);i(D),i(R),O(()=>{w(_e,e(P).subject),ge(Y,1,`change-value ${e(P).change>0?"positive":e(P).change<0?"negative":"neutral"}`,"svelte-103w4k3"),w(N,`${e(P).change>0?"+":""}${e(P).change??""}`),w(L,e(P).observation)}),Xa(1,R,()=>Bs,()=>({y:-10,duration:350,delay:100+le*60,easing:Vs})),Xa(2,R,()=>zs,()=>({duration:200})),p(T,R)}),i(ue),p(ee,ue)};$(We,ee=>{a().quarterComparison.notableChanges&&a().quarterComparison.notableChanges.length>0&&ee(Ze)})}i(He),Us(He,ee=>u[1]=ee,()=>u?.[1]),O(()=>{ge(tt,1,`trend-badge ${a().quarterComparison.overallTrend??""}`,"svelte-103w4k3"),w(ct,`${a().quarterComparison.changeAmount>0?"+":""}${a().quarterComparison.changeAmount??""}`),w(Se,a().quarterComparison.insight)}),Xa(1,He,()=>Bs,()=>({y:-20,duration:400,delay:50,easing:Vs})),Xa(2,He,()=>zs,()=>({duration:200})),p(Be,He)};$(B,Be=>{a().quarterComparison&&e(c)>=2&&Be(oe)})}var K=v(B,2);{var de=Be=>{var He=wh(),Ne=v(n(He),2);Tt(Ne,17,()=>a().strengths,Ha,(Je,lt,Pe)=>{var we=yh(),tt=n(we),ct=n(tt),xe=n(ct,!0);i(ct);var Se=v(ct,2),We=n(Se,!0);i(Se),i(tt);var Ze=v(tt,2),ee=n(Ze,!0);i(Ze),i(we),O(ue=>{w(xe,e(lt).subject),w(We,ue),w(ee,e(lt).reason)},[()=>e(lt).score.toFixed(1)]),Xa(1,we,()=>Bs,()=>({y:-10,duration:350,delay:100+Pe*80,easing:Vs})),Xa(2,we,()=>zs,()=>({duration:200})),p(Je,we)}),i(He),Us(He,Je=>u[a().quarterComparison?2:1]=Je,()=>u?.[a().quarterComparison?2:1]),Xa(1,He,()=>Bs,()=>({y:-20,duration:400,delay:50,easing:Vs})),Xa(2,He,()=>zs,()=>({duration:200})),p(Be,He)};$(K,Be=>{e(c)>=(a().quarterComparison?3:2)&&Be(de)})}var ae=v(K,2);{var te=Be=>{const He=Lt(()=>a().quarterComparison?4:3),Ne=Lt(()=>a().quarterComparison?3:2);var Je=mt(),lt=Ue(Je);{var Pe=we=>{var tt=Sh(),ct=v(n(tt),2);Tt(ct,17,()=>a().areasForGrowth,Ha,(xe,Se,We)=>{var Ze=xh(),ee=n(Ze),ue=n(ee),fe=n(ue,!0);i(ue);var T=v(ue,2),P=n(T,!0);i(T),i(ee);var le=v(ee,2),R=n(le,!0);i(le);var G=v(le,2),ie=n(G,!0);i(G),i(Ze),O(_e=>{w(fe,e(Se).subject),w(P,_e),w(R,e(Se).currentGap),w(ie,e(Se).potential)},[()=>e(Se).score.toFixed(1)]),Xa(1,Ze,()=>Bs,()=>({y:-10,duration:350,delay:100+We*80,easing:Vs})),Xa(2,Ze,()=>zs,()=>({duration:200})),p(xe,Ze)}),i(tt),Us(tt,xe=>u[e(Ne)]=xe,()=>u?.[e(Ne)]),Xa(1,tt,()=>Bs,()=>({y:-20,duration:400,delay:100,easing:Vs})),Xa(2,tt,()=>zs,()=>({duration:200})),p(we,tt)};$(lt,we=>{e(c)>=e(He)&&we(Pe)})}p(Be,Je)};$(ae,Be=>{a().areasForGrowth&&a().areasForGrowth.length>0&&Be(te)})}var Ce=v(ae,2);{var Ae=Be=>{var He=Ch(),Ne=v(n(He),2),Je=n(Ne);{var lt=Ze=>{var ee=kh(),ue=n(ee),fe=v(n(ue),2),T=n(fe);i(fe),i(ue);var P=v(ue,2),le=n(P,!0);i(P),i(ee),O(R=>{w(T,`${R??""}%`),w(le,a().assessmentInsights.writtenWork.insight)},[()=>a().assessmentInsights.writtenWork.average.toFixed(1)]),Xa(1,ee,()=>Bs,()=>({y:-10,duration:350,delay:100,easing:Vs})),Xa(2,ee,()=>zs,()=>({duration:200})),p(Ze,ee)};$(Je,Ze=>{a().assessmentInsights.writtenWork&&Ze(lt)})}var Pe=v(Je,2);{var we=Ze=>{var ee=Dh(),ue=n(ee),fe=v(n(ue),2),T=n(fe);i(fe),i(ue);var P=v(ue,2),le=n(P,!0);i(P),i(ee),O(R=>{w(T,`${R??""}%`),w(le,a().assessmentInsights.performanceTasks.insight)},[()=>a().assessmentInsights.performanceTasks.average.toFixed(1)]),Xa(1,ee,()=>Bs,()=>({y:-10,duration:350,delay:180,easing:Vs})),Xa(2,ee,()=>zs,()=>({duration:200})),p(Ze,ee)};$(Pe,Ze=>{a().assessmentInsights.performanceTasks&&Ze(we)})}var tt=v(Pe,2);{var ct=Ze=>{var ee=Ah(),ue=n(ee),fe=v(n(ue),2),T=n(fe);i(fe),i(ue);var P=v(ue,2),le=n(P,!0);i(P),i(ee),O(R=>{w(T,`${R??""}%`),w(le,a().assessmentInsights.quarterlyAssessment.insight)},[()=>a().assessmentInsights.quarterlyAssessment.average.toFixed(1)]),Xa(1,ee,()=>Bs,()=>({y:-10,duration:350,delay:260,easing:Vs})),Xa(2,ee,()=>zs,()=>({duration:200})),p(Ze,ee)};$(tt,Ze=>{a().assessmentInsights.quarterlyAssessment&&Ze(ct)})}i(Ne);var xe=v(Ne,2),Se=n(xe);nh(Se,{get subjects(){return l()}});var We=v(Se,2);dh(We,{get subjects(){return l()}}),i(xe),i(He),Us(He,Ze=>u[e(W)]=Ze,()=>u?.[e(W)]),Xa(1,He,()=>Bs,()=>({y:-20,duration:400,delay:150,easing:Vs})),Xa(2,He,()=>zs,()=>({duration:200})),p(Be,He)};$(Ce,Be=>{e(c)>=e(Q)&&Be(Ae)})}var Re=v(Ce,2);{var Me=Be=>{const He=Lt(()=>(a().quarterComparison?1:0)+2+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+1),Ne=Lt(()=>(a().quarterComparison?1:0)+1+(a().areasForGrowth&&a().areasForGrowth.length>0?1:0)+1+1);var Je=mt(),lt=Ue(Je);{var Pe=we=>{var tt=Eh(),ct=v(n(tt),2);Tt(ct,17,()=>a().actionPlan,Ha,(xe,Se,We)=>{var Ze=Th();Ya(Ze,`--action-index: ${We};`);var ee=n(Ze),ue=n(ee,!0);i(ee);var fe=v(ee,2),T=n(fe,!0);i(fe);var P=v(fe,2),le=n(P,!0);i(P),i(Ze),O(()=>{w(ue,e(Se).title),w(T,e(Se).description),w(le,e(Se).expectedImpact)}),Xa(1,Ze,()=>Bs,()=>({y:-10,duration:350,delay:100+We*80,easing:Vs})),Xa(2,Ze,()=>zs,()=>({duration:200})),p(xe,Ze)}),i(tt),Us(tt,xe=>u[e(Ne)]=xe,()=>u?.[e(Ne)]),Xa(1,tt,()=>Bs,()=>({y:-20,duration:400,delay:200,easing:Vs})),Xa(2,tt,()=>zs,()=>({duration:200})),p(we,tt)};$(lt,we=>{e(c)>=e(He)&&we(Pe)})}p(Be,Je)};$(Re,Be=>{a().actionPlan&&a().actionPlan.length>0&&Be(Me)})}var Ge=v(Re,2),be=n(Ge);{var ke=Be=>{var He=mt(),Ne=Ue(He);{var Je=Pe=>{var we=Fh();we.__click=[fh,c,u],Xa(1,we,()=>Bs,()=>({y:20,duration:400,delay:100,easing:Vs})),Xa(2,we,()=>zs,()=>({duration:200})),p(Pe,we)},lt=Pe=>{var we=$h();we.__click=[vh,c,u],Xa(1,we,()=>Bs,()=>({y:20,duration:400,delay:100,easing:Vs})),Xa(2,we,()=>zs,()=>({duration:200})),p(Pe,we)};$(Ne,Pe=>{e(h)?Pe(Je):Pe(lt,!1)})}p(Be,He)};$(be,Be=>{e(c)>1&&Be(ke)})}var Ve=v(be,2);{var it=Be=>{var He=Nh();He.__click=[uh,c],Xa(1,He,()=>Bs,()=>({y:20,duration:400,delay:100,easing:Vs})),Xa(2,He,()=>zs,()=>({duration:200})),p(Be,He)};$(Ve,Be=>{e(h)||Be(it)})}i(Ge),p(Z,H)};$(j,Z=>{a()&&Z(M)},!0)}p(q,I)};$(E,q=>{o()?q(F):q(S,!1)},!0)}p(A,C)};$(b,A=>{r()?A(y):A(x,!1)})}i(g),p(s,g),Ga()}Cs(["click"]);const Ih=300*1e3,vc="student_grades_",fc="student_ai_analysis_",Rh=10080*60*1e3;function jh(){const s={grades:[],statistics:{overallAverage:0,totalSubjects:0},sectionInfo:null,classRank:null,totalStudentsInSection:0,currentQuarter:2,currentQuarterName:"2nd Quarter",currentSchoolYear:"2025-2026",isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null,previousQuarterAverage:null,averageChange:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null,isPreloading:!1,preloadProgress:{current:0,total:0}},{subscribe:t,set:a,update:r}=Qs(s);function o(){const U=ho(ws);if(!U?.isAuthenticated||!U.userData)return{};const X={id:U.userData.id,name:U.userData.name,account_number:U.userData.accountNumber,account_type:U.userData.account_type||U.userData.accountType};return{"x-user-info":JSON.stringify(X)}}function l(U,X,B){return`${vc}${U}_${X}_${B}`}function c(U){return!U||!U.timestamp?!1:Date.now()-U.timestamp<Ih}function u(U,X,B){try{const oe=l(U,X,B),K=localStorage.getItem(oe);if(K)return JSON.parse(K).data}catch{}return null}function f(U,X,B){try{const oe=l(U,X,B),K=localStorage.getItem(oe);if(K){const de=JSON.parse(K);if(c(de))return de.data}}catch{}return null}function m(U,X,B,oe){try{const K=l(U,X,B),de={data:oe,timestamp:Date.now()};localStorage.setItem(K,JSON.stringify(de))}catch{}}async function h(){try{const X=await(await fetch("/api/current-quarter",{headers:o()})).json();if(X.success&&X.data)return{currentQuarter:X.data.currentQuarter,currentQuarterName:X.data.quarterName,currentSchoolYear:X.data.currentSchoolYear}}catch{}return{currentQuarter:2,currentQuarterName:"2nd Quarter",currentSchoolYear:"2025-2026"}}async function g(U){try{const B=await(await fetch(`/api/student-profile?studentId=${U}`,{headers:o()})).json();if(B.success){const{section:oe}=B.data;return{sectionInfo:oe}}}catch{}return{sectionInfo:null}}async function b(U,X,B){try{const K=await(await fetch(`/api/class-rankings?studentId=${U}&quarter=${X}&schoolYear=${B}`,{headers:o()})).json();if(K.success)return{classRank:K.myRank,totalStudentsInSection:K.totalStudents}}catch{}return{classRank:null,totalStudentsInSection:0}}async function y(U,X,B){try{let oe=X-1,K=B;if(oe<1){oe=4;const[te,Ce]=B.split("-").map(Ae=>parseInt(Ae));K=`${te-1}-${Ce-1}`}const ae=await(await fetch(`/api/student-grades?student_id=${U}&quarter=${oe}&school_year=${K}`,{headers:o()})).json();if(ae.success&&ae.data.statistics)return ae.data.statistics.overallAverage||null}catch{}return null}async function x(U,X=null,B=null,oe=!1){try{r(Ge=>({...Ge,isLoading:!oe,isRefreshing:oe,error:null,currentStudentId:U}));let K;!X||!B?(K=await h(),X=X||K.currentQuarter,B=B||K.currentSchoolYear):K={currentQuarter:X,currentQuarterName:`${X}${X===1?"st":X===2?"nd":X===3?"rd":"th"} Quarter`,currentSchoolYear:B};const[de,ae,te,Ce]=await Promise.all([fetch(`/api/student-grades?student_id=${U}&quarter=${X}&school_year=${B}`,{headers:o()}).then(Ge=>Ge.json()),g(U),b(U,X,B),y(U,X,B)]);if(!de.success)throw new Error(de.error||"Failed to fetch grades data");const Ae=de.data.statistics?.overallAverage||0;let Re=null;Ce!==null&&Ae>0&&(Re=Ae-Ce);const Me={grades:de.data.grades||[],statistics:de.data.statistics||{overallAverage:0,totalSubjects:0},sectionInfo:ae.sectionInfo,classRank:te.classRank,totalStudentsInSection:te.totalStudentsInSection,currentQuarter:X,currentQuarterName:K.currentQuarterName,currentSchoolYear:B,previousQuarterAverage:Ce,averageChange:Re,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString(),currentStudentId:U};r(Ge=>({...Ge,...Me})),m(U,X,B,{grades:Me.grades,statistics:Me.statistics,sectionInfo:Me.sectionInfo,classRank:Me.classRank,totalStudentsInSection:Me.totalStudentsInSection,currentQuarter:X,currentQuarterName:K.currentQuarterName,currentSchoolYear:B,previousQuarterAverage:Me.previousQuarterAverage,averageChange:Me.averageChange,lastUpdated:Me.lastUpdated})}catch(K){const de=u(U,X,B);de?(r(ae=>({...ae,grades:de.grades||[],statistics:de.statistics||{overallAverage:0,totalSubjects:0},sectionInfo:de.sectionInfo,classRank:de.classRank,totalStudentsInSection:de.totalStudentsInSection,currentQuarter:de.currentQuarter,currentQuarterName:de.currentQuarterName,currentSchoolYear:de.currentSchoolYear,previousQuarterAverage:de.previousQuarterAverage,averageChange:de.averageChange,lastUpdated:de.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Fe.error("No internet connection. Showing offline data.")):r(ae=>({...ae,isLoading:!1,isRefreshing:!1,error:K.message,grades:[],statistics:{overallAverage:0,totalSubjects:0},previousQuarterAverage:null,averageChange:null}))}}function A(U,X=null,B=null){let oe;if(t(de=>{oe=de.currentStudentId})(),oe&&oe!==U&&r(de=>({...de,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!X||!B)return h().then(de=>{const ae=f(U,de.currentQuarter,de.currentSchoolYear);r(ae?te=>({...te,...ae,currentStudentId:U,isLoading:!1,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}):te=>({...te,currentStudentId:U,currentQuarter:de.currentQuarter,currentQuarterName:de.currentQuarterName,currentSchoolYear:de.currentSchoolYear,isLoading:!0,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}))}),!1;const K=f(U,X,B);return K?(r(de=>({...de,...K,currentStudentId:U,isLoading:!1,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!0):(r(de=>({...de,currentStudentId:U,currentQuarter:X,currentSchoolYear:B,isLoading:!0,isRefreshing:!1,error:null,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null})),!1)}async function C(U,X,B){const oe=f(U,X,B);oe&&r(K=>({...K,...oe,currentStudentId:U,isLoading:!1,isRefreshing:!1,error:null})),await x(U,X,B,!!oe)}function E(U,X,B){try{const oe=l(U,X,B);localStorage.removeItem(oe)}catch{}return r(oe=>({...s,currentStudentId:U,currentQuarter:X,currentSchoolYear:B,isLoading:!0})),H.loadGrades(U,X,B,!1)}function F(U){try{const X=Object.keys(localStorage),B=`${vc}${U}_`,oe=`${fc}${U}_`;X.forEach(K=>{(K.startsWith(B)||K.startsWith(oe))&&localStorage.removeItem(K)})}catch{}}function S(U,X,B){return`${fc}${U}_${X}_${B}`}function q(U,X,B){try{const oe=S(U,X,B),K=localStorage.getItem(oe);if(K){const de=JSON.parse(K);if(Date.now()-de.timestamp<Rh)return de.data}}catch{}return null}function I(U,X,B,oe){try{const K=S(U,X,B),de={data:oe,timestamp:Date.now()};localStorage.setItem(K,JSON.stringify(de))}catch{}}async function j(U,X,B,oe=!1){try{r(Ae=>({...Ae,aiAnalysisLoading:!0,aiAnalysisError:null}));let K=null,de=X-1,ae=B;if(de<1){de=4;const[Ae,Re]=B.split("-").map(Me=>parseInt(Me));ae=`${Ae-1}-${Re-1}`}if(K={quarter:de,schoolYear:ae},!oe){const Ae=q(U,X,B);if(Ae)return r(Re=>({...Re,aiAnalysis:Ae,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),Ae}const te=new AbortController,Ce=setTimeout(()=>te.abort(),9e4);try{const Ae=await fetch("/api/ai-grade-analysis",{method:"POST",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:U,quarter:X,schoolYear:B,forceRefresh:oe,previousQuarterInfo:K}),signal:te.signal});if(clearTimeout(Ce),!Ae.ok)throw new Error("Failed to fetch AI analysis");const Re=Ae.body.getReader(),Me=new TextDecoder;let Ge="";for(;;){const{value:ke,done:Ve}=await Re.read();if(Ve)break;Ge+=Me.decode(ke,{stream:!0})}const be=JSON.parse(Ge);if(!be||!be.overallInsight)throw new Error("Invalid analysis data structure");return I(U,X,B,be),r(ke=>({...ke,aiAnalysis:be,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),be}catch(Ae){throw clearTimeout(Ce),Ae.name==="AbortError"?new Error("AI analysis is taking longer than expected. Please try again."):Ae}}catch(K){const de=q(U,X,B);if(de)return r(ae=>({...ae,aiAnalysis:de,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:Date.now()})),de;throw r(ae=>({...ae,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:K.message,aiAnalysisTimestamp:null})),K}}function M(){r(U=>({...U,aiAnalysis:null,aiAnalysisLoading:!1,aiAnalysisError:null,aiAnalysisTimestamp:null}))}function Z(U,X,B){const oe=q(U,X,B);return oe?(r(K=>({...K,aiAnalysis:oe,aiAnalysisTimestamp:Date.now()})),!0):!1}async function Q(U,X,B){const oe=[1,2,3,4].filter(K=>K!==X);r(K=>({...K,isPreloading:!0,preloadProgress:{current:0,total:oe.length}}));for(let K=0;K<oe.length;K++){const de=oe[K];try{if(f(U,de,B)){r(ke=>({...ke,preloadProgress:{current:K+1,total:oe.length}}));continue}const te=`${de}${de===1?"st":de===2?"nd":de===3?"rd":"th"} Quarter`,[Ce,Ae,Re,Me]=await Promise.all([fetch(`/api/student-grades?student_id=${U}&quarter=${de}&school_year=${B}`,{headers:o()}).then(ke=>ke.json()),g(U),b(U,de,B),y(U,de,B)]);if(!Ce.success){r(ke=>({...ke,preloadProgress:{current:K+1,total:oe.length}}));continue}const Ge=Ce.data.statistics?.overallAverage||0;let be=null;Me!==null&&Ge>0&&(be=Ge-Me),m(U,de,B,{grades:Ce.data.grades||[],statistics:Ce.data.statistics||{overallAverage:0,totalSubjects:0},sectionInfo:Ae.sectionInfo,classRank:Re.classRank,totalStudentsInSection:Re.totalStudentsInSection,currentQuarter:de,currentQuarterName:te,currentSchoolYear:B,previousQuarterAverage:Me,averageChange:be,lastUpdated:new Date().toISOString()}),r(ke=>({...ke,preloadProgress:{current:K+1,total:oe.length}})),await new Promise(ke=>setTimeout(ke,500))}catch{r(te=>({...te,preloadProgress:{current:K+1,total:oe.length}}))}}r(K=>({...K,isPreloading:!1,preloadProgress:{current:0,total:0}}))}async function W(U,X,B){const oe=[1,2,3,4].filter(K=>K!==X);for(const K of oe)try{if(q(U,K,B))continue;const ae=f(U,K,B);if(!(ae&&ae.grades&&ae.grades.length>0))continue;let Ce=K-1,Ae=B;if(Ce<1){Ce=4;const[be,ke]=B.split("-").map(Ve=>parseInt(Ve));Ae=`${be-1}-${ke-1}`}const Re={quarter:Ce,schoolYear:Ae},Me=new AbortController,Ge=setTimeout(()=>Me.abort(),3e4);try{const be=await fetch("/api/ai-grade-analysis",{method:"POST",headers:{"Content-Type":"application/json",...o()},body:JSON.stringify({studentId:U,quarter:K,schoolYear:B,forceRefresh:!1,previousQuarterInfo:Re,cacheOnly:!0}),signal:Me.signal});if(clearTimeout(Ge),!be.ok)continue;const ke=be.body.getReader(),Ve=new TextDecoder;let it="";for(;;){const{value:He,done:Ne}=await ke.read();if(Ne)break;it+=Ve.decode(He,{stream:!0})}const Be=JSON.parse(it);Be&&Be.overallInsight&&I(U,K,B,Be),await new Promise(He=>setTimeout(He,500))}catch{clearTimeout(Ge)}}catch{}}const H={subscribe:t,init:A,loadGrades:x,changeQuarter:C,forceRefresh:E,clearAllCache:F,getCachedData:(U,X,B)=>u(U,X,B),loadAiAnalysis:j,clearAiAnalysis:M,initAiAnalysis:Z,getCachedAiAnalysis:(U,X,B)=>q(U,X,B),preloadAllQuarters:Q,preloadAllAiAnalysis:W};return H}const pr=jh();function Oh(s,t){d(t,!e(t))}function qh(s,t){d(t,s.touches[0].clientX,!0)}function Gh(s,t){d(t,s.touches[0].clientX,!0)}function Vh(s,t,a,r){if(!e(t)||!e(a))return;const o=e(t)-e(a);Math.abs(o)>50&&(o>0?d(r,(e(r)+1)%3):d(r,(e(r)-1+3)%3)),d(t,0),d(a,0)}function Bh(s,t){d(t,s.touches[0].clientX,!0)}function zh(s,t){d(t,s.touches[0].clientX,!0)}function Wh(s,t,a,r,o){if(!e(t)||!e(a))return;const l=e(t)-e(a);Math.abs(l)>50&&(l>0?d(r,(e(r)+1)%e(o).length):d(r,(e(r)-1+e(o).length)%e(o).length)),d(t,0),d(a,0)}async function Hh(s,t){try{await t(!0),Fe.success("Analysis refreshed successfully")}catch{}}var Uh=(s,t,a)=>t(e(a)),Yh=_("<button> </button>"),Qh=_('<div class="dropdown-menu-quarter"></div>'),Kh=_('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Jh=_('<div class="performance-subtitle"> </div>'),Xh=_('<div class="grade-comparison no-grades"><span class="material-symbols-outlined comparison-icon">pending</span> <span class="comparison-text">No Grades Yet</span></div>'),Zh=_('<div><span class="material-symbols-outlined comparison-icon"><!></span> <span class="comparison-text"><!> from last quarter</span></div>'),eg=_('<div class="grade-comparison first-quarter"><span class="material-symbols-outlined comparison-icon">rocket_launch</span> <span class="comparison-text"> </span></div>'),tg=_('<span class="badge-text"> </span>'),ag=_('<span class="badge-text"> </span>'),sg=_('<div class="performance-stats"><div style="--stat-index: 0;"><div class="stat-header"><div class="stat-label">Quarter Average</div> <div class="stat-icon"><span class="material-symbols-outlined">star</span></div></div> <div class="grade-stat-value"><!></div> <!></div> <div style="--stat-index: 1;"><div class="stat-header"><div class="stat-label">Total Subjects</div> <div class="stat-icon"><span class="material-symbols-outlined">school</span></div></div> <div class="grade-stat-value"><!></div> <div class="grade-info-badge"><span class="material-symbols-outlined badge-icon">verified</span> <!></div></div> <div style="--stat-index: 2;"><div class="stat-header"><div class="stat-label">Class Rank</div> <div class="stat-icon"><span class="material-symbols-outlined">crown</span></div></div> <div class="grade-stat-value">Rank <!></div> <div class="grade-info-badge"><span class="material-symbols-outlined badge-icon">groups</span> <!></div></div></div>'),rg=(s,t)=>t(0),ig=(s,t)=>t(1),ng=(s,t)=>t(2),og=_('<button class="ai-refresh-btn" title="Refresh analysis"><span class="material-symbols-outlined">refresh</span></button>'),lg=_('<span class="material-symbols-outlined">expand_less</span> <span>Hide Analysis</span>',1),cg=_('<span class="material-symbols-outlined">auto_awesome</span> <span>Get AI Analysis</span>',1),dg=_('<div class="analysis-display-container"><!></div>'),ug=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your grades...</p></div>'),vg=_('<div class="no-subjects"><span class="material-symbols-outlined">school</span> <p> </p> <small>Grades will appear here once they are verified by your teachers</small></div>'),fg=(s,t,a)=>t(e(a)),pg=(s,t,a)=>s.key==="Enter"&&t(e(a)),mg=_('<div class="progress-fill progress-fill-animated"></div>'),hg=_("<span> </span>"),gg=_('<span class="unverified-indicator" title="Grade not yet verified">*</span>'),_g=_("<!> <!>",1),bg=_('<div><div class="subject-card clickable" role="button" tabindex="0"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p> </p> <div class="progress-bar"><!></div></div> <div class="grade-column"><div class="grade-large"><!></div> <div> </div></div></div></div>'),yg=_('<div class="subjects-grid"></div>'),wg=_("<button></button>"),xg=_('<div class="mobile-subject-pagination"></div>'),Sg=_("<!> <!>",1),kg=_('<div class="performance-card"><div class="performance-header"><div class="performance-title-section"><div class="performance-title-content"><h2 class="performance-title">Academic Performance</h2> <!></div> <button class="refresh-data-btn" title="Refresh data from database"><span class="material-symbols-outlined">refresh</span></button></div></div> <!> <div class="mobile-stat-pagination"><button aria-label="Go to quarter average"></button> <button aria-label="Go to total subjects"></button> <button aria-label="Go to class rank"></button></div></div> <div class="ai-analysis-section"><div class="analysis-section-header"><div class="analysis-title-group"><span class="material-symbols-outlined">psychology</span> <h2 class="section-title">AI Performance Insights</h2></div> <div class="analysis-controls"><!> <button><!></button></div></div> <!></div> <div class="subjects-section"><h2 class="section-title">Subject Performance</h2> <!></div>',1),Dg=_('<div class="grades-container"><div class="grades-header"><div class="header-content"><h1 class="page-title">My Grades</h1> <p class="page-subtitle">Performance Overview</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function Ag(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(pr,"$studentGradeStore",a),l=()=>Ja(ws,"$authStore",a);let c=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],u=at(!1),f=at(!1),m=null,h=at(0),g=at(0),b=at(0),y=at(0),x=at(0),A=at(0),C=Lt(()=>o().aiAnalysis),E=Lt(()=>o().aiAnalysisLoading),F=Lt(()=>o().aiAnalysisError);Ss(()=>{l().userData?.id&&(m&&m!==l().userData.id&&d(f,!1),m=l().userData.id)});let S=at(Os({})),q=at(Os({})),I=Lt(()=>o().grades),j=Lt(()=>e(I)),M=Lt(()=>o().statistics),Z=Lt(()=>e(M).overallAverage),Q=Lt(()=>e(M).totalSubjects),W=Lt(()=>o().sectionInfo),H=Lt(()=>o().classRank),U=Lt(()=>o().totalStudentsInSection),X=Lt(()=>o().currentQuarter),B=Lt(()=>o().currentQuarterName),oe=Lt(()=>o().currentSchoolYear),K=Lt(()=>o().isLoading),de=Lt(()=>o().error),ae=Lt(()=>o().averageChange);const te={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};Ss(()=>{e(I)&&e(I).length>0&&e(I).some(D=>D.numericGrade>0&&D.teacher!=="No teacher"&&D.verified&&!e(S)[D.id])&&(e(I).forEach(D=>{D.numericGrade>0&&D.teacher!=="No teacher"&&D.verified&&(e(S)[D.id]||(e(S)[D.id]=Re(65)))}),d(S,{...e(S)},!0),setTimeout(()=>{e(I).forEach(D=>{D.numericGrade>0&&D.teacher!=="No teacher"&&D.verified&&Me(D.id,D.numericGrade)})},100))});async function Ce(N){d(u,!1),pr.clearAiAnalysis(),d(f,!1),d(y,0),Object.values(e(q)).forEach(L=>{L&&cancelAnimationFrame(L)}),d(q,{},!0),d(S,{},!0);const D=te[N];l().userData?.id&&await pr.changeQuarter(l().userData.id,D,e(oe))}function Ae(N){e(u)&&!N.target.closest(".custom-dropdown")&&d(u,!1)}function Re(N){return N===0||N===null||N===void 0?"var(--grade-no-grade)":N>=85?"var(--grade-excellent)":N>=80?"var(--grade-good)":N>=75?"var(--grade-satisfactory)":(N>=65||N<65,"var(--grade-needs-improvement)")}function Me(N,D,L=2500){e(q)[N]&&cancelAnimationFrame(e(q)[N]);const z=Date.now();function ve(){const $e=Date.now()-z,he=Math.min($e/L,1);let qe=0;D>=85?qe=3:D>=80?qe=2:D>=75?qe=1:qe=0;const et=Math.min(he*1.6,1),Le=Math.min(Math.floor(et*(qe+1)),qe),st=[65,75,80,85][Le];e(S)[N]=Re(st),d(S,{...e(S)},!0),he<1?e(q)[N]=requestAnimationFrame(ve):(e(S)[N]=Re(D),d(S,{...e(S)},!0),delete e(q)[N])}ve()}function Ge(N,D,L,z){return!D||!L||!z?"N/A":N>0?be(N):"N/A"}function be(N){return N==null||N===0?"N/A":N%1===0?N.toString():N.toFixed(1)}function ke(N,D,L,z){return!D||!L||!z||N===0?0:Math.min(N/100*100,100)}function Ve(N){const D=["blue","green","purple","yellow","orange","red","teal","indigo","pink","cyan","lime","amber","deeporange"];return D[N%D.length]}function it(N){const D=Ve(N);return{border:`var(--subject-card-${D}-border)`,text:`var(--subject-card-${D}-text)`,icon:`var(--subject-card-${D}-icon)`}}function Be(N){return N>=85?"Excellent":N>=80?"Good":N>=75?"Satisfactory":N>=65?"Needs Improvement":"No Grade"}function He(N){return N>=90?"Keep it up!":N>=85?"Maintain the momentum!":N>=80?"Push for higher!":N>=75?"Aim higher next quarter!":"Work harder next quarter!"}function Ne(N){d(h,N,!0)}function Je(N){d(y,N,!0)}function lt(N){return!N||N.length===0?{verified:0,total:0}:{verified:N.filter(L=>L.verified&&L.numericGrade>0&&L.teacher!=="No teacher").length,total:N.length}}let Pe=Lt(()=>e(X)&&e(I)?lt(e(I)):{verified:0,total:0}),we=Lt(()=>e(X)||0);async function tt(N=!1){if(!(e(E)||!e(j).length||!l().userData?.id)){d(f,!0);try{const D=te[e(B)];await pr.loadAiAnalysis(l().userData.id,D,e(oe),N),N||Fe.success("AI Analysis generated successfully")}catch{Fe.error("Failed to generate AI analysis")}}}function ct(){if(!e(f)&&!e(C)){const N=l().userData?.id,D=te[e(B)];N&&(pr.initAiAnalysis(N,D,e(oe))?d(f,!0):tt())}else d(f,!e(f))}function xe(N){Rd.open(N,e(B),e(oe))}Ua(async()=>{if(l().userData?.id){const N=pr.init(l().userData.id);await pr.loadGrades(l().userData.id,null,null,N),setTimeout(async()=>{try{const D=o().currentQuarter,L=o().currentSchoolYear;await pr.preloadAllQuarters(l().userData.id,D,L)}catch{}},1e3)}return()=>{Object.values(e(q)).forEach(N=>{N&&cancelAnimationFrame(N)})}});var Se=Dg();De("click",tr,Ae);var We=n(Se),Ze=v(n(We),2),ee=n(Ze),ue=n(ee);ue.__click=[Oh,u];var fe=v(n(ue),2),T=n(fe,!0);i(fe);var P=v(fe,2);let le;i(ue);var R=v(ue,2);{var G=N=>{var D=Qh();Tt(D,21,()=>c,Ha,(L,z)=>{var ve=Yh();let se;ve.__click=[Uh,Ce,z];var $e=n(ve,!0);i(ve),O(he=>{se=ge(ve,1,"dropdown-item-quarter",null,se,he),w($e,e(z))},[()=>({active:e(z)===e(B)})]),p(L,ve)}),i(D),p(N,D)};$(R,N=>{e(u)&&N(G)})}i(ee),i(Ze),i(We);var ie=v(We,2);{var _e=N=>{var D=Kh(),L=v(n(D),2),z=n(L);i(L);var ve=v(L,2);ve.__click=()=>pr.loadGrades(l().userData.id),i(D),O(()=>w(z,`Error: ${e(de)??""}`)),p(N,D)},Y=N=>{var D=kg(),L=Ue(D),z=n(L),ve=n(z),se=n(ve),$e=v(n(se),2);{var he=rt=>{var vt=Jh(),Rt=n(vt);i(vt),O(()=>w(Rt,`Grade ${e(W).gradeLevel??""}  ${e(W).name??""}`)),p(rt,vt)};$($e,rt=>{e(W)&&rt(he)})}i(se);var qe=v(se,2);qe.__click=()=>pr.forceRefresh(l().userData.id,e(X),e(oe)),i(ve),i(z);var et=v(z,2);Ms(et,()=>`stats-${e(X)}-${e(oe)}`,rt=>{var vt=sg();vt.__touchstart=[qh,g],vt.__touchmove=[Gh,b],vt.__touchend=[Vh,g,b,h];var Rt=n(vt);let Zt;var ma=v(n(Rt),2),ft=n(ma);Ms(ft,()=>`${e(X)}-${e(oe)}`,Et=>{Jr(Et,{get value(){return e(Z)},decimals:1,duration:2.5,colorTransition:!0,getGradeColor:Re})}),i(ma);var ut=v(ma,2);Ms(ut,()=>`${e(X)}-${e(oe)}`,Et=>{var qt=mt(),Jt=Ue(qt);{var va=ya=>{var wa=Xh();p(ya,wa)},la=ya=>{var wa=mt(),Ea=Ue(wa);{var Aa=Ra=>{var $a=Zh();let ha;var fa=n($a),ne=n(fa);{var Ee=pa=>{var oa=_a("trending_up");p(pa,oa)},nt=pa=>{var oa=mt(),ga=Ue(oa);{var xa=Xt=>{var ba=_a("trending_down");p(Xt,ba)},ta=Xt=>{var ba=_a("trending_flat");p(Xt,ba)};$(ga,Xt=>{e(ae)<0?Xt(xa):Xt(ta,!1)},!0)}p(pa,oa)};$(ne,pa=>{e(ae)>0?pa(Ee):pa(nt,!1)})}i(fa);var Ct=v(fa,2),Qt=n(Ct);{var Ot=pa=>{var oa=_a();O(ga=>w(oa,`+${ga??""}`),[()=>e(ae).toFixed(1)]),p(pa,oa)},At=pa=>{var oa=mt(),ga=Ue(oa);{var xa=Xt=>{var ba=_a();O(Ca=>w(ba,Ca),[()=>e(ae).toFixed(1)]),p(Xt,ba)},ta=Xt=>{var ba=_a("No change");p(Xt,ba)};$(ga,Xt=>{e(ae)<0?Xt(xa):Xt(ta,!1)},!0)}p(pa,oa)};$(Qt,pa=>{e(ae)>0?pa(Ot):pa(At,!1)})}zt(),i(Ct),i($a),O(pa=>ha=ge($a,1,"grade-comparison",null,ha,pa),[()=>({positive:e(ae)>0,negative:e(ae)<0,neutral:e(ae)===0})]),p(Ra,$a)},ja=Ra=>{var $a=mt(),ha=Ue($a);{var fa=ne=>{var Ee=eg(),nt=v(n(Ee),2),Ct=n(nt,!0);i(nt),i(Ee),O(Qt=>w(Ct,Qt),[()=>He(e(Z))]),p(ne,Ee)};$(ha,ne=>{e(X)===1&&e(Z)>0&&ne(fa)},!0)}p(Ra,$a)};$(Ea,Ra=>{e(ae)!==null?Ra(Aa):Ra(ja,!1)},!0)}p(ya,wa)};$(Jt,ya=>{e(Z)===0?ya(va):ya(la,!1)})}p(Et,qt)}),i(Rt);var me=v(Rt,2);let re;var J=v(n(me),2),je=n(J);Ms(je,()=>`${e(X)}-${e(oe)}`,Et=>{Jr(Et,{get value(){return e(Q)},decimals:0,duration:2})}),i(J);var Ie=v(J,2),ot=v(n(Ie),2);Ms(ot,()=>`${e(X)}-${e(oe)}`,Et=>{var qt=tg(),Jt=n(qt);i(qt),O(()=>w(Jt,`${e(Pe).verified??""}/${e(Pe).total??""} Verified Grades`)),p(Et,qt)}),i(Ie),i(me);var Xe=v(me,2);let Mt;var na=v(n(Xe),2),gt=v(n(na));Ms(gt,()=>`${e(X)}-${e(oe)}`,Et=>{Jr(Et,{get value(){return e(H)},decimals:0,duration:2})}),i(na);var Oe=v(na,2),bt=v(n(Oe),2);Ms(bt,()=>`${e(X)}-${e(oe)}`,Et=>{var qt=ag(),Jt=n(qt);i(qt),O(()=>w(Jt,`Out of ${e(U)??""} Students`)),p(Et,qt)}),i(Oe),i(Xe),i(vt),O((Et,qt,Jt)=>{Ya(vt,`--current-page: ${e(h)??""};`),Zt=ge(Rt,1,"grade-stat-item primary",null,Zt,Et),re=ge(me,1,"grade-stat-item secondary",null,re,qt),Mt=ge(Xe,1,"grade-stat-item tertiary",null,Mt,Jt)},[()=>({"mobile-active":e(h)===0}),()=>({"mobile-active":e(h)===1}),()=>({"mobile-active":e(h)===2})]),p(rt,vt)});var Le=v(et,2),Qe=n(Le);let st;Qe.__click=[rg,Ne];var ht=v(Qe,2);let _t;ht.__click=[ig,Ne];var xt=v(ht,2);let wt;xt.__click=[ng,Ne],i(Le),i(L);var St=v(L,2),$t=n(St),Nt=v(n($t),2),Ut=n(Nt);{var kt=rt=>{var vt=og();vt.__click=[Hh,tt],p(rt,vt)};$(Ut,rt=>{e(C)&&!e(E)&&rt(kt)})}var jt=v(Ut,2);let Wt;jt.__click=ct;var Kt=n(jt);{var aa=rt=>{var vt=lg();zt(2),p(rt,vt)},Yt=rt=>{var vt=cg();zt(2),p(rt,vt)};$(Kt,rt=>{e(f)?rt(aa):rt(Yt,!1)})}i(jt),i(Nt),i($t);var pe=v($t,2);{var Ke=rt=>{var vt=dg(),Rt=n(vt);Mh(Rt,{get analysisData(){return e(C)},get isLoading(){return e(E)},get error(){return e(F)},get subjects(){return e(I)}}),i(vt),p(rt,vt)};$(pe,rt=>{e(f)&&rt(Ke)})}i(St);var yt=v(St,2),Te=v(n(yt),2);{var ze=rt=>{var vt=ug();p(rt,vt)},dt=rt=>{var vt=mt(),Rt=Ue(vt);{var Zt=ft=>{var ut=vg(),me=v(n(ut),2),re=n(me);i(me),zt(2),i(ut),O(()=>w(re,`No subjects found for ${e(B)??""}`)),p(ft,ut)},ma=ft=>{var ut=Sg(),me=Ue(ut);Ms(me,()=>e(we),je=>{var Ie=yg();Ie.__touchstart=[Bh,x],Ie.__touchmove=[zh,A],Ie.__touchend=[Wh,x,A,y,j],Tt(Ie,23,()=>e(j),ot=>ot.subject_id||ot.id,(ot,Xe,Mt)=>{const na=Lt(()=>it(e(Mt)));var gt=bg();let Oe;var bt=n(gt);bt.__click=[fg,xe,Xe],bt.__keydown=[pg,xe,Xe];var Et=n(bt),qt=n(Et);i(Et);var Jt=v(Et,2),va=n(Jt),la=n(va,!0);i(va);var ya=v(va,2);let wa;var Ea=n(ya,!0);i(ya);var Aa=v(ya,2),ja=n(Aa);Ms(ja,()=>`${e(Xe).id}-${e(X)}-${e(oe)}`,Ee=>{var nt=mt(),Ct=Ue(nt);{var Qt=Ot=>{var At=mg();O((pa,oa)=>Ya(At,`width: ${pa??""}%; background-color: ${oa??""}`),[()=>ke(e(Xe).numericGrade,e(Xe).teacher!=="No teacher",e(Xe).numericGrade>0,e(Xe).verified),()=>e(S)[e(Xe).id]||Re(e(Xe).numericGrade)]),p(Ot,At)};$(Ct,Ot=>{ke(e(Xe).numericGrade,e(Xe).teacher!=="No teacher",e(Xe).numericGrade>0,e(Xe).verified)>0&&Ot(Qt)})}p(Ee,nt)}),i(Aa),i(Jt);var Ra=v(Jt,2),$a=n(Ra),ha=n($a);Ms(ha,()=>`${e(Xe).id}-${e(X)}`,Ee=>{var nt=_g(),Ct=Ue(nt);{var Qt=oa=>{Jr(oa,{get value(){return e(Xe).numericGrade},decimals:1,duration:2.5,colorTransition:!0,getGradeColor:Re})},Ot=oa=>{var ga=hg(),xa=n(ga,!0);i(ga),O((ta,Xt)=>{Ya(ga,`color: ${ta??""}`),w(xa,Xt)},[()=>Re(e(Xe).numericGrade),()=>Ge(e(Xe).numericGrade,e(Xe).teacher!=="No teacher",e(Xe).numericGrade>0,e(Xe).verified)]),p(oa,ga)};$(Ct,oa=>{e(Xe).numericGrade>0&&e(Xe).teacher!=="No teacher"&&e(Xe).verified?oa(Qt):oa(Ot,!1)})}var At=v(Ct,2);{var pa=oa=>{var ga=gg();p(oa,ga)};$(At,oa=>{e(Xe).numericGrade>0&&!e(Xe).verified&&oa(pa)})}p(Ee,nt)}),i($a);var fa=v($a,2),ne=n(fa,!0);i(fa),i(Ra),i(bt),i(gt),O((Ee,nt,Ct,Qt)=>{Oe=ge(gt,1,"subject-accordion",null,Oe,Ee),Ya(gt,`--card-index: ${e(Mt)??""};`),Ya(bt,`border: 2px solid ${e(na).border??""};`),Ya(qt,`color: ${e(na).icon??""};`),Ya(va,`color: ${e(na).text??""};`),w(la,e(Xe).name),wa=ge(ya,1,"teacher-name",null,wa,nt),w(Ea,e(Xe).teacher),ge(fa,1,`grade-indicator ${Ct??""}`),w(ne,Qt)},[()=>({"mobile-active":e(y)===e(Mt)}),()=>({"no-teacher":e(Xe).teacher==="No teacher"}),()=>Be(e(Xe).numericGrade).color,()=>Be(e(Xe).numericGrade).text]),p(ot,gt)}),i(Ie),O(()=>Ya(Ie,`--current-subject-page: ${e(y)??""};`)),p(je,Ie)});var re=v(me,2);{var J=je=>{var Ie=xg();Tt(Ie,21,()=>e(j),Ha,(ot,Xe,Mt)=>{var na=wg();let gt;na.__click=()=>Je(Mt),Vt(na,"aria-label",`Go to subject ${Mt+1}`),O(Oe=>gt=ge(na,1,"subject-pagination-dot",null,gt,Oe),[()=>({active:e(y)===Mt})]),p(ot,na)}),i(Ie),p(je,Ie)};$(re,je=>{e(j).length>0&&je(J)})}p(ft,ut)};$(Rt,ft=>{e(j).length===0?ft(Zt):ft(ma,!1)},!0)}p(rt,vt)};$(Te,rt=>{e(K)?rt(ze):rt(dt,!1)})}i(yt),O((rt,vt,Rt,Zt)=>{qe.disabled=e(K),st=ge(Qe,1,"stat-pagination-dot",null,st,rt),_t=ge(ht,1,"stat-pagination-dot",null,_t,vt),wt=ge(xt,1,"stat-pagination-dot",null,wt,Rt),Wt=ge(jt,1,"toggle-analysis-btn",null,Wt,Zt),Vt(jt,"title",e(f)?"Hide Analysis":"Get AI Analysis")},[()=>({active:e(h)===0}),()=>({active:e(h)===1}),()=>({active:e(h)===2}),()=>({active:e(f)})]),p(N,D)};$(ie,N=>{e(de)?N(_e):N(Y,!1)})}i(Se),O(N=>{w(T,e(B)),le=ge(P,1,"material-symbols-outlined dropdown-arrow",null,le,N)},[()=>({rotated:e(u)})]),p(s,Se),Ga(),r()}Cs(["click","touchstart","touchmove","touchend","keydown"]);const Cg=300*1e3,pc="student_class_ranking_";function Tg(){const s={myRank:0,totalStudents:0,myAverage:0,sectionInfo:null,rankingsList:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null,currentQuarter:null,currentSchoolYear:null},{subscribe:t,set:a,update:r}=Qs(s);function o(){const g=ho(ws);if(!g?.isAuthenticated||!g.userData)return{};const b={id:g.userData.id,name:g.userData.name,account_number:g.userData.accountNumber,account_type:g.userData.account_type||g.userData.accountType};return{"x-user-info":JSON.stringify(b)}}function l(g,b,y){return`${pc}${g}_${b}_${y}`}function c(g){return!g||!g.timestamp?!1:Date.now()-g.timestamp<Cg}function u(g,b,y){try{const x=l(g,b,y),A=localStorage.getItem(x);if(A)return JSON.parse(A).data}catch(x){console.warn("Failed to retrieve cached class ranking data:",x)}return null}function f(g,b,y){try{const x=l(g,b,y),A=localStorage.getItem(x);if(A){const C=JSON.parse(A);if(c(C))return C.data}}catch(x){console.warn("Failed to retrieve cached class ranking data:",x)}return null}function m(g,b,y,x){try{const A=l(g,b,y),C={data:x,timestamp:Date.now()};localStorage.setItem(A,JSON.stringify(C))}catch(A){console.warn("Failed to cache class ranking data:",A)}}async function h(g,b,y){const x=await fetch(`/api/class-rankings?studentId=${g}&quarter=${b}&schoolYear=${y}`,{headers:o()});if(!x.ok)throw new Error("Failed to load class rankings");return await x.json()}return{subscribe:t,init(g,b,y){const x=f(g,b,y);return x?(r(A=>({...A,...x,currentStudentId:g,currentQuarter:b,currentSchoolYear:y,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(A=>({...A,currentStudentId:g,currentQuarter:b,currentSchoolYear:y,isLoading:!0,isRefreshing:!1,error:null})),!1)},async loadRankings(g,b,y,x=!1){if(!g){console.warn("Student ID is required to load rankings");return}r(A=>({...A,isLoading:A.rankingsList.length===0&&!x,isRefreshing:A.rankingsList.length>0||x,error:null,currentStudentId:g,currentQuarter:b,currentSchoolYear:y}));try{const A=await h(g,b,y),C={myRank:A.myRank||0,totalStudents:A.totalStudents||0,myAverage:A.myAverage||0,sectionInfo:A.sectionInfo||null,rankingsList:A.rankings||[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),currentStudentId:g,currentQuarter:b,currentSchoolYear:y};m(g,b,y,{myRank:C.myRank,totalStudents:C.totalStudents,myAverage:C.myAverage,sectionInfo:C.sectionInfo,rankingsList:C.rankingsList,lastUpdated:C.lastUpdated}),a(C)}catch(A){console.error("Error loading class rankings:",A);const C=u(g,b,y);console.log("Rankings fetch failed, checking cache:",{hasCachedData:!!C,studentId:g,quarter:b,schoolYear:y}),C?(console.log("Using cached rankings data and showing toast"),r(E=>({...E,myRank:C.myRank||0,totalStudents:C.totalStudents||0,myAverage:C.myAverage||0,sectionInfo:C.sectionInfo||null,rankingsList:C.rankingsList||[],lastUpdated:C.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),setTimeout(()=>{Fe.error("No internet connection. Showing offline data.")},100)):(console.log("No cached data available, showing error container"),r(E=>({...E,isLoading:!1,isRefreshing:!1,error:A.message||"Failed to load rankings"})))}},async refresh(){let g;t(y=>{g=y})(),g.currentStudentId&&g.currentQuarter&&g.currentSchoolYear&&await this.loadRankings(g.currentStudentId,g.currentQuarter,g.currentSchoolYear,!0)},reset(){a(s)},clearCache(g,b,y){try{const x=l(g,b,y);localStorage.removeItem(x)}catch(x){console.warn("Failed to clear cache:",x)}},clearAllCache(){try{Object.keys(localStorage).forEach(b=>{b.startsWith(pc)&&localStorage.removeItem(b)})}catch(g){console.warn("Failed to clear all caches:",g)}}}}const mc=Tg();var Eg=_("<button> </button>"),Fg=_('<div class="dropdown-menu-quarter"></div>'),$g=_('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Ng=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading rankings...</p></div>'),Pg=_('<div class="no-rankings"><span class="material-symbols-outlined">leaderboard</span> <p> </p> <small>Rankings will appear here once grades are finalized</small></div>'),Lg=_(`<div class="message-text"><strong>Outstanding!</strong> You're the top student in your class!</div>`),Mg=_(`<div class="message-text"><strong>Excellent work!</strong> You're in 2nd place. Keep pushing for the top!</div>`),Ig=_(`<div class="message-text"><strong>Great job!</strong> You're in 3rd place and in the top tier!</div>`),Rg=_(`<div class="message-text"><strong>Fantastic!</strong> You're in the top 10% of your class!</div>`),jg=_(`<div class="message-text"><strong>Well done!</strong> You're in the top 25% of your class!</div>`),Og=_(`<div class="message-text"><strong>Good work!</strong> You're in the top half of your class!</div>`),qg=_('<div class="message-text"><strong>Keep going!</strong> You have great potential to improve!</div>'),Gg=_('<div><div class="rank-banner-content"><div class="rank-display"><span> </span> <div class="rank-info"><span class="rank-banner-label">Your Rank</span> <div class="rank-banner-value"><span class="rank-number-display"><!></span> <span class="rank-total"> </span></div></div></div> <div class="rank-divider"></div> <div class="rank-message"><!></div></div></div>'),Vg=_('<div><div class="rank-position"><span class="material-symbols-outlined rank-icon"> </span> <span class="rank-number"> </span></div> <div class="student-info"><h3 class="student-name"> </h3> <p class="student-id"> </p></div> <div class="student-average"><span class="average-label">Average</span> <span class="average-value"> </span></div></div>'),Bg=_('<div class="rankings-list"></div>'),zg=_("<!> <!>",1),Wg=_('<div class="rankings-section"><!></div>'),Hg=_('<div class="rankings-container"><div class="rankings-header"><div class="header-content"><h1 class="page-title">Class Rankings</h1> <p class="page-subtitle">Academic Standings</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function Ug(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(pr,"$studentGradeStore",a),l=()=>Ja(mc,"$studentClassRankingStore",a),c=()=>Ja(ws,"$authStore",a),u=V(),f=V(),m=V(),h=V(),g=V(),b=V(),y=V(),x=V(),A=V();let C=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],E=V(!1);const F={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};let S=V(0),q=V(!1),I=V(null);function j(){d(E,!e(E))}function M(Ve){d(E,!1),d(u,Ve)}function Z(Ve){e(E)&&!Ve.target.closest(".custom-dropdown")&&d(E,!1)}function Q(Ve){return Ve===1?"var(--rank-gold)":Ve===2?"var(--rank-silver)":Ve===3?"var(--rank-bronze)":"var(--md-sys-color-on-surface)"}function W(Ve){return Ve<=3?"trophy":"military_tech"}function H(Ve){return Ve===0||Ve===null||Ve===void 0?"var(--grade-no-grade)":Ve>=85?"var(--grade-excellent)":Ve>=80?"var(--grade-good)":Ve>=75?"var(--grade-satisfactory)":(Ve>=65,"var(--grade-needs-improvement)")}async function U(){if(!c().userData?.id)return;const Ve=F[e(u)];await mc.loadRankings(c().userData.id,Ve,e(f))}Ft(()=>o(),()=>{d(u,o().currentQuarterName||"1st Quarter")}),Ft(()=>o(),()=>{d(f,o().currentSchoolYear||"2025-2026")}),Ft(()=>l(),()=>{d(m,l().myRank)}),Ft(()=>l(),()=>{d(h,l().totalStudents)}),Ft(()=>l(),()=>{d(g,l().myAverage)}),Ft(()=>l(),()=>{d(b,l().sectionInfo)}),Ft(()=>l(),()=>{d(y,l().rankingsList)}),Ft(()=>l(),()=>{d(x,l().isLoading||l().isRefreshing)}),Ft(()=>l(),()=>{d(A,l().error)}),Ft(()=>(e(S),e(m)),()=>{mr(S),d(q,!1),e(m)>0&&setTimeout(()=>{d(q,!0)},700)}),Ft(()=>(e(u),c(),e(I)),()=>{e(u)&&c().userData?.id&&(e(I)===null||e(u)!==e(I))&&(d(I,e(u)),U())}),Is(),Ps();var X=Hg();De("click",tr,Z);var B=n(X),oe=v(n(B),2),K=n(oe),de=n(K),ae=v(n(de),2),te=n(ae,!0);i(ae);var Ce=v(ae,2);let Ae;i(de);var Re=v(de,2);{var Me=Ve=>{var it=Fg();Tt(it,5,()=>C,Ha,(Be,He)=>{var Ne=Eg();let Je;var lt=n(Ne,!0);i(Ne),O(Pe=>{Je=ge(Ne,1,"dropdown-item-quarter",null,Je,Pe),w(lt,e(He))},[()=>({active:e(He)===e(u)})]),De("click",Ne,()=>M(e(He))),p(Be,Ne)}),i(it),p(Ve,it)};$(Re,Ve=>{e(E)&&Ve(Me)})}i(K),i(oe),i(B);var Ge=v(B,2);{var be=Ve=>{var it=$g(),Be=v(n(it),2),He=n(Be);i(Be);var Ne=v(Be,2);i(it),O(()=>w(He,`Error: ${e(A)??""}`)),De("click",Ne,U),p(Ve,it)},ke=Ve=>{var it=mt(),Be=Ue(it);{var He=Je=>{var lt=Ng();p(Je,lt)},Ne=Je=>{var lt=Wg(),Pe=n(lt);{var we=ct=>{var xe=Pg(),Se=v(n(xe),2),We=n(Se);i(Se),zt(2),i(xe),O(()=>w(We,`No rankings available for ${e(u)??""}`)),p(ct,xe)},tt=ct=>{var xe=zg(),Se=Ue(xe);Ms(Se,()=>e(S),Ze=>{var ee=Gg();let ue;var fe=n(ee),T=n(fe),P=n(T);let le;var R=n(P,!0);i(P);var G=v(P,2),ie=v(n(G),2),_e=n(ie),Y=n(_e);{var N=qe=>{var et=mt(),Le=Ue(et);Ms(Le,()=>e(m),Qe=>{Jr(Qe,{get value(){return e(m)},get startVal(){return e(h)},duration:1.6,decimals:0})}),p(qe,et)},D=qe=>{var et=_a();O(()=>w(et,e(h))),p(qe,et)};$(Y,qe=>{e(q)?qe(N):qe(D,!1)})}i(_e);var L=v(_e,2),z=n(L);i(L),i(ie),i(G),i(T);var ve=v(T,4),se=n(ve);{var $e=qe=>{var et=Lg();p(qe,et)},he=qe=>{var et=mt(),Le=Ue(et);{var Qe=ht=>{var _t=Mg();p(ht,_t)},st=ht=>{var _t=mt(),xt=Ue(_t);{var wt=$t=>{var Nt=Ig();p($t,Nt)},St=$t=>{var Nt=mt(),Ut=Ue(Nt);{var kt=Wt=>{var Kt=Rg();p(Wt,Kt)},jt=Wt=>{var Kt=mt(),aa=Ue(Kt);{var Yt=Ke=>{var yt=jg();p(Ke,yt)},pe=Ke=>{var yt=mt(),Te=Ue(yt);{var ze=rt=>{var vt=Og();p(rt,vt)},dt=rt=>{var vt=qg();p(rt,vt)};$(Te,rt=>{e(m)<=e(h)*.5?rt(ze):rt(dt,!1)},!0)}p(Ke,yt)};$(aa,Ke=>{e(m)<=e(h)*.25?Ke(Yt):Ke(pe,!1)},!0)}p(Wt,Kt)};$(Ut,Wt=>{e(m)<=e(h)*.1?Wt(kt):Wt(jt,!1)},!0)}p($t,Nt)};$(xt,$t=>{e(m)===3?$t(wt):$t(St,!1)},!0)}p(ht,_t)};$(Le,ht=>{e(m)===2?ht(Qe):ht(st,!1)},!0)}p(qe,et)};$(se,qe=>{e(m)===1?qe($e):qe(he,!1)})}i(ve),i(fe),i(ee),O((qe,et,Le,Qe)=>{ue=ge(ee,1,"student-rank-banner",null,ue,qe),le=ge(P,1,"material-symbols-outlined rank-banner-icon",null,le,et),Ya(P,`color: ${Le??""};`),w(R,Qe),w(z,`/ ${e(h)??""}`)},[()=>({"top-rank":e(m)<=3}),()=>({"show-icon":e(q)}),()=>(e(m),k(()=>Q(e(m)))),()=>(e(m),k(()=>W(e(m))))]),p(Ze,ee)});var We=v(Se,2);Ms(We,()=>e(S),Ze=>{var ee=Bg();Tt(ee,7,()=>e(y),ue=>ue.studentId,(ue,fe,T)=>{var P=Vg();let le;var R=n(P),G=n(R),ie=n(G,!0);i(G);var _e=v(G,2),Y=n(_e,!0);i(_e),i(R);var N=v(R,2),D=n(N),L=n(D,!0);i(D);var z=v(D,2),ve=n(z);i(z),i(N);var se=v(N,2),$e=v(n(se),2),he=n($e,!0);i($e),i(se),i(P),O((qe,et,Le,Qe,st,ht)=>{le=ge(P,1,"ranking-card",null,le,qe),Ya(P,`--card-index: ${e(T)??""};`),Ya(G,`color: ${et??""};`),w(ie,Le),Ya(_e,`color: ${Qe??""};`),w(Y,(e(fe),k(()=>e(fe).rank))),w(L,(e(fe),c(),k(()=>e(fe).studentId===c().userData?.id?"You":e(fe).name))),w(ve,`ID: ${e(fe),k(()=>e(fe).studentNumber)??""}`),Ya($e,`color: ${st??""};`),w(he,ht)},[()=>({"my-rank":e(fe).studentId===c().userData?.id}),()=>(e(fe),k(()=>Q(e(fe).rank))),()=>(e(fe),k(()=>W(e(fe).rank))),()=>(e(fe),k(()=>Q(e(fe).rank))),()=>(e(fe),k(()=>H(e(fe).average))),()=>(e(fe),k(()=>e(fe).average.toFixed(1)))]),p(ue,P)}),i(ee),p(Ze,ee)}),p(ct,xe)};$(Pe,ct=>{e(y),k(()=>e(y).length===0)?ct(we):ct(tt,!1)})}i(lt),p(Je,lt)};$(Be,Je=>{e(x)?Je(He):Je(Ne,!1)},!0)}p(Ve,it)};$(Ge,Ve=>{e(A)?Ve(be):Ve(ke,!1)})}i(X),O(Ve=>{w(te,e(u)),Ae=ge(Ce,1,"material-symbols-outlined dropdown-arrow",null,Ae,Ve)},[()=>({rotated:e(E)})]),De("click",de,j),p(s,X),Ga(),r()}const Yg=300*1e3,Qg="student_schedule_";function hc(){let s;return ws.subscribe(t=>{s=t.userData})(),s?{"x-user-info":JSON.stringify({id:s.id,name:s.name,account_number:s.accountNumber,account_type:s.accountType})}:(console.warn("No user info available for authentication"),{})}function Kg(){const s={scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Qs(s);function o(F){return`${Qg}${F}`}function l(F){return!F||!F.timestamp?!1:Date.now()-F.timestamp<Yg}function c(F){try{const S=o(F),q=localStorage.getItem(S);if(q)return JSON.parse(q).data}catch(S){console.warn("Failed to retrieve cached student schedule data:",S)}return null}function u(F){try{const S=o(F),q=localStorage.getItem(S);if(q){const I=JSON.parse(q);if(l(I))return I.data}}catch(S){console.warn("Failed to retrieve cached student schedule data:",S)}return null}function f(F,S){try{const q=o(F),I={data:S,timestamp:Date.now()};localStorage.setItem(q,JSON.stringify(I))}catch(q){console.warn("Failed to cache student schedule data:",q)}}const m={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},h=["blue","green","purple","yellow","orange"];function g(F){return h[F%h.length]}function b(F){const[S,q]=F.split(":"),I=parseInt(S),j=I>=12?"PM":"AM";return`${(I===0?12:I>12?I-12:I).toString().padStart(2,"0")}:${q} ${j}`}function y(F){const S={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},q={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return F.forEach(I=>{const j=m[I.day_of_week.toLowerCase()];if(j){const M=b(I.start_time),Z=b(I.end_time);let Q,W;I.schedule_type==="subject"?(Q=I.subject_name||"Unknown Subject",W=I.teacher_name||"No Teacher Assigned"):I.schedule_type==="activity"&&(Q=I.activity_type_name||"Activity",W=I.teacher_name||"");const H={name:Q,time:`${M} - ${Z}`,room:I.room_name||"TBA",teacher:W,scheduleType:I.schedule_type,color:g(q[j])};S[j].push(H),q[j]++}}),S}async function x(F,S=!1){try{r(W=>({...W,isLoading:!S,isRefreshing:S,error:null,currentStudentId:F}));const j=(await(await fetch("/api/current-quarter",{headers:hc()})).json()).data?.currentSchoolYear||"2025-2026",Z=await(await fetch(`/api/schedules?action=student-schedules&studentId=${F}&schoolYear=${j}`,{headers:hc()})).json();if(!Z.success)throw new Error(Z.error||"Failed to fetch schedule data");const Q=y(Z.data);r(W=>({...W,scheduleData:Q,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),f(F,{scheduleData:Q,lastUpdated:new Date().toISOString()})}catch(q){console.error("Error loading student schedule:",q);const I=c(F);I?(r(j=>({...j,isLoading:!1,isRefreshing:!1,error:null,scheduleData:I.scheduleData||{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},lastUpdated:I.lastUpdated})),Fe.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:q.message,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}}))}}function A(F){const S=u(F);return S?(r(q=>({...q,...S,currentStudentId:F,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(q=>({...q,currentStudentId:F,isLoading:!0,isRefreshing:!1,error:null})),!1)}function C(F){try{const S=o(F);localStorage.removeItem(S)}catch(S){console.warn("Failed to clear student schedule cache:",S)}return r(S=>({...s,currentStudentId:F,isLoading:!0})),E.loadSchedule(F,!1)}const E={subscribe:t,init:A,loadSchedule:x,forceRefresh:C,getCachedData:F=>c(F)};return E}const Ti=Kg();var Jg=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),Xg=_("<button> </button>"),Zg=_('<div class="schedule-dropdown-menu"></div>'),e_=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),t_=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p>Error Loading Schedule</p> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),a_=_('<div class="class-teacher"><span class="material-symbols-outlined">person_book</span> <span> </span></div>'),s_=_('<div><div class="class-header"><h3 class="class-name"> </h3> <span class="class-time"> </span></div> <div class="class-details"><div class="class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!></div></div>'),r_=_('<div class="classes-list"></div>'),i_=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),n_=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-header"><div class="schedule-header-content"><div class="schedule-header-text"><h1 class="page-title">Schedule</h1> <p class="page-subtitle">Your weekly class schedule</p></div></div></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="day-selector"></div> <div class="schedule-mobile-dropdown"><button class="schedule-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function o_(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(Ti,"$studentScheduleStore",a),l=()=>Ja(ws,"$authStore",a),c=V(),u=V(),f=V(),m=V(),h=V(),g=V(),b=V(),y=V(),x=V(),A=new Date,C=["January","February","March","April","May","June","July","August","September","October","November","December"],E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],F=C[A.getMonth()],S=A.getDate(),q=E[A.getDay()],I={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},j=A.getDay();let M=V(I[j]||"Mon"),Z=V(new Date),Q;async function W(){const ee=l();ee.isAuthenticated&&ee.userData?.id&&await Ti.forceRefresh(ee.userData.id)}Ua(()=>{const ee=l();if(ee.isAuthenticated&&ee.userData?.id){const ue=Ti.init(ee.userData.id);Ti.loadSchedule(ee.userData.id,ue);const fe=setInterval(()=>{const T=l();T.isAuthenticated&&T.userData?.id&&Ti.loadSchedule(T.userData.id,!0)},300*1e3);return Q=setInterval(()=>{d(Z,new Date)},6e4),()=>{clearInterval(fe),clearInterval(Q)}}});const H=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}],U={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"};let X=V(0),B=V(!1);function oe(ee){ee.target.closest(".schedule-mobile-dropdown")||d(B,!1)}function K(){d(B,!e(B))}function de(ee){d(M,ee),d(B,!1)}function ae(ee){if(!e(x)||!ee)return!1;const ue=ee.replace(/\u00A0/g," ").trim(),fe=ue.match(/(.*?)\s*[-]\s*(.*)/);let T,P;if(fe)T=fe[1],P=fe[2];else{const _e=ue.split(" - ");if(_e.length===2)T=_e[0],P=_e[1];else return!1}if(T=T.trim(),P=P.trim(),!T||!P)return!1;const le=te(T),R=te(P),G=e(Z),ie=G.getHours()*60+G.getMinutes();return ie>=le&&ie<R}function te(ee){const ue=ee.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);if(!ue)return 0;let fe=parseInt(ue[1]);const T=parseInt(ue[2]),P=ue[3].toUpperCase();return P==="PM"&&fe!==12&&(fe+=12),P==="AM"&&fe===12&&(fe=0),fe*60+T}Ft(()=>(e(c),e(u),e(f),e(m),e(h),o()),()=>{(ee=>{d(c,ee.scheduleData),d(u,ee.isLoading),d(f,ee.isRefreshing),d(m,ee.error),d(h,ee.lastUpdated)})(o())}),Ft(()=>(e(c),e(M)),()=>{d(g,e(c)[e(M)]||[])}),Ft(()=>e(M),()=>{d(b,U[e(M)]||"Monday")}),Ft(()=>e(Z),()=>{d(y,I[e(Z).getDay()])}),Ft(()=>(e(y),e(M)),()=>{d(x,e(y)===e(M))}),Ft(()=>(e(M),e(X)),()=>{e(M),mr(X)}),Is(),Ps();var Ce=n_(),Ae=v(n(Ce),2),Re=n(Ae),Me=n(Re),Ge=n(Me);i(Me),i(Re);var be=v(Re,2);Tt(be,5,()=>H,Ha,(ee,ue)=>{let fe=()=>e(ue).day;var T=Jg(),P=n(T),le=n(P,!0);i(P);var R=v(P,2),G=n(R,!0);i(R),i(T),O(()=>{ge(T,1,`day-btn ${fe()===e(M)?"active":""}`),w(le,fe()),w(G,(fe(),k(()=>U[fe()])))}),De("click",T,()=>de(fe())),p(ee,T)}),i(be);var ke=v(be,2),Ve=n(ke),it=n(Ve),Be=n(it,!0);i(it);var He=v(it,2);i(Ve);var Ne=v(Ve,2);{var Je=ee=>{var ue=Zg();Tt(ue,5,()=>H,Ha,(fe,T)=>{let P=()=>e(T).day;var le=Xg(),R=n(le,!0);i(le),O(()=>{ge(le,1,`schedule-dropdown-item ${P()===e(M)?"selected":""}`),w(R,(P(),k(()=>U[P()])))}),De("click",le,()=>de(P())),p(fe,le)}),i(ue),p(ee,ue)};$(Ne,ee=>{e(B)&&ee(Je)})}i(ke),i(Ae);var lt=v(Ae,2),Pe=n(lt),we=n(Pe),tt=n(we);i(we);var ct=v(we,2),xe=n(ct);i(ct),i(Pe);var Se=v(Pe,2);{var We=ee=>{var ue=e_();p(ee,ue)},Ze=ee=>{var ue=mt(),fe=Ue(ue);{var T=le=>{var R=t_(),G=v(n(R),4),ie=n(G,!0);i(G);var _e=v(G,2);i(R),O(()=>w(ie,e(m))),De("click",_e,W),p(le,R)},P=le=>{var R=mt(),G=Ue(R);{var ie=Y=>{var N=mt(),D=Ue(N);Ms(D,()=>e(X),L=>{var z=r_();Tt(z,5,()=>e(g),Ha,(ve,se,$e)=>{var he=s_();Ya(he,`--card-index: ${$e};`);var qe=n(he),et=n(qe),Le=n(et,!0);i(et);var Qe=v(et,2),st=n(Qe,!0);i(Qe),i(qe);var ht=v(qe,2),_t=n(ht),xt=v(n(_t),2),wt=n(xt,!0);i(xt),i(_t);var St=v(_t,2);{var $t=Nt=>{var Ut=a_(),kt=v(n(Ut),2),jt=n(kt,!0);i(kt),i(Ut),O(()=>w(jt,(e(se),k(()=>e(se).teacher)))),p(Nt,Ut)};$(St,Nt=>{e(se),k(()=>e(se).teacher)&&Nt($t)})}i(ht),i(he),O(Nt=>{ge(he,1,`class-card ${e(se),k(()=>e(se).color)??""} ${Nt??""}`),w(Le,(e(se),k(()=>e(se).name))),w(st,(e(se),k(()=>e(se).time))),w(wt,(e(se),k(()=>e(se).scheduleType==="activity"?"No room":e(se).room)))},[()=>(e(se),k(()=>ae(e(se).time)?"current":""))]),p(ve,he)}),i(z),p(L,z)}),p(Y,N)},_e=Y=>{var N=i_(),D=v(n(N),4),L=n(D);i(D),i(N),O(()=>w(L,`You don't have any classes scheduled for ${e(b)??""}. Enjoy your free day!`)),p(Y,N)};$(G,Y=>{e(g),k(()=>e(g).length>0)?Y(ie):Y(_e,!1)},!0)}p(le,R)};$(fe,le=>{e(m)?le(T):le(P,!1)},!0)}p(ee,ue)};$(Se,ee=>{e(u)?ee(We):ee(Ze,!1)})}i(lt),i(Ce),O(()=>{w(Ge,`${q??""}, ${F??""} ${S??""}`),w(Be,(e(M),k(()=>U[e(M)]||"Select Day"))),ge(He,1,`material-symbols-outlined schedule-dropdown-icon ${e(B)?"open":""}`),w(tt,`${e(b)??""} Classes`),xe.disabled=e(u)}),De("click",Ve,K),De("click",xe,W),De("click",Ce,oe),De("keydown",Ce,oe),p(s,Ce),Ga(),r()}const l_=300*1e3,c_="student_doc_requests_";function d_(){const s={requestHistory:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Qs(s);function o(F){return`${c_}${F}`}function l(F){return!F||!F.timestamp?!1:Date.now()-F.timestamp<l_}function c(F){try{const S=o(F),q=localStorage.getItem(S);if(q)return JSON.parse(q).data}catch(S){console.warn("Failed to retrieve cached document request data:",S)}return null}function u(F){try{const S=o(F),q=localStorage.getItem(S);if(q){const I=JSON.parse(q);if(l(I))return I.data}}catch(S){console.warn("Failed to retrieve cached document request data:",S)}return null}function f(F,S){try{const q=o(F),I={data:S,timestamp:Date.now()};localStorage.setItem(q,JSON.stringify(I))}catch(q){console.warn("Failed to cache document request data:",q)}}function m(F){return F}async function h(F=!1){try{r(M=>({...M,isLoading:!F,isRefreshing:F,error:null}));const S=await ea.get("/api/document-requests?action=student");if(!S.success)throw new Error(S.error||"Failed to load document requests");const q=S.data.map(M=>({id:M.id,requestId:M.requestId,type:M.documentType,purpose:M.purpose,quantity:M.quantity||1,status:M.status,requestedDate:M.submittedDate,completedDate:M.completedDate,cancelledDate:M.cancelledDate,tentativeDate:M.tentativeDate,payment:M.payment,paymentAmount:M.paymentAmount,paymentStatus:M.paymentStatus||"pending",processedBy:M.processedBy,adminName:M.processedBy,adminNote:M.adminNote,rejectionReason:M.rejectionReason,messages:M.messages||[],lastReadAt:M.lastReadAt||null}));r(M=>({...M,requestHistory:q,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()}));const I={requestHistory:q,lastUpdated:new Date().toISOString()};let j;r(M=>(j=M.currentStudentId,M)),j&&f(j,I)}catch(S){console.error("Error loading document requests:",S);let q;r(j=>(q=j.currentStudentId,j));const I=c(q);I?(r(j=>({...j,requestHistory:I.requestHistory||[],lastUpdated:I.lastUpdated,isLoading:!1,isRefreshing:!1,error:null})),Fe.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:S.message,requestHistory:[]}))}}function g(F){const S=u(F);return S?(r(q=>({...q,...S,currentStudentId:F,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(q=>({...q,currentStudentId:F,isLoading:!0,isRefreshing:!1,error:null})),!1)}async function b(F){try{const S=o(F);localStorage.removeItem(S)}catch(S){console.warn("Failed to clear document request cache:",S)}return r(S=>({...s,currentStudentId:F,isLoading:!0})),await E.loadDocumentRequests(!1)}async function y(F,S,q=1){try{const I=await ea.post("/api/document-requests",{action:"create",documentType:F,purpose:S.trim(),quantity:q,paymentAmount:null,isUrgent:!1});if(!I.success)throw new Error(I.error||"Failed to submit request");return await E.loadDocumentRequests(!1),{success:!0}}catch(I){return console.error("Error submitting document request:",I),{success:!1,error:I.message}}}async function x(F){try{const S=await ea.post("/api/document-requests",{action:"cancel",requestId:F});if(!S.success)throw new Error(S.error||"Failed to cancel request");return await E.loadDocumentRequests(!1),{success:!0}}catch(S){return console.error("Error cancelling document request:",S),{success:!1,error:S.message}}}async function A(F){try{const S=await ea.post("/api/document-requests",{action:"markAsRead",requestId:F});return S.success&&r(q=>({...q,requestHistory:q.requestHistory.map(I=>I.requestId===F?{...I,lastReadAt:S.data.lastReadAt}:I)})),{success:S.success}}catch(S){return console.error("Error marking messages as read:",S),{success:!1,error:S.message}}}async function C(F){try{const S=await ea.get(`/api/document-requests?action=single&requestId=${F}`);if(!S.success)throw new Error(S.error||"Failed to load request details");return{success:!0,data:{...S.data,type:S.data.documentType,quantity:S.data.quantity||1,requestedDate:S.data.submittedDate,paymentAmount:S.data.paymentAmount,paymentStatus:S.data.paymentStatus??"pending"}}}catch(S){return console.error("Error fetching request details:",S),{success:!1,error:S.message}}}const E={subscribe:t,init:g,loadDocumentRequests:h,forceRefresh:b,submitRequest:y,cancelRequest:x,markMessagesAsRead:A,getRequestDetails:C,getCachedData:F=>c(F)};return E}const _r=d_();function gc(s,t,a,r){d(t,!e(t)),e(t)&&e(a).length===0&&d(a,[{role:"assistant",content:"Hi!  I'm here to help you with your document requests. Feel free to ask me anything about the process, statuses, or requirements!",timestamp:new Date}],!0),e(t)&&setTimeout(r,100)}function u_(s,t){localStorage.removeItem("student_chatbot_history"),d(t,[{role:"assistant",content:"Hi!  I'm here to help you with your document requests. Feel free to ask me anything about the process, statuses, or requirements!",timestamp:new Date}],!0)}var v_=_('<span class="sc-badge">AI</span>'),f_=_('<div><div class="sc-message-content"><div class="sc-message-bubble"> </div> <div class="sc-message-time"> </div></div></div>'),p_=_('<div class="sc-message assistant"><div class="sc-message-content"><div class="sc-message-bubble typing"><div class="sc-typing-indicator"><span></span> <span></span> <span></span></div></div></div></div>'),m_=(s,t,a)=>t(e(a)),h_=_('<button class="sc-suggestion-btn"> </button>'),g_=_('<div class="sc-suggestions"><p class="sc-suggestions-title">Try asking:</p> <!></div>'),__=_('<div class="sc-window"><div class="sc-header"><div class="sc-header-content"><span class="material-symbols-outlined">smart_toy</span> <div><h3>Document Assistant</h3> <p>Ask me anything!</p></div></div> <div class="sc-header-actions"><button class="sc-header-btn" title="New Conversation"><span class="material-symbols-outlined">add_comment</span></button> <button class="sc-header-btn" title="Minimize"><span class="material-symbols-outlined">expand_more</span></button></div></div> <div class="sc-messages"><!> <!> <!></div> <div class="sc-input-area"><textarea placeholder="Type your question..." rows="1"></textarea> <button class="sc-send-btn"><span class="material-symbols-outlined">send</span></button></div></div>'),b_=_('<button><span class="material-symbols-outlined"> </span> <!></button> <!>',1);function y_(s,t){qa(t,!0);let a=at(!1),r=at(Os([])),o=at(""),l=at(!1),c=at(null);Ua(()=>{const j=localStorage.getItem("student_chatbot_history");if(j)try{const M=JSON.parse(j);d(r,M.map(Z=>({...Z,timestamp:new Date(Z.timestamp)})),!0)}catch(M){console.error("Failed to parse saved chat",M)}}),Ss(()=>{e(r).length>0&&localStorage.setItem("student_chatbot_history",JSON.stringify(e(r)))});async function u(){if(!e(o).trim()||e(l))return;const j=e(o).trim();d(o,""),d(r,[...e(r),{role:"user",content:j,timestamp:new Date}],!0),setTimeout(m,100),d(l,!0);try{const M=e(r).filter(W=>W.role!=="system").map(W=>({role:W.role,content:W.content})),Q=await(await fetch("/api/ai-chatbot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:M})})).json();Q.success?d(r,[...e(r),{role:"assistant",content:Q.reply,timestamp:new Date}],!0):d(r,[...e(r),{role:"assistant",content:"Sorry, I encountered an error. Please try again later.",timestamp:new Date}],!0)}catch(M){console.error("Chatbot error:",M),d(r,[...e(r),{role:"assistant",content:"Sorry, I couldn't connect to the server. Please check your connection and try again.",timestamp:new Date}],!0)}finally{d(l,!1),setTimeout(m,100)}}function f(j){j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),u())}function m(){e(c)&&(e(c).scrollTop=e(c).scrollHeight)}function h(j){return j.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}const g=["Is the system/chatbot available 24/7?","How long does it take to process my document?","How much is the document fee?"];function b(j){d(o,j,!0),u()}var y=b_(),x=Ue(y);let A;x.__click=[gc,a,r,m];var C=n(x),E=n(C,!0);i(C);var F=v(C,2);{var S=j=>{var M=v_();p(j,M)};$(F,j=>{e(a)||j(S)})}i(x);var q=v(x,2);{var I=j=>{var M=__(),Z=n(M),Q=v(n(Z),2),W=n(Q);W.__click=[u_,r];var H=v(W,2);H.__click=[gc,a,r,m],i(Q),i(Z);var U=v(Z,2),X=n(U);Tt(X,17,()=>e(r),Ha,(Ae,Re)=>{var Me=f_(),Ge=n(Me),be=n(Ge),ke=n(be,!0);i(be);var Ve=v(be,2),it=n(Ve,!0);i(Ve),i(Ge),i(Me),O(Be=>{ge(Me,1,`sc-message ${e(Re).role??""}`),w(ke,e(Re).content),w(it,Be)},[()=>h(e(Re).timestamp)]),p(Ae,Me)});var B=v(X,2);{var oe=Ae=>{var Re=p_();p(Ae,Re)};$(B,Ae=>{e(l)&&Ae(oe)})}var K=v(B,2);{var de=Ae=>{var Re=g_(),Me=v(n(Re),2);Tt(Me,17,()=>g,Ha,(Ge,be)=>{var ke=h_();ke.__click=[m_,b,be];var Ve=n(ke,!0);i(ke),O(()=>w(Ve,e(be))),p(Ge,ke)}),i(Re),p(Ae,Re)};$(K,Ae=>{e(r).length===1&&Ae(de)})}i(U),Us(U,Ae=>d(c,Ae),()=>e(c));var ae=v(U,2),te=n(ae);Oi(te);var Ce=v(te,2);Ce.__click=u,i(ae),i(M),O(Ae=>{te.disabled=e(l),Ce.disabled=Ae},[()=>!e(o).trim()||e(l)]),De("keypress",te,f),ca(te,()=>e(o),Ae=>d(o,Ae)),p(j,M)};$(q,j=>{e(a)&&j(I)})}O(j=>{A=ge(x,1,"sc-toggle",null,A,j),w(E,e(a)?"close":"chat")},[()=>({open:e(a)})]),p(s,y),Ga()}Cs(["click"]);function _c(s,t,a){s.target.closest(".custom-dropdown")||d(t,!1),s.target.closest(".quantity-dropdown")||d(a,!1)}function w_(s,t){d(t,!e(t))}function x_(s,t){d(t,!e(t))}async function S_(s,t,a,r,o,l,c,u){if(!e(t)||!e(a).trim())return;const f=r.find(g=>g.id===e(t))?.name||"N/A",m=!o(e(t)),h=e(l)===0?`<strong style="color: var(--md-sys-color-tertiary);">Free</strong>${m?" (First-time request)":""}`:`<strong>${e(l).toFixed(2)}</strong>${m&&e(c)>1?` (1st copy free, ${e(c)-1} additional charged)`:""}`;ns.confirm("Confirm Document Request",`<p>Please review your document request before submitting:</p>
			<ul style="margin: 12px 0; padding-left: 20px; line-height: 1.8;">
				<li><strong>Document Type:</strong> ${f}</li>
				<li><strong>Quantity:</strong> ${e(c)} ${e(c)===1?"copy":"copies"}</li>
				<li><strong>Total Price:</strong> ${h}</li>
				<li><strong>Purpose:</strong> ${e(a).length>100?e(a).substring(0,100)+"...":e(a)}</li>
			</ul>`,async()=>{await u()},()=>{},{size:"small"})}var k_=(s,t,a,r)=>!e(t)&&a(e(r)),D_=_('<span class="doc-dropdown-item-price on-hold-badge"><span class="material-symbols-outlined">schedule</span></span>'),A_=_('<span class="doc-dropdown-item-price free-price"><span class="free-badge">1st copy FREE</span> <span class="original-price"> </span></span>'),C_=_('<span class="doc-dropdown-item-price"> </span>'),T_=_('<button><div class="doc-dropdown-item-content"><div class="doc-dropdown-item-main"><span class="doc-dropdown-item-name"> </span> <span class="doc-dropdown-item-desc"><!></span></div> <!></div></button>'),E_=_('<div class="dropdown-menu-document"></div>'),F_=(s,t,a)=>t(e(a)),$_=_("<button> </button>"),N_=_('<div class="dropdown-menu-quantity"></div>'),P_=_('<div class="pricing-info"><span class="material-symbols-outlined">info</span> <span> </span></div>'),L_=_(`<div class="pricing-info free-info"><span class="material-symbols-outlined">celebration</span> <span>This is your first request for this document type - it's free!</span></div>`),M_=_('<div class="total-price-section"><div class="total-price-label"><span class="material-symbols-outlined">payments</span> Total Amount</div> <div class="total-price-amount"> </div></div> <!>',1),I_=_('<div class="request-form-section"><div class="form-container"><div class="form-header"><h2 class="form-title">New Document Request</h2> <p class="form-subtitle">Fill out the form below to request a document</p></div> <div class="form-content"><div class="student-form-row"><div class="student form-group"><label class="student-form-label" for="document-type-dropdown"><span class="material-symbols-outlined form-icon">description</span> Document Type</label> <div class="custom-dropdown"><button id="document-type-dropdown" class="dropdown-toggle"><span><!></span> <span>expand_more</span></button> <!></div></div> <div class="form-group"><label class="student-form-label" for="quantity-dropdown"><span class="material-symbols-outlined form-icon">numbers</span> Quantity</label> <div class="quantity-dropdown"><button id="quantity-dropdown" class="dropdown-toggle quantity-toggle"><span> </span> <span>expand_more</span></button> <!></div></div></div> <!> <div class="form-group"><label class="student-form-label" for="description"><span class="material-symbols-outlined form-icon">edit_note</span> Purpose & Details</label> <textarea id="description" class="form-textarea enhanced" placeholder="Please describe the purpose of your request and any specific requirements..." rows="5" maxlength="200"></textarea> <div class="form-help"><span class="material-symbols-outlined help-icon">info</span> Be specific about your needs to help us process your request efficiently <span class="char-counter"> </span></div></div> <div class="document-form-actions"><button class="document-cancel-button">Cancel</button> <button class="submit-button"><!></button></div></div></div></div>'),R_=_('<div class="error-message" style="padding: 20px; background: #fee; border-radius: 8px; color: #c33; margin: 20px 0;"><strong>Error:</strong> </div>'),j_=_('<div class="loading-message"><div class="system-loader"></div> Loading your document requests...</div>'),O_=_('<div class="no-requests-message"><span class="material-symbols-outlined">description</span> <p>No document requests found</p> <p class="subtitle">Start by requesting your first document above</p></div>'),q_=(s,t,a)=>t(e(a)),G_=_('<span class="chat-badge"> </span>'),V_=_('<div class="request-footer completed-footer"><span class="footer-info"> </span></div>'),B_=_("<span> </span>"),z_=_('<div class="request-footer processing-footer"><span class="footer-info"><!> <!></span></div>'),W_=_('<div class="request-footer pending-footer"><span class="footer-info"> </span></div>'),H_=_('<div class="request-footer rejected-footer"><span class="footer-info">Deadline passed without compliance submission</span></div>'),U_=_('<div class="request-footer pending-footer"><span class="footer-info">Awaiting review</span></div>'),Y_=_('<div class="request-footer cancelled-footer"><span class="footer-info"> </span></div>'),Q_=_('<div class="request-footer rejected-footer"><span class="footer-info"> </span></div>'),K_=_('<div><div class="request-main-content"><div class="request-status-icon"><span class="material-symbols-outlined"> </span></div> <div class="request-content"><div class="request-header"><div class="request-info"><h3 class="request-title"> </h3> <p class="request-date"> </p></div> <div class="request-header-actions"><div> </div> <button class="chat-indicator-btn"><span class="material-symbols-outlined">chat_bubble</span> <!></button></div></div></div></div> <!></div>'),J_=_('<div class="request-history-grid"></div>'),X_=_('<div class="document-request-container"><div class="document-header"><div class="header-content"><h1 class="page-title">Document Requests</h1> <p class="page-subtitle">Request new documents or check existing requests</p></div></div> <div class="quick-actions-section"><div class="quick-actions-header"><h2 class="quick-actions-title">Request a Document</h2> <div style="display: flex; gap: 8px;"><button class="request-new-button"><span class="material-symbols-outlined"> </span> <span class="request-new-button-text"> </span></button></div></div></div> <!> <div class="request-history-section"><div class="request-history-header"><h2 class="section-title">Request History</h2> <button class="refresh-button" title="Refresh document requests"><span class="material-symbols-outlined">refresh</span></button></div> <!> <!></div> <!></div>');function Z_(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(_r,"$studentDocumentRequestStore",a),l=()=>Ja(ws,"$authStore",a);let c=Pa(t,"openRequestId",15,null),u=at(!1),f=at(""),m=at(1),h=at(""),g=at(!1),b=at(!1),y=at(!1);const x=Array.from({length:3},(xe,Se)=>Se+1);let A=Lt(()=>{if(!e(f))return 0;const xe=j.find(We=>We.id===e(f));return xe?M(e(f))?xe.price*e(m):xe.price*(e(m)-1):0}),C,E=Lt(()=>o().requestHistory),F=Lt(()=>o().isLoading),S=Lt(()=>o().error);function q(xe){d(f,xe.id,!0),d(b,!1)}function I(xe){d(m,xe,!0),d(y,!1)}const j=[{id:"Transcript of Records",name:"Transcript of Records",description:"Official academic record",price:300},{id:"Enrollment Certificate",name:"Enrollment Certificate",description:"Proof of enrollment",price:150},{id:"Grade Report",name:"Grade Report",description:"Semester grade report",price:50},{id:"Diploma",name:"Diploma",description:"Official graduation certificate",price:800},{id:"Certificate",name:"Certificate",description:"Academic achievement certificate",price:100},{id:"Good Moral",name:"Good Moral",description:"Certificate of good moral character",price:300},{id:"Grade Slip",name:"Grade Slip",description:"Grade slip for specific period",price:170}];function M(xe){return!e(E)||e(E).length===0?!1:e(E).some(Se=>Se.type===xe&&["released","for_pickup","processing","verifying"].includes(Se.status))}function Z(xe){if(!e(E)||e(E).length===0)return!1;const Se=["released","cancelled","rejected"];return e(E).some(We=>We.type===xe&&!Se.includes(We.status))}async function Q(){const xe=l();xe.isAuthenticated&&xe.userData?.id&&await _r.forceRefresh(xe.userData.id)}Ua(()=>{const xe=l();if(xe.isAuthenticated&&xe.userData?.id){const Se=_r.init(xe.userData.id);_r.loadDocumentRequests(Se),C=setInterval(()=>{const We=l();We.isAuthenticated&&We.userData?.id&&_r.loadDocumentRequests(!0)},30*1e3)}}),Ss(()=>{if(c()&&e(E).length>0){const xe=e(E).find(Se=>Se.requestId===c());xe&&K(xe),c(null)}}),ai(()=>{C&&clearInterval(C)});function W(xe){return{on_hold:"On Hold",verifying:"Verifying",for_compliance:"For Compliance",processing:"For Processing",for_pickup:"For Pick Up",released:"Released",non_compliance:"Non-Compliant",rejected:"Rejected",cancelled:"Cancelled"}[xe]||xe}function H(xe){if(!xe)return"N/A";const Se=new Date(xe),We=String(Se.getMonth()+1).padStart(2,"0"),Ze=String(Se.getDate()).padStart(2,"0"),ee=Se.getFullYear();return`${We}/${Ze}/${ee}`}async function U(){if(!(!e(f)||!e(h).trim()))try{d(g,!0);const xe=j.find(We=>We.id===e(f))?.name,Se=await _r.submitRequest(xe||e(f),e(h),e(m));Se.success?(X(),Fe.success("Document request submitted successfully")):Fe.error(Se.error||"Failed to submit request")}catch(xe){console.error("Error submitting request:",xe),Fe.error("Failed to submit document request")}finally{d(g,!1)}}function X(){d(u,!e(u)),e(u)?setTimeout(()=>{const xe=document.querySelector(".request-form-section");xe&&xe.scrollIntoView({behavior:"smooth",block:"center"})},100):(d(f,""),d(m,1),d(h,""),d(b,!1),d(y,!1))}function B(xe){switch(xe){case"on_hold":return"pause_circle";case"verifying":return"fact_check";case"for_compliance":return"assignment_late";case"processing":return"sync";case"for_pickup":return"hand_package";case"released":return"check_circle";case"non_compliance":return"warning";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}function oe(xe){if(!xe.messages||xe.messages.length===0)return 0;if(!xe.lastReadAt)return xe.messages.length;const Se=new Date(xe.lastReadAt).getTime();return xe.messages.filter(We=>new Date(We.created_at).getTime()>Se).length}async function K(xe){try{const Se=await _r.getRequestDetails(xe.requestId);Se.success?(jd.open(Se.data,de,()=>_r.loadDocumentRequests(!1)),await _r.markMessagesAsRead(xe.requestId)):(console.error("Failed to fetch request details:",Se.error),Fe.error("Failed to load request details. Please try again."))}catch(Se){console.error("Error fetching request details:",Se),Fe.error("An error occurred while loading the request details.")}}async function de(xe){try{const Se=await _r.cancelRequest(xe.requestId);Se.success?Fe.success("Document request cancelled successfully"):(console.error("Failed to cancel request:",Se.error),Fe.error(Se.error||"Failed to cancel request"))}catch(Se){console.error("Error cancelling request:",Se),Fe.error("Failed to cancel request")}}var ae=X_();ae.__click=[_c,b,y],ae.__keydown=[_c,b,y];var te=v(n(ae),2),Ce=n(te),Ae=v(n(Ce),2),Re=n(Ae);Re.__click=X;var Me=n(Re),Ge=n(Me,!0);i(Me);var be=v(Me,2),ke=n(be,!0);i(be),i(Re),i(Ae),i(Ce),i(te);var Ve=v(te,2);{var it=xe=>{var Se=I_(),We=n(Se),Ze=v(n(We),2),ee=n(Ze),ue=n(ee),fe=v(n(ue),2),T=n(fe);T.__click=[w_,b];var P=n(T),le=n(P);{var R=kt=>{var jt=_a();O(Wt=>w(jt,Wt),[()=>j.find(Wt=>Wt.id===e(f))?.name||"Select Document Type"]),p(kt,jt)},G=kt=>{var jt=_a("Choose the document");p(kt,jt)};$(le,kt=>{e(f)?kt(R):kt(G,!1)})}i(P);var ie=v(P,2);i(T);var _e=v(T,2);{var Y=kt=>{var jt=E_();Tt(jt,21,()=>j,Ha,(Wt,Kt)=>{const aa=Lt(()=>Z(e(Kt).id));var Yt=T_();Yt.__click=[k_,aa,q,Kt];var pe=n(Yt),Ke=n(pe),yt=n(Ke),Te=n(yt,!0);i(yt);var ze=v(yt,2),dt=n(ze);{var rt=ft=>{var ut=_a("Request in progress");p(ft,ut)},vt=ft=>{var ut=_a();O(()=>w(ut,e(Kt).description)),p(ft,ut)};$(dt,ft=>{e(aa)?ft(rt):ft(vt,!1)})}i(ze),i(Ke);var Rt=v(Ke,2);{var Zt=ft=>{var ut=D_();p(ft,ut)},ma=ft=>{var ut=mt(),me=Ue(ut);{var re=je=>{var Ie=A_(),ot=v(n(Ie),2),Xe=n(ot);i(ot),i(Ie),O(Mt=>w(Xe,`${Mt??""}/copy`),[()=>e(Kt).price.toFixed(2)]),p(je,Ie)},J=je=>{var Ie=C_(),ot=n(Ie);i(Ie),O(Xe=>w(ot,`${Xe??""}`),[()=>e(Kt).price.toFixed(2)]),p(je,Ie)};$(me,je=>{M(e(Kt).id)?je(J,!1):je(re)},!0)}p(ft,ut)};$(Rt,ft=>{e(aa)?ft(Zt):ft(ma,!1)})}i(pe),i(Yt),O(()=>{ge(Yt,1,`doc-dropdown-item ${e(Kt).id===e(f)?"selected":""} ${e(aa)?"disabled":""}`),Yt.disabled=e(aa),w(Te,e(Kt).name)}),p(Wt,Yt)}),i(jt),p(kt,jt)};$(_e,kt=>{e(b)&&kt(Y)})}i(fe),i(ue);var N=v(ue,2),D=v(n(N),2),L=n(D);L.__click=[x_,y];var z=n(L),ve=n(z);i(z);var se=v(z,2);i(L);var $e=v(L,2);{var he=kt=>{var jt=N_();Tt(jt,21,()=>x,Ha,(Wt,Kt)=>{var aa=$_();aa.__click=[F_,I,Kt];var Yt=n(aa);i(aa),O(()=>{ge(aa,1,`quantity-dropdown-item ${e(Kt)===e(m)?"selected":""}`),w(Yt,`${e(Kt)??""} ${e(Kt)===1?"copy":"copies"}`)}),p(Wt,aa)}),i(jt),p(kt,jt)};$($e,kt=>{e(y)&&kt(he)})}i(D),i(N),i(ee);var qe=v(ee,2);{var et=kt=>{const jt=Lt(()=>!M(e(f)));var Wt=M_(),Kt=Ue(Wt),aa=v(n(Kt),2),Yt=n(aa);i(aa),i(Kt);var pe=v(Kt,2);{var Ke=Te=>{var ze=P_(),dt=v(n(ze),2),rt=n(dt);i(dt),i(ze),O(()=>w(rt,`First copy is free. You're being charged for ${e(m)-1} additional ${e(m)-1===1?"copy":"copies"}.`)),p(Te,ze)},yt=Te=>{var ze=mt(),dt=Ue(ze);{var rt=vt=>{var Rt=L_();p(vt,Rt)};$(dt,vt=>{e(jt)&&e(m)===1&&vt(rt)},!0)}p(Te,ze)};$(pe,Te=>{e(jt)&&e(m)>1?Te(Ke):Te(yt,!1)})}O(Te=>w(Yt,`${Te??""}`),[()=>(e(A)||0).toFixed(2)]),p(kt,Wt)};$(qe,kt=>{e(f)&&kt(et)})}var Le=v(qe,2),Qe=v(n(Le),2);Oi(Qe);var st=v(Qe,2),ht=v(n(st),2),_t=n(ht);i(ht),i(st),i(Le);var xt=v(Le,2),wt=n(xt);wt.__click=X;var St=v(wt,2);St.__click=[S_,f,h,j,M,A,m,U];var $t=n(St);{var Nt=kt=>{var jt=_a("Submitting...");p(kt,jt)},Ut=kt=>{var jt=_a("Submit");p(kt,jt)};$($t,kt=>{e(g)?kt(Nt):kt(Ut,!1)})}i(St),i(xt),i(Ze),i(We),i(Se),O(kt=>{ge(ie,1,`material-symbols-outlined dropdown-icon ${e(b)?"open":""}`),w(ve,`${e(m)??""} ${e(m)===1?"copy":"copies"}`),ge(se,1,`material-symbols-outlined dropdown-icon ${e(y)?"open":""}`),w(_t,`${e(h).length??""}/200`),wt.disabled=e(g),St.disabled=kt},[()=>!e(f)||!e(h).trim()||e(g)]),ca(Qe,()=>e(h),kt=>d(h,kt)),p(xe,Se)};$(Ve,xe=>{e(u)&&xe(it)})}var Be=v(Ve,2),He=n(Be),Ne=v(n(He),2);Ne.__click=Q,i(He);var Je=v(He,2);{var lt=xe=>{var Se=R_(),We=v(n(Se));i(Se),O(()=>w(We,` ${e(S)??""}`)),p(xe,Se)};$(Je,xe=>{e(S)&&xe(lt)})}var Pe=v(Je,2);{var we=xe=>{var Se=j_();p(xe,Se)},tt=xe=>{var Se=mt(),We=Ue(Se);{var Ze=ue=>{var fe=O_();p(ue,fe)},ee=ue=>{var fe=J_();Tt(fe,23,()=>e(E),T=>T.id,(T,P,le)=>{var R=K_();R.__click=[q_,K,P];var G=n(R),ie=n(G),_e=n(ie),Y=n(_e,!0);i(_e),i(ie);var N=v(ie,2),D=n(N),L=n(D),z=n(L),ve=n(z,!0);i(z);var se=v(z,2),$e=n(se);i(se),i(L);var he=v(L,2),qe=n(he),et=n(qe,!0);i(qe);var Le=v(qe,2),Qe=v(n(Le),2);{var st=wt=>{var St=G_(),$t=n(St,!0);i(St),O(Nt=>w($t,Nt),[()=>oe(e(P))]),p(wt,St)};$(Qe,wt=>{oe(e(P))>0&&wt(st)})}i(Le),i(he),i(D),i(N),i(G);var ht=v(G,2);{var _t=wt=>{var St=V_(),$t=n(St),Nt=n($t);i($t),i(St),O(()=>w(Nt,`${e(P).status==="released"?"Released":"Ready for pick up"}${e(P).processedBy?` by ${e(P).processedBy}`:""}`)),p(wt,St)},xt=wt=>{var St=mt(),$t=Ue(St);{var Nt=kt=>{var jt=z_(),Wt=n(jt),Kt=n(Wt);{var aa=yt=>{var Te=_a();O(()=>w(Te,`Note${e(P).processedBy?` by ${e(P).processedBy}`:""}: ${e(P).adminNote??""}`)),p(yt,Te)},Yt=yt=>{var Te=_a();O(()=>w(Te,e(P).processedBy?`Being ${e(P).status==="verifying"?"verified":"processed"} by ${e(P).processedBy}`:`${e(P).status==="verifying"?"Verifying":"Processing"} your request`)),p(yt,Te)};$(Kt,yt=>{e(P).adminNote?yt(aa):yt(Yt,!1)})}var pe=v(Kt,2);{var Ke=yt=>{var Te=B_(),ze=n(Te);i(Te),O(()=>w(ze,` Tentative: ${e(P).tentativeDate??""}`)),p(yt,Te)};$(pe,yt=>{e(P).tentativeDate&&e(P).status==="processing"&&yt(Ke)})}i(Wt),i(jt),p(kt,jt)},Ut=kt=>{var jt=mt(),Wt=Ue(jt);{var Kt=Yt=>{var pe=W_(),Ke=n(pe),yt=n(Ke);i(Ke),i(pe),O(()=>w(yt,`Please submit required compliance  Deadline: ${e(P).tentativeDate||"Not set"}`)),p(Yt,pe)},aa=Yt=>{var pe=mt(),Ke=Ue(pe);{var yt=ze=>{var dt=H_();p(ze,dt)},Te=ze=>{var dt=mt(),rt=Ue(dt);{var vt=Zt=>{var ma=U_();p(Zt,ma)},Rt=Zt=>{var ma=mt(),ft=Ue(ma);{var ut=re=>{var J=Y_(),je=n(J),Ie=n(je);i(je),i(J),O(ot=>w(Ie,`Cancelled on ${ot??""}`),[()=>H(e(P).cancelledDate||e(P).submittedDate)]),p(re,J)},me=re=>{var J=mt(),je=Ue(J);{var Ie=ot=>{var Xe=Q_(),Mt=n(Xe),na=n(Mt);i(Mt),i(Xe),O(()=>w(na,`Rejected${e(P).processedBy?` by ${e(P).processedBy}`:""}${e(P).rejectionReason?`: ${e(P).rejectionReason}`:""}`)),p(ot,Xe)};$(je,ot=>{e(P).status==="rejected"&&ot(Ie)},!0)}p(re,J)};$(ft,re=>{e(P).status==="cancelled"?re(ut):re(me,!1)},!0)}p(Zt,ma)};$(rt,Zt=>{e(P).status==="on_hold"?Zt(vt):Zt(Rt,!1)},!0)}p(ze,dt)};$(Ke,ze=>{e(P).status==="non_compliance"?ze(yt):ze(Te,!1)},!0)}p(Yt,pe)};$(Wt,Yt=>{e(P).status==="for_compliance"?Yt(Kt):Yt(aa,!1)},!0)}p(kt,jt)};$($t,kt=>{e(P).status==="processing"||e(P).status==="verifying"?kt(Nt):kt(Ut,!1)},!0)}p(wt,St)};$(ht,wt=>{e(P).status==="released"||e(P).status==="for_pickup"?wt(_t):wt(xt,!1)})}i(R),O((wt,St,$t)=>{ge(R,1,`request-card ${e(P).status??""}`),Ya(R,`--card-index: ${e(le)??""};`),w(Y,wt),w(ve,e(P).type),w($e,`Requested on ${e(P).requestedDate??""}`),ge(qe,1,`student-status-badge status-${e(P).status??""}`),w(et,St),Vt(Le,"title",$t)},[()=>B(e(P).status),()=>W(e(P).status),()=>oe(e(P))>0?`${oe(e(P))} unread message${oe(e(P))!==1?"s":""}`:"View messages"]),p(T,R)}),i(fe),p(ue,fe)};$(We,ue=>{e(E).length===0?ue(Ze):ue(ee,!1)},!0)}p(xe,Se)};$(Pe,xe=>{e(F)?xe(we):xe(tt,!1)})}i(Be);var ct=v(Be,2);y_(ct,{}),i(ae),O(()=>{Re.disabled=e(F),w(Ge,e(u)?"remove":"add"),w(ke,e(u)?"Cancel":"New Document"),Ne.disabled=e(F)}),p(s,ae),Ga(),r()}Cs(["click","keydown"]);function eb(s,t){d(t,!e(t))}function tb(s,t){t()}function ab(s,t,a){const r=e(t).filter(o=>o.isRead).length;ns.confirm("Clear All Read Notifications",`<p>Are you sure you want to delete all <strong>${r}</strong> read notification${r!==1?"s":""}?</p>
       <p style="margin-top: 8px; color: var(--md-sys-color-on-surface-variant); font-size: 0.9rem;">This action cannot be undone.</p>`,async()=>{await a(),Fe.success(`${r} read notification${r!==1?"s":""} cleared successfully`)},()=>{},{size:"small"})}var sb=(s,t,a)=>t(e(a).value),rb=_('<span class="count-badge"> </span>'),ib=_('<button><span class="material-symbols-outlined"> </span> <span> </span> <!></button>'),nb=_('<div class="filter-dropdown-menu"></div>'),ob=_('<button class="notifications-action-btn mark-all-read" title="Mark All Read"><span class="material-symbols-outlined">done_all</span></button>'),lb=_('<button class="notifications-action-btn clear-read" title="Clear Read"><span class="material-symbols-outlined">clear_all</span></button>'),cb=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading notifications...</p></div>'),db=_('<div class="error-state"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Notifications</h3> <p> </p> <button class="retry-btn">Reload</button></div>'),ub=(s,t,a)=>t(e(a)),vb=(s,t,a)=>s.key==="Enter"&&t(e(a)),fb=_('<div class="admin-note"><span class="material-symbols-outlined">note</span> <div class="note-content"><span class="note-label">Admin Note:</span> <span class="note-text"> </span></div></div>'),pb=_('<div class="rejection-reason"><span class="material-symbols-outlined">error</span> <div class="reason-content"><span class="reason-label">Rejection Reason:</span> <span class="reason-text"> </span></div></div>'),mb=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},hb=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},gb=_('<div role="button" tabindex="0"><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p> <!> <!></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),_b=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},bb=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},yb=_('<div><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),wb=_('<div class="notifications-list"></div>'),xb=_('<div class="no-notifications"><div class="no-notifications-icon"><span class="material-symbols-outlined"> </span></div> <h3> </h3> <p> </p></div>'),Sb=_('<div class="notification-container"><div class="notification-header"><div class="header-content"><h1 class="page-title">Notifications</h1> <p class="page-subtitle">Stay updated with your academic activities <span class="notification-badge"> </span></p></div></div> <div class="filter-actions-section"><div class="filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="actions-section"><!> <!></div></div> <div class="notifications-section"><!></div></div>');function kb(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(xr,"$studentNotificationStore",a),l=()=>Ja(ws,"$authStore",a);let c=Lt(()=>o().notifications),u=Lt(()=>o().isLoading),f=Lt(()=>o().error),m=Lt(()=>o().unreadCount);const h=[{value:"all",label:"All Notifications",icon:"notifications"},{value:"unread",label:"Unread Only",icon:"mark_email_unread"},{value:"grade",label:"Grades",icon:"grade"},{value:"document",label:"Document Requests",icon:"description"}];let g=at("all"),b=at(!1);function y(ee){d(g,ee,!0),d(b,!1),xr.setFilter(ee),I()}function x(ee){ee.target.closest(".filter-dropdown")||d(b,!1)}function A(ee){const ue=e(c).find(fe=>fe.id===ee);ue?j(ee,!ue.isRead):console.warn("Notification not found for toggle:",ee)}function C(ee){const ue=e(c).find(T=>T.id===ee),fe=ue?ue.title:"this notification";ns.confirm("Delete Notification",`<p>Are you sure you want to delete <strong>"${fe}"</strong>?</p>
       <p style="margin-top: 8px; color: var(--md-sys-color-on-surface-variant); font-size: 0.9rem;">This action cannot be undone.</p>`,async()=>{await M(ee),Fe.success("Notification deleted successfully")},()=>{},{size:"small"})}function E(ee){if(ee.type==="document"||ee.type==="document_request"){const ue=ee.metadata?.relatedId;t.onnavigate&&t.onnavigate({detail:{section:"documents",requestId:ue}})}}function F(ee){const ue=new Date(ee),fe=new Date,T=Math.floor((fe-ue)/(1e3*60*60));if(T<1){const P=Math.floor((fe-ue)/6e4);return P<=1?"Just now":`${P} minutes ago`}else{if(T<24)return`${T} hour${T>1?"s":""} ago`;{const P=Math.floor(T/24);return P<7?`${P} day${P>1?"s":""} ago`:ue.toLocaleDateString("en-US",{month:"short",day:"numeric",year:ue.getFullYear()!==fe.getFullYear()?"numeric":void 0})}}}function S(ee){const ue=h.find(fe=>fe.value===ee);return ue?ue.label:"All Notifications"}function q(ee){const ue=h.find(fe=>fe.value===ee);return ue?ue.icon:"notifications"}async function I(){const ee=l().userData;if(!ee?.id){d(f,"User not authenticated");return}await xr.loadNotifications(ee.id,e(g))}async function j(ee,ue){const fe=l().userData;fe?.id&&await xr.updateNotificationStatus(fe.id,ee,ue)}async function M(ee){const ue=l().userData;ue?.id&&await xr.deleteNotification(ue.id,ee)}async function Z(){const ee=l().userData;ee?.id&&await xr.markAllAsRead(ee.id)}async function Q(){const ee=l().userData;ee?.id&&await xr.clearAllRead(ee.id)}Ua(()=>{if(l().userData?.id){const ee=l().userData;xr.init(ee.id,e(g)),I()}});let W=Lt(()=>Array.isArray(e(c))?e(g)==="all"?e(c):e(g)==="unread"?e(c).filter(ee=>!ee.isRead):e(c).filter(ee=>ee.type===e(g)):[]),H=at(0),U=at(0),X=at("all");Ss(()=>{(e(g)!==e(X)||e(W).length!==e(U))&&(mr(H),d(X,e(g),!0),d(U,e(W).length,!0))});var B=Sb();De("click",tr,x);var oe=n(B),K=n(oe),de=v(n(K),2),ae=v(n(de)),te=n(ae);i(ae),i(de),i(K),i(oe);var Ce=v(oe,2),Ae=n(Ce),Re=n(Ae),Me=n(Re);Me.__click=[eb,b];var Ge=n(Me),be=n(Ge),ke=n(be,!0);i(be);var Ve=v(be,2),it=n(Ve,!0);i(Ve),i(Ge);var Be=v(Ge,2);let He;i(Me);var Ne=v(Me,2);{var Je=ee=>{var ue=nb();Tt(ue,21,()=>h,Ha,(fe,T)=>{var P=ib();let le;P.__click=[sb,y,T];var R=n(P),G=n(R,!0);i(R);var ie=v(R,2),_e=n(ie,!0);i(ie);var Y=v(ie,2);{var N=D=>{var L=rb(),z=n(L,!0);i(L),O(()=>w(z,e(m))),p(D,L)};$(Y,D=>{e(T).value==="unread"&&D(N)})}i(P),O(D=>{le=ge(P,1,"filter-dropdown-item",null,le,D),w(G,e(T).icon),w(_e,e(T).label)},[()=>({active:e(T).value===e(g)})]),p(fe,P)}),i(ue),p(ee,ue)};$(Ne,ee=>{e(b)&&ee(Je)})}i(Re),i(Ae);var lt=v(Ae,2),Pe=n(lt);{var we=ee=>{var ue=ob();ue.__click=[tb,Z],p(ee,ue)};$(Pe,ee=>{e(m)>0&&ee(we)})}var tt=v(Pe,2);{var ct=ee=>{var ue=lb();ue.__click=[ab,c,Q],p(ee,ue)};$(tt,ee=>{e(c).some(ue=>ue.isRead)&&ee(ct)})}i(lt),i(Ce);var xe=v(Ce,2),Se=n(xe);{var We=ee=>{var ue=cb();p(ee,ue)},Ze=ee=>{var ue=mt(),fe=Ue(ue);{var T=le=>{var R=db(),G=v(n(R),4),ie=n(G,!0);i(G);var _e=v(G,2);_e.__click=I,i(R),O(()=>w(ie,e(f))),p(le,R)},P=le=>{var R=mt(),G=Ue(R);{var ie=Y=>{var N=mt(),D=Ue(N);Ms(D,()=>e(H),L=>{var z=wb();Tt(z,23,()=>e(W),ve=>ve.id,(ve,se,$e)=>{var he=mt(),qe=Ue(he);{var et=Qe=>{var st=gb();st.__click=[ub,E,se],st.__keydown=[vb,E,se];var ht=n(st),_t=n(ht),xt=n(_t,!0);i(_t);var wt=v(_t,2),St=n(wt,!0);i(wt),i(ht);var $t=v(ht,2),Nt=n($t),Ut=n(Nt),kt=n(Ut,!0);i(Ut);var jt=v(Ut,2);{var Wt=ze=>{var dt=fb(),rt=v(n(dt),2),vt=v(n(rt),2),Rt=n(vt,!0);i(vt),i(rt),i(dt),O(()=>w(Rt,e(se).adminNote)),p(ze,dt)};$(jt,ze=>{e(se).adminNote&&ze(Wt)})}var Kt=v(jt,2);{var aa=ze=>{var dt=pb(),rt=v(n(dt),2),vt=v(n(rt),2),Rt=n(vt,!0);i(vt),i(rt),i(dt),O(()=>w(Rt,e(se).rejectionReason)),p(ze,dt)};$(Kt,ze=>{e(se).rejectionReason&&ze(aa)})}i(Nt);var Yt=v(Nt,2),pe=n(Yt);pe.__click=[mb,A,se];var Ke=n(pe),yt=n(Ke,!0);i(Ke),i(pe);var Te=v(pe,2);Te.__click=[hb,C,se],i(Yt),i($t),i(st),O(ze=>{ge(st,1,`notification-card ${e(se).isRead?"read":"unread"} clickable`),Ya(st,`--card-index: ${e($e)??""};`),w(xt,e(se).title),w(St,ze),w(kt,e(se).message),Vt(pe,"title",e(se).isRead?"Mark as unread":"Mark as read"),w(yt,e(se).isRead?"mark_email_unread":"mark_email_read")},[()=>F(e(se).timestamp)]),p(Qe,st)},Le=Qe=>{var st=yb(),ht=n(st),_t=n(ht),xt=n(_t,!0);i(_t);var wt=v(_t,2),St=n(wt,!0);i(wt),i(ht);var $t=v(ht,2),Nt=n($t),Ut=n(Nt),kt=n(Ut,!0);i(Ut),i(Nt);var jt=v(Nt,2),Wt=n(jt);Wt.__click=[_b,A,se];var Kt=n(Wt),aa=n(Kt,!0);i(Kt),i(Wt);var Yt=v(Wt,2);Yt.__click=[bb,C,se],i(jt),i($t),i(st),O(pe=>{ge(st,1,`notification-card ${e(se).isRead?"read":"unread"}`),Ya(st,`--card-index: ${e($e)??""};`),w(xt,e(se).title),w(St,pe),w(kt,e(se).message),Vt(Wt,"title",e(se).isRead?"Mark as unread":"Mark as read"),w(aa,e(se).isRead?"mark_email_unread":"mark_email_read")},[()=>F(e(se).timestamp)]),p(Qe,st)};$(qe,Qe=>{e(se).type==="document"||e(se).type==="document_request"?Qe(et):Qe(Le,!1)})}p(ve,he)}),i(z),p(L,z)}),p(Y,N)},_e=Y=>{var N=xb(),D=n(N),L=n(D),z=n(L,!0);i(L),i(D);var ve=v(D,2),se=n(ve,!0);i(ve);var $e=v(ve,2),he=n($e,!0);i($e),i(N),O(qe=>{w(z,e(g)==="unread"?"mark_email_read":"notifications_off"),w(se,e(g)==="unread"?"All Caught Up!":"No Notifications"),w(he,qe)},[()=>e(g)==="unread"?"You have no unread notifications. Great job staying on top of things!":e(g)==="all"?"You don't have any notifications yet.":`No ${S(e(g)).toLowerCase()} notifications found.`]),p(Y,N)};$(G,Y=>{e(W).length>0?Y(ie):Y(_e,!1)},!0)}p(le,R)};$(fe,le=>{e(f)?le(T):le(P,!1)},!0)}p(ee,ue)};$(Se,ee=>{e(u)?ee(We):ee(Ze,!1)})}i(xe),i(B),O((ee,ue,fe)=>{w(te,`${e(m)??""} unread`),w(ke,ee),w(it,ue),He=ge(Be,1,"material-symbols-outlined dropdown-arrow",null,He,fe)},[()=>q(e(g)),()=>S(e(g)),()=>({rotated:e(b)})]),p(s,B),Ga(),r()}Cs(["click","keydown"]);const Db=300*1e3,Ab="student_todolist_";function Cb(){const s={todos:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:r}=Qs(s);function o(E){return`${Ab}${E}`}function l(E){return!E||!E.timestamp?!1:Date.now()-E.timestamp<Db}function c(E){try{const F=o(E),S=localStorage.getItem(F);if(S)return JSON.parse(S).data}catch(F){console.warn("Failed to retrieve cached student todolist data:",F)}return null}function u(E){try{const F=o(E),S=localStorage.getItem(F);if(S){const q=JSON.parse(S);if(l(q))return q.data}}catch(F){console.warn("Failed to retrieve cached student todolist data:",F)}return null}function f(E,F){try{const S=o(E),q={data:F,timestamp:Date.now()};localStorage.setItem(S,JSON.stringify(q))}catch(S){console.warn("Failed to cache student todolist data:",S)}}async function m(E,F=!1){try{r(I=>({...I,isLoading:!F,isRefreshing:F,error:null,currentStudentId:E}));const S=await ea.get(`/api/student-todos?studentId=${E}`);if(!S.success)throw new Error(S.error||"Failed to fetch todos");const q=S.data||[];r(I=>({...I,todos:q,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),f(E,{todos:q,lastUpdated:new Date().toISOString()})}catch(S){console.error("Error loading student todos:",S);let q;r(j=>(q=j.currentStudentId,j));const I=c(q);I?(r(j=>({...j,isLoading:!1,isRefreshing:!1,error:null,todos:I.todos||[],lastUpdated:I.lastUpdated})),Fe.error("No internet connection. Showing offline data.")):r(j=>({...j,isLoading:!1,isRefreshing:!1,error:S.message,todos:[]}))}}async function h(E,F){try{const S=await ea.post("/api/student-todos",{studentId:E,...F});if(!S.success)throw new Error(S.error||"Failed to add todo");return r(q=>{const I=[S.data,...q.todos];return f(E,{todos:I,lastUpdated:new Date().toISOString()}),{...q,todos:I,lastUpdated:new Date().toISOString()}}),{success:!0,data:S.data}}catch(S){return console.error("Error adding todo:",S),{success:!1,error:S.message}}}async function g(E,F,S){try{const q=await ea.put("/api/student-todos",{id:F,studentId:E,action:"update",...S});if(!q.success)throw new Error(q.error||"Failed to update todo");return r(I=>{const j=I.todos.map(M=>M.id===F?q.data:M);return f(E,{todos:j,lastUpdated:new Date().toISOString()}),{...I,todos:j,lastUpdated:new Date().toISOString()}}),{success:!0,data:q.data}}catch(q){return console.error("Error updating todo:",q),{success:!1,error:q.message}}}async function b(E,F){try{const S=await ea.put("/api/student-todos",{id:F,studentId:E,action:"toggle"});if(!S.success)throw new Error(S.error||"Failed to toggle todo");return r(q=>{const I=q.todos.map(j=>j.id===F?S.data:j);return f(E,{todos:I,lastUpdated:new Date().toISOString()}),{...q,todos:I,lastUpdated:new Date().toISOString()}}),{success:!0,data:S.data}}catch(S){return console.error("Error toggling todo:",S),{success:!1,error:S.message}}}async function y(E,F){try{const S=await ea.delete("/api/student-todos",{id:F,studentId:E});if(!S.success)throw new Error(S.error||"Failed to delete todo");return r(q=>{const I=q.todos.filter(j=>j.id!==F);return f(E,{todos:I,lastUpdated:new Date().toISOString()}),{...q,todos:I,lastUpdated:new Date().toISOString()}}),{success:!0}}catch(S){return console.error("Error deleting todo:",S),{success:!1,error:S.message}}}function x(E){const F=u(E);return F?(r(S=>({...S,...F,currentStudentId:E,isLoading:!1,isRefreshing:!1,error:null})),!0):(r(S=>({...S,currentStudentId:E,isLoading:!0,isRefreshing:!1,error:null})),!1)}function A(E){try{const F=o(E);localStorage.removeItem(F)}catch(F){console.warn("Failed to clear student todolist cache:",F)}return r(F=>({...s,currentStudentId:E,isLoading:!0})),C.loadTodos(E,!1)}const C={subscribe:t,init:x,loadTodos:m,addTodo:h,updateTodo:g,toggleTodo:b,deleteTodo:y,forceRefresh:A,getCachedData:E=>c(E)};return C}const Mr=Cb();var Tb=_('<button type="button"><span class="material-symbols-outlined"> </span> <span> </span></button>'),Eb=_('<div class="dropdown-menu-category"></div>'),Fb=_('<button class="clear-date-btn" type="button" title="Clear date"><span class="material-symbols-outlined">close</span></button>'),$b=_('<div class="day-header"> </div>'),Nb=_('<div class="empty-day"></div>'),Pb=_('<button type="button"> </button>'),Lb=_('<div class="date-picker-dropdown"><div class="date-picker-header"><button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_left</span></button> <div class="month-year-display"><span class="month-name"> </span> <span class="year-name"> </span></div> <button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_right</span></button></div> <div class="calendar-grid"><!> <!> <!></div></div>'),Mb=_('<div class="add-todo-section"><h2 class="section-title">Add New Task</h2> <div class="add-todo-form"><input type="text" placeholder="Enter task title..." class="todo-input"/> <textarea placeholder="Enter description (optional)..." class="todo-input todo-textarea" rows="3"></textarea> <div class="form-row"><div class="form-field"><label class="form-label" for="category-dropdown">Category</label> <div class="custom-dropdown"><button class="dropdown-toggle" id="category-dropdown" type="button"><div class="dropdown-toggle-content"><span class="material-symbols-outlined dropdown-icon-left"> </span> <span class="dropdown-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="form-field"><label class="form-label" for="due-date-picker">Due Date (optional)</label> <div class="custom-date-picker"><div class="date-picker-toggle-wrapper"><button class="date-picker-toggle" id="due-date-picker" type="button"><div class="date-picker-toggle-content"><span class="material-symbols-outlined date-picker-icon-left">calendar_today</span> <span class="date-picker-label"> </span></div> <div class="date-picker-actions"><!> <span>expand_more</span></div></button></div> <!></div></div></div> <button class="add-todo-btn"> </button></div></div>'),Ib=_('<button class="clear-search-btn"><span class="material-symbols-outlined">close</span></button>'),Rb=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),jb=_('<div class="filter-dropdown-menu"></div>'),Ob=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),qb=_('<div class="filter-dropdown-menu"></div>'),Gb=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading todos...</p></div>'),Vb=_('<div class="error-state"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-btn">Retry</button></div>'),Bb=_('<p class="todo-description"> </p>'),zb=_('<div><div class="todo-checkbox"><input type="checkbox"/> <label class="checkbox-label"></label></div> <div class="todo-content"><h3> </h3> <!> <div class="todo-meta"><span class="todo-category"> </span> <span class="todo-due-date"> </span></div></div> <div class="todo-actions"><button class="action-btn todo-delete-btn" title="Delete task"><span class="material-symbols-outlined">delete</span></button></div></div>'),Wb=_('<div class="todos-list"></div>'),Hb=_('<div class="no-filtered-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">search_off</span></div> <h3>No Matching Tasks</h3> <p>No tasks match your current search or filter criteria.</p> <button class="clear-filters-btn">Clear all filters</button></div>'),Ub=_(`<div class="no-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">check_circle</span></div> <h3>No Tasks</h3> <p>You don't have any tasks yet. Add one above to get started!</p></div>`),Yb=_('<div class="todo-container"><div class="todo-header"><div class="header-content"><div class="header-text-content"><h1 class="page-title">Todo List</h1> <p class="page-subtitle">Keep track of your tasks and assignments <span class="progress-badge"> </span></p></div> <div class="header-actions"></div></div></div> <div class="add-todo-button-section"><button class="add-todo-toggle-btn"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="search-filter-section"><div class="search-filter-row"><div class="todo-search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="todo-search-input" placeholder="Search todos by title or description..."/> <!></div> <div class="todo-filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <button class="todo-refresh-button" title="Refresh todos"><span class="material-symbols-outlined">refresh</span></button></div></div></div> <div class="todos-section"><!></div></div>');function Qb(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(Mr,"$studentTodolistStore",a),l=()=>Ja(ws,"$authStore",a),c=V(),u=V(),f=V(),m=V(),h=V(),g=V(),b=V(),y=V(),x=V(),A=V(),C=V();let E=V(!1),F=V(""),S=V("all"),q=V("all"),I=V(!1),j=V(!1),M=V(""),Z=V(""),Q=V("personal"),W=V(""),H=V(!1);const U=[{value:"all",label:"All Categories",icon:"category"},{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}],X=[{value:"all",label:"All Status",icon:"list"},{value:"pending",label:"Pending",icon:"pending"},{value:"completed",label:"Completed",icon:"check_circle"}],B=[{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}];let oe=V(!1),K=V(!1);const de=new Date;let ae=V(de.getFullYear()),te=V(de.getMonth());const Ce=["January","February","March","April","May","June","July","August","September","October","November","December"],Ae=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];async function Re(){const Oe=l();Oe.isAuthenticated&&Oe.userData?.id&&await Mr.forceRefresh(Oe.userData.id)}async function Me(){try{d(E,!0);const Oe=l().userData;if(!Oe||!Oe.id)throw new Error("User not authenticated");if(!e(M).trim()){Fe.error("Please enter a title for your todo");return}const bt={title:e(M).trim(),description:e(Z).trim()||null,category:e(Q),dueDate:e(W)||null},Et=await Mr.addTodo(Oe.id,bt);if(Et.success)Fe.success("Todo added successfully!"),d(M,""),d(Z,""),d(Q,"personal"),d(W,""),d(H,!1);else throw new Error(Et.error||"Failed to add todo")}catch(Oe){console.error("Error adding todo:",Oe),Fe.error("Failed to add todo: "+Oe.message)}finally{d(E,!1)}}async function Ge(Oe){try{const bt=l().userData;if(!bt||!bt.id)throw new Error("User not authenticated");const Et=await Mr.deleteTodo(bt.id,Oe);if(Et.success)Fe.success("Todo deleted successfully!");else throw new Error(Et.error||"Failed to delete todo")}catch(bt){console.error("Error deleting todo:",bt),Fe.error("Failed to delete todo: "+bt.message)}}async function be(Oe){try{const bt=l().userData;if(!bt||!bt.id)throw new Error("User not authenticated");const Et=await Mr.toggleTodo(bt.id,Oe);if(Et.success){const Jt=Et.data.completed?"Todo marked as completed!":"Todo marked as pending!";Fe.success(Jt)}else throw new Error(Et.error||"Failed to update todo")}catch(bt){console.error("Error toggling todo:",bt),Fe.error("Failed to update todo: "+bt.message)}}Ua(()=>{const Oe=l();if(Oe.isAuthenticated&&Oe.userData?.id){const bt=Mr.init(Oe.userData.id);Mr.loadTodos(Oe.userData.id,bt);const Et=setInterval(()=>{const qt=l();qt.isAuthenticated&&qt.userData?.id&&Mr.loadTodos(qt.userData.id,!0)},300*1e3);return()=>{clearInterval(Et)}}});function ke(Oe){ns.confirm("Delete Task",`Are you sure you want to delete "${Oe.title}"? This action cannot be undone.`,async()=>{await Ge(Oe.id)},()=>{})}function Ve(){d(H,!e(H)),e(H)||(d(M,""),d(Z,""),d(Q,"personal"),d(W,""),d(oe,!1),d(K,!1))}function it(){d(I,!e(I))}function Be(){d(j,!e(j))}function He(Oe){d(S,Oe),d(I,!1)}function Ne(Oe){d(q,Oe),d(j,!1)}function Je(Oe){const bt=U.find(Et=>Et.value===Oe);return bt?bt.label:"All Categories"}function lt(Oe){const bt=U.find(Et=>Et.value===Oe);return bt?bt.icon:"category"}function Pe(Oe){const bt=X.find(Et=>Et.value===Oe);return bt?bt.label:"All Status"}function we(Oe){const bt=X.find(Et=>Et.value===Oe);return bt?bt.icon:"list"}function tt(){d(oe,!e(oe))}function ct(Oe){d(Q,Oe),d(oe,!1)}function xe(Oe){Oe.target.closest(".custom-dropdown")||d(oe,!1),Oe.target.closest(".custom-date-picker")||d(K,!1),Oe.target.closest(".filter-dropdown")||(d(I,!1),d(j,!1))}Ua(()=>(document.addEventListener("click",xe),()=>{document.removeEventListener("click",xe)}));function Se(Oe){const bt=B.find(Et=>Et.value===Oe);return bt?bt.label:"Select Category"}function We(Oe){const bt=B.find(Et=>Et.value===Oe);return bt?bt.icon:"category"}function Ze(){if(d(K,!e(K)),e(K))if(e(W)){const Oe=new Date(e(W)+"T00:00:00");d(ae,Oe.getFullYear()),d(te,Oe.getMonth()),Oe.getDate()}else{const Oe=new Date;d(ae,Oe.getFullYear()),d(te,Oe.getMonth())}}function ee(Oe){const bt=e(ae),Et=e(te)+1,qt=Oe.toString().padStart(2,"0"),Jt=Et.toString().padStart(2,"0");d(W,`${bt}-${Jt}-${qt}`),d(K,!1)}function ue(){d(W,""),d(K,!1)}function fe(){e(te)===0?(d(te,11),mr(ae,-1)):mr(te,-1)}function T(){e(te)===11?(d(te,0),mr(ae)):mr(te)}function P(Oe,bt){return new Date(Oe,bt+1,0).getDate()}function le(Oe,bt){return new Date(Oe,bt,1).getDay()}function R(Oe){const bt=new Date;return Oe===bt.getDate()&&e(te)===bt.getMonth()&&e(ae)===bt.getFullYear()}function G(Oe){if(!e(W))return!1;const bt=new Date(e(W)+"T00:00:00");return Oe===bt.getDate()&&e(te)===bt.getMonth()&&e(ae)===bt.getFullYear()}function ie(Oe){if(!Oe||Oe==="No due date")return"No due date";if(Oe==="Today"||Oe==="Tomorrow"||Oe==="Next Week")return Oe;const bt=Oe.split("-");if(bt.length!==3)return Oe;const Et=parseInt(bt[0]),qt=parseInt(bt[1])-1,Jt=parseInt(bt[2]);if(isNaN(Et)||isNaN(qt)||isNaN(Jt))return Oe;const va=new Date,la=va.getFullYear(),ya=va.getMonth(),wa=va.getDate();if(Et===la&&qt===ya&&Jt===wa)return"Today";const Ea=new Date(va);Ea.setDate(Ea.getDate()+1);const Aa=Ea.getFullYear(),ja=Ea.getMonth(),Ra=Ea.getDate();return Et===Aa&&qt===ja&&Jt===Ra?"Tomorrow":new Date(Et,qt,Jt).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).replace(/^(\w+),/,"$1:")}let _e=V(0),Y=V(""),N=V(e(S)),D=V(e(q));Ft(()=>(e(c),e(u),e(f),e(m),e(h),o()),()=>{(Oe=>{d(c,Oe.todos),d(u,Oe.isLoading),d(f,Oe.isRefreshing),d(m,Oe.error),d(h,Oe.lastUpdated)})(o())}),Ft(()=>(e(c),e(F),e(S),e(q)),()=>{d(g,(()=>{let Oe=e(c);if(e(F).trim()){const bt=e(F).toLowerCase().trim();Oe=Oe.filter(Et=>Et.title.toLowerCase().includes(bt)||Et.description&&Et.description.toLowerCase().includes(bt))}return e(S)!=="all"&&(Oe=Oe.filter(bt=>bt.category===e(S))),e(q)!=="all"&&(e(q)==="completed"?Oe=Oe.filter(bt=>bt.completed):e(q)==="pending"&&(Oe=Oe.filter(bt=>!bt.completed))),Oe})())}),Ft(()=>e(W),()=>{d(b,e(W)?new Date(e(W)+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).replace(/^(\w+),/,"$1:"):"Select due date")}),Ft(()=>e(c),()=>{d(y,e(c).filter(Oe=>Oe.completed).length)}),Ft(()=>e(c),()=>{d(x,e(c).length)}),Ft(()=>e(g),()=>{d(A,e(g).filter(Oe=>Oe.completed).length)}),Ft(()=>e(g),()=>{d(C,e(g).length)}),Ft(()=>(e(F),e(Y),e(S),e(N),e(q),e(D),e(_e)),()=>{(e(F)!==e(Y)||e(S)!==e(N)||e(q)!==e(D))&&(mr(_e),d(Y,e(F)),d(N,e(S)),d(D,e(q)))}),Is(),Ps();var L=Yb();De("click",tr,xe);var z=n(L),ve=n(z),se=n(ve),$e=v(n(se),2),he=v(n($e)),qe=n(he);i(he),i($e),i(se),zt(2),i(ve),i(z);var et=v(z,2),Le=n(et),Qe=n(Le),st=n(Qe,!0);i(Qe);var ht=v(Qe);i(Le),i(et);var _t=v(et,2);{var xt=Oe=>{var bt=Mb(),Et=v(n(bt),2),qt=n(Et);ia(qt);var Jt=v(qt,2);Oi(Jt);var va=v(Jt,2),la=n(va),ya=v(n(la),2),wa=n(ya),Ea=n(wa),Aa=n(Ea),ja=n(Aa,!0);i(Aa);var Ra=v(Aa,2),$a=n(Ra,!0);i(Ra),i(Ea);var ha=v(Ea,2);i(wa);var fa=v(wa,2);{var ne=Sa=>{var Da=Eb();Tt(Da,5,()=>B,Ha,(La,ce)=>{var ye=Tb(),pt=n(ye),It=n(pt,!0);i(pt);var Pt=v(pt,2),Gt=n(Pt,!0);i(Pt),i(ye),O(()=>{ge(ye,1,`dropdown-item ${e(ce),e(Q),k(()=>e(ce).value===e(Q)?"selected":"")??""}`),w(It,(e(ce),k(()=>e(ce).icon))),w(Gt,(e(ce),k(()=>e(ce).label)))}),De("click",ye,()=>ct(e(ce).value)),p(La,ye)}),i(Da),p(Sa,Da)};$(fa,Sa=>{e(oe)&&Sa(ne)})}i(ya),i(la);var Ee=v(la,2),nt=v(n(Ee),2),Ct=n(nt),Qt=n(Ct),Ot=n(Qt),At=v(n(Ot),2),pa=n(At,!0);i(At),i(Ot);var oa=v(Ot,2),ga=n(oa);{var xa=Sa=>{var Da=Fb();De("click",Da,co(ue)),p(Sa,Da)};$(ga,Sa=>{e(W)&&Sa(xa)})}var ta=v(ga,2);i(oa),i(Qt),i(Ct);var Xt=v(Ct,2);{var ba=Sa=>{var Da=Lb(),La=n(Da),ce=n(La),ye=v(ce,2),pt=n(ye),It=n(pt,!0);i(pt);var Pt=v(pt,2),Gt=n(Pt,!0);i(Pt),i(ye);var da=v(ye,2);i(La);var ka=v(La,2),Ht=n(ka);Tt(Ht,1,()=>Ae,Ha,(Dt,Bt)=>{var ra=$b(),ua=n(ra,!0);i(ra),O(()=>w(ua,e(Bt))),p(Dt,ra)});var Ye=v(Ht,2);Tt(Ye,1,()=>(e(ae),e(te),k(()=>Array(le(e(ae),e(te))))),Ha,(Dt,Bt)=>{var ra=Nb();p(Dt,ra)});var sa=v(Ye,2);Tt(sa,1,()=>(e(ae),e(te),k(()=>Array(P(e(ae),e(te))))),Ha,(Dt,Bt,ra)=>{const ua=$r(()=>ra+1);var Oa=Pb(),Ta=n(Oa,!0);i(Oa),O((Ma,za)=>{ge(Oa,1,`day-cell ${Ma??""} ${za??""}`),w(Ta,e(ua))},[()=>(js(e(ua)),k(()=>R(e(ua))?"today":"")),()=>(js(e(ua)),k(()=>G(e(ua))?"selected":""))]),De("click",Oa,()=>ee(e(ua))),p(Dt,Oa)}),i(ka),i(Da),O(()=>{w(It,(e(te),k(()=>Ce[e(te)]))),w(Gt,e(ae))}),De("click",ce,fe),De("click",da,T),p(Sa,Da)};$(Xt,Sa=>{e(K)&&Sa(ba)})}i(nt),i(Ee),i(va);var Ca=v(va,2),Na=n(Ca,!0);i(Ca),i(Et),i(bt),O((Sa,Da,La)=>{w(ja,Sa),w($a,Da),ge(ha,1,`material-symbols-outlined dropdown-icon ${e(oe)?"open":""}`),w(pa,e(b)),ge(ta,1,`material-symbols-outlined dropdown-icon ${e(K)?"open":""}`),Ca.disabled=La,w(Na,e(E)?"Adding...":"Add Task")},[()=>(e(Q),k(()=>We(e(Q)))),()=>(e(Q),k(()=>Se(e(Q)))),()=>(e(M),e(E),k(()=>!e(M).trim()||e(E)))]),ca(qt,()=>e(M),Sa=>d(M,Sa)),De("keydown",qt,Sa=>Sa.key==="Enter"&&Me()),ca(Jt,()=>e(Z),Sa=>d(Z,Sa)),De("click",wa,tt),De("click",Qt,Ze),De("click",Ca,Me),p(Oe,bt)};$(_t,Oe=>{e(H)&&Oe(xt)})}var wt=v(_t,2),St=n(wt),$t=n(St),Nt=v(n($t),2);ia(Nt);var Ut=v(Nt,2);{var kt=Oe=>{var bt=Ib();De("click",bt,()=>d(F,"")),p(Oe,bt)};$(Ut,Oe=>{e(F)&&Oe(kt)})}i($t);var jt=v($t,2),Wt=n(jt),Kt=n(Wt),aa=n(Kt),Yt=n(aa),pe=n(Yt,!0);i(Yt);var Ke=v(Yt,2),yt=n(Ke,!0);i(Ke),i(aa);var Te=v(aa,2);let ze;i(Kt);var dt=v(Kt,2);{var rt=Oe=>{var bt=jb();Tt(bt,5,()=>U,Ha,(Et,qt)=>{var Jt=Rb();let va;var la=n(Jt),ya=n(la,!0);i(la);var wa=v(la,2),Ea=n(wa,!0);i(wa),i(Jt),O(Aa=>{va=ge(Jt,1,"filter-dropdown-item",null,va,Aa),w(ya,(e(qt),k(()=>e(qt).icon))),w(Ea,(e(qt),k(()=>e(qt).label)))},[()=>({active:e(qt).value===e(S)})]),De("click",Jt,()=>He(e(qt).value)),p(Et,Jt)}),i(bt),p(Oe,bt)};$(dt,Oe=>{e(I)&&Oe(rt)})}i(Wt);var vt=v(Wt,2),Rt=n(vt),Zt=n(Rt),ma=n(Zt),ft=n(ma,!0);i(ma);var ut=v(ma,2),me=n(ut,!0);i(ut),i(Zt);var re=v(Zt,2);let J;i(Rt);var je=v(Rt,2);{var Ie=Oe=>{var bt=qb();Tt(bt,5,()=>X,Ha,(Et,qt)=>{var Jt=Ob();let va;var la=n(Jt),ya=n(la,!0);i(la);var wa=v(la,2),Ea=n(wa,!0);i(wa),i(Jt),O(Aa=>{va=ge(Jt,1,"filter-dropdown-item",null,va,Aa),w(ya,(e(qt),k(()=>e(qt).icon))),w(Ea,(e(qt),k(()=>e(qt).label)))},[()=>({active:e(qt).value===e(q)})]),De("click",Jt,()=>Ne(e(qt).value)),p(Et,Jt)}),i(bt),p(Oe,bt)};$(je,Oe=>{e(j)&&Oe(Ie)})}i(vt);var ot=v(vt,2);i(jt),i(St),i(wt);var Xe=v(wt,2),Mt=n(Xe);{var na=Oe=>{var bt=Gb();p(Oe,bt)},gt=Oe=>{var bt=mt(),Et=Ue(bt);{var qt=va=>{var la=Vb(),ya=v(n(la),2),wa=n(ya,!0);i(ya);var Ea=v(ya,2);i(la),O(()=>w(wa,e(m))),De("click",Ea,Re),p(va,la)},Jt=va=>{var la=mt(),ya=Ue(la);{var wa=Aa=>{var ja=mt(),Ra=Ue(ja);Ms(Ra,()=>e(_e),$a=>{var ha=Wb();Tt(ha,7,()=>e(g),fa=>fa.id,(fa,ne,Ee)=>{var nt=zb();let Ct;var Qt=n(nt),Ot=n(Qt);ia(Ot);var At=v(Ot,2);i(Qt);var pa=v(Qt,2),oa=n(pa);let ga;var xa=n(oa,!0);i(oa);var ta=v(oa,2);{var Xt=ye=>{var pt=Bb(),It=n(pt,!0);i(pt),O(()=>w(It,(e(ne),k(()=>e(ne).description)))),p(ye,pt)};$(ta,ye=>{e(ne),k(()=>e(ne).description)&&ye(Xt)})}var ba=v(ta,2),Ca=n(ba),Na=n(Ca,!0);i(Ca);var Sa=v(Ca,2),Da=n(Sa,!0);i(Sa),i(ba),i(pa);var La=v(pa,2),ce=n(La);i(La),i(nt),O((ye,pt,It)=>{Ct=ge(nt,1,"todo-card",null,Ct,ye),Ya(nt,`--card-index: ${e(Ee)??""};`),Od(Ot,(e(ne),k(()=>e(ne).completed))),Vt(Ot,"id",`todo-${e(ne),k(()=>e(ne).id)??""}`),Ot.disabled=e(u),Vt(At,"for",`todo-${e(ne),k(()=>e(ne).id)??""}`),ga=ge(oa,1,"todo-title",null,ga,pt),w(xa,(e(ne),k(()=>e(ne).title))),w(Na,(e(ne),k(()=>e(ne).category))),w(Da,It),ce.disabled=e(u)},[()=>({completed:e(ne).completed}),()=>({completed:e(ne).completed}),()=>(e(ne),k(()=>ie(e(ne).dueDate)))]),De("change",Ot,()=>be(e(ne).id)),De("click",ce,()=>ke(e(ne))),p(fa,nt)}),i(ha),p($a,ha)}),p(Aa,ja)},Ea=Aa=>{var ja=mt(),Ra=Ue(ja);{var $a=fa=>{var ne=Hb(),Ee=v(n(ne),6);i(ne),De("click",Ee,()=>{d(F,""),d(S,"all"),d(q,"all")}),p(fa,ne)},ha=fa=>{var ne=Ub();p(fa,ne)};$(Ra,fa=>{e(c),k(()=>e(c).length>0)?fa($a):fa(ha,!1)},!0)}p(Aa,ja)};$(ya,Aa=>{e(g),k(()=>e(g).length>0)?Aa(wa):Aa(Ea,!1)},!0)}p(va,la)};$(Et,va=>{e(m)?va(qt):va(Jt,!1)},!0)}p(Oe,bt)};$(Mt,Oe=>{e(u)?Oe(na):Oe(gt,!1)})}i(Xe),i(L),O((Oe,bt,Et,qt,Jt,va)=>{w(qe,`${e(y)??""}/${e(x)??""} completed`),w(st,e(H)?"remove":"add"),w(ht,` ${e(H)?"Cancel":"Add New Task"}`),w(pe,Oe),w(yt,bt),ze=ge(Te,1,"material-symbols-outlined dropdown-arrow",null,ze,Et),w(ft,qt),w(me,Jt),J=ge(re,1,"material-symbols-outlined dropdown-arrow",null,J,va),ot.disabled=e(u)},[()=>(e(S),k(()=>lt(e(S)))),()=>(e(S),k(()=>Je(e(S)))),()=>({rotated:e(I)}),()=>(e(q),k(()=>we(e(q)))),()=>(e(q),k(()=>Pe(e(q)))),()=>({rotated:e(j)})]),De("click",Le,Ve),ca(Nt,()=>e(F),Oe=>d(F,Oe)),De("click",Kt,it),De("click",Rt,Be),De("click",ot,Re),p(s,L),Ga(),r()}function Kb(s,t){d(t,!e(t))}function Jb(s,t,a){d(t,!e(t)),a()}var Xb=_('<img alt="Profile" class="avatar-image"/>'),Zb=_('<div class="avatar-placeholder"> </div>'),ey=(s,t,a)=>{t(),a.onnavigate("profile")},ty=async(s,t,a)=>{t(),await a.onlogout(),Vr("Logged out successfully. See you next time!")},ay=_('<div class="teacher-navbar-dropdown-menu"><button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),sy=_('<nav class="teacher-navbar" aria-label="Teacher navigation"><div class="teacher-navbar-container"><div class="teacher-navbar-left"><button class="teacher-navbar-icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">person_book</span> <span class="app-title"> </span></div></div> <div class="teacher-navbar-right"><button class="teacher-navbar-icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="teacher-navbar-user-profile"><div class="teacher-navbar-user-info"><span class="teacher-navbar-user-name"> </span> <span class="user-id"> </span></div> <div class="teacher-navbar-user-avatar"><!></div></button> <!></div></div></div></nav>');function ry(s,t){qa(t,!0);let a=Pa(t,"teacherName",3,"John Does"),r=Pa(t,"firstName",3,"John"),o=Pa(t,"gender",3,"male"),l=Pa(t,"accountNumber",3,"TCH-2025-0001"),c=Pa(t,"profileImage",3,null);function u(be){return be==="female"?"Ms.":"Mr."}function f(be){if(!be)return"";if(be.includes(","))return be.split(",")[0].trim();const ke=be.trim().split(" ");return ke.length>1?ke[ke.length-1]:ke[0]}let m=Lt(()=>`${u(o())} ${f(a())}`),h=at(!0),g=at(!1);function b(){d(g,!1)}function y(be){e(g)&&!be.target.closest(".user-profile-container")&&b()}Ua(()=>{const be=localStorage.getItem("theme");return d(h,be!=="light"),x(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}});function x(){e(h)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"),A("#121212")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"),A("#FFFFFF"))}function A(be){let ke=document.querySelector('meta[name="theme-color"]:not([media])');ke||(ke=document.createElement("meta"),ke.setAttribute("name","theme-color"),document.head.appendChild(ke)),ke.setAttribute("content",be)}function C(be){return be.split(" ").map(ke=>ke.charAt(0)).join("").toUpperCase().slice(0,2)}var E=sy(),F=n(E),S=n(F),q=n(S);q.__click=function(...be){t.onToggleNavRail?.apply(this,be)};var I=v(q,2),j=v(n(I),2),M=n(j);i(j),i(I),i(S);var Z=v(S,2),Q=n(Z);Q.__click=[Jb,h,x];var W=n(Q),H=n(W,!0);i(W),i(Q);var U=v(Q,2),X=n(U);X.__click=[Kb,g];var B=n(X),oe=n(B),K=n(oe,!0);i(oe);var de=v(oe,2),ae=n(de);i(de),i(B);var te=v(B,2),Ce=n(te);{var Ae=be=>{var ke=Xb();O(()=>Vt(ke,"src",c())),p(be,ke)},Re=be=>{var ke=Zb(),Ve=n(ke,!0);i(ke),O(it=>w(Ve,it),[()=>C(r())]),p(be,ke)};$(Ce,be=>{c()?be(Ae):be(Re,!1)})}i(te),i(X);var Me=v(X,2);{var Ge=be=>{var ke=ay(),Ve=n(ke);Ve.__click=[ey,b,t];var it=v(Ve,2);it.__click=[ty,b,t],i(ke),p(be,ke)};$(Me,be=>{e(g)&&be(Ge)})}i(U),i(Z),i(F),i(E),O(()=>{w(M,`Welcome, ${e(m)??""}`),w(H,e(h)?"light_mode":"dark_mode"),w(K,a()),w(ae,`Account: ${l()??""}`)}),p(s,E),Ga()}Cs(["click"]);var iy=(s,t,a)=>t(e(a).id),ny=_('<button><div class="teacher-menu-rail-icon-container"><span class="material-symbols-outlined teacher-menu-rail-icon"> </span></div> <span class="teacher-menu-rail-label"> </span></button>'),oy=(s,t,a)=>t(e(a).id),ly=_('<button><div class="teacher-menu-nav-icon-container"><span class="material-symbols-outlined teacher-menu-nav-icon"> </span></div></button>'),cy=_('<nav aria-label="Teacher portal navigation"><div class="teacher-menu-rail-container"></div></nav> <nav class="teacher-menu-bottom-navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-nav-container"></div></nav>',1);function dy(s,t){qa(t,!0);let a=Pa(t,"teacherActiveSection",15,"schedule"),r=Pa(t,"teacherNavRailVisible",3,!0);const o=[{id:"schedule",label:"Schedule",icon:"schedule"},{id:"students",label:"Class Management",icon:"group"},{id:"advisory",label:"Advisory Class",icon:"supervisor_account"}];let l=at(!1),c=at(!1);Ss(()=>{t.teacherId&&!e(c)&&u()});async function u(){try{const C=await ea.get(`/api/teacher-advisory?teacher_id=${t.teacherId}`);d(l,C.success&&C.data.advisoryData!==null,!0)}catch(C){console.error("Error checking advisory status:",C),d(l,!1)}finally{d(c,!0)}}let f=Lt(()=>o.filter(C=>C.id!=="advisory"||e(l)));function m(C){a(C),t.onnavigate&&t.onnavigate({detail:{section:C}})}var h=cy(),g=Ue(h);let b;var y=n(g);Tt(y,21,()=>e(f),C=>C.id,(C,E)=>{var F=ny();let S;F.__click=[iy,m,E];var q=n(F),I=n(q),j=n(I,!0);i(I),i(q);var M=v(q,2),Z=n(M,!0);i(M),i(F),O(Q=>{S=ge(F,1,"teacher-menu-rail-item",null,S,Q),Vt(F,"aria-label",e(E).label),Vt(F,"aria-current",e(E).id===a()?"page":void 0),w(j,e(E).icon),w(Z,e(E).label)},[()=>({active:e(E).id===a()})]),p(C,F)}),i(y),i(g);var x=v(g,2),A=n(x);Tt(A,21,()=>e(f),C=>C.id,(C,E)=>{var F=ly();let S;F.__click=[oy,m,E];var q=n(F),I=n(q),j=n(I,!0);i(I),i(q),i(F),O(M=>{S=ge(F,1,"teacher-menu-nav-item",null,S,M),Vt(F,"aria-label",e(E).label),Vt(F,"aria-current",e(E).id===a()?"page":void 0),w(j,e(E).icon)},[()=>({active:e(E).id===a()})]),p(C,F)}),i(A),i(x),O(C=>b=ge(g,1,"teacher-menu-navigation-rail",null,b,C),[()=>({collapsed:!r()})]),p(s,h),Ga()}Cs(["click"]);const Lo="teacherProfileCache",uy=300*1e3;function vy(){const{subscribe:s,set:t,update:a}=Qs({teacherData:null,teacherProfileData:null,teacherSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),r={subscribe:s,init:o=>{const l=fy(o);return l?(a(c=>({...c,teacherData:l.teacherData,teacherProfileData:l.teacherProfileData,teacherSections:l.teacherSections,lastUpdated:l.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(o,l=!1)=>{a(c=>({...c,isLoading:o&&!c.isInitialized&&!l,isRefreshing:o&&l,error:o?null:c.error}))},setError:o=>{a(l=>({...l,isLoading:!1,isRefreshing:!1,error:o}))},updateProfileData:(o,l,c,u)=>{const f=Date.now();a(m=>({...m,teacherData:o,teacherProfileData:l,teacherSections:c,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),py(o,l,c,u,f)},loadProfile:async(o,l=!1)=>{try{a(b=>({...b,isLoading:!l&&!b.isInitialized,isRefreshing:l,error:null}));const c=String(o);console.log("Loading teacher profile for ID:",c);let u=null,f=null,m=[];const h=await ea.get(`/api/teacher-profile?teacherId=${c}`);if(console.log("Profile response:",h),!h.success||!h.data)throw new Error(h.error||"Failed to fetch teacher profile");const g=h.data;u={id:g.teacher.id,name:g.teacher.full_name,firstName:g.teacher.full_name.split(" ")[0],lastName:g.teacher.full_name.split(" ").slice(1).join(" "),middleInitial:"",email:g.teacher.email,type:"Teacher",number:c,position:g.teacher.position||"Teacher",department:g.teacher.department||"Not assigned",contactNumber:"Not available",address:"Not available",birthdate:null,age:"Not available",gender:"Not available",createdDate:"Not available",updatedDate:"Not available",status:"active"},f={subjects:g.subjects||[],classes:[],sections:g.sections||[]};try{const y=(await ea.get("/api/current-quarter")).data?.currentSchoolYear||"2025-2026",x=await ea.get(`/api/teacher-sections?teacherId=${c}&schoolYear=${y}`);x.success&&(m=x.data?.classData||[])}catch(b){console.warn("Failed to fetch teacher sections:",b)}r.updateProfileData(u,f,m,o)}catch(c){console.error("Error loading teacher profile:",c),a(u=>({...u,isLoading:!1,isRefreshing:!1,error:c.message}))}},clearCache:o=>{try{const l=`${Lo}_${o}`;localStorage.removeItem(l)}catch(l){console.warn("Failed to clear teacher profile cache:",l)}},forceRefresh:async o=>{r.clearCache(o),a(l=>({...l,isInitialized:!1,teacherData:null,teacherProfileData:null,teacherSections:[]})),await r.loadProfile(o,!1)}};return r}function fy(s){try{const t=`${Lo}_${s}`,a=localStorage.getItem(t);if(!a)return null;const r=JSON.parse(a);return Date.now()-r.timestamp>uy?(localStorage.removeItem(t),null):{teacherData:r.teacherData,teacherProfileData:r.teacherProfileData,teacherSections:r.teacherSections,lastUpdated:r.timestamp}}catch(t){return console.warn("Failed to get cached teacher profile data:",t),null}}function py(s,t,a,r,o){try{const l=`${Lo}_${r}`,c={teacherData:s,teacherProfileData:t,teacherSections:a,timestamp:o};localStorage.setItem(l,JSON.stringify(c))}catch(l){console.warn("Failed to cache teacher profile data:",l)}}const Ei=vy();function my(s,t){d(t,!e(t))}function hy(s,t){d(t,!e(t))}function gy(s,t){d(t,!e(t))}function _y(s,t){ns.confirm("Change Password",`
			<div class="teacher-profile-password-form">
				<div class="teacher-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var by=_('<div class="teacher-error-container"><div class="teacher-error-icon"><span class="material-symbols-outlined">error</span></div> <p class="teacher-error-message"> </p> <button class="teacher-retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),yy=_('<div class="teacher-profile-loading-container"><span class="system-loader"></span> <p class="teacher-profile-loading-text">Loading teacher information...</p></div>'),wy=_('<div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Teacher ID</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">person</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Full Name</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">work</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Position</div> <div class="teacher-info-value"> </div></div></div></div> <div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">email</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Email</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Total Subjects</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">domain</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Department</div> <div class="teacher-info-value"> </div></div></div></div>',1),xy=_('<div class="teacher-profile-loading-container"><span class="system-loader"></span> <p class="teacher-profile-loading-text">Loading teaching sections...</p></div>'),Sy=_('<div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">groups</span></div> <div class="teacher-info-content"><div class="teacher-info-label"> </div> <div class="teacher-info-value"> </div></div></div>'),ky=_('<div class="teacher-info-row teacher-row-three"></div>'),Dy=_('<div class="teacher-sections-empty"><span class="material-symbols-outlined">groups</span> <p>No teaching sections assigned yet</p></div>'),Ay=_('<div class="teacher-profile-loading-container"><span class="system-loader"></span> <p class="teacher-profile-loading-text">Loading teaching assignments...</p></div>'),Cy=_('<div class="teacher-subject-card"><div class="teacher-subject-icon-column"><div class="teacher-subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="teacher-subject-details-column"><h3 class="teacher-subject-name"> </h3> <p class="teacher-subject-classes"><!></p></div></div>'),Ty=_('<div class="teacher-subjects-grid"></div>'),Ey=_('<div class="teacher-subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects assigned yet</p></div>'),Fy=_('<div class="teacher-profile-header"><div class="teacher-header-content"><h1 class="teacher-page-title">Teacher Profile</h1> <p class="teacher-page-subtitle">Personal Information & Teaching Details</p></div> <div class="teacher-header-actions"><button class="teacher-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="teacher-profile-info-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teacher Information</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teacher information"><h2 class="teacher-section-title">Teacher Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-sections-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Sections</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching sections"><h2 class="teacher-section-title">Teaching Sections</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-subjects-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Assignments</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching assignments"><h2 class="teacher-section-title">Teaching Assignments</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-security-section"><h2 class="teacher-section-title teacher-section-title-desktop">Account Security</h2> <div class="teacher-section-content"><div class="teacher-info-row teacher-row-one"><div class="teacher-info-card teacher-security-card"><div class="teacher-info-content-container"><div class="teacher-info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Password</div> <div class="teacher-info-value">Change your account password for security</div></div></div> <div class="teacher-security-actions"><button class="teacher-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),$y=_('<div class="teacher-profile-container"><!></div>');function Ny(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a),l=()=>Ja(Ei,"$teacherProfileStore",a);let c=Lt(o),u=Lt(()=>l().teacherData),f=Lt(()=>l().teacherProfileData),m=Lt(()=>l().teacherSections),h=Lt(()=>l().isLoading),g=Lt(()=>l().error),b=at(!1);Ss(()=>{if(e(c)?.userData?.id&&!e(b)){d(b,!0);const W=e(c).userData.id;console.log("Loading teacher profile for ID:",W);const H=Ei.init(W);Ei.loadProfile(W,H)}}),Ua(()=>{const W=setInterval(async()=>{e(c)?.userData?.id&&await Ei.loadProfile(e(c).userData.id,!0)},3e5);return()=>{clearInterval(W)}});async function y(){if(!e(c)?.isAuthenticated||!e(c)?.userData?.id){console.error("User not authenticated");return}const W=e(c).userData.id;await Ei.forceRefresh(W)}let x=Lt(()=>({id:e(u)?.number||e(c)?.userData?.accountNumber||"N/A",name:e(u)?.name||e(c)?.userData?.name||"Teacher Name",firstName:e(u)?.firstName||e(c)?.userData?.firstName||"",lastName:e(u)?.lastName||"",middleInitial:e(u)?.middleInitial||"",department:e(u)?.department||"Not assigned",position:e(u)?.position||"Teacher",email:e(u)?.email||"Not available",phone:e(u)?.contactNumber||"Not available",address:e(u)?.address||"Not available",birthDate:e(u)?.birthdate?new Date(e(u).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(u)?.age||"Not available",gender:e(u)?.gender||e(c)?.userData?.gender||"male",employmentInfo:{hireDate:e(u)?.hireDate?new Date(e(u).hireDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",yearsOfService:e(u)?.yearsOfService||"Not available",employeeId:e(u)?.employeeId||"Not available"},subjects:e(f)?.subjects||[],classes:e(f)?.classes||[],sections:e(f)?.sections||[]})),A=Lt(()=>e(x).subjects.length||"Not available"),C=at(!0),E=at(!0),F=at(!0),S=at(!1);function q(W){const H=document.getElementById(W),X=H.nextElementSibling.querySelector(".password-eye-icon");H.type==="password"?(H.type="text",X.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(H.type="password",X.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=q);async function I(){const W=document.getElementById("current-password"),H=document.getElementById("new-password"),U=document.getElementById("confirm-password");if(!W||!H||!U){vs("Password form inputs not found");return}const X=W.value,B=H.value,oe=U.value;if(!X){vs("Current password is required");return}if(!B){vs("New password is required");return}if(B!==oe){vs("New passwords do not match");return}if(B.length<8){vs("Password must be at least 8 characters long");return}if(X===B){vs("New password must be different from current password");return}try{d(S,!0);const K=await ea.post("/api/change-password",{currentPassword:X,newPassword:B});K.success?(W.value="",H.value="",U.value="",Vr("Password changed successfully!"),ns.close()):vs(K.error||"Failed to change password")}catch(K){vs(K.message||"Failed to change password")}finally{d(S,!1)}}var j=$y(),M=n(j);{var Z=W=>{var H=by(),U=v(n(H),2),X=n(U);i(U);var B=v(U,2);B.__click=y,i(H),O(()=>w(X,`Failed to load profile data: ${e(g)??""}`)),p(W,H)},Q=W=>{var H=Fy(),U=Ue(H),X=v(n(U),2),B=n(X);B.__click=y,i(X),i(U);var oe=v(U,2),K=v(n(oe),2);K.__click=[my,C];var de=v(n(K),2);let ae;i(K);var te=v(K,2);let Ce;var Ae=n(te);{var Re=R=>{var G=yy();p(R,G)},Me=R=>{var G=wy(),ie=Ue(G),_e=n(ie),Y=v(n(_e),2),N=v(n(Y),2),D=n(N,!0);i(N),i(Y),i(_e);var L=v(_e,2),z=v(n(L),2),ve=v(n(z),2),se=n(ve,!0);i(ve),i(z),i(L);var $e=v(L,2),he=v(n($e),2),qe=v(n(he),2),et=n(qe,!0);i(qe),i(he),i($e),i(ie);var Le=v(ie,2),Qe=n(Le),st=v(n(Qe),2),ht=v(n(st),2),_t=n(ht,!0);i(ht),i(st),i(Qe);var xt=v(Qe,2),wt=v(n(xt),2),St=v(n(wt),2),$t=n(St,!0);i(St),i(wt),i(xt);var Nt=v(xt,2),Ut=v(n(Nt),2),kt=v(n(Ut),2),jt=n(kt,!0);i(kt),i(Ut),i(Nt),i(Le),O(()=>{w(D,e(x).id),w(se,e(x).name),w(et,e(x).position),w(_t,e(x).email||"Not provided"),w($t,e(A)),w(jt,e(x).department)}),p(R,G)};$(Ae,R=>{e(h)?R(Re):R(Me,!1)})}i(te),i(oe);var Ge=v(oe,2),be=v(n(Ge),2);be.__click=[hy,E];var ke=v(n(be),2);let Ve;i(be);var it=v(be,2);let Be;var He=n(it);{var Ne=R=>{var G=xy();p(R,G)},Je=R=>{var G=mt(),ie=Ue(G);{var _e=N=>{var D=ky();Tt(D,21,()=>e(m),Ha,(L,z)=>{var ve=mt(),se=Ue(ve);Tt(se,17,()=>e(z).sections,Ha,($e,he)=>{var qe=Sy(),et=v(n(qe),2),Le=n(et),Qe=n(Le,!0);i(Le);var st=v(Le,2),ht=n(st);i(st),i(et),i(qe),O(()=>{w(Qe,e(he).name),w(ht,`${e(z).gradeName??""}  ${e(he).students??""} students`)}),p($e,qe)}),p(L,ve)}),i(D),p(N,D)},Y=N=>{var D=Dy();p(N,D)};$(ie,N=>{e(m).length>0?N(_e):N(Y,!1)},!0)}p(R,G)};$(He,R=>{e(h)?R(Ne):R(Je,!1)})}i(it),i(Ge);var lt=v(Ge,2),Pe=v(n(lt),2);Pe.__click=[gy,F];var we=v(n(Pe),2);let tt;i(Pe);var ct=v(Pe,2);let xe;var Se=n(ct);{var We=R=>{var G=Ay();p(R,G)},Ze=R=>{var G=mt(),ie=Ue(G);{var _e=N=>{var D=Ty();Tt(D,21,()=>e(x).subjects,L=>L.id,(L,z)=>{var ve=Cy(),se=n(ve),$e=n(se);i(se);var he=v(se,2),qe=n(he),et=n(qe,!0);i(qe);var Le=v(qe,2),Qe=n(Le);{var st=_t=>{var xt=_a();O(()=>w(xt,`${e(z).section_count??""} ${e(z).section_count===1?"section":"sections"}`)),p(_t,xt)},ht=_t=>{var xt=_a("No sections assigned");p(_t,xt)};$(Qe,_t=>{e(z).section_count?_t(st):_t(ht,!1)})}i(Le),i(he),i(ve),O(()=>{Ya(ve,`border-color: ${e(z).color??""};`),Ya($e,`background-color: ${e(z).color??""}20; color: ${e(z).color??""}`),w(et,e(z).name)}),p(L,ve)}),i(D),p(N,D)},Y=N=>{var D=Ey();p(N,D)};$(ie,N=>{e(x).subjects.length>0?N(_e):N(Y,!1)},!0)}p(R,G)};$(Se,R=>{e(h)?R(We):R(Ze,!1)})}i(ct),i(lt);var ee=v(lt,2),ue=v(n(ee),2),fe=n(ue),T=n(fe),P=v(n(T),2),le=n(P);le.__click=[_y,I],i(P),i(T),i(fe),i(ue),i(ee),O((R,G,ie,_e,Y,N)=>{B.disabled=e(h),ae=ge(de,1,"material-symbols-outlined teacher-collapse-icon",null,ae,R),Ce=ge(te,1,"teacher-section-content",null,Ce,G),Ve=ge(ke,1,"material-symbols-outlined teacher-collapse-icon",null,Ve,ie),Be=ge(it,1,"teacher-section-content",null,Be,_e),tt=ge(we,1,"material-symbols-outlined teacher-collapse-icon",null,tt,Y),xe=ge(ct,1,"teacher-section-content",null,xe,N)},[()=>({rotated:e(C)}),()=>({collapsed:e(C)}),()=>({rotated:e(E)}),()=>({collapsed:e(E)}),()=>({rotated:e(F)}),()=>({collapsed:e(F)})]),p(W,H)};$(M,W=>{e(g)?W(Z):W(Q,!1)})}i(j),p(s,j),Ga(),r()}Cs(["click"]);const $n="teacherScheduleCache",Py=300*1e3;function Ly(){const{subscribe:s,set:t,update:a}=Qs({scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),r={subscribe:s,init:(o,l)=>{const c=My(o,l);return c?(a(u=>({...u,scheduleData:c.scheduleData,lastUpdated:c.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(o,l=!1)=>{a(c=>({...c,isLoading:o&&!c.isInitialized&&!l,isRefreshing:o&&l,error:o?null:c.error}))},updateScheduleData:(o,l,c,u=!1)=>{const f=Date.now();a(m=>({...m,scheduleData:o,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),bc(o,l,c,f)},setError:(o,l=!1)=>{a(c=>({...c,error:o,isLoading:!1,isRefreshing:!1}))},loadSchedule:async(o,l,c=!1)=>{try{a(g=>({...g,isLoading:!c&&!g.isInitialized,isRefreshing:c,error:null}));let u=l;u||(u=(await(await is("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026");const m=await(await is(`/api/schedules?action=teacher-schedules&teacherId=${o}&schoolYear=${u}`)).json();if(!m.success)throw new Error(m.error||"Failed to fetch schedule data");const h=Iy(m.data);a(g=>({...g,scheduleData:h,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),isInitialized:!0})),bc(h,o,u,Date.now())}catch(u){console.error("Error loading teacher schedule:",u),a(f=>({...f,error:u.message,isLoading:!1,isRefreshing:!1}))}},clearCache:(o,l)=>{try{const c=`${$n}_${o}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear teacher schedule cache:",c)}},forceRefresh:async(o,l)=>{try{const c=`${$n}_${o}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear cache during force refresh:",c)}a(c=>({...c,isInitialized:!1,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}})),await r.loadSchedule(o,l,!1)}};return r}function My(s,t){try{const a=`${$n}_${s}_${t}`,r=localStorage.getItem(a);if(!r)return null;const o=JSON.parse(r);return Date.now()-o.timestamp>Py?(localStorage.removeItem(a),null):{scheduleData:o.scheduleData,lastUpdated:o.timestamp}}catch(a){return console.warn("Failed to retrieve cached teacher schedule:",a),null}}function bc(s,t,a,r){try{const o=`${$n}_${t}_${a}`,l={scheduleData:s,timestamp:r,teacherId:t,schoolYear:a};localStorage.setItem(o,JSON.stringify(l))}catch(o){console.warn("Failed to cache teacher schedule data:",o)}}function Iy(s){const t={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},a={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},r=["blue","green","purple","yellow","orange"];function o(c){return r[c%r.length]}const l={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return s.forEach(c=>{const u=a[c.day_of_week.toLowerCase()];if(u){const f=yc(c.start_time),m=yc(c.end_time);let h,g;c.schedule_type==="subject"?(h=c.section_name,g=c.subject_name||"Unknown Subject"):c.schedule_type==="activity"&&(h=c.activity_type_name||"Activity",g=c.activity_type_name||"Activity");const b={name:h,time:`${f} - ${m}`,room:c.room_name||"TBA",subject:g,gradeLevel:c.grade_level,scheduleType:c.schedule_type,color:o(l[u])};t[u].push(b),l[u]++}}),Object.keys(t).forEach(c=>{const u=t[c],f=Ry(u),m=[...u,...f].sort((h,g)=>{const b=ui(h.time.split(" - ")[0]),y=ui(g.time.split(" - ")[0]);return b-y});t[c]=m}),t}function yc(s){const[t,a]=s.split(":"),r=parseInt(t),o=r>=12?"PM":"AM";return`${(r===0?12:r>12?r-12:r).toString().padStart(2,"0")}:${a} ${o}`}function ui(s){const[t,a]=s.split(" "),[r,o]=t.split(":").map(Number);let l=o;return a==="PM"&&r!==12?l+=(r+12)*60:a==="AM"&&r===12?l+=0:l+=r*60,l}function wc(s){const t=Math.floor(s/60),a=s%60,r=t>=12?"PM":"AM";return`${(t===0?12:t>12?t-12:t).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")} ${r}`}function Ry(s){if(s.length<=1)return[];const t=[...s].sort((r,o)=>{const l=ui(r.time.split(" - ")[0]),c=ui(o.time.split(" - ")[0]);return l-c}),a=[];for(let r=0;r<t.length-1;r++){const o=t[r],l=t[r+1],c=ui(o.time.split(" - ")[1]),u=ui(l.time.split(" - ")[0]);if(u>c){const f=wc(c),m=wc(u);a.push({name:"Vacant Time",time:`${f} - ${m}`,room:"Available",subject:"Free Period",color:"gray",isVacant:!0})}}return a}const Fi=Ly();var jy=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),Oy=_("<button> </button>"),qy=_('<div class="teacher-dropdown-menu"></div>'),Gy=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),Vy=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),By=_('<div class="schedule-class-location"><span class="material-symbols-outlined">schedule</span> <span>Available Time</span></div>'),zy=_('<div class="schedule-class-teacher"><span class="material-symbols-outlined">book</span> <span> </span></div>'),Wy=_('<div class="schedule-class-grade"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Hy=_('<div class="schedule-class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <!>',1),Uy=_('<div><div class="class-header"><h3 class="schedule-class-name"> </h3> <span class="schedule-class-time"> </span></div> <div class="class-details"><!></div></div>'),Yy=_('<div class="schedule-classes-grid"></div>'),Qy=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),Ky=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-schedule-header"><h1 class="schedule-page-title">Teaching Schedule</h1> <p class="schedule-page-subtitle">Your weekly teaching schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="schedule-day-selector"></div> <div class="teacher-mobile-dropdown"><button class="teacher-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function Jy(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(Fi,"$teacherScheduleStore",a),l=()=>Ja(ws,"$authStore",a),c=V(),u=V(),f=V(),m=V(),h=V(),g=V(),b=V(),y=V(),x=V(),A=new Date,C=["January","February","March","April","May","June","July","August","September","October","November","December"],E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],F=C[A.getMonth()],S=A.getDate(),q=E[A.getDay()],I={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},j=A.getDay();let M=V(I[j]||"Mon"),Z=V(new Date),Q;Ua(async()=>{const ee=l();if(!ee.isAuthenticated||!ee.userData?.id){console.error("User not authenticated");return}const ue=ee.userData.id,fe=Fi.init(ue,null);await Fi.loadSchedule(ue,null,fe);const T=setInterval(async()=>{await Fi.loadSchedule(ue,null,!0)},300*1e3);return Q=setInterval(()=>{d(Z,new Date)},6e4),()=>{clearInterval(T),clearInterval(Q)}});async function W(){const ee=l();if(!ee.isAuthenticated||!ee.userData?.id){console.error("User not authenticated");return}const ue=ee.userData.id;await Fi.forceRefresh(ue,null)}const H={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"},U=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}];let X=V(0),B=V(!1);function oe(ee){ee.target.closest(".teacher-mobile-dropdown")||d(B,!1)}function K(){d(B,!e(B))}function de(ee){d(M,ee),d(B,!1)}function ae(ee){if(!e(x)||!ee)return!1;const ue=ee.replace(/\u00A0/g," ").trim(),fe=ue.match(/(.*?)\s*[-]\s*(.*)/);let T,P;if(fe)T=fe[1],P=fe[2];else{const _e=ue.split(" - ");if(_e.length===2)T=_e[0],P=_e[1];else return!1}if(T=T.trim(),P=P.trim(),!T||!P)return!1;const le=te(T),R=te(P),G=e(Z),ie=G.getHours()*60+G.getMinutes();return ie>=le&&ie<R}function te(ee){const ue=ee.match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);if(!ue)return 0;let fe=parseInt(ue[1]);const T=parseInt(ue[2]),P=ue[3].toUpperCase();return P==="PM"&&fe!==12&&(fe+=12),P==="AM"&&fe===12&&(fe=0),fe*60+T}Ft(()=>(e(c),e(u),e(f),e(m),e(h),o()),()=>{(ee=>{d(c,ee.scheduleData),d(u,ee.isLoading),d(f,ee.isRefreshing),d(m,ee.error),d(h,ee.lastUpdated)})(o())}),Ft(()=>(e(c),e(M)),()=>{d(g,e(c)[e(M)]||[])}),Ft(()=>e(M),()=>{d(b,H[e(M)]||"Monday")}),Ft(()=>e(Z),()=>{d(y,I[e(Z).getDay()])}),Ft(()=>(e(y),e(M)),()=>{d(x,e(y)===e(M))}),Ft(()=>(e(M),e(X)),()=>{e(M),mr(X)}),Is(),Ps();var Ce=Ky(),Ae=v(n(Ce),2),Re=n(Ae),Me=n(Re),Ge=n(Me);i(Me),i(Re);var be=v(Re,2);Tt(be,5,()=>U,Ha,(ee,ue)=>{let fe=()=>e(ue).day;var T=jy(),P=n(T),le=n(P,!0);i(P);var R=v(P,2),G=n(R,!0);i(R),i(T),O(()=>{ge(T,1,`schedule-day-btn ${fe()===e(M)?"active":""}`),w(le,fe()),w(G,(fe(),k(()=>H[fe()])))}),De("click",T,()=>de(fe())),p(ee,T)}),i(be);var ke=v(be,2),Ve=n(ke),it=n(Ve),Be=n(it,!0);i(it);var He=v(it,2);i(Ve);var Ne=v(Ve,2);{var Je=ee=>{var ue=qy();Tt(ue,5,()=>U,Ha,(fe,T)=>{let P=()=>e(T).day;var le=Oy(),R=n(le,!0);i(le),O(()=>{ge(le,1,`teacher-dropdown-item ${P()===e(M)?"selected":""}`),w(R,(P(),k(()=>H[P()])))}),De("click",le,()=>de(P())),p(fe,le)}),i(ue),p(ee,ue)};$(Ne,ee=>{e(B)&&ee(Je)})}i(ke),i(Ae);var lt=v(Ae,2),Pe=n(lt),we=n(Pe),tt=n(we);i(we);var ct=v(we,2),xe=n(ct);i(ct),i(Pe);var Se=v(Pe,2);{var We=ee=>{var ue=Gy();p(ee,ue)},Ze=ee=>{var ue=mt(),fe=Ue(ue);{var T=le=>{var R=Vy(),G=v(n(R),4),ie=n(G,!0);i(G);var _e=v(G,2);i(R),O(()=>w(ie,e(m))),De("click",_e,W),p(le,R)},P=le=>{var R=mt(),G=Ue(R);{var ie=Y=>{var N=mt(),D=Ue(N);Ms(D,()=>e(X),L=>{var z=Yy();Tt(z,5,()=>e(g),Ha,(ve,se,$e)=>{var he=Uy();Ya(he,`--card-index: ${$e};`);var qe=n(he),et=n(qe),Le=n(et,!0);i(et);var Qe=v(et,2),st=n(Qe,!0);i(Qe),i(qe);var ht=v(qe,2),_t=n(ht);{var xt=St=>{var $t=By();p(St,$t)},wt=St=>{var $t=Hy(),Nt=Ue($t),Ut=v(n(Nt),2),kt=n(Ut,!0);i(Ut),i(Nt);var jt=v(Nt,2);{var Wt=Yt=>{var pe=zy(),Ke=v(n(pe),2),yt=n(Ke,!0);i(Ke),i(pe),O(()=>w(yt,(e(se),k(()=>e(se).subject)))),p(Yt,pe)};$(jt,Yt=>{e(se),k(()=>e(se).subject)&&Yt(Wt)})}var Kt=v(jt,2);{var aa=Yt=>{var pe=Wy(),Ke=v(n(pe),2),yt=n(Ke);i(Ke),i(pe),O(()=>w(yt,`Grade ${e(se),k(()=>e(se).gradeLevel)??""}`)),p(Yt,pe)};$(Kt,Yt=>{e(se),k(()=>e(se).gradeLevel&&e(se).scheduleType==="subject")&&Yt(aa)})}O(()=>w(kt,(e(se),k(()=>e(se).room)))),p(St,$t)};$(_t,St=>{e(se),k(()=>e(se).scheduleType==="vacant")?St(xt):St(wt,!1)})}i(ht),i(he),O(St=>{ge(he,1,`schedule-class-card ${e(se),k(()=>e(se).color)??""} ${St??""}`),w(Le,(e(se),k(()=>e(se).name))),w(st,(e(se),k(()=>e(se).time)))},[()=>(e(se),k(()=>ae(e(se).time)?"current":""))]),p(ve,he)}),i(z),p(L,z)}),p(Y,N)},_e=Y=>{var N=Qy(),D=v(n(N),4),L=n(D);i(D),i(N),O(()=>w(L,`You don't have any classes scheduled for ${e(b)??""}. Enjoy your free day!`)),p(Y,N)};$(G,Y=>{e(g),k(()=>e(g).length>0)?Y(ie):Y(_e,!1)},!0)}p(le,R)};$(fe,le=>{e(m)?le(T):le(P,!1)},!0)}p(ee,ue)};$(Se,ee=>{e(u)?ee(We):ee(Ze,!1)})}i(lt),i(Ce),O(()=>{w(Ge,`${q??""}, ${F??""} ${S??""}`),w(Be,(e(M),k(()=>H[e(M)]||"Select Day"))),ge(He,1,`material-symbols-outlined teacher-dropdown-icon ${e(B)?"open":""}`),w(tt,`${e(b)??""} Classes`),xe.disabled=e(u)}),De("click",Ve,K),De("click",xe,W),De("click",Ce,oe),De("keydown",Ce,oe),p(s,Ce),Ga(),r()}var Xy=_('<div><div class="stat-card-header"><p class="class-mgmt-stat-label"> </p> <div class="class-mgmt-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="class-mgmt-stat-value"><!></h3></div></div>'),Zy=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your teaching assignments...</p></div>'),e1=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),t1=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Teaching Assignments</h3> <p>You don't have any sections assigned for this school year.</p></div>`),a1=(s,t,a,r)=>t(e(a).yearLevel,e(r).name,e(r).id),s1=_('<span class="more-subjects"> </span>'),r1=_('<div class="section-subjects"><span> </span> <!></div>'),i1=_('<button class="section-card stagger-section-item"><div class="section-card-content"><div class="section-name"> </div> <!></div> <div class="section-card-icon"><span class="material-symbols-outlined">chevron_right</span></div></button>'),n1=_('<div class="year-level-container stagger-item"><div class="year-level-header"><div class="year-level-info"><div class="year-level-icon"><span class="material-symbols-outlined">school</span></div> <div class="year-level-details"><h3 class="year-level-title"> </h3> <p class="year-level-summary"> </p></div></div></div> <div class="sections-grid"></div></div>'),o1=_('<div class="year-levels-grid"></div>'),l1=_('<div class="class-management-container"><div class="class-mgmt-page-header fade-in"><div class="header-content"><h1 class="class-mgmt-page-title">Class Management</h1> <p class="class-mgmt-page-subtitle">Overview of your teaching assignments and student distribution</p></div></div> <div class="class-mgmt-stats-section"><div class="class-mgmt-stats-grid"></div></div> <div class="classes-section-container"><h2 class="class-mgmt-section-title">Year Levels & Sections</h2> <!></div></div>');function xc(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a);let l=at(Os({name:"Loading...",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0})),c=at(Os([])),u=at(!0),f=at(null);function m(I,j,M){t.onNavigateToClassList&&t.onNavigateToClassList({detail:{yearLevel:I,sectionName:j,sectionId:M}})}const h=["border-blue","border-green","border-orange","border-purple"];function g(I){return h[I%h.length]}let b=[{id:"year-levels",label:"Year Levels",getValue:()=>e(l).yearLevels.length,icon:"school",color:"var(--school-primary)"},{id:"sections",label:"Total Sections",getValue:()=>e(l).totalSections,icon:"class",color:"var(--school-secondary)"},{id:"students",label:"Total Students",getValue:()=>e(l).totalStudents,icon:"people",color:"var(--success)"},{id:"average",label:"Average Per Section",getValue:()=>e(l).averagePerSection,icon:"analytics",color:"var(--school-accent)"}];async function y(){try{d(u,!0),d(f,null);const I=o();if(!I.isAuthenticated||!I.userData?.id)throw new Error("User not authenticated");const j=I.userData.id,Z=(await ea.get("/api/current-quarter")).data?.currentSchoolYear||"2025-2026",Q=await ea.get(`/api/teacher-sections?teacherId=${j}&schoolYear=${Z}`);if(!Q.success)throw new Error(Q.error||"Failed to fetch teacher sections");d(c,Q.data.classData,!0),d(l,{name:I.userData.name||"Teacher",yearLevels:Q.data.stats.yearLevels,totalSections:Q.data.stats.totalSections,totalStudents:Q.data.stats.totalStudents,averagePerSection:Q.data.stats.averagePerSection},!0)}catch(I){console.error("Error fetching teacher sections:",I),d(f,I.message,!0),d(c,[],!0),d(l,{name:"Teacher",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0},!0)}finally{d(u,!1)}}Ua(()=>{y()});var x=l1(),A=v(n(x),2),C=n(A);Tt(C,23,()=>b,I=>I.id,(I,j,M)=>{var Z=Xy(),Q=n(Z),W=n(Q),H=n(W,!0);i(W);var U=v(W,2),X=n(U),B=n(X,!0);i(X),i(U),i(Q);var oe=v(Q,2),K=n(oe),de=n(K);{let ae=Lt(()=>e(j).getValue());Jr(de,{get value(){return e(ae)},decimals:0,duration:2})}i(K),i(oe),i(Z),O(ae=>{ge(Z,1,`class-mgmt-stat-card ${ae??""} stagger-item`),Ya(Z,`--stagger-index: ${e(M)??""}`),w(H,e(j).label),w(B,e(j).icon)},[()=>g(e(M))]),p(I,Z)}),i(C),i(A);var E=v(A,2),F=v(n(E),2);{var S=I=>{var j=Zy();p(I,j)},q=I=>{var j=mt(),M=Ue(j);{var Z=W=>{var H=e1(),U=v(n(H),2),X=n(U);i(U);var B=v(U,2);B.__click=y,i(H),O(()=>w(X,`Error: ${e(f)??""}`)),p(W,H)},Q=W=>{var H=mt(),U=Ue(H);{var X=oe=>{var K=t1();p(oe,K)},B=oe=>{var K=o1();Tt(K,23,()=>e(c),de=>de.yearLevel,(de,ae,te)=>{var Ce=n1(),Ae=n(Ce),Re=n(Ae),Me=v(n(Re),2),Ge=n(Me),be=n(Ge,!0);i(Ge);var ke=v(Ge,2),Ve=n(ke);i(ke),i(Me),i(Re),i(Ae);var it=v(Ae,2);Tt(it,23,()=>e(ae).sections,Be=>Be.name,(Be,He,Ne)=>{var Je=i1();Je.__click=[a1,m,ae,He];var lt=n(Je),Pe=n(lt),we=n(Pe,!0);i(Pe);var tt=v(Pe,2);{var ct=xe=>{var Se=r1(),We=n(Se),Ze=n(We,!0);i(We);var ee=v(We,2);{var ue=fe=>{var T=s1(),P=n(T);i(T),O(()=>w(P,`+${e(He).subjects.length-2} more`)),p(fe,T)};$(ee,fe=>{e(He).subjects.length>2&&fe(ue)})}i(Se),O(fe=>w(Ze,fe),[()=>e(He).subjects.slice(0,2).join(", ")]),p(xe,Se)};$(tt,xe=>{e(He).subjects&&e(He).subjects.length>0&&xe(ct)})}i(lt),zt(2),i(Je),O(()=>{Vt(Je,"aria-label",`View class list for ${e(He).name??""}`),Ya(Je,`--stagger-index: ${e(Ne)??""}`),w(we,e(He).name)}),p(Be,Je)}),i(it),i(Ce),O(Be=>{Ya(Ce,`--stagger-index: ${e(te)??""}`),w(be,e(ae).gradeName),w(Ve,`${e(ae).sections.length??""} section${e(ae).sections.length!==1?"s":""}  ${Be??""} students`)},[()=>e(ae).sections.reduce((Be,He)=>Be+He.students,0)]),p(de,Ce)}),i(K),p(oe,K)};$(U,oe=>{e(c).length===0?oe(X):oe(B,!1)},!0)}p(W,H)};$(M,W=>{e(f)?W(Z):W(Q,!1)},!0)}p(I,j)};$(F,I=>{e(u)?I(S):I(q,!1)})}i(E),i(x),p(s,x),Ga(),r()}Cs(["click"]);async function c1(s,t,a,r,o,l,c,u,f,m,h){if(!t.sectionId||!t.subjectId){Fe.error("Missing section or subject information");return}ns.confirm("Send Grades to Adviser","Are you sure you want to send final grades to the adviser?",async()=>{const g=a().filter(y=>!y.isVerified),b=a().length-g.length;if(g.length===0){Fe.warning("All student grades have already been verified by the adviser. No grades to send.");return}d(r,!0),d(o,""),d(l,!1);try{const y=g.map(C=>{const E=c(C.writtenWork,u().writtenWork.totals,"writtenWork"),F=c(C.performanceTasks,u().performanceTasks.totals,"performanceTasks"),S=c(C.quarterlyAssessment,u().quarterlyAssessment.totals,"quarterlyAssessment"),q=f(C);return{student_id:C.accountNumber||C.account_number||C.id,written_work_average:E!==""?parseFloat(E):null,performance_tasks_average:F!==""?parseFloat(F):null,quarterly_assessment_average:S!==""?parseFloat(S):null,final_grade:q!==""?parseFloat(q):null,written_work_items:C.writtenWork||[],performance_tasks_items:C.performanceTasks||[],quarterly_assessment_items:C.quarterlyAssessment||[]}}),x=await is("/api/grades",{method:"POST",body:JSON.stringify({action:"submit_final_grades",section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:m(),teacher_id:h().userData.id,final_grades:y})});if(!x.ok){const C=await x.json().catch(()=>({}));throw console.error("API error response:",C),new Error(C.error||`HTTP ${x.status}: ${x.statusText}`)}const A=await x.json();d(l,!0),b>0?Fe.success(`Final grades sent to adviser for ${g.length} students. ${b} verified students were skipped.`):Fe.success("Final grades have been sent to the adviser successfully!"),setTimeout(()=>{d(o,"")},3e3)}catch(y){console.error("Error saving final grades:",y),d(l,!1),d(o,y.message||"Failed to save final grades",!0),Fe.error(e(o)),setTimeout(()=>{d(o,"")},5e3)}finally{d(r,!1)}},()=>{})}async function d1(s,t,a,r,o,l,c,u,f,m){try{Fe.info("Refreshing grades from database...");const h=t(),g=h.isAuthenticated?h.userData?.id:null,b=new URLSearchParams({sectionId:a.sectionId.toString(),subjectId:a.subjectId.toString(),gradingPeriodId:r().toString()});g&&b.append("teacherId",g.toString());const y=await is(`/api/class-students?${b}`);if(!y.ok)throw new Error(`HTTP ${y.status}: ${y.statusText}`);const x=await y.json();if(x.success&&x.data?.students)o(x.data.students.map(A=>({...A,writtenWork:A.grades?.written_work||[],performanceTasks:A.grades?.performance_tasks||[],quarterlyAssessment:A.grades?.quarterly_assessment||[],grades:A.grades,id:A.account_number||A.id,name:A.full_name||`${A.first_name} ${A.last_name}`,isVerified:A.grades?.verified||A.grades?.verification?.verified||!1}))),l(),d(c,!0),d(u,!1),d(f,m(),!0),Fe.success("Grades refreshed successfully");else throw new Error(x.error||"Failed to refresh grades")}catch(h){console.error("Error refreshing grades:",h),Fe.error("Failed to refresh grades. Please try again.")}}var u1=_('<span class="material-symbols-outlined spinning">sync</span> <span>Saving...</span>',1),v1=_('<span class="material-symbols-outlined">check_circle</span> <span>Grades Saved</span>',1),f1=_('<span class="material-symbols-outlined">save</span> <span>Save Grades</span>',1),p1=_('<span class="material-symbols-outlined spinning">sync</span> <span>Uploading...</span>',1),m1=_('<span class="material-symbols-outlined">upload</span> <span>Send to Adviser</span>',1),h1=_('<div class="spreadsheet-loading-overlay"><div class="spreadsheet-loader"><div class="system-loader"></div> <p>Loading grading spreadsheet...</p></div></div>'),g1=_('<div class="header-overlay"><span class="header-icon material-symbols-outlined">settings</span></div>'),_1=_('<th><span class="header-text"> </span> <!></th>'),b1=_('<input type="text" class="cell-input"/>'),y1=_('<span class="cell-content verified-cell"> </span>'),w1=_('<span class="cell-content"> </span>'),x1=_("<td><!></td>"),S1=_("<tr></tr>"),k1=_('<div class="spreadsheet-container"><table class="spreadsheet-table"><thead><tr></tr></thead><tbody></tbody></table></div>'),D1=_('<div class="save-section"><div class="refresh-button-container"><button class="refresh-grades-button" title="Refresh grades from database"><span class="material-symbols-outlined">refresh</span> <span>Refresh</span></button></div> <div class="save-button-container"><button><!></button> <button class="final-grades-button" title="Upload final grades (averages and computed final grades) to database"><!></button></div></div> <div class="grading-spreadsheet"><!></div>',1);function A1(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a);let l=Pa(t,"students",23,()=>[]),c=Pa(t,"gradingPeriodId",3,1),u=Pa(t,"gradingConfig",23,()=>({writtenWork:{count:3,weight:.3,totals:[]},performanceTasks:{count:3,weight:.5,totals:[]},quarterlyAssessment:{count:1,weight:.2,totals:[]}})),f=at(!1),m=at(!1),h=at(""),g=at(!1),b=at(!1),y=at(!0),x=at(null),A,C=at(null),E=at(!1),F=at(""),S=at(!0),q=at(!1),I=at(Os(new Set)),j=at(Os([]));Os([]);function M(R){if(R==null||R==="")return"0";const G=parseFloat(R);return isNaN(G)?R:(G%1===0,G.toString())}function Z(){return JSON.parse(JSON.stringify(l().map(R=>({id:R.id,writtenWork:Array.isArray(R.writtenWork)?[...R.writtenWork]:[],performanceTasks:Array.isArray(R.performanceTasks)?[...R.performanceTasks]:[],quarterlyAssessment:Array.isArray(R.quarterlyAssessment)?[...R.quarterlyAssessment]:[]}))))}function Q(){if(!e(x))return!1;const R=Z(),G=JSON.stringify(R)!==JSON.stringify(e(x));return d(b,G),d(y,!G),G}function W(){const R=["Student ID","Student Name"];for(let G=1;G<=u().writtenWork.count;G++)R.push(Re("writtenWork",G-1));R.push("WW Avg");for(let G=1;G<=u().performanceTasks.count;G++)R.push(Re("performanceTasks",G-1));R.push("PT Avg");for(let G=1;G<=u().quarterlyAssessment.count;G++)R.push(Re("quarterlyAssessment",G-1));R.push("QA Avg"),R.push("Final Grade"),d(j,[R],!0),l().forEach(G=>{if(!G||!G.id||!G.name){console.warn("Invalid student data:",G);return}const ie=[G.id,G.name],_e=G.writtenWork||[];for(let D=0;D<u().writtenWork.count;D++)ie.push(M(_e[D]));ie.push(H(_e,u().writtenWork.totals,"writtenWork"));const Y=G.performanceTasks||[];for(let D=0;D<u().performanceTasks.count;D++)ie.push(M(Y[D]));ie.push(H(Y,u().performanceTasks.totals,"performanceTasks"));const N=G.quarterlyAssessment||[];for(let D=0;D<u().quarterlyAssessment.count;D++)ie.push(M(N[D]));ie.push(H(N,u().quarterlyAssessment.totals,"quarterlyAssessment")),ie.push(U(G)),e(j).push(ie)}),d(x,Z(),!0),d(y,!1),d(b,!1),d(S,!1)}function H(R,G=null,ie=null){if(!R||!Array.isArray(R))return"";const _e=R.filter(N=>N!=null&&N!=="");if(_e.length===0)return"";let Y=0;if(G&&G.length>0){let N=0,D=0;const L=Math.min(R.length,G.length);for(let ve=0;ve<L;ve++){const se=R[ve];if(se!=null&&se!==""){const $e=parseFloat(se),he=G[ve];if(he&&he>0){const qe=$e/he*100;N+=qe,D++}}}if(D===0)return"";const z=Math.round(N/D*10)/10;return M(z)}else{Y=_e.reduce((D,L)=>D+parseFloat(L),0);const N=Math.round(Y/_e.length*10)/10;return M(N)}}function U(R){if(!R)return"";const G=H(R.writtenWork,u().writtenWork.totals,"writtenWork"),ie=H(R.performanceTasks,u().performanceTasks.totals,"performanceTasks"),_e=H(R.quarterlyAssessment,u().quarterlyAssessment.totals,"quarterlyAssessment");if(G===""||ie===""||_e==="")return"";const Y=parseFloat(G)||0,N=parseFloat(ie)||0,D=parseFloat(_e)||0,L=Y*u().writtenWork.weight+N*u().performanceTasks.weight+D*u().quarterlyAssessment.weight,z=Math.round(L*10)/10;return M(z)}function X(R,G,ie){if(G<2)return;const _e=R-1,Y=l()[_e];if(Y&&Y.isVerified){Fe.warning("This student's grades have been verified by the adviser and cannot be edited.");return}d(C,{row:R,col:G},!0),d(E,!1)}function B(R){if(!e(C)||e(E))return;const{row:G,col:ie}=e(C);if(R.key==="ArrowUp"||R.key==="ArrowDown"||R.key==="ArrowLeft"||R.key==="ArrowRight"){R.preventDefault(),oe(R.key);return}if(R.key==="Enter"){R.preventDefault(),oe("ArrowDown");return}if(R.key==="Tab"){R.preventDefault(),oe(R.shiftKey?"ArrowLeft":"ArrowRight");return}if(/^[0-9.]$/.test(R.key)&&!de(ie)&&ie>1){const _e=G-1,Y=l()[_e];if(Y&&Y.isVerified){Fe.warning("This student's grades have been verified by the adviser and cannot be edited.");return}R.preventDefault(),d(E,!0),d(F,R.key,!0),d(q,!1)}else if(R.key.length===1&&!de(ie)&&ie>1){const _e=G-1,Y=l()[_e];if(Y&&Y.isVerified){Fe.warning("This student's grades have been verified by the adviser and cannot be edited.");return}R.preventDefault(),d(E,!0),d(F,R.key,!0),d(q,!1)}}function oe(R){if(!e(C)||!e(j).length)return;const{row:G,col:ie}=e(C),_e=e(j).length-1,Y=e(j)[0].length-1;let N=G,D=ie;switch(R){case"ArrowUp":N=Math.max(1,G-1);break;case"ArrowDown":N=Math.min(_e,G+1);break;case"ArrowLeft":D=Math.max(0,ie-1);break;case"ArrowRight":D=Math.min(Y,ie+1);break}d(C,{row:N,col:D},!0),K(N,D)}function K(R,G){if(!A)return;const ie=A.querySelector(`tbody tr:nth-child(${R}) td:nth-child(${G+1})`);ie&&ie.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}function de(R){const ie=e(j)[0][R];return ie?.includes("Avg")||ie==="Final Grade"}function ae(R){return Ae(R)!==null}function te(R){const ie=e(j)[0][R];return R<2?"spreadsheet-student-info":ie==="Final Grade"||ie?.includes("Avg")?"calculated":ie?.startsWith("WW")?"written-work":ie?.startsWith("PT")?"performance-task":ie?.startsWith("QA")?"quarterly-assessment":"default"}function Ce(R,G){G.preventDefault(),G.stopPropagation(),ae(R)&&it(R)}function Ae(R){let G=2;for(let ie=0;ie<u().writtenWork.count;ie++){if(G===R)return{assessmentType:"writtenWork",columnIndex:ie};G++}G++;for(let ie=0;ie<u().performanceTasks.count;ie++){if(G===R)return{assessmentType:"performanceTasks",columnIndex:ie};G++}G++;for(let ie=0;ie<u().quarterlyAssessment.count;ie++){if(G===R)return{assessmentType:"quarterlyAssessment",columnIndex:ie};G++}return null}function Re(R,G){const ie=Me(R,G),_e=u()[R].totals[G]||100;return`${ie} - ${_e}`}function Me(R,G){if(u()[R].columnNames&&u()[R].columnNames[G])return u()[R].columnNames[G];const ie=R==="writtenWork"?"WW":R==="performanceTasks"?"PT":"QA";return u()[R].columnPositions&&u()[R].columnPositions[G]!==void 0?`${ie}${u()[R].columnPositions[G]}`:`${ie}${G+1}`}function Ge(){return l().some(R=>R.isVerified||R.verified)}function be(){if(!e(C)||e(C).row===0)return;const{row:R,col:G}=e(C),ie=R-1,_e=l()[ie];if(!_e)return;const Y=Ae(G);if(!Y)return;const{assessmentType:N,columnIndex:D}=Y;let L=e(F).trim(),z=null,ve=!0,se="";if(L!==""){if(z=parseFloat(L),isNaN(z)||z<0)z=0,ve=!1,se=isNaN(parseFloat(L))?"Invalid input. Only numbers are allowed.":"Negative scores are not allowed.";else{const $e=u()[N].totals?.[D];$e&&z>$e&&(z=0,ve=!1,se=`Score cannot exceed the total score of ${$e}.`)}ve?e(I).delete(`${R}-${G}`):(Fe.error(se),e(I).add(`${R}-${G}`),setTimeout(()=>{e(I).delete(`${R}-${G}`),d(I,new Set(e(I)),!0)},3e3))}else z=null,e(I).delete(`${R}-${G}`);_e[N][D]=z,l([...l()]),W(),Q()}function ke(R,G,ie){if(e(C)&&e(E)){if(R.key==="Enter"){R.preventDefault();const _e=e(C).row,Y=e(C).col;be(),d(E,!1),setTimeout(()=>{d(C,{row:_e,col:Y},!0),oe("ArrowDown")},0);return}if(R.key==="Tab"){R.preventDefault();const _e=e(C).row,Y=e(C).col;be(),d(E,!1),setTimeout(()=>{d(C,{row:_e,col:Y},!0),oe(R.shiftKey?"ArrowLeft":"ArrowRight")},0);return}if(R.key==="ArrowUp"||R.key==="ArrowDown"||R.key==="ArrowLeft"||R.key==="ArrowRight"){R.preventDefault();const _e=e(C).row,Y=e(C).col;be(),d(E,!1),setTimeout(()=>{d(C,{row:_e,col:Y},!0),oe(R.key)},0);return}if(R.key==="Escape"){R.preventDefault(),d(E,!1),d(F,"");return}}}async function Ve(){if(!t.sectionId||!t.subjectId){Fe.error("Missing section or subject information");return}d(f,!0),d(h,""),d(g,!1);try{const R=l().map(_e=>({student_id:_e.accountNumber||_e.account_number||_e.id,writtenWork:_e.writtenWork,performanceTasks:_e.performanceTasks,quarterlyAssessment:_e.quarterlyAssessment})),G=await is("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:c(),grading_config:u(),grades:R})});if(!G.ok){const _e=await G.json().catch(()=>({}));throw new Error(_e.error||`HTTP ${G.status}: ${G.statusText}`)}const ie=await G.json();d(g,!0),Fe.success("Grades saved successfully"),d(x,Z(),!0),d(b,!1),d(y,!0),setTimeout(()=>{d(h,"")},3e3)}catch(R){console.error("Error saving grades:",R),d(g,!1),d(h,R.message||"Failed to save grades",!0),Fe.error(e(h)),setTimeout(()=>{d(h,"")},5e3)}finally{d(f,!1)}}Ss(()=>{const R=l().length,G=u(),ie=t.subjectId;k(()=>{(R>0||G||ie)&&W()})}),Ss(()=>()=>{});function it(R){const G=Ae(R);if(!G){Fe.error("Cannot edit this column");return}const{assessmentType:ie,columnIndex:_e}=G,Y=Me(ie,_e),N=u()[ie].totals[_e]||100,D=u()[ie].gradeItemIds?.[_e];if(!D){Fe.error("Cannot edit column: Grade item ID not found");return}const L=Ge();ns.form("Edit Column","Edit the column name and total score for this assessment:",{label:"Column Name",type:"text",placeholder:"Enter column name",value:Y},{label:"Total Score",type:"number",placeholder:"Enter total score",value:N,min:1,max:1e3,disabled:L,disabledReason:L?"Cannot edit total score when grades are verified by adviser":""},async(z,ve)=>{if(!z||!z.trim()){Fe.error("Column name cannot be empty");return}const se=parseInt(ve);if(isNaN(se)||se<1||se>1e3){Fe.error("Total score must be between 1 and 1000");return}try{const $e=await is("/api/grades/grade-items",{method:"PUT",body:JSON.stringify({grade_item_id:D,name:z.trim(),total_score:se})});u()[ie].columnNames||(u()[ie].columnNames=[]),u()[ie].columnNames[_e]=z.trim(),u()[ie].totals[_e]=se,u({...u()}),W(),Fe.success("Column updated successfully")}catch($e){console.error("Error updating column:",$e),Fe.error("Failed to update column. Please try again.")}},()=>{},()=>{ns.confirm("Delete Column",`<p>Are you sure you want to permanently delete the column <strong>"${Y}"</strong>?</p>
          <p class="grading-warning">This action will:</p>
          <ul class="grading-warning-list">
            <li>Permanently delete the column and all its grades</li>
            <li>Remove all student scores for this assessment</li>
            <li>This action cannot be undone</li>
          </ul>`,async()=>{try{const z=await is("/api/grades/grade-items",{method:"DELETE",body:JSON.stringify({grade_item_id:D})});if(!z.ok){const se=await z.json().catch(()=>({error:z.statusText}));throw new Error(se.error||`HTTP ${z.status}: ${z.statusText}`)}const ve=await z.json();u()[ie].count-=1,u()[ie].columnNames&&u()[ie].columnNames.splice(_e,1),u()[ie].totals&&u()[ie].totals.splice(_e,1),u()[ie].columnPositions&&u()[ie].columnPositions.splice(_e,1),u()[ie].gradeItemIds&&u()[ie].gradeItemIds.splice(_e,1),u({...u()}),l(l().map(se=>{const $e={...se};return ie==="writtenWork"&&$e.writtenWork?$e.writtenWork.splice(_e,1):ie==="performanceTasks"&&$e.performanceTasks?$e.performanceTasks.splice(_e,1):ie==="quarterlyAssessment"&&$e.quarterlyAssessment&&$e.quarterlyAssessment.splice(_e,1),$e})),W(),Fe.success("Column deleted successfully")}catch(z){console.error("Error deleting column:",z),Fe.error("Failed to delete column. Please try again.")}},null,{size:"medium"})},{size:"small",deleteDisabled:L,deleteDisabledReason:L?"Cannot delete columns when grades are verified by adviser":""})}var Be=D1();De("keydown",tr,B);var He=Ue(Be),Ne=n(He),Je=n(Ne);Je.__click=[d1,o,t,c,l,W,y,b,x,Z],i(Ne);var lt=v(Ne,2),Pe=n(lt);let we;Pe.__click=Ve;var tt=n(Pe);{var ct=R=>{var G=u1();zt(2),p(R,G)},xe=R=>{var G=mt(),ie=Ue(G);{var _e=N=>{var D=v1();zt(2),p(N,D)},Y=N=>{var D=f1();zt(2),p(N,D)};$(ie,N=>{e(y)&&!e(b)?N(_e):N(Y,!1)},!0)}p(R,G)};$(tt,R=>{e(f)?R(ct):R(xe,!1)})}i(Pe);var Se=v(Pe,2);Se.__click=[c1,t,l,m,h,g,H,u,U,c,o];var We=n(Se);{var Ze=R=>{var G=p1();zt(2),p(R,G)},ee=R=>{var G=m1();zt(2),p(R,G)};$(We,R=>{e(m)?R(Ze):R(ee,!1)})}i(Se),i(lt),i(He);var ue=v(He,2),fe=n(ue);{var T=R=>{var G=h1();p(R,G)},P=R=>{var G=k1(),ie=n(G),_e=n(ie),Y=n(_e);Tt(Y,21,()=>e(j)[0]||[],Ha,(D,L,z)=>{var ve=_1();let se;ve.__click=Le=>Ce(z,Le);var $e=n(ve),he=n($e,!0);i($e);var qe=v($e,2);{var et=Le=>{var Qe=g1();p(Le,Qe)};$(qe,Le=>{ae(z)&&Le(et)})}i(ve),O((Le,Qe)=>{se=ge(ve,1,"spreadsheet-header",null,se,Le),Vt(ve,"title",Qe),w(he,e(L))},[()=>({"spreadsheet-student-info":z<2,calculated:de(z),"final-grade":te(z)==="final-grade",clickable:ae(z)}),()=>ae(z)?"Click to set total scores":""]),p(D,ve)}),i(Y),i(_e);var N=v(_e);Tt(N,21,()=>e(j).slice(1),Ha,(D,L,z)=>{var ve=S1();let se;Tt(ve,21,()=>e(L),Ha,($e,he,qe)=>{var et=x1();let Le;et.__click=_t=>X(z+1,qe);var Qe=n(et);{var st=_t=>{var xt=b1();ia(xt),xt.__keydown=wt=>ke(wt),Nd(xt),De("blur",xt,()=>{be(),d(E,!1)}),ca(xt,()=>e(F),wt=>d(F,wt)),p(_t,xt)},ht=_t=>{var xt=mt(),wt=Ue(xt);{var St=Nt=>{var Ut=y1(),kt=n(Ut,!0);i(Ut),O(()=>w(kt,e(he))),p(Nt,Ut)},$t=Nt=>{var Ut=w1(),kt=n(Ut,!0);i(Ut),O(()=>w(kt,e(he))),p(Nt,Ut)};$(wt,Nt=>{e(E)&&e(C)?.row===z+1&&e(C)?.col===qe&&l()[z]?.isVerified?Nt(St):Nt($t,!1)},!0)}p(_t,xt)};$(Qe,_t=>{e(E)&&e(C)?.row===z+1&&e(C)?.col===qe&&!l()[z]?.isVerified?_t(st):_t(ht,!1)})}i(et),O(_t=>Le=ge(et,1,"spreadsheet-cell",null,Le,_t),[()=>({selected:e(C)?.row===z+1&&e(C)?.col===qe,editing:e(E)&&e(C)?.row===z+1&&e(C)?.col===qe,"spreadsheet-student-info":qe<2,calculated:de(qe),"final-grade":te(qe)==="final-grade",editable:!de(qe)&&qe>1,invalid:e(I).has(`${z+1}-${qe}`)})]),p($e,et)}),i(ve),O($e=>se=ge(ve,1,"spreadsheet-row",null,se,$e),[()=>({verified:l()[z]?.isVerified})]),p(D,ve)}),i(N),i(ie),i(G),Us(G,D=>A=D,()=>A),p(R,G)};$(fe,R=>{e(S)?R(T):R(P,!1)})}i(ue),Us(ue,R=>A=R,()=>A),O(R=>{we=ge(Pe,1,"save-grades-button",null,we,R),Pe.disabled=e(f)||e(y)&&!e(b),Vt(Pe,"title",e(y)&&!e(b)?"All grades are saved":"Save all grades to database"),Se.disabled=e(m)},[()=>({saved:e(y)&&!e(b)})]),p(s,Be);var le=Ga({saveGrades:Ve});return r(),le}Cs(["click","keydown"]);function C1(s,t){d(t,!e(t))}var T1=(s,t)=>t.onBackToClassManagement&&t.onBackToClassManagement(),E1=_('<button><span class="material-symbols-outlined">book</span> </button>'),F1=_('<div class="subject-tab-navigation"></div>'),$1=_('<div class="classlist-quarter-selected-option"><span class="material-symbols-outlined classlist-quarter-option-icon"> </span> <div class="classlist-quarter-option-content"><span class="classlist-quarter-option-name"> </span></div></div>'),N1=_('<span class="classlist-quarter-placeholder">Select quarter</span>'),P1=(s,t,a)=>t(e(a)),L1=_('<button type="button"><span class="material-symbols-outlined classlist-quarter-option-icon"> </span> <div class="classlist-quarter-option-content"><span class="classlist-quarter-option-name"> </span></div></button>'),M1=(s,t)=>t("writtenWork"),I1=(s,t)=>t("performanceTasks"),R1=(s,t)=>t("quarterlyAssessment"),j1=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading class data...</p></div>'),O1=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),q1=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Students Found</h3> <p>This section doesn't have any enrolled students yet.</p></div>`),G1=_('<div class="class-management-container"><div class="classlist-page-header"><div class="header-content"><div class="header-navigation"><button class="back-button"><span class="material-symbols-outlined">arrow_back</span> <span>Back to Class Management</span></button></div> <h1 class="classlist-page-title">Class Grading Sheet</h1> <p class="classlist-page-subtitle"> </p></div> <!></div> <div class="grading-config-section"><div class="config-header"><h2 class="config-title">Grading Configuration</h2> <div class="classlist-quarter-selector-container"><div><button type="button" id="classlist-quarter-select"><!> <span class="material-symbols-outlined classlist-quarter-dropdown-arrow">expand_more</span></button> <div class="classlist-quarter-dropdown-menu"></div></div></div></div> <div class="config-grid"><div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><div class="config-label"> </div> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div></div> <!></div></div> <!>',1);function V1(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a);let l=at(!0),c=at(null),u=at(!1),f=at(!1),m=at(null),h=at(1),g=at("1st Quarter"),b=at("2025-2026"),y=at(!1),x=at(0),A=at(null),C=Lt(()=>e(m)?.subjects?.[e(x)]||null);const E=[{id:1,name:"1st Quarter",icon:"looks_one"},{id:2,name:"2nd Quarter",icon:"looks_two"},{id:3,name:"3rd Quarter",icon:"looks_3"},{id:4,name:"4th Quarter",icon:"looks_4"}],F=Lt(()=>E.find(pe=>pe.id===e(h)));async function S(pe){if(!(!e(m)?.subjects||pe<0||pe>=e(m).subjects.length)){if(e(A)&&typeof e(A).saveGrades=="function")try{await e(A).saveGrades()}catch{}d(x,pe,!0),d(H,{writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}},!0),setTimeout(async()=>{try{await Z(),await W()}catch(Ke){console.error("Error fetching data for subject:",Ke)}},0)}}let q=Lt(()=>e(m)?{yearLevel:e(m).section.grade_level,sectionName:e(m).section.section_name,gradeName:`Grade ${e(m).section.grade_level}`,subject:e(C)?.name||"No Subject",section:`Grade ${e(m).section.grade_level} - ${e(m).section.section_name}`,quarter:e(g),totalStudents:e(m).students?.length||0,adviser:`${e(m).section.adviser_first_name||""} ${e(m).section.adviser_last_name||""}`.trim()||"No Adviser",room:e(m).section.room_name||"No Room"}:t.selectedClass?{yearLevel:t.selectedClass.yearLevel,sectionName:t.selectedClass.sectionName,gradeName:`Grade ${t.selectedClass.yearLevel}`,subject:"Loading...",section:`Grade ${t.selectedClass.yearLevel} - ${t.selectedClass.sectionName}`,quarter:e(g),totalStudents:0}:{yearLevel:7,sectionName:"Section A",gradeName:"Grade 7",subject:"Mathematics",section:"Grade 7 - Section A",quarter:e(g),totalStudents:0}),I=at(Os([]));async function j(){try{const pe=await ea.get("/api/current-quarter");pe.success&&pe.data?(d(h,pe.data.currentQuarter,!0),d(g,pe.data.quarterName,!0),d(b,pe.data.currentSchoolYear||"2025-2026",!0),console.log(`Current quarter set to: ${e(g)} (Quarter ${e(h)})`),console.log(`Current school year set to: ${e(b)}`)):(d(h,1),d(g,"1st Quarter"),d(b,"2025-2026"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter and 2025-2026"))}catch(pe){console.error("Error fetching current quarter:",pe),d(h,1),d(g,"1st Quarter"),d(b,"2025-2026")}}async function M(pe){pe.id!==e(h)?(d(h,pe.id,!0),d(g,pe.name,!0),d(y,!1),await Z(),await W()):d(y,!1)}async function Z(){if(!(!t.selectedClass||!e(C)))try{const pe={id:o().userData.id,name:o().userData.name,account_number:o().userData.accountNumber,account_type:o().userData.account_type||o().userData.accountType},Ke=await fetch(`/api/grades/grade-items?section_id=${t.selectedClass.sectionId}&subject_id=${e(C).id}&grading_period_id=${e(h)}&teacher_id=${o().userData.id}`,{method:"GET",headers:{"Content-Type":"application/json","x-user-info":JSON.stringify(pe)}});if(!Ke.ok)throw new Error(`HTTP error! status: ${Ke.status}`);const Te=(await Ke.json()).data||{},ze={writtenWork:{count:Te.writtenWork?.length||0,weight:.3,label:"Written Work",totals:Te.writtenWork?.map(dt=>dt.totalScore)||[],columnNames:Te.writtenWork?.map(dt=>dt.name)||[],columnPositions:Te.writtenWork?.map((dt,rt)=>rt+1)||[],gradeItemIds:Te.writtenWork?.map(dt=>dt.id)||[]},performanceTasks:{count:Te.performanceTasks?.length||0,weight:.5,label:"Performance Tasks",totals:Te.performanceTasks?.map(dt=>dt.totalScore)||[],columnNames:Te.performanceTasks?.map(dt=>dt.name)||[],columnPositions:Te.performanceTasks?.map((dt,rt)=>rt+1)||[],gradeItemIds:Te.performanceTasks?.map(dt=>dt.id)||[]},quarterlyAssessment:{count:Te.quarterlyAssessment?.length||0,weight:.2,label:"Quarterly Assessment",totals:Te.quarterlyAssessment?.map(dt=>dt.totalScore)||[],columnNames:Te.quarterlyAssessment?.map(dt=>dt.name)||[],columnPositions:Te.quarterlyAssessment?.map((dt,rt)=>rt+1)||[],gradeItemIds:Te.quarterlyAssessment?.map(dt=>dt.id)||[]}};d(H,ze,!0)}catch(pe){console.error("Error fetching grading configuration:",pe),te("Failed to load grading configuration","error")}}async function Q(){if(!e(u))try{if(d(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");const pe=o(),Ke=pe.isAuthenticated?pe.userData?.id:null,yt=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString()});Ke&&yt.append("teacherId",Ke.toString());const ze=await(await fetch(`/api/class-students?${yt}`)).json();if(!ze.success)throw new Error(ze.error||"Failed to fetch section data");d(m,ze.data,!0)}catch(pe){console.error("Error fetching section data:",pe),d(c,pe.message,!0)}}async function W(){if(!e(u))try{if(d(l,!0),d(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");if(!e(C)?.id)return;const pe=o(),Ke=pe.isAuthenticated?pe.userData?.id:null,yt=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString(),schoolYear:e(b)});Ke&&yt.append("teacherId",Ke.toString()),e(C)?.id&&yt.append("subjectId",e(C).id.toString()),e(h)&&yt.append("gradingPeriodId",e(h).toString());const ze=await(await fetch(`/api/class-students?${yt}`)).json();if(!ze.success)throw new Error(ze.error||"Failed to fetch class students");d(m,ze.data,!0),d(I,ze.data.students.map(dt=>({...dt,writtenWork:dt.grades?.written_work||[],performanceTasks:dt.grades?.performance_tasks||[],quarterlyAssessment:dt.grades?.quarterly_assessment||[],grades:dt.grades,id:dt.account_number||dt.id,name:dt.full_name||`${dt.first_name} ${dt.last_name}`,isVerified:dt.grades?.verified||dt.grades?.verification?.verified||!1})),!0)}catch(pe){console.error("Error fetching class students:",pe),d(c,pe.message,!0),d(m,null),d(I,[],!0)}finally{d(l,!1)}}let H=at(Os({writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}})),U=at(""),X=at("error"),B=at(!1);function oe(pe){pe.target.closest(".classlist-quarter-dropdown")||d(y,!1)}function K(){return e(I).some(pe=>pe.isVerified||pe.verified)}async function de(pe){if(e(H)[pe].count<10&&!e(f)&&!e(u))try{if(d(f,!0),!{writtenWork:1,performanceTasks:2,quarterlyAssessment:3}[pe]){console.error("Invalid category:",pe);return}if(!o().isAuthenticated||!o().userData?.id){console.error("User not authenticated");return}const Te={writtenWork:"WW",performanceTasks:"PT",quarterlyAssessment:"QA"},ze=e(H)[pe].count,dt=`${Te[pe]} ${ze+1}`,rt={id:o().userData.id,name:o().userData.name,account_number:o().userData.accountNumber,account_type:o().userData.account_type||o().userData.accountType},vt=await fetch("/api/grades/grade-items",{method:"POST",headers:{"Content-Type":"application/json","x-user-info":JSON.stringify(rt)},body:JSON.stringify({action:"create_grade_item",section_id:t.selectedClass?.sectionId||e(m)?.section?.id,subject_id:e(C)?.id||t.selectedClass?.subjectId||e(m)?.subjects?.[0]?.id,grading_period_id:e(h),teacher_id:o().userData.id,category:pe,name:dt,total_score:100})});if(!vt.ok){const ft=await vt.json();console.error("Failed to add grade item:",ft.error);return}const Rt=await vt.json();if(e(H)[pe].count+=1,e(H)[pe].gradeItemIds||(e(H)[pe].gradeItemIds=[]),e(H)[pe].gradeItemIds.push(Rt.data.id),e(H)[pe].columnNames||(e(H)[pe].columnNames=[]),e(H)[pe].columnNames.push(Rt.data.name),!e(H)[pe].columnPositions){e(H)[pe].columnPositions=[];for(let ft=0;ft<e(H)[pe].count-1;ft++)e(H)[pe].columnPositions[ft]=ft+1}const Zt=e(H)[pe].columnPositions||[];let ma=1;for(;Zt.includes(ma);)ma++;e(H)[pe].columnPositions.push(ma),ae()}catch(Ke){console.error("Error adding column:",Ke)}finally{d(f,!1)}}function ae(){d(I,e(I).map(pe=>pe&&{...pe,writtenWork:Array(e(H).writtenWork.count).fill(0).map((yt,Te)=>pe.writtenWork?.[Te]||0),performanceTasks:Array(e(H).performanceTasks.count).fill(0).map((yt,Te)=>pe.performanceTasks?.[Te]||0),quarterlyAssessment:Array(e(H).quarterlyAssessment.count).fill(0).map((yt,Te)=>pe.quarterlyAssessment?.[Te]||0)}),!0)}function te(pe,Ke="error"){d(B,!1),setTimeout(()=>{d(U,pe,!0),d(X,Ke,!0),d(B,!0)},50)}Ua(async()=>{e(u)||(await j(),await Q(),await new Promise(pe=>setTimeout(pe,0)),e(m)?.subjects&&e(m).subjects.length>0?(e(x)>=e(m).subjects.length&&d(x,0),await W(),await Z()):(d(c,"No subjects found for this section"),d(l,!1)))}),ai(()=>{d(u,!0),d(l,!1)});var Ce=G1();De("click",tr,oe);var Ae=Ue(Ce),Re=n(Ae),Me=n(Re),Ge=n(Me),be=n(Ge);be.__click=[T1,t],i(Ge);var ke=v(Ge,4),Ve=n(ke);i(ke),i(Me);var it=v(Me,2);{var Be=pe=>{var Ke=F1();Tt(Ke,21,()=>e(m).subjects,Ha,(yt,Te,ze)=>{var dt=E1();let rt;dt.__click=()=>S(ze);var vt=v(n(dt));i(dt),O(Rt=>{rt=ge(dt,1,"subject-tab-button",null,rt,Rt),w(vt,` ${e(Te).name??""}`)},[()=>({active:e(x)===ze})]),p(yt,dt)}),i(Ke),p(pe,Ke)};$(it,pe=>{e(m)?.subjects&&e(m).subjects.length>1&&pe(Be)})}i(Re);var He=v(Re,2),Ne=n(He),Je=v(n(Ne),2),lt=n(Je);let Pe;var we=n(lt);let tt;we.__click=[C1,y];var ct=n(we);{var xe=pe=>{var Ke=$1(),yt=n(Ke),Te=n(yt,!0);i(yt);var ze=v(yt,2),dt=n(ze),rt=n(dt,!0);i(dt),i(ze),i(Ke),O(()=>{w(Te,e(F).icon),w(rt,e(F).name)}),p(pe,Ke)},Se=pe=>{var Ke=N1();p(pe,Ke)};$(ct,pe=>{e(F)?pe(xe):pe(Se,!1)})}zt(2),i(we);var We=v(we,2);Tt(We,21,()=>E,pe=>pe.id,(pe,Ke)=>{var yt=L1();let Te;yt.__click=[P1,M,Ke];var ze=n(yt),dt=n(ze,!0);i(ze);var rt=v(ze,2),vt=n(rt),Rt=n(vt,!0);i(vt),i(rt),i(yt),O(Zt=>{Te=ge(yt,1,"classlist-quarter-dropdown-option",null,Te,Zt),w(dt,e(Ke).icon),w(Rt,e(Ke).name)},[()=>({selected:e(h)===e(Ke).id})]),p(pe,yt)}),i(We),i(lt),i(Je),i(Ne);var Ze=v(Ne,2),ee=n(Ze),ue=n(ee),fe=n(ue);i(ue);var T=v(ue,2),P=n(T),le=n(P),R=n(le);{var G=pe=>{var Ke=_a("Loading...");p(pe,Ke)},ie=pe=>{var Ke=_a();O(()=>w(Ke,`${e(H).writtenWork.count??""} Column${e(H).writtenWork.count!==1?"s":""}`)),p(pe,Ke)};$(R,pe=>{e(l)?pe(G):pe(ie,!1)})}i(le),i(P);var _e=v(P,2),Y=n(_e);Y.__click=[M1,de],i(_e),i(T),i(ee);var N=v(ee,2),D=n(N),L=n(D);i(D);var z=v(D,2),ve=n(z),se=n(ve),$e=n(se);{var he=pe=>{var Ke=_a("Loading...");p(pe,Ke)},qe=pe=>{var Ke=_a();O(()=>w(Ke,`${e(H).performanceTasks.count??""} Column${e(H).performanceTasks.count!==1?"s":""}`)),p(pe,Ke)};$($e,pe=>{e(l)?pe(he):pe(qe,!1)})}i(se),i(ve);var et=v(ve,2),Le=n(et);Le.__click=[I1,de],i(et),i(z),i(N);var Qe=v(N,2),st=n(Qe),ht=n(st);i(st);var _t=v(st,2),xt=n(_t),wt=n(xt),St=n(wt);{var $t=pe=>{var Ke=_a("Loading...");p(pe,Ke)},Nt=pe=>{var Ke=_a();O(()=>w(Ke,`${e(H).quarterlyAssessment.count??""} Column${e(H).quarterlyAssessment.count!==1?"s":""}`)),p(pe,Ke)};$(St,pe=>{e(l)?pe($t):pe(Nt,!1)})}i(wt),i(xt);var Ut=v(xt,2),kt=n(Ut);kt.__click=[R1,de],i(Ut),i(_t),i(Qe),i(Ze);var jt=v(Ze,2);{var Wt=pe=>{var Ke=j1();p(pe,Ke)},Kt=pe=>{var Ke=mt(),yt=Ue(Ke);{var Te=dt=>{var rt=O1(),vt=v(n(rt),2),Rt=n(vt);i(vt);var Zt=v(vt,2);Zt.__click=W,i(rt),O(()=>w(Rt,`Error: ${e(c)??""}`)),p(dt,rt)},ze=dt=>{var rt=mt(),vt=Ue(rt);{var Rt=ma=>{var ft=q1();p(ma,ft)},Zt=ma=>{{let ft=Lt(()=>t.selectedClass?.sectionId),ut=Lt(()=>e(C)?.id);Us(A1(ma,{get sectionId(){return e(ft)},get subjectId(){return e(ut)},get gradingPeriodId(){return e(h)},get students(){return e(I)},set students(me){d(I,me,!0)},get gradingConfig(){return e(H)},set gradingConfig(me){d(H,me,!0)}}),me=>d(A,me,!0),()=>e(A))}};$(vt,ma=>{e(I).length===0?ma(Rt):ma(Zt,!1)},!0)}p(dt,rt)};$(yt,dt=>{e(c)?dt(Te):dt(ze,!1)},!0)}p(pe,Ke)};$(jt,pe=>{e(l)?pe(Wt):pe(Kt,!1)})}i(He),i(Ae);var aa=v(Ae,2);{var Yt=pe=>{qd(pe,{get message(){return e(U)},get type(){return e(X)},onClose:()=>d(B,!1)})};$(aa,pe=>{e(B)&&pe(Yt)})}O((pe,Ke,yt,Te,ze,dt,rt,vt,Rt,Zt,ma)=>{w(Ve,`${e(q).section??""}  ${e(q).subject??""}  ${e(q).quarter??""}`),Pe=ge(lt,1,"classlist-quarter-dropdown",null,Pe,pe),tt=ge(we,1,"classlist-quarter-select-button",null,tt,Ke),w(fe,`Written Work (${yt??""}%)`),Y.disabled=Te,Vt(Y,"title",ze),w(L,`Performance Tasks (${dt??""}%)`),Le.disabled=rt,Vt(Le,"title",vt),w(ht,`Quarterly Assessment (${Rt??""}%)`),kt.disabled=Zt,Vt(kt,"title",ma)},[()=>({open:e(y)}),()=>({selected:e(h)}),()=>Math.round(e(H).writtenWork.weight*100),()=>e(H).writtenWork.count>=10||e(f)||K(),()=>K()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(H).performanceTasks.weight*100),()=>e(H).performanceTasks.count>=10||e(f)||K(),()=>K()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(H).quarterlyAssessment.weight*100),()=>e(H).quarterlyAssessment.count>=10||e(f)||K(),()=>K()?"Cannot add columns when grades are verified":"Add Column"]),p(s,Ce),Ga(),r()}Cs(["click"]);async function B1(s,t,a,r,o){const l=e(t).filter(c=>c.finalGrades?.some(u=>u.finalGrade===null||u.finalGrade==="N/A"||u.finalGrade===""));if(l.length>0){const c=l.map(u=>u.full_name).join(", ");Fe.error(`Cannot verify all grades - the following students have N/A grades: ${c}`);return}ns.confirm("Verify All Students","Are you sure you want to verify all grades for all students in this class?",async()=>{try{const c=await ea.post("/api/teacher-advisory",{action:"verify_all_grades",section_id:e(a).section_id,teacher_id:r().userData.id,quarter:e(o),verified:!0});c.success?(d(t,e(t).map(u=>({...u,gradesVerified:!0,finalGrades:u.finalGrades?.map(f=>({...f,verified:!0}))||[],grades:u.grades.map(f=>({...f,verified:!0}))})),!0),Fe.success("All student grades verified successfully")):(console.error("Failed to verify all students:",c.error),Fe.error(c.error||"Failed to verify all students. Please try again."))}catch(c){console.error("Error verifying all students:",c),Fe.error("Failed to verify all students. Please try again.")}},()=>{})}function z1(s,t){d(t,!e(t))}var W1=_('<div class="quarter-selected-option"><span class="material-symbols-outlined quarter-option-icon"> </span> <div class="quarter-option-content"><span class="quarter-option-name"> </span></div></div>'),H1=_('<span class="quarter-placeholder">Select quarter</span>'),U1=(s,t,a)=>t(e(a)),Y1=_('<button type="button"><span class="material-symbols-outlined quarter-option-icon"> </span> <div class="quarter-option-content"><span class="quarter-option-name"> </span></div></button>'),Q1=_('<span class="stat-suffix"> </span>'),K1=_('<div><div class="stat-card-header"><p class="advisory-stat-label"> </p> <div class="advisory-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="advisory-stat-value"><!> <!></h3></div></div>'),J1=_('<div class="students-loading"><div class="system-loader"></div> <p>Loading students and grades...</p></div>'),X1=_('<div class="students-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),Z1=_('<div class="students-empty"><span class="material-symbols-outlined">school</span> <p>No students found in this advisory class</p></div>'),e2=(s,t,a)=>t(e(a)),t2=(s,t,a)=>{s.stopPropagation(),t(e(a).id)},a2=(s,t,a)=>!e(t)?.verified&&a(e(t).id),s2=_('<div class="loading-spinner"></div> <div class="overlay-text">Processing...</div>',1),r2=_('<span class="material-symbols-outlined">verified</span> <div class="overlay-text">Verify</div>',1),i2=_('<small class="submitted-date"> </small>'),n2=_('<small class="submitted-date not-submitted">Grades not submitted yet</small>'),o2=_('<div class="grade-score-display"> </div>'),l2=_('<div class="grade-score-display" style="color: #666;">N/A</div>'),c2=_('<button><div class="grade-overlay"><div class="overlay-content"><!></div></div> <div class="grade-item-header"><div class="grade-info"><div class="subject-name"> </div> <div class="subject-teacher"> </div> <!></div> <div class="grade-controls"><!></div></div></button>'),d2=_('<div class="student-grades"><div class="grades-header"><h4 class="grades-title"> </h4> <div class="student-verification-controls"><button class="verify-btn"><span class="material-symbols-outlined">verified</span> Verify All</button></div></div> <div class="grades-grid"></div></div>'),u2=_('<div><button class="student-header"><div class="student-header-content"><div class="student-title-section"><h3 class="student-title"> </h3></div> <div class="student-info-row"><div class="student-info-item"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined">assignment</span> <span> </span></div></div></div> <div class="student-average"><div class="average-score"> </div></div> <div class="expand-icon"><span class="material-symbols-outlined"> </span></div></button> <!></div>'),v2=_('<div class="advisory-class-container"><div class="advisory-page-header fade-in"><div class="header-content"><h1 class="advisory-page-title">Advisory Class Dashboard</h1> <div class="header-controls"><div class="advisory-class-info"><div class="class-detail"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">meeting_room</span> <span> </span></div></div> <div class="quarter-selector-container"><div><button type="button" id="quarter-select"><!> <span class="material-symbols-outlined quarter-dropdown-arrow">expand_more</span></button> <div class="quarter-dropdown-menu"></div></div></div></div></div></div> <div class="advisory-stats-section"><div class="advisory-stats-grid"></div></div> <div class="students-section"><div class="section-header"><button class="refresh-btn"><span class="material-symbols-outlined">refresh</span> Refresh</button> <div class="bulk-controls"><button class="verify-all-btn"><span class="material-symbols-outlined">verified</span> Verify All Grades</button></div></div> <div class="advisory-students-grid"><!></div></div></div>');function f2(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a);function l(T){if(!T)return null;const P=new Date(T),le=String(P.getMonth()+1).padStart(2,"0"),R=String(P.getDate()).padStart(2,"0"),G=P.getFullYear();return`${le}-${R}-${G}`}let c=at(!0),u=at(null),f=at(Os({averageGrade:null})),m=at(Os([])),h=at(Os(new Set)),g=at(2),b=at("2nd Quarter");async function y(){try{d(c,!0),d(u,null);const T=await ea.get(`/api/teacher-advisory?teacher_id=${o().userData.id}&quarter=${e(g)}`);T.success?(d(f,{...e(f),...T.data.advisoryData},!0),T.data.students&&d(m,T.data.students.map(P=>({id:P.id.toString(),name:P.name,full_name:P.name,studentNumber:P.student_number,gradeLevel:P.grade_level,gradesVerified:P.grades_verified,finalGrades:P.subjects.map(le=>({id:`${P.id}_${le.subject_id}`,subjectName:le.subject_name,subjectCode:le.subject_code,teacherName:le.teacher_name,finalGrade:le.averages.final_grade,verified:le.verified,verifiedAt:le.verified_at,submittedToAdviser:le.submitted_to_adviser})),grades:P.subjects.map(le=>({subject:le.subject_name,teacher:le.teacher_name,grade:le.averages.final_grade,quarter:e(b),verified:le.verified,submittedDate:le.submitted_at?l(le.submitted_at):null,submittedToAdviser:le.submitted_to_adviser,gradeItems:[]}))})),!0)):d(u,T.error||"Failed to fetch advisory data",!0)}catch(T){console.error("Error fetching advisory data:",T),d(u,"Failed to load advisory data. Please try again.")}finally{d(c,!1)}}async function x(){try{const T=await ea.get("/api/current-quarter");T.success&&T.data?(d(g,T.data.currentQuarter,!0),d(b,T.data.quarterName,!0)):(d(g,1),d(b,"1st Quarter"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter"))}catch(T){console.error("Error fetching current quarter:",T),d(g,1),d(b,"1st Quarter")}}Ua(async()=>{o().userData?.id&&(await x(),await y())});const A=Lt(()=>e(m).map(T=>{if(!T.finalGrades||T.finalGrades.length===0)return{...T,average:0,verifiedGradesCount:0,pendingGradesCount:T.grades?.length||0};const le=T.finalGrades.reduce((G,ie)=>G+(ie.finalGrade||0),0)/T.finalGrades.length,R=T.finalGrades?.filter(G=>G.verified)||[];return{...T,average:Math.round(le*10)/10,verifiedGradesCount:R.length,pendingGradesCount:(T.finalGrades?.length||0)-R.length}}));Ss(()=>{if(e(f)&&e(A).length>0){const T=e(A).map(P=>P.average).filter(P=>P!==null&&P>0);T.length>0?e(f).averageGrade=Math.round(T.reduce((P,le)=>P+le,0)/T.length*10)/10:e(f).averageGrade=null}else e(f)&&(e(f).averageGrade=null)});async function C(T){if(!T||e(h).has(T))return;const[P,le]=T.split("_"),R=e(m).find(Y=>Y.id===P),G=R?.finalGrades?.find(Y=>Y.id===T),ie=G?.subjectName||"Unknown Subject",_e=R?.full_name||"Unknown Student";if(G?.finalGrade===null||G?.finalGrade==="N/A"||G?.finalGrade===""){Fe.error(`Cannot verify ${ie} grade for ${_e} - grade is N/A`);return}ns.confirm("Verify Grade",`Are you sure you want to verify the ${ie} grade for ${_e}?`,async()=>{e(h).add(T),d(h,new Set(e(h)),!0);try{const Y=await ea.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:P,section_id:e(f).section_id,teacher_id:o().userData.id,quarter:e(g),verified:!0});Y.success?(d(m,e(m).map(N=>{const D={...N,finalGrades:N.finalGrades?.map(z=>z.id===T?{...z,verified:!0}:z)||[]},L=D.finalGrades?.every(z=>z.verified)||!1;return D.gradesVerified=L,D}),!0),Fe.success(`${ie} grade verified for ${_e}`),e(h).delete(T),d(h,new Set(e(h)),!0)):(console.error("Failed to verify grade:",Y.error),Fe.error(Y.error||"Failed to verify grade. Please try again."),e(h).delete(T),d(h,new Set(e(h)),!0))}catch(Y){console.error("Error verifying grade:",Y),Fe.error("Failed to verify grade. Please try again."),e(h).delete(T),d(h,new Set(e(h)),!0)}},()=>{})}async function E(T){const P=e(m).find(G=>G.id===T),le=P?.full_name||"Unknown Student";if(P?.finalGrades?.some(G=>G.finalGrade===null||G.finalGrade==="N/A"||G.finalGrade==="")){Fe.error(`Cannot verify all grades for ${le} - some grades are N/A`);return}ns.confirm("Verify All Grades",`Are you sure you want to verify all grades for ${le}?`,async()=>{try{const G=await ea.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:T,section_id:e(f).section_id,teacher_id:o().userData.id,quarter:e(g),verified:!0});G.success?(d(m,e(m).map(ie=>ie.id===T?{...ie,gradesVerified:!0,finalGrades:ie.finalGrades?.map(_e=>({..._e,verified:!0}))||[]}:ie),!0),Fe.success(`All grades verified for ${le}`)):(console.error("Failed to verify student grades:",G.error),Fe.error(G.error||"Failed to verify student grades. Please try again."))}catch(G){console.error("Error verifying student grades:",G),Fe.error("Failed to verify student grades. Please try again.")}},()=>{})}const F=["border-blue","border-green","border-orange","border-purple"];function S(T){return F[T%F.length]}const q=Lt(()=>()=>{const T=e(A).filter(R=>R.average>0);if(T.length===0)return 0;const P=T.filter(R=>R.average>=75).length;return Math.round(P/T.length*100)});let I=[{id:"students",label:"Total Students",getValue:()=>e(f)?.totalStudents||0,icon:"people",color:"var(--school-primary)",showAsNumber:!0},{id:"subjects",label:"Subjects Tracked",getValue:()=>e(f)?.subjectsCount||0,icon:"book",color:"var(--school-secondary)",showAsNumber:!0},{id:"average",label:"Class Average",getValue:()=>e(f)&&e(f).averageGrade!==null?e(f).averageGrade:0,icon:"grade",color:"var(--school-accent)",showAsNumber:!0},{id:"passRate",label:"Pass Rate",getValue:()=>e(q)(),icon:"trending_up",color:"var(--success)",showAsNumber:!0,suffix:"%"}],j=at(null),M=at(!1);function Z(T){d(j,e(j)?.id===T.id?null:T,!0)}function Q(T){return T>=90?"var(--success)":T>=80?"var(--school-accent)":T>=75?"var(--warning)":"var(--error)"}const W=[{id:1,name:"1st Quarter",icon:"looks_one"},{id:2,name:"2nd Quarter",icon:"looks_two"},{id:3,name:"3rd Quarter",icon:"looks_3"},{id:4,name:"4th Quarter",icon:"looks_4"}];async function H(T){T.id!==e(g)?(d(g,T.id,!0),d(b,T.name,!0),d(M,!1),await y()):d(M,!1)}function U(T){T.target.closest(".quarter-dropdown")||d(M,!1)}const X=Lt(()=>W.find(T=>T.id===e(g)));var B=v2();De("click",tr,U);var oe=n(B),K=n(oe),de=v(n(K),2),ae=n(de),te=n(ae),Ce=v(n(te),2),Ae=n(Ce,!0);i(Ce),i(te);var Re=v(te,2),Me=v(n(Re),2),Ge=n(Me,!0);i(Me),i(Re),i(ae);var be=v(ae,2),ke=n(be);let Ve;var it=n(ke);let Be;it.__click=[z1,M];var He=n(it);{var Ne=T=>{var P=W1(),le=n(P),R=n(le,!0);i(le);var G=v(le,2),ie=n(G),_e=n(ie,!0);i(ie),i(G),i(P),O(()=>{w(R,e(X).icon),w(_e,e(X).name)}),p(T,P)},Je=T=>{var P=H1();p(T,P)};$(He,T=>{e(X)?T(Ne):T(Je,!1)})}zt(2),i(it);var lt=v(it,2);Tt(lt,21,()=>W,T=>T.id,(T,P)=>{var le=Y1();let R;le.__click=[U1,H,P];var G=n(le),ie=n(G,!0);i(G);var _e=v(G,2),Y=n(_e),N=n(Y,!0);i(Y),i(_e),i(le),O(D=>{R=ge(le,1,"quarter-dropdown-option",null,R,D),w(ie,e(P).icon),w(N,e(P).name)},[()=>({selected:e(g)===e(P).id})]),p(T,le)}),i(lt),i(ke),i(be),i(de),i(K),i(oe);var Pe=v(oe,2),we=n(Pe);Tt(we,23,()=>I,T=>T.id,(T,P,le)=>{var R=K1(),G=n(R),ie=n(G),_e=n(ie,!0);i(ie);var Y=v(ie,2),N=n(Y),D=n(N,!0);i(N),i(Y),i(G);var L=v(G,2),z=n(L),ve=n(z);Ms(ve,()=>e(P).getValue(),he=>{{let qe=Lt(()=>e(P).getValue()),et=Lt(()=>e(P).id==="average"?1:0);Jr(he,{get value(){return e(qe)},get decimals(){return e(et)},duration:2})}});var se=v(ve,2);{var $e=he=>{var qe=Q1(),et=n(qe,!0);i(qe),O(()=>w(et,e(P).suffix)),p(he,qe)};$(se,he=>{e(P).suffix&&he($e)})}i(z),i(L),i(R),O(he=>{ge(R,1,`advisory-stat-card ${he??""} stagger-item`),Ya(R,`--stagger-index: ${e(le)??""}`),w(_e,e(P).label),w(D,e(P).icon)},[()=>S(e(le))]),p(T,R)}),i(we),i(Pe);var tt=v(Pe,2),ct=n(tt),xe=n(ct);xe.__click=y;var Se=v(xe,2),We=n(Se);We.__click=[B1,m,f,o,g],i(Se),i(ct);var Ze=v(ct,2),ee=n(Ze);{var ue=T=>{var P=J1();p(T,P)},fe=T=>{var P=mt(),le=Ue(P);{var R=ie=>{var _e=X1(),Y=v(n(_e),2),N=n(Y);i(Y),i(_e),O(()=>w(N,`Error loading students: ${e(u)??""}`)),p(ie,_e)},G=ie=>{var _e=mt(),Y=Ue(_e);{var N=L=>{var z=Z1();p(L,z)},D=L=>{var z=mt(),ve=Ue(z);Tt(ve,19,()=>e(A),se=>se.id,(se,$e,he)=>{var qe=u2();let et;var Le=n(qe);Le.__click=[e2,Z,$e];var Qe=n(Le),st=n(Qe),ht=n(st),_t=n(ht);i(ht),i(st);var xt=v(st,2),wt=n(xt),St=v(n(wt),2),$t=n(St,!0);i(St),i(wt);var Nt=v(wt,2),Ut=n(Nt),kt=n(Ut,!0);i(Ut);var jt=v(Ut,2),Wt=n(jt,!0);i(jt),i(Nt);var Kt=v(Nt,2),aa=v(n(Kt),2),Yt=n(aa);i(aa),i(Kt),i(xt),i(Qe);var pe=v(Qe,2),Ke=n(pe),yt=n(Ke,!0);i(Ke),i(pe);var Te=v(pe,2),ze=n(Te),dt=n(ze,!0);i(ze),i(Te),i(Le);var rt=v(Le,2);{var vt=Rt=>{var Zt=d2(),ma=n(Zt),ft=n(ma),ut=n(ft);i(ft);var me=v(ft,2),re=n(me);re.__click=[t2,E,$e],i(me),i(ma);var J=v(ma,2);Tt(J,23,()=>e($e).grades,je=>je.subject,(je,Ie,ot)=>{const Xe=Lt(()=>e($e).finalGrades?.find(Ee=>Ee.subjectName===e(Ie).subject));var Mt=c2();let na;Mt.__click=[a2,Xe,C];var gt=n(Mt),Oe=n(gt),bt=n(Oe);{var Et=Ee=>{var nt=s2();zt(2),p(Ee,nt)},qt=Ee=>{var nt=r2();zt(2),p(Ee,nt)};$(bt,Ee=>{e(h).has(e(Xe)?.id)?Ee(Et):Ee(qt,!1)})}i(Oe),i(gt);var Jt=v(gt,2),va=n(Jt),la=n(va),ya=n(la,!0);i(la);var wa=v(la,2),Ea=n(wa);i(wa);var Aa=v(wa,2);{var ja=Ee=>{var nt=i2(),Ct=n(nt);i(nt),O(()=>w(Ct,`Submitted: ${e(Ie).submittedDate||"N/A"}`)),p(Ee,nt)},Ra=Ee=>{var nt=n2();p(Ee,nt)};$(Aa,Ee=>{e(Xe)&&e(Xe).submittedToAdviser&&e(Xe).finalGrade!==null?Ee(ja):Ee(Ra,!1)})}i(va);var $a=v(va,2),ha=n($a);{var fa=Ee=>{var nt=o2(),Ct=n(nt,!0);i(nt),O((Qt,Ot)=>{Ya(nt,`color: ${Qt??""}`),w(Ct,Ot)},[()=>Q(e(Xe).finalGrade),()=>Math.round(e(Xe).finalGrade*10)/10]),p(Ee,nt)},ne=Ee=>{var nt=l2();p(Ee,nt)};$(ha,Ee=>{e(Xe)&&e(Xe).submittedToAdviser&&e(Xe).finalGrade!==null?Ee(fa):Ee(ne,!1)})}i($a),i(Jt),i(Mt),O((Ee,nt)=>{na=ge(Mt,1,`grade-item ${e(Xe)?.verified?"verified":"unverified"} stagger-grade-item`,null,na,Ee),Mt.disabled=nt,Ya(Mt,`--stagger-index: ${e(ot)??""}`),w(ya,e(Ie).subject),w(Ea,`by ${e(Ie).teacher??""}`)},[()=>({loading:e(h).has(e(Xe)?.id)}),()=>e(h).has(e(Xe)?.id)||e(Xe)?.verified]),p(je,Mt)}),i(J),i(Zt),O(()=>w(ut,`Subject Grades (${e(b)??""})`)),p(Rt,Zt)};$(rt,Rt=>{e(j)?.id===e($e).id&&Rt(vt)})}i(qe),O((Rt,Zt)=>{et=ge(qe,1,`advisory-student-card ${e($e).gradesVerified?"verified":"pending"} stagger-item`,null,et,Rt),Ya(qe,`--stagger-index: ${e(he)??""}`),w(_t,`${e($e).name??""}  Grade ${e($e).gradeLevel||"7"}`),w($t,e($e).studentNumber),w(kt,e($e).gradesVerified?"verified":"pending"),w(Wt,e($e).gradesVerified?"Verified":"Pending"),w(Yt,`${e($e).verifiedGradesCount??""} Verified, ${e($e).pendingGradesCount??""} Pending`),Ya(Ke,`color: ${Zt??""}`),w(yt,e($e).average!==null?e($e).average:"N/A"),w(dt,e(j)?.id===e($e).id?"expand_less":"expand_more")},[()=>({selected:e(j)?.id===e($e).id}),()=>e($e).average!==null?Q(e($e).average):"#666"]),p(se,qe)}),p(L,z)};$(Y,L=>{e(A).length===0?L(N):L(D,!1)},!0)}p(ie,_e)};$(le,ie=>{e(u)?ie(R):ie(G,!1)},!0)}p(T,P)};$(ee,T=>{e(c)?T(ue):T(fe,!1)})}i(Ze),i(tt),i(B),O((T,P)=>{w(Ae,e(f)?.sectionName||"Loading..."),w(Ge,e(f)?.roomName||"Loading..."),Ve=ge(ke,1,"quarter-dropdown",null,Ve,T),Be=ge(it,1,"quarter-select-button",null,Be,P)},[()=>({open:e(M)}),()=>({selected:e(g)})]),p(s,B),Ga(),r()}Cs(["click"]);function p2(s,t){d(t,!e(t))}function m2(s,t,a){d(t,!e(t)),a()}var h2=_('<img alt="Profile" class="avatar-image"/>'),g2=_('<div class="avatar-placeholder"> </div>'),_2=(s,t,a)=>{t(),a.onNavigateToSettings()},b2=async(s,t,a)=>{t(),await a.onlogout(),Vr("Logged out successfully. See you next time!")},y2=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),w2=_('<nav class="admin-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">admin_panel_settings</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function x2(s,t){qa(t,!0);let a=Pa(t,"adminName",3,"Admin User"),r=Pa(t,"firstName",3,"Admin"),o=Pa(t,"gender",3,"male"),l=Pa(t,"accountNumber",3,"ADM-2025-0001"),c=Pa(t,"profileImage",3,null);function u(be){return be==="female"?"Ms.":"Mr."}function f(be){if(!be)return"";if(be.includes(","))return be.split(",")[0].trim();const ke=be.trim().split(" ");return ke.length>1?ke[ke.length-1]:ke[0]}let m=Lt(()=>`${u(o())} ${f(a())}`),h=at(!0),g=at(!1);function b(){d(g,!1)}function y(be){e(g)&&!be.target.closest(".user-profile-container")&&b()}Ua(()=>{const be=localStorage.getItem("theme");return d(h,be!=="light"),x(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}});function x(){e(h)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"),A("#121212")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"),A("#FFFFFF"))}function A(be){let ke=document.querySelector('meta[name="theme-color"]:not([media])');ke||(ke=document.createElement("meta"),ke.setAttribute("name","theme-color"),document.head.appendChild(ke)),ke.setAttribute("content",be)}function C(be){return be.split(" ").map(ke=>ke.charAt(0)).join("").toUpperCase().slice(0,2)}var E=w2(),F=n(E),S=n(F),q=n(S);q.__click=function(...be){t.onToggleNavRail?.apply(this,be)};var I=v(q,2),j=v(n(I),2),M=n(j);i(j),i(I),i(S);var Z=v(S,2),Q=n(Z);Q.__click=[m2,h,x];var W=n(Q),H=n(W,!0);i(W),i(Q);var U=v(Q,2),X=n(U);X.__click=[p2,g];var B=n(X),oe=n(B),K=n(oe,!0);i(oe);var de=v(oe,2),ae=n(de);i(de),i(B);var te=v(B,2),Ce=n(te);{var Ae=be=>{var ke=h2();O(()=>Vt(ke,"src",c())),p(be,ke)},Re=be=>{var ke=g2(),Ve=n(ke,!0);i(ke),O(it=>w(Ve,it),[()=>C(r())]),p(be,ke)};$(Ce,be=>{c()?be(Ae):be(Re,!1)})}i(te),i(X);var Me=v(X,2);{var Ge=be=>{var ke=y2(),Ve=n(ke);Ve.__click=[_2,b,t];var it=v(Ve,2);it.__click=[b2,b,t],i(ke),p(be,ke)};$(Me,be=>{e(g)&&be(Ge)})}i(U),i(Z),i(F),i(E),O(()=>{w(M,`Welcome, ${e(m)??""}`),w(H,e(h)?"light_mode":"dark_mode"),w(K,a()),w(ae,`Account: ${l()??""}`)}),p(s,E),Ga()}Cs(["click"]);var S2=(s,t,a)=>t(e(a).id),k2=(s,t,a)=>t(e(a).id),D2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),A2=_('<div class="admin-menu-folder-contents"></div>'),C2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button> <!>',1),T2=(s,t,a)=>t(e(a).id),E2=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),F2=(s,t,a)=>t(e(a).id),$2=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),N2=(s,t,a)=>t(e(a).id),P2=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),L2=(s,t)=>t("management-folder"),M2=(s,t)=>s.key==="Enter"||s.key===" "?t("management-folder"):null,I2=s=>s.stopPropagation(),R2=s=>s.stopPropagation(),j2=(s,t)=>t("management-folder"),O2=(s,t,a,r)=>{t(e(a).id),r("management-folder")},q2=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),G2=_('<div class="admin-menu-mobile-folder-overlay" role="button" tabindex="0" aria-label="Close management folder"><div class="admin-menu-mobile-folder-content" role="dialog" aria-label="Management folder menu" tabindex="-1"><div class="admin-menu-mobile-folder-header"><h3>Management</h3> <button class="admin-menu-close-folder"><span class="material-symbols-outlined">close</span></button></div> <div class="admin-menu-mobile-folder-items"></div></div></div>'),V2=_('<nav aria-label="Admin portal navigation"><div class="admin-menu-rail-container"></div></nav> <nav class="admin-menu-bottom-navigation" aria-label="Admin portal navigation"><div class="admin-menu-nav-container"><!> <!></div></nav>',1);function B2(s,t){qa(t,!0);let a=Pa(t,"adminActiveSection",15,"dashboard"),r=Pa(t,"adminNavRailVisible",3,!0),o=at(!1);const l=[{id:"dashboard",label:"Dashboard",icon:"dashboard",type:"item"},{id:"management-folder",label:"Management",icon:"folder",type:"folder",items:[{id:"schedule-management",label:"Schedule",icon:"schedule"},{id:"department-management",label:"Department",icon:"corporate_fare"},{id:"subjects-and-activities",label:"Subjects & Activities",icon:"school"}]},{id:"account-creation",label:"Account Creation",icon:"person_add",type:"item"},{id:"document-requests",label:"Document Requests",icon:"description",type:"item"},{id:"student-masterlist",label:"Student Masterlist",icon:"groups",type:"item"},{id:"teacher-masterlist",label:"Teacher Masterlist",icon:"school",type:"item"},{id:"student-grades-list",label:"Student Grades List",icon:"grade",type:"item"},{id:"archived-accounts",label:"Archived Accounts",icon:"archive",type:"item"}];function c(F){a(F),t.onnavigate&&t.onnavigate({detail:{section:F}})}function u(F){F==="management-folder"&&d(o,!e(o))}function f(F){return F.items?.some(S=>S.id===a())||!1}var m=V2(),h=Ue(m);let g;var b=n(h);Tt(b,21,()=>l,F=>F.id,(F,S)=>{var q=mt(),I=Ue(q);{var j=Z=>{var Q=C2(),W=Ue(Q);let H;W.__click=[S2,u,S];var U=n(W),X=n(U),B=n(X,!0);i(X),i(U);var oe=v(U,2),K=n(oe,!0);i(oe),i(W);var de=v(W,2);{var ae=te=>{var Ce=A2();Tt(Ce,21,()=>e(S).items,Ae=>Ae.id,(Ae,Re)=>{var Me=D2();let Ge;Me.__click=[k2,c,Re];var be=n(Me),ke=n(be),Ve=n(ke,!0);i(ke),i(be);var it=v(be,2),Be=n(it,!0);i(it),i(Me),O(He=>{Ge=ge(Me,1,"admin-menu-rail-item admin-menu-sub-item",null,Ge,He),Vt(Me,"aria-label",e(Re).label),Vt(Me,"aria-current",e(Re).id===a()?"page":void 0),w(Ve,e(Re).icon),w(Be,e(Re).label)},[()=>({active:e(Re).id===a()})]),p(Ae,Me)}),i(Ce),p(te,Ce)};$(de,te=>{e(o)&&te(ae)})}O(te=>{H=ge(W,1,"admin-menu-rail-item admin-menu-folder",null,H,te),Vt(W,"aria-label",e(S).label),Vt(W,"aria-expanded",e(o)),w(B,e(o)?"folder_open":"folder"),w(K,e(S).label)},[()=>({active:f(e(S)),expanded:e(o)})]),p(Z,Q)},M=Z=>{var Q=E2();let W;Q.__click=[T2,c,S];var H=n(Q),U=n(H),X=n(U,!0);i(U),i(H);var B=v(H,2),oe=n(B,!0);i(B),i(Q),O(K=>{W=ge(Q,1,"admin-menu-rail-item",null,W,K),Vt(Q,"aria-label",e(S).label),Vt(Q,"aria-current",e(S).id===a()?"page":void 0),w(X,e(S).icon),w(oe,e(S).label)},[()=>({active:e(S).id===a()})]),p(Z,Q)};$(I,Z=>{e(S).type==="folder"?Z(j):Z(M,!1)})}p(F,q)}),i(b),i(h);var y=v(h,2),x=n(y),A=n(x);Tt(A,17,()=>l,F=>F.id,(F,S)=>{var q=mt(),I=Ue(q);{var j=Z=>{var Q=$2();let W;Q.__click=[F2,u,S];var H=n(Q),U=n(H),X=n(U,!0);i(U),i(H),i(Q),O(B=>{W=ge(Q,1,"admin-menu-nav-item admin-menu-folder",null,W,B),Vt(Q,"aria-label",e(S).label),Vt(Q,"aria-expanded",e(o)),w(X,e(o)?"folder_open":"folder")},[()=>({active:f(e(S))})]),p(Z,Q)},M=Z=>{var Q=P2();let W;Q.__click=[N2,c,S];var H=n(Q),U=n(H),X=n(U,!0);i(U),i(H),i(Q),O(B=>{W=ge(Q,1,"admin-menu-nav-item",null,W,B),Vt(Q,"aria-label",e(S).label),Vt(Q,"aria-current",e(S).id===a()?"page":void 0),w(X,e(S).icon)},[()=>({active:e(S).id===a()})]),p(Z,Q)};$(I,Z=>{e(S).type==="folder"?Z(j):Z(M,!1)})}p(F,q)});var C=v(A,2);{var E=F=>{var S=G2();S.__click=[L2,u],S.__keydown=[M2,u];var q=n(S);q.__click=[I2],q.__keydown=[R2];var I=n(q),j=v(n(I),2);j.__click=[j2,u],i(I);var M=v(I,2);Tt(M,21,()=>l.find(Z=>Z.id==="management-folder")?.items||[],Z=>Z.id,(Z,Q)=>{var W=q2();let H;W.__click=[O2,c,Q,u];var U=n(W),X=n(U,!0);i(U);var B=v(U,2),oe=n(B,!0);i(B),i(W),O(K=>{H=ge(W,1,"admin-menu-mobile-folder-item",null,H,K),w(X,e(Q).icon),w(oe,e(Q).label)},[()=>({active:e(Q).id===a()})]),p(Z,W)}),i(M),i(q),i(S),p(F,S)};$(C,F=>{e(o)&&F(E)})}i(x),i(y),O(F=>g=ge(h,1,"admin-menu-navigation-rail",null,g,F),[()=>({collapsed:!r()})]),p(s,m),Ga()}Cs(["click","keydown"]);function z2(){const{subscribe:s,set:t,update:a}=Qs({data:[{id:"students",label:"Total Students",value:0,icon:"school",color:"blue"},{id:"teachers",label:"Total Teachers",value:0,icon:"person",color:"green"},{id:"sections",label:"Total Sections",value:0,icon:"class",color:"orange"},{id:"rooms",label:"Total Rooms",value:0,icon:"meeting_room",color:"purple"}],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1,charts:{studentsPerGrade:{data:null,isLoading:!1,error:null,lastUpdated:null},sectionsPerGrade:{data:null,isLoading:!1,error:null,lastUpdated:null}}});return{subscribe:s,init:r=>{r&&a(o=>({...o,data:r,isInitialized:!0,isLoading:!1}))},setLoading:r=>{a(o=>({...o,isLoading:r&&!o.isInitialized}))},updateData:r=>{a(o=>({...o,data:r,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0}));try{localStorage.setItem("dashboard-stats-cache",JSON.stringify({data:r,timestamp:Date.now()}))}catch(o){console.warn("Failed to cache dashboard data:",o)}},setError:r=>{a(o=>({...o,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem("dashboard-stats-cache");if(r){const{data:o,timestamp:l}=JSON.parse(r);if(Date.now()-l<300*1e3)return o}}catch(r){console.warn("Failed to retrieve cached dashboard data:",r)}return null},clearCache:()=>{try{localStorage.removeItem("dashboard-stats-cache"),localStorage.removeItem("dashboard-charts-cache")}catch(r){console.warn("Failed to clear dashboard cache:",r)}},initChartData:(r,o)=>{o&&a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],data:o,isLoading:!1}}}))},setChartLoading:(r,o)=>{a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],isLoading:o}}}))},updateChartData:(r,o)=>{a(l=>({...l,charts:{...l.charts,[r]:{data:o,isLoading:!1,error:null,lastUpdated:new Date}}}));try{const l=`dashboard-chart-${r}-cache`;localStorage.setItem(l,JSON.stringify({data:o,timestamp:Date.now()}))}catch(l){console.warn(`Failed to cache ${r} data:`,l)}},setChartError:(r,o)=>{a(l=>({...l,charts:{...l.charts,[r]:{...l.charts[r],error:o,isLoading:!1}}}))},getCachedChartData:r=>{try{const o=`dashboard-chart-${r}-cache`,l=localStorage.getItem(o);if(l){const{data:c,timestamp:u}=JSON.parse(l);if(Date.now()-u<300*1e3)return c}}catch(o){console.warn(`Failed to retrieve cached ${r} data:`,o)}return null}}}const Ls=z2();var W2=(s,t)=>t("students"),H2=(s,t)=>t("teachers"),U2=_('<div class="chart-loading svelte-1gmj41e"><div class="system-loader svelte-1gmj41e"></div> <p class="svelte-1gmj41e">Loading chart data...</p></div>'),Y2=_('<div class="chart-error svelte-1gmj41e"><span class="material-symbols-outlined svelte-1gmj41e">error</span> <p class="svelte-1gmj41e"> </p></div>'),Q2=_('<div class="legend-item svelte-1gmj41e"><div class="legend-circle svelte-1gmj41e"></div> <span class="legend-text svelte-1gmj41e"> </span></div>'),K2=_('<canvas class="svelte-1gmj41e"></canvas> <div class="graph-label svelte-1gmj41e"></div>',1),J2=_('<div class="ai-loading svelte-1gmj41e"><div class="system-loader svelte-1gmj41e"></div> <p class="svelte-1gmj41e">Generating insights...</p></div>'),X2=_('<div class="ai-error svelte-1gmj41e"><p class="svelte-1gmj41e"> </p></div>'),Z2=_('<div class="ai-content svelte-1gmj41e"><div class="ai-header svelte-1gmj41e"></div> <p class="ai-text svelte-1gmj41e"> </p></div>'),e0=_('<div class="chart-container svelte-1gmj41e"><div class="chart-header svelte-1gmj41e"><h3 class="chart-title svelte-1gmj41e"> </h3> <div class="toggle-buttons svelte-1gmj41e"><button><span class="material-symbols-outlined svelte-1gmj41e">school</span> Students</button> <button><span class="material-symbols-outlined svelte-1gmj41e">person</span> Teachers</button></div></div> <!></div> <div class="ai-insights-container svelte-1gmj41e"><!></div>',1);function t0(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(Ls,"$dashboardStore",a);dr.register(pp,Fm,Yi,Hi,Ui);let l=at(void 0),c,u=at("students"),f=at(Os([])),m=at(!1),h=at(null),g=at(""),b=at(""),y=at(!1),x=at(null),A,C=Lt(()=>o().charts.studentsPerGrade),E=Lt(()=>e(C).isLoading),F=Lt(()=>e(C).error),S=Lt(()=>e(C).data);const q="studentsPerGrade_aiAnalysis",I="studentsPerGrade_cachedData",j="teachersPerDept_aiAnalysis",M="teachersPerDept_cachedData",Z=["7","8","9","10"],Q=["rgb(0, 114, 178)","rgb(230, 159, 0)","rgb(86, 180, 233)","rgb(102, 102, 102)"],W=["rgb(244, 67, 54)","rgb(33, 150, 243)","rgb(76, 175, 80)","rgb(255, 152, 0)","rgb(156, 39, 176)","rgb(0, 188, 212)","rgb(255, 235, 59)","rgb(121, 85, 72)"],H="rgb(158, 158, 158)";async function U(){try{d(m,!0),d(h,null);const[We,Ze]=await Promise.all([ea.get("/api/departments?action=departments"),ea.get("/api/departments?action=teachers")]);if(We.success&&Ze.success){const ee=We.data.filter(P=>P.teacher_count>0),ue=We.data.reduce((P,le)=>P+(le.teacher_count||0),0),T=Ze.data.length-ue;d(f,[...ee],!0),T>0&&e(f).push({name:"Not Assigned",teacher_count:T,isNotAssigned:!0})}else throw new Error(We.error||Ze.error||"Failed to fetch teachers data")}catch(We){console.error("Error fetching teachers data:",We),d(h,We.message,!0)}finally{d(m,!1)}}Ss(()=>{e(l)&&(e(u)==="students"&&e(S)&&!e(E)?setTimeout(()=>{oe(e(S)),X(e(S),"students")},0):e(u)==="teachers"&&e(f).length>0&&!e(m)&&setTimeout(()=>{K(e(f)),X(e(f),"teachers")},0))});async function X(We,Ze){const ee=Ze==="students"?q:j,ue=Ze==="students"?I:M,fe=localStorage.getItem(ue),T=JSON.stringify(We);if(fe===T){const P=localStorage.getItem(ee);if(P){d(g,P,!0),B(P);return}}try{d(y,!0),d(x,null);let P,le;Ze==="students"?(P=Z.map(G=>{const ie=We.find(_e=>_e.grade_level===G);return{grade:G,count:ie?ie.count:0}}),le="studentsPerGrade"):(P=We.map(G=>({department:G.name,count:G.teacher_count})),le="teachersPerDepartment");const R=await ea.post("/api/ai-analysis",{data:P,type:le});if(R.success){const G=R.analysis;localStorage.setItem(ee,G),localStorage.setItem(ue,T),d(g,G,!0),B(G)}else throw new Error(R.error||"Failed to generate AI analysis")}catch(P){console.error("AI Analysis Error:",P),d(x,"Unable to generate insights")}finally{d(y,!1)}}function B(We){A&&clearInterval(A),d(b,"");let Ze=0;A=setInterval(()=>{Ze<We.length?(d(b,e(b)+We[Ze]),Ze++):clearInterval(A)},5)}function oe(We){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const Ze=Z.map(ue=>{const fe=We.find(T=>T.grade_level===ue);return fe?fe.count:0}),ee=e(l).getContext("2d");c=new dr(ee,{type:"doughnut",data:{labels:Z.map(ue=>`Grade ${ue}`),datasets:[{label:"Students",data:Ze,backgroundColor:Q,borderWidth:5,borderRadius:2,borderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim(),hoverBorderWidth:1,hoverBorderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim()}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label(ue){const fe=ue.label||"",T=ue.parsed||0,P=ue.dataset.data.reduce((R,G)=>R+G,0),le=P>0?(T/P*100).toFixed(1):0;return`${fe}: ${T} students (${le}%)`}}}}},plugins:[{id:"centerText",beforeDraw(ue){const{ctx:fe,chartArea:{width:T,height:P}}=ue,R=ue.data.datasets[0].data.reduce((L,z)=>L+z,0),G=getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),ie=32,_e=14,Y=5;fe.save(),fe.textAlign="center",fe.textBaseline="middle",fe.fillStyle=G;const N=T/2,D=P/2;fe.font=`bold ${ie}px sans-serif`,fe.fillText(R,N,D-_e/1.5+Y),fe.font=`400 ${_e}px sans-serif`,fe.fillText("Total Students",N,D+ie/1.8+Y),fe.restore()}}]})}function K(We){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const Ze=We.map(T=>T.name.replace(" Department","")),ee=We.map(T=>T.teacher_count),ue=We.map((T,P)=>T.isNotAssigned?H:W[P%W.length]),fe=e(l).getContext("2d");c=new dr(fe,{type:"doughnut",data:{labels:Ze,datasets:[{label:"Teachers",data:ee,backgroundColor:ue,borderWidth:5,borderRadius:2,borderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim(),hoverBorderWidth:1,hoverBorderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim()}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},title:{display:!1},tooltip:{callbacks:{label(T){const P=T.label||"",le=T.parsed||0,R=T.dataset.data.reduce((ie,_e)=>ie+_e,0),G=R>0?(le/R*100).toFixed(1):0;return`${P}: ${le} teachers (${G}%)`}}}}},plugins:[{id:"centerText",beforeDraw(T){const{ctx:P,chartArea:{width:le,height:R}}=T,ie=T.data.datasets[0].data.reduce((ve,se)=>ve+se,0),_e=getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),Y=32,N=14,D=5;P.save(),P.textAlign="center",P.textBaseline="middle",P.fillStyle=_e;const L=le/2,z=R/2;P.font=`bold ${Y}px sans-serif`,P.fillText(ie,L,z-N/1.5+D),P.font=`400 ${N}px sans-serif`,P.fillText("Total Teachers",L,z+Y/1.8+D),P.restore()}}]})}function de(We){if(d(u,We,!0),We==="teachers"&&e(f).length===0&&!e(m))U();else{const Ze=We==="students"?q:j,ee=localStorage.getItem(Ze);ee?(d(g,ee,!0),d(b,ee,!0)):(d(g,""),d(b,""))}}function ae(){c&&(e(u)==="students"&&e(S)?oe(e(S)):e(u)==="teachers"&&e(f).length>0&&K(e(f)))}Ua(()=>{const We=new MutationObserver(Ze=>{Ze.forEach(ee=>{ee.type==="attributes"&&ee.attributeName==="data-theme"&&ae()})});return We.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{We.disconnect()}}),ai(()=>{c&&c.destroy(),A&&clearInterval(A)});let te=Lt(()=>e(u)==="students"?e(E):e(m)),Ce=Lt(()=>e(u)==="students"?e(F):e(h)),Ae=Lt(()=>e(u)==="students"?"Students per Grade Level":"Teachers per Department"),Re=Lt(()=>e(u)==="students"?Z.map((We,Ze)=>({label:`Grade ${We}`,color:Q[Ze]})):e(f).map((We,Ze)=>({label:We.name.replace(" Department",""),color:We.isNotAssigned?H:W[Ze%W.length]})));var Me=e0(),Ge=Ue(Me),be=n(Ge),ke=n(be),Ve=n(ke,!0);i(ke);var it=v(ke,2),Be=n(it);let He;Be.__click=[W2,de];var Ne=v(Be,2);let Je;Ne.__click=[H2,de],i(it),i(be);var lt=v(be,2);{var Pe=We=>{var Ze=U2();p(We,Ze)},we=We=>{var Ze=mt(),ee=Ue(Ze);{var ue=T=>{var P=Y2(),le=v(n(P),2),R=n(le,!0);i(le),i(P),O(()=>w(R,e(Ce))),p(T,P)},fe=T=>{var P=K2(),le=Ue(P);Us(le,G=>d(l,G),()=>e(l));var R=v(le,2);Tt(R,21,()=>e(Re),Ha,(G,ie)=>{var _e=Q2(),Y=n(_e),N=v(Y,2),D=n(N,!0);i(N),i(_e),O(()=>{Ya(Y,`background-color: ${e(ie).color??""};`),w(D,e(ie).label)}),p(G,_e)}),i(R),p(T,P)};$(ee,T=>{e(Ce)?T(ue):T(fe,!1)},!0)}p(We,Ze)};$(lt,We=>{e(te)?We(Pe):We(we,!1)})}i(Ge);var tt=v(Ge,2),ct=n(tt);{var xe=We=>{var Ze=J2();p(We,Ze)},Se=We=>{var Ze=mt(),ee=Ue(Ze);{var ue=T=>{var P=X2(),le=n(P),R=n(le,!0);i(le),i(P),O(()=>w(R,e(x))),p(T,P)},fe=T=>{var P=mt(),le=Ue(P);{var R=G=>{var ie=Z2(),_e=v(n(ie),2),Y=n(_e,!0);i(_e),i(ie),O(()=>w(Y,e(b))),p(G,ie)};$(le,G=>{e(g)&&G(R)},!0)}p(T,P)};$(ee,T=>{e(x)?T(ue):T(fe,!1)},!0)}p(We,Ze)};$(ct,We=>{e(y)?We(xe):We(Se,!1)})}i(tt),O((We,Ze)=>{w(Ve,e(Ae)),He=ge(Be,1,"toggle-btn svelte-1gmj41e",null,He,We),Je=ge(Ne,1,"toggle-btn svelte-1gmj41e",null,Je,Ze)},[()=>({active:e(u)==="students"}),()=>({active:e(u)==="teachers"})]),p(s,Me),Ga(),r()}Cs(["click"]);var a0=_('<div class="chart-loading svelte-1fxdp77"><div class="system-loader svelte-1fxdp77"></div> <p class="svelte-1fxdp77">Loading chart data...</p></div>'),s0=_('<div class="chart-error svelte-1fxdp77"><span class="material-symbols-outlined svelte-1fxdp77">error</span> <p class="svelte-1fxdp77"> </p></div>'),r0=_('<canvas class="svelte-1fxdp77"></canvas>'),i0=_('<div class="ai-loading svelte-1fxdp77"><div class="system-loader svelte-1fxdp77"></div> <p class="svelte-1fxdp77">Generating insights...</p></div>'),n0=_('<div class="ai-error svelte-1fxdp77"><p class="svelte-1fxdp77"> </p></div>'),o0=_('<div class="ai-content svelte-1fxdp77"><div class="ai-header svelte-1fxdp77"></div> <p class="ai-text svelte-1fxdp77"> </p></div>'),l0=_('<div class="chart-container svelte-1fxdp77"><!></div> <div class="ai-insights-container svelte-1fxdp77"><!></div>',1);function c0(s,t){qa(t,!0);const[a,r]=ks(),o=()=>Ja(Ls,"$dashboardStore",a);dr.register(Pn,Mn,In,Rn,Yi,Hi,Ui);let l=at(void 0),c,u=at(""),f=at(""),m=at(!1),h=at(null),g,b=Lt(()=>o().charts.sectionsPerGrade),y=Lt(()=>e(b).isLoading),x=Lt(()=>e(b).error),A=Lt(()=>e(b).data);const C=["7","8","9","10"],E="sectionsPerGrade_aiAnalysis",F="sectionsPerGrade_cachedData";Ss(()=>{e(A)&&!e(y)&&e(l)&&setTimeout(()=>{I(e(A)),S(e(A))},0)});async function S(K){const de=localStorage.getItem(F),ae=JSON.stringify(K);if(de===ae){const te=localStorage.getItem(E);if(te){d(u,te,!0),q(te);return}}try{d(m,!0),d(h,null);const te=C.map(Ae=>{const Re=K.find(Me=>Me.grade_level===Ae);return{grade:Ae,sections:Re?Re.section_count:0}}),Ce=await ea.post("/api/ai-analysis",{data:te,type:"sectionsPerGrade"});if(Ce.success){const Ae=Ce.analysis;localStorage.setItem(E,Ae),localStorage.setItem(F,ae),d(u,Ae,!0),q(Ae)}else throw new Error(Ce.error||"Failed to generate AI analysis")}catch(te){console.error("AI Analysis Error:",te),d(h,"Unable to generate insights")}finally{d(m,!1)}}function q(K){g&&clearInterval(g),d(f,"");let de=0;g=setInterval(()=>{de<K.length?(d(f,e(f)+K[de]),de++):clearInterval(g)},5)}function I(K){if(!e(l)){console.warn("Canvas not yet available");return}c&&c.destroy();const de=C.map(te=>{const Ce=K.find(Ae=>Ae.grade_level===te);return Ce?Ce.section_count:0}),ae=e(l).getContext("2d");c=new dr(ae,{type:"bar",data:{labels:C.map(te=>`Grade ${te}`),datasets:[{label:"Number of Sections",data:de,backgroundColor:["rgba(54, 162, 235, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgb(54, 162, 235)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)"],borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,suggestedMax:Math.max(...de)+2,ticks:{stepSize:1,callback(te){return Math.floor(te)},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim()},title:{display:!0,text:"Number of Sections",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:12,weight:"bold"}}},x:{ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,text:"Sections per Grade Level",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(te){return`Sections: ${te.parsed.y||0}`}}}}}})}function j(){c&&e(A)&&I(e(A))}Ua(()=>{const K=new MutationObserver(de=>{de.forEach(ae=>{ae.type==="attributes"&&ae.attributeName==="data-theme"&&j()})});return K.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{K.disconnect()}}),ai(()=>{c&&c.destroy(),g&&clearInterval(g)});var M=l0(),Z=Ue(M),Q=n(Z);{var W=K=>{var de=a0();p(K,de)},H=K=>{var de=mt(),ae=Ue(de);{var te=Ae=>{var Re=s0(),Me=v(n(Re),2),Ge=n(Me,!0);i(Me),i(Re),O(()=>w(Ge,e(x))),p(Ae,Re)},Ce=Ae=>{var Re=r0();Us(Re,Me=>d(l,Me),()=>e(l)),p(Ae,Re)};$(ae,Ae=>{e(x)?Ae(te):Ae(Ce,!1)},!0)}p(K,de)};$(Q,K=>{e(y)?K(W):K(H,!1)})}i(Z);var U=v(Z,2),X=n(U);{var B=K=>{var de=i0();p(K,de)},oe=K=>{var de=mt(),ae=Ue(de);{var te=Ae=>{var Re=n0(),Me=n(Re),Ge=n(Me,!0);i(Me),i(Re),O(()=>w(Ge,e(h))),p(Ae,Re)},Ce=Ae=>{var Re=mt(),Me=Ue(Re);{var Ge=be=>{var ke=o0(),Ve=v(n(ke),2),it=n(Ve,!0);i(Ve),i(ke),O(()=>w(it,e(f))),p(be,ke)};$(Me,be=>{e(u)&&be(Ge)},!0)}p(Ae,Re)};$(ae,Ae=>{e(h)?Ae(te):Ae(Ce,!1)},!0)}p(K,de)};$(X,K=>{e(m)?K(B):K(oe,!1)})}i(U),p(s,M),Ga(),r()}var d0=_('<div class="stats-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),u0=_('<div><div class="stat-card-header"><p class="stat-label"> </p> <div class="dashboard-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="stat-card-value"><!></h3></div></div>'),v0=_('<div class="stats-grid"></div>'),f0=_('<div class="activities-loading"><div class="system-loader"></div> <p>Loading recent activities...</p></div>'),p0=_('<div class="activities-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),m0=_('<div class="activities-empty"><span class="material-symbols-outlined">inbox</span> <p>No recent activities found</p></div>'),h0=_('<p class="activity-user"> </p>'),g0=_('<div class="activity-item"><div class="activity-icon"><span class="material-symbols-outlined"> </span></div> <div class="activity-content"><p class="activity-message"> </p> <!></div> <span class="activity-timestamp"> </span></div>'),_0=_('<div class="dashboard-container"><div class="dashboard-header"><div class="header-content"><h1 class="page-title">Admin Dashboard</h1> <p class="page-subtitle">Overview of school management system statistics</p></div></div> <div class="stats-section"><!></div> <div class="graph-row"><div class="accounts-stats-container"><!></div> <div class="average-grades-stats-container"><!></div></div> <div class="activities-section"><div class="section-header"><h2 class="section-title">Activity Logs</h2> <button class="refresh-button" title="Refresh activity logs"><span class="material-symbols-outlined">refresh</span> Refresh</button></div> <div class="activities-list"><!></div></div></div>');function b0(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(Ls,"$dashboardStore",a),l=V(),c=V(),u=V();let f=V([]),m=V(!1),h=V(null);const g=["border-blue","border-green","border-orange","border-purple"];function b(ae){return g[ae%g.length]}async function y(ae=!1){try{ae||Ls.setLoading(!0);const te=await ea.get("/api/dashboard");if(te.success){const Ce=[{id:"students",label:"Total Students",value:te.data.students.toLocaleString(),icon:"school",color:"primary"},{id:"teachers",label:"Total Teachers",value:te.data.teachers.toLocaleString(),icon:"person",color:"primary"},{id:"sections",label:"Total Sections",value:te.data.sections.toLocaleString(),icon:"class",color:"primary"},{id:"rooms",label:"Total Rooms",value:te.data.rooms.toLocaleString(),icon:"meeting_room",color:"primary"}];Ls.updateData(Ce)}else throw new Error(te.error||"Failed to fetch dashboard statistics")}catch(te){console.error("Error fetching dashboard statistics:",te),Ls.setError(te.message)}}async function x(ae=!1){try{ae||Ls.setChartLoading("studentsPerGrade",!0);const te=await ea.get("/api/dashboard/students-per-grade");if(te.success)Ls.updateChartData("studentsPerGrade",te.data);else throw new Error(te.error||"Failed to fetch students per grade data")}catch(te){console.error("Error fetching students per grade:",te),Ls.setChartError("studentsPerGrade",te.message)}}async function A(ae=!1){try{ae||Ls.setChartLoading("sectionsPerGrade",!0);const te=await ea.get("/api/dashboard/sections-per-grade");if(te.success)Ls.updateChartData("sectionsPerGrade",te.data);else throw new Error(te.error||"Failed to fetch sections per grade data")}catch(te){console.error("Error fetching sections per grade:",te),Ls.setChartError("sectionsPerGrade",te.message)}}async function C(ae=!1){try{ae||(d(m,!0),d(h,null));const te=await ea.get("/api/activity-logs");if(te.success)d(f,te.activities);else throw new Error(te.error||"Failed to fetch activities")}catch(te){console.error("Error fetching activities:",te),d(h,te.message)}finally{d(m,!1)}}Ua(()=>{const ae=Ls.getCachedData();ae&&Ls.init(ae);const te=Ls.getCachedChartData("studentsPerGrade");te&&Ls.initChartData("studentsPerGrade",te);const Ce=Ls.getCachedChartData("sectionsPerGrade");Ce&&Ls.initChartData("sectionsPerGrade",Ce),y(!!ae),x(!!te),A(!!Ce),C(!1);const Ae=setInterval(()=>{y(!0),x(!0),A(!0),C(!0)},3e4);return()=>{clearInterval(Ae)}}),Ft(()=>(e(l),e(c),e(u),o()),()=>{(ae=>{d(l,ae.data),d(c,ae.isLoading),d(u,ae.error)})(o())}),Is(),Ps();var E=_0(),F=v(n(E),2),S=n(F);{var q=ae=>{var te=d0(),Ce=v(n(te),2),Ae=n(Ce);i(Ce);var Re=v(Ce,2);i(te),O(()=>w(Ae,`Error loading statistics: ${e(u)??""}`)),De("click",Re,()=>y(!1)),p(ae,te)},I=ae=>{var te=v0();Tt(te,7,()=>e(l),Ce=>Ce.id,(Ce,Ae,Re)=>{var Me=u0(),Ge=n(Me),be=n(Ge),ke=n(be,!0);i(be);var Ve=v(be,2),it=n(Ve),Be=n(it,!0);i(it),i(Ve),i(Ge);var He=v(Ge,2),Ne=n(He),Je=n(Ne);{var lt=we=>{var tt=_a("Loading...");p(we,tt)},Pe=we=>{var tt=_a();O(()=>w(tt,(e(Ae),k(()=>e(Ae).value)))),p(we,tt)};$(Je,we=>{e(c)?we(lt):we(Pe,!1)})}i(Ne),i(He),i(Me),O(we=>{ge(Me,1,`stat-card ${we??""}`),w(ke,(e(Ae),k(()=>e(Ae).label))),w(Be,(e(Ae),k(()=>e(Ae).icon)))},[()=>(js(e(Re)),k(()=>b(e(Re))))]),p(Ce,Me)}),i(te),p(ae,te)};$(S,ae=>{e(u)?ae(q):ae(I,!1)})}i(F);var j=v(F,2),M=n(j),Z=n(M);t0(Z,{}),i(M);var Q=v(M,2),W=n(Q);c0(W,{}),i(Q),i(j);var H=v(j,2),U=n(H),X=v(n(U),2);i(U);var B=v(U,2),oe=n(B);{var K=ae=>{var te=f0();p(ae,te)},de=ae=>{var te=mt(),Ce=Ue(te);{var Ae=Me=>{var Ge=p0(),be=v(n(Ge),2),ke=n(be);i(be),i(Ge),O(()=>w(ke,`Error loading activities: ${e(h)??""}`)),p(Me,Ge)},Re=Me=>{var Ge=mt(),be=Ue(Ge);{var ke=it=>{var Be=m0();p(it,Be)},Ve=it=>{var Be=mt(),He=Ue(Be);Tt(He,1,()=>e(f),Ne=>Ne.id,(Ne,Je)=>{var lt=g0(),Pe=n(lt),we=n(Pe),tt=n(we,!0);i(we),i(Pe);var ct=v(Pe,2),xe=n(ct),Se=n(xe,!0);i(xe);var We=v(xe,2);{var Ze=fe=>{var T=h0(),P=n(T,!0);i(T),O(()=>w(P,(e(Je),k(()=>e(Je).performed_by)))),p(fe,T)};$(We,fe=>{e(Je),k(()=>e(Je).performed_by&&e(Je).performed_by!=="System")&&fe(Ze)})}i(ct);var ee=v(ct,2),ue=n(ee,!0);i(ee),i(lt),O(()=>{w(tt,(e(Je),k(()=>e(Je).icon))),w(Se,(e(Je),k(()=>e(Je).message))),w(ue,(e(Je),k(()=>e(Je).timestamp)))}),p(Ne,lt)}),p(it,Be)};$(be,it=>{e(f),k(()=>e(f).length===0)?it(ke):it(Ve,!1)},!0)}p(Me,Ge)};$(Ce,Me=>{e(h)?Me(Ae):Me(Re,!1)},!0)}p(ae,te)};$(oe,ae=>{e(m)?ae(K):ae(de,!1)})}i(B),i(H),i(E),O(()=>X.disabled=e(m)),De("click",X,()=>C(!1)),p(s,E),Ga(),r()}var y0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),w0=_('<span class="placeholder">Select account type</span>'),x0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),S0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),k0=_('<span class="placeholder">Select gender</span>'),D0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),A0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),C0=_('<span class="placeholder">Select grade level</span>'),T0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),E0=_('<div class="form-group"><label class="form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div>'),F0=_('<span class="email-status checking"><span class="material-symbols-outlined spinning">progress_activity</span></span>'),$0=_('<span class="email-status valid"><span class="material-symbols-outlined">check_circle</span></span>'),N0=_('<span class="email-status error"><span class="material-symbols-outlined">error</span></span>'),P0=_('<p class="form-error"> </p>'),L0=_('<p class="form-success">Email is available</p>'),M0=_('<div class="form-group"><label class="form-label" for="email">Email Address *</label> <div class="email-input-wrapper"><input type="email" id="email" placeholder="Enter email address" required/> <!></div> <!></div>'),I0=_(`<div class="additional-info-section"><h3 class="section-subtitle">Additional Information</h3> <p class="section-description">Required information for student accounts</p> <div class="form-row"><div class="form-group"><label class="form-label" for="birthdate">Birthdate *</label> <input type="date" id="birthdate" class="form-input" required/></div> <div class="form-group"><label class="form-label" for="age">Age</label> <input type="number" id="age" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label" for="address">Address *</label> <textarea id="address" class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label" for="guardian">Guardian/Parent Name *</label> <input type="text" id="guardian" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label" for="contact-number">Guardian's Contact Number *</label> <input type="tel" id="contact-number" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`),R0=_('<span class="auto-label">Loading preview...</span>'),j0=_('<span class="auto-number"> </span> <span class="auto-label">(Preview - will use lowest available)</span>',1),O0=_('<span class="auto-label">Will be auto-assigned (lowest available number)</span>'),q0=_('<span class="placeholder-number">Select account type first</span>'),G0=_('<span class="material-symbols-outlined">person_add</span> Create Account',1),V0=_('<button type="button" class="account-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),B0=_('<div class="account-filter-selected-option"><span class="material-symbols-outlined account-filter-option-icon"> </span> <div class="account-filter-option-content"><span class="account-filter-option-name"> </span></div></div>'),z0=_('<span class="account-filter-placeholder">Filter by type</span>'),W0=_('<button type="button"><span class="material-symbols-outlined account-filter-option-icon"> </span> <div class="account-filter-option-content"><span class="account-filter-option-name"> </span></div></button>'),H0=_('<div class="loading-container"><span class="system-loader"></span> <p class="loading-text">Loading accounts...</p></div>'),U0=_("<p>No accounts created yet.</p>"),Y0=_("<p>No accounts found matching your search or filter.</p>"),Q0=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon">group_off</span> <!></div>'),K0=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),J0=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),X0=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Z0=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),ew=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),tw=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),aw=_('<span class="placeholder">Select grade level</span>'),sw=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),rw=_(`<div class="form-group"><label class="form-label">Grade Level</label> <div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="additional-info-section"><h4 class="section-subtitle">Additional Information</h4> <p class="section-description">Update student additional information</p> <div class="form-row"><div class="form-group"><label class="form-label">Birthdate *</label> <input type="date" class="form-input" required/></div> <div class="form-group"><label class="form-label">Age</label> <input type="number" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label">Address *</label> <textarea class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label">Guardian/Parent Name *</label> <input type="text" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label">Guardian's Contact Number *</label> <input type="tel" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`,1),iw=_('<div class="edit-form-section"><div class="edit-form-container"><div class="edit-form-header"><h4 class="edit-form-title">Edit Account Information</h4> <p class="edit-form-subtitle">Update the name information for this account</p></div> <form class="edit-form-content"><div class="edit-name-fields-row"><div class="form-group"><label class="form-label">Last Name *</label> <input type="text" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label">First Name *</label> <input type="text" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label">M.I.</label> <input type="text" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <div class="edit-form-actions"><a><button type="button" class="account-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),nw=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"> </h3></div> <div class="account-action-buttons"><a><button type="button" class="account-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="account-remove-button" title="Remove Account"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="account-details"><div class="account-detail-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <!> <!> <!> <!> <!> <div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),ow=_(`<div class="account-creation-container"><div class="account-header"><div class="header-content"><h1 class="page-title">Account Creation</h1> <p class="page-subtitle">Create new student, teacher, and admin accounts for the system</p></div></div> <div class="creation-form-section"><div class="account-section-header"><h2 class="section-title">Create New Account</h2> <p class="section-subtitle">Fill in the details below to create a new account</p></div> <div class="form-container"><form><div class="account-type-gender-row"><div class="form-group admin"><label class="form-label" for="account-type">Account Type *</label> <div><button type="button" id="account-type"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="form-group"><label class="form-label" for="gender">Gender *</label> <div><button type="button" id="gender"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div> <div class="name-fields-row"><div class="form-group"><label class="form-label" for="last-name">Last Name *</label> <input type="text" id="last-name" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label" for="first-name">First Name *</label> <input type="text" id="first-name" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label" for="middle-initial">M.I.</label> <input type="text" id="middle-initial" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <!> <div class="form-group"><div class="form-label"> </div> <div class="number-display"><!></div> <p class="form-help">Account number will be automatically assigned using the lowest available number.
						Password will be set to the same as the account number.</p></div> <div class="form-actions"><button type="submit"><!></button></div></form></div></div> <div class="recent-accounts-section"><div class="account-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="section-title">All Account Creations</h2> <p class="account-creation-section-subtitle">All accounts in the system</p></div> <div class="account-search-filter-container"><div class="account-search-container"><div class="account-search-input-wrapper"><span class="material-symbols-outlined account-search-icon">search</span> <input type="text" placeholder="Search by name, account number, or account type..." class="account-search-input"/> <!></div></div> <div class="account-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined account-filter-dropdown-arrow">expand_more</span></button> <div class="account-filter-dropdown-menu"></div></div></div></div></div></div> <div class="accounts-grid"><!></div></div></div>`);function lw(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(ws,"$authStore",a),l=V(),c=V(),u=V(),f=V(),m=V(),h=V(),g=V();let b=V(!1),y=V(""),x=V(""),A=V(""),C=V(""),E=V(""),F=V(""),S=V(""),q=V(""),I=V(!1),j=null;const M=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;let Z=V(""),Q=V(""),W=V(""),H=V(""),U=V(0),X=V(!1),B=V(!1),oe=V(!1),K=V(null),de=V(""),ae=V(""),te=V(""),Ce=V(""),Ae=V(!1),Re=V(!1),Me=V(""),Ge=V(""),be=V(""),ke=V(""),Ve=V(0);function it(){const ce=new Date;return ce.setDate(ce.getDate()-1),ce.toISOString().split("T")[0]}function Be(ce){return ce&&ce.split(" ").map(ye=>ye.charAt(0).toUpperCase()+ye.slice(1).toLowerCase()).join(" ")}function He(ce,ye,pt=!1){const It=ce.target.value,Pt=ye==="middleInitial"?It.toUpperCase():Be(It);pt?ye==="firstName"?d(de,Pt):ye==="lastName"?d(ae,Pt):ye==="middleInitial"&&d(te,Pt):ye==="firstName"?d(C,Pt):ye==="lastName"?d(E,Pt):ye==="middleInitial"&&d(F,Pt),ce.target.value=Pt}function Ne(ce){if(!ce)return!1;const ye=ce.replace(/\D/g,"");return ye.startsWith("09")&&ye.length===11}function Je(ce){return ce.replace(/\D/g,"").slice(0,11)}function lt(ce,ye=!1){const pt=Je(ce.target.value);ye?d(ke,pt):d(H,pt),ce.target.value=pt}async function Pe(ce){if(d(q,""),!(!ce||ce.trim()==="")){if(!M.test(ce)){d(q,"Invalid email format");return}d(I,!0);try{const ye=await ea.get(`/api/accounts/check-email?email=${encodeURIComponent(ce)}`);ye.valid?ye.exists?d(q,"This email is already registered"):d(q,""):d(q,ye.error||"Invalid email format")}catch(ye){console.error("Error checking email:",ye)}finally{d(I,!1)}}}function we(ce){const ye=ce.target.value.trim().toLowerCase();d(S,ye),j&&clearTimeout(j),ye?j=setTimeout(()=>{Pe(ye)},500):d(q,"")}function tt(ce){if(!ce||ce.length<10)return!0;const ye=new Date(ce),pt=ye.getFullYear(),It=new Date,Pt=It.getFullYear();if(isNaN(ye.getTime())||pt<1900||pt>Pt)return!1;const Gt=new Date(It.getFullYear(),It.getMonth(),It.getDate());return!(new Date(ye.getFullYear(),ye.getMonth(),ye.getDate())>=Gt)}const ct=[{id:"student",name:"Student Account",description:"Create a new student account",icon:"school"},{id:"teacher",name:"Teacher Account",description:"Create a new teacher account",icon:"person"},{id:"admin",name:"Admin Account",description:"Create a new admin account",icon:"admin_panel_settings"}],xe=[{id:"male",name:"Male",icon:"male"},{id:"female",name:"Female",icon:"female"}],Se=[{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let We=V([]),Ze=V(!1),ee=V(""),ue=V("all"),fe=V(!1);const T=[{id:"all",name:"All Accounts",icon:"group"},{id:"student",name:"Student Accounts",icon:"school"},{id:"teacher",name:"Teacher Accounts",icon:"person"},{id:"admin",name:"Admin Accounts",icon:"admin_panel_settings"}];function P(ce){!ce.target.closest(".custom-dropdown")&&!ce.target.closest(".account-filter-dropdown")&&(d(X,!1),d(B,!1),d(oe,!1),d(Ae,!1),d(fe,!1))}async function le(ce){const ye=o().userData;if(ye&&ye.accountNumber===ce.number){Fe.error("You cannot delete your own account while logged in.");return}ns.confirm("Remove Account",`<p>Are you sure you want to remove the account for <strong>"${ce.name}"</strong>?</p>`,async()=>{try{const pt=await ea.delete("/api/accounts",{id:ce.id});if(!pt.success)throw new Error(pt.message||"Failed to delete account");d(We,e(We).filter(It=>It.id!==ce.id)),Fe.success(`Account for "${ce.name}" has been removed successfully`)}catch(pt){console.error("Error deleting account:",pt),Fe.error(`Failed to delete account: ${pt.message}`)}},()=>{},{size:"small"})}function R(ce){if(e(K)===ce.id)d(K,null),d(de,""),d(ae,""),d(te,""),d(Ce,""),d(Me,""),d(Ge,""),d(be,""),d(ke,""),d(Ve,0),d(Ae,!1);else if(d(K,ce.id),ce.firstName&&ce.lastName){if(d(de,ce.firstName),d(ae,ce.lastName),d(te,ce.middleInitial||""),d(Ce,ce.gradeLevel||""),ce.birthdate){const ye=new Date(ce.birthdate),pt=ye.getFullYear(),It=String(ye.getMonth()+1).padStart(2,"0"),Pt=String(ye.getDate()).padStart(2,"0");d(Me,`${pt}-${It}-${Pt}`)}else d(Me,"");d(Ge,ce.address||""),d(be,ce.guardian||""),d(ke,ce.contactNumber||"")}else{const ye=ce.name.split(", ");if(ye.length>=2){d(ae,ye[0]);const It=ye[1].split(" ");d(de,It[0]),It.length>1&&It[1].endsWith(".")?d(te,It[1].replace(".","")):d(te,"")}if(d(Ce,ce.gradeLevel||""),ce.birthdate){const pt=new Date(ce.birthdate),It=pt.getFullYear(),Pt=String(pt.getMonth()+1).padStart(2,"0"),Gt=String(pt.getDate()).padStart(2,"0");d(Me,`${It}-${Pt}-${Gt}`)}else d(Me,"");d(Ge,ce.address||""),d(be,ce.guardian||""),d(ke,ce.contactNumber||"")}}async function G(){if(!e(de)||!e(ae)){Fe.error("Please fill in all required fields.");return}if(e(l)&&e(l).type.toLowerCase()==="student"){if(!e(Me)||!e(Ge)||!e(be)||!e(ke)){Fe.error("Please fill in all required student information fields.");return}if(!Ne(e(ke))){Fe.error("Invalid contact number.");return}}d(Re,!0);try{const ce={id:e(K),firstName:e(de).trim(),lastName:e(ae).trim(),middleInitial:e(te)?e(te).trim():null};e(l)&&e(l).type.toLowerCase()==="student"&&(ce.gradeLevel=e(Ce)||null,ce.birthdate=e(Me)||null,ce.address=e(Ge)?e(Ge).trim():null,ce.guardian=e(be)?e(be).trim():null,ce.contactNumber=e(ke)?e(ke).trim():null);const ye=await ea.put("/api/accounts",ce);ye.success?(d(We,e(We).map(pt=>pt.id===e(K)?ye.account:pt)),Fe.success(ye.message),d(K,null),d(de,""),d(ae,""),d(te,""),d(Ce,""),d(Me,""),d(Ge,""),d(be,""),d(ke,""),d(Ve,0)):Fe.error(ye.error||"Failed to update account")}catch(ce){console.error("Error updating account:",ce),Fe.error("Failed to update account. Please try again.")}finally{d(Re,!1)}}function ie(){d(X,!e(X))}function _e(ce){d(y,ce.id),d(X,!1),ce.id!=="student"&&d(A,"")}function Y(){d(B,!e(B))}function N(ce){d(x,ce.id),d(B,!1)}function D(){d(oe,!e(oe))}function L(ce){d(A,ce.id),d(oe,!1)}function z(){d(Ae,!e(Ae))}function ve(ce){d(Ce,ce.id),d(Ae,!1)}async function se(){if(!e(y)||!e(x)||!e(C)||!e(E)){Fe.error("Please fill in all required fields.");return}if((e(y)==="student"||e(y)==="teacher")&&!e(S)){Fe.error("Please enter an email address.");return}if(e(q)){Fe.error(e(q));return}if(e(I)){Fe.error("Please wait while we verify the email address.");return}if(e(y)==="student"&&!e(A)){Fe.error("Please select a grade level for the student account.");return}if(e(y)==="student"){if(!e(Z)||!e(Q)||!e(W)||!e(H)){Fe.error("Please fill in all additional information fields for the student account.");return}if(!Ne(e(H))){Fe.error("Invalid contact number.");return}}const ce=e(y)==="student"?"Student":e(y)==="teacher"?"Teacher":"Admin",ye=`${e(C)} ${e(F)?e(F)+". ":""}${e(E)}`;ns.confirm("Confirm Account Creation",`<p>Are you sure you want to create a <strong>${ce}</strong> account for <strong>"${ye}"</strong>?</p>`,async()=>{await $e()},()=>{},{size:"small"})}async function $e(){d(b,!0);try{const ce=o().userData,ye=await ea.post("/api/accounts",{accountType:e(y),gender:e(x),gradeLevel:e(A),firstName:e(C),lastName:e(E),middleInitial:e(F),email:e(S),birthdate:e(y)==="student"?e(Z):null,address:e(y)==="student"?e(Q):null,guardian:e(y)==="student"?e(W):null,contactNumber:e(y)==="student"?e(H):null,createdBy:ce?ce.id:null});if(!ye.success)throw new Error(ye.message||"Failed to create account");d(We,[ye.account,...e(We)]);const pt=e(y)==="student"?"Student":e(y)==="teacher"?"Teacher":"Admin";Fe.success(`${pt} account created successfully for ${ye.account.name}! Password is the same as account number: ${ye.account.number}`),d(y,""),d(x,""),d(A,""),d(C,""),d(E,""),d(F,""),d(S,""),d(q,""),d(Z,""),d(Q,""),d(W,""),d(H,""),d(U,0)}catch(ce){console.error("Error creating account:",ce),Fe.error(ce.message||"Failed to create account. Please try again.")}finally{d(b,!1)}}function he(){d(fe,!e(fe))}function qe(ce){d(ue,ce.id),d(fe,!1)}function et(){d(ee,"")}let Le=V(""),Qe=V(!1);async function st(ce){if(!ce){d(Le,"");return}d(Qe,!0);try{const ye=await ea.get(`/api/accounts/next-number?type=${ce}`);d(Le,ye.accountNumber)}catch(ye){console.error("Error fetching next account number:",ye),d(Le,"Error loading preview")}finally{d(Qe,!1)}}async function ht(){d(Ze,!0);try{const ce=await ea.get("/api/accounts");if(!ce.success)throw new Error("Failed to load accounts");d(We,ce.accounts)}catch(ce){console.error("Error loading accounts:",ce),Fe.error("Failed to load existing accounts")}finally{d(Ze,!1)}}Ua(()=>{ht()}),Ft(()=>(e(K),e(We)),()=>{d(l,e(K)?e(We).find(ce=>ce.id===e(K)):null)}),Ft(()=>e(y),()=>{d(c,ct.find(ce=>ce.id===e(y)))}),Ft(()=>e(x),()=>{d(u,xe.find(ce=>ce.id===e(x)))}),Ft(()=>e(A),()=>{d(f,Se.find(ce=>ce.id===e(A)))}),Ft(()=>e(Ce),()=>{d(m,Se.find(ce=>ce.id===e(Ce)))}),Ft(()=>e(Z),()=>{if(e(Z)){const ce=new Date(e(Z)),ye=new Date;let pt=ye.getFullYear()-ce.getFullYear();const It=ye.getMonth()-ce.getMonth();(It<0||It===0&&ye.getDate()<ce.getDate())&&pt--,d(U,pt>=0?pt:0)}else d(U,0)}),Ft(()=>e(Me),()=>{if(e(Me)){const ce=new Date(e(Me)),ye=new Date;let pt=ye.getFullYear()-ce.getFullYear();const It=ye.getMonth()-ce.getMonth();(It<0||It===0&&ye.getDate()<ce.getDate())&&pt--,d(Ve,pt>=0?pt:0)}else d(Ve,0)}),Ft(()=>e(ue),()=>{d(h,T.find(ce=>ce.id===e(ue)))}),Ft(()=>(e(We),e(ue),e(ee)),()=>{d(g,e(We).filter(ce=>{const ye=e(ue)==="all"||ce.type.toLowerCase()===e(ue).toLowerCase(),pt=!e(ee)||ce.name?.toLowerCase().includes(e(ee).toLowerCase())||ce.number?.toString().toLowerCase().includes(e(ee).toLowerCase())||ce.type?.toLowerCase().includes(e(ee).toLowerCase());return ye&&pt}))}),Ft(()=>e(y),()=>{e(y)&&st(e(y))}),Is(),Ps();var _t=ow();De("click",tr,P);var xt=v(n(_t),2),wt=v(n(xt),2),St=n(wt),$t=n(St),Nt=n($t),Ut=v(n(Nt),2);let kt;var jt=n(Ut);let Wt;var Kt=n(jt);{var aa=ce=>{var ye=y0(),pt=n(ye),It=n(pt,!0);i(pt);var Pt=v(pt,2),Gt=n(Pt),da=n(Gt,!0);i(Gt);var ka=v(Gt,2),Ht=n(ka,!0);i(ka),i(Pt),i(ye),O(()=>{w(It,(e(c),k(()=>e(c).icon))),w(da,(e(c),k(()=>e(c).name))),w(Ht,(e(c),k(()=>e(c).description)))}),p(ce,ye)},Yt=ce=>{var ye=w0();p(ce,ye)};$(Kt,ce=>{e(c)?ce(aa):ce(Yt,!1)})}zt(2),i(jt);var pe=v(jt,2);Tt(pe,5,()=>ct,ce=>ce.id,(ce,ye)=>{var pt=x0();let It;var Pt=n(pt),Gt=n(Pt,!0);i(Pt);var da=v(Pt,2),ka=n(da),Ht=n(ka,!0);i(ka);var Ye=v(ka,2),sa=n(Ye,!0);i(Ye),i(da),i(pt),O(Dt=>{It=ge(pt,1,"dropdown-option",null,It,Dt),w(Gt,(e(ye),k(()=>e(ye).icon))),w(Ht,(e(ye),k(()=>e(ye).name))),w(sa,(e(ye),k(()=>e(ye).description)))},[()=>({selected:e(y)===e(ye).id})]),De("click",pt,()=>_e(e(ye))),p(ce,pt)}),i(pe),i(Ut),i(Nt);var Ke=v(Nt,2),yt=v(n(Ke),2);let Te;var ze=n(yt);let dt;var rt=n(ze);{var vt=ce=>{var ye=S0(),pt=n(ye),It=n(pt,!0);i(pt);var Pt=v(pt,2),Gt=n(Pt),da=n(Gt,!0);i(Gt),i(Pt),i(ye),O(()=>{w(It,(e(u),k(()=>e(u).icon))),w(da,(e(u),k(()=>e(u).name)))}),p(ce,ye)},Rt=ce=>{var ye=k0();p(ce,ye)};$(rt,ce=>{e(u)?ce(vt):ce(Rt,!1)})}zt(2),i(ze);var Zt=v(ze,2);Tt(Zt,5,()=>xe,ce=>ce.id,(ce,ye)=>{var pt=D0();let It;var Pt=n(pt),Gt=n(Pt,!0);i(Pt);var da=v(Pt,2),ka=n(da),Ht=n(ka,!0);i(ka),i(da),i(pt),O(Ye=>{It=ge(pt,1,"dropdown-option",null,It,Ye),w(Gt,(e(ye),k(()=>e(ye).icon))),w(Ht,(e(ye),k(()=>e(ye).name)))},[()=>({selected:e(x)===e(ye).id})]),De("click",pt,()=>N(e(ye))),p(ce,pt)}),i(Zt),i(yt),i(Ke);var ma=v(Ke,2);{var ft=ce=>{var ye=E0(),pt=v(n(ye),2);let It;var Pt=n(pt);let Gt;var da=n(Pt);{var ka=sa=>{var Dt=A0(),Bt=n(Dt),ra=n(Bt,!0);i(Bt);var ua=v(Bt,2),Oa=n(ua),Ta=n(Oa,!0);i(Oa),i(ua),i(Dt),O(()=>{w(ra,(e(f),k(()=>e(f).icon))),w(Ta,(e(f),k(()=>e(f).name)))}),p(sa,Dt)},Ht=sa=>{var Dt=C0();p(sa,Dt)};$(da,sa=>{e(f)?sa(ka):sa(Ht,!1)})}zt(2),i(Pt);var Ye=v(Pt,2);Tt(Ye,5,()=>Se,sa=>sa.id,(sa,Dt)=>{var Bt=T0();let ra;var ua=n(Bt),Oa=n(ua,!0);i(ua);var Ta=v(ua,2),Ma=n(Ta),za=n(Ma,!0);i(Ma),i(Ta),i(Bt),O(ts=>{ra=ge(Bt,1,"dropdown-option",null,ra,ts),w(Oa,(e(Dt),k(()=>e(Dt).icon))),w(za,(e(Dt),k(()=>e(Dt).name)))},[()=>({selected:e(A)===e(Dt).id})]),De("click",Bt,()=>L(e(Dt))),p(sa,Bt)}),i(Ye),i(pt),i(ye),O((sa,Dt)=>{It=ge(pt,1,"custom-dropdown",null,It,sa),Gt=ge(Pt,1,"dropdown-trigger",null,Gt,Dt)},[()=>({open:e(oe)}),()=>({selected:e(A)})]),De("click",Pt,D),p(ce,ye)};$(ma,ce=>{e(y)==="student"&&ce(ft)})}i($t);var ut=v($t,2),me=n(ut),re=v(n(me),2);ia(re),i(me);var J=v(me,2),je=v(n(J),2);ia(je),i(J);var Ie=v(J,2),ot=v(n(Ie),2);ia(ot),i(Ie),i(ut);var Xe=v(ut,2);{var Mt=ce=>{var ye=M0(),pt=v(n(ye),2),It=n(pt);ia(It);let Pt;var Gt=v(It,2);{var da=Dt=>{var Bt=F0();p(Dt,Bt)},ka=Dt=>{var Bt=mt(),ra=Ue(Bt);{var ua=Ta=>{var Ma=$0();p(Ta,Ma)},Oa=Ta=>{var Ma=mt(),za=Ue(Ma);{var ts=bs=>{var Va=N0();p(bs,Va)};$(za,bs=>{e(q)&&bs(ts)},!0)}p(Ta,Ma)};$(ra,Ta=>{e(S)&&!e(q)?Ta(ua):Ta(Oa,!1)},!0)}p(Dt,Bt)};$(Gt,Dt=>{e(I)?Dt(da):Dt(ka,!1)})}i(pt);var Ht=v(pt,2);{var Ye=Dt=>{var Bt=P0(),ra=n(Bt,!0);i(Bt),O(()=>w(ra,e(q))),p(Dt,Bt)},sa=Dt=>{var Bt=mt(),ra=Ue(Bt);{var ua=Oa=>{var Ta=L0();p(Oa,Ta)};$(ra,Oa=>{e(S)&&!e(I)&&Oa(ua)},!0)}p(Dt,Bt)};$(Ht,Dt=>{e(q)?Dt(Ye):Dt(sa,!1)})}i(ye),O(Dt=>Pt=ge(It,1,"form-input",null,Pt,Dt),[()=>({error:e(q),valid:e(S)&&!e(q)&&!e(I)})]),ca(It,()=>e(S),Dt=>d(S,Dt)),De("input",It,we),p(ce,ye)};$(Xe,ce=>{(e(y)==="student"||e(y)==="teacher")&&ce(Mt)})}var na=v(Xe,2);{var gt=ce=>{var ye=I0(),pt=v(n(ye),4),It=n(pt),Pt=v(n(It),2);ia(Pt),i(It);var Gt=v(It,2),da=v(n(Gt),2);ia(da),i(Gt),i(pt);var ka=v(pt,2),Ht=v(n(ka),2);Oi(Ht),i(ka);var Ye=v(ka,2),sa=n(Ye),Dt=v(n(sa),2);ia(Dt),i(sa);var Bt=v(sa,2),ra=v(n(Bt),2);ia(ra),i(Bt),i(Ye),i(ye),O(ua=>{Vt(Pt,"max",ua),Mi(da,e(U))},[()=>k(it)]),ca(Pt,()=>e(Z),ua=>d(Z,ua)),De("blur",Pt,ua=>{e(Z)&&!tt(e(Z))&&(Fe.error("Invalid date. Please enter a valid date."),d(Z,""),ua.target.value="")}),ca(Ht,()=>e(Q),ua=>d(Q,ua)),ca(Dt,()=>e(W),ua=>d(W,ua)),ca(ra,()=>e(H),ua=>d(H,ua)),De("input",ra,ua=>lt(ua,!1)),p(ce,ye)};$(na,ce=>{e(y)==="student"&&ce(gt)})}var Oe=v(na,2),bt=n(Oe),Et=n(bt,!0);i(bt);var qt=v(bt,2),Jt=n(qt);{var va=ce=>{var ye=mt(),pt=Ue(ye);{var It=Gt=>{var da=R0();p(Gt,da)},Pt=Gt=>{var da=mt(),ka=Ue(da);{var Ht=sa=>{var Dt=j0(),Bt=Ue(Dt),ra=n(Bt,!0);i(Bt),zt(2),O(()=>w(ra,e(Le))),p(sa,Dt)},Ye=sa=>{var Dt=O0();p(sa,Dt)};$(ka,sa=>{e(Le)?sa(Ht):sa(Ye,!1)},!0)}p(Gt,da)};$(pt,Gt=>{e(Qe)?Gt(It):Gt(Pt,!1)})}p(ce,ye)},la=ce=>{var ye=q0();p(ce,ye)};$(Jt,ce=>{e(y)?ce(va):ce(la,!1)})}i(qt),zt(2),i(Oe);var ya=v(Oe,2),wa=n(ya);let Ea;var Aa=n(wa);{var ja=ce=>{var ye=_a("Creating Account...");p(ce,ye)},Ra=ce=>{var ye=G0();zt(),p(ce,ye)};$(Aa,ce=>{e(b)?ce(ja):ce(Ra,!1)})}i(wa),i(ya),i(St),i(wt),i(xt);var $a=v(xt,2),ha=n($a),fa=n(ha),ne=v(n(fa),2),Ee=n(ne),nt=n(Ee),Ct=v(n(nt),2);ia(Ct);var Qt=v(Ct,2);{var Ot=ce=>{var ye=V0();De("click",ye,et),p(ce,ye)};$(Qt,ce=>{e(ee)&&ce(Ot)})}i(nt),i(Ee);var At=v(Ee,2),pa=n(At);let oa;var ga=n(pa);let xa;var ta=n(ga);{var Xt=ce=>{var ye=B0(),pt=n(ye),It=n(pt,!0);i(pt);var Pt=v(pt,2),Gt=n(Pt),da=n(Gt,!0);i(Gt),i(Pt),i(ye),O(()=>{w(It,(e(h),k(()=>e(h).icon))),w(da,(e(h),k(()=>e(h).name)))}),p(ce,ye)},ba=ce=>{var ye=z0();p(ce,ye)};$(ta,ce=>{e(h)?ce(Xt):ce(ba,!1)})}zt(2),i(ga);var Ca=v(ga,2);Tt(Ca,5,()=>T,ce=>ce.id,(ce,ye)=>{var pt=W0();let It;var Pt=n(pt),Gt=n(Pt,!0);i(Pt);var da=v(Pt,2),ka=n(da),Ht=n(ka,!0);i(ka),i(da),i(pt),O(Ye=>{It=ge(pt,1,"account-filter-dropdown-option",null,It,Ye),w(Gt,(e(ye),k(()=>e(ye).icon))),w(Ht,(e(ye),k(()=>e(ye).name)))},[()=>({selected:e(ue)===e(ye).id})]),De("click",pt,()=>qe(e(ye))),p(ce,pt)}),i(Ca),i(pa),i(At),i(ne),i(fa),i(ha);var Na=v(ha,2),Sa=n(Na);{var Da=ce=>{var ye=H0();p(ce,ye)},La=ce=>{var ye=mt(),pt=Ue(ye);{var It=Gt=>{var da=Q0(),ka=v(n(da),2);{var Ht=sa=>{var Dt=U0();p(sa,Dt)},Ye=sa=>{var Dt=Y0();p(sa,Dt)};$(ka,sa=>{e(We),k(()=>e(We).length===0)?sa(Ht):sa(Ye,!1)})}i(da),p(Gt,da)},Pt=Gt=>{var da=mt(),ka=Ue(da);Tt(ka,1,()=>e(g),Ht=>Ht.id,(Ht,Ye)=>{var sa=nw(),Dt=n(sa),Bt=n(Dt),ra=n(Bt),ua=n(ra);i(ra),i(Bt);var Oa=v(Bt,2),Ta=n(Oa),Ma=n(Ta),za=n(Ma),ts=n(za,!0);i(za),i(Ma),i(Ta);var bs=v(Ta,2);i(Oa),i(Dt);var Va=v(Dt,2),ss=n(Va),Fa=n(ss),Wa=n(Fa,!0);i(Fa);var fs=v(Fa,2),es=n(fs,!0);i(fs),i(ss);var Za=v(ss,2),os=v(n(Za),2),ls=n(os);i(os),i(Za);var Ds=v(Za,2);{var rs=ms=>{var us=K0(),Ts=v(n(us),2),Rs=n(Ts,!0);i(Ts),i(us),O(()=>w(Rs,(e(Ye),k(()=>e(Ye).advisorySection||"No advisory section assigned")))),p(ms,us)};$(Ds,ms=>{e(Ye),k(()=>e(Ye).type==="Teacher")&&ms(rs)})}var ps=v(Ds,2);{var xs=ms=>{var us=J0(),Ts=v(n(us),2),Rs=n(Ts);i(Ts),i(us),O(()=>w(Rs,`Grade ${e(Ye),k(()=>e(Ye).gradeLevel)??""}`)),p(ms,us)};$(ps,ms=>{e(Ye),k(()=>e(Ye).type==="Student"&&e(Ye).gradeLevel)&&ms(xs)})}var qs=v(ps,2);{var Ks=ms=>{var us=X0(),Ts=v(n(us),2),Rs=n(Ts);i(Ts),i(us),O(()=>w(Rs,`Age: ${e(Ye),k(()=>e(Ye).age)??""}`)),p(ms,us)};$(qs,ms=>{e(Ye),k(()=>e(Ye).type==="Student"&&e(Ye).age)&&ms(Ks)})}var Fs=v(qs,2);{var rr=ms=>{var us=Z0(),Ts=v(n(us),2),Rs=n(Ts);i(Ts),i(us),O(()=>w(Rs,`Guardian: ${e(Ye),k(()=>e(Ye).guardian)??""}`)),p(ms,us)};$(Fs,ms=>{e(Ye),k(()=>e(Ye).type==="Student"&&e(Ye).guardian)&&ms(rr)})}var ir=v(Fs,2);{var zr=ms=>{var us=ew(),Ts=v(n(us),2),Rs=n(Ts);i(Ts),i(us),O(()=>w(Rs,`Contact: ${e(Ye),k(()=>e(Ye).contactNumber)??""}`)),p(ms,us)};$(ir,ms=>{e(Ye),k(()=>e(Ye).type==="Student"&&e(Ye).contactNumber)&&ms(zr)})}var Dr=v(ir,2),Nr=v(n(Dr),2),gi=n(Nr);i(Nr),i(Dr);var Qi=v(Dr,2),Ki=v(n(Qi),2),Ji=n(Ki);i(Ki),i(Qi),i(Va);var Xi=v(Va,2);{var On=ms=>{var us=iw(),Ts=n(us),Rs=v(n(Ts),2),_i=n(Rs),bi=n(_i),Zi=n(bi),Ia=v(Zi,2);ia(Ia),i(bi);var Ba=v(bi,2),ys=n(Ba),Gs=v(ys,2);ia(Gs),i(Ba);var ar=v(Ba,2),nr=n(ar),hr=v(nr,2);ia(hr),i(ar),i(_i);var Pr=v(_i,2);{var yi=gs=>{var Lr=rw(),qn=Ue(Lr),Io=n(qn),Gn=v(Io,2);let Ro;var ni=n(Gn);let jo;var md=n(ni);{var hd=_s=>{var Js=tw(),fr=n(Js),tn=n(fr,!0);i(fr);var oi=v(fr,2),an=n(oi),sn=n(an,!0);i(an),i(oi),i(Js),O(()=>{w(tn,(e(m),k(()=>e(m).icon))),w(sn,(e(m),k(()=>e(m).name)))}),p(_s,Js)},gd=_s=>{var Js=aw();p(_s,Js)};$(md,_s=>{e(m)?_s(hd):_s(gd,!1)})}zt(2),i(ni);var Oo=v(ni,2);Tt(Oo,5,()=>Se,_s=>_s.id,(_s,Js)=>{var fr=sw();let tn;var oi=n(fr),an=n(oi,!0);i(oi);var sn=v(oi,2),Qo=n(sn),_d=n(Qo,!0);i(Qo),i(sn),i(fr),O(bd=>{tn=ge(fr,1,"dropdown-option",null,tn,bd),w(an,(e(Js),k(()=>e(Js).icon))),w(_d,(e(Js),k(()=>e(Js).name)))},[()=>({selected:e(Ce)===e(Js).id})]),De("click",fr,()=>ve(e(Js))),p(_s,fr)}),i(Oo),i(Gn),i(qn);var qo=v(qn,2),Vn=v(n(qo),4),Bn=n(Vn),Go=n(Bn),wi=v(Go,2);ia(wi),i(Bn);var Vo=v(Bn,2),Bo=n(Vo),zn=v(Bo,2);ia(zn),i(Vo),i(Vn);var Wn=v(Vn,2),zo=n(Wn),Hn=v(zo,2);Oi(Hn),i(Wn);var Wo=v(Wn,2),Un=n(Wo),Ho=n(Un),Yn=v(Ho,2);ia(Yn),i(Un);var Uo=v(Un,2),Yo=n(Uo),en=v(Yo,2);ia(en),i(Uo),i(Wo),i(qo),O((_s,Js,fr)=>{Vt(Io,"for",`edit-grade-level-${e(Ye),k(()=>e(Ye).id)??""}`),Ro=ge(Gn,1,"custom-dropdown",null,Ro,_s),jo=ge(ni,1,"dropdown-trigger",null,jo,Js),Vt(ni,"id",`edit-grade-level-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Go,"for",`edit-birthdate-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(wi,"id",`edit-birthdate-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(wi,"max",fr),Vt(Bo,"for",`edit-age-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(zn,"id",`edit-age-${e(Ye),k(()=>e(Ye).id)??""}`),Mi(zn,e(Ve)),Vt(zo,"for",`edit-address-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Hn,"id",`edit-address-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Ho,"for",`edit-guardian-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Yn,"id",`edit-guardian-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Yo,"for",`edit-contact-number-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(en,"id",`edit-contact-number-${e(Ye),k(()=>e(Ye).id)??""}`)},[()=>({open:e(Ae)}),()=>({selected:e(Ce)}),()=>k(it)]),De("click",ni,z),ca(wi,()=>e(Me),_s=>d(Me,_s)),De("blur",wi,_s=>{e(Me)&&!tt(e(Me))&&(Fe.error("Invalid date. Please enter a valid date."),d(Me,""),_s.target.value="")}),ca(Hn,()=>e(Ge),_s=>d(Ge,_s)),ca(Yn,()=>e(be),_s=>d(be,_s)),ca(en,()=>e(ke),_s=>d(ke,_s)),De("input",en,_s=>lt(_s,!0)),p(gs,Lr)};$(Pr,gs=>{e(Ye),k(()=>e(Ye).type.toLowerCase()==="student")&&gs(yi)})}var Wr=v(Pr,2),ri=n(Wr),Hr=n(ri);i(ri);var ii=v(ri,2);let Mo;var vd=n(ii);{var fd=gs=>{var Lr=_a("Updating...");p(gs,Lr)},pd=gs=>{var Lr=_a("Update Account");p(gs,Lr)};$(vd,gs=>{e(Re)?gs(fd):gs(pd,!1)})}i(ii),i(Wr),i(Rs),i(Ts),i(us),O((gs,Lr)=>{Vt(Zi,"for",`edit-last-name-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Ia,"id",`edit-last-name-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(ys,"for",`edit-first-name-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Gs,"id",`edit-first-name-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(nr,"for",`edit-middle-initial-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(hr,"id",`edit-middle-initial-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(ri,"href",`#account-card-${e(Ye),k(()=>e(Ye).id)??""}`),Mo=ge(ii,1,"account-submit-button",null,Mo,gs),ii.disabled=Lr},[()=>({loading:e(Re)}),()=>(e(Re),e(de),e(ae),e(l),e(Me),e(Ge),e(be),e(ke),k(()=>e(Re)||!e(de)||!e(ae)||e(l)&&e(l).type.toLowerCase()==="student"&&(!e(Me)||!e(Ge)||!e(be)||!e(ke))))]),ca(Ia,()=>e(ae),gs=>d(ae,gs)),De("input",Ia,gs=>He(gs,"lastName",!0)),ca(Gs,()=>e(de),gs=>d(de,gs)),De("input",Gs,gs=>He(gs,"firstName",!0)),ca(hr,()=>e(te),gs=>d(te,gs)),De("input",hr,gs=>He(gs,"middleInitial",!0)),De("click",Hr,()=>R(e(Ye))),De("submit",Rs,sr(G)),p(ms,us)};$(Xi,ms=>{e(K),e(Ye),k(()=>e(K)===e(Ye).id)&&ms(On)})}i(sa),O(()=>{Vt(sa,"id",`account-card-${e(Ye),k(()=>e(Ye).id)??""}`),w(ua,`${e(Ye),k(()=>e(Ye).name)??""}  ${e(Ye),k(()=>e(Ye).type)??""}`),Vt(Ta,"href",`#account-card-${e(Ye),k(()=>e(Ye).id)??""}`),Vt(Ma,"title",(e(K),e(Ye),k(()=>e(K)===e(Ye).id?"Cancel Edit":"Edit Account"))),w(ts,(e(K),e(Ye),k(()=>e(K)===e(Ye).id?"close":"edit"))),w(Wa,(e(Ye),k(()=>e(Ye).type==="Student"?"school":e(Ye).type==="Teacher"?"person":"admin_panel_settings"))),w(es,(e(Ye),k(()=>e(Ye).number))),w(ls,`${e(Ye),k(()=>e(Ye).type)??""} Account`),w(gi,`Created: ${e(Ye),k(()=>e(Ye).createdDate)??""}`),w(Ji,`Updated: ${e(Ye),k(()=>e(Ye).updatedDate)??""}`)}),De("click",Ma,()=>R(e(Ye))),De("click",bs,()=>le(e(Ye))),p(Ht,sa)}),p(Gt,da)};$(pt,Gt=>{e(g),k(()=>e(g).length===0)?Gt(It):Gt(Pt,!1)},!0)}p(ce,ye)};$(Sa,ce=>{e(Ze)?ce(Da):ce(La,!1)})}i(Na),i($a),i(_t),O((ce,ye,pt,It,Pt,Gt,da)=>{kt=ge(Ut,1,"custom-dropdown",null,kt,ce),Wt=ge(jt,1,"dropdown-trigger",null,Wt,ye),Te=ge(yt,1,"custom-dropdown",null,Te,pt),dt=ge(ze,1,"dropdown-trigger",null,dt,It),w(Et,e(y)==="student"?"Student Number":e(y)==="teacher"?"Teacher Number":e(y)==="admin"?"Admin Number":"Account Number"),Ea=ge(wa,1,"account-create-button",null,Ea,Pt),wa.disabled=e(b)||!e(y)||!e(x)||!e(C)||!e(E)||(e(y)==="student"||e(y)==="teacher")&&(!e(S)||e(q)||e(I))||e(y)==="student"&&(!e(Z)||!e(Q)||!e(W)||!e(H)),oa=ge(pa,1,"account-filter-dropdown",null,oa,Gt),xa=ge(ga,1,"account-filter-trigger",null,xa,da)},[()=>({open:e(X)}),()=>({selected:e(y)}),()=>({open:e(B)}),()=>({selected:e(x)}),()=>({loading:e(b)}),()=>({open:e(fe)}),()=>({selected:e(ue)!=="all"})]),De("click",jt,ie),De("click",ze,Y),ca(re,()=>e(E),ce=>d(E,ce)),De("input",re,ce=>He(ce,"lastName")),ca(je,()=>e(C),ce=>d(C,ce)),De("input",je,ce=>He(ce,"firstName")),ca(ot,()=>e(F),ce=>d(F,ce)),De("input",ot,ce=>He(ce,"middleInitial")),De("submit",St,sr(se)),ca(Ct,()=>e(ee),ce=>d(ee,ce)),De("click",ga,he),p(s,_t),Ga(),r()}function cw(){const{subscribe:s,set:t,update:a}=Qs({students:[],sections:[],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:s,init:r=>{r&&a(o=>({...o,students:r.students||[],sections:r.sections||[],isInitialized:!0,isLoading:!1}))},setLoading:r=>{a(o=>({...o,isLoading:r&&!o.isInitialized}))},updateStudents:r=>{a(o=>{const l={...o,students:r,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0};try{localStorage.setItem("student-masterlist-cache",JSON.stringify({students:r,sections:o.sections,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache student masterlist data:",c)}return l})},updateSections:r=>{a(o=>{const l={...o,sections:r};try{localStorage.setItem("student-masterlist-cache",JSON.stringify({students:o.students,sections:r,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache sections data:",c)}return l})},setError:r=>{a(o=>({...o,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem("student-masterlist-cache");if(r){const{students:o,sections:l,timestamp:c}=JSON.parse(r);if(Date.now()-c<300*1e3)return{students:o,sections:l}}}catch(r){console.warn("Failed to retrieve cached student masterlist data:",r)}return null},clearCache:()=>{try{localStorage.removeItem("student-masterlist-cache")}catch(r){console.warn("Failed to clear student masterlist cache:",r)}},refresh:async(r,o)=>{a(l=>({...l,isLoading:!0})),await Promise.all([r(),o()])}}}const Ir=cw();var dw=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),uw=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <span class="option-name"> </span></div>'),vw=_('<span class="placeholder">All Grade Levels</span>'),fw=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),pw=_('<div class="selected-option"><span class="option-name"> </span></div>'),mw=_('<span class="placeholder">All Sections</span>'),hw=_('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),gw=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),_w=_('<div class="masterlist-loading-container"><span class="system-loader"></span> <p class="masterlist-loading-text">Loading students...</p></div>'),bw=_('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),yw=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),ww=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),xw=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Sw=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),kw=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),Dw=_('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Aw=_('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),Cw=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Student"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),Tw=_('<div class="students-grid"></div>'),Ew=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p></div>'),Fw=_('<div class="student-masterlist-container"><div class="admin-student-header"><div class="header-content"><h1 class="page-title">Student Masterlist</h1> <p class="page-subtitle">View and manage all student records in the system</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label" for="grade-level-dropdown">Grade Level</label> <div><button type="button" id="grade-level-dropdown" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label" for="section-dropdown">Section</label> <div><button type="button" id="section-dropdown" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="students-list-section"><!></div></div>');function $w(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(Ir,"$studentMasterlistStore",a),l=V(),c=V(),u=V(),f=V(),m=V(),h=V();let g=V([]),b=V(""),y=V(""),x=V(""),A=V(!1),C=V(!1);const E=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];async function F(T=!1){try{T||Ir.setLoading(!0);const P=await ea.get("/api/accounts?type=student");if(!P.success)throw new Error("Failed to load students");const le=P.accounts.map(R=>({id:R.id,name:R.name,number:R.number,email:R.email,gradeLevel:R.gradeLevel||"Not specified",section:R.section||"Not specified",birthdate:R.birthdate||"Not specified",address:R.address||"Not specified",guardian:R.guardian||"Not specified",contactNumber:R.contactNumber||"Not specified",status:R.status||"active"}));Ir.updateStudents(le)}catch(P){console.error("Error loading students:",P),Ir.setError(P.message),T||Fe.error("Failed to load students. Please try again.")}}async function S(){try{const T=await ea.get("/api/sections");if(T.success&&T.data){const P=T.data.map(R=>({id:R.name,name:R.name})),le=[{id:"",name:"All Sections"},...P];Ir.updateSections(le)}}catch(T){console.error("Error loading sections:",T),Ir.updateSections([{id:"",name:"All Sections"}])}}function q(){d(g,e(l).filter(T=>{const P=!e(b)||T.name.toLowerCase().includes(e(b).toLowerCase())||T.email.toLowerCase().includes(e(b).toLowerCase())||T.number&&T.number.toLowerCase().includes(e(b).toLowerCase()),le=!e(y)||T.gradeLevel===e(y),R=!e(x)||T.section===e(x);return P&&le&&R}))}function I(){d(A,!e(A)),d(C,!1)}function j(){d(C,!e(C)),d(A,!1)}function M(T){d(y,T.id),d(A,!1),q()}function Z(T){d(x,T.id),d(C,!1),q()}function Q(T){if(!T)return"N/A";const P=new Date,le=new Date(T);let R=P.getFullYear()-le.getFullYear();const G=P.getMonth()-le.getMonth();return(G<0||G===0&&P.getDate()<le.getDate())&&R--,R}function W(T){return T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function H(){d(b,""),d(y,""),d(x,""),q()}function U(T){T.target.closest(".custom-dropdown")||(d(A,!1),d(C,!1))}async function X(T,P){ns.confirm("Archive Student",`Are you sure you want to archive ${P}? This action will move the student to the archived list.`,async()=>{try{const le=await ea.patch("/api/accounts",{id:T,action:"archive"});le.success?(Fe.success(le.message),await F()):Fe.error(le.message||"Failed to archive student")}catch(le){console.error("Error archiving student:",le),Fe.error("Failed to archive student. Please try again.")}},()=>{},{variant:"danger"})}Ua(()=>{const T=Ir.getCachedData();T&&Ir.init(T),S(),F(!!T);const P=setInterval(()=>{F(!0)},3e4);return document.addEventListener("click",U),()=>{clearInterval(P),document.removeEventListener("click",U)}}),Ft(()=>(e(l),e(c),e(u),e(f),o()),()=>{(T=>{d(l,T.students),d(c,T.sections),d(u,T.isLoading),d(f,T.error)})(o())}),Ft(()=>e(y),()=>{d(m,E.find(T=>T.id===e(y)))}),Ft(()=>(e(c),e(x)),()=>{d(h,e(c).find(T=>T.id===e(x)))}),Ft(()=>e(l),()=>{e(l)&&q()}),Ft(()=>e(b),()=>{e(b)!==void 0&&q()}),Is(),Ps();var B=Fw(),oe=v(n(B),2),K=n(oe),de=n(K),ae=n(de),te=v(n(ae),2);ia(te);var Ce=v(te,2);{var Ae=T=>{var P=dw();De("click",P,()=>d(b,"")),p(T,P)};$(Ce,T=>{e(b)&&T(Ae)})}i(ae),i(de);var Re=v(de,2),Me=n(Re),Ge=v(n(Me),2);let be;var ke=n(Ge),Ve=n(ke);{var it=T=>{var P=uw(),le=n(P),R=n(le,!0);i(le);var G=v(le,2),ie=n(G,!0);i(G),i(P),O(()=>{w(R,(e(m),k(()=>e(m).icon))),w(ie,(e(m),k(()=>e(m).name)))}),p(T,P)},Be=T=>{var P=vw();p(T,P)};$(Ve,T=>{e(m)&&e(y)?T(it):T(Be,!1)})}zt(2),i(ke);var He=v(ke,2);Tt(He,5,()=>E,T=>T.id,(T,P)=>{var le=fw();let R;var G=n(le),ie=n(G,!0);i(G);var _e=v(G,2),Y=n(_e),N=n(Y,!0);i(Y),i(_e),i(le),O(D=>{R=ge(le,1,"dropdown-option",null,R,D),w(ie,(e(P),k(()=>e(P).icon))),w(N,(e(P),k(()=>e(P).name)))},[()=>({selected:e(y)===e(P).id})]),De("click",le,()=>M(e(P))),p(T,le)}),i(He),i(Ge),i(Me);var Ne=v(Me,2),Je=v(n(Ne),2);let lt;var Pe=n(Je),we=n(Pe);{var tt=T=>{var P=pw(),le=n(P),R=n(le,!0);i(le),i(P),O(()=>w(R,(e(h),k(()=>e(h).name)))),p(T,P)},ct=T=>{var P=mw();p(T,P)};$(we,T=>{e(h)&&e(x)?T(tt):T(ct,!1)})}zt(2),i(Pe);var xe=v(Pe,2);Tt(xe,5,()=>e(c),T=>T.id,(T,P)=>{var le=hw();let R;var G=n(le),ie=n(G),_e=n(ie,!0);i(ie),i(G),i(le),O(Y=>{R=ge(le,1,"dropdown-option",null,R,Y),w(_e,(e(P),k(()=>e(P).name)))},[()=>({selected:e(x)===e(P).id})]),De("click",le,()=>Z(e(P))),p(T,le)}),i(xe),i(Je),i(Ne);var Se=v(Ne,2);{var We=T=>{var P=gw();De("click",P,H),p(T,P)};$(Se,T=>{(e(b)||e(y)||e(x))&&T(We)})}i(Re),i(K),i(oe);var Ze=v(oe,2),ee=n(Ze);{var ue=T=>{var P=_w();p(T,P)},fe=T=>{var P=mt(),le=Ue(P);{var R=ie=>{var _e=Tw();Tt(_e,5,()=>e(g),Y=>Y.id,(Y,N)=>{var D=Cw(),L=n(D),z=n(L),ve=n(z),se=n(ve);{var $e=pe=>{var Ke=_a();O(()=>w(Ke,(e(N),k(()=>e(N).number)))),p(pe,Ke)};$(se,pe=>{e(N),k(()=>e(N).number)&&pe($e)})}var he=v(se);i(ve),i(z);var qe=v(z,2),et=n(qe);i(qe),i(L);var Le=v(L,2),Qe=n(Le);{var st=pe=>{var Ke=bw(),yt=v(n(Ke),2),Te=n(yt,!0);i(yt),i(Ke),O(()=>w(Te,(e(N),k(()=>e(N).email)))),p(pe,Ke)};$(Qe,pe=>{e(N),k(()=>e(N).email)&&pe(st)})}var ht=v(Qe,2);{var _t=pe=>{var Ke=yw(),yt=v(n(Ke),2),Te=n(yt,!0);i(yt),i(Ke),O(ze=>w(Te,ze),[()=>(e(N),k(()=>E.find(ze=>ze.id===e(N).gradeLevel)?.name||e(N).gradeLevel))]),p(pe,Ke)};$(ht,pe=>{e(N),k(()=>e(N).gradeLevel&&e(N).gradeLevel!=="Not specified")&&pe(_t)})}var xt=v(ht,2);{var wt=pe=>{var Ke=ww(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(ze=>w(Te,`Section: ${ze??""}`),[()=>(e(c),e(N),k(()=>e(c).find(ze=>ze.id===e(N).section)?.name||e(N).section))]),p(pe,Ke)};$(xt,pe=>{e(N),k(()=>e(N).section&&e(N).section!=="Not specified")&&pe(wt)})}var St=v(xt,2);{var $t=pe=>{var Ke=xw(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(ze=>w(Te,`Age: ${ze??""} years old`),[()=>(e(N),k(()=>Q(e(N).birthdate)))]),p(pe,Ke)};$(St,pe=>{e(N),k(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&pe($t)})}var Nt=v(St,2);{var Ut=pe=>{var Ke=Sw(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(()=>w(Te,`Guardian: ${e(N),k(()=>e(N).guardian)??""}`)),p(pe,Ke)};$(Nt,pe=>{e(N),k(()=>e(N).guardian&&e(N).guardian!=="Not specified")&&pe(Ut)})}var kt=v(Nt,2);{var jt=pe=>{var Ke=kw(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(()=>w(Te,`Contact: ${e(N),k(()=>e(N).contactNumber)??""}`)),p(pe,Ke)};$(kt,pe=>{e(N),k(()=>e(N).contactNumber&&e(N).contactNumber!=="Not specified")&&pe(jt)})}var Wt=v(kt,2);{var Kt=pe=>{var Ke=Dw(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(()=>w(Te,`Address: ${e(N),k(()=>e(N).address)??""}`)),p(pe,Ke)};$(Wt,pe=>{e(N),k(()=>e(N).address&&e(N).address!=="Not specified")&&pe(Kt)})}var aa=v(Wt,2);{var Yt=pe=>{var Ke=Aw(),yt=v(n(Ke),2),Te=n(yt);i(yt),i(Ke),O(ze=>w(Te,`Birthdate: ${ze??""}`),[()=>(e(N),k(()=>W(e(N).birthdate)))]),p(pe,Ke)};$(aa,pe=>{e(N),k(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&pe(Yt)})}i(Le),i(D),O(()=>w(he,`  ${e(N),k(()=>e(N).name)??""}`)),De("click",et,()=>X(e(N).id,e(N).name)),p(Y,D)}),i(_e),p(ie,_e)},G=ie=>{var _e=Ew(),Y=n(_e),N=n(Y,!0);i(Y);var D=v(Y,2),L=n(D);{var z=se=>{var $e=_a("No students found matching your search criteria.");p(se,$e)},ve=se=>{var $e=_a("No students found in the system.");p(se,$e)};$(L,se=>{e(b)||e(y)||e(x)?se(z):se(ve,!1)})}i(D),i(_e),O(()=>w(N,e(b)||e(y)||e(x)?"search_off":"school")),p(ie,_e)};$(le,ie=>{e(g),k(()=>e(g).length>0)?ie(R):ie(G,!1)},!0)}p(T,P)};$(ee,T=>{e(u)?T(ue):T(fe,!1)})}i(Ze),i(B),O((T,P)=>{be=ge(Ge,1,"custom-dropdown",null,be,T),lt=ge(Je,1,"custom-dropdown",null,lt,P)},[()=>({open:e(A)}),()=>({open:e(C)})]),ca(te,()=>e(b),T=>d(b,T)),De("click",ke,I),De("click",Pe,j),p(s,B),Ga(),r()}function Nw(){const{subscribe:s,set:t,update:a}=Qs({teachers:[],departments:[],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:s,init:r=>{r&&a(o=>({...o,teachers:r.teachers||[],departments:r.departments||[],isInitialized:!0,isLoading:!1}))},setLoading:r=>{a(o=>({...o,isLoading:r&&!o.isInitialized}))},updateTeachers:r=>{a(o=>{const l={...o,teachers:r,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0};try{localStorage.setItem("teacher-masterlist-cache",JSON.stringify({teachers:r,departments:o.departments,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache teacher masterlist data:",c)}return l})},updateDepartments:r=>{a(o=>{const l={...o,departments:r};try{localStorage.setItem("teacher-masterlist-cache",JSON.stringify({teachers:o.teachers,departments:r,timestamp:Date.now()}))}catch(c){console.warn("Failed to cache departments data:",c)}return l})},setError:r=>{a(o=>({...o,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem("teacher-masterlist-cache");if(r){const{teachers:o,departments:l,timestamp:c}=JSON.parse(r);if(Date.now()-c<300*1e3)return{teachers:o,departments:l}}}catch(r){console.warn("Failed to retrieve cached teacher masterlist data:",r)}return null},clearCache:()=>{try{localStorage.removeItem("teacher-masterlist-cache")}catch(r){console.warn("Failed to clear teacher masterlist cache:",r)}},refresh:async(r,o)=>{a(l=>({...l,isLoading:!0})),await Promise.all([r(),o()])}}}const br=Nw();var Pw=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Lw=_('<div class="selected-option"><span class="option-name"> </span></div>'),Mw=_('<span class="placeholder">All Departments</span>'),Iw=_('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),Rw=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),jw=_('<div class="masterlist-loading-container"><span class="system-loader"></span> <p class="masterlist-loading-text">Loading teachers...</p></div>'),Ow=_('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),qw=_('<div class="account-detail-item"><span class="material-symbols-outlined">corporate_fare</span> <span> </span></div>'),Gw=_('<div class="account-detail-item"><span class="material-symbols-outlined">menu_book</span> <span> </span></div>'),Vw=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Bw=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),zw=_('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),Ww=_('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),Hw=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Teacher"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!></div></div>'),Uw=_('<div class="teachers-grid"></div>'),Yw=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p></div>'),Qw=_('<div class="teacher-masterlist-container"><div class="admin-teacher-header"><div class="header-content"><h1 class="page-title">Teacher Masterlist</h1> <p class="page-subtitle">View and manage all teacher records in the system</p></div></div> <div class="filters-section"><div class="teachmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search teachers by name, email, or ID..."/> <!></div></div> <div class="teachmaster-filter-container"><div class="filter-group"><label class="filter-label" for="department-dropdown">Department</label> <div><button type="button" id="department-dropdown" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="teachers-list-section"><!></div></div>');function Kw(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(br,"$teacherMasterlistStore",a),l=V(),c=V(),u=V(),f=V(),m=V();let h=V([]),g=V(""),b=V(""),y=V(!1);async function x(Ne=!1){try{Ne||br.setLoading(!0);const Je=await ea.get("/api/accounts?type=teacher");if(!Je.success)throw new Error("Failed to load teachers");const lt=Je.accounts.map(Pe=>({id:Pe.id,name:Pe.name,number:Pe.number,email:Pe.email,department:Pe.department||"Not specified",birthdate:Pe.birthdate||"Not specified",address:Pe.address||"Not specified",contactNumber:Pe.contactNumber||"Not specified",status:Pe.status||"active",subjects:Pe.subjects||[]}));br.updateTeachers(lt)}catch(Je){console.error("Error loading teachers:",Je),br.setError(Je.message),Ne||Fe.error("Failed to load teachers. Please try again.")}}async function A(){try{const Ne=await ea.get("/api/departments");if(Ne.success&&Ne.data){const Je=Ne.data.map(Pe=>({id:Pe.name,name:Pe.name})),lt=[{id:"",name:"All Departments"},...Je];br.updateDepartments(lt)}}catch(Ne){console.error("Error loading departments:",Ne),br.updateDepartments([{id:"",name:"All Departments"}])}}function C(){d(h,e(l).filter(Ne=>{const Je=!e(g)||Ne.name.toLowerCase().includes(e(g).toLowerCase())||Ne.email.toLowerCase().includes(e(g).toLowerCase())||Ne.number&&Ne.number.toLowerCase().includes(e(g).toLowerCase()),lt=!e(b)||Ne.department===e(b);return Je&&lt}))}function E(){d(y,!e(y))}function F(Ne){d(b,Ne.id),d(y,!1),C()}function S(Ne){if(!Ne)return"N/A";const Je=new Date,lt=new Date(Ne);let Pe=Je.getFullYear()-lt.getFullYear();const we=Je.getMonth()-lt.getMonth();return(we<0||we===0&&Je.getDate()<lt.getDate())&&Pe--,Pe}function q(Ne){return Ne?new Date(Ne).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function I(){d(g,""),d(b,""),C()}function j(Ne){Ne.target.closest(".custom-dropdown")||d(y,!1)}async function M(Ne,Je){ns.confirm("Archive Teacher",`Are you sure you want to archive ${Je}? This action will move the teacher to the archived list.`,async()=>{try{const lt=await ea.patch("/api/accounts",{id:Ne,action:"archive"});lt.success?(Fe.success(lt.message),await x()):Fe.error(lt.message||"Failed to archive teacher")}catch(lt){console.error("Error archiving teacher:",lt),Fe.error("Failed to archive teacher. Please try again.")}},()=>{},{variant:"danger"})}Ua(()=>{const Ne=br.getCachedData();Ne&&br.init(Ne),A(),x(!!Ne);const Je=setInterval(()=>{x(!0)},3e4);return document.addEventListener("click",j),()=>{clearInterval(Je),document.removeEventListener("click",j)}}),Ft(()=>(e(l),e(c),e(u),e(f),o()),()=>{(Ne=>{d(l,Ne.teachers),d(c,Ne.departments),d(u,Ne.isLoading),d(f,Ne.error)})(o())}),Ft(()=>(e(c),br),()=>{(!e(c)||e(c).length===0)&&br.updateDepartments([{id:"",name:"All Departments"}])}),Ft(()=>(e(c),e(b)),()=>{d(m,e(c).find(Ne=>Ne.id===e(b)))}),Ft(()=>e(l),()=>{e(l)&&C()}),Ft(()=>e(g),()=>{e(g)!==void 0&&C()}),Is(),Ps();var Z=Qw(),Q=v(n(Z),2),W=n(Q),H=n(W),U=n(H),X=v(n(U),2);ia(X);var B=v(X,2);{var oe=Ne=>{var Je=Pw();De("click",Je,()=>d(g,"")),p(Ne,Je)};$(B,Ne=>{e(g)&&Ne(oe)})}i(U),i(H);var K=v(H,2),de=n(K),ae=v(n(de),2);let te;var Ce=n(ae),Ae=n(Ce);{var Re=Ne=>{var Je=Lw(),lt=n(Je),Pe=n(lt,!0);i(lt),i(Je),O(()=>w(Pe,(e(m),k(()=>e(m).name)))),p(Ne,Je)},Me=Ne=>{var Je=Mw();p(Ne,Je)};$(Ae,Ne=>{e(m)&&e(b)?Ne(Re):Ne(Me,!1)})}zt(2),i(Ce);var Ge=v(Ce,2);Tt(Ge,5,()=>e(c),Ne=>Ne.id,(Ne,Je)=>{var lt=Iw();let Pe;var we=n(lt),tt=n(we),ct=n(tt,!0);i(tt),i(we),i(lt),O(xe=>{Pe=ge(lt,1,"dropdown-option",null,Pe,xe),w(ct,(e(Je),k(()=>e(Je).name)))},[()=>({selected:e(b)===e(Je).id})]),De("click",lt,()=>F(e(Je))),p(Ne,lt)}),i(Ge),i(ae),i(de);var be=v(de,2);{var ke=Ne=>{var Je=Rw();De("click",Je,I),p(Ne,Je)};$(be,Ne=>{(e(g)||e(b))&&Ne(ke)})}i(K),i(W),i(Q);var Ve=v(Q,2),it=n(Ve);{var Be=Ne=>{var Je=jw();p(Ne,Je)},He=Ne=>{var Je=mt(),lt=Ue(Je);{var Pe=tt=>{var ct=Uw();Tt(ct,5,()=>e(h),xe=>xe.id,(xe,Se)=>{var We=Hw(),Ze=n(We),ee=n(Ze),ue=n(ee),fe=n(ue);{var T=Qe=>{var st=_a();O(()=>w(st,`${e(Se),k(()=>e(Se).number)??""} `)),p(Qe,st)};$(fe,Qe=>{e(Se),k(()=>e(Se).number)&&Qe(T)})}var P=v(fe);i(ue),i(ee);var le=v(ee,2),R=n(le);i(le),i(Ze);var G=v(Ze,2),ie=n(G);{var _e=Qe=>{var st=Ow(),ht=v(n(st),2),_t=n(ht,!0);i(ht),i(st),O(()=>w(_t,(e(Se),k(()=>e(Se).email)))),p(Qe,st)};$(ie,Qe=>{e(Se),k(()=>e(Se).email)&&Qe(_e)})}var Y=v(ie,2);{var N=Qe=>{var st=qw(),ht=v(n(st),2),_t=n(ht,!0);i(ht),i(st),O(()=>w(_t,(e(Se),k(()=>e(Se).department)))),p(Qe,st)};$(Y,Qe=>{e(Se),k(()=>e(Se).department&&e(Se).department!=="Not specified")&&Qe(N)})}var D=v(Y,2);{var L=Qe=>{var st=Gw(),ht=v(n(st),2),_t=n(ht);i(ht),i(st),O(xt=>w(_t,`Subjects: ${xt??""}`),[()=>(e(Se),k(()=>e(Se).subjects.join(", ")))]),p(Qe,st)};$(D,Qe=>{e(Se),k(()=>e(Se).subjects&&e(Se).subjects.length>0)&&Qe(L)})}var z=v(D,2);{var ve=Qe=>{var st=Vw(),ht=v(n(st),2),_t=n(ht);i(ht),i(st),O(xt=>w(_t,`Age: ${xt??""} years old`),[()=>(e(Se),k(()=>S(e(Se).birthdate)))]),p(Qe,st)};$(z,Qe=>{e(Se),k(()=>e(Se).birthdate&&e(Se).birthdate!=="Not specified")&&Qe(ve)})}var se=v(z,2);{var $e=Qe=>{var st=Bw(),ht=v(n(st),2),_t=n(ht);i(ht),i(st),O(()=>w(_t,`Contact: ${e(Se),k(()=>e(Se).contactNumber)??""}`)),p(Qe,st)};$(se,Qe=>{e(Se),k(()=>e(Se).contactNumber&&e(Se).contactNumber!=="Not specified")&&Qe($e)})}var he=v(se,2);{var qe=Qe=>{var st=zw(),ht=v(n(st),2),_t=n(ht);i(ht),i(st),O(()=>w(_t,`Address: ${e(Se),k(()=>e(Se).address)??""}`)),p(Qe,st)};$(he,Qe=>{e(Se),k(()=>e(Se).address&&e(Se).address!=="Not specified")&&Qe(qe)})}var et=v(he,2);{var Le=Qe=>{var st=Ww(),ht=v(n(st),2),_t=n(ht);i(ht),i(st),O(xt=>w(_t,`Birthdate: ${xt??""}`),[()=>(e(Se),k(()=>q(e(Se).birthdate)))]),p(Qe,st)};$(et,Qe=>{e(Se),k(()=>e(Se).birthdate&&e(Se).birthdate!=="Not specified")&&Qe(Le)})}i(G),i(We),O(()=>w(P,` ${e(Se),k(()=>e(Se).name)??""}`)),De("click",R,()=>M(e(Se).id,e(Se).name)),p(xe,We)}),i(ct),p(tt,ct)},we=tt=>{var ct=Yw(),xe=n(ct),Se=n(xe,!0);i(xe);var We=v(xe,2),Ze=n(We);{var ee=fe=>{var T=_a("No teachers found matching your search criteria.");p(fe,T)},ue=fe=>{var T=_a("No teachers found in the system.");p(fe,T)};$(Ze,fe=>{e(g)||e(b)?fe(ee):fe(ue,!1)})}i(We),i(ct),O(()=>w(Se,e(g)||e(b)?"search_off":"school")),p(tt,ct)};$(lt,tt=>{e(h),k(()=>e(h).length>0)?tt(Pe):tt(we,!1)},!0)}p(Ne,Je)};$(it,Ne=>{e(u)?Ne(Be):Ne(He,!1)})}i(Ve),i(Z),O(Ne=>te=ge(ae,1,"custom-dropdown",null,te,Ne),[()=>({open:e(y)})]),ca(X,()=>e(g),Ne=>d(g,Ne)),De("click",Ce,E),p(s,Z),Ga(),r()}var Jw=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Xw=_('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),Zw=_('<span class="aas-placeholder">All Accounts</span>'),ex=_('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),tx=_('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),ax=_('<span class="aas-placeholder">All Grade Levels</span>'),sx=_('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),rx=_('<div class="filter-group"><label class="filter-label" for="archived-grade-level-dropdown">Grade Level</label> <div><button type="button" id="archived-grade-level-dropdown" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div>'),ix=_('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),nx=_('<span class="aas-placeholder">All Departments</span>'),ox=_('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),lx=_('<div class="filter-group"><label class="filter-label" for="archived-department-dropdown">Department</label> <div><button type="button" id="archived-department-dropdown" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div>'),cx=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),dx=_('<div class="aas-loading-container"><span class="system-loader"></span> <p class="aas-loading-text">Loading archived accounts...</p></div>'),ux=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),vx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),fx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),px=_("<!> <!>",1),mx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">corporate_fare</span> <span> </span></div>'),hx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),gx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),_x=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),bx=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),yx=_('<div class="aas-account-card"><div class="aas-account-card-header"><div class="aas-account-title"><h3 class="aas-account-name"><!> </h3> <div class="aas-archived-badge"><span class="material-symbols-outlined">archive</span> <span> </span></div></div> <div class="aas-action-buttons"><button type="button" class="aas-restore-button"><span class="material-symbols-outlined">unarchive</span></button></div></div> <div class="aas-account-details"><div class="aas-account-detail-item"><span class="material-symbols-outlined"> </span> <span class="account-type-badge"> </span></div> <!> <!> <!> <!> <!> <!> <!></div></div>'),wx=_('<div class="aas-students-grid"></div>'),xx=_('<button type="button" class="aas-clear-search-button-inline">Clear</button>'),Sx=_('<div class="aas-no-results"><span class="material-symbols-outlined aas-no-results-icon"> </span> <p><!></p> <!></div>'),kx=_('<div class="aas-archived-students-container"><div class="aas-admin-student-header"><div class="aas-header-content"><h1 class="aas-page-title">Archived Accounts</h1> <p class="aas-page-subtitle">View and manage archived student and teacher records</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search archived accounts by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label" for="archived-account-type-dropdown">Account Type</label> <div><button type="button" id="archived-account-type-dropdown" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <!> <!> <!></div></div></div> <div class="aas-students-list-section"><!></div></div>');function Dx(s,t){qa(t,!1);const a=V(),r=V(),o=V();let l=[],c=V([]),u=V(!0),f=V(""),m=V(""),h=V(""),g=V(""),b=V([]),y=V(!1),x=V(!1),A=V(!1);const C=[{id:"",name:"All Accounts",icon:"group"},{id:"student",name:"Students",icon:"school"},{id:"teacher",name:"Teachers",icon:"person"}],E=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];async function F(){d(u,!0);try{const T=await ea.get("/api/archived-accounts");if(!T.accounts)throw new Error("No accounts data received");l=T.accounts.map(P=>({id:P.id,name:P.name,number:P.number,email:P.email,accountType:P.accountType,gradeLevel:P.gradeLevel||"Not specified",department:P.department||"Not specified",birthdate:P.birthdate||"Not specified",address:P.address||"Not specified",guardian:P.guardian||"Not specified",contactNumber:P.contactNumber||"Not specified",archivedDate:P.archivedDate||"Not specified"})),q()}catch(T){console.error("Error loading archived accounts:",T),Fe.error("Failed to load archived accounts. Please try again."),l=[]}finally{d(u,!1)}}async function S(){try{const T=await ea.get("/api/departments");T.success&&T.data&&d(b,[{id:"",name:"All Departments",icon:"corporate_fare"},...T.data.map(P=>({id:P.id,name:P.name,icon:"corporate_fare"}))])}catch(T){console.error("Error loading departments:",T),Fe.error("Failed to load departments.")}}function q(){d(c,l.filter(T=>{const P=!e(f)||T.name.toLowerCase().includes(e(f).toLowerCase())||T.email.toLowerCase().includes(e(f).toLowerCase())||T.number&&T.number.toLowerCase().includes(e(f).toLowerCase()),le=!e(h)||T.accountType===e(h),R=!e(m)||T.gradeLevel===e(m);let G=!0;if(e(g)&&e(o)){const ie=T.department===e(o).name;console.log(`Comparing account dept "${T.department}" with selected dept "${e(o).name}": ${ie}`),G=ie}return P&&le&&R&&G}))}function I(T){d(c,l.filter(P=>{const le=!e(f)||P.name.toLowerCase().includes(e(f).toLowerCase())||P.email.toLowerCase().includes(e(f).toLowerCase())||P.number&&P.number.toLowerCase().includes(e(f).toLowerCase()),R=!e(h)||P.accountType===e(h),G=!e(m)||P.gradeLevel===e(m);let ie=!0;return T.id&&(ie=P.department===T.name),le&&R&&G&&ie}))}function j(){d(x,!e(x)),d(y,!1),d(A,!1)}function M(){d(y,!e(y)),d(x,!1),d(A,!1)}function Z(){d(A,!e(A)),d(x,!1),d(y,!1)}function Q(T){d(h,T.id),d(x,!1),d(m,""),d(g,""),q()}function W(T){d(m,T.id),d(y,!1),q()}function H(T){d(g,T.id),d(A,!1),I(T)}function U(T){if(!T)return"N/A";const P=new Date,le=new Date(T);let R=P.getFullYear()-le.getFullYear();const G=P.getMonth()-le.getMonth();return(G<0||G===0&&P.getDate()<le.getDate())&&R--,R}function X(T){return T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function B(T){return T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}async function oe(T,P,le){const R=le==="student"?"Student":"Teacher";ns.confirm(`Restore ${R}`,`Are you sure you want to restore ${P}? This action will move the ${R.toLowerCase()} back to the active list.`,async()=>{try{const G=await ea.put("/api/archived-accounts",{id:T});Fe.success(G.message||`${R} restored successfully`),await F()}catch(G){console.error(`Error restoring ${R.toLowerCase()}:`,G),Fe.error(G.message||`Failed to restore ${R.toLowerCase()}. Please try again.`)}},()=>{})}function K(){d(f,""),d(h,""),d(m,""),d(g,""),q()}function de(T){T.target.closest(".aas-custom-dropdown")||(d(x,!1),d(y,!1),d(A,!1))}Ua(()=>(F(),S(),document.addEventListener("click",de),()=>{document.removeEventListener("click",de)})),Ft(()=>e(h),()=>{d(a,C.find(T=>T.id===e(h)))}),Ft(()=>e(m),()=>{d(r,E.find(T=>T.id===e(m)))}),Ft(()=>(e(b),e(g)),()=>{d(o,e(b).find(T=>T.id===e(g)))}),Ft(()=>e(f),()=>{e(f)!==void 0&&q()}),Is(),Ps();var ae=kx(),te=v(n(ae),2),Ce=n(te),Ae=n(Ce),Re=n(Ae),Me=v(n(Re),2);ia(Me);var Ge=v(Me,2);{var be=T=>{var P=Jw();De("click",P,()=>d(f,"")),p(T,P)};$(Ge,T=>{e(f)&&T(be)})}i(Re),i(Ae);var ke=v(Ae,2),Ve=n(ke),it=v(n(Ve),2);let Be;var He=n(it),Ne=n(He);{var Je=T=>{var P=Xw(),le=n(P),R=n(le,!0);i(le);var G=v(le,2),ie=n(G,!0);i(G),i(P),O(()=>{w(R,(e(a),k(()=>e(a).icon))),w(ie,(e(a),k(()=>e(a).name)))}),p(T,P)},lt=T=>{var P=Zw();p(T,P)};$(Ne,T=>{e(a)&&e(h)?T(Je):T(lt,!1)})}zt(2),i(He);var Pe=v(He,2);Tt(Pe,5,()=>C,T=>T.id,(T,P)=>{var le=ex();let R;var G=n(le),ie=n(G,!0);i(G);var _e=v(G,2),Y=n(_e),N=n(Y,!0);i(Y),i(_e),i(le),O(D=>{R=ge(le,1,"aas-dropdown-option",null,R,D),w(ie,(e(P),k(()=>e(P).icon))),w(N,(e(P),k(()=>e(P).name)))},[()=>({selected:e(h)===e(P).id})]),De("click",le,()=>Q(e(P))),p(T,le)}),i(Pe),i(it),i(Ve);var we=v(Ve,2);{var tt=T=>{var P=rx(),le=v(n(P),2);let R;var G=n(le),ie=n(G);{var _e=D=>{var L=tx(),z=n(L),ve=n(z,!0);i(z);var se=v(z,2),$e=n(se,!0);i(se),i(L),O(()=>{w(ve,(e(r),k(()=>e(r).icon))),w($e,(e(r),k(()=>e(r).name)))}),p(D,L)},Y=D=>{var L=ax();p(D,L)};$(ie,D=>{e(r)&&e(m)?D(_e):D(Y,!1)})}zt(2),i(G);var N=v(G,2);Tt(N,5,()=>E,D=>D.id,(D,L)=>{var z=sx();let ve;var se=n(z),$e=n(se,!0);i(se);var he=v(se,2),qe=n(he),et=n(qe,!0);i(qe),i(he),i(z),O(Le=>{ve=ge(z,1,"aas-dropdown-option",null,ve,Le),w($e,(e(L),k(()=>e(L).icon))),w(et,(e(L),k(()=>e(L).name)))},[()=>({selected:e(m)===e(L).id})]),De("click",z,()=>W(e(L))),p(D,z)}),i(N),i(le),i(P),O(D=>R=ge(le,1,"aas-custom-dropdown",null,R,D),[()=>({open:e(y)})]),De("click",G,M),p(T,P)};$(we,T=>{e(h)==="student"&&T(tt)})}var ct=v(we,2);{var xe=T=>{var P=lx(),le=v(n(P),2);let R;var G=n(le),ie=n(G);{var _e=D=>{var L=ix(),z=n(L),ve=n(z,!0);i(z);var se=v(z,2),$e=n(se,!0);i(se),i(L),O(()=>{w(ve,(e(o),k(()=>e(o).icon))),w($e,(e(o),k(()=>e(o).name)))}),p(D,L)},Y=D=>{var L=nx();p(D,L)};$(ie,D=>{e(o)&&e(g)?D(_e):D(Y,!1)})}zt(2),i(G);var N=v(G,2);Tt(N,5,()=>e(b),D=>D.id,(D,L)=>{var z=ox();let ve;var se=n(z),$e=n(se,!0);i(se);var he=v(se,2),qe=n(he),et=n(qe,!0);i(qe),i(he),i(z),O(Le=>{ve=ge(z,1,"aas-dropdown-option",null,ve,Le),w($e,(e(L),k(()=>e(L).icon))),w(et,(e(L),k(()=>e(L).name)))},[()=>({selected:e(g)===e(L).id})]),De("click",z,()=>H(e(L))),p(D,z)}),i(N),i(le),i(P),O(D=>R=ge(le,1,"aas-custom-dropdown",null,R,D),[()=>({open:e(A)})]),De("click",G,Z),p(T,P)};$(ct,T=>{e(h)==="teacher"&&T(xe)})}var Se=v(ct,2);{var We=T=>{var P=cx();De("click",P,K),p(T,P)};$(Se,T=>{(e(f)||e(h)||e(m)||e(g))&&T(We)})}i(ke),i(Ce),i(te);var Ze=v(te,2),ee=n(Ze);{var ue=T=>{var P=dx();p(T,P)},fe=T=>{var P=mt(),le=Ue(P);{var R=ie=>{var _e=wx();Tt(_e,5,()=>e(c),Y=>Y.id,(Y,N)=>{var D=yx(),L=n(D),z=n(L),ve=n(z),se=n(ve);{var $e=rt=>{var vt=_a();O(()=>w(vt,(e(N),k(()=>e(N).number)))),p(rt,vt)};$(se,rt=>{e(N),k(()=>e(N).number)&&rt($e)})}var he=v(se);i(ve);var qe=v(ve,2),et=v(n(qe),2),Le=n(et);i(et),i(qe),i(z);var Qe=v(z,2),st=n(Qe);i(Qe),i(L);var ht=v(L,2),_t=n(ht),xt=n(_t),wt=n(xt,!0);i(xt);var St=v(xt,2),$t=n(St,!0);i(St),i(_t);var Nt=v(_t,2);{var Ut=rt=>{var vt=ux(),Rt=v(n(vt),2),Zt=n(Rt,!0);i(Rt),i(vt),O(()=>w(Zt,(e(N),k(()=>e(N).email)))),p(rt,vt)};$(Nt,rt=>{e(N),k(()=>e(N).email)&&rt(Ut)})}var kt=v(Nt,2);{var jt=rt=>{var vt=px(),Rt=Ue(vt);{var Zt=ut=>{var me=vx(),re=v(n(me),2),J=n(re,!0);i(re),i(me),O(je=>w(J,je),[()=>(e(N),k(()=>E.find(je=>je.id===e(N).gradeLevel)?.name||e(N).gradeLevel))]),p(ut,me)};$(Rt,ut=>{e(N),k(()=>e(N).gradeLevel&&e(N).gradeLevel!=="Not specified")&&ut(Zt)})}var ma=v(Rt,2);{var ft=ut=>{var me=fx(),re=v(n(me),2),J=n(re);i(re),i(me),O(()=>w(J,`Guardian: ${e(N),k(()=>e(N).guardian)??""}`)),p(ut,me)};$(ma,ut=>{e(N),k(()=>e(N).guardian&&e(N).guardian!=="Not specified")&&ut(ft)})}p(rt,vt)};$(kt,rt=>{e(N),k(()=>e(N).accountType==="student")&&rt(jt)})}var Wt=v(kt,2);{var Kt=rt=>{var vt=mt(),Rt=Ue(vt);{var Zt=ma=>{var ft=mx(),ut=v(n(ft),2),me=n(ut);i(ut),i(ft),O(()=>w(me,`Department: ${e(N),k(()=>e(N).department)??""}`)),p(ma,ft)};$(Rt,ma=>{e(N),k(()=>e(N).department&&e(N).department!=="Not specified")&&ma(Zt)})}p(rt,vt)};$(Wt,rt=>{e(N),k(()=>e(N).accountType==="teacher")&&rt(Kt)})}var aa=v(Wt,2);{var Yt=rt=>{var vt=hx(),Rt=v(n(vt),2),Zt=n(Rt);i(Rt),i(vt),O(ma=>w(Zt,`Age: ${ma??""} years old`),[()=>(e(N),k(()=>U(e(N).birthdate)))]),p(rt,vt)};$(aa,rt=>{e(N),k(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&rt(Yt)})}var pe=v(aa,2);{var Ke=rt=>{var vt=gx(),Rt=v(n(vt),2),Zt=n(Rt);i(Rt),i(vt),O(()=>w(Zt,`Contact: ${e(N),k(()=>e(N).contactNumber)??""}`)),p(rt,vt)};$(pe,rt=>{e(N),k(()=>e(N).contactNumber&&e(N).contactNumber!=="Not specified")&&rt(Ke)})}var yt=v(pe,2);{var Te=rt=>{var vt=_x(),Rt=v(n(vt),2),Zt=n(Rt);i(Rt),i(vt),O(()=>w(Zt,`Address: ${e(N),k(()=>e(N).address)??""}`)),p(rt,vt)};$(yt,rt=>{e(N),k(()=>e(N).address&&e(N).address!=="Not specified")&&rt(Te)})}var ze=v(yt,2);{var dt=rt=>{var vt=bx(),Rt=v(n(vt),2),Zt=n(Rt);i(Rt),i(vt),O(ma=>w(Zt,`Birthdate: ${ma??""}`),[()=>(e(N),k(()=>X(e(N).birthdate)))]),p(rt,vt)};$(ze,rt=>{e(N),k(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&rt(dt)})}i(ht),i(D),O(rt=>{w(he,`  ${e(N),k(()=>e(N).name)??""}`),w(Le,`Archived ${rt??""}`),Vt(st,"title",`Restore ${e(N),k(()=>e(N).accountType==="student"?"Student":"Teacher")??""}`),w(wt,(e(N),k(()=>e(N).accountType==="student"?"school":"person"))),w($t,(e(N),k(()=>e(N).accountType==="student"?"Student":"Teacher")))},[()=>(e(N),k(()=>B(e(N).archivedDate)))]),De("click",st,()=>oe(e(N).id,e(N).name,e(N).accountType)),p(Y,D)}),i(_e),p(ie,_e)},G=ie=>{var _e=Sx(),Y=n(_e),N=n(Y,!0);i(Y);var D=v(Y,2),L=n(D);{var z=he=>{var qe=_a("No archived accounts found matching your search criteria.");p(he,qe)},ve=he=>{var qe=_a("No archived accounts found in the system.");p(he,qe)};$(L,he=>{e(f)||e(h)||e(m)?he(z):he(ve,!1)})}i(D);var se=v(D,2);{var $e=he=>{var qe=xx();De("click",qe,K),p(he,qe)};$(se,he=>{(e(f)||e(h)||e(m))&&he($e)})}i(_e),O(()=>w(N,e(f)||e(h)||e(m)?"search_off":"archive")),p(ie,_e)};$(le,ie=>{e(c),k(()=>e(c).length>0)?ie(R):ie(G,!1)},!0)}p(T,P)};$(ee,T=>{e(u)?T(ue):T(fe,!1)})}i(Ze),i(ae),O(T=>Be=ge(it,1,"aas-custom-dropdown",null,Be,T),[()=>({open:e(x)})]),ca(Me,()=>e(f),T=>d(f,T)),De("click",He,j),p(s,ae),Ga()}var Ax=_('<button type="button" class="sgl-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Cx=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),Tx=_('<span class="sgl-placeholder">Current Quarter</span>'),Ex=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Fx=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),$x=_('<span class="sgl-placeholder">All Grade Levels</span>'),Nx=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Px=_('<div class="sgl-selected-option"><span class="sgl-option-name"> </span></div>'),Lx=_('<span class="sgl-placeholder">All Sections</span>'),Mx=_('<button type="button"><div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Ix=_('<button type="button" class="sgl-clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Rx=_('<div class="sgl-masterlist-loading-container"><span class="system-loader"></span> <p class="sgl-masterlist-loading-text">Loading student grades...</p></div>'),jx=_('<div class="sgl-empty-state"><span class="material-symbols-outlined sgl-empty-icon">search_off</span> <h3 class="sgl-empty-title">No students found</h3> <p class="sgl-empty-description"><!></p></div>'),Ox=_('<tr><td class="sgl-student-id"> </td><td class="sgl-student-name"> </td><td class="sgl-year-level"> </td><td class="sgl-section"> </td><td class="sgl-gwa"> </td></tr>'),qx=_('<div class="sgl-results-header"><p class="sgl-results-count"> </p></div> <div class="sgl-table-container"><table class="sgl-students-table"><thead><tr><th>Student ID</th><th>Name</th><th>Grade Level</th><th>Section</th><th>GWA</th></tr></thead><tbody></tbody></table></div>',1),Gx=_('<div class="sgl-student-grades-container"><div class="sgl-admin-student-header"><div class="sgl-header-content"><h1 class="sgl-page-title">Student Grades List</h1> <p class="sgl-page-subtitle">View and manage student academic performance records</p></div></div> <div class="sgl-filters-section"><div class="sgl-search-filter-container"><div class="sgl-search-container"><div class="sgl-search-input-wrapper"><span class="material-symbols-outlined sgl-search-icon">search</span> <input type="text" class="sgl-search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="sgl-filter-container"><div class="sgl-filter-group"><label class="sgl-filter-label" for="quarter-dropdown">Quarter</label> <div><button type="button" id="quarter-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label" for="grades-grade-level-dropdown">Grade Level</label> <div><button type="button" id="grades-grade-level-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label" for="grades-section-dropdown">Section</label> <div><button type="button" id="grades-section-dropdown" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <!></div></div></div> <div class="sgl-results-section"><!></div></div>');function Vx(s,t){qa(t,!1);const a=V(),r=V(),o=V();let l=V([]),c=V([]),u=[],f=V(!0),m=V(""),h=V(""),g=V(""),b=V(""),y=V(!1),x=V(!1),A=V(!1);const C=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}],E=[{id:"",name:"Current Quarter",icon:"event"},{id:"all",name:"Overall (All Quarters)",icon:"summarize"},{id:"1",name:"1st Quarter",icon:"filter_1"},{id:"2",name:"2nd Quarter",icon:"filter_2"},{id:"3",name:"3rd Quarter",icon:"filter_3"},{id:"4",name:"4th Quarter",icon:"filter_4"}];let F=V([{id:"",name:"All Sections"}]);async function S(){try{const L=await ea.get("/api/sections");if(L.success){u=L.data||[];const z=u.filter(ve=>ve.status==="active");d(F,[{id:"",name:"All Sections"},...z.map(ve=>({id:ve.name,name:`Grade ${ve.grade_level}  ${ve.name}`}))])}}catch(L){console.error("Error loading sections:",L),Fe.error("Failed to load sections")}}async function q(){d(f,!0);try{const L=new URLSearchParams;e(b)&&L.append("quarter",e(b));const z=`/api/students-bulk${L.toString()?"?"+L.toString():""}`,ve=await ea.get(z);if(!ve.success)throw new Error(ve.error||"Failed to load students");d(l,ve.students||[]),I()}catch(L){console.error("Error loading students:",L),Fe.error("Failed to load students. Please try again."),d(l,[])}finally{d(f,!1)}}function I(){d(c,e(l).filter(L=>{const z=!e(m)||L.name.toLowerCase().includes(e(m).toLowerCase())||L.id.toString().toLowerCase().includes(e(m).toLowerCase()),ve=!e(h)||L.gradeLevel===e(h),se=!e(g)||L.section===e(g);return z&&ve&&se}))}function j(){d(y,!e(y)),d(x,!1),d(A,!1)}function M(){d(x,!e(x)),d(y,!1),d(A,!1)}function Z(){d(A,!e(A)),d(y,!1),d(x,!1)}function Q(L){d(h,L.id),d(y,!1),I()}function W(L){d(g,L.id),d(x,!1),I()}function H(L){d(b,L.id),d(A,!1),q()}function U(){I()}function X(){d(m,""),d(h,""),d(g,""),d(b,""),q()}function B(L){return{7:"Grade 7",8:"Grade 8",9:"Grade 9",10:"Grade 10"}[L]||L}function oe(L){L.target.closest(".sgl-custom-dropdown")||(d(y,!1),d(x,!1),d(A,!1))}Ua(async()=>(await S(),await q(),document.addEventListener("click",oe),()=>{document.removeEventListener("click",oe)})),Ft(()=>e(h),()=>{d(a,C.find(L=>L.id===e(h)))}),Ft(()=>(e(F),e(g)),()=>{d(r,e(F).find(L=>L.id===e(g)))}),Ft(()=>e(b),()=>{d(o,E.find(L=>L.id===e(b)))}),Ft(()=>e(m),()=>{e(m)!==void 0&&U()}),Is(),Ps();var K=Gx(),de=v(n(K),2),ae=n(de),te=n(ae),Ce=n(te),Ae=v(n(Ce),2);ia(Ae);var Re=v(Ae,2);{var Me=L=>{var z=Ax();De("click",z,()=>d(m,"")),p(L,z)};$(Re,L=>{e(m)&&L(Me)})}i(Ce),i(te);var Ge=v(te,2),be=n(Ge),ke=v(n(be),2);let Ve;var it=n(ke),Be=n(it);{var He=L=>{var z=Cx(),ve=n(z),se=n(ve,!0);i(ve);var $e=v(ve,2),he=n($e,!0);i($e),i(z),O(()=>{w(se,(e(o),k(()=>e(o).icon))),w(he,(e(o),k(()=>e(o).name)))}),p(L,z)},Ne=L=>{var z=Tx();p(L,z)};$(Be,L=>{e(o)?L(He):L(Ne,!1)})}zt(2),i(it);var Je=v(it,2);Tt(Je,5,()=>E,L=>L.id,(L,z)=>{var ve=Ex();let se;var $e=n(ve),he=n($e,!0);i($e);var qe=v($e,2),et=n(qe),Le=n(et,!0);i(et),i(qe),i(ve),O(Qe=>{se=ge(ve,1,"sgl-dropdown-option",null,se,Qe),w(he,(e(z),k(()=>e(z).icon))),w(Le,(e(z),k(()=>e(z).name)))},[()=>({selected:e(b)===e(z).id})]),De("click",ve,()=>H(e(z))),p(L,ve)}),i(Je),i(ke),i(be);var lt=v(be,2),Pe=v(n(lt),2);let we;var tt=n(Pe),ct=n(tt);{var xe=L=>{var z=Fx(),ve=n(z),se=n(ve,!0);i(ve);var $e=v(ve,2),he=n($e,!0);i($e),i(z),O(()=>{w(se,(e(a),k(()=>e(a).icon))),w(he,(e(a),k(()=>e(a).name)))}),p(L,z)},Se=L=>{var z=$x();p(L,z)};$(ct,L=>{e(a)&&e(h)?L(xe):L(Se,!1)})}zt(2),i(tt);var We=v(tt,2);Tt(We,5,()=>C,L=>L.id,(L,z)=>{var ve=Nx();let se;var $e=n(ve),he=n($e,!0);i($e);var qe=v($e,2),et=n(qe),Le=n(et,!0);i(et),i(qe),i(ve),O(Qe=>{se=ge(ve,1,"sgl-dropdown-option",null,se,Qe),w(he,(e(z),k(()=>e(z).icon))),w(Le,(e(z),k(()=>e(z).name)))},[()=>({selected:e(h)===e(z).id})]),De("click",ve,()=>Q(e(z))),p(L,ve)}),i(We),i(Pe),i(lt);var Ze=v(lt,2),ee=v(n(Ze),2);let ue;var fe=n(ee),T=n(fe);{var P=L=>{var z=Px(),ve=n(z),se=n(ve,!0);i(ve),i(z),O(()=>w(se,(e(r),k(()=>e(r).name)))),p(L,z)},le=L=>{var z=Lx();p(L,z)};$(T,L=>{e(r)&&e(g)?L(P):L(le,!1)})}zt(2),i(fe);var R=v(fe,2);Tt(R,5,()=>e(F),L=>L.id,(L,z)=>{var ve=Mx();let se;var $e=n(ve),he=n($e),qe=n(he,!0);i(he),i($e),i(ve),O(et=>{se=ge(ve,1,"sgl-dropdown-option",null,se,et),w(qe,(e(z),k(()=>e(z).name)))},[()=>({selected:e(g)===e(z).id})]),De("click",ve,()=>W(e(z))),p(L,ve)}),i(R),i(ee),i(Ze);var G=v(Ze,2);{var ie=L=>{var z=Ix();De("click",z,X),p(L,z)};$(G,L=>{(e(m)||e(h)||e(g)||e(b))&&L(ie)})}i(Ge),i(ae),i(de);var _e=v(de,2),Y=n(_e);{var N=L=>{var z=Rx();p(L,z)},D=L=>{var z=mt(),ve=Ue(z);{var se=he=>{var qe=jx(),et=v(n(qe),4),Le=n(et);{var Qe=ht=>{var _t=_a("Try adjusting your search criteria or filters.");p(ht,_t)},st=ht=>{var _t=_a("No student records are available at the moment.");p(ht,_t)};$(Le,ht=>{e(m)||e(h)||e(g)?ht(Qe):ht(st,!1)})}i(et),i(qe),p(he,qe)},$e=he=>{var qe=qx(),et=Ue(qe),Le=n(et),Qe=n(Le);i(Le),i(et);var st=v(et,2),ht=n(st),_t=v(n(ht));Tt(_t,5,()=>e(c),xt=>xt.id,(xt,wt)=>{var St=Ox();let $t;var Nt=n(St),Ut=n(Nt,!0);i(Nt);var kt=v(Nt),jt=n(kt,!0);i(kt);var Wt=v(kt),Kt=n(Wt,!0);i(Wt);var aa=v(Wt),Yt=n(aa,!0);i(aa);var pe=v(aa),Ke=n(pe,!0);i(pe),i(St),O((yt,Te)=>{$t=ge(St,1,"sgl-student-row",null,$t,yt),w(Ut,(e(wt),k(()=>e(wt).id))),w(jt,(e(wt),k(()=>e(wt).name))),w(Kt,Te),w(Yt,(e(wt),k(()=>e(wt).section))),w(Ke,(e(wt),k(()=>e(wt).gwa)))},[()=>({"low-gwa":e(wt).gwa<75}),()=>(e(wt),k(()=>B(e(wt).gradeLevel)))]),p(xt,St)}),i(_t),i(ht),i(st),O(()=>w(Qe,`Showing ${e(c),k(()=>e(c).length)??""} of ${e(l),k(()=>e(l).length)??""} students`)),p(he,qe)};$(ve,he=>{e(c),k(()=>e(c).length===0)?he(se):he($e,!1)},!0)}p(L,z)};$(Y,L=>{e(f)?L(N):L(D,!1)})}i(_e),i(K),O((L,z,ve)=>{Ve=ge(ke,1,"sgl-custom-dropdown",null,Ve,L),we=ge(Pe,1,"sgl-custom-dropdown",null,we,z),ue=ge(ee,1,"sgl-custom-dropdown",null,ue,ve)},[()=>({open:e(A)}),()=>({open:e(y)}),()=>({open:e(x)})]),ca(Ae,()=>e(m),L=>d(m,L)),De("click",it,Z),De("click",tt,j),De("click",fe,M),p(s,K),Ga()}var Bx=_('<label class="time-input-label svelte-rxn8x9"> </label>'),zx=_('<span class="time-display svelte-rxn8x9"> </span>'),Wx=_('<span class="time-placeholder svelte-rxn8x9"> </span>'),Hx=_('<button type="button"> </button>'),Ux=_('<button type="button"> </button>'),Yx=_('<button type="button"> </button>'),Qx=_('<div class="time-dropdown-menu svelte-rxn8x9"><div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Hour</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Minute</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Period</div> <div class="time-options svelte-rxn8x9"></div></div></div>'),Kx=_('<div class="time-input-container svelte-rxn8x9"><!> <button type="button"><!> <span class="material-symbols-outlined time-dropdown-arrow svelte-rxn8x9">expand_more</span></button> <!></div>');function Sc(s,t){qa(t,!1);const a=V();let r=Pa(t,"value",8,""),o=Pa(t,"placeholder",8,"Select time"),l=Pa(t,"disabled",8,!1),c=Pa(t,"label",8,""),u=Pa(t,"isOpen",12,!1);const f=Pd(),m=`time-input-${Math.random().toString(36).substr(2,9)}`;let h=V(""),g=V(""),b=V("AM");const y=Array.from({length:12},(ae,te)=>{const Ce=te+1;return{value:Ce.toString().padStart(2,"0"),label:Ce.toString()}}),x=[{value:"00",label:"00"},{value:"15",label:"15"},{value:"30",label:"30"},{value:"45",label:"45"}],A=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}];function C(ae){if(!ae){d(h,""),d(g,""),d(b,"AM");return}const te=ae.split(":");let Ce=parseInt(te[0]);const Ae=te[1]||"00";Ce===0?(d(h,"12"),d(b,"AM")):Ce<12?(d(h,Ce.toString().padStart(2,"0")),d(b,"AM")):Ce===12?(d(h,"12"),d(b,"PM")):(d(h,(Ce-12).toString().padStart(2,"0")),d(b,"PM")),d(g,Ae)}function E(){if(!e(h)||!e(g))return"";let ae=parseInt(e(h));return e(b)==="AM"&&ae===12?ae=0:e(b)==="PM"&&ae!==12&&(ae+=12),`${ae.toString().padStart(2,"0")}:${e(g)}`}function F(){const ae=E();ae!==r()&&f("change",{value:ae})}function S(ae){d(h,ae),F()}function q(ae){d(g,ae),F()}function I(ae){d(b,ae),F()}function j(){l()||(u(!u()),u()&&f("open"))}function M(ae){ae.target.closest(".time-input-container")||u(!1)}Ft(()=>js(r()),()=>{r()&&r()!==E()&&C(r())}),Ft(()=>(e(h),e(g),e(b)),()=>{d(a,e(h)&&e(g)?`${e(h)}:${e(g)} ${e(b)}`:"")}),Is(),Ps();var Z=Kx();De("click",tr,M);var Q=n(Z);{var W=ae=>{var te=Bx(),Ce=n(te,!0);i(te),O(()=>{Vt(te,"for",m),w(Ce,c())}),p(ae,te)};$(Q,ae=>{c()&&ae(W)})}var H=v(Q,2);let U;var X=n(H);{var B=ae=>{var te=zx(),Ce=n(te,!0);i(te),O(()=>w(Ce,e(a))),p(ae,te)},oe=ae=>{var te=Wx(),Ce=n(te,!0);i(te),O(()=>w(Ce,o())),p(ae,te)};$(X,ae=>{e(a)?ae(B):ae(oe,!1)})}zt(2),i(H);var K=v(H,2);{var de=ae=>{var te=Qx(),Ce=n(te),Ae=v(n(Ce),2);Tt(Ae,5,()=>y,Ha,(ke,Ve)=>{var it=Hx();let Be;var He=n(it,!0);i(it),O(Ne=>{Be=ge(it,1,"time-option svelte-rxn8x9",null,Be,Ne),w(He,(e(Ve),k(()=>e(Ve).label)))},[()=>({selected:e(h)===e(Ve).value})]),De("click",it,()=>S(e(Ve).value)),p(ke,it)}),i(Ae),i(Ce);var Re=v(Ce,2),Me=v(n(Re),2);Tt(Me,5,()=>x,Ha,(ke,Ve)=>{var it=Ux();let Be;var He=n(it,!0);i(it),O(Ne=>{Be=ge(it,1,"time-option svelte-rxn8x9",null,Be,Ne),w(He,(e(Ve),k(()=>e(Ve).label)))},[()=>({selected:e(g)===e(Ve).value})]),De("click",it,()=>q(e(Ve).value)),p(ke,it)}),i(Me),i(Re);var Ge=v(Re,2),be=v(n(Ge),2);Tt(be,5,()=>A,Ha,(ke,Ve)=>{var it=Yx();let Be;var He=n(it,!0);i(it),O(Ne=>{Be=ge(it,1,"time-option svelte-rxn8x9",null,Be,Ne),w(He,(e(Ve),k(()=>e(Ve).label)))},[()=>({selected:e(b)===e(Ve).value})]),De("click",it,()=>I(e(Ve).value)),p(ke,it)}),i(be),i(Ge),i(te),p(ae,te)};$(K,ae=>{u()&&ae(de)})}i(Z),O(ae=>{Vt(H,"id",m),U=ge(H,1,"time-input-trigger svelte-rxn8x9",null,U,ae),H.disabled=l()},[()=>({open:u(),selected:e(a),disabled:l()})]),De("click",H,j),p(s,Z),Ga()}var Jx=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span></div></div>'),Xx=_('<span class="placeholder">Select year level</span>'),Zx=_('<button type="button"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),eS=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span></div></div>'),tS=_('<span class="placeholder"> </span>'),aS=_('<div class="admin-section-loading"><span class="system-loader"></span> <span>Loading sections...</span></div>'),sS=_('<button type="button"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),rS=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text">No sections available</span></div>'),iS=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon"> </span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),nS=_('<span class="scheduleassign-placeholder">Select Schedule Type</span>'),oS=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),lS=_('<span class="scheduleassign-placeholder">Select Subject</span>'),cS=_('<div class="scheduleassign-loading"><span class="system-loader"></span> <span>Loading subjects...</span></div>'),dS=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),uS=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text"> </span></div>'),vS=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-subject-dropdown">Subject</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-subject-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search subjects..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div>'),fS=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),pS=_('<span class="scheduleassign-placeholder">Select Activity Type</span>'),mS=_('<div class="scheduleassign-loading"><span class="system-loader"></span> <span>Loading activity types...</span></div>'),hS=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),gS=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No activity types available</span></div>'),_S=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-activity-dropdown">Activity Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-activity-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),bS=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),yS=_('<span class="scheduleassign-placeholder">Select Teacher</span>'),wS=_('<div class="scheduleassign-loading"><span class="system-loader"></span> <span>Loading teachers...</span></div>'),xS=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),SS=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text"> </span></div>'),kS=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-teacher-dropdown">Teacher</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-teacher-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search teachers..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div>'),DS=_('<div class="scheduleassign-time-error"><span class="material-symbols-outlined">error</span> <span> </span></div>'),AS=_('<div class="scheduleassign-time-duration"><span class="material-symbols-outlined">schedule</span> <span> </span></div>'),CS=_('<label class="scheduleassign-day-checkbox"><input type="checkbox"/> <span class="scheduleassign-checkbox-label"> </span></label>'),TS=_('<div class="scheduleassign-add-form" id="addScheduleForm"><h4 class="scheduleassign-form-title">Add New Schedule</h4> <div class="scheduleassign-form-inputs"><div class="scheduleassign-type-subject-row"><div class="scheduleassign-input-group"><label class="scheduleassign-input-label" for="scheduleassign-schedule-type-dropdown">Schedule Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-schedule-type-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Subject</span></div></button> <button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Activity</span></div></button></div></div></div> <!> <!></div> <div class="scheduleassign-time-section"><div class="scheduleassign-time-row"><div class="scheduleassign-input-group"><!></div> <div class="scheduleassign-input-group"><!></div></div> <div class="scheduleassign-time-info-container"><!></div> <div class="scheduleassign-day-selection-section"><div class="scheduleassign-day-checkboxes"></div></div></div></div> <div class="scheduleassign-form-actions"><button type="button"><span class="material-symbols-outlined"> </span> <!></button></div></div>'),ES=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">person</span> <span class="scheduleassign-detail-text"> </span></div>'),FS=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">schedule</span> <span class="scheduleassign-detail-text"> </span></div>'),$S=_('<span class="scheduleassign-room-details"> </span>'),NS=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">location_on</span> <span class="scheduleassign-detail-text"> <!></span></div>'),PS=_('<div class="scheduleassign-assignment-card"><div class="scheduleassign-assignment-header"><div class="scheduleassign-assignment-info"><h4 class="scheduleassign-assignment-title"> </h4> <p class="scheduleassign-assignment-subtitle"> </p></div> <div class="scheduleassign-assignment-actions"><button type="button" class="scheduleassign-delete-button" title="Delete assignment"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="scheduleassign-assignment-details"><!> <!> <!></div></div>'),LS=_('<div class="scheduleassign-empty-day"><span class="material-symbols-outlined empty-icon">event_available</span> <span class="empty-text">No schedules</span></div>'),MS=_('<div class="scheduleassign-day-column"><div class="scheduleassign-day-header"><span class="day-name"> </span></div> <div class="scheduleassign-day-schedules"><!></div></div>'),IS=_('<div class="scheduleassign-schedule-grid"><div class="scheduleassign-schedule-actions"><a href="#addScheduleForm" class="scheduleassign-add-schedule-link"><button type="button"><span class="material-symbols-outlined"> </span> </button></a></div> <!> <div class="scheduleassign-days-grid"></div></div>'),RS=_('<div class="scheduleassign-empty-state-main"><span class="material-symbols-outlined empty-icon">calendar_month</span> <h3>Select Year Level and Section</h3> <p>Choose a year level and section to view the weekly schedule.</p></div>'),jS=_('<div class="scheduleassign-form-section"><div class="scheduleassign-section-header"><h2 class="admin-section-title">Schedule Management</h2> <p class="scheduleassign-form-instruction">Select year level and section to view all schedule assignments.</p></div> <form><div class="scheduleassign-hierarchical-form"><div class="scheduleassign-selection-row"><div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-year">Year Level *</label> <div><button type="button" id="form-year"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"></div></div></div> <div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-section">Section *</label> <div><button type="button" id="form-section"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search sections..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div></div> <!></div></form></div>');function OS(s,t){qa(t,!1);const a=V(),r=V(),o=V(),l=V(),c=V(),u=V(),f=V(),m=V(),h=V(),g=[];let b=V(""),y=V(""),x=V(!1),A=V(!1),C=V(""),E=V(""),F=V(""),S=V(!1);const q=[{id:"grade-7",name:"Grade 7",description:"Junior High School - First Year"},{id:"grade-8",name:"Grade 8",description:"Junior High School - Second Year"},{id:"grade-9",name:"Grade 9",description:"Junior High School - Third Year"},{id:"grade-10",name:"Grade 10",description:"Junior High School - Fourth Year"}],I=[{id:"monday",name:"Monday"},{id:"tuesday",name:"Tuesday"},{id:"wednesday",name:"Wednesday"},{id:"thursday",name:"Thursday"},{id:"friday",name:"Friday"}];let j=V([]),M="2024-2025";async function Z(){try{const re=await(await fetch("/api/current-quarter")).json();re.success&&re.data?(M=re.data.currentSchoolYear,console.log(`School year set to: ${M}`)):console.warn("Failed to fetch current school year, using default: 2024-2025")}catch(me){console.error("Error fetching current school year:",me)}}async function Q(){d(S,!0);try{const re=await(await is("/api/sections?action=available-sections")).json();re.success&&d(j,re.data.map(J=>({id:J._id,name:J.name,grade:`Grade ${J.grade_level}`,year:`grade-${J.grade_level}`,grade_level:J.grade_level,school_year:J.school_year,status:J.status})))}catch(me){console.error("Error loading sections:",me)}finally{d(S,!1)}}let W=V([]),H=V(!1),U=V(!1),X=V([]),B=V({startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""}),oe=V([]),K=V([]),de=V([]),ae=V(!1),te=V(!1),Ce=V(!1),Ae=V(!1),Re=V(!1),Me=V(!1),Ge=V(!1),be=V(!1),ke=V(!1),Ve=V(""),it=V(""),Be=V(""),He=V(!1),Ne=V([]);function Je(){const me=e(B).startTime,re=e(B).endTime;if(!me||!re){d(Ve,""),d(it,"");return}const J=lt(me),je=lt(re);if(je<=J)d(Ve,"End time must be after start time"),d(it,"");else{d(Ve,"");const Ie=je-J,ot=Math.floor(Ie/60),Xe=Ie%60;ot>0&&Xe>0?d(it,`${ot} hour${ot>1?"s":""} and ${Xe} minute${Xe>1?"s":""}`):ot>0?d(it,`${ot} hour${ot>1?"s":""}`):d(it,`${Xe} minute${Xe>1?"s":""}`)}}function lt(me){const[re,J]=me.split(":").map(Number);return re*60+J}let Pe;function we(me,re){clearTimeout(Pe),Pe=setTimeout(me,re)}async function tt(){we(async()=>{if(!(!e(y)||!e(B).startTime||!e(B).endTime||e(X).length===0)){d(He,!1),d(Ne,[]),d(Be,"");try{const me=e(X).map(async Ie=>{const ot=I.find(gt=>gt.id===Ie)?.name.toLowerCase(),Xe=new URLSearchParams({action:"check-conflicts",sectionId:e(y),dayOfWeek:ot,startTime:e(B).startTime,endTime:e(B).endTime,schoolYear:M});e(B).teacherId&&e(B).scheduleType==="subject"&&Xe.append("teacherId",e(B).teacherId);const na=await(await is(`/api/schedules?${Xe}`)).json();return{day:ot,dayDisplay:I.find(gt=>gt.id===Ie)?.name,...na}}),re=await Promise.all(me),J=[],je=[];if(re.forEach(Ie=>{Ie.hasConflicts&&(je.push(Ie.dayDisplay),Ie.conflicts.forEach(ot=>{J.push({...ot,day:Ie.dayDisplay})}))}),J.length>0){d(He,!0),d(Ne,J);const Ie=J.filter(Mt=>Mt.type==="teacher_conflict"),ot=J.filter(Mt=>Mt.type==="section_conflict");if(Ie.length===1)Fe.error(Ie[0].message,6e3);else if(Ie.length>1){const Mt=[...new Set(Ie.map(gt=>gt.day))],na=Ie[0].details?.teacher_name||"Selected teacher";Fe.error(`${na} has schedule conflicts on ${Mt.join(", ")}. Please choose different times or another teacher.`,8e3)}if(ot.length===1)Fe.error(ot[0].message,6e3);else if(ot.length>1){const Mt=[...new Set(ot.map(na=>na.day))];Fe.error(`Time conflicts detected for this section on ${Mt.join(", ")}. Please choose different time slots.`,6e3)}let Xe=[];Ie.length>0&&Xe.push(`Teacher conflicts detected on ${[...new Set(Ie.map(Mt=>Mt.day))].join(", ")}`),ot.length>0&&Xe.push(`Section time conflicts detected on ${[...new Set(ot.map(Mt=>Mt.day))].join(", ")}`),d(Be,Xe.join(". "))}else d(He,!1),d(Be,"")}catch(me){console.error("Error checking conflicts:",me),Fe.error("Error checking for conflicts. Please try again."),d(He,!1)}finally{}}},500)}function ct(me){if(!me)return 0;const[re,J]=me.split(" "),[je,Ie]=re.split(":").map(Number);let ot=Ie;return J==="PM"&&je!==12?ot+=(je+12)*60:J==="AM"&&je===12?ot+=0:ot+=je*60,ot}function xe(me){me.target.closest(".scheduleassign-custom-dropdown")||(d(x,!1),d(A,!1),d(Ae,!1),d(Re,!1),d(Me,!1),d(Ge,!1)),me.target.closest(".time-input-container")||(d(be,!1),d(ke,!1))}function Se(){d(x,!e(x))}function We(){e(b)&&d(A,!e(A))}function Ze(me){d(b,me?me.id:""),d(y,""),d(x,!1)}function ee(me){d(y,me?me.id:""),d(A,!1),d(oe,[]),Ws(B,e(B).subjectId="")}function ue(me){if(!me)return"";const re=me.split(":");let J=parseInt(re[0]);const je=re[1],Ie=J>=12?"PM":"AM";J=J%12,J=J||12;const ot=je.startsWith("0")&&je!=="00"?je.substring(1):je;return ot==="00"?`${J}:00 ${Ie}`:`${J}:${ot} ${Ie}`}async function fe(){try{const re=await(await is("/api/schedules")).json();re.success?d(W,re.data.map(J=>({id:J.id,year:`grade-${J.grade_level}`,grade:`Grade ${J.grade_level}`,section:J.section_name,day:J.day_of_week.charAt(0).toUpperCase()+J.day_of_week.slice(1),time:`${ue(J.start_time)} - ${ue(J.end_time)}`,subject:J.subject_name||J.activity_type_name,teacher:J.teacher_name,type:J.schedule_type,startTime:ue(J.start_time),endTime:ue(J.end_time),subjectId:J.subject_id,activityTypeId:J.activity_type_id,teacherId:J.teacher_id,sectionId:J.section_id,schoolYear:J.school_year,roomId:J.room_id,roomName:J.room_name,roomBuilding:J.room_building,roomFloor:J.room_floor}))):console.error("Failed to load schedules:",re.error)}catch(me){console.error("Error loading schedules:",me)}}async function T(me){ns.confirm("Delete Assignment","<p>Are you sure you want to delete this schedule assignment?</p>",async()=>{try{const re=await ea.delete(`/api/schedules?id=${me.id}`);re.success?(d(W,e(W).filter(J=>J.id!==me.id)),d(W,[...e(W)]),setTimeout(()=>et(),0),Fe.success(`Assignment for ${me.subject} has been deleted successfully`)):Fe.error(re.error||"Failed to delete assignment")}catch(re){console.error("Error deleting assignment:",re),Fe.error("Failed to delete assignment. Please try again.")}},()=>{})}function P(){d(H,!e(H)),e(H)||le()}function le(){d(X,[]),d(B,{startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""})}function R(){d(Ae,!e(Ae))}function G(){d(Re,!e(Re))}function ie(){d(Me,!e(Me))}function _e(){d(Ge,!e(Ge))}function Y(){d(be,!0),d(ke,!1)}function N(){d(ke,!0),d(be,!1)}function D(me){const re=e(B).subjectId;if(Ws(B,e(B).subjectId=me.id),d(Ae,!1),d(E,""),re!==me.id&&e(B).teacherId){const J=e(de).find(je=>je.id===e(B).teacherId);J&&(!J.department_ids||!J.department_ids.includes(me.department_id))&&Ws(B,e(B).teacherId="")}}function L(me){Ws(B,e(B).activityTypeId=me.id),d(Re,!1)}function z(me){Ws(B,e(B).teacherId=me.id),d(Me,!1),d(F,"")}function ve(me){Ws(B,e(B).scheduleType=me),d(Ge,!1),me==="subject"?Ws(B,e(B).activityTypeId=null):Ws(B,e(B).subjectId=null)}async function se(){if(!(e(oe).length>0)){d(ae,!0);try{const me=e(j).find(ot=>ot.id===e(y)),re=me?me.grade_level:"",J=re?`/api/subjects?action=available-subjects&grade_level=${re}`:"/api/subjects?action=available-subjects",Ie=await(await is(J)).json();Ie.success&&d(oe,Ie.data)}catch(me){console.error("Error loading subjects:",me)}finally{d(ae,!1)}}}async function $e(){if(!(e(K).length>0)){d(te,!0);try{const re=await(await is("/api/activity-types?action=available-activity-types")).json();re.success&&d(K,re.data)}catch(me){console.error("Error loading activity types:",me)}finally{d(te,!1)}}}async function he(){if(!(e(de).length>0)){d(Ce,!0);try{const re=await(await is("/api/users?action=teachers")).json();re.success&&d(de,re.data)}catch(me){console.error("Error loading teachers:",me)}finally{d(Ce,!1)}}}async function qe(){if(!e(y)||e(X).length===0){Fe.error("Please select a section and at least one day");return}if(!e(B).startTime||!e(B).endTime){Fe.error("Please enter start and end times");return}if(e(B).scheduleType==="subject"&&!e(B).subjectId){Fe.error("Please select a subject");return}if(e(B).scheduleType==="activity"&&!e(B).activityTypeId){Fe.error("Please select an activity type");return}d(U,!0);try{const me=e(X).map(async Ie=>{const ot=I.find(Xe=>Xe.id===Ie)?.name.toLowerCase();try{const Xe=await is("/api/schedules",{method:"POST",body:JSON.stringify({sectionId:e(y),dayOfWeek:ot,startTime:e(B).startTime,endTime:e(B).endTime,scheduleType:e(B).scheduleType,subjectId:e(B).scheduleType==="subject"?e(B).subjectId:null,activityTypeId:e(B).scheduleType==="activity"?e(B).activityTypeId:null,teacherId:e(B).teacherId||null,schoolYear:M})}),Mt=await Xe.json();return Xe.ok?Mt:{success:!1,error:Mt.error||"Failed to create schedule",conflictType:Mt.conflictType,conflictingSchedule:Mt.conflictingSchedule}}catch(Xe){return console.error("API Error:",Xe),{success:!1,error:Xe.message||"Failed to create schedule"}}}),re=await Promise.all(me),J=re.filter(Ie=>!Ie.success),je=re.filter(Ie=>Ie.success);if(je.length>0&&await fe(),J.length===0)Fe.success(`Schedule added successfully for ${e(X).length} day(s)`),le(),d(H,!1);else{je.length>0&&Fe.success(`Schedule added successfully for ${je.length} day(s)`);const Ie=J.filter(Xe=>Xe.conflictType==="teacher_conflict"),ot=J.filter(Xe=>Xe.conflictType!=="teacher_conflict");Ie.length>0&&Ie.forEach(Xe=>{Fe.error(Xe.error,8e3)}),ot.length>0&&Fe.error(`Failed to add schedule for ${ot.length} day(s) due to time conflicts`),J.length>Ie.length+ot.length&&Fe.error(`Failed to add schedule for ${J.length-Ie.length-ot.length} day(s)`)}}catch(me){console.error("Error submitting schedule:",me),Fe.error("Failed to add schedule. Please try again.")}finally{d(U,!1)}}Ua(async()=>{await Z(),Q(),fe()}),Ld(()=>{et()});function et(){if(!e(b)||!e(y))return;const me=document.querySelectorAll(".scheduleassign-day-column");if(me.length===0)return;let re=0;me.forEach(J=>{const je=J.querySelector(".scheduleassign-day-schedules");if(je){const Ie=je.scrollHeight;re=Math.max(re,Ie)}}),me.forEach(J=>{const je=J.querySelector(".scheduleassign-empty-day"),Ie=J.querySelector(".scheduleassign-day-schedules");je&&Ie&&(Ie.children.length>1||Ie.children.length===1&&!Ie.querySelector(".scheduleassign-empty-day")||(je.style.minHeight=`${re}px`))})}Ft(()=>e(B),()=>{e(B).startTime&&e(B).endTime?Je():(d(Ve,""),d(it,""))}),Ft(()=>(e(y),e(B),e(X)),()=>{e(y)&&e(B).startTime&&e(B).endTime&&e(X).length>0?tt():(d(Be,""),d(He,!1),d(Ne,[]))}),Ft(()=>(e(b),e(j)),()=>{d(a,e(b)?e(j).filter(me=>me.year===e(b)):[])}),Ft(()=>(e(a),e(C)),()=>{d(r,e(a).filter(me=>me.name.toLowerCase().includes(e(C).toLowerCase())||me.grade.toLowerCase().includes(e(C).toLowerCase())))}),Ft(()=>(e(oe),e(E)),()=>{d(o,e(oe).filter(me=>me.name?.toLowerCase().includes(e(E).toLowerCase())||me.description?.toLowerCase().includes(e(E).toLowerCase())))}),Ft(()=>(e(de),e(B),e(oe),e(F)),()=>{d(l,e(de).filter(me=>{if(e(B).subjectId){const Xe=e(oe).find(Mt=>Mt.id===e(B).subjectId);if(Xe&&Xe.department_id&&(!me.department_ids||!me.department_ids.includes(Xe.department_id)))return!1}const re=e(F).toLowerCase(),J=me.full_name?.toLowerCase()||"",je=me.first_name?.toLowerCase()||"",Ie=me.last_name?.toLowerCase()||"",ot=me.email?.toLowerCase()||"";return J.includes(re)||je.includes(re)||Ie.includes(re)||ot.includes(re)}))}),Ft(()=>e(b),()=>{d(c,q.find(me=>me.id===e(b)))}),Ft(()=>(e(j),e(y)),()=>{d(u,e(j).find(me=>me.id===e(y)))}),Ft(()=>(e(W),e(b),e(y),e(u)),()=>{d(f,I.reduce((me,re)=>(me[re.id]=e(W).filter(J=>{if(!e(b)||!e(y))return!1;const je=J.year===e(b),Ie=J.section===e(u)?.name,ot=J.day===re.name;return je&&Ie&&ot}).sort((J,je)=>{const Ie=ct(J.startTime),ot=ct(je.startTime);return Ie-ot}),me),{}))}),Ft(()=>e(b),()=>{d(m,!!e(b))}),Ft(()=>e(y),()=>{d(h,!!e(y))}),Ft(()=>e(H),()=>{e(H)&&(se(),$e(),he())}),Is(),Ps();var Le=jS();De("click",tr,xe);var Qe=v(n(Le),2),st=n(Qe),ht=n(st),_t=n(ht),xt=v(n(_t),2);let wt;var St=n(xt);let $t;var Nt=n(St);{var Ut=me=>{var re=Jx(),J=v(n(re),2),je=n(J),Ie=n(je,!0);i(je),i(J),i(re),O(()=>w(Ie,(e(c),k(()=>e(c).name)))),p(me,re)},kt=me=>{var re=Xx();p(me,re)};$(Nt,me=>{e(c)?me(Ut):me(kt,!1)})}zt(2),i(St);var jt=v(St,2);Tt(jt,5,()=>q,me=>me.id,(me,re)=>{var J=Zx();let je;var Ie=v(n(J),2),ot=n(Ie),Xe=n(ot,!0);i(ot);var Mt=v(ot,2),na=n(Mt,!0);i(Mt),i(Ie),i(J),O(gt=>{je=ge(J,1,"scheduleassign-dropdown-item",null,je,gt),w(Xe,(e(re),k(()=>e(re).name))),w(na,(e(re),k(()=>e(re).description)))},[()=>({selected:e(b)===e(re).id})]),De("click",J,()=>Ze(e(re))),p(me,J)}),i(jt),i(xt),i(_t);var Wt=v(_t,2),Kt=v(n(Wt),2);let aa;var Yt=n(Kt);let pe;var Ke=n(Yt);{var yt=me=>{var re=eS(),J=v(n(re),2),je=n(J),Ie=n(je);i(je),i(J),i(re),O(()=>w(Ie,`${e(u),k(()=>e(u).grade)??""}  ${e(u),k(()=>e(u).name)??""}`)),p(me,re)},Te=me=>{var re=tS(),J=n(re,!0);i(re),O(()=>w(J,e(b)?"Select section":"Select year level first")),p(me,re)};$(Ke,me=>{e(u)?me(yt):me(Te,!1)})}zt(2),i(Yt);var ze=v(Yt,2),dt=n(ze),rt=n(dt);ia(rt),zt(2),i(dt);var vt=v(dt,2);{var Rt=me=>{var re=aS();p(me,re)},Zt=me=>{var re=mt(),J=Ue(re);{var je=ot=>{var Xe=mt(),Mt=Ue(Xe);Tt(Mt,1,()=>e(r),na=>na.id,(na,gt)=>{var Oe=sS();let bt;var Et=v(n(Oe),2),qt=n(Et),Jt=n(qt);i(qt);var va=v(qt,2),la=n(va);i(va),i(Et),i(Oe),O(ya=>{bt=ge(Oe,1,"scheduleassign-dropdown-item",null,bt,ya),w(Jt,`${e(gt),k(()=>e(gt).grade)??""}  ${e(gt),k(()=>e(gt).name)??""}`),w(la,`${e(gt),k(()=>e(gt).grade)??""} Section`)},[()=>({selected:e(y)===e(gt).id})]),De("click",Oe,()=>ee(e(gt))),p(na,Oe)}),p(ot,Xe)},Ie=ot=>{var Xe=rS();p(ot,Xe)};$(J,ot=>{e(r),k(()=>e(r).length>0)?ot(je):ot(Ie,!1)},!0)}p(me,re)};$(vt,me=>{e(S)?me(Rt):me(Zt,!1)})}i(ze),i(Kt),i(Wt),i(ht);var ma=v(ht,2);{var ft=me=>{var re=IS(),J=n(re),je=n(J),Ie=n(je);let ot;var Xe=n(Ie),Mt=n(Xe,!0);i(Xe);var na=v(Xe);i(Ie),i(je),i(J);var gt=v(J,2);{var Oe=Et=>{var qt=TS(),Jt=v(n(qt),2),va=n(Jt),la=n(va),ya=v(n(la),2),wa=n(ya);let Ea;var Aa=n(wa);{var ja=Ht=>{var Ye=iS(),sa=n(Ye),Dt=n(sa,!0);i(sa);var Bt=v(sa,2),ra=n(Bt),ua=n(ra,!0);i(ra),i(Bt),i(Ye),O(()=>{w(Dt,(e(B),k(()=>e(B).scheduleType==="subject"?"book":"sports"))),w(ua,(e(B),k(()=>e(B).scheduleType==="subject"?"Subject":"Activity")))}),p(Ht,Ye)},Ra=Ht=>{var Ye=nS();p(Ht,Ye)};$(Aa,Ht=>{e(B),k(()=>e(B).scheduleType)?Ht(ja):Ht(Ra,!1)})}zt(2),i(wa);var $a=v(wa,2);let ha;var fa=n($a);let ne;var Ee=v(fa,2);let nt;i($a),i(ya),i(la);var Ct=v(la,2);{var Qt=Ht=>{var Ye=vS(),sa=v(n(Ye),2),Dt=n(sa);let Bt;var ra=n(Dt);{var ua=Fa=>{const Wa=$r(()=>(e(oe),e(B),k(()=>e(oe).find(ls=>ls.id===e(B).subjectId))));var fs=oS(),es=v(n(fs),2),Za=n(es),os=n(Za,!0);i(Za),i(es),i(fs),O(()=>w(os,(js(e(Wa)),k(()=>e(Wa)?.name)))),p(Fa,fs)},Oa=Fa=>{var Wa=lS();p(Fa,Wa)};$(ra,Fa=>{e(B),k(()=>e(B).subjectId)?Fa(ua):Fa(Oa,!1)})}zt(2),i(Dt);var Ta=v(Dt,2);let Ma;var za=n(Ta),ts=n(za);ia(ts),zt(2),i(za);var bs=v(za,2);{var Va=Fa=>{var Wa=cS();p(Fa,Wa)},ss=Fa=>{var Wa=mt(),fs=Ue(Wa);{var es=os=>{var ls=mt(),Ds=Ue(ls);Tt(Ds,1,()=>e(o),rs=>rs.id,(rs,ps)=>{var xs=dS();let qs;var Ks=v(n(xs),2),Fs=n(Ks),rr=n(Fs,!0);i(Fs),i(Ks),i(xs),O(ir=>{qs=ge(xs,1,"scheduleassign-dropdown-option",null,qs,ir),w(rr,(e(ps),k(()=>e(ps).name)))},[()=>({selected:e(B).subjectId===e(ps).id})]),De("click",xs,()=>D(e(ps))),p(rs,xs)}),p(os,ls)},Za=os=>{var ls=uS(),Ds=v(n(ls),2),rs=n(Ds,!0);i(Ds),i(ls),O(()=>w(rs,e(E)?"No subjects found":"No subjects available")),p(os,ls)};$(fs,os=>{e(o),k(()=>e(o).length>0)?os(es):os(Za,!1)},!0)}p(Fa,Wa)};$(bs,Fa=>{e(ae)?Fa(Va):Fa(ss,!1)})}i(Ta),i(sa),i(Ye),O((Fa,Wa)=>{Bt=ge(Dt,1,"scheduleassign-dropdown-trigger",null,Bt,Fa),Dt.disabled=e(ae),Ma=ge(Ta,1,"scheduleassign-dropdown-menu",null,Ma,Wa)},[()=>({open:e(Ae),selected:e(B).subjectId}),()=>({open:e(Ae)})]),De("click",Dt,R),ca(ts,()=>e(E),Fa=>d(E,Fa)),p(Ht,Ye)},Ot=Ht=>{var Ye=_S(),sa=v(n(Ye),2),Dt=n(sa);let Bt;var ra=n(Dt);{var ua=Va=>{const ss=$r(()=>(e(K),e(B),k(()=>e(K).find(Za=>Za.id===e(B).activityTypeId))));var Fa=fS(),Wa=v(n(Fa),2),fs=n(Wa),es=n(fs,!0);i(fs),i(Wa),i(Fa),O(()=>w(es,(js(e(ss)),k(()=>e(ss)?.name)))),p(Va,Fa)},Oa=Va=>{var ss=pS();p(Va,ss)};$(ra,Va=>{e(B),k(()=>e(B).activityTypeId)?Va(ua):Va(Oa,!1)})}zt(2),i(Dt);var Ta=v(Dt,2);let Ma;var za=n(Ta);{var ts=Va=>{var ss=mS();p(Va,ss)},bs=Va=>{var ss=mt(),Fa=Ue(ss);{var Wa=es=>{var Za=mt(),os=Ue(Za);Tt(os,1,()=>e(K),ls=>ls.id,(ls,Ds)=>{var rs=hS();let ps;var xs=v(n(rs),2),qs=n(xs),Ks=n(qs,!0);i(qs),i(xs),i(rs),O(Fs=>{ps=ge(rs,1,"scheduleassign-dropdown-option",null,ps,Fs),w(Ks,(e(Ds),k(()=>e(Ds).name)))},[()=>({selected:e(B).activityTypeId===e(Ds).id})]),De("click",rs,()=>L(e(Ds))),p(ls,rs)}),p(es,Za)},fs=es=>{var Za=gS();p(es,Za)};$(Fa,es=>{e(K),k(()=>e(K).length>0)?es(Wa):es(fs,!1)},!0)}p(Va,ss)};$(za,Va=>{e(te)?Va(ts):Va(bs,!1)})}i(Ta),i(sa),i(Ye),O((Va,ss)=>{Bt=ge(Dt,1,"scheduleassign-dropdown-trigger",null,Bt,Va),Dt.disabled=e(te),Ma=ge(Ta,1,"scheduleassign-dropdown-menu",null,Ma,ss)},[()=>({open:e(Re),selected:e(B).activityTypeId}),()=>({open:e(Re)})]),De("click",Dt,G),p(Ht,Ye)};$(Ct,Ht=>{e(B),k(()=>e(B).scheduleType==="subject")?Ht(Qt):Ht(Ot,!1)})}var At=v(Ct,2);{var pa=Ht=>{var Ye=kS(),sa=v(n(Ye),2),Dt=n(sa);let Bt;var ra=n(Dt);{var ua=Fa=>{const Wa=$r(()=>(e(de),e(B),k(()=>e(de).find(ls=>ls.id===e(B).teacherId))));var fs=bS(),es=v(n(fs),2),Za=n(es),os=n(Za);i(Za),i(es),i(fs),O(()=>w(os,`${js(e(Wa)),k(()=>e(Wa)?.first_name)??""} ${js(e(Wa)),k(()=>e(Wa)?.last_name)??""}`)),p(Fa,fs)},Oa=Fa=>{var Wa=yS();p(Fa,Wa)};$(ra,Fa=>{e(B),k(()=>e(B).teacherId)?Fa(ua):Fa(Oa,!1)})}zt(2),i(Dt);var Ta=v(Dt,2);let Ma;var za=n(Ta),ts=n(za);ia(ts),zt(2),i(za);var bs=v(za,2);{var Va=Fa=>{var Wa=wS();p(Fa,Wa)},ss=Fa=>{var Wa=mt(),fs=Ue(Wa);{var es=os=>{var ls=mt(),Ds=Ue(ls);Tt(Ds,1,()=>e(l),rs=>rs.id,(rs,ps)=>{var xs=xS();let qs;var Ks=v(n(xs),2),Fs=n(Ks),rr=n(Fs);i(Fs),i(Ks),i(xs),O(ir=>{qs=ge(xs,1,"scheduleassign-dropdown-option",null,qs,ir),w(rr,`${e(ps),k(()=>e(ps).first_name)??""} ${e(ps),k(()=>e(ps).last_name)??""}`)},[()=>({selected:e(B).teacherId===e(ps).id})]),De("click",xs,()=>z(e(ps))),p(rs,xs)}),p(os,ls)},Za=os=>{var ls=SS(),Ds=v(n(ls),2),rs=n(Ds,!0);i(Ds),i(ls),O(()=>w(rs,e(F)?"No teachers found":"No teachers available")),p(os,ls)};$(fs,os=>{e(l),k(()=>e(l).length>0)?os(es):os(Za,!1)},!0)}p(Fa,Wa)};$(bs,Fa=>{e(Ce)?Fa(Va):Fa(ss,!1)})}i(Ta),i(sa),i(Ye),O((Fa,Wa)=>{Bt=ge(Dt,1,"scheduleassign-dropdown-trigger",null,Bt,Fa),Dt.disabled=e(Ce),Ma=ge(Ta,1,"scheduleassign-dropdown-menu",null,Ma,Wa)},[()=>({open:e(Me),selected:e(B).teacherId}),()=>({open:e(Me)})]),De("click",Dt,ie),ca(ts,()=>e(F),Fa=>d(F,Fa)),p(Ht,Ye)};$(At,Ht=>{e(B),k(()=>e(B).scheduleType==="subject")&&Ht(pa)})}i(va);var oa=v(va,2),ga=n(oa),xa=n(ga),ta=n(xa);Sc(ta,{label:"Start Time",placeholder:"Select start time",get value(){return e(B).startTime},set value(Ht){Ws(B,e(B).startTime=Ht)},get isOpen(){return e(be)},set isOpen(Ht){d(be,Ht)},$$events:{change:Ht=>Ws(B,e(B).startTime=Ht.detail.value),open:Y},$$legacy:!0}),i(xa);var Xt=v(xa,2),ba=n(Xt);Sc(ba,{label:"End Time",placeholder:"Select end time",get value(){return e(B).endTime},set value(Ht){Ws(B,e(B).endTime=Ht)},get isOpen(){return e(ke)},set isOpen(Ht){d(ke,Ht)},$$events:{change:Ht=>Ws(B,e(B).endTime=Ht.detail.value),open:N},$$legacy:!0}),i(Xt),i(ga);var Ca=v(ga,2),Na=n(Ca);{var Sa=Ht=>{var Ye=mt(),sa=Ue(Ye);{var Dt=ra=>{var ua=DS(),Oa=v(n(ua),2),Ta=n(Oa,!0);i(Oa),i(ua),O(()=>w(Ta,e(Ve))),p(ra,ua)},Bt=ra=>{var ua=mt(),Oa=Ue(ua);{var Ta=Ma=>{var za=AS(),ts=v(n(za),2),bs=n(ts);i(ts),i(za),O(()=>w(bs,`Duration: ${e(it)??""}`)),p(Ma,za)};$(Oa,Ma=>{e(it)&&Ma(Ta)},!0)}p(ra,ua)};$(sa,ra=>{e(Ve)?ra(Dt):ra(Bt,!1)})}p(Ht,Ye)};$(Na,Ht=>{e(B),k(()=>e(B).startTime&&e(B).endTime)&&Ht(Sa)})}i(Ca);var Da=v(Ca,2),La=n(Da);Tt(La,5,()=>I,Ha,(Ht,Ye)=>{var sa=CS(),Dt=n(sa);ia(Dt);var Bt,ra=v(Dt,2),ua=n(ra,!0);i(ra),i(sa),O(()=>{Bt!==(Bt=(e(Ye),k(()=>e(Ye).id)))&&(Dt.value=(Dt.__value=(e(Ye),k(()=>e(Ye).id)))??""),w(ua,(e(Ye),k(()=>e(Ye).name)))}),Gd(g,[],Dt,()=>(e(Ye),k(()=>e(Ye).id),e(X)),Oa=>d(X,Oa)),p(Ht,sa)}),i(La),i(Da),i(oa),i(Jt);var ce=v(Jt,2),ye=n(ce);let pt;var It=n(ye),Pt=n(It,!0);i(It);var Gt=v(It,2);{var da=Ht=>{var Ye=_a("Cannot Save - Conflicts Detected");p(Ht,Ye)},ka=Ht=>{var Ye=mt(),sa=Ue(Ye);{var Dt=ra=>{var ua=_a("Saving...");p(ra,ua)},Bt=ra=>{var ua=_a("Save Schedule");p(ra,ua)};$(sa,ra=>{e(U)?ra(Dt):ra(Bt,!1)},!0)}p(Ht,Ye)};$(Gt,Ht=>{e(He)?Ht(da):Ht(ka,!1)})}i(ye),i(ce),i(qt),O((Ht,Ye,sa,Dt,Bt)=>{Ea=ge(wa,1,"scheduleassign-dropdown-trigger",null,Ea,Ht),ha=ge($a,1,"scheduleassign-dropdown-menu",null,ha,Ye),ne=ge(fa,1,"scheduleassign-dropdown-option",null,ne,sa),nt=ge(Ee,1,"scheduleassign-dropdown-option",null,nt,Dt),pt=ge(ye,1,"scheduleassign-save-schedule-btn",null,pt,Bt),ye.disabled=(e(U),e(X),e(He),e(Ve),k(()=>e(U)||e(X).length===0||e(He)||e(Ve))),w(Pt,e(He)?"block":"save")},[()=>({open:e(Ge),selected:e(B).scheduleType}),()=>({open:e(Ge)}),()=>({selected:e(B).scheduleType==="subject"}),()=>({selected:e(B).scheduleType==="activity"}),()=>({"has-conflicts":e(He)})]),De("click",wa,_e),De("click",fa,()=>ve("subject")),De("click",Ee,()=>ve("activity")),De("click",ye,qe),p(Et,qt)};$(gt,Et=>{e(H)&&Et(Oe)})}var bt=v(gt,2);Tt(bt,5,()=>I,Et=>Et.id,(Et,qt)=>{var Jt=MS(),va=n(Jt),la=n(va),ya=n(la,!0);i(la),i(va);var wa=v(va,2),Ea=n(wa);{var Aa=Ra=>{var $a=mt(),ha=Ue($a);Tt(ha,1,()=>(e(f),e(qt),k(()=>e(f)[e(qt).id])),fa=>fa.id,(fa,ne)=>{var Ee=PS(),nt=n(Ee),Ct=n(nt),Qt=n(Ct),Ot=n(Qt,!0);i(Qt);var At=v(Qt,2),pa=n(At);i(At),i(Ct);var oa=v(Ct,2),ga=n(oa);i(oa),i(nt);var xa=v(nt,2),ta=n(xa);{var Xt=Da=>{var La=ES(),ce=v(n(La),2),ye=n(ce,!0);i(ce),i(La),O(()=>w(ye,(e(ne),k(()=>e(ne).teacher)))),p(Da,La)};$(ta,Da=>{e(ne),k(()=>e(ne).teacher)&&Da(Xt)})}var ba=v(ta,2);{var Ca=Da=>{var La=FS(),ce=v(n(La),2),ye=n(ce);i(ce),i(La),O(()=>w(ye,`${e(ne),k(()=>e(ne).startTime)??""} - ${e(ne),k(()=>e(ne).endTime)??""}`)),p(Da,La)};$(ba,Da=>{e(ne),k(()=>e(ne).startTime&&e(ne).endTime)&&Da(Ca)})}var Na=v(ba,2);{var Sa=Da=>{var La=NS(),ce=v(n(La),2),ye=n(ce),pt=v(ye);{var It=Pt=>{var Gt=$S(),da=n(Gt);i(Gt),O(()=>w(da,`(${e(ne),k(()=>e(ne).roomBuilding)??""}${e(ne),k(()=>e(ne).roomFloor?`, Floor ${e(ne).roomFloor}`:"")??""})`)),p(Pt,Gt)};$(pt,Pt=>{e(ne),k(()=>e(ne).roomBuilding||e(ne).roomFloor)&&Pt(It)})}i(ce),i(La),O(()=>w(ye,`${e(ne),k(()=>e(ne).roomName)??""} `)),p(Da,La)};$(Na,Da=>{e(ne),k(()=>e(ne).type==="subject"&&e(ne).roomName)&&Da(Sa)})}i(xa),i(Ee),O(()=>{w(Ot,(e(ne),k(()=>e(ne).subject))),w(pa,`${e(ne),k(()=>e(ne).grade)??""} - ${e(ne),k(()=>e(ne).section)??""}`)}),De("click",ga,()=>T(e(ne))),p(fa,Ee)}),p(Ra,$a)},ja=Ra=>{var $a=LS();p(Ra,$a)};$(Ea,Ra=>{e(f),e(qt),k(()=>e(f)[e(qt).id]&&e(f)[e(qt).id].length>0)?Ra(Aa):Ra(ja,!1)})}i(wa),i(Jt),O(()=>w(ya,(e(qt),k(()=>e(qt).name)))),p(Et,Jt)}),i(bt),i(re),O(Et=>{ot=ge(Ie,1,"scheduleassign-add-schedule-card",null,ot,Et),w(Mt,e(H)?"close":"add"),w(na,` ${e(H)?"Cancel Schedule":"Add Schedule"}`)},[()=>({"cancel-mode":e(H)})]),De("click",Ie,P),p(me,re)},ut=me=>{var re=RS();p(me,re)};$(ma,me=>{e(b)&&e(y)?me(ft):me(ut,!1)})}i(st),i(Qe),i(Le),O((me,re,J,je)=>{wt=ge(xt,1,"scheduleassign-custom-dropdown",null,wt,me),$t=ge(St,1,"scheduleassign-dropdown-button",null,$t,re),aa=ge(Kt,1,"scheduleassign-custom-dropdown",null,aa,J),pe=ge(Yt,1,"scheduleassign-dropdown-button",null,pe,je),Yt.disabled=!e(b)},[()=>({open:e(x)}),()=>({selected:e(b)}),()=>({open:e(A),disabled:!e(b)}),()=>({selected:e(y),disabled:!e(b)})]),De("click",St,Se),De("click",Yt,We),ca(rt,()=>e(C),me=>d(C,me)),p(s,Le),Ga()}const di="roomManagementData",lo="availableSectionsData",kc=300*1e3;function qS(){const{subscribe:s,set:t,update:a}=Qs({rooms:[],availableSections:[],isLoading:!1,error:null,lastUpdated:null});return{subscribe:s,init:r=>{r&&r.rooms&&t({rooms:r.rooms,availableSections:r.availableSections||[],isLoading:!1,error:null,lastUpdated:r.lastUpdated})},setLoading:r=>{a(o=>({...o,isLoading:r,error:r?null:o.error}))},updateRooms:r=>{const o=Date.now(),l={rooms:r,lastUpdated:o,isLoading:!1,error:null};a(c=>({...c,...l}));try{localStorage.setItem(di,JSON.stringify({rooms:r,lastUpdated:o}))}catch(c){console.warn("Failed to cache rooms data:",c)}},updateSections:r=>{const o=Date.now();a(l=>({...l,availableSections:r,lastUpdated:o}));try{localStorage.setItem(lo,JSON.stringify({sections:r,lastUpdated:o}))}catch(l){console.warn("Failed to cache sections data:",l)}},setError:r=>{a(o=>({...o,error:r,isLoading:!1}))},getCachedData:()=>{try{const r=localStorage.getItem(di),o=localStorage.getItem(lo);if(!r)return null;const l=JSON.parse(r),c=o?JSON.parse(o):{sections:[]},u=Date.now(),f=u-(l.lastUpdated||0),m=u-(c.lastUpdated||0);return f<kc?{rooms:l.rooms||[],availableSections:m<kc?c.sections||[]:[],lastUpdated:l.lastUpdated}:null}catch(r){return console.warn("Failed to retrieve cached room data:",r),null}},clearCache:()=>{try{localStorage.removeItem(di),localStorage.removeItem(lo)}catch(r){console.warn("Failed to clear room cache:",r)}},addRoom:r=>{a(o=>{const l=[r,...o.rooms];try{localStorage.setItem(di,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after adding room:",c)}return{...o,rooms:l}})},removeRoom:r=>{a(o=>{const l=o.rooms.filter(c=>c.id!==r);try{localStorage.setItem(di,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after removing room:",c)}return{...o,rooms:l}})},updateRoom:(r,o)=>{a(l=>{const c=l.rooms.map(u=>u.id===r?{...u,...o}:u);try{localStorage.setItem(di,JSON.stringify({rooms:c,lastUpdated:Date.now()}))}catch(u){console.warn("Failed to update cache after updating room:",u)}return{...l,rooms:c}})}}}const yr=qS();var GS=_('<span class="material-symbols-outlined">add_ad</span> Create Room',1),VS=_('<button type="button" class="adminroom-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),BS=_('<div class="admin-room-loading"><span class="system-loader"></span> <p>Loading rooms...</p></div>'),zS=_("<p>No rooms found. Create your first room using the form above.</p>"),WS=_("<p>No rooms found matching your search.</p>"),HS=_('<div class="admin-room-empty-state"><span class="material-symbols-outlined">meeting_room</span> <!></div>'),US=_('<button type="button" class="admin-room-unassign-button" title="Unassign Room"><span class="material-symbols-outlined">remove_circle</span></button>'),YS=_('<a><button type="button" class="admin-room-assign-button"><span class="material-symbols-outlined"> </span></button></a>'),QS=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">group</span> <span> </span></div>'),KS=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">check_circle</span> <span>Available</span></div>'),JS=_('<div class="admin-room-room-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),XS=_('<div class="admin-room-edit-form-section"><div class="admin-room-edit-form-container"><div class="admin-room-edit-form-header"><h2 class="admin-room-edit-form-title">Edit Room</h2> <p class="admin-room-edit-form-subtitle">Update room information</p></div> <form class="admin-room-edit-form-content"><div class="admin-room-edit-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-room-name">Room Name *</label> <input type="text" id="edit-room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-building">Building *</label> <input type="text" id="edit-building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-floor">Floor *</label> <input type="text" id="edit-floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-edit-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-update-button"><!></button></div></form></div></div>'),ZS=_('<div class="selected-option"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),ek=_('<span class="placeholder">Select a section</span>'),tk=_('<button type="button"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),ak=_('<div class="dropdown-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text"> </span></div>'),sk=_('<div class="admin-room-assign-form-section"><div class="admin-room-assign-form-container"><div class="admin-room-assign-form-header"><h2 class="admin-room-assign-form-title">Assign Room</h2> <p class="admin-room-assign-form-subtitle">Select a section to assign this room to</p></div> <form class="admin-room-assign-form-content"><div class="admin-room-assign-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="assign-section-select">Select Section *</label> <div><button type="button" id="assign-section-select"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="room-dropdown-menu"><div class="dropdown-search-container"><input type="text" class="dropdown-search-input" placeholder="Search sections..."/> <span class="material-icons dropdown-search-icon">search</span></div> <!></div></div></div></div> <div class="admin-room-assign-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-assign-submit-button"><!></button></div></form></div></div>'),rk=_('<div><div class="admin-room-room-header"><div class="admin-room-room-title"><h3 class="admin-room-room-name"> </h3></div> <div class="admin-room-action-buttons"><!> <a><button type="button" class="admin-room-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="admin-room-remove-button" title="Remove Room"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="admin-room-room-details"><div class="admin-room-room-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <div class="admin-room-room-created"><span class="material-symbols-outlined">schedule</span> <span> </span></div> <!></div> <!> <!></div>'),ik=_('<div class="admin-room-rooms-grid"></div>'),nk=_('<div class="admin-room-creation-form-container"><div class="admin-room-creation-form-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Create New Room</h2> <p class="admin-room-section-subtitle">Fill in the details below to create a new room</p></div> <div class="admin-room-form-container"><form><div class="admin-room-form-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="room-name">Room Name *</label> <input type="text" id="room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="building">Building *</label> <input type="text" id="building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="floor">Floor *</label> <input type="text" id="floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-form-actions"><button type="submit" class="admin-room-create-button"><!></button></div></form></div></div> <div class="admin-room-rooms-list-section"><div class="admin-room-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-room-section-title">All Rooms</h2> <p class="admin-room-section-subtitle">All rooms in the system</p></div> <div class="adminroom-filters-container"><div class="adminroom-search-container"><div class="adminroom-search-input-wrapper"><span class="material-symbols-outlined adminroom-search-icon">search</span> <input type="text" placeholder="Search by room name, building, or floor..." class="adminroom-search-input"/> <!></div></div></div></div></div> <!></div></div>');function ok(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(yr,"$roomManagementStore",a),l=V(),c=V(),u=V(),f=V(),m=V(),h=V();let g=V(!1),b=V(""),y=V(""),x=V(""),A=V(""),C=V(null),E=V(""),F=V(""),S=V(""),q=V(!1),I=V(null),j=V(""),M=V(!1),Z=V(!1),Q=V("");async function W(Y=!1){try{Y||yr.setLoading(!0);const N=await ea.get("/api/rooms");if(N.success)yr.updateRooms(N.data||[]);else throw new Error(N.message||"Failed to load rooms")}catch(N){console.error("Error loading rooms:",N),yr.setError("Failed to load rooms. Please try again."),Fe.error("Failed to load rooms. Please try again.")}}async function H(Y=!1){try{const N=await ea.get("/api/sections?action=available-sections");if(N.success)yr.updateSections(N.data||[]);else throw new Error(N.message||"Failed to load sections")}catch(N){console.error("Error loading sections:",N),Y||Fe.error("Failed to load sections. Please try again.")}}const U=Y=>{ns.confirm("Remove Room",`Are you sure you want to remove room ${Y.name}? This action cannot be undone.`,async()=>{try{const N=await ea.delete("/api/rooms",{id:Y.id});if(N.success)yr.removeRoom(Y.id),Fe.success(N.message);else throw new Error(N.message||"Failed to remove room")}catch(N){console.error("Error removing room:",N),Fe.error("Failed to remove room. Please try again.")}},()=>{})};async function X(){if(!e(y)||!e(x)||!e(A)){Fe.warning("Please fill in all required fields.");return}d(g,!0);try{const Y=await ea.post("/api/rooms",{name:e(y),building:e(x),floor:e(A)});if(Y.success)yr.addRoom(Y.data),Fe.success(Y.message),K();else throw new Error(Y.message||"Failed to create room")}catch(Y){console.error("Error creating room:",Y),Fe.error("Failed to create room. Please try again.")}finally{d(g,!1)}}async function B(Y){const N=e(l).find(D=>D.id===Y);N&&ns.confirm("Unassign Room",`Are you sure you want to unassign room "${N.name}"? This will remove all section assignments from this room.`,async()=>{await oe(Y)},()=>{})}async function oe(Y){try{if(!e(l).find(L=>L.id===Y))return;const D=await ea.patch("/api/rooms",{roomId:Y,action:"unassign"});if(D.success)await W(),await H(),Fe.success(D.message);else throw new Error(D.message||"Failed to unassign room")}catch(N){console.error("Error unassigning room:",N),Fe.error("Failed to unassign room. Please try again.")}}function K(){d(y,""),d(x,""),d(A,"")}function de(Y){Y.target.closest(".custom-dropdown")||d(Z,!1)}function ae(Y){e(C)===Y.id?(d(C,null),d(E,""),d(F,""),d(S,"")):(e(I)===Y.id&&(d(I,null),d(j,""),d(Z,!1)),d(C,Y.id),d(E,Y.name),d(F,Y.building),d(S,Y.floor))}async function te(){if(!e(E)||!e(F)||!e(S)){Fe.warning("Please fill in all required fields.");return}d(q,!0);try{const Y=e(l).find(D=>D.id===e(C)),N=await ea.put("/api/rooms",{id:e(C),name:e(E),building:e(F),floor:e(S),status:Y.status,assignedTo:Y.assignedTo});if(N.success)yr.updateRoom(e(C),N.data),Fe.success(N.message),d(C,null),d(E,""),d(F,""),d(S,"");else throw new Error(N.message||"Failed to update room")}catch(Y){console.error("Error updating room:",Y),Fe.error("Failed to update room. Please try again.")}finally{d(q,!1)}}function Ce(Y){e(I)===Y.id?(d(I,null),d(j,""),d(Z,!1)):(e(C)===Y.id&&(d(C,null),d(E,""),d(F,""),d(S,"")),d(I,Y.id),d(j,""),d(Z,!1))}function Ae(){d(Z,!e(Z))}function Re(Y){d(j,Y.id||Y._id?.toString()),d(Z,!1),d(Q,"")}async function Me(){if(!e(j)){Fe.warning("Please select a section.");return}d(M,!0);try{const Y=await ea.patch("/api/rooms",{roomId:e(I),sectionIds:[e(j)],action:"assign"});if(Y.success)await W(),await H(),Fe.success(Y.message),d(I,null),d(j,"");else throw new Error(Y.message||"Failed to assign room")}catch(Y){console.error("Error assigning room:",Y),Fe.error("Failed to assign room. Please try again.")}finally{d(M,!1)}}Ua(()=>{const Y=yr.getCachedData();Y&&yr.init(Y),W(!!Y),H(!!Y);const N=setInterval(()=>{W(!0),H(!0)},3e4);return()=>{clearInterval(N)}}),Ft(()=>(e(l),e(c),e(u),e(f),o()),()=>{(Y=>{d(l,Y.rooms),d(c,Y.availableSections),d(u,Y.isLoading),d(f,Y.error)})(o())}),Ft(()=>(e(l),e(b)),()=>{d(m,e(l).filter(Y=>Y.name.toLowerCase().includes(e(b).toLowerCase())||Y.building.toLowerCase().includes(e(b).toLowerCase())||Y.floor.toLowerCase().includes(e(b).toLowerCase())))}),Ft(()=>(e(c),e(Q)),()=>{d(h,e(c).filter(Y=>Y.name.toLowerCase().includes(e(Q).toLowerCase())||`Grade ${Y.grade_level}`.toLowerCase().includes(e(Q).toLowerCase())))}),Is(),Ps();var Ge=nk();De("click",tr,de);var be=n(Ge),ke=v(n(be),2),Ve=n(ke),it=n(Ve),Be=n(it),He=v(n(Be),2);ia(He),i(Be);var Ne=v(Be,2),Je=v(n(Ne),2);ia(Je),i(Ne);var lt=v(Ne,2),Pe=v(n(lt),2);ia(Pe),i(lt),i(it);var we=v(it,2),tt=n(we),ct=n(tt);{var xe=Y=>{var N=_a("Creating...");p(Y,N)},Se=Y=>{var N=GS();zt(),p(Y,N)};$(ct,Y=>{e(g)?Y(xe):Y(Se,!1)})}i(tt),i(we),i(Ve),i(ke),i(be);var We=v(be,2),Ze=n(We),ee=n(Ze),ue=v(n(ee),2),fe=n(ue),T=n(fe),P=v(n(T),2);ia(P);var le=v(P,2);{var R=Y=>{var N=VS();De("click",N,()=>d(b,"")),p(Y,N)};$(le,Y=>{e(b)&&Y(R)})}i(T),i(fe),i(ue),i(ee),i(Ze);var G=v(Ze,2);{var ie=Y=>{var N=BS();p(Y,N)},_e=Y=>{var N=mt(),D=Ue(N);{var L=ve=>{var se=HS(),$e=v(n(se),2);{var he=et=>{var Le=zS();p(et,Le)},qe=et=>{var Le=WS();p(et,Le)};$($e,et=>{e(l),k(()=>e(l).length===0)?et(he):et(qe,!1)})}i(se),p(ve,se)},z=ve=>{var se=ik();Tt(se,5,()=>e(m),$e=>$e.id,($e,he)=>{var qe=rk();let et;var Le=n(qe),Qe=n(Le),st=n(Qe),ht=n(st,!0);i(st),i(Qe);var _t=v(Qe,2),xt=n(_t);{var wt=ut=>{var me=US();De("click",me,()=>B(e(he).id)),p(ut,me)},St=ut=>{var me=YS(),re=n(me),J=n(re),je=n(J,!0);i(J),i(re),i(me),O(()=>{Vt(me,"href",`#admin-room-room-card-${e(he),k(()=>e(he).id)??""}`),Vt(re,"title",(e(I),e(he),k(()=>e(I)===e(he).id?"Cancel Assign":"Assign Room"))),w(je,(e(I),e(he),k(()=>e(I)===e(he).id?"close":"add_circle")))}),De("click",re,()=>Ce(e(he))),p(ut,me)};$(xt,ut=>{e(he),k(()=>e(he).assignedSections&&e(he).assignedSections.length>0)?ut(wt):ut(St,!1)})}var $t=v(xt,2),Nt=n($t),Ut=n(Nt),kt=n(Ut,!0);i(Ut),i(Nt),i($t);var jt=v($t,2);i(_t),i(Le);var Wt=v(Le,2),Kt=n(Wt),aa=v(n(Kt),2),Yt=n(aa);i(aa),i(Kt);var pe=v(Kt,2);{var Ke=ut=>{var me=QS(),re=v(n(me),2),J=n(re);i(re),i(me),O(je=>w(J,`Assigned to: ${je??""}`),[()=>(e(he),k(()=>e(he).assignedSections.map(je=>je.name).join(", ")))]),p(ut,me)},yt=ut=>{var me=KS();p(ut,me)};$(pe,ut=>{e(he),k(()=>e(he).assignedSections&&e(he).assignedSections.length>0)?ut(Ke):ut(yt,!1)})}var Te=v(pe,2),ze=v(n(Te),2),dt=n(ze);i(ze),i(Te);var rt=v(Te,2);{var vt=ut=>{var me=JS(),re=v(n(me),2),J=n(re);i(re),i(me),O(()=>w(J,`Updated: ${e(he),k(()=>e(he).updatedDate)??""}`)),p(ut,me)};$(rt,ut=>{e(he),k(()=>e(he).updatedDate&&e(he).updatedDate!==e(he).createdDate)&&ut(vt)})}i(Wt);var Rt=v(Wt,2);{var Zt=ut=>{var me=XS(),re=n(me),J=v(n(re),2),je=n(J),Ie=n(je),ot=v(n(Ie),2);ia(ot),i(Ie);var Xe=v(Ie,2),Mt=v(n(Xe),2);ia(Mt),i(Xe);var na=v(Xe,2),gt=v(n(na),2);ia(gt),i(na),i(je);var Oe=v(je,2),bt=n(Oe),Et=v(bt,2),qt=n(Et);{var Jt=la=>{var ya=_a("Updating...");p(la,ya)},va=la=>{var ya=_a("Update");p(la,ya)};$(qt,la=>{e(q)?la(Jt):la(va,!1)})}i(Et),i(Oe),i(J),i(re),i(me),O(()=>Et.disabled=e(q)||!e(E)||!e(F)||!e(S)),ca(ot,()=>e(E),la=>d(E,la)),ca(Mt,()=>e(F),la=>d(F,la)),ca(gt,()=>e(S),la=>d(S,la)),De("click",bt,()=>ae(e(he))),De("submit",J,sr(te)),p(ut,me)};$(Rt,ut=>{e(C),e(he),k(()=>e(C)===e(he).id)&&ut(Zt)})}var ma=v(Rt,2);{var ft=ut=>{var me=sk(),re=n(me),J=v(n(re),2),je=n(J),Ie=n(je),ot=v(n(Ie),2);let Xe;var Mt=n(ot);let na;var gt=n(Mt);{var Oe=ha=>{const fa=$r(()=>(e(c),e(j),k(()=>e(c).find(Ct=>(Ct.id||Ct._id?.toString())===e(j)))));var ne=mt(),Ee=Ue(ne);{var nt=Ct=>{var Qt=ZS(),Ot=v(n(Qt),2),At=n(Ot),pa=n(At,!0);i(At);var oa=v(At,2),ga=n(oa);i(oa),i(Ot),i(Qt),O(()=>{w(pa,(js(e(fa)),k(()=>e(fa).name))),w(ga,`Grade ${js(e(fa)),k(()=>e(fa).grade_level)??""} Section`)}),p(Ct,Qt)};$(Ee,Ct=>{e(fa)&&Ct(nt)})}p(ha,ne)},bt=ha=>{var fa=ek();p(ha,fa)};$(gt,ha=>{e(j)?ha(Oe):ha(bt,!1)})}zt(2),i(Mt);var Et=v(Mt,2),qt=n(Et),Jt=n(qt);ia(Jt),zt(2),i(qt);var va=v(qt,2);{var la=ha=>{var fa=mt(),ne=Ue(fa);Tt(ne,1,()=>e(h),Ee=>Ee.id||Ee._id,(Ee,nt)=>{var Ct=tk();let Qt;var Ot=v(n(Ct),2),At=n(Ot),pa=n(At,!0);i(At);var oa=v(At,2),ga=n(oa);i(oa),i(Ot),i(Ct),O(xa=>{Qt=ge(Ct,1,"dropdown-option",null,Qt,xa),w(pa,(e(nt),k(()=>e(nt).name))),w(ga,`Grade ${e(nt),k(()=>e(nt).grade_level)??""} Section`)},[()=>({selected:e(j)===(e(nt).id||e(nt)._id?.toString())})]),De("click",Ct,co(()=>Re(e(nt)))),p(Ee,Ct)}),p(ha,fa)},ya=ha=>{var fa=ak(),ne=v(n(fa),2),Ee=n(ne,!0);i(ne),i(fa),O(()=>w(Ee,e(Q)?"No sections found":"No sections available")),p(ha,fa)};$(va,ha=>{e(h),k(()=>e(h).length>0)?ha(la):ha(ya,!1)})}i(Et),i(ot),i(Ie),i(je);var wa=v(je,2),Ea=n(wa),Aa=v(Ea,2),ja=n(Aa);{var Ra=ha=>{var fa=_a("Assigning");p(ha,fa)},$a=ha=>{var fa=_a("Assign");p(ha,fa)};$(ja,ha=>{e(M)?ha(Ra):ha($a,!1)})}i(Aa),i(wa),i(J),i(re),i(me),O((ha,fa)=>{Xe=ge(ot,1,"custom-dropdown",null,Xe,ha),na=ge(Mt,1,"dropdown-trigger",null,na,fa),Aa.disabled=e(M)||!e(j)},[()=>({open:e(Z)}),()=>({selected:e(j)})]),De("click",Mt,co(Ae)),ca(Jt,()=>e(Q),ha=>d(Q,ha)),De("click",Ea,()=>Ce(e(he))),De("submit",J,sr(Me)),p(ut,me)};$(ma,ut=>{e(I),e(he),k(()=>e(I)===e(he).id)&&ut(ft)})}i(qe),O(ut=>{et=ge(qe,1,"admin-room-room-card",null,et,ut),Vt(qe,"id",`admin-room-room-card-${e(he),k(()=>e(he).id)??""}`),w(ht,(e(he),k(()=>e(he).name))),Vt($t,"href",`#admin-room-room-card-${e(he),k(()=>e(he).id)??""}`),Vt(Nt,"title",(e(C),e(he),k(()=>e(C)===e(he).id?"Cancel Edit":"Edit Room"))),w(kt,(e(C),e(he),k(()=>e(C)===e(he).id?"close":"edit"))),w(Yt,`${e(he),k(()=>e(he).building)??""}, ${e(he),k(()=>e(he).floor)??""}`),w(dt,`Created: ${e(he),k(()=>e(he).createdDate)??""}`)},[()=>({editing:e(C)===e(he).id,assigning:e(I)===e(he).id})]),De("click",Nt,()=>ae(e(he))),De("click",jt,()=>U(e(he))),p($e,qe)}),i(se),p(ve,se)};$(D,ve=>{e(m),k(()=>e(m).length===0)?ve(L):ve(z,!1)},!0)}p(Y,N)};$(G,Y=>{e(u)?Y(ie):Y(_e,!1)})}i(We),i(Ge),O(()=>tt.disabled=e(g)||!e(y)||!e(x)||!e(A)),ca(He,()=>e(y),Y=>d(y,Y)),ca(Je,()=>e(x),Y=>d(x,Y)),ca(Pe,()=>e(A),Y=>d(A,Y)),De("submit",Ve,sr(X)),ca(P,()=>e(b),Y=>d(b,Y)),p(s,Ge),Ga(),r()}const $i="sectionsCache",lk=180*1e3,lr=(()=>{const s=Qs([]),t=Qs(!1),a=Qs(null),r=()=>{try{const x=localStorage.getItem($i);if(!x)return null;const A=JSON.parse(x);return Date.now()-A.timestamp>lk?(localStorage.removeItem($i),null):A.sections}catch(x){return console.error("Error reading sections cache:",x),localStorage.removeItem($i),null}},o=x=>{try{const A={sections:x,timestamp:Date.now()};localStorage.setItem($i,JSON.stringify(A))}catch(A){console.error("Error setting sections cache:",A)}},l=()=>{try{localStorage.removeItem($i)}catch(x){console.error("Error clearing sections cache:",x)}},c=()=>{const x=r();return x?(s.set(x),!0):!1},u=(x,A=!1)=>{s.set(x),a.set(null),A||t.set(!1),o(x)},f=(x,A=!1)=>{A||t.set(x)},m=x=>{a.set(x),t.set(!1)},h=async(x=!1,A="")=>{try{f(!0,x);let C="/api/sections";A&&A.trim()&&(C+=`?search=${encodeURIComponent(A.trim())}`);const E=await is(C);if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const F=await E.json();if(!F.success||!F.data)throw new Error("Invalid API response structure");const S=F.data.map(q=>({...q,students:q.students||[],adviser:q.adviser||null}));u(S,x)}catch(C){console.error("Error loading sections:",C),m(C.message)}finally{f(!1,!1)}},g=x=>{s.update(A=>{const C=[...A,x];return o(C),C})},b=(x,A)=>{s.update(C=>{const E=C.map(F=>F.id===x?{...F,...A}:F);return o(E),E})},y=x=>{s.update(A=>{const C=A.filter(E=>E.id!==x);return o(C),C})};return{sections:{subscribe:s.subscribe},isLoadingSections:{subscribe:t.subscribe},sectionsError:{subscribe:a.subscribe},initSections:c,loadSections:h,updateSections:u,setLoadingSections:f,setSectionsError:m,addSection:g,updateSection:b,removeSection:y,clearSectionsCache:l}})();var ck=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),dk=_('<span class="sectionmgmt-placeholder">Select grade level</span>'),uk=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),vk=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),fk=_('<span class="sectionmgmt-placeholder">Select advisory teacher</span>'),pk=_('<span class="sectionmgmt-placeholder">Select grade level first</span>'),mk=_('<div class="admin-section-loading"><span class="system-loader"></span> <p>Loading teachers...</p></div>'),hk=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available teachers found</span></div>'),gk=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),_k=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),bk=_('<div class="admin-section-loading"><span class="system-loader"></span> <p>Loading students...</p></div>'),yk=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found for this grade level</span></div>'),wk=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <div class="sectionmgmt-student-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),xk=_('<div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="students"/> <!></div> <div class="sectionmgmt-student-list"><!></div>',1),Sk=_('<div class="sectionmgmt-placeholder-message"><span class="material-symbols-outlined">info</span> <span>Please select a grade level first to view available students.</span></div>'),kk=_('<span class="material-symbols-outlined">groups</span> Create Section',1),Dk=_('<button type="button" class="adminform-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Ak=_('<div class="adminform-selected-option"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></div>'),Ck=_('<span class="adminform-placeholder">Filter by grade</span>'),Tk=_('<button type="button"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></button>'),Ek=_('<div class="admin-section-loading"><span class="system-loader"></span> <p>Loading sections...</p></div>'),Fk=_('<div class="sectionmgmt-section-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),$k=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Nk=_('<span class="sectionmgmt-placeholder">Select section adviser</span>'),Pk=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Lk=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available advisers found</span></div>'),Mk=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),Ik=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <span class="material-symbols-outlined sectionmgmt-option-icon"> </span></button>'),Rk=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found</span></div>'),jk=_('<div class="sectionmgmt-edit-form-section"><div class="sectionmgmt-edit-form-container" id="section-edit-form-container"><div class="sectionmgmt-edit-form-header"><h2 class="sectionmgmt-edit-form-title">Edit Section</h2> <p class="sectionmgmt-edit-form-subtitle">Update section information and manage students</p></div> <form class="sectionmgmt-edit-form-content"><div class="sectionmgmt-edit-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-name">Section Name</label> <input type="text" id="edit-section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-adviser">Section Adviser</label> <div><button type="button" id="edit-section-adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search advisers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!> <!></div></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-students"> </label> <div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="edit-students"/> <!></div> <div class="sectionmgmt-student-list"><!> <!></div></div> <div class="sectionmgmt-edit-form-actions"><button type="button" class="sectionmgmt-cancel-button">Cancel</button> <button type="submit" class="sectionmgmt-submit-button"><!></button></div></form></div></div>'),Ok=_('<div><div class="sectionmgmt-section-header-card"><div class="sectionmgmt-section-title"><h3 class="sectionmgmt-section-name"> </h3></div> <div class="sectionmgmt-action-buttons"><a><button type="button" class="sectionmgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="sectionmgmt-remove-button" title="Remove Section"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="sectionmgmt-section-details"><div class="sectionmgmt-section-adviser"><span class="material-symbols-outlined">person_book</span> <span> </span></div> <div class="sectionmgmt-section-students"><span class="material-symbols-outlined">group</span> <span> </span></div> <div class="sectionmgmt-section-room"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <div class="sectionmgmt-section-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div> <!></div>'),qk=_("<p>No sections found</p>"),Gk=_("<p>No sections found matching your search.</p>"),Vk=_('<div class="sectionmgmt-sections-empty"><span class="material-symbols-outlined">school</span> <!></div>'),Bk=_("<!> <!>",1),zk=_(`<div class="sectionmgmt-form-container"><div class="sectionmgmt-creation-form-section"><div class="sectionmgmt-section-header"><h2 class="sectionmgmt-section-title">Create New Section</h2> <p class="sectionmgmt-section-subtitle">Fill in the details below to create a new class section</p></div> <div class="sectionmgmt-form-container"><form><div class="sectionmgmt-basic-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="section-name">Section Name *</label> <input type="text" id="section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="school-year">School Year</label> <input type="text" id="school-year" class="sectionmgmt-form-input" readonly=""/></div></div> <div class="sectionmgmt-create-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="adviser">Advisory Teacher (Optional)</label> <div><button type="button" id="adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search teachers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only teachers without assigned sections are shown. Each teacher can only advise one
							section.</p></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="students">Students (Optional)</label> <!></div> <div class="sectionmgmt-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="sectionmgmt-recent-sections-section"><div class="sectionmgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="sectionmgmt-section-title">All Sections</h2> <p class="sectionmgmt-section-subtitle">All sections in the system</p></div> <div class="adminform-search-filter-container"><div class="adminform-search-container"><div class="adminform-search-input-wrapper"><span class="material-symbols-outlined adminform-search-icon">search</span> <input type="text" placeholder="Search by section name, grade level, student account number, or student name..." class="adminform-search-input"/> <!></div></div> <div class="adminform-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined adminform-dropdown-arrow">expand_more</span></button> <div class="adminform-dropdown-menu"></div></div></div></div></div></div> <div class="sectionmgmt-sections-grid"><!></div></div></div>`);function Wk(s,t){qa(t,!1);const[a,r]=ks(),o=()=>Ja(e(u),"$isLoadingSections",a),l=()=>Ja(e(c),"$sections",a),c=V(),u=V(),f=V(),m=V(),h=V(),g=V(),b=V(),y=V(),x=V(),A=V(),C=V(),E=V();let F=V(!1),S=V(""),q=V(""),I=V(""),j=V(null),M=V([]),Z=V(!1),Q=V(!1),W=V(!1),H=V(""),U=V(""),X=V(""),B,oe=V("all"),K=V(null),de=V(""),ae=V(null),te=V([]),Ce=V(!1),Ae=V(!1),Re=V(""),Me=V(""),Ge=V([]),be=V([]),ke=V(!1),Ve=V(!1);async function it(){try{const Ee=await(await is("/api/current-quarter")).json();Ee.success&&Ee.data?.currentSchoolYear&&d(I,Ee.data.currentSchoolYear)}catch(ne){console.error("Error fetching current school year:",ne)}}Ua(async()=>{await it();const ne=lr.initSections();await lr.loadSections(ne),await Be()});async function Be(ne=null){try{d(ke,!0);const Ee=ne?`&teacherGradeLevel=${ne}`:"",nt=await ea.get(`/api/sections?action=available-teachers&schoolYear=${e(I)}${Ee}`);if(nt.success&&(d(Ge,nt.data.map(Ct=>{const Qt=e(h)&&e(h).length>0?e(h).some(Ot=>Ot.adviser_id===Ct.id):!1;return{id:Ct.id,name:Ct.full_name,employeeId:Ct.account_number,subject:Ct.subject_code||"No Subject",subject_grade_level:Ct.subject_grade_level,hasSection:Qt}})),e(h)&&e(h).length>0))for(const Ct of e(h))Ct.adviser_id&&!e(Ge).find(Qt=>Qt.id===Ct.adviser_id)&&e(Ge).push({id:Ct.adviser_id,name:Ct.adviser_name,employeeId:Ct.adviser_account_number||"N/A",subject:Ct.adviser_subject||"No Subject",subject_grade_level:Ct.grade_level,hasSection:!0})}catch(Ee){console.error("Error loading teachers:",Ee),Fe.error("Failed to load available teachers")}finally{d(ke,!1)}}async function He(ne){try{d(Ve,!0);const Ee=await ea.get(`/api/sections?action=available-students&gradeLevel=${ne}&schoolYear=${e(I)}`);Ee.success&&d(be,Ee.data.map(nt=>({id:nt.id,name:nt.full_name,studentId:nt.account_number,grade:nt.grade_level,hasSection:!1})))}catch(Ee){console.error("Error loading students:",Ee),Fe.error("Failed to load available students")}finally{d(Ve,!1)}}async function Ne(ne){try{const Ee=await ea.get(`/api/sections?action=section-students&sectionId=${ne}`);return Ee.success?Ee.data.map(nt=>({id:nt.id,name:nt.full_name,studentId:nt.account_number,grade:nt.grade_level})):[]}catch(Ee){return console.error("Error loading section students:",Ee),[]}}function Je(ne){e(te).findIndex(nt=>nt.id===ne.id)>-1?d(te,e(te).filter(nt=>nt.id!==ne.id)):d(te,[...e(te),ne])}function lt(){if(e(te).length===e(E).length&&e(E).every(ne=>e(te).some(Ee=>Ee.id===ne.id)))d(te,e(te).filter(ne=>!e(E).some(Ee=>Ee.id===ne.id)));else{const ne=e(E).filter(Ee=>!e(te).some(nt=>nt.id===Ee.id));d(te,[...e(te),...ne])}}const Pe=[{id:"7",name:"Grade 7",description:"First Year Junior High School"},{id:"8",name:"Grade 8",description:"Second Year Junior High School"},{id:"9",name:"Grade 9",description:"Third Year Junior High School"},{id:"10",name:"Grade 10",description:"Fourth Year Junior High School"}],we=[{id:"all",name:"All Sections",icon:"group"},{id:"7",name:"Grade 7",icon:"school"},{id:"8",name:"Grade 8",icon:"school"},{id:"9",name:"Grade 9",icon:"school"},{id:"10",name:"Grade 10",icon:"school"}];function tt(){d(Z,!e(Z)),d(Q,!1)}function ct(){d(Q,!e(Q)),d(Z,!1)}function xe(){d(W,!e(W))}function Se(ne){d(q,ne.id),d(Z,!1),d(M,[]),He(ne.id),Be(ne.id)}function We(ne){d(j,ne),d(Q,!1),d(H,"")}function Ze(ne){d(oe,ne.id),d(W,!1)}function ee(ne){e(M).findIndex(nt=>nt.id===ne.id)>-1?d(M,e(M).filter(nt=>nt.id!==ne.id)):d(M,[...e(M),ne])}function ue(){if(e(M).length===e(x).length&&e(x).every(ne=>e(M).some(Ee=>Ee.id===ne.id)))d(M,e(M).filter(ne=>!e(x).some(Ee=>Ee.id===ne.id)));else{const ne=e(x).filter(Ee=>!e(M).some(nt=>nt.id===Ee.id));d(M,[...e(M),...ne])}}function fe(){clearTimeout(B),B=setTimeout(async()=>{await lr.loadSections(!1,e(X))},500)}function T(){d(X,""),lr.loadSections(!1,"")}async function P(){if(!e(S)||!e(q)){Fe.error("Please fill in section name and grade level.");return}d(F,!0);try{const ne=await ea.post("/api/sections",{sectionName:e(S),gradeLevel:parseInt(e(q)),schoolYear:e(I),adviserId:e(j)?.id||null,studentIds:e(M).map(Ee=>Ee.id),roomId:null});ne.success?(Fe.success(ne.message),d(S,""),d(q,""),d(j,null),d(M,[]),d(H,""),d(U,""),d(be,[]),lr.addSection(ne.data),await Be()):Fe.error(ne.error||"Failed to create section")}catch(ne){console.error("Error creating section:",ne),Fe.error("Failed to create section. Please try again.")}finally{d(F,!1)}}async function le(ne){e(K)===ne.id?(d(K,null),d(de,""),d(ae,null),d(te,[]),d(Re,""),d(Me,""),d(Ae,!1)):(d(K,ne.id),d(de,ne.name),d(ae,e(Ge).find(Ee=>Ee.id===ne.adviser_id)),!e(ae)&&ne.adviser_id&&(d(ae,{id:ne.adviser_id,name:"Loading...",employeeId:"",subject:"",hasSection:!0}),await Be(ne.grade_level),d(ae,e(Ge).find(Ee=>Ee.id===ne.adviser_id)||e(ae))),d(te,await Ne(ne.id)),d(N,[...e(te)]),d(Me,""),await He(ne.grade_level))}async function R(){if(!e(de)){Fe.error("Please fill in section name.");return}d(Ce,!0);try{const ne={sectionId:e(K),sectionName:e(de),adviserId:e(ae)?.id||null,studentIds:e(te).map(nt=>nt.id||nt._id),roomId:null},Ee=await ea.put("/api/sections",ne);Ee.success?(Fe.success(Ee.message),d(K,null),d(de,""),d(ae,null),d(te,[]),d(Re,""),d(Me,""),d(Ae,!1),lr.updateSection(e(K),Ee.data),await lr.loadSections(!0),await Be()):Fe.error(Ee.error||"Failed to update section")}catch(ne){console.error("Error updating section:",ne),Fe.error("Failed to update section. Please try again.")}finally{d(Ce,!1)}}function G(){d(Ae,!e(Ae))}async function ie(ne){const Ee=ne.id;d(ae,ne),d(Ae,!1),d(Re,""),await Be(),d(ae,e(Ge).find(nt=>nt.id===Ee)||ne)}function _e(ne){ns.confirm("Delete Section",`<p>Are you sure you want to permanently delete section <strong>"${ne.name}"</strong> (Grade ${ne.grade_level})?</p>
			<p class="sectionmgmt-warning">This action will:</p>
			<ul class="sectionmgmt-warning-list">
				<li>Permanently delete the section and all its data</li>
				<li>Remove all students from this section</li>
				<li>Free up the advisory teacher for other sections</li>
				<li>This action cannot be undone</li>
			</ul>`,()=>Y(ne),null,{size:"medium"})}async function Y(ne){try{const Ee=await ea.delete(`/api/sections?sectionId=${ne._id}`);Ee.success?(Fe.success("Section deleted successfully"),lr.removeSection(ne._id)):Fe.error(Ee.error||"Failed to delete section")}catch(Ee){console.error("Error deleting section:",Ee),Fe.error("An error occurred while deleting the section")}}let N=V([]);Ft(()=>(e(c),e(u),e(f),lr),()=>{Jo(d(c,lr.sections),"$sections",a),Jo(d(u,lr.isLoadingSections),"$isLoadingSections",a),d(f,lr.sectionsError)}),Ft(()=>o(),()=>{d(m,o())}),Ft(()=>l(),()=>{d(h,l())}),Ft(()=>e(X),()=>{e(X)!==void 0&&fe()}),Ft(()=>e(q),()=>{d(g,Pe.find(ne=>ne.id===e(q)))}),Ft(()=>e(oe),()=>{d(b,we.find(ne=>ne.id===e(oe)))}),Ft(()=>(e(Ge),e(H)),()=>{d(y,e(Ge).filter(ne=>!ne.hasSection&&ne.name.toLowerCase().includes(e(H).toLowerCase())))}),Ft(()=>(e(q),e(M),e(j)),()=>{e(q)&&(d(M,e(M).filter(ne=>ne.grade===e(q))),e(j)&&e(j).subject_grade_level&&e(j).subject_grade_level!==parseInt(e(q))&&d(j,null))}),Ft(()=>(e(be),e(q),e(U),e(M)),()=>{d(x,e(be).filter(ne=>{const Ee=ne.grade===e(q),nt=ne.name.toLowerCase().includes(e(U).toLowerCase()),Ct=!ne.hasSection,Qt=!e(M).some(Ot=>Ot.id===ne.id);return Ee&&nt&&(Ct||!Qt)}).sort((ne,Ee)=>{const nt=e(M).some(Qt=>Qt.id===ne.id),Ct=e(M).some(Qt=>Qt.id===Ee.id);return nt&&!Ct?-1:!nt&&Ct?1:ne.name.localeCompare(Ee.name)}))}),Ft(()=>e(h),()=>{d(A,e(h))}),Ft(()=>(e(Ge),e(K),e(h),e(Re)),()=>{d(C,e(Ge).filter(ne=>{const Ee=e(K)&&e(h).find(At=>At.id===e(K))?.adviser_id,nt=!ne.hasSection||ne.id===Ee,Qt=(e(K)&&e(h).find(At=>At.id===e(K)))?.grade_level,Ot=!Qt||!ne.subject_grade_level||ne.subject_grade_level===Qt;return nt&&Ot&&ne.name.toLowerCase().includes(e(Re).toLowerCase())}))}),Ft(()=>(e(h),e(K),e(be),e(N),e(Me),e(te)),()=>{d(E,(()=>{e(h).find(Ee=>Ee.id===e(K));const ne=[...e(be)];return e(N).forEach(Ee=>{ne.some(nt=>nt.id===Ee.id)||ne.push({...Ee,hasSection:!0})}),ne.filter(Ee=>{const nt=Ee.name.toLowerCase().includes(e(Me).toLowerCase()),Ct=e(te).some(At=>At.id===Ee.id),Qt=e(N).some(At=>At.id===Ee.id),Ot=!Ee.hasSection||Ct||Qt;return nt&&Ot}).sort((Ee,nt)=>{const Ct=e(te).some(Ot=>Ot.id===Ee.id),Qt=e(te).some(Ot=>Ot.id===nt.id);return Ct&&!Qt?-1:!Ct&&Qt?1:Ee.name.localeCompare(nt.name)})})())}),Is(),Ps();var D=zk(),L=n(D),z=v(n(L),2),ve=n(z),se=n(ve),$e=n(se),he=v(n($e),2);ia(he),i($e);var qe=v($e,2),et=v(n(qe),2);ia(et),i(qe),i(se);var Le=v(se,2),Qe=n(Le),st=v(n(Qe),2);let ht;var _t=n(st);let xt;var wt=n(_t);{var St=ne=>{var Ee=ck(),nt=v(n(Ee),2),Ct=n(nt),Qt=n(Ct,!0);i(Ct),i(nt),i(Ee),O(()=>w(Qt,(e(g),k(()=>e(g).name)))),p(ne,Ee)},$t=ne=>{var Ee=dk();p(ne,Ee)};$(wt,ne=>{e(g)?ne(St):ne($t,!1)})}zt(2),i(_t);var Nt=v(_t,2);Tt(Nt,5,()=>Pe,ne=>ne.id,(ne,Ee)=>{var nt=uk();let Ct;var Qt=v(n(nt),2),Ot=n(Qt),At=n(Ot,!0);i(Ot);var pa=v(Ot,2),oa=n(pa,!0);i(pa),i(Qt),i(nt),O(ga=>{Ct=ge(nt,1,"sectionmgmt-dropdown-option",null,Ct,ga),w(At,(e(Ee),k(()=>e(Ee).name))),w(oa,(e(Ee),k(()=>e(Ee).description)))},[()=>({selected:e(q)===e(Ee).id})]),De("click",nt,()=>Se(e(Ee))),p(ne,nt)}),i(Nt),i(st),i(Qe);var Ut=v(Qe,2),kt=v(n(Ut),2);let jt;var Wt=n(kt);let Kt;var aa=n(Wt);{var Yt=ne=>{var Ee=vk(),nt=v(n(Ee),2),Ct=n(nt),Qt=n(Ct,!0);i(Ct),i(nt),i(Ee),O(()=>w(Qt,(e(j),k(()=>e(j).name)))),p(ne,Ee)},pe=ne=>{var Ee=mt(),nt=Ue(Ee);{var Ct=Ot=>{var At=fk();p(Ot,At)},Qt=Ot=>{var At=pk();p(Ot,At)};$(nt,Ot=>{e(q)?Ot(Ct):Ot(Qt,!1)},!0)}p(ne,Ee)};$(aa,ne=>{e(j)?ne(Yt):ne(pe,!1)})}zt(2),i(Wt);var Ke=v(Wt,2),yt=n(Ke),Te=n(yt);ia(Te),zt(2),i(yt);var ze=v(yt,2);{var dt=ne=>{var Ee=mk();p(ne,Ee)},rt=ne=>{var Ee=mt(),nt=Ue(Ee);{var Ct=Ot=>{var At=hk();p(Ot,At)},Qt=Ot=>{var At=mt(),pa=Ue(At);Tt(pa,1,()=>e(y),oa=>oa.id,(oa,ga)=>{var xa=gk();let ta;var Xt=v(n(xa),2),ba=n(Xt),Ca=n(ba,!0);i(ba);var Na=v(ba,2),Sa=n(Na,!0);i(Na),i(Xt),i(xa),O(Da=>{ta=ge(xa,1,"sectionmgmt-dropdown-option",null,ta,Da),w(Ca,(e(ga),k(()=>e(ga).name))),w(Sa,(e(ga),k(()=>e(ga).employeeId)))},[()=>({selected:e(j)?.id===e(ga).id})]),De("click",xa,()=>We(e(ga))),p(oa,xa)}),p(Ot,At)};$(nt,Ot=>{e(y),k(()=>e(y).length===0)?Ot(Ct):Ot(Qt,!1)},!0)}p(ne,Ee)};$(ze,ne=>{e(ke)?ne(dt):ne(rt,!1)})}i(Ke),i(kt),zt(2),i(Ut),i(Le);var vt=v(Le,2),Rt=v(n(vt),2);{var Zt=ne=>{var Ee=xk(),nt=Ue(Ee),Ct=n(nt);ia(Ct);var Qt=v(Ct,2);{var Ot=xa=>{const ta=$r(()=>(e(x),e(M),k(()=>e(x).every(Na=>e(M).some(Sa=>Sa.id===Na.id)))));var Xt=_k(),ba=n(Xt),Ca=n(ba,!0);i(ba),i(Xt),O(()=>{Vt(Xt,"title",`${e(ta)?"Deselect All":"Select All"} (${e(x),k(()=>e(x).length)??""})`),w(Ca,e(ta)?"deselect":"select_all")}),De("click",Xt,ue),p(xa,Xt)};$(Qt,xa=>{e(x),k(()=>e(x).length>0)&&xa(Ot)})}i(nt);var At=v(nt,2),pa=n(At);{var oa=xa=>{var ta=bk();p(xa,ta)},ga=xa=>{var ta=mt(),Xt=Ue(ta);{var ba=Na=>{var Sa=yk();p(Na,Sa)},Ca=Na=>{var Sa=mt(),Da=Ue(Sa);Tt(Da,1,()=>e(x),La=>La.id,(La,ce)=>{var ye=wk();let pt;var It=n(ye),Pt=v(n(It),2),Gt=n(Pt);i(Pt);var da=v(Pt,2),ka=n(da);i(da),i(It);var Ht=v(It,2),Ye=n(Ht),sa=n(Ye,!0);i(Ye),i(Ht),i(ye),O((Dt,Bt)=>{pt=ge(ye,1,"sectionmgmt-student-item",null,pt,Dt),w(Gt,`Grade ${e(ce),k(()=>e(ce).grade)??""} |`),w(ka,`${e(ce),k(()=>e(ce).name)??""}  ${e(ce),k(()=>e(ce).studentId)??""}`),w(sa,Bt)},[()=>({selected:e(M).some(Dt=>Dt.id===e(ce).id)}),()=>(e(M),e(ce),k(()=>e(M).some(Dt=>Dt.id===e(ce).id)?"check_box":"check_box_outline_blank"))]),De("click",ye,()=>ee(e(ce))),p(La,ye)}),p(Na,Sa)};$(Xt,Na=>{e(x),k(()=>e(x).length===0)?Na(ba):Na(Ca,!1)},!0)}p(xa,ta)};$(pa,xa=>{e(Ve)?xa(oa):xa(ga,!1)})}i(At),ca(Ct,()=>e(U),xa=>d(U,xa)),p(ne,Ee)},ma=ne=>{var Ee=Sk();p(ne,Ee)};$(Rt,ne=>{e(q)?ne(Zt):ne(ma,!1)})}i(vt);var ft=v(vt,2),ut=n(ft);let me;var re=n(ut);{var J=ne=>{var Ee=_a("Creating...");p(ne,Ee)},je=ne=>{var Ee=kk();zt(),p(ne,Ee)};$(re,ne=>{e(F)?ne(J):ne(je,!1)})}i(ut),i(ft),i(ve),i(z),i(L);var Ie=v(L,2),ot=n(Ie),Xe=n(ot),Mt=v(n(Xe),2),na=n(Mt),gt=n(na),Oe=v(n(gt),2);ia(Oe);var bt=v(Oe,2);{var Et=ne=>{var Ee=Dk();De("click",Ee,T),p(ne,Ee)};$(bt,ne=>{e(X)&&ne(Et)})}i(gt),i(na);var qt=v(na,2),Jt=n(qt);let va;var la=n(Jt);let ya;var wa=n(la);{var Ea=ne=>{var Ee=Ak(),nt=n(Ee),Ct=n(nt,!0);i(nt);var Qt=v(nt,2),Ot=n(Qt),At=n(Ot,!0);i(Ot),i(Qt),i(Ee),O(()=>{w(Ct,(e(b),k(()=>e(b).icon))),w(At,(e(b),k(()=>e(b).name)))}),p(ne,Ee)},Aa=ne=>{var Ee=Ck();p(ne,Ee)};$(wa,ne=>{e(b)?ne(Ea):ne(Aa,!1)})}zt(2),i(la);var ja=v(la,2);Tt(ja,5,()=>we,ne=>ne.id,(ne,Ee)=>{var nt=Tk();let Ct;var Qt=n(nt),Ot=n(Qt,!0);i(Qt);var At=v(Qt,2),pa=n(At),oa=n(pa,!0);i(pa),i(At),i(nt),O(ga=>{Ct=ge(nt,1,"adminform-dropdown-option",null,Ct,ga),w(Ot,(e(Ee),k(()=>e(Ee).icon))),w(oa,(e(Ee),k(()=>e(Ee).name)))},[()=>({selected:e(oe)===e(Ee).id})]),De("click",nt,()=>Ze(e(Ee))),p(ne,nt)}),i(ja),i(Jt),i(qt),i(Mt),i(Xe),i(ot);var Ra=v(ot,2),$a=n(Ra);{var ha=ne=>{var Ee=Ek();p(ne,Ee)},fa=ne=>{var Ee=Bk(),nt=Ue(Ee);Tt(nt,1,()=>e(A),Ot=>Ot.id,(Ot,At)=>{var pa=Ok();let oa;var ga=n(pa),xa=n(ga),ta=n(xa),Xt=n(ta);i(ta),i(xa);var ba=v(xa,2),Ca=n(ba),Na=n(Ca),Sa=n(Na),Da=n(Sa,!0);i(Sa),i(Na),i(Ca);var La=v(Ca,2);i(ba),i(ga);var ce=v(ga,2),ye=n(ce),pt=v(n(ye),2),It=n(pt,!0);i(pt),i(ye);var Pt=v(ye,2),Gt=v(n(Pt),2),da=n(Gt);i(Gt),i(Pt);var ka=v(Pt,2),Ht=v(n(ka),2),Ye=n(Ht,!0);i(Ht),i(ka);var sa=v(ka,2),Dt=v(n(sa),2),Bt=n(Dt);i(Dt),i(sa);var ra=v(sa,2);{var ua=Ma=>{var za=Fk(),ts=v(n(za),2),bs=n(ts);i(ts),i(za),O(Va=>w(bs,`Updated: ${Va??""}`),[()=>(e(At),k(()=>new Date(e(At).updated_at).toLocaleDateString()))]),p(Ma,za)};$(ra,Ma=>{e(At),k(()=>e(At).updated_at&&e(At).updated_at!==e(At).created_at)&&Ma(ua)})}i(ce);var Oa=v(ce,2);{var Ta=Ma=>{var za=jk(),ts=n(za),bs=v(n(ts),2),Va=n(bs),ss=n(Va),Fa=v(n(ss),2);ia(Fa),i(ss);var Wa=v(ss,2),fs=v(n(Wa),2);let es;var Za=n(fs);let os;var ls=n(Za);{var Ds=Ia=>{var Ba=$k(),ys=v(n(Ba),2),Gs=n(ys),ar=n(Gs,!0);i(Gs),i(ys),i(Ba),O(()=>w(ar,(e(ae),k(()=>e(ae).name)))),p(Ia,Ba)},rs=Ia=>{var Ba=Nk();p(Ia,Ba)};$(ls,Ia=>{e(ae)?Ia(Ds):Ia(rs,!1)})}zt(2),i(Za);var ps=v(Za,2),xs=n(ps),qs=n(xs);ia(qs),zt(2),i(xs);var Ks=v(xs,2);Tt(Ks,1,()=>e(C),Ia=>Ia.id,(Ia,Ba)=>{var ys=Pk();let Gs;var ar=v(n(ys),2),nr=n(ar),hr=n(nr,!0);i(nr);var Pr=v(nr,2),yi=n(Pr,!0);i(Pr),i(ar),i(ys),O(Wr=>{Gs=ge(ys,1,"sectionmgmt-dropdown-option",null,Gs,Wr),w(hr,(e(Ba),k(()=>e(Ba).name))),w(yi,(e(Ba),k(()=>e(Ba).employeeId)))},[()=>({selected:e(ae)?.id===e(Ba).id})]),De("click",ys,()=>ie(e(Ba))),p(Ia,ys)});var Fs=v(Ks,2);{var rr=Ia=>{var Ba=Lk();p(Ia,Ba)};$(Fs,Ia=>{e(C),k(()=>e(C).length===0)&&Ia(rr)})}i(ps),i(fs),i(Wa),i(Va);var ir=v(Va,2),zr=n(ir),Dr=n(zr);i(zr);var Nr=v(zr,2),gi=n(Nr);ia(gi);var Qi=v(gi,2);{var Ki=Ia=>{const Ba=$r(()=>(e(E),e(te),k(()=>e(E).every(nr=>e(te).some(hr=>hr.id===nr.id)))));var ys=Mk(),Gs=n(ys),ar=n(Gs,!0);i(Gs),i(ys),O(()=>{Vt(ys,"title",`${e(Ba)?"Deselect All":"Select All"} (${e(E),k(()=>e(E).length)??""})`),w(ar,e(Ba)?"deselect":"select_all")}),De("click",ys,lt),p(Ia,ys)};$(Qi,Ia=>{e(E),k(()=>e(E).length>0)&&Ia(Ki)})}i(Nr);var Ji=v(Nr,2),Xi=n(Ji);Tt(Xi,1,()=>e(E),Ia=>Ia.id,(Ia,Ba)=>{var ys=Ik();let Gs;var ar=n(ys),nr=v(n(ar),2),hr=n(nr,!0);i(nr);var Pr=v(nr,2),yi=n(Pr);i(Pr),i(ar);var Wr=v(ar,2),ri=n(Wr,!0);i(Wr),i(ys),O((Hr,ii)=>{Gs=ge(ys,1,"sectionmgmt-student-item",null,Gs,Hr),w(hr,(e(Ba),k(()=>e(Ba).name))),w(yi,`${e(Ba),k(()=>e(Ba).studentId)??""}  Grade ${e(Ba),k(()=>e(Ba).grade)??""}`),w(ri,ii)},[()=>({selected:e(te).some(Hr=>Hr.id===e(Ba).id)}),()=>(e(te),e(Ba),k(()=>e(te).some(Hr=>Hr.id===e(Ba).id)?"check_box":"check_box_outline_blank"))]),De("click",ys,()=>Je(e(Ba))),p(Ia,ys)});var On=v(Xi,2);{var ms=Ia=>{var Ba=Rk();p(Ia,Ba)};$(On,Ia=>{e(E),k(()=>e(E).length===0)&&Ia(ms)})}i(Ji),i(ir);var us=v(ir,2),Ts=n(us),Rs=v(Ts,2),_i=n(Rs);{var bi=Ia=>{var Ba=_a("Updating...");p(Ia,Ba)},Zi=Ia=>{var Ba=_a("Update");p(Ia,Ba)};$(_i,Ia=>{e(Ce)?Ia(bi):Ia(Zi,!1)})}i(Rs),i(us),i(bs),i(ts),i(za),O((Ia,Ba)=>{es=ge(fs,1,"sectionmgmt-custom-dropdown",null,es,Ia),os=ge(Za,1,"sectionmgmt-dropdown-trigger",null,os,Ba),w(Dr,`Students (${e(te),k(()=>e(te).length)??""} selected)`),Rs.disabled=e(Ce)||!e(de)},[()=>({open:e(Ae)}),()=>({selected:e(ae)})]),ca(Fa,()=>e(de),Ia=>d(de,Ia)),De("click",Za,G),ca(qs,()=>e(Re),Ia=>d(Re,Ia)),ca(gi,()=>e(Me),Ia=>d(Me,Ia)),De("click",Ts,()=>le(e(At))),De("submit",bs,sr(R)),p(Ma,za)};$(Oa,Ma=>{e(K),e(At),k(()=>e(K)===e(At).id)&&Ma(Ta)})}i(pa),O((Ma,za)=>{oa=ge(pa,1,"sectionmgmt-section-card",null,oa,Ma),Vt(pa,"id",`sectionmgmt-section-card-${e(At),k(()=>e(At).id)??""}`),w(Xt,`${e(At),k(()=>e(At).name)??""}  Grade ${e(At),k(()=>e(At).grade_level)??""}`),Vt(Ca,"href",`#sectionmgmt-section-card-${e(At),k(()=>e(At).id)??""}`),Vt(Na,"title",(e(K),e(At),k(()=>e(K)===e(At).id?"Cancel Edit":"Edit Section"))),w(Da,(e(K),e(At),k(()=>e(K)===e(At).id?"close":"edit"))),w(It,(e(At),k(()=>e(At).adviser_name||"No adviser"))),w(da,`${e(At),k(()=>e(At).student_count)??""} students`),w(Ye,(e(At),k(()=>e(At).room_name?`${e(At).room_name} (${e(At).room_building}, ${e(At).room_floor})`:"No room assigned"))),w(Bt,`Created: ${za??""}`)},[()=>({editing:e(K)===e(At).id}),()=>(e(At),k(()=>new Date(e(At).created_at).toLocaleDateString()))]),De("click",Na,()=>le(e(At))),De("click",La,()=>_e(e(At))),p(Ot,pa)});var Ct=v(nt,2);{var Qt=Ot=>{var At=Vk(),pa=v(n(At),2);{var oa=xa=>{var ta=qk();p(xa,ta)},ga=xa=>{var ta=Gk();p(xa,ta)};$(pa,xa=>{e(h),k(()=>e(h).length===0)?xa(oa):xa(ga,!1)})}i(At),p(Ot,At)};$(Ct,Ot=>{e(A),k(()=>e(A).length===0)&&Ot(Qt)})}p(ne,Ee)};$($a,ne=>{e(m)?ne(ha):ne(fa,!1)})}i(Ra),i(Ie),i(D),O((ne,Ee,nt,Ct,Qt,Ot,At)=>{ht=ge(st,1,"sectionmgmt-custom-dropdown",null,ht,ne),xt=ge(_t,1,"sectionmgmt-dropdown-trigger",null,xt,Ee),jt=ge(kt,1,"sectionmgmt-custom-dropdown",null,jt,nt),Kt=ge(Wt,1,"sectionmgmt-dropdown-trigger",null,Kt,Ct),Wt.disabled=!e(q),me=ge(ut,1,"sectionmgmt-create-button",null,me,Qt),ut.disabled=e(F)||!e(S)||!e(q),va=ge(Jt,1,"adminform-custom-dropdown",null,va,Ot),ya=ge(la,1,"adminform-dropdown-trigger adminform-filter-trigger",null,ya,At)},[()=>({open:e(Z)}),()=>({selected:e(q)}),()=>({open:e(Q)}),()=>({selected:e(j)}),()=>({loading:e(F)}),()=>({open:e(W)}),()=>({selected:e(oe)!=="all"})]),ca(he,()=>e(S),ne=>d(S,ne)),ca(et,()=>e(I),ne=>d(I,ne)),De("click",_t,tt),De("click",Wt,ct),ca(Te,()=>e(H),ne=>d(H,ne)),De("submit",ve,sr(P)),ca(Oe,()=>e(X),ne=>d(X,ne)),De("click",la,xe),p(s,D),Ga(),r()}var Hk=_('<div class="scheduleassign-container"><div class="scheduleassign-header"><div class="scheduleassign-header-content"><h1 class="scheduleassign-page-title">Schedule Management</h1> <p class="scheduleassign-page-subtitle">Assign subjects and teachers to sections with specific time periods</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">schedule</span> Schedule</button> <button><span class="material-icons">groups</span> Section</button> <button><span class="material-icons">meeting_room</span> Room</button></div></div> <div class="schedule-content-container"><!> <!> <!></div></div>');function Uk(s){let t=V("schedule");function a(S){d(t,S)}var r=Hk(),o=n(r),l=v(n(o),2),c=n(l);let u;var f=v(c,2);let m;var h=v(f,2);let g;i(l),i(o);var b=v(o,2),y=n(b);{var x=S=>{OS(S,{})};$(y,S=>{e(t)==="schedule"&&S(x)})}var A=v(y,2);{var C=S=>{Wk(S,{})};$(A,S=>{e(t)==="section"&&S(C)})}var E=v(A,2);{var F=S=>{ok(S,{})};$(E,S=>{e(t)==="room"&&S(F)})}i(b),i(r),O((S,q,I)=>{u=ge(c,1,"admin-tab-button",null,u,S),m=ge(f,1,"admin-tab-button",null,m,q),g=ge(h,1,"admin-tab-button",null,g,I)},[()=>({active:e(t)==="schedule"}),()=>({active:e(t)==="section"}),()=>({active:e(t)==="room"})]),De("click",c,()=>a("schedule")),De("click",f,()=>a("section")),De("click",h,()=>a("room")),p(s,r)}var Yk=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),Qk=_('<span class="adminsubject-placeholder">Select grade level</span>'),Kk=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),Jk=_('<span class="material-symbols-outlined">add_circle</span> Create Subject',1),Xk=_('<button type="button" class="adminsubject-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Zk=_('<div class="adminsubject-loading-container"><span class="system-loader"></span> <p class="adminsubject-loading-text">Loading subjects...</p></div>'),eD=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),tD=_('<span class="adminsubject-placeholder">Select grade level</span>'),aD=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),sD=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container" id="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Subject</h2> <p class="adminsubject-edit-form-subtitle">Update subject information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-grade-level">Grade Level *</label> <div><button type="button" id="edit-grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectName" class="adminsubject-form-label">Subject Name *</label> <input id="editSubjectName" type="text" class="adminsubject-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectCode" class="adminsubject-form-label">Subject Code *</label> <input id="editSubjectCode" type="text" class="adminsubject-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="adminsubject-edit-form-actions"><button type="button" class="adminsubject-cancel-button">Cancel</button> <button type="submit" class="adminsubject-submit-button"><!></button></div></form></div></div>'),rD=_('<div class="adminsubject-subject-card"><div class="adminsubject-subject-header"><div class="adminsubject-subject-title"><h3 class="adminsubject-subject-name"> </h3></div> <div class="adminsubject-action-buttons"><a><button type="button" class="adminsubject-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminsubject-remove-button" title="Remove Subject"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminsubject-subject-details"><div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),iD=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">search_off</span> <p>No subjects found matching your search.</p></div>'),nD=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Subject</h2> <p class="admin-section-subtitle">Fill in the details below to create a new subject</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="admin-form-group admin-form-group-third"><label for="subjectName" class="admin-form-label">Subject Name *</label> <input id="subjectName" type="text" class="admin-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="admin-form-group admin-form-group-third"><label for="subjectCode" class="admin-form-label">Subject Code *</label> <input id="subjectCode" type="text" class="admin-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Subjects</h2> <p class="admin-section-subtitle">All subjects in the system</p></div> <div class="adminsubject-search-container"><div class="adminsubject-search-input-wrapper"><span class="material-symbols-outlined adminsubject-search-icon">search</span> <input type="text" placeholder="Search by subject name or code..." class="adminsubject-search-input"/> <!></div></div></div></div> <div class="adminsubject-subjects-grid"><!></div></div></div>'),oD=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),lD=_('<span class="adminsubject-placeholder">Select icon</span>'),cD=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),dD=_('<span class="material-symbols-outlined">add_circle</span> Create Activity Type',1),uD=_('<button type="button" class="adminactivity-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),vD=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),fD=_('<span class="adminsubject-placeholder">Select icon</span>'),pD=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),mD=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Activity Type</h2> <p class="adminsubject-edit-form-subtitle">Update activity type information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-name">Activity Name *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-name" placeholder="e.g., Flag Ceremony" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-code">Activity Code *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-code" placeholder="e.g., FLAG" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-icon">Icon</label> <div><button type="button" id="edit-activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="adminsubject-edit-form-actions"><a><button type="button" class="adminsubject-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),hD=_('<div class="adminactivity-activity-card"><div class="adminactivity-activity-header"><div class="adminactivity-activity-title"><h3 class="adminactivity-activity-name"> </h3></div> <div class="adminactivity-action-buttons"><a><button type="button" class="adminactivity-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminactivity-remove-button" title="Remove Activity Type"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminactivity-activity-details"><div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">palette</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!></div>'),gD=_("<p>No activity types created yet.</p>"),_D=_("<p>No activity types found matching your search.</p>"),bD=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">event_note</span> <!></div>'),yD=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Activity Type</h2> <p class="admin-section-subtitle">Fill in the details below to create a new activity type</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-name">Activity Name *</label> <input id="activity-name" type="text" class="admin-form-input" placeholder="e.g., Flag Ceremony, Break Time" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-code">Activity Code *</label> <input id="activity-code" type="text" class="admin-form-input" placeholder="e.g., FLAG, BREAK" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-icon">Icon</label> <div><button type="button" id="activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Activities</h2> <p class="admin-section-subtitle">All activity types in the system</p></div> <div class="adminactivity-search-container"><div class="adminactivity-search-input-wrapper"><span class="material-symbols-outlined adminactivity-search-icon">search</span> <input type="text" placeholder="Search by activity name or code..." class="adminactivity-search-input"/> <!></div></div></div></div> <div class="adminactivity-activities-grid"><!></div></div></div>'),wD=_('<div class="admin-subject-creation-container"><div class="admin-subject-header"><div class="admin-header-content"><h1 class="admin-page-title">Subjects & Activities</h1> <p class="admin-page-subtitle">Manage subjects and activity types for the curriculum</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">subject</span> Subjects</button> <button><span class="material-icons">event</span> Activity Types</button></div></div> <!> <!></div>');function xD(s,t){qa(t,!1);const a=V(),r=V(),o=V(),l=V();let c=V(!1),u=V(""),f=V(""),m=V(""),h=V(!1),g=V(""),b=V(""),y=V("");function x(){d(g,"")}function A(){d(y,"")}let C=V(null),E=V(""),F=V(""),S=V(""),q=V(!1),I=V(!1),j=V("subjects"),M=V([]),Z=V(!1),Q=V(""),W=V(""),H=V("event"),U=V(!1),X=V(null),B=V(""),oe=V(""),K=V("event"),de=V(!1),ae=V(!1),te=V(!1),Ce=V([]);const Ae=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],Re=[{value:"event",name:"Event"},{value:"flag",name:"Flag"},{value:"coffee",name:"Coffee"},{value:"restaurant",name:"Restaurant"},{value:"groups",name:"Groups"},{value:"home",name:"Home"},{value:"book",name:"Book"},{value:"group_work",name:"Group Work"},{value:"schedule",name:"Schedule"}];async function Me(){d(te,!0);try{const D=await ea.get("/api/subjects");D.success?d(Ce,D.data):Fe.error("Failed to load subjects: "+D.message)}catch(D){console.error("Error loading subjects:",D),Fe.error("Failed to load subjects. Please try again.")}finally{d(te,!1)}}async function Ge(){try{const D=await ea.get("/api/activity-types");D.success?d(M,D.data):Fe.error("Failed to load activity types: "+D.message)}catch(D){console.error("Error loading activity types:",D),Fe.error("Failed to load activity types. Please try again.")}}Ua(()=>{Me(),Ge()});async function be(){if(!e(u)||!e(f).trim()||!e(m).trim()){Fe.error("Please fill in all required fields");return}d(c,!0);try{const D=await ea.post("/api/subjects",{name:e(f).trim(),code:e(m).trim(),gradeLevel:e(u)});D.success?(d(Ce,[D.data,...e(Ce)]),d(u,""),d(f,""),d(m,""),Fe.success(D.message)):Fe.error(D.message)}catch(D){console.error("Error creating subject:",D),Fe.error("Failed to create subject. Please try again.")}finally{d(c,!1)}}async function ke(D){ns.confirm("Remove Subject",`<p>Are you sure you want to remove the subject <strong>"${D.name}"</strong>?</p>`,async()=>{try{const L=await ea.delete("/api/subjects",{id:D.id});L.success?(d(Ce,e(Ce).filter(z=>z.id!==D.id)),Fe.success(L.message)):Fe.error(L.message)}catch(L){console.error("Error removing subject:",L),Fe.error("Failed to remove subject. Please try again.")}},null,{size:"small"})}function Ve(){d(I,!e(I))}function it(D){d(S,D.value),d(I,!1)}function Be(){d(h,!e(h))}function He(D){d(u,D.value),d(h,!1)}function Ne(D){D.target.closest(".adminsubject-custom-dropdown")||(d(h,!1),d(I,!1),d(U,!1),d(ae,!1))}function Je(){d(U,!e(U))}function lt(D){d(H,D),d(U,!1)}function Pe(D){const L=Re.find(z=>z.value===D);return L?L.name:D}function we(D){e(C)===D.id?(d(C,null),d(E,""),d(F,""),d(S,""),d(I,!1)):(d(C,D.id),d(E,D.name),d(F,D.code),d(S,parseInt(D.gradeLevel.replace("Grade ",""))))}async function tt(){if(!e(E).trim()||!e(F).trim()||!e(S)){Fe.error("Please fill in all required fields");return}d(q,!0);try{const D=await ea.put("/api/subjects",{id:e(C),name:e(E).trim(),code:e(F).trim(),gradeLevel:e(S)});D.success?(d(Ce,e(Ce).map(L=>L.id===e(C)?D.data:L)),Fe.success(D.message),d(C,null),d(E,""),d(F,""),d(S,""),d(I,!1)):Fe.error(D.message)}catch(D){console.error("Error updating subject:",D),Fe.error("Failed to update subject. Please try again.")}finally{d(q,!1)}}function ct(D){e(X)===D.id?(d(X,null),d(B,""),d(oe,""),d(K,"event"),d(ae,!1)):(d(X,D.id),d(B,D.name),d(oe,D.code),d(K,D.icon))}async function xe(){if(!e(B).trim()||!e(oe).trim()){Fe.error("Please fill in all required fields");return}d(de,!0);try{const D=await ea.put("/api/activity-types",{id:e(X),name:e(B).trim(),code:e(oe).trim(),icon:e(K)});D.success?(recentActivityTypes=recentActivityTypes.map(L=>L.id===e(X)?D.data:L),Fe.success(D.message),d(X,null),d(B,""),d(oe,""),d(K,"event"),d(ae,!1)):Fe.error(D.message)}catch(D){console.error("Error updating activity type:",D),Fe.error("Failed to update activity type. Please try again.")}finally{d(de,!1)}}function Se(){d(ae,!e(ae))}function We(D){d(K,D),d(ae,!1)}async function Ze(){if(!e(Q).trim()||!e(W).trim()){Fe.error("Please fill in all required fields");return}d(Z,!0);try{const D=await ea.post("/api/activity-types",{name:e(Q).trim(),code:e(W).trim(),icon:e(H)});D.success?(d(M,[D.data,...e(M)]),d(Q,""),d(W,""),d(H,"event"),Fe.success("Activity type created successfully")):Fe.error(D.message)}catch(D){console.error("Error creating activity type:",D),Fe.error("Failed to create activity type. Please try again.")}finally{d(Z,!1)}}async function ee(D){ns.confirm("Remove Activity Type",`<p>Are you sure you want to remove the activity type <strong>"${D.name}"</strong>?</p>`,async()=>{try{const L=await ea.delete("/api/activity-types",{id:D.id});L.success?(d(M,e(M).filter(z=>z.id!==D.id)),Fe.success(L.message)):Fe.error(L.message)}catch(L){console.error("Error removing activity type:",L),Fe.error("Failed to remove activity type. Please try again.")}},null,{size:"small"})}Ft(()=>e(u),()=>{d(a,Ae.find(D=>D.value===e(u)))}),Ft(()=>(e(Ce),e(g),e(b)),()=>{d(r,e(Ce).filter(D=>{const L=D.name.toLowerCase().includes(e(g).toLowerCase())||D.code.toLowerCase().includes(e(g).toLowerCase()),z=e(b)?D.gradeLevel===`Grade ${e(b)}`:!0;return L&&z}))}),Ft(()=>(e(M),e(y)),()=>{d(o,e(M).filter(D=>D.name.toLowerCase().includes(e(y).toLowerCase())||D.code.toLowerCase().includes(e(y).toLowerCase())))}),Ft(()=>e(S),()=>{d(l,Ae.find(D=>D.value===e(S)))}),Is(),Ps();var ue=wD();De("click",tr,Ne);var fe=n(ue),T=v(n(fe),2),P=n(T);let le;var R=v(P,2);let G;i(T),i(fe);var ie=v(fe,2);{var _e=D=>{var L=nD(),z=n(L),ve=v(n(z),2),se=n(ve),$e=n(se),he=n($e),qe=v(n(he),2);let et;var Le=n(qe);let Qe;var st=n(Le);{var ht=ft=>{var ut=Yk(),me=v(n(ut),2),re=n(me),J=n(re,!0);i(re),i(me),i(ut),O(()=>w(J,(e(a),k(()=>e(a).label)))),p(ft,ut)},_t=ft=>{var ut=Qk();p(ft,ut)};$(st,ft=>{e(a)?ft(ht):ft(_t,!1)})}zt(2),i(Le);var xt=v(Le,2);Tt(xt,5,()=>Ae,ft=>ft.value,(ft,ut)=>{var me=Kk();let re;var J=v(n(me),2),je=n(J),Ie=n(je,!0);i(je);var ot=v(je,2),Xe=n(ot,!0);i(ot),i(J),i(me),O(Mt=>{re=ge(me,1,"adminsubject-dropdown-option",null,re,Mt),w(Ie,(e(ut),k(()=>e(ut).label))),w(Xe,(e(ut),k(()=>e(ut).description)))},[()=>({selected:e(u)===e(ut).value})]),De("click",me,()=>He(e(ut))),p(ft,me)}),i(xt),i(qe),i(he);var wt=v(he,2),St=v(n(wt),2);ia(St),i(wt);var $t=v(wt,2),Nt=v(n($t),2);ia(Nt),i($t),i($e);var Ut=v($e,2),kt=n(Ut);let jt;var Wt=n(kt);{var Kt=ft=>{var ut=_a("Creating...");p(ft,ut)},aa=ft=>{var ut=Jk();zt(),p(ft,ut)};$(Wt,ft=>{e(c)?ft(Kt):ft(aa,!1)})}i(kt),i(Ut),i(se),i(ve),i(z);var Yt=v(z,2),pe=n(Yt),Ke=n(pe),yt=v(n(Ke),2),Te=n(yt),ze=v(n(Te),2);ia(ze);var dt=v(ze,2);{var rt=ft=>{var ut=Xk();De("click",ut,x),p(ft,ut)};$(dt,ft=>{e(g)&&ft(rt)})}i(Te),i(yt),i(Ke),i(pe);var vt=v(pe,2),Rt=n(vt);{var Zt=ft=>{var ut=Zk();p(ft,ut)},ma=ft=>{var ut=mt(),me=Ue(ut);Tt(me,1,()=>e(r),re=>re.id,(re,J)=>{var je=rD(),Ie=n(je),ot=n(Ie),Xe=n(ot),Mt=n(Xe);i(Xe),i(ot);var na=v(ot,2),gt=n(na),Oe=n(gt),bt=n(Oe),Et=n(bt,!0);i(bt),i(Oe),i(gt);var qt=v(gt,2);i(na),i(Ie);var Jt=v(Ie,2),va=n(Jt),la=v(n(va),2),ya=n(la,!0);i(la),i(va);var wa=v(va,2),Ea=v(n(wa),2),Aa=n(Ea);i(Ea),i(wa);var ja=v(wa,2),Ra=v(n(ja),2),$a=n(Ra);i(Ra),i(ja),i(Jt);var ha=v(Jt,2);{var fa=ne=>{var Ee=sD(),nt=n(Ee),Ct=v(n(nt),2),Qt=n(Ct),Ot=n(Qt),At=v(n(Ot),2);let pa;var oa=n(At);let ga;var xa=n(oa);{var ta=Gt=>{var da=eD(),ka=v(n(da),2),Ht=n(ka),Ye=n(Ht,!0);i(Ht),i(ka),i(da),O(()=>w(Ye,(e(l),k(()=>e(l).label)))),p(Gt,da)},Xt=Gt=>{var da=tD();p(Gt,da)};$(xa,Gt=>{e(l)?Gt(ta):Gt(Xt,!1)})}zt(2),i(oa);var ba=v(oa,2);Tt(ba,5,()=>Ae,Gt=>Gt.value,(Gt,da)=>{var ka=aD();let Ht;var Ye=v(n(ka),2),sa=n(Ye),Dt=n(sa,!0);i(sa);var Bt=v(sa,2),ra=n(Bt,!0);i(Bt),i(Ye),i(ka),O(ua=>{Ht=ge(ka,1,"adminsubject-dropdown-option",null,Ht,ua),w(Dt,(e(da),k(()=>e(da).label))),w(ra,(e(da),k(()=>e(da).description)))},[()=>({selected:e(S)===e(da).value})]),De("click",ka,()=>it(e(da))),p(Gt,ka)}),i(ba),i(At),i(Ot);var Ca=v(Ot,2),Na=v(n(Ca),2);ia(Na),i(Ca);var Sa=v(Ca,2),Da=v(n(Sa),2);ia(Da),i(Sa),i(Qt);var La=v(Qt,2),ce=n(La),ye=v(ce,2),pt=n(ye);{var It=Gt=>{var da=_a("Updating...");p(Gt,da)},Pt=Gt=>{var da=_a("Update Subject");p(Gt,da)};$(pt,Gt=>{e(q)?Gt(It):Gt(Pt,!1)})}i(ye),i(La),i(Ct),i(nt),i(Ee),O((Gt,da,ka)=>{pa=ge(At,1,"adminsubject-custom-dropdown",null,pa,Gt),ga=ge(oa,1,"adminsubject-dropdown-trigger",null,ga,da),ye.disabled=ka},[()=>({open:e(I)}),()=>({selected:e(S)}),()=>(e(q),e(E),e(F),e(S),k(()=>e(q)||!e(E).trim()||!e(F).trim()||!e(S)))]),De("click",oa,Ve),ca(Na,()=>e(E),Gt=>d(E,Gt)),ca(Da,()=>e(F),Gt=>d(F,Gt)),De("click",ce,()=>we(e(J))),De("submit",Ct,sr(tt)),p(ne,Ee)};$(ha,ne=>{e(C),e(J),k(()=>e(C)===e(J).id)&&ne(fa)})}i(je),O(()=>{Vt(je,"id",`adminsubject-subject-card-${e(J),k(()=>e(J).id)??""}`),w(Mt,`${e(J),k(()=>e(J).name)??""}  ${e(J),k(()=>e(J).gradeLevel)??""}`),Vt(gt,"href",`#adminsubject-subject-card-${e(J),k(()=>e(J).id)??""}`),Vt(Oe,"title",(e(C),e(J),k(()=>e(C)===e(J).id?"Cancel Edit":"Edit Subject"))),w(Et,(e(C),e(J),k(()=>e(C)===e(J).id?"close":"edit"))),w(ya,(e(J),k(()=>e(J).code))),w(Aa,`Created: ${e(J),k(()=>e(J).createdDate)??""}`),w($a,`Updated: ${e(J),k(()=>e(J).updatedDate)??""}`)}),De("click",Oe,()=>we(e(J))),De("click",qt,()=>ke(e(J))),p(re,je)},re=>{var J=iD();p(re,J)}),p(ft,ut)};$(Rt,ft=>{e(te)?ft(Zt):ft(ma,!1)})}i(vt),i(Yt),i(L),O((ft,ut,me,re)=>{et=ge(qe,1,"adminsubject-custom-dropdown",null,et,ft),Qe=ge(Le,1,"adminsubject-dropdown-trigger",null,Qe,ut),St.disabled=!e(u),jt=ge(kt,1,"admin-create-button",null,jt,me),kt.disabled=re},[()=>({open:e(h)}),()=>({selected:e(u)}),()=>({loading:e(c)}),()=>(e(c),e(u),e(f),k(()=>e(c)||!e(u)||!e(f).trim()))]),De("click",Le,Be),ca(St,()=>e(f),ft=>d(f,ft)),ca(Nt,()=>e(m),ft=>d(m,ft)),De("submit",se,sr(be)),ca(ze,()=>e(g),ft=>d(g,ft)),p(D,L)};$(ie,D=>{e(j)==="subjects"&&D(_e)})}var Y=v(ie,2);{var N=D=>{var L=yD(),z=n(L),ve=v(n(z),2),se=n(ve),$e=n(se),he=n($e),qe=v(n(he),2);ia(qe),i(he);var et=v(he,2),Le=v(n(et),2);ia(Le),i(et);var Qe=v(et,2),st=v(n(Qe),2);let ht;var _t=n(st);let xt;var wt=n(_t);{var St=ft=>{var ut=oD(),me=n(ut),re=n(me,!0);i(me);var J=v(me,2),je=n(J),Ie=n(je,!0);i(je),i(J),i(ut),O(ot=>{w(re,e(H)),w(Ie,ot)},[()=>(e(H),k(()=>Pe(e(H))))]),p(ft,ut)},$t=ft=>{var ut=lD();p(ft,ut)};$(wt,ft=>{e(H)?ft(St):ft($t,!1)})}zt(2),i(_t);var Nt=v(_t,2);Tt(Nt,5,()=>Re,ft=>ft.value,(ft,ut)=>{var me=cD();let re;var J=n(me),je=n(J,!0);i(J);var Ie=v(J,2),ot=n(Ie),Xe=n(ot,!0);i(ot),i(Ie),i(me),O(Mt=>{re=ge(me,1,"adminsubject-dropdown-option",null,re,Mt),w(je,(e(ut),k(()=>e(ut).value))),w(Xe,(e(ut),k(()=>e(ut).name)))},[()=>({selected:e(H)===e(ut).value})]),De("click",me,()=>lt(e(ut).value)),p(ft,me)}),i(Nt),i(st),i(Qe),i($e);var Ut=v($e,2),kt=n(Ut);let jt;var Wt=n(kt);{var Kt=ft=>{var ut=_a("Creating...");p(ft,ut)},aa=ft=>{var ut=dD();zt(),p(ft,ut)};$(Wt,ft=>{e(Z)?ft(Kt):ft(aa,!1)})}i(kt),i(Ut),i(se),i(ve),i(z);var Yt=v(z,2),pe=n(Yt),Ke=n(pe),yt=v(n(Ke),2),Te=n(yt),ze=v(n(Te),2);ia(ze);var dt=v(ze,2);{var rt=ft=>{var ut=uD();De("click",ut,A),p(ft,ut)};$(dt,ft=>{e(y)&&ft(rt)})}i(Te),i(yt),i(Ke),i(pe);var vt=v(pe,2),Rt=n(vt);{var Zt=ft=>{var ut=mt(),me=Ue(ut);Tt(me,1,()=>e(o),re=>re.id,(re,J)=>{var je=hD(),Ie=n(je),ot=n(Ie),Xe=n(ot),Mt=n(Xe,!0);i(Xe),i(ot);var na=v(ot,2),gt=n(na),Oe=n(gt),bt=n(Oe),Et=n(bt,!0);i(bt),i(Oe),i(gt);var qt=v(gt,2);i(na),i(Ie);var Jt=v(Ie,2),va=n(Jt),la=v(n(va),2),ya=n(la,!0);i(la),i(va);var wa=v(va,2),Ea=n(wa),Aa=n(Ea,!0);i(Ea);var ja=v(Ea,2),Ra=n(ja);i(ja),i(wa);var $a=v(wa,2),ha=v(n($a),2),fa=n(ha);i(ha),i($a);var ne=v($a,2),Ee=v(n(ne),2),nt=n(Ee);i(Ee),i(ne),i(Jt);var Ct=v(Jt,2);{var Qt=Ot=>{var At=mD(),pa=n(At),oa=v(n(pa),2),ga=n(oa),xa=n(ga),ta=v(n(xa),2);ia(ta),i(xa);var Xt=v(xa,2),ba=v(n(Xt),2);ia(ba),i(Xt);var Ca=v(Xt,2),Na=v(n(Ca),2);let Sa;var Da=n(Na);let La;var ce=n(Da);{var ye=Bt=>{var ra=vD(),ua=n(ra),Oa=n(ua,!0);i(ua);var Ta=v(ua,2),Ma=n(Ta),za=n(Ma,!0);i(Ma),i(Ta),i(ra),O(ts=>{w(Oa,e(K)),w(za,ts)},[()=>(e(K),k(()=>Pe(e(K))))]),p(Bt,ra)},pt=Bt=>{var ra=fD();p(Bt,ra)};$(ce,Bt=>{e(K)?Bt(ye):Bt(pt,!1)})}zt(2),i(Da);var It=v(Da,2);Tt(It,5,()=>Re,Bt=>Bt.value,(Bt,ra)=>{var ua=pD();let Oa;var Ta=n(ua),Ma=n(Ta,!0);i(Ta);var za=v(Ta,2),ts=n(za),bs=n(ts,!0);i(ts),i(za),i(ua),O(Va=>{Oa=ge(ua,1,"adminsubject-dropdown-option",null,Oa,Va),w(Ma,(e(ra),k(()=>e(ra).value))),w(bs,(e(ra),k(()=>e(ra).name)))},[()=>({selected:e(K)===e(ra).value})]),De("click",ua,()=>We(e(ra).value)),p(Bt,ua)}),i(It),i(Na),i(Ca),i(ga);var Pt=v(ga,2),Gt=n(Pt),da=n(Gt);i(Gt);var ka=v(Gt,2);let Ht;var Ye=n(ka);{var sa=Bt=>{var ra=_a("Updating...");p(Bt,ra)},Dt=Bt=>{var ra=_a("Update Activity Type");p(Bt,ra)};$(Ye,Bt=>{e(de)?Bt(sa):Bt(Dt,!1)})}i(ka),i(Pt),i(oa),i(pa),i(At),O((Bt,ra,ua,Oa)=>{Sa=ge(Na,1,"adminsubject-custom-dropdown",null,Sa,Bt),La=ge(Da,1,"adminsubject-dropdown-trigger",null,La,ra),Vt(Gt,"href",`#adminactivity-activity-card-${e(J),k(()=>e(J).id)??""}`),Ht=ge(ka,1,"adminsubject-submit-button",null,Ht,ua),ka.disabled=Oa},[()=>({open:e(ae)}),()=>({selected:e(K)}),()=>({loading:e(de)}),()=>(e(de),e(B),e(oe),k(()=>e(de)||!e(B).trim()||!e(oe).trim()))]),ca(ta,()=>e(B),Bt=>d(B,Bt)),ca(ba,()=>e(oe),Bt=>d(oe,Bt)),De("click",Da,Se),De("click",da,()=>ct(e(J))),De("submit",oa,sr(xe)),p(Ot,At)};$(Ct,Ot=>{e(X),e(J),k(()=>e(X)===e(J).id)&&Ot(Qt)})}i(je),O(Ot=>{Vt(je,"id",`adminactivity-activity-card-${e(J),k(()=>e(J).id)??""}`),w(Mt,(e(J),k(()=>e(J).name))),Vt(gt,"href",`#adminactivity-activity-card-${e(J),k(()=>e(J).id)??""}`),Vt(Oe,"title",(e(X),e(J),k(()=>e(X)===e(J).id?"Cancel Edit":"Edit Activity Type"))),w(Et,(e(X),e(J),k(()=>e(X)===e(J).id?"close":"edit"))),w(ya,(e(J),k(()=>e(J).code))),Ya(Ea,`color: var(--${e(J),k(()=>e(J).color)??""}-500)`),w(Aa,(e(J),k(()=>e(J).icon))),w(Ra,`Icon: ${e(J),k(()=>e(J).icon)??""}`),w(fa,`Color: ${e(J),k(()=>e(J).color)??""}`),w(nt,`Created: ${Ot??""}`)},[()=>k(()=>new Date().toLocaleDateString())]),De("click",Oe,()=>ct(e(J))),De("click",qt,()=>ee(e(J))),p(re,je)}),p(ft,ut)},ma=ft=>{var ut=bD(),me=v(n(ut),2);{var re=je=>{var Ie=gD();p(je,Ie)},J=je=>{var Ie=_D();p(je,Ie)};$(me,je=>{e(M),k(()=>e(M).length===0)?je(re):je(J,!1)})}i(ut),p(ft,ut)};$(Rt,ft=>{e(o),k(()=>e(o).length>0)?ft(Zt):ft(ma,!1)})}i(vt),i(Yt),i(L),O((ft,ut,me,re)=>{ht=ge(st,1,"adminsubject-custom-dropdown",null,ht,ft),xt=ge(_t,1,"adminsubject-dropdown-trigger",null,xt,ut),jt=ge(kt,1,"admin-create-button",null,jt,me),kt.disabled=re},[()=>({open:e(U)}),()=>({selected:e(H)}),()=>({loading:e(Z)}),()=>(e(Z),e(Q),e(W),k(()=>e(Z)||!e(Q).trim()||!e(W).trim()))]),ca(qe,()=>e(Q),ft=>d(Q,ft)),ca(Le,()=>e(W),ft=>d(W,ft)),De("click",_t,Je),De("submit",se,sr(Ze)),ca(ze,()=>e(y),ft=>d(y,ft)),p(D,L)};$(Y,D=>{e(j)==="activities"&&D(N)})}i(ue),O((D,L)=>{le=ge(P,1,"admin-tab-button",null,le,D),G=ge(R,1,"admin-tab-button",null,G,L)},[()=>({active:e(j)==="subjects"}),()=>({active:e(j)==="activities"})]),De("click",P,()=>d(j,"subjects")),De("click",R,()=>d(j,"activities")),p(s,ue),Ga()}var SD=_('<span class="material-symbols-outlined">add_ad</span> Create Department',1),kD=_('<button type="button" class="dept-mgmt-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),DD=_('<div class="dept-mgmt-loading"><span class="system-loader"></span> <p>Loading departments...</p></div>'),AD=_('<h3 class="dept-mgmt-empty-title">No departments created yet</h3> <p class="dept-mgmt-empty-description">Create your first department to get started</p>',1),CD=_('<h3 class="dept-mgmt-empty-title">No departments found</h3> <p class="dept-mgmt-empty-description">No departments match your search or filter criteria</p>',1),TD=_('<div class="dept-mgmt-empty-state"><span class="material-symbols-outlined dept-mgmt-empty-icon">corporate_fare</span> <!></div>'),ED=_('<div class="dept-mgmt-edit-form-section"><div class="dept-mgmt-edit-form-container" id="admin-department-edit-form-container"><div class="dept-mgmt-edit-form-header"><h2 class="dept-mgmt-edit-form-title">Edit Department</h2> <p class="dept-mgmt-edit-form-subtitle">Update department information</p></div> <form class="dept-mgmt-edit-form-content"><div class="dept-mgmt-edit-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-name">Department Name *</label> <input type="text" id="edit-department-name" class="dept-mgmt-form-input" placeholder="Enter department name" required/></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-code">Department Code *</label> <input type="text" id="edit-department-code" class="dept-mgmt-form-input" placeholder="Enter department code" required/></div></div> <div class="dept-mgmt-edit-form-actions"><a><button type="button" class="dept-mgmt-cancel-button">Cancel</button></a> <button type="submit" class="dept-mgmt-update-button"><!></button></div></form></div></div>'),FD=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),$D=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">subject</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-subject-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),ND=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">subject</span> <span>No subjects found</span></div>'),PD=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),LD=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">person</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-teacher-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),MD=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No teachers found</span></div>'),ID=_('<div class="dept-mgmt-assign-form-section"><div class="dept-mgmt-assign-form-container"><div class="dept-mgmt-assign-form-header"><h2 class="dept-mgmt-assign-form-title">Assign Subjects & Teachers</h2> <p class="dept-mgmt-assign-form-subtitle">Select subjects and teachers for this department</p></div> <form class="dept-mgmt-assign-form-content"><div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="subjects"> </label> <div class="dept-mgmt-subject-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search subjects by name or code..." id="subjects"/> <!></div> <div class="dept-mgmt-subject-list"><!> <!></div> <p class="dept-mgmt-form-help">Select subjects that will be managed by this department.</p></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="teachers"> </label> <div class="dept-mgmt-teacher-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search teachers by name or account number..." id="teachers"/> <!></div> <div class="dept-mgmt-teacher-list"><!> <!></div> <p class="dept-mgmt-form-help">Select teachers who will be part of this department.</p></div></div> <div class="dept-mgmt-assign-actions"><button type="button" class="dept-mgmt-cancel-button">Cancel</button> <button type="submit" class="dept-mgmt-assign-submit-button"><!></button></div></form></div></div>'),RD=_('<div><div class="dept-mgmt-department-header"><div class="dept-mgmt-department-title"><h3 class="dept-mgmt-department-name"> </h3></div> <div class="dept-mgmt-action-buttons"><a><button type="button" class="dept-mgmt-assign-button"><span class="material-symbols-outlined"> </span></button></a> <a><button type="button" class="dept-mgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="dept-mgmt-remove-button" title="Remove Department"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="dept-mgmt-department-details"><div class="dept-mgmt-department-code"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="dept-mgmt-department-subjects"><span class="material-symbols-outlined">subject</span> <span> </span></div> <div class="dept-mgmt-department-teachers"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="dept-mgmt-department-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!> <!></div>'),jD=_('<div class="dept-mgmt-container"><div class="dept-mgmt-header"><div class="dept-mgmt-header-content"><h1 class="dept-mgmt-page-title">Department Management</h1> <p class="dept-mgmt-page-subtitle">Create and manage academic departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-create-section"><h2 class="dept-mgmt-section-title">Create New Department</h2> <p class="dept-mgmt-section-subtitle">Add a new academic department to organize subjects and teachers</p> <div class="dept-mgmt-create-form"><div class="dept-mgmt-form-row"><div class="dept-mgmt-form-group"><label for="departmentName" class="dept-mgmt-form-label">Department Name *</label> <input id="departmentName" type="text" placeholder="e.g., Mathematics Department" class="dept-mgmt-form-input"/></div> <div class="dept-mgmt-form-group"><label for="departmentCode" class="dept-mgmt-form-label">Department Code *</label> <input id="departmentCode" type="text" placeholder="e.g., MATH-DEPT" class="dept-mgmt-form-input"/></div></div> <div class="dept-mgmt-form-actions"><button type="submit" class="dept-mgmt-btn-primary"><!></button></div></div></div> <div class="dept-mgmt-departments-section"><div class="dept-mgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="dept-mgmt-section-title">All Departments</h2> <p class="dept-mgmt-section-subtitle">Manage existing departments, assign subjects and teachers</p></div> <div class="dept-mgmt-search-container"><div class="dept-mgmt-search-input-wrapper"><span class="material-symbols-outlined dept-mgmt-search-icon">search</span> <input type="text" placeholder="Search by name or code..." class="dept-mgmt-search-input"/> <!></div></div></div></div> <div class="dept-mgmt-departments-grid"><!></div></div></div>');function OD(s,t){qa(t,!1);const a=V(),r=V(),o=V(),l=V();let c=V(!1),u=V([]),f=V([]),m=V(""),h=V(""),g=V([]),b=V([]),y="all",x=V(""),A=V(null),C=V(""),E=V(""),F=V(!1),S=V(null),q=V(!1),I=V([]),j=V([]),M=V(""),Z=V(""),Q=V(!1);async function W(){d(Q,!0);try{const D=await ea.get("/api/departments?action=departments");D.success?d(g,D.data.map(L=>({id:L.id,name:L.name,code:L.code,subjects:L.subjects||[],teachers:L.teachers||[],createdAt:L.created_at?L.created_at.split("T")[0]:new Date().toISOString().split("T")[0]}))):Fe.error("Failed to load departments")}catch(D){console.error("Error fetching departments:",D),Fe.error("Failed to load departments")}finally{d(Q,!1)}}async function H(){try{const D=await ea.get("/api/departments?action=subjects");D.success?d(I,D.data.map(L=>({id:L.id,name:L.name,code:L.code,gradeLevel:`Grade ${L.grade_level}`}))):Fe.error("Failed to load subjects")}catch(D){console.error("Error fetching subjects:",D),Fe.error("Failed to load subjects")}finally{}}async function U(){try{const D=await ea.get("/api/departments?action=teachers");D.success?d(j,D.data.map(L=>({id:L.id,name:L.full_name||`${L.first_name} ${L.last_name}`,accountNumber:L.account_number}))):Fe.error("Failed to load teachers")}catch(D){console.error("Error fetching teachers:",D),Fe.error("Failed to load teachers")}finally{}}Ua(async()=>{await Promise.all([W(),H(),U()]),X()});function X(D=e(g),L=y,z=e(x)){let ve=[...D];L==="with_subjects"?ve=ve.filter(se=>se.subjects.length>0):L==="with_teachers"?ve=ve.filter(se=>se.teachers.length>0):L==="empty"&&(ve=ve.filter(se=>se.subjects.length===0&&se.teachers.length===0)),z.trim()!==""&&(ve=ve.filter(se=>se.name.toLowerCase().includes(z.toLowerCase())||se.code.toLowerCase().includes(z.toLowerCase()))),d(b,ve)}async function B(){if(!e(m).trim()||!e(h).trim()){Fe.error("Please fill in all required fields");return}if(e(g).some(D=>D.code.toLowerCase()===e(h).toLowerCase())){Fe.error("Department code already exists");return}d(c,!0);try{const D=await ea.post("/api/departments",{name:e(m).trim(),code:e(h).trim().toUpperCase()});D.success?(await W(),d(m,""),d(h,""),Fe.success("Department created successfully")):Fe.error(D.error||"Failed to create department")}catch(D){console.error("Error creating department:",D);const L=D.message||"Failed to create department. Please try again.";Fe.error(L)}finally{d(c,!1)}}async function oe(D){if(D.preventDefault(),!e(F)){d(F,!0);try{if(!e(C).trim()||!e(E).trim()){Fe.error("Department name and code are required");return}if(e(E).trim().length>20){Fe.error("Department code cannot exceed 20 characters");return}if(e(g).find(he=>he.code.toLowerCase()===e(E).trim().toLowerCase()&&he.id!==e(A))){Fe.error("Department code already exists");return}const z=e(g).find(he=>he.id===e(A));if(!z)throw new Error("Department not found");const ve=z.teachers?z.teachers.map(he=>he.id):[],se=z.subjects?z.subjects.map(he=>he.id):[],$e=await ea.put("/api/departments",{id:e(A),name:e(C).trim(),code:e(E).trim().toUpperCase(),teachers:ve,subjects:se});$e.success?(await W(),d(A,null),d(C,""),d(E,""),Fe.success("Department updated successfully")):Fe.error($e.error||"Failed to update department")}catch(L){console.error("Error updating department:",L);const z=L.message||"Failed to update department. Please try again.";Fe.error(z)}finally{d(F,!1)}}}function K(D){e(A)===D.id?(d(A,null),d(C,""),d(E,"")):(e(S)===D.id&&(d(S,null),d(u,[]),d(f,[]),d(M,""),d(Z,"")),d(A,D.id),d(C,D.name),d(E,D.code))}function de(D){ns.confirm("Remove Department",`<p>Are you sure you want to remove the department <strong>"${D.name}"</strong>?</p>
			 <p class="warning-text">This action will also remove all subject and teacher assignments.</p>`,async()=>{try{const L=await ea.delete("/api/departments",{id:D.id,name:D.name});L.success?(await W(),Fe.success("Department removed successfully")):Fe.error(L.error||"Failed to remove department")}catch(L){console.error("Error removing department:",L),Fe.error("Failed to remove department. Please try again.")}},()=>{},{size:"small"})}function ae(D){e(S)===D.id?(d(S,null),d(u,[]),d(f,[]),d(M,""),d(Z,"")):(e(A)===D.id&&(d(A,null),d(C,""),d(E,"")),d(S,D.id),d(u,D.subjects?D.subjects.map(L=>L.id):[]),d(f,D.teachers?D.teachers.map(L=>L.id):[]),d(M,""),d(Z,""))}function te(D){e(u).findIndex(z=>z===D.id)>-1?d(u,e(u).filter(z=>z!==D.id)):d(u,[...e(u),D.id])}function Ce(D){e(f).findIndex(z=>z===D.id)>-1?d(f,e(f).filter(z=>z!==D.id)):d(f,[...e(f),D.id])}function Ae(){if(e(o).every(L=>e(u).some(z=>z===L.id)))d(u,e(u).filter(L=>!e(o).some(z=>z.id===L)));else{const L=e(o).filter(z=>!e(u).some(ve=>ve===z.id)).map(z=>z.id);d(u,[...e(u),...L])}}function Re(){if(e(l).every(L=>e(f).some(z=>z===L.id)))d(f,e(f).filter(L=>!e(l).some(z=>z.id===L)));else{const L=e(l).filter(z=>!e(f).some(ve=>ve===z.id)).map(z=>z.id);d(f,[...e(f),...L])}}async function Me(){d(q,!0);try{const D=e(g).find(ve=>ve.id===e(S));if(!D)throw new Error("Department not found");const L={id:e(S),name:D.name,code:D.code,teachers:e(f),subjects:e(u)},z=await ea.put("/api/departments",L);if(!z.success)throw new Error(z.error||"Failed to update assignments");d(g,e(g).map(ve=>{if(ve.id===e(S)){const se=e(I).filter(he=>e(u).includes(he.id)),$e=e(j).filter(he=>e(f).includes(he.id));return{...ve,subjects:se,teachers:$e}}return ve})),Fe.success("Department assignments updated successfully"),d(S,null),d(u,[]),d(f,[])}catch(D){console.error("Error assigning department:",D),Fe.error("Failed to update assignments. Please try again.")}finally{d(q,!1)}}function Ge(D){return D.subjects||[]}function be(D){return D.teachers||[]}function ke(D){}function Ve(D){if(!D)return"";const L=D.split("-");return L.length===3?`${L[1]}-${L[2]}-${L[0]}`:D}function it(){d(x,"")}Ft(()=>(e(g),e(x)),()=>{e(g)&&X(e(g),y,e(x))}),Ft(()=>(e(I),e(M)),()=>{d(a,e(I).filter(D=>D.name.toLowerCase().includes(e(M).toLowerCase())||D.code.toLowerCase().includes(e(M).toLowerCase())))}),Ft(()=>(e(j),e(Z)),()=>{d(r,e(j).filter(D=>D.name.toLowerCase().includes(e(Z).toLowerCase())||D.accountNumber.toLowerCase().includes(e(Z).toLowerCase())))}),Ft(()=>(e(a),e(u)),()=>{d(o,e(a).sort((D,L)=>{const z=e(u).some(se=>se===D.id),ve=e(u).some(se=>se===L.id);return z&&!ve?-1:!z&&ve?1:D.name.localeCompare(L.name)}))}),Ft(()=>(e(r),e(f)),()=>{d(l,e(r).sort((D,L)=>{const z=e(f).some(se=>se===D.id),ve=e(f).some(se=>se===L.id);return z&&!ve?-1:!z&&ve?1:D.name.localeCompare(L.name)}))}),Is(),Ps();var Be=jD();De("click",tr,ke);var He=v(n(Be),2),Ne=v(n(He),4),Je=n(Ne),lt=n(Je),Pe=v(n(lt),2);ia(Pe),i(lt);var we=v(lt,2),tt=v(n(we),2);ia(tt),i(we),i(Je);var ct=v(Je,2),xe=n(ct),Se=n(xe);{var We=D=>{var L=_a("Creating...");p(D,L)},Ze=D=>{var L=SD();zt(),p(D,L)};$(Se,D=>{e(c)?D(We):D(Ze,!1)})}i(xe),i(ct),i(Ne),i(He);var ee=v(He,2),ue=n(ee),fe=n(ue),T=v(n(fe),2),P=n(T),le=v(n(P),2);ia(le);var R=v(le,2);{var G=D=>{var L=kD();De("click",L,it),p(D,L)};$(R,D=>{e(x)&&D(G)})}i(P),i(T),i(fe),i(ue);var ie=v(ue,2),_e=n(ie);{var Y=D=>{var L=DD();p(D,L)},N=D=>{var L=mt(),z=Ue(L);{var ve=$e=>{var he=TD(),qe=v(n(he),2);{var et=Qe=>{var st=AD();zt(2),p(Qe,st)},Le=Qe=>{var st=CD();zt(2),p(Qe,st)};$(qe,Qe=>{e(g),k(()=>e(g).length===0)?Qe(et):Qe(Le,!1)})}i(he),p($e,he)},se=$e=>{var he=mt(),qe=Ue(he);Tt(qe,1,()=>e(b),et=>et.id,(et,Le)=>{var Qe=RD();let st;var ht=n(Qe),_t=n(ht),xt=n(_t),wt=n(xt,!0);i(xt),i(_t);var St=v(_t,2),$t=n(St),Nt=n($t),Ut=n(Nt),kt=n(Ut,!0);i(Ut),i(Nt),i($t);var jt=v($t,2),Wt=n(jt),Kt=n(Wt),aa=n(Kt,!0);i(Kt),i(Wt),i(jt);var Yt=v(jt,2);i(St),i(ht);var pe=v(ht,2),Ke=n(pe),yt=v(n(Ke),2),Te=n(yt,!0);i(yt),i(Ke);var ze=v(Ke,2),dt=v(n(ze),2),rt=n(dt);i(dt),i(ze);var vt=v(ze,2),Rt=v(n(vt),2),Zt=n(Rt);i(Rt),i(vt);var ma=v(vt,2),ft=v(n(ma),2),ut=n(ft);i(ft),i(ma),i(pe);var me=v(pe,2);{var re=Ie=>{var ot=ED(),Xe=n(ot),Mt=v(n(Xe),2),na=n(Mt),gt=n(na),Oe=v(n(gt),2);ia(Oe),i(gt);var bt=v(gt,2),Et=v(n(bt),2);ia(Et),i(bt),i(na);var qt=v(na,2),Jt=n(qt),va=n(Jt);i(Jt);var la=v(Jt,2),ya=n(la);{var wa=Aa=>{var ja=_a("Updating...");p(Aa,ja)},Ea=Aa=>{var ja=_a("Update Department");p(Aa,ja)};$(ya,Aa=>{e(F)?Aa(wa):Aa(Ea,!1)})}i(la),i(qt),i(Mt),i(Xe),i(ot),O(()=>{Vt(Jt,"href",`#department-card-${e(Le),k(()=>e(Le).id)??""}`),la.disabled=e(F)||!e(C)||!e(E)}),ca(Oe,()=>e(C),Aa=>d(C,Aa)),ca(Et,()=>e(E),Aa=>d(E,Aa)),De("click",va,()=>K(e(Le))),De("submit",Mt,sr(oe)),p(Ie,ot)};$(me,Ie=>{e(A),e(Le),k(()=>e(A)===e(Le).id)&&Ie(re)})}var J=v(me,2);{var je=Ie=>{var ot=ID(),Xe=n(ot),Mt=v(n(Xe),2),na=n(Mt),gt=n(na),Oe=n(gt),bt=n(Oe);i(Oe);var Et=v(Oe,2),qt=n(Et);ia(qt);var Jt=v(qt,2);{var va=ta=>{const Xt=$r(()=>(e(o),e(u),k(()=>e(o).every(Sa=>e(u).some(Da=>Da===Sa.id)))));var ba=FD(),Ca=n(ba),Na=n(Ca,!0);i(Ca),i(ba),O(()=>{Vt(ba,"title",`${e(Xt)?"Deselect All":"Select All"} (${e(o),k(()=>e(o).length)??""})`),w(Na,e(Xt)?"deselect":"select_all")}),De("click",ba,Ae),p(ta,ba)};$(Jt,ta=>{e(o),k(()=>e(o).length>0)&&ta(va)})}i(Et);var la=v(Et,2),ya=n(la);Tt(ya,1,()=>e(o),ta=>ta.id,(ta,Xt)=>{var ba=$D();let Ca;var Na=n(ba),Sa=v(n(Na),2),Da=n(Sa,!0);i(Sa);var La=v(Sa,2),ce=n(La);i(La),i(Na);var ye=v(Na,2),pt=n(ye),It=n(pt,!0);i(pt),i(ye),i(ba),O((Pt,Gt)=>{Ca=ge(ba,1,"dept-mgmt-subject-item",null,Ca,Pt),w(Da,(e(Xt),k(()=>e(Xt).name))),w(ce,`${e(Xt),k(()=>e(Xt).code)??""}  ${e(Xt),k(()=>e(Xt).gradeLevel)??""}`),w(It,Gt)},[()=>({selected:e(u).some(Pt=>Pt===e(Xt).id)}),()=>(e(u),e(Xt),k(()=>e(u).some(Pt=>Pt===e(Xt).id)?"check_box":"check_box_outline_blank"))]),De("click",ba,()=>te(e(Xt))),p(ta,ba)});var wa=v(ya,2);{var Ea=ta=>{var Xt=ND();p(ta,Xt)};$(wa,ta=>{e(o),k(()=>e(o).length===0)&&ta(Ea)})}i(la),zt(2),i(gt);var Aa=v(gt,2),ja=n(Aa),Ra=n(ja);i(ja);var $a=v(ja,2),ha=n($a);ia(ha);var fa=v(ha,2);{var ne=ta=>{const Xt=$r(()=>(e(l),e(f),k(()=>e(l).every(Sa=>e(f).some(Da=>Da===Sa.id)))));var ba=PD(),Ca=n(ba),Na=n(Ca,!0);i(Ca),i(ba),O(()=>{Vt(ba,"title",`${e(Xt)?"Deselect All":"Select All"} (${e(l),k(()=>e(l).length)??""})`),w(Na,e(Xt)?"deselect":"select_all")}),De("click",ba,Re),p(ta,ba)};$(fa,ta=>{e(l),k(()=>e(l).length>0)&&ta(ne)})}i($a);var Ee=v($a,2),nt=n(Ee);Tt(nt,1,()=>e(l),ta=>ta.id,(ta,Xt)=>{var ba=LD();let Ca;var Na=n(ba),Sa=v(n(Na),2),Da=n(Sa,!0);i(Sa);var La=v(Sa,2),ce=n(La,!0);i(La),i(Na);var ye=v(Na,2),pt=n(ye),It=n(pt,!0);i(pt),i(ye),i(ba),O((Pt,Gt)=>{Ca=ge(ba,1,"dept-mgmt-teacher-item",null,Ca,Pt),w(Da,(e(Xt),k(()=>e(Xt).name))),w(ce,(e(Xt),k(()=>e(Xt).accountNumber))),w(It,Gt)},[()=>({selected:e(f).some(Pt=>Pt===e(Xt).id)}),()=>(e(f),e(Xt),k(()=>e(f).some(Pt=>Pt===e(Xt).id)?"check_box":"check_box_outline_blank"))]),De("click",ba,()=>Ce(e(Xt))),p(ta,ba)});var Ct=v(nt,2);{var Qt=ta=>{var Xt=MD();p(ta,Xt)};$(Ct,ta=>{e(l),k(()=>e(l).length===0)&&ta(Qt)})}i(Ee),zt(2),i(Aa),i(na);var Ot=v(na,2),At=n(Ot),pa=v(At,2),oa=n(pa);{var ga=ta=>{var Xt=_a("Assigning...");p(ta,Xt)},xa=ta=>{var Xt=_a("Update");p(ta,Xt)};$(oa,ta=>{e(q)?ta(ga):ta(xa,!1)})}i(pa),i(Ot),i(Mt),i(Xe),i(ot),O(()=>{w(bt,`Select Subjects (${e(u),k(()=>e(u).length)??""} selected)`),w(Ra,`Select Teachers (${e(f),k(()=>e(f).length)??""} selected)`),pa.disabled=e(q)}),ca(qt,()=>e(M),ta=>d(M,ta)),ca(ha,()=>e(Z),ta=>d(Z,ta)),De("click",At,()=>ae(e(Le))),De("submit",Mt,sr(Me)),p(Ie,ot)};$(J,Ie=>{e(S),e(Le),k(()=>e(S)===e(Le).id)&&Ie(je)})}i(Qe),O((Ie,ot,Xe,Mt)=>{st=ge(Qe,1,"dept-mgmt-department-card",null,st,Ie),Vt(Qe,"id",`department-card-${e(Le),k(()=>e(Le).id)??""}`),w(wt,(e(Le),k(()=>e(Le).name))),Vt($t,"href",`#department-card-${e(Le),k(()=>e(Le).id)??""}`),Vt(Nt,"title",(e(S),e(Le),k(()=>e(S)===e(Le).id?"Cancel Assign":"Assign"))),w(kt,(e(S),e(Le),k(()=>e(S)===e(Le).id?"close":"add_circle"))),Vt(jt,"href",`#department-card-${e(Le),k(()=>e(Le).id)??""}`),Vt(Wt,"title",(e(A),e(Le),k(()=>e(A)===e(Le).id?"Cancel Edit":"Edit Department"))),w(aa,(e(A),e(Le),k(()=>e(A)===e(Le).id?"close":"edit"))),w(Te,(e(Le),k(()=>e(Le).code))),w(rt,`${ot??""} Subjects`),w(Zt,`${Xe??""} Teachers`),w(ut,`Created: ${Mt??""}`)},[()=>({editing:e(A)===e(Le).id,assigning:e(S)===e(Le).id}),()=>(e(Le),k(()=>Ge(e(Le)).length)),()=>(e(Le),k(()=>be(e(Le)).length)),()=>(e(Le),k(()=>Ve(e(Le).createdAt)))]),De("click",Nt,()=>ae(e(Le))),De("click",Wt,()=>K(e(Le))),De("click",Yt,()=>de(e(Le))),p(et,Qe)}),p($e,he)};$(z,$e=>{e(b),k(()=>e(b).length===0)?$e(ve):$e(se,!1)},!0)}p(D,L)};$(_e,D=>{e(Q)?D(Y):D(N,!1)})}i(ie),i(ee),i(Be),O(()=>{Pe.disabled=e(c),tt.disabled=e(c),xe.disabled=e(c)||!e(m)||!e(h)}),ca(Pe,()=>e(m),D=>d(m,D)),ca(tt,()=>e(h),D=>d(h,D)),De("click",xe,B),ca(le,()=>e(x),D=>d(x,D)),p(s,Be),Ga()}var qD=_('<div class="chart-loading svelte-1vg55bj"><div class="system-loader svelte-1vg55bj"></div> <p class="svelte-1vg55bj">Loading chart data...</p></div>'),GD=_('<div class="chart-error svelte-1vg55bj"><span class="material-symbols-outlined svelte-1vg55bj">error</span> <p class="svelte-1vg55bj"> </p> <button class="retry-button svelte-1vg55bj"><span class="material-symbols-outlined svelte-1vg55bj">refresh</span> Retry</button></div>'),VD=_('<canvas class="svelte-1vg55bj"></canvas>'),BD=_('<div class="chart-container svelte-1vg55bj"><!></div>');function zD(s,t){qa(t,!1),dr.register(Pn,Mn,In,Rn,Yi,Hi,Ui);let a=V(),r,o=V(!0),l=V(null),c=null;const u={on_hold:"On Hold",verifying:"Verifying",processing:"Processing",for_pickup:"For Pickup",released:"Released"},f=["rgba(253, 216, 53, 0.6)","rgba(92, 107, 192, 0.6)","rgba(255, 152, 0, 0.6)","rgba(0, 188, 212, 0.6)","rgba(76, 175, 80, 0.6)"],m=["rgb(253, 216, 53)","rgb(92, 107, 192)","rgb(255, 152, 0)","rgb(0, 188, 212)","rgb(76, 175, 80)"];async function h(){try{d(o,!0),d(l,null);const E=await ea.get("/api/document-requests?action=stats");if(E.success)c=E.data,d(o,!1),setTimeout(()=>{e(a)&&g(E.data)},0);else throw new Error(E.error||"Failed to fetch document requests data")}catch(E){console.error("Error fetching document requests data:",E),d(l,E.message),d(o,!1)}}function g(E){if(!e(a)){console.warn("Canvas not yet available");return}r&&r.destroy();const F=Object.keys(u).map(q=>E[q]||0),S=e(a).getContext("2d");r=new dr(S,{type:"bar",data:{labels:Object.values(u),datasets:[{label:"Number of Requests",data:F,backgroundColor:f,borderColor:m,borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,suggestedMax:Math.max(...F)+2,ticks:{stepSize:1,callback(q){return Math.floor(q)},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim()},title:{display:!0,text:"Number of Requests",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:12,weight:"bold"}}},x:{ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,text:"Document Requests by Status",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(q){return`Requests: ${q.parsed.y||0}`}}}}}})}function b(){r&&c&&g(c)}Ua(()=>{h();const E=setInterval(()=>{h()},6e4),F=new MutationObserver(S=>{S.forEach(q=>{q.type==="attributes"&&q.attributeName==="data-theme"&&b()})});return F.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{clearInterval(E),F.disconnect()}}),ai(()=>{r&&r.destroy()}),Ps();var y=BD(),x=n(y);{var A=E=>{var F=qD();p(E,F)},C=E=>{var F=mt(),S=Ue(F);{var q=j=>{var M=GD(),Z=v(n(M),2),Q=n(Z,!0);i(Z);var W=v(Z,2);i(M),O(()=>w(Q,e(l))),De("click",W,h),p(j,M)},I=j=>{var M=VD();Us(M,Z=>d(a,Z),()=>e(a)),p(j,M)};$(S,j=>{e(l)?j(q):j(I,!1)},!0)}p(E,F)};$(x,E=>{e(o)?E(A):E(C,!1)})}i(y),p(s,y),Ga()}function WD(s,t,a,r){d(t,!e(t)),d(a,!1),d(r,!1)}function HD(s,t,a,r){d(t,!e(t)),d(a,!1),d(r,!1)}function UD(s,t,a,r){d(t,!e(t)),d(a,!1),d(r,!1)}var YD=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),QD=_('<span class="admindocreq-placeholder">All Statuses</span>'),KD=(s,t)=>t(null),JD=(s,t,a)=>t(e(a)),XD=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),ZD=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),e3=_('<span class="admindocreq-placeholder">All Document Types</span>'),t3=(s,t)=>t(null),a3=(s,t,a)=>t(e(a)),s3=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),r3=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),i3=_('<span class="admindocreq-placeholder">All Grades</span>'),n3=(s,t)=>t(null),o3=(s,t,a)=>t(e(a)),l3=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),c3=_('<div style="padding: 20px; background: #fee; border-radius: 8px; color: #c33; margin: 20px 0;"><strong>Error:</strong> </div>'),d3=_('<div class="dept-mgmt-loading"><span class="system-loader"></span> <p>Loading departments...</p></div>'),u3=_('<div style="padding: 40px; text-align: center; color: #999;"><span class="material-symbols-outlined" style="font-size: 48px;">description</span> <p>No document requests found</p></div>'),v3=(s,t,a)=>t(e(a)),f3=(s,t,a)=>{(s.key==="Enter"||s.key===" ")&&t(e(a))},p3=_('<span class="material-symbols-outlined">pause_circle</span> <span>On Hold</span>',1),m3=_('<span class="material-symbols-outlined">fact_check</span> <span>Verifying</span>',1),h3=_('<span class="material-symbols-outlined">assignment_late</span> <span>For Compliance</span>',1),g3=_('<span class="material-symbols-outlined">sync</span> <span>For Processing</span>',1),_3=_('<span class="material-symbols-outlined">hand_package</span> <span>For Pick up</span>',1),b3=_('<span class="material-symbols-outlined">check_circle</span> <span>Released</span>',1),y3=_('<span class="material-symbols-outlined">warning</span> <span>Non-Compliant</span>',1),w3=_('<span class="material-symbols-outlined">block</span> <span>Cancelled</span>',1),x3=_('<span class="material-symbols-outlined">cancel</span> <span>Rejected</span>',1),S3=_('<span class="chat-badge"> </span>'),k3=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">event_busy</span> <span> </span></div>'),D3=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">payments</span> <span> </span></div>'),A3=_('<div class="docreq-detail-item"><span class="material-symbols-outlined">event</span> <span> </span></div>'),C3=_('<div role="button" tabindex="0"><div class="docreq-request-header"><div class="docreq-request-info"><div class="docreq-student-info"><h3 class="docreq-student-name"> </h3></div></div> <div class="docreq-action-buttons"><div><!></div> <button class="chat-indicator-btn"><span class="material-symbols-outlined">chat_bubble</span> <!></button></div></div> <div class="docreq-request-details"><div class="docreq-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">description</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!> <!> <!></div></div>'),T3=_('<div class="docreq-requests-grid"></div>'),E3=_('<div class="admin-document-requests-container"><div class="admin-docreq-header"><div class="admin-header-content"><h1 class="admin-page-title">Document Requests</h1> <p class="admin-page-subtitle">Manage and process student document requests</p></div></div> <div class="docreq-status-cards-section"><div class="docreq-status-cards-grid"><div class="docreq-status-card docreq-status-onhold"><div class="docreq-status-icon"><span class="material-symbols-outlined">pause_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">On Hold</p></div></div> <div class="docreq-status-card docreq-status-verifying"><div class="docreq-status-icon"><span class="material-symbols-outlined">fact_check</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Verifying</p></div></div> <div class="docreq-status-card docreq-status-processing"><div class="docreq-status-icon"><span class="material-symbols-outlined">sync</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Processing</p></div></div> <div class="docreq-status-card docreq-status-pickup"><div class="docreq-status-icon"><span class="material-symbols-outlined">hand_package</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">For Pickup</p></div></div> <div class="docreq-status-card docreq-status-released"><div class="docreq-status-icon"><span class="material-symbols-outlined">check_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Released</p></div></div> <div class="docreq-status-card docreq-status-cancelled"><div class="docreq-status-icon"><span class="material-symbols-outlined">block</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Cancelled</p></div></div></div></div> <div class="docreq-chart-section"><!></div> <div class="admin-docreq-filters-section"><div class="admin-section-header"><h2 class="admin-section-title">Filter Requests</h2> <p class="admin-section-subtitle">Search and filter document requests</p></div> <div class="admindocreq-filters-container"><div class="admindocreq-search-container"><input type="text" placeholder="Search by student name, ID, or document type..." class="admindocreq-search-input"/> <span class="material-symbols-outlined admindocreq-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Statuses</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Document Types</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Grades</span></div></button> <!></div></div></div></div> <div class="admin-docreq-requests-section"><div class="docreq-section-header"><div class="docreq-section-header-content"><div class="docreq-section-title-group"><h2 class="docreq-section-title">Document Requests</h2> <p class="docreq-section-subtitle">Manage and review all student document requests</p></div></div></div> <!> <!></div></div>');function F3(s,t){qa(t,!1);const a=V(),r=V(),o=V();let l=V([]),c=V(!0),u=!1,f=V(null),m=V(""),h=V(""),g=V(""),b=V(""),y=V(!1),x=V(!1),A=V(!1);const C=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],E=[{id:"tor",name:"Transcript of Records",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"},{id:"good-moral",name:"Good Moral",description:"Certificate of good moral character"},{id:"grade-slip",name:"Grade Slip",description:"Grade slip for specific period"}],F=[{id:"on_hold",name:"On Hold",description:"Awaiting review"},{id:"verifying",name:"Verifying",description:"Under verification"},{id:"for_compliance",name:"For Compliance",description:"Awaiting student compliance"},{id:"processing",name:"For Processing",description:"Currently being processed"},{id:"for_pickup",name:"For Pick Up",description:"Ready for pickup"},{id:"released",name:"Released",description:"Successfully released"},{id:"non_compliance",name:"Non-Compliant",description:"Student did not comply within deadline"},{id:"rejected",name:"Rejected",description:"Request denied"},{id:"cancelled",name:"Cancelled",description:"Cancelled by student"}],S=[{id:"on_hold",name:"On Hold"},{id:"verifying",name:"Verifying"},{id:"for_compliance",name:"For Compliance"},{id:"processing",name:"For Processing"},{id:"for_pickup",name:"For Pick Up"},{id:"released",name:"Released"}];function q(re){re?d(h,re.id):d(h,""),d(y,!1)}function I(re){re?d(g,re.id):d(g,""),d(x,!1)}function j(re){re?d(b,re.value):d(b,""),d(A,!1)}function M(re){re.target.closest(".admindocreq-status-filter")||d(y,!1),re.target.closest(".admindocreq-doctype-filter")||d(x,!1),re.target.closest(".admindocreq-grade-filter")||d(A,!1)}async function Z(re){try{Qn.open(re,F,S,H,U);const je=await(await is(`/api/document-requests?action=single&requestId=${re.requestId}`)).json();if(je.success){if(je.data.status==="on_hold"){const Ie=new Date;Ie.setDate(Ie.getDate()+5);const ot=Ie.getFullYear(),Xe=String(Ie.getMonth()+1).padStart(2,"0"),Mt=String(Ie.getDate()).padStart(2,"0"),na=`${ot}-${Xe}-${Mt}`;await H(re.requestId,{status:"verifying",tentativeDate:na,paymentAmount:je.data.paymentAmount,paymentStatus:je.data.paymentStatus});const Oe=await(await is(`/api/document-requests?action=single&requestId=${re.requestId}`)).json();Oe.success&&Qn.open(Oe.data,F,S,H,U)}else Qn.open(je.data,F,S,H,U);await Q(re.requestId)}else console.error("Failed to fetch request details:",je.error)}catch(J){console.error("Error fetching request details:",J)}}async function Q(re){try{const je=await(await is("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"markAsRead",requestId:re})})).json();je.success?d(l,e(l).map(Ie=>Ie.requestId===re?{...Ie,lastReadAt:new Date().toISOString()}:Ie)):console.error("Failed to mark messages as read:",je.error)}catch(J){console.error("Error marking messages as read:",J)}}async function W(re=!1){try{re?u=!0:d(c,!0),d(f,null);const J=new URLSearchParams({action:"all"});if(e(m)&&J.append("search",e(m)),e(h)&&J.append("status",e(h)),e(g)){const ot=E.find(Xe=>Xe.id===e(g));ot&&J.append("documentType",ot.name)}e(b)&&J.append("gradeLevel",e(b));const Ie=await(await is(`/api/document-requests?${J.toString()}`)).json();Ie.success?d(l,Ie.data):d(f,Ie.error||"Failed to fetch document requests")}catch(J){console.error("Error fetching document requests:",J),d(f,"Failed to load document requests")}finally{d(c,!1),u=!1}}async function H(re,J){try{const Ie=await(await is("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",requestId:re,...J})})).json();return Ie.success?(await W(),Fe.success("Document request updated successfully!"),!0):(d(f,Ie.error||"Failed to update request"),Fe.error(Ie.error||"Failed to update document request"),!1)}catch(je){return console.error("Error updating request:",je),d(f,"Failed to update request"),Fe.error("An error occurred while updating the request"),!1}}async function U(re){try{const je=await(await is("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject",requestId:re})})).json();return je.success?(await W(),Fe.success("Document request rejected successfully"),!0):(d(f,je.error||"Failed to reject request"),Fe.error(je.error||"Failed to reject document request"),!1)}catch(J){return console.error("Error rejecting request:",J),d(f,"Failed to reject request"),Fe.error("An error occurred while rejecting the request"),!1}}function X(re){if(!re)return"N/A";const[J,je,Ie]=re.split("-");return!J||!je||!Ie?re:`${je}/${Ie}/${J}`}function B(re){if(!re.messages||re.messages.length===0)return 0;const J=re.messages.filter(Ie=>Ie.authorRole!=="admin");if(J.length===0)return 0;if(!re.lastReadAt)return J.length;const je=new Date(re.lastReadAt).getTime();return J.filter(Ie=>new Date(Ie.created_at).getTime()>je).length}let oe=V(!1),K;Ua(()=>(W(),d(oe,!0),K=setInterval(()=>{W(!0)},30*1e3),()=>{K&&clearInterval(K)}));let de=V(),ae=V(""),te=V(""),Ce=V(""),Ae=V("");Ft(()=>e(h),()=>{d(a,F.find(re=>re.id===e(h)))}),Ft(()=>e(g),()=>{d(r,E.find(re=>re.id===e(g)))}),Ft(()=>e(b),()=>{d(o,C.find(re=>re.value===e(b)))}),Ft(()=>(e(oe),e(m),e(ae),e(de)),()=>{e(oe)&&e(m)!==e(ae)&&(d(ae,e(m)),clearTimeout(e(de)),d(de,setTimeout(()=>{W()},300)))}),Ft(()=>(e(oe),e(h),e(te),e(g),e(Ce),e(b),e(Ae)),()=>{e(oe)&&(e(h)!==e(te)||e(g)!==e(Ce)||e(b)!==e(Ae))&&(d(te,e(h)),d(Ce,e(g)),d(Ae,e(b)),W())}),Is(),Ps();var Re=E3();De("click",tr,M);var Me=v(n(Re),2),Ge=n(Me),be=n(Ge),ke=v(n(be),2),Ve=n(ke),it=n(Ve,!0);i(Ve),zt(2),i(ke),i(be);var Be=v(be,2),He=v(n(Be),2),Ne=n(He),Je=n(Ne,!0);i(Ne),zt(2),i(He),i(Be);var lt=v(Be,2),Pe=v(n(lt),2),we=n(Pe),tt=n(we,!0);i(we),zt(2),i(Pe),i(lt);var ct=v(lt,2),xe=v(n(ct),2),Se=n(xe),We=n(Se,!0);i(Se),zt(2),i(xe),i(ct);var Ze=v(ct,2),ee=v(n(Ze),2),ue=n(ee),fe=n(ue,!0);i(ue),zt(2),i(ee),i(Ze);var T=v(Ze,2),P=v(n(T),2),le=n(P),R=n(le,!0);i(le),zt(2),i(P),i(T),i(Ge),i(Me);var G=v(Me,2),ie=n(G);zD(ie,{}),i(G);var _e=v(G,2),Y=v(n(_e),2),N=n(Y),D=n(N);ia(D),zt(2),i(N);var L=v(N,2);let z;var ve=n(L);let se;ve.__click=[WD,y,x,A];var $e=n(ve);{var he=re=>{var J=YD(),je=v(n(J),2),Ie=n(je),ot=n(Ie,!0);i(Ie),i(je),i(J),O(()=>w(ot,(e(a),k(()=>e(a).name)))),p(re,J)},qe=re=>{var J=QD();p(re,J)};$($e,re=>{e(a)?re(he):re(qe,!1)})}zt(2),i(ve);var et=v(ve,2),Le=n(et);let Qe;Le.__click=[KD,q];var st=v(Le,2);Tt(st,1,()=>F,re=>re.id,(re,J)=>{var je=XD();let Ie;je.__click=[JD,q,J];var ot=v(n(je),2),Xe=n(ot),Mt=n(Xe,!0);i(Xe);var na=v(Xe,2),gt=n(na,!0);i(na),i(ot),i(je),O(Oe=>{Ie=ge(je,1,"admindocreq-dropdown-option",null,Ie,Oe),w(Mt,(e(J),k(()=>e(J).name))),w(gt,(e(J),k(()=>e(J).description)))},[()=>({selected:e(h)===e(J).id})]),p(re,je)}),i(et),i(L);var ht=v(L,2);let _t;var xt=n(ht);let wt;xt.__click=[HD,x,y,A];var St=n(xt);{var $t=re=>{var J=ZD(),je=v(n(J),2),Ie=n(je),ot=n(Ie,!0);i(Ie),i(je),i(J),O(()=>w(ot,(e(r),k(()=>e(r).name)))),p(re,J)},Nt=re=>{var J=e3();p(re,J)};$(St,re=>{e(r)?re($t):re(Nt,!1)})}zt(2),i(xt);var Ut=v(xt,2),kt=n(Ut);let jt;kt.__click=[t3,I];var Wt=v(kt,2);Tt(Wt,1,()=>E,re=>re.id,(re,J)=>{var je=s3();let Ie;je.__click=[a3,I,J];var ot=v(n(je),2),Xe=n(ot),Mt=n(Xe,!0);i(Xe);var na=v(Xe,2),gt=n(na,!0);i(na),i(ot),i(je),O(Oe=>{Ie=ge(je,1,"admindocreq-dropdown-option",null,Ie,Oe),w(Mt,(e(J),k(()=>e(J).name))),w(gt,(e(J),k(()=>e(J).description)))},[()=>({selected:e(g)===e(J).id})]),p(re,je)}),i(Ut),i(ht);var Kt=v(ht,2);let aa;var Yt=n(Kt);let pe;Yt.__click=[UD,A,y,x];var Ke=n(Yt);{var yt=re=>{var J=r3(),je=v(n(J),2),Ie=n(je),ot=n(Ie,!0);i(Ie),i(je),i(J),O(()=>w(ot,(e(o),k(()=>e(o).label)))),p(re,J)},Te=re=>{var J=i3();p(re,J)};$(Ke,re=>{e(o)?re(yt):re(Te,!1)})}zt(2),i(Yt);var ze=v(Yt,2),dt=n(ze);let rt;dt.__click=[n3,j];var vt=v(dt,2);Tt(vt,1,()=>C,re=>re.value,(re,J)=>{var je=l3();let Ie;je.__click=[o3,j,J];var ot=v(n(je),2),Xe=n(ot),Mt=n(Xe,!0);i(Xe);var na=v(Xe,2),gt=n(na,!0);i(na),i(ot),i(je),O(Oe=>{Ie=ge(je,1,"admindocreq-dropdown-option",null,Ie,Oe),w(Mt,(e(J),k(()=>e(J).label))),w(gt,(e(J),k(()=>e(J).description)))},[()=>({selected:e(b)===e(J).value})]),p(re,je)}),i(ze),i(Kt),i(Y),i(_e);var Rt=v(_e,2),Zt=v(n(Rt),2);{var ma=re=>{var J=c3(),je=v(n(J));i(J),O(()=>w(je,` ${e(f)??""}`)),p(re,J)};$(Zt,re=>{e(f)&&re(ma)})}var ft=v(Zt,2);{var ut=re=>{var J=d3();p(re,J)},me=re=>{var J=mt(),je=Ue(J);{var Ie=Xe=>{var Mt=u3();p(Xe,Mt)},ot=Xe=>{var Mt=T3();Tt(Mt,5,()=>e(l),na=>na.id,(na,gt)=>{var Oe=C3();Oe.__click=[v3,Z,gt],Oe.__keydown=[f3,Z,gt];var bt=n(Oe),Et=n(bt),qt=n(Et),Jt=n(qt),va=n(Jt,!0);i(Jt),i(qt),i(Et);var la=v(Et,2),ya=n(la),wa=n(ya);{var Ea=ye=>{var pt=p3();zt(2),p(ye,pt)},Aa=ye=>{var pt=mt(),It=Ue(pt);{var Pt=da=>{var ka=m3();zt(2),p(da,ka)},Gt=da=>{var ka=mt(),Ht=Ue(ka);{var Ye=Dt=>{var Bt=h3();zt(2),p(Dt,Bt)},sa=Dt=>{var Bt=mt(),ra=Ue(Bt);{var ua=Ta=>{var Ma=g3();zt(2),p(Ta,Ma)},Oa=Ta=>{var Ma=mt(),za=Ue(Ma);{var ts=Va=>{var ss=_3();zt(2),p(Va,ss)},bs=Va=>{var ss=mt(),Fa=Ue(ss);{var Wa=es=>{var Za=b3();zt(2),p(es,Za)},fs=es=>{var Za=mt(),os=Ue(Za);{var ls=rs=>{var ps=y3();zt(2),p(rs,ps)},Ds=rs=>{var ps=mt(),xs=Ue(ps);{var qs=Fs=>{var rr=w3();zt(2),p(Fs,rr)},Ks=Fs=>{var rr=mt(),ir=Ue(rr);{var zr=Dr=>{var Nr=x3();zt(2),p(Dr,Nr)};$(ir,Dr=>{e(gt),k(()=>e(gt).status==="rejected")&&Dr(zr)},!0)}p(Fs,rr)};$(xs,Fs=>{e(gt),k(()=>e(gt).status==="cancelled")?Fs(qs):Fs(Ks,!1)},!0)}p(rs,ps)};$(os,rs=>{e(gt),k(()=>e(gt).status==="non_compliance")?rs(ls):rs(Ds,!1)},!0)}p(es,Za)};$(Fa,es=>{e(gt),k(()=>e(gt).status==="released")?es(Wa):es(fs,!1)},!0)}p(Va,ss)};$(za,Va=>{e(gt),k(()=>e(gt).status==="for_pickup")?Va(ts):Va(bs,!1)},!0)}p(Ta,Ma)};$(ra,Ta=>{e(gt),k(()=>e(gt).status==="processing")?Ta(ua):Ta(Oa,!1)},!0)}p(Dt,Bt)};$(Ht,Dt=>{e(gt),k(()=>e(gt).status==="for_compliance")?Dt(Ye):Dt(sa,!1)},!0)}p(da,ka)};$(It,da=>{e(gt),k(()=>e(gt).status==="verifying")?da(Pt):da(Gt,!1)},!0)}p(ye,pt)};$(wa,ye=>{e(gt),k(()=>e(gt).status==="on_hold")?ye(Ea):ye(Aa,!1)})}i(ya);var ja=v(ya,2),Ra=v(n(ja),2);{var $a=ye=>{var pt=S3(),It=n(pt,!0);i(pt),O(Pt=>w(It,Pt),[()=>(e(gt),k(()=>B(e(gt))))]),p(ye,pt)};$(Ra,ye=>{e(gt),k(()=>B(e(gt))>0)&&ye($a)})}i(ja),i(la),i(bt);var ha=v(bt,2),fa=n(ha),ne=v(n(fa),2),Ee=n(ne,!0);i(ne),i(fa);var nt=v(fa,2),Ct=v(n(nt),2),Qt=n(Ct,!0);i(Ct),i(nt);var Ot=v(nt,2),At=v(n(Ot),2),pa=n(At,!0);i(At),i(Ot);var oa=v(Ot,2),ga=v(n(oa),2),xa=n(ga);i(ga),i(oa);var ta=v(oa,2),Xt=v(n(ta),2),ba=n(Xt);i(Xt),i(ta);var Ca=v(ta,2);{var Na=ye=>{var pt=k3(),It=v(n(pt),2),Pt=n(It);i(It),i(pt),O(()=>w(Pt,`Cancelled: ${e(gt),k(()=>e(gt).cancelledDate)??""}`)),p(ye,pt)};$(Ca,ye=>{e(gt),k(()=>e(gt).status==="cancelled"&&e(gt).cancelledDate)&&ye(Na)})}var Sa=v(Ca,2);{var Da=ye=>{var pt=D3(),It=v(n(pt),2),Pt=n(It,!0);i(It),i(pt),O(()=>w(Pt,(e(gt),k(()=>e(gt).payment)))),p(ye,pt)};$(Sa,ye=>{e(gt),k(()=>e(gt).payment&&e(gt).payment!=="Free"&&!e(gt).payment.toLowerCase().includes("tentative"))&&ye(Da)})}var La=v(Sa,2);{var ce=ye=>{var pt=A3(),It=v(n(pt),2),Pt=n(It);i(It),i(pt),O(Gt=>w(Pt,`${e(gt),k(()=>e(gt).status==="for_compliance"?"Deadline:":"Tentative:")??""} ${Gt??""}`),[()=>(e(gt),k(()=>X(e(gt).tentativeDate)))]),p(ye,pt)};$(La,ye=>{e(gt),k(()=>e(gt).tentativeDate)&&ye(ce)})}i(ha),i(Oe),O(ye=>{ge(Oe,1,`docreq-request-card status-${e(gt),k(()=>e(gt).status)??""}-border`),w(va,(e(gt),k(()=>e(gt).studentName))),ge(ya,1,`docreq-status-badge docreq-status-${e(gt),k(()=>e(gt).status)??""}`),Vt(ja,"title",ye),w(Ee,(e(gt),k(()=>e(gt).studentId))),w(Qt,(e(gt),k(()=>e(gt).gradeLevel))),w(pa,(e(gt),k(()=>e(gt).documentType))),w(xa,`ID: ${e(gt),k(()=>e(gt).requestId)??""}`),w(ba,`Requested: ${e(gt),k(()=>e(gt).submittedDate)??""}`)},[()=>(e(gt),k(()=>B(e(gt))>0?`${B(e(gt))} unread message${B(e(gt))!==1?"s":""}`:"View messages"))]),p(na,Oe)}),i(Mt),p(Xe,Mt)};$(je,Xe=>{e(l),k(()=>e(l).length===0)?Xe(Ie):Xe(ot,!1)},!0)}p(re,J)};$(ft,re=>{e(c)?re(ut):re(me,!1)})}i(Rt),i(Re),O((re,J,je,Ie,ot,Xe,Mt,na,gt,Oe,bt,Et,qt,Jt,va)=>{w(it,re),w(Je,J),w(tt,je),w(We,Ie),w(fe,ot),w(R,Xe),z=ge(L,1,"admindocreq-status-filter admindocreq-custom-dropdown",null,z,Mt),se=ge(ve,1,"admindocreq-dropdown-trigger",null,se,na),Qe=ge(Le,1,"admindocreq-dropdown-option",null,Qe,gt),_t=ge(ht,1,"admindocreq-doctype-filter admindocreq-custom-dropdown",null,_t,Oe),wt=ge(xt,1,"admindocreq-dropdown-trigger",null,wt,bt),jt=ge(kt,1,"admindocreq-dropdown-option",null,jt,Et),aa=ge(Kt,1,"admindocreq-grade-filter admindocreq-custom-dropdown",null,aa,qt),pe=ge(Yt,1,"admindocreq-dropdown-trigger",null,pe,Jt),rt=ge(dt,1,"admindocreq-dropdown-option",null,rt,va)},[()=>(e(l),k(()=>e(l).filter(re=>re.status==="on_hold").length)),()=>(e(l),k(()=>e(l).filter(re=>re.status==="verifying").length)),()=>(e(l),k(()=>e(l).filter(re=>re.status==="processing").length)),()=>(e(l),k(()=>e(l).filter(re=>re.status==="for_pickup").length)),()=>(e(l),k(()=>e(l).filter(re=>re.status==="released").length)),()=>(e(l),k(()=>e(l).filter(re=>re.status==="cancelled").length)),()=>({open:e(y)}),()=>({selected:e(h)}),()=>({selected:e(h)===""}),()=>({open:e(x)}),()=>({selected:e(g)}),()=>({selected:e(g)===""}),()=>({open:e(A)}),()=>({selected:e(b)}),()=>({selected:e(b)===""})]),ca(D,()=>e(m),re=>d(m,re)),p(s,Re),Ga()}Cs(["click","keydown"]);function $3(s,t,a,r,o){ns.confirm("Change Password",`
			<div class="admin-settings-password-form">
				<div class="admin-settings-form-group">
					<label for="current-password">Current Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="new-password">New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{d(a,""),d(r,""),d(o,"")},{size:"medium"})}var N3=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),P3=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),L3=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),M3=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),I3=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),R3=_('<span class="material-symbols-outlined">check</span> Apply Date Changes',1),j3=_('<div class="admin-settings-container"><div class="admin-settings-header"><div class="admin-settings-header-content"><h1 class="admin-settings-page-title">Admin Settings</h1> <p class="admin-settings-page-subtitle">Manage system settings and configurations</p></div></div> <div class="admin-settings-section"><div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Current School Year</h3> <p class="admin-settings-item-description">The active academic year for the system</p></div> <div class="admin-settings-item-value"><span class="admin-settings-current-year"> </span></div></div></div></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">School Year Dates</h3> <p class="admin-settings-item-description">Set the start and end dates for classes</p></div></div> <div class="admin-settings-dates-section"><div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="start-date" class="admin-settings-date-label">Start of Classes</label> <input id="start-date" type="date"/></div> <div class="admin-settings-date-item"><label for="end-date" class="admin-settings-date-label">End of Classes</label> <input id="end-date" type="date"/></div></div> <div class="admin-settings-quarters-section svelte-jysw9o"><h4 class="admin-settings-quarters-title svelte-jysw9o">Quarter Schedules</h4> <div class="admin-settings-quarters-row svelte-jysw9o"><div class="admin-settings-quarter-group quarter-1 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">1st Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q1-start" class="admin-settings-date-label">Start</label> <input id="q1-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q1-end" class="admin-settings-date-label">End</label> <input id="q1-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-2 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">2nd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q2-start" class="admin-settings-date-label">Start</label> <input id="q2-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q2-end" class="admin-settings-date-label">End</label> <input id="q2-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-3 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">3rd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q3-start" class="admin-settings-date-label">Start</label> <input id="q3-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q3-end" class="admin-settings-date-label">End</label> <input id="q3-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-4 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">4th Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q4-start" class="admin-settings-date-label">Start</label> <input id="q4-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q4-end" class="admin-settings-date-label">End</label> <input id="q4-end" type="date"/></div></div> <!></div></div></div> <!></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><!></button></div></div></div></div> <div class="admin-settings-section"><div class="admin-settings-section-header"><h2 class="admin-settings-section-title">Account Security</h2> <p class="admin-settings-section-subtitle">Manage your account password and security settings</p></div> <div class="admin-settings-security-row"><div class="admin-settings-security-card"><div class="admin-settings-security-content-container"><div class="admin-settings-security-icon"><span class="material-symbols-outlined">lock</span></div> <div class="admin-settings-security-content"><div class="admin-settings-security-label">Password</div> <div class="admin-settings-security-value">Change your account password for security</div></div></div> <div class="admin-settings-security-actions"><button class="admin-settings-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>');function O3(s,t){qa(t,!0);let a=at(!1),r=at(!1),o=at("2024-2025"),l=at(""),c=at("");function u(Te,ze){if(!Te||!ze)return"2024-2025";const dt=new Date(Te),rt=new Date(ze),vt=dt.getFullYear(),Rt=rt.getFullYear();return Rt>vt?`${vt}-${Rt}`:`${vt}-${vt}`}let f=at(""),m=at(""),h=at(""),g=at(""),b=at(""),y=at(""),x=at(""),A=at("");async function C(){try{d(a,!0);const Te=await ea.get("/api/admin-settings");if(Te.success){let dt=function(rt){if(!rt)return rt;const[vt,Rt,Zt]=rt.split("-");return`${Zt}-${vt}-${Rt}`};const ze=Te.data;d(l,dt(ze.school_year_start_date)||"",!0),d(c,dt(ze.school_year_end_date)||"",!0),d(o,u(e(l),e(c)),!0),d(f,dt(ze.quarter_1_start_date)||"",!0),d(m,dt(ze.quarter_1_end_date)||"",!0),d(h,dt(ze.quarter_2_start_date)||"",!0),d(g,dt(ze.quarter_2_end_date)||"",!0),d(b,dt(ze.quarter_3_start_date)||"",!0),d(y,dt(ze.quarter_3_end_date)||"",!0),d(x,dt(ze.quarter_4_start_date)||"",!0),d(A,dt(ze.quarter_4_end_date)||"",!0)}}catch(Te){console.error("Error loading admin settings:",Te),vs("Failed to load admin settings")}finally{d(a,!1)}}async function E(){try{let Te=function(rt){if(!rt)return rt;const[vt,Rt,Zt]=rt.split("-");return`${Rt}-${Zt}-${vt}`};d(r,!0);const ze={current_school_year:e(o),school_year_start_date:Te(e(l)),school_year_end_date:Te(e(c)),quarter_1_start_date:Te(e(f)),quarter_1_end_date:Te(e(m)),quarter_2_start_date:Te(e(h)),quarter_2_end_date:Te(e(g)),quarter_3_start_date:Te(e(b)),quarter_3_end_date:Te(e(y)),quarter_4_start_date:Te(e(x)),quarter_4_end_date:Te(e(A))},dt=await ea.put("/api/admin-settings",{settings:ze});if(dt.success)Vr("Admin settings saved successfully");else throw new Error(dt.error||"Failed to save settings")}catch(Te){console.error("Error saving admin settings:",Te),vs("Failed to save admin settings")}finally{d(r,!1)}}let F=at("");Ss(()=>{if(e(l)&&e(c)){const Te=new Date(e(l)),ze=new Date(e(c));Te>=ze?d(F,"Start date must be before end date"):(d(F,""),d(o,u(e(l),e(c)),!0))}else d(F,"")});let S={quarter1:"",quarter2:"",quarter3:"",quarter4:""};Ss(()=>{if(e(f)&&e(m)){const Te=new Date(e(f)),ze=new Date(e(m));Te>=ze?S.quarter1="1st Quarter start date must be before end date":S.quarter1=""}else S.quarter1="";if(e(h)&&e(g)){const Te=new Date(e(h)),ze=new Date(e(g));Te>=ze?S.quarter2="2nd Quarter start date must be before end date":S.quarter2=""}else S.quarter2="";if(e(b)&&e(y)){const Te=new Date(e(b)),ze=new Date(e(y));Te>=ze?S.quarter3="3rd Quarter start date must be before end date":S.quarter3=""}else S.quarter3="";if(e(x)&&e(A)){const Te=new Date(e(x)),ze=new Date(e(A));Te>=ze?S.quarter4="4th Quarter start date must be before end date":S.quarter4=""}else S.quarter4=""});async function q(){if(e(F)){console.error("Cannot apply changes: Date validation error");return}if(Object.values(S).some(ze=>ze!=="")){console.error("Cannot apply changes: Quarter validation errors");return}await E()}let I=at(""),j=at(""),M=at(""),Z=at(!1);function Q(Te){const ze=document.getElementById(Te),rt=ze.nextElementSibling.querySelector(".password-eye-icon");ze.type==="password"?(ze.type="text",rt.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(ze.type="password",rt.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=Q);async function W(){const Te=document.getElementById("current-password"),ze=document.getElementById("new-password"),dt=document.getElementById("confirm-password");if(!Te||!ze||!dt){vs("Password form inputs not found");return}const rt=Te.value,vt=ze.value,Rt=dt.value;if(!rt){vs("Current password is required");return}if(!vt){vs("New password is required");return}if(vt!==Rt){vs("New passwords do not match");return}if(vt.length<8){vs("Password must be at least 8 characters long");return}if(rt===vt){vs("New password must be different from current password");return}try{d(Z,!0);const Zt=await ea.post("/api/change-password",{currentPassword:rt,newPassword:vt});Zt.success?(Te.value="",ze.value="",dt.value="",Vr("Password changed successfully!"),ns.close()):vs(Zt.error||"Failed to change password")}catch(Zt){console.error("Password change error:",Zt),vs(Zt.message||"Failed to change password")}finally{d(Z,!1)}}Ua(()=>{C()});var H=j3(),U=v(n(H),2),X=n(U),B=n(X),oe=n(B),K=v(n(oe),2),de=n(K),ae=n(de,!0);i(de),i(K),i(oe),i(B),i(X);var te=v(X,2),Ce=n(te),Ae=v(n(Ce),2),Re=n(Ae),Me=n(Re),Ge=v(n(Me),2);ia(Ge);let be;i(Me);var ke=v(Me,2),Ve=v(n(ke),2);ia(Ve);let it;i(ke),i(Re);var Be=v(Re,2),He=v(n(Be),2),Ne=n(He),Je=v(n(Ne),2),lt=n(Je),Pe=v(n(lt),2);ia(Pe);let we;i(lt);var tt=v(lt,2),ct=v(n(tt),2);ia(ct);let xe;i(tt),i(Je);var Se=v(Je,2);{var We=Te=>{var ze=N3(),dt=v(n(ze));i(ze),O(()=>w(dt,` ${S.quarter1??""}`)),p(Te,ze)};$(Se,Te=>{S.quarter1&&Te(We)})}i(Ne);var Ze=v(Ne,2),ee=v(n(Ze),2),ue=n(ee),fe=v(n(ue),2);ia(fe);let T;i(ue);var P=v(ue,2),le=v(n(P),2);ia(le);let R;i(P),i(ee);var G=v(ee,2);{var ie=Te=>{var ze=P3(),dt=v(n(ze));i(ze),O(()=>w(dt,` ${S.quarter2??""}`)),p(Te,ze)};$(G,Te=>{S.quarter2&&Te(ie)})}i(Ze);var _e=v(Ze,2),Y=v(n(_e),2),N=n(Y),D=v(n(N),2);ia(D);let L;i(N);var z=v(N,2),ve=v(n(z),2);ia(ve);let se;i(z),i(Y);var $e=v(Y,2);{var he=Te=>{var ze=L3(),dt=v(n(ze));i(ze),O(()=>w(dt,` ${S.quarter3??""}`)),p(Te,ze)};$($e,Te=>{S.quarter3&&Te(he)})}i(_e);var qe=v(_e,2),et=v(n(qe),2),Le=n(et),Qe=v(n(Le),2);ia(Qe);let st;i(Le);var ht=v(Le,2),_t=v(n(ht),2);ia(_t);let xt;i(ht),i(et);var wt=v(et,2);{var St=Te=>{var ze=M3(),dt=v(n(ze));i(ze),O(()=>w(dt,` ${S.quarter4??""}`)),p(Te,ze)};$(wt,Te=>{S.quarter4&&Te(St)})}i(qe),i(He),i(Be);var $t=v(Be,2);{var Nt=Te=>{var ze=I3(),dt=v(n(ze));i(ze),O(()=>w(dt,` ${e(F)??""}`)),p(Te,ze)};$($t,Te=>{e(F)&&Te(Nt)})}i(Ae);var Ut=v(Ae,2),kt=n(Ut);kt.__click=q;var jt=n(kt);{var Wt=Te=>{var ze=_a("Saving...");p(Te,ze)},Kt=Te=>{var ze=R3();zt(),p(Te,ze)};$(jt,Te=>{e(r)?Te(Wt):Te(Kt,!1)})}i(kt),i(Ut),i(Ce),i(te),i(U);var aa=v(U,2),Yt=v(n(aa),2),pe=n(Yt),Ke=v(n(pe),2),yt=n(Ke);yt.__click=[$3,W,I,j,M],i(Ke),i(pe),i(Yt),i(aa),i(H),O((Te,ze,dt,rt,vt,Rt,Zt,ma,ft,ut)=>{w(ae,e(o)),be=ge(Ge,1,"admin-settings-date-input",null,be,Te),it=ge(Ve,1,"admin-settings-date-input",null,it,ze),we=ge(Pe,1,"admin-settings-date-input quarter-1-input",null,we,dt),xe=ge(ct,1,"admin-settings-date-input quarter-1-input",null,xe,rt),T=ge(fe,1,"admin-settings-date-input quarter-2-input",null,T,vt),R=ge(le,1,"admin-settings-date-input quarter-2-input",null,R,Rt),L=ge(D,1,"admin-settings-date-input quarter-3-input",null,L,Zt),se=ge(ve,1,"admin-settings-date-input quarter-3-input",null,se,ma),st=ge(Qe,1,"admin-settings-date-input quarter-4-input",null,st,ft),xt=ge(_t,1,"admin-settings-date-input quarter-4-input",null,xt,ut),kt.disabled=e(r)||e(a)||!!e(F)||S.quarter1||S.quarter2||S.quarter3||S.quarter4||!e(l)||!e(c)},[()=>({error:e(F)}),()=>({error:e(F)}),()=>({error:S.quarter1}),()=>({error:S.quarter1}),()=>({error:S.quarter2}),()=>({error:S.quarter2}),()=>({error:S.quarter3}),()=>({error:S.quarter3}),()=>({error:S.quarter4}),()=>({error:S.quarter4})]),ca(Ge,()=>e(l),Te=>d(l,Te)),ca(Ve,()=>e(c),Te=>d(c,Te)),ca(Pe,()=>e(f),Te=>d(f,Te)),ca(ct,()=>e(m),Te=>d(m,Te)),ca(fe,()=>e(h),Te=>d(h,Te)),ca(le,()=>e(g),Te=>d(g,Te)),ca(D,()=>e(b),Te=>d(b,Te)),ca(ve,()=>e(y),Te=>d(y,Te)),ca(Qe,()=>e(x),Te=>d(x,Te)),ca(_t,()=>e(A),Te=>d(A,Te)),p(s,H),Ga()}Cs(["click"]);var q3=_('<meta name="description" content="High School Student Information System"/>'),G3=_('<div><!> <main class="content-area"><!></main> <!></div>'),V3=_('<div><!> <main class="content-area"><!></main> <!></div>'),B3=_('<div><!> <main class="content-area"><!></main> <!></div>'),z3=_('<div class="app-container"><!></div>');function J3(s,t){qa(t,!0);let a=at(void 0);Ss(()=>ws.subscribe(H=>{d(a,H,!0)}));let r=at("grades"),o=at(null),l=at("students"),c=at("dashboard"),u=at(!1),f=at(!1),m=at(!1);function h(W){typeof W=="string"?(d(r,W,!0),d(o,null)):(d(r,W.detail.section,!0),W.detail.requestId?d(o,W.detail.requestId,!0):d(o,null))}function g(W){typeof W=="string"?d(l,W,!0):d(l,W.detail.section,!0),(typeof W=="string"?W:W.detail.section)!=="class-list"&&d(x,null)}function b(W){const{yearLevel:H,sectionName:U,sectionId:X}=W.detail;d(x,{yearLevel:H,sectionName:U,sectionId:X},!0),d(l,"class-list")}function y(){d(x,null),d(l,"students")}let x=at(null);function A(W){d(c,W.detail.section,!0)}function C(){d(c,"settings")}function E(){d(u,!e(u))}function F(){d(f,!e(f))}function S(){d(m,!e(m))}async function q(){await ws.logout(),d(r,"grades"),d(l,"students"),d(c,"dashboard")}let I=Lt(()=>e(a)?.isAuthenticated?e(a).userType==="student"?"Student Portal - High School":e(a).userType==="teacher"?"Teacher Portal - High School":e(a).userType==="admin"?"Admin Portal - High School":"High School Student Information System":"Login - High School Student Information System");var j=z3();Md(W=>{var H=q3();O(()=>Id.title=e(I)),p(W,H)});var M=n(j);{var Z=W=>{Tu(W,{})},Q=W=>{var H=mt(),U=Ue(H);{var X=oe=>{var K=G3();let de;var ae=n(K);{let Ge=Lt(()=>e(a).userData?.name||"Student"),be=Lt(()=>e(a).userData?.firstName||"Student"),ke=Lt(()=>e(a).userData?.gender||"male"),Ve=Lt(()=>e(a).userData?.accountNumber||"N/A"),it=Lt(()=>e(a).userData?.profileImage);Gu(ae,{get studentName(){return e(Ge)},get firstName(){return e(be)},get gender(){return e(ke)},get accountNumber(){return e(Ve)},get profileImage(){return e(it)},onlogout:q,onToggleNavRail:E,onnavigate:h})}var te=v(ae,2),Ce=n(te);{var Ae=Ge=>{fv(Ge,{})},Re=Ge=>{var be=mt(),ke=Ue(be);{var Ve=Be=>{Ag(Be,{})},it=Be=>{var He=mt(),Ne=Ue(He);{var Je=Pe=>{Ug(Pe,{})},lt=Pe=>{var we=mt(),tt=Ue(we);{var ct=Se=>{o_(Se,{})},xe=Se=>{var We=mt(),Ze=Ue(We);{var ee=fe=>{Z_(fe,{get openRequestId(){return e(o)}})},ue=fe=>{var T=mt(),P=Ue(T);{var le=G=>{kb(G,{onnavigate:h})},R=G=>{var ie=mt(),_e=Ue(ie);{var Y=N=>{Qb(N,{})};$(_e,N=>{e(r)==="todo"&&N(Y)},!0)}p(G,ie)};$(P,G=>{e(r)==="notifications"?G(le):G(R,!1)},!0)}p(fe,T)};$(Ze,fe=>{e(r)==="documents"?fe(ee):fe(ue,!1)},!0)}p(Se,We)};$(tt,Se=>{e(r)==="schedule"?Se(ct):Se(xe,!1)},!0)}p(Pe,we)};$(Ne,Pe=>{e(r)==="ranking"?Pe(Je):Pe(lt,!1)},!0)}p(Be,He)};$(ke,Be=>{e(r)==="grades"?Be(Ve):Be(it,!1)},!0)}p(Ge,be)};$(Ce,Ge=>{e(r)==="profile"?Ge(Ae):Ge(Re,!1)})}i(te);var Me=v(te,2);Uu(Me,{get activeSection(){return e(r)},get isNavRailVisible(){return e(u)},onnavigate:h}),i(K),O(Ge=>de=ge(K,1,"student-portal",null,de,Ge),[()=>({"nav-rail-collapsed":!e(u)})]),p(oe,K)},B=oe=>{var K=mt(),de=Ue(K);{var ae=Ce=>{var Ae=V3();let Re;var Me=n(Ae);{let Be=Lt(()=>e(a).userData?.name||"Teacher"),He=Lt(()=>e(a).userData?.firstName||"Teacher"),Ne=Lt(()=>e(a).userData?.gender||"male"),Je=Lt(()=>e(a).userData?.accountNumber||"N/A"),lt=Lt(()=>e(a).userData?.profileImage);ry(Me,{get teacherName(){return e(Be)},get firstName(){return e(He)},get gender(){return e(Ne)},get accountNumber(){return e(Je)},get profileImage(){return e(lt)},onlogout:q,onToggleNavRail:F,onnavigate:g})}var Ge=v(Me,2),be=n(Ge);{var ke=Be=>{Ny(Be,{})},Ve=Be=>{var He=mt(),Ne=Ue(He);{var Je=Pe=>{Jy(Pe,{})},lt=Pe=>{var we=mt(),tt=Ue(we);{var ct=Se=>{xc(Se,{onNavigateToClassList:b})},xe=Se=>{var We=mt(),Ze=Ue(We);{var ee=fe=>{V1(fe,{get selectedClass(){return e(x)},onBackToClassManagement:y})},ue=fe=>{var T=mt(),P=Ue(T);{var le=G=>{f2(G,{})},R=G=>{xc(G,{onNavigateToClassList:b})};$(P,G=>{e(l)==="advisory"?G(le):G(R,!1)},!0)}p(fe,T)};$(Ze,fe=>{e(l)==="class-list"&&e(x)?fe(ee):fe(ue,!1)},!0)}p(Se,We)};$(tt,Se=>{e(l)==="students"?Se(ct):Se(xe,!1)},!0)}p(Pe,we)};$(Ne,Pe=>{e(l)==="schedule"?Pe(Je):Pe(lt,!1)},!0)}p(Be,He)};$(be,Be=>{e(l)==="profile"?Be(ke):Be(Ve,!1)})}i(Ge);var it=v(Ge,2);{let Be=Lt(()=>e(a).userData?.id);dy(it,{get teacherActiveSection(){return e(l)},get teacherNavRailVisible(){return e(f)},onnavigate:g,get teacherId(){return e(Be)}})}i(Ae),O(Be=>Re=ge(Ae,1,"teacher-portal",null,Re,Be),[()=>({"nav-rail-collapsed":!e(f)})]),p(Ce,Ae)},te=Ce=>{var Ae=mt(),Re=Ue(Ae);{var Me=Ge=>{var be=B3();let ke;var Ve=n(be);{let lt=Lt(()=>e(a).userData?.name||"Admin"),Pe=Lt(()=>e(a).userData?.firstName||"Admin"),we=Lt(()=>e(a).userData?.gender||"male"),tt=Lt(()=>e(a).userData?.accountNumber||"N/A"),ct=Lt(()=>e(a).userData?.profileImage);x2(Ve,{get adminName(){return e(lt)},get firstName(){return e(Pe)},get gender(){return e(we)},get accountNumber(){return e(tt)},get profileImage(){return e(ct)},onlogout:q,onToggleNavRail:S,onNavigateToSettings:C})}var it=v(Ve,2),Be=n(it);{var He=lt=>{b0(lt,{})},Ne=lt=>{var Pe=mt(),we=Ue(Pe);{var tt=xe=>{lw(xe,{})},ct=xe=>{var Se=mt(),We=Ue(Se);{var Ze=ue=>{$w(ue,{})},ee=ue=>{var fe=mt(),T=Ue(fe);{var P=R=>{Kw(R,{})},le=R=>{var G=mt(),ie=Ue(G);{var _e=N=>{Dx(N,{})},Y=N=>{var D=mt(),L=Ue(D);{var z=se=>{Vx(se,{})},ve=se=>{var $e=mt(),he=Ue($e);{var qe=Le=>{Uk(Le)},et=Le=>{var Qe=mt(),st=Ue(Qe);{var ht=xt=>{OD(xt,{})},_t=xt=>{var wt=mt(),St=Ue(wt);{var $t=Ut=>{xD(Ut,{})},Nt=Ut=>{var kt=mt(),jt=Ue(kt);{var Wt=aa=>{F3(aa,{})},Kt=aa=>{var Yt=mt(),pe=Ue(Yt);{var Ke=yt=>{O3(yt,{})};$(pe,yt=>{e(c)==="settings"&&yt(Ke)},!0)}p(aa,Yt)};$(jt,aa=>{e(c)==="document-requests"?aa(Wt):aa(Kt,!1)},!0)}p(Ut,kt)};$(St,Ut=>{e(c)==="subjects-and-activities"?Ut($t):Ut(Nt,!1)},!0)}p(xt,wt)};$(st,xt=>{e(c)==="department-management"?xt(ht):xt(_t,!1)},!0)}p(Le,Qe)};$(he,Le=>{e(c)==="schedule-management"?Le(qe):Le(et,!1)},!0)}p(se,$e)};$(L,se=>{e(c)==="student-grades-list"?se(z):se(ve,!1)},!0)}p(N,D)};$(ie,N=>{e(c)==="archived-accounts"?N(_e):N(Y,!1)},!0)}p(R,G)};$(T,R=>{e(c)==="teacher-masterlist"?R(P):R(le,!1)},!0)}p(ue,fe)};$(We,ue=>{e(c)==="student-masterlist"?ue(Ze):ue(ee,!1)},!0)}p(xe,Se)};$(we,xe=>{e(c)==="account-creation"?xe(tt):xe(ct,!1)},!0)}p(lt,Pe)};$(Be,lt=>{e(c)==="dashboard"?lt(He):lt(Ne,!1)})}i(it);var Je=v(it,2);B2(Je,{get adminActiveSection(){return e(c)},get adminNavRailVisible(){return e(m)},onnavigate:A}),i(be),O(lt=>ke=ge(be,1,"admin-portal",null,ke,lt),[()=>({"nav-rail-collapsed":!e(m)})]),p(Ge,be)};$(Re,Ge=>{e(a).userType==="admin"&&Ge(Me)},!0)}p(Ce,Ae)};$(de,Ce=>{e(a).userType==="teacher"?Ce(ae):Ce(te,!1)},!0)}p(oe,K)};$(U,oe=>{e(a).userType==="student"?oe(X):oe(B,!1)},!0)}p(W,H)};$(M,W=>{e(a)?.isAuthenticated?W(Q,!1):W(Z)})}i(j),p(s,j),Ga()}export{J3 as component};
