const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../assets/odometer-theme-default.DMiGbRSv.css"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{h as Ao,as as Wc,aQ as Is,q as za,ae as kt,_ as Gs,ad as Wa,Q as d,t as _,z as o,A as n,B as v,l as e,w as $,C as w,x as h,y as Ga,v as ut,aU as ia,aS as Q,ah as Ra,R as Hc,aP as vi,i as Xs,ag as Et,O as P,aX as Ts,aY as Jt,aZ as Ss,m as xs,aT as Ys,Z as Ks,ai as ka,j as x,a_ as Sn,a$ as On,b0 as Yc,b1 as Hr,aR as Uc,b2 as Qc,aV as Jc,b3 as Kc}from"../chunks/DfuX6PLp.js";import{i as C,p as La,a as ps,c as Ds,b as Pi,d as Co}from"../chunks/X9SYq9-G.js";import{d as Xc,c as ms,f as bi,r as sa,s as oe,g as Ui,a as $t,b as la,e as Tt,i as Ka,m as ds,j as ns,h as Zc,t as Ae,k as ed,T as td,l as ad}from"../chunks/CPr56_eZ.js";import{i as vs}from"../chunks/BLIOTr-m.js";import{_ as To}from"../chunks/D9Z9MdNV.js";const sd=!0;function as(s,t,a,i){var r=s.__style;if(Ao||r!==t){var l=Xc(t);(!Ao||l!==s.getAttribute("style"))&&(l==null?s.removeAttribute("style"):s.style.cssText=l),s.__style=t}return i}function Ti(s){return function(...t){var a=t[0];return a.stopPropagation(),s?.apply(this,t)}}function Os(s){return function(...t){var a=t[0];return a.preventDefault(),s?.apply(this,t)}}function Mo(s,t){var a=s.$$events?.[t.type],i=Wc(a)?a.slice():a==null?[]:[a];for(var r of i)r.call(this,t)}const Ul=sd,Ql=s=>{const t=/^[A-Z]{3}-\d{4}-\d{4}$/;return s?t.test(s)?"":"Please enter a valid ID Number (e.g., STU-2025-0001)":"ID Number is required"},Jl=s=>s?"":"Password is required",Kl=()=>document.documentElement.getAttribute("data-theme")||"light",id=s=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},nd=()=>{const t=Kl()==="dark"?"light":"dark";return id(t),t},rd=async({accountNumber:s,password:t})=>{try{const i=await(await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountNumber:s,password:t})})).json();if(i.success){const r={id:i.user.id,name:i.user.name,firstName:i.user.firstName,gender:i.user.gender,accountNumber:i.user.accountNumber,accountType:i.user.accountType,isAuthenticated:!0};return ms.login(r.accountType,r),bi(`Login successful! Welcome back, ${r.name}`),console.log("Login successful:",{accountNumber:s,userType:r.accountType}),r}else throw new Error(i.error||"Invalid credentials. Please try again.")}catch(a){const i=a.message||"Network error. Please try again.";throw new Error(i)}};function od(s,t){const a=nd();d(t,a==="dark")}const ld=(s,t,a)=>{d(t,s.target.value,!0),e(a).idNumber&&d(a,{...e(a),idNumber:Ql(e(t))},!0)},cd=(s,t,a)=>{d(t,s.target.value,!0),e(a).password&&d(a,{...e(a),password:Jl(e(t))},!0)},Po=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),t(s))};async function dd(s,t,a,i,r){d(t,""),d(a,["","","","","",""],!0),d(i,5),await r({preventDefault:()=>{}})}var ud=_('<div class="error-text"> </div>'),vd=(s,t)=>{s.preventDefault(),s.stopPropagation(),d(t,!e(t))},fd=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),s.stopPropagation(),d(t,!e(t)))},pd=_('<div class="error-text"> </div>'),hd=_('<div class="error-message-item"> </div>'),md=_('<div class="error-message-item"> </div>'),gd=_('<div class="error-message-item"> </div>'),_d=_('<div class="login-error-container"><span class="material-symbols-outlined">error</span> <div class="error-messages"><!> <!> <!></div></div>'),bd=_('<div class="login-loading-spinner"></div>'),yd=_("<span>Login</span>"),wd=_('<div class="login-header"><h1 class="login-title">Login</h1> <h2 class="login-subtitle">Enter your account details</h2></div> <form class="login-form" novalidate="" autocomplete="off"><div class="form-field"><div><span class="leading-icon material-symbols-outlined">badge</span> <input type="text" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="idnumber-input">ID Number</label></div> <!></div> <div class="form-field"><div><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" class="text-input" placeholder=" "/> <label class="text-label" for="password-input">Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div> <!></div> <!> <button id="login-submit-btn" type="submit" class="custom-filled-button login-submit" aria-label="Sign in"><!></button> <button type="button" id="forgot-password-btn" class="custom-text-button forgot-password" aria-label="forgot-password">Forgot Password</button></form>',1),xd=_('<div class="success-message-box"><span class="material-symbols-outlined">check_circle</span> <span> </span></div>'),Sd=_('<div class="error-message-box"><span class="material-symbols-outlined">error</span> <span> </span></div>'),kd=_('<div class="login-loading-spinner"></div>'),Dd=_('<span class="material-symbols-outlined">send</span> <span>Send Code</span>',1),Ad=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">email</span> <input type="email" autocomplete="email" class="text-input" placeholder=" " required/> <label class="text-label">Email Address</label></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),Cd=_('<input type="text" maxlength="1" inputmode="numeric" autocomplete="off" class="code-box" required/>'),Td=_('<div class="info-text"> </div>'),Md=_('<div class="verification-loading"><div class="login-loading-spinner"></div> <span>Verifying code...</span></div>'),Pd=_('<div class="login-loading-spinner"></div>'),Ed=_('<span class="material-symbols-outlined">refresh</span> <span>Resend Code</span>',1),Fd=_('<form class="login-form"><div class="form-field"><div class="code-boxes-container"></div> <!> <!></div> <button type="button" class="custom-filled-button login-submit"><!></button> <button class="back-to-login-btn" aria-label="Back to login">Back to Login</button></form>'),Nd=(s,t)=>{s.preventDefault(),d(t,!e(t))},Ld=(s,t)=>{s.preventDefault(),d(t,!e(t))},$d=_('<div class="login-loading-spinner"></div>'),jd=_("<span>Reset Password</span>"),Id=_('<form class="login-form"><div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock</span> <input autocomplete="new-password" class="text-input" placeholder=" " required/> <label class="text-label">New Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <div class="form-field"><div class="custom-text-field"><span class="leading-icon material-symbols-outlined">lock_reset</span> <input autocomplete="new-password" class="text-input" placeholder=" " required/> <label class="text-label">Confirm Password</label> <button type="button" class="trailing-icon-button"><span class="material-symbols-outlined"> </span></button></div></div> <button type="submit" class="custom-filled-button login-submit"><!></button></form>'),Rd=_('<div class="login-header"><h1 class="login-title"> </h1> <h2 class="login-subtitle"> </h2></div> <!> <!> <!> <!> <!>',1),Od=_('<div class="login-container"><button class="theme-toggle-btn" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="left-side"><!></div> <div class="right-side"><div class="welcome-text"><h1 class="welcome-title"> </h1> <p class="welcome-subtitle"> </p></div></div></div>');function qd(s,t){za(t,!0);let a=kt(""),i=kt(""),r=kt(!1),l=kt(!1),c=kt(Gs({idNumber:"",password:"",general:""})),u=kt(!1),f=kt(1),p=kt(""),m=kt(""),g=kt(""),y=kt(Gs(["","","","","",""])),b=kt(""),D=kt(""),S=kt(!1),k=kt(!1),A=kt(""),E=kt(5),M=kt(!1);Wa(()=>{const We=Kl();d(M,We==="dark")});const I=async We=>{We.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0);const nt=Ql(e(a)),ke=Jl(e(i));if(nt||ke){d(c,{idNumber:nt,password:ke,general:""},!0);return}d(r,!0);try{await rd({accountNumber:e(a),password:e(i)})}catch(De){d(c,{...e(c),general:De.message},!0)}finally{d(r,!1)}};function F(){d(u,!e(u)),e(u)||(d(f,1),d(p,""),d(m,""),d(g,""),d(y,["","","","","",""],!0),d(b,""),d(D,""),d(c,{idNumber:"",password:"",general:""},!0),d(A,""),d(E,5))}function z(We,nt){const De=nt.target.value.replace(/\D/g,"");if(De.length>0)if(e(y)[We]=De[De.length-1],d(g,e(y).join(""),!0),We<5&&De){const Ie=document.getElementById(`code-digit-${We+1}`);Ie&&Ie.focus()}else We===5&&e(y).every(Ie=>Ie!=="")&&ce({preventDefault:()=>{}});else e(y)[We]="",d(g,e(y).join(""),!0)}function R(We,nt){if(nt.key==="Backspace"&&!e(y)[We]&&We>0){const ke=document.getElementById(`code-digit-${We-1}`);ke&&ke.focus()}}function J(We){We.preventDefault();const nt=We.clipboardData.getData("text").replace(/\D/g,"").slice(0,6);if(nt.length>0){const ke=nt.split("");d(y,[...ke,...Array(6-ke.length).fill("")],!0),d(g,e(y).join(""),!0);const De=Math.min(ke.length,5),Ie=document.getElementById(`code-digit-${De}`);Ie&&Ie.focus(),nt.length===6&&ce({preventDefault:()=>{}})}}function V(We){return We?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(We)?"":"Please enter a valid email address":"Email address is required"}function L(We){return We?/^\d{6}$/.test(We)?"":"Code must be 6 digits":"Verification code is required"}function X(We){return We?We.length<6?"Password must be at least 6 characters":"":"Password is required"}async function ne(We){We.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(A,"");const nt=V(e(p));if(nt){d(c,{...e(c),general:nt},!0);return}d(r,!0);try{const ke=await fetch("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e(p).toLowerCase().trim()})}),De=await ke.json();if(!ke.ok)throw new Error(De.error||"Failed to send reset code");d(m,De.resetToken,!0),d(A,"A verification code has been sent to your email address."),d(f,2)}catch(ke){d(c,{...e(c),general:ke.message},!0)}finally{d(r,!1)}}async function ce(We){We.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(A,"");const nt=L(e(g));if(nt){d(c,{...e(c),general:nt},!0);return}d(r,!0);try{const ke=await fetch("/api/forgot-password/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(m),code:e(g)})}),De=await ke.json();if(!ke.ok)throw De.attemptsRemaining!==void 0&&d(E,De.attemptsRemaining,!0),new Error(De.error||"Invalid verification code");d(A,"Code verified! Please enter your new password."),d(f,3)}catch(ke){d(c,{...e(c),general:ke.message},!0)}finally{d(r,!1)}}async function Le(We){We.preventDefault(),d(c,{idNumber:"",password:"",general:""},!0),d(A,"");const nt=X(e(b));if(nt){d(c,{...e(c),general:nt},!0);return}if(e(b)!==e(D)){d(c,{...e(c),general:"Passwords do not match"},!0);return}d(r,!0);try{const ke=await fetch("/api/forgot-password/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resetToken:e(m),code:e(g),newPassword:e(b)})}),De=await ke.json();if(!ke.ok)throw new Error(De.error||"Failed to reset password");d(A,"Password reset successfully! Redirecting to login..."),setTimeout(()=>{F()},2e3)}catch(ke){d(c,{...e(c),general:ke.message},!0)}finally{d(r,!1)}}var fe=Od(),se=o(fe);se.__click=[od,M];var re=o(se),Se=o(re,!0);n(re),n(se);var me=v(se,2),ze=o(me);{var Xe=We=>{var nt=wd(),ke=v(ut(nt),2),De=o(ke),Ie=o(De),Ee=v(o(Ie),2);sa(Ee),Ee.__input=[ld,a,c],Ee.__keydown=[Po,I],ia(2),n(Ie);var ee=v(Ie,2);{var Ue=be=>{var Fe=ud(),he=o(Fe,!0);n(Fe),$(()=>w(he,e(c).idNumber)),h(be,Fe)};C(ee,be=>{e(c).idNumber&&be(Ue)})}n(De);var rt=v(De,2),Ye=o(rt),at=v(o(Ye),2);sa(at),at.__input=[cd,i,c],at.__keydown=[Po,I];var lt=v(at,4);lt.__click=[vd,l],lt.__keydown=[fd,l];var O=o(lt),T=o(O,!0);n(O),n(lt),n(Ye);var U=v(Ye,2);{var de=be=>{var Fe=pd(),he=o(Fe,!0);n(Fe),$(()=>w(he,e(c).password)),h(be,Fe)};C(U,be=>{e(c).password&&be(de)})}n(rt);var Pe=v(rt,2);{var Ve=be=>{var Fe=_d(),he=v(o(Fe),2),te=o(he);{var j=Ke=>{var Ge=hd(),ot=o(Ge,!0);n(Ge),$(()=>w(ot,e(c).idNumber)),h(Ke,Ge)};C(te,Ke=>{e(c).idNumber&&Ke(j)})}var K=v(te,2);{var ae=Ke=>{var Ge=md(),ot=o(Ge,!0);n(Ge),$(()=>w(ot,e(c).password)),h(Ke,Ge)};C(K,Ke=>{e(c).password&&Ke(ae)})}var Oe=v(K,2);{var Be=Ke=>{var Ge=gd(),ot=o(Ge,!0);n(Ge),$(()=>w(ot,e(c).general)),h(Ke,Ge)};C(Oe,Ke=>{e(c).general&&Ke(Be)})}n(he),n(Fe),h(be,Fe)};C(Pe,be=>{(e(c).idNumber||e(c).password||e(c).general)&&be(Ve)})}var Me=v(Pe,2),q=o(Me);{var B=be=>{var Fe=bd();h(be,Fe)},N=be=>{var Fe=yd();h(be,Fe)};C(q,be=>{e(r)?be(B):be(N,!1)})}n(Me);var Z=v(Me,2);Z.__click=F,n(ke),$(()=>{oe(Ie,1,`custom-text-field ${e(c).idNumber?"error":""}`),Ui(Ee,e(a)),oe(Ye,1,`custom-text-field ${e(c).password?"error":""}`),$t(at,"type",e(l)?"text":"password"),Ui(at,e(i)),$t(lt,"aria-label",e(l)?"Hide password":"Show password"),w(T,e(l)?"visibility":"visibility_off"),Me.disabled=e(r)}),Q("submit",ke,I),h(We,nt)},tt=We=>{var nt=Rd(),ke=ut(nt),De=o(ke),Ie=o(De,!0);n(De);var Ee=v(De,2),ee=o(Ee,!0);n(Ee),n(ke);var Ue=v(ke,2);{var rt=Ve=>{var Me=xd(),q=v(o(Me),2),B=o(q,!0);n(q),n(Me),$(()=>w(B,e(A))),h(Ve,Me)};C(Ue,Ve=>{e(A)&&Ve(rt)})}var Ye=v(Ue,2);{var at=Ve=>{var Me=Sd(),q=v(o(Me),2),B=o(q,!0);n(q),n(Me),$(()=>w(B,e(c).general)),h(Ve,Me)};C(Ye,Ve=>{e(c).general&&Ve(at)})}var lt=v(Ye,2);{var O=Ve=>{var Me=Ad(),q=o(Me),B=o(q),N=v(o(B),2);sa(N),ia(2),n(B),n(q);var Z=v(q,2),be=o(Z);{var Fe=j=>{var K=kd();h(j,K)},he=j=>{var K=Dd();ia(2),h(j,K)};C(be,j=>{e(r)?j(Fe):j(he,!1)})}n(Z);var te=v(Z,2);te.__click=F,n(Me),$(()=>Z.disabled=e(r)),Q("submit",Me,ne),la(N,()=>e(p),j=>d(p,j)),h(Ve,Me)};C(lt,Ve=>{e(f)===1&&Ve(O)})}var T=v(lt,2);{var U=Ve=>{var Me=Fd(),q=o(Me),B=o(q);Tt(B,21,()=>e(y),Ka,(Oe,Be,Ke)=>{var Ge=Cd();sa(Ge),$t(Ge,"id",`code-digit-${Ke}`),Ge.__input=ot=>z(Ke,ot),Ge.__keydown=ot=>R(Ke,ot),$(()=>{Ui(Ge,e(Be)),Ge.disabled=e(r)}),Q("paste",Ge,function(...ot){(Ke===0?J:null)?.apply(this,ot)}),h(Oe,Ge)}),n(B);var N=v(B,2);{var Z=Oe=>{var Be=Td(),Ke=o(Be);n(Be),$(()=>w(Ke,`Attempts remaining: ${e(E)??""}`)),h(Oe,Be)};C(N,Oe=>{e(E)<5&&Oe(Z)})}var be=v(N,2);{var Fe=Oe=>{var Be=Md();h(Oe,Be)};C(be,Oe=>{e(r)&&Oe(Fe)})}n(q);var he=v(q,2);he.__click=[dd,g,y,E,ne];var te=o(he);{var j=Oe=>{var Be=Pd();h(Oe,Be)},K=Oe=>{var Be=Ed();ia(2),h(Oe,Be)};C(te,Oe=>{e(r)?Oe(j):Oe(K,!1)})}n(he);var ae=v(he,2);ae.__click=F,n(Me),$(()=>he.disabled=e(r)),Q("submit",Me,Oe=>{Oe.preventDefault()}),h(Ve,Me)};C(T,Ve=>{e(f)===2&&Ve(U)})}var de=v(T,2);{var Pe=Ve=>{var Me=Id(),q=o(Me),B=o(q),N=v(o(B),2);sa(N);var Z=v(N,4);Z.__click=[Nd,S];var be=o(Z),Fe=o(be,!0);n(be),n(Z),n(B),n(q);var he=v(q,2),te=o(he),j=v(o(te),2);sa(j);var K=v(j,4);K.__click=[Ld,k];var ae=o(K),Oe=o(ae,!0);n(ae),n(K),n(te),n(he);var Be=v(he,2),Ke=o(Be);{var Ge=gt=>{var Yt=$d();h(gt,Yt)},ot=gt=>{var Yt=jd();h(gt,Yt)};C(Ke,gt=>{e(r)?gt(Ge):gt(ot,!1)})}n(Be),n(Me),$(()=>{$t(N,"type",e(S)?"text":"password"),$t(Z,"aria-label",e(S)?"Hide password":"Show password"),w(Fe,e(S)?"visibility":"visibility_off"),$t(j,"type",e(k)?"text":"password"),$t(K,"aria-label",e(k)?"Hide password":"Show password"),w(Oe,e(k)?"visibility":"visibility_off"),Be.disabled=e(r)}),Q("submit",Me,Le),la(N,()=>e(b),gt=>d(b,gt)),la(j,()=>e(D),gt=>d(D,gt)),h(Ve,Me)};C(de,Ve=>{e(f)===3&&Ve(Pe)})}$(()=>{w(Ie,e(f)===1?"Forgot Password?":e(f)===2?"Verify Code":"Reset Password"),w(ee,e(f)===1?"Enter your email to receive a verification code":e(f)===2?"Enter the 6-digit code sent to your email":"Create a new password for your account")}),h(We,nt)};C(ze,We=>{e(u)?We(tt,!1):We(Xe)})}n(me);var ve=v(me,2),$e=o(ve),Je=o($e),Re=o(Je,!0);n(Je);var Ze=v(Je,2),st=o(Ze,!0);n(Ze),n($e),n(ve),n(fe),$(()=>{w(Se,e(M)?"light_mode":"dark_mode"),w(Re,e(u)?"Password Reset":"Welcome"),w(st,e(u)?"Recover your account securely":"Login to access your account")}),h(s,fe),Ga()}Is(["click","input","keydown"]);function Vd(s,t){d(t,!e(t))}function Bd(s,t,a){d(t,!e(t)),a()}var zd=_('<img alt="Profile" class="avatar-image"/>'),Gd=_('<div class="avatar-placeholder"> </div>'),Wd=(s,t,a)=>{t(),a.onnavigate("profile")},Hd=async(s,t,a)=>{t(),await a.onlogout(),bi("Logged out successfully. See you next time!")},Yd=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Ud=_('<nav class="student-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">school</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function Qd(s,t){za(t,!0);let a=La(t,"studentName",3,"John Does"),i=La(t,"firstName",3,"John"),r=La(t,"gender",3,"male"),l=La(t,"accountNumber",3,"STU-2025-0001"),c=La(t,"profileImage",3,null);function u(ve){return ve==="female"?"Ms.":"Mr."}let f=Ra(()=>`${u(r())} ${i()}`),p=kt(!0),m=kt(!1);function g(){d(m,!1)}function y(ve){e(m)&&!ve.target.closest(".user-profile-container")&&g()}Wa(()=>{const ve=localStorage.getItem("theme");return d(p,ve!=="light"),b(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}});function b(){e(p)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function D(ve){return ve.split(" ").map($e=>$e.charAt(0)).join("").toUpperCase().slice(0,2)}var S=Ud(),k=o(S),A=o(k),E=o(A);E.__click=function(...ve){t.onToggleNavRail?.apply(this,ve)};var M=v(E,2),I=v(o(M),2),F=o(I);n(I),n(M),n(A);var z=v(A,2),R=o(z);R.__click=[Bd,p,b];var J=o(R),V=o(J,!0);n(J),n(R);var L=v(R,2),X=o(L);X.__click=[Vd,m];var ne=o(X),ce=o(ne),Le=o(ce,!0);n(ce);var fe=v(ce,2),se=o(fe);n(fe),n(ne);var re=v(ne,2),Se=o(re);{var me=ve=>{var $e=zd();$(()=>$t($e,"src",c())),h(ve,$e)},ze=ve=>{var $e=Gd(),Je=o($e,!0);n($e),$(Re=>w(Je,Re),[()=>D(i())]),h(ve,$e)};C(Se,ve=>{c()?ve(me):ve(ze,!1)})}n(re),n(X);var Xe=v(X,2);{var tt=ve=>{var $e=Yd(),Je=o($e);Je.__click=[Wd,g,t];var Re=v(Je,2);Re.__click=[Hd,g,t],n($e),h(ve,$e)};C(Xe,ve=>{e(m)&&ve(tt)})}n(L),n(z),n(k),n(S),$(()=>{w(F,`Welcome, ${e(f)??""}`),w(V,e(p)?"light_mode":"dark_mode"),w(Le,a()),w(se,`Account: ${l()??""}`)}),h(s,S),Ga()}Is(["click"]);async function bs(s,t={}){const a=Hc(ms),i={"Content-Type":"application/json",...t.headers};if(a.isAuthenticated&&a.userData){const l={id:a.userData.id,name:a.userData.name,account_number:a.userData.accountNumber,account_type:a.userData.account_type||a.userData.accountType};i["x-user-info"]=JSON.stringify(l),i["x-user-id"]=a.userData.id.toString(),i["x-user-account-number"]=a.userData.accountNumber,i["x-user-name"]=encodeURIComponent(a.userData.name)}const r={...t,headers:i};try{return await fetch(s,r)}catch(l){throw console.error("Fetch error:",l),l}}const da={get:async(s,t={})=>{const a=await bs(s,{...t,method:"GET"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return a.json()},post:async(s,t,a={})=>{const i=await bs(s,{...a,method:"POST",body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return i.json()},put:async(s,t,a={})=>{const i=await bs(s,{...a,method:"PUT",body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return i.json()},delete:async(s,t,a={})=>{const i=await bs(s,{...a,method:"DELETE",body:t?JSON.stringify(t):void 0});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return i.json()},patch:async(s,t,a={})=>{const i=await bs(s,{...a,method:"PATCH",body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);return i.json()}};var Jd=(s,t,a)=>t(e(a).id),Kd=_('<span class="menu-notification-badge menu-rail-badge"> </span>'),Xd=_('<button><div class="rail-icon-container"><span class="material-symbols-outlined rail-icon"> </span> <!></div> <span class="rail-label"> </span></button>'),Zd=(s,t,a)=>t(e(a).id),eu=_('<span class="menu-notification-badge menu-nav-badge"> </span>'),tu=_('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),au=(s,t)=>t("todo"),su=(s,t,a)=>t(e(a).id),iu=_('<span class="menu-notification-badge menu-nav-badge"> </span>'),nu=_('<button><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon"> </span> <!></div></button>'),ru=_(`<nav role="navigation" aria-label="Student portal navigation"><div class="rail-container"></div></nav> <nav class="bottom-navigation" role="	navigation" aria-label="Student portal navigation"><div class="nav-container"><!> <button aria-label="Todo List"><div class="nav-icon-container"><span class="material-symbols-outlined nav-icon" style="font-variation-settings: 'FILL' 1; font-size: 28px;">checklist</span></div></button> <!></div></nav>`,1);function ou(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=La(t,"activeSection",15,"grades"),c=La(t,"isNavRailVisible",3,!0),u=kt(0);const f=[{id:"grades",label:"My Grades",icon:"grade"},{id:"schedule",label:"Schedule",icon:"schedule"},{id:"documents",label:"Documents",icon:"description"},{id:"notifications",label:"Notifications",icon:"notifications",hasBadge:!0},{id:"todo",label:"Todo List",icon:"checklist"}];async function p(){if(r().isAuthenticated)try{const z=await bs("/api/notifications?limit=1&offset=0");z.success&&d(u,z.data.unreadCount||0,!0)}catch(z){console.error("Error fetching notification count:",z)}}function m(F){l(F),t.onnavigate&&t.onnavigate({detail:{section:F}})}Wa(()=>{let F;F=ms.subscribe(R=>{R.isAuthenticated&&(p(),F&&F())});const z=setInterval(()=>{r().isAuthenticated&&p()},15e3);return()=>{clearInterval(z),F&&F()}});var g=ru(),y=ut(g);let b;var D=o(y);Tt(D,21,()=>f,F=>F.id,(F,z)=>{var R=Xd();let J;R.__click=[Jd,m,z];var V=o(R),L=o(V),X=o(L,!0);n(L);var ne=v(L,2);{var ce=se=>{var re=Kd(),Se=o(re,!0);n(re),$(()=>w(Se,e(u)>99?"99+":e(u))),h(se,re)};C(ne,se=>{e(z).hasBadge&&e(u)>0&&se(ce)})}n(V);var Le=v(V,2),fe=o(Le,!0);n(Le),n(R),$(se=>{J=oe(R,1,"rail-item",null,J,se),$t(R,"aria-label",e(z).label),$t(R,"aria-current",e(z).id===l()?"page":void 0),w(X,e(z).icon),w(fe,e(z).label)},[()=>({active:e(z).id===l()})]),h(F,R)}),n(D),n(y);var S=v(y,2),k=o(S),A=o(k);Tt(A,17,()=>f.slice(0,2),F=>F.id,(F,z)=>{var R=tu();let J;R.__click=[Zd,m,z];var V=o(R),L=o(V),X=o(L,!0);n(L);var ne=v(L,2);{var ce=Le=>{var fe=eu(),se=o(fe,!0);n(fe),$(()=>w(se,e(u)>99?"99+":e(u))),h(Le,fe)};C(ne,Le=>{e(z).hasBadge&&e(u)>0&&Le(ce)})}n(V),n(R),$(Le=>{J=oe(R,1,"nav-item",null,J,Le),$t(R,"aria-label",e(z).label),$t(R,"aria-current",e(z).id===l()?"page":void 0),w(X,e(z).icon)},[()=>({active:e(z).id===l()})]),h(F,R)});var E=v(A,2);let M;E.__click=[au,m];var I=v(E,2);Tt(I,17,()=>f.slice(2,4),F=>F.id,(F,z)=>{var R=nu();let J;R.__click=[su,m,z];var V=o(R),L=o(V),X=o(L,!0);n(L);var ne=v(L,2);{var ce=Le=>{var fe=iu(),se=o(fe,!0);n(fe),$(()=>w(se,e(u)>99?"99+":e(u))),h(Le,fe)};C(ne,Le=>{e(z).hasBadge&&e(u)>0&&Le(ce)})}n(V),n(R),$(Le=>{J=oe(R,1,"nav-item",null,J,Le),$t(R,"aria-label",e(z).label),$t(R,"aria-current",e(z).id===l()?"page":void 0),w(X,e(z).icon)},[()=>({active:e(z).id===l()})]),h(F,R)}),n(k),n(S),$((F,z)=>{b=oe(y,1,"navigation-rail",null,b,F),M=oe(E,1,"nav-item",null,M,z),$t(E,"aria-current",l()==="todo"?"page":void 0)},[()=>({collapsed:!c()}),()=>({active:l()==="todo"})]),h(s,g),Ga(),i()}Is(["click"]);const lu=300*1e3,cu="student_profile_";function du(){const s={studentData:null,studentProfileData:null,studentSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:i}=vi(s);function r(b){return`${cu}${b}`}function l(b){return!b||!b.timestamp?!1:Date.now()-b.timestamp<lu}function c(b){try{const D=r(b),S=localStorage.getItem(D);if(S){const k=JSON.parse(S);if(l(k))return k.data}}catch(D){console.warn("Failed to retrieve cached student profile data:",D)}return null}function u(b,D){try{const S=r(b),k={data:D,timestamp:Date.now()};localStorage.setItem(S,JSON.stringify(k))}catch(S){console.warn("Failed to cache student profile data:",S)}}async function f(b,D=!1){try{i(F=>({...F,isLoading:!D,isRefreshing:D,error:null,currentStudentId:b}));const S=await fetch("/api/accounts?type=student&limit=1000");if(!S.ok)throw new Error("Failed to fetch student data");const k=await S.json();if(!k.success)throw new Error(k.message||"Failed to fetch student data");const A=k.accounts.find(F=>F.id===b||F.number===b);if(!A)throw new Error("Student data not found");let E=null;try{const F=await fetch(`/api/student-profile?studentId=${b}`);if(F.ok){const z=await F.json();z.success&&(E=z.data)}}catch(F){console.warn("Failed to fetch additional student profile data:",F)}if(!E?.subjects||E.subjects.length===0)try{const z=await(await fetch("/api/current-quarter")).json(),R=z.data?.currentQuarter||2,J=z.data?.currentSchoolYear||"2025-2026",V=await fetch(`/api/student-grades?student_id=${b}&quarter=${R}&school_year=${J}`);if(V.ok){const L=await V.json();if(L.success&&L.data.grades){const X=L.data.grades.map(ne=>({id:ne.subject_id,name:ne.name,code:ne.code||"",teacher:ne.teacher,color:p(ne.name)}));E?E.subjects=X:E={section:{id:null,name:"No section assigned",gradeLevel:A.grade_level||"Not assigned",adviser:"No adviser"},subjects:X,academicSummary:{generalAverage:L.data.statistics.overallAverage||"Not available",classRank:"Not available",totalStudentsInSection:0,totalSubjectsEnrolled:X.length,totalSubjectsWithGrades:L.data.statistics.countedSubjects||0}}}}}catch(F){console.warn("Failed to fetch subjects from grades API:",F)}let M=[];try{const R=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",J=await fetch(`/api/student-sections?studentId=${b}&schoolYear=${R}`);if(J.ok){const V=await J.json();V.success&&(M=V.data.classData||[])}}catch(F){console.warn("Failed to fetch student sections:",F)}const I={studentData:A,studentProfileData:E,studentSections:M,lastUpdated:new Date().toISOString()};i(F=>({...F,...I,isLoading:!1,isRefreshing:!1,error:null})),u(b,I)}catch(S){console.error("Error loading student profile:",S),i(k=>({...k,isLoading:!1,isRefreshing:!1,error:S.message}))}}function p(b){const D={Mathematics:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Math:["#4F46E5","#6366F1","#8B5CF6","#3B82F6"],Science:["#059669","#10B981","#34D399","#047857"],English:["#DC2626","#EF4444","#F87171","#B91C1C"],"Physical Education":["#EA580C","#F97316","#FB923C","#C2410C"],MAPEH:["#EA580C","#F97316","#FB923C","#C2410C"],PE:["#EA580C","#F97316","#FB923C","#C2410C"],Filipino:["#7C2D12","#A16207","#D97706","#92400E"],"Araling Panlipunan":["#B45309","#D97706","#F59E0B","#A16207"],History:["#B45309","#D97706","#F59E0B","#A16207"],Computer:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Technology:["#6366F1","#8B5CF6","#A855F7","#7C3AED"],Arts:["#C026D3","#D946EF","#E879F9","#A21CAF"],Music:["#EC4899","#F472B6","#F9A8D4","#DB2777"],Health:["#16A34A","#22C55E","#4ADE80","#15803D"],Values:["#0891B2","#06B6D4","#22D3EE","#0E7490"],Research:["#7C2D12","#A16207","#D97706","#92400E"],TLE:["#9333EA","#A855F7","#C084FC","#7E22CE"],ESP:["#0891B2","#06B6D4","#22D3EE","#0E7490"]},S=["#EF4444","#F97316","#F59E0B","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899","#F43F5E","#E11D48","#BE123C","#9F1239","#881337"];function k(I){let F=0;for(let z=0;z<I.length;z++){const R=I.charCodeAt(z);F=(F<<5)-F+R,F=F&F}return Math.abs(F)}const A=b.toLowerCase().trim();for(const[I,F]of Object.entries(D))if(A.includes(I.toLowerCase())){const R=k(b)%F.length;return F[R]}const M=k(b)%S.length;return S[M]}function m(b){const D=c(b);return D?(i(S=>({...S,...D,currentStudentId:b,isLoading:!1,isRefreshing:!1,error:null})),!0):(i(S=>({...S,currentStudentId:b,isLoading:!0,isRefreshing:!1,error:null})),!1)}function g(b){try{const D=r(b);localStorage.removeItem(D)}catch(D){console.warn("Failed to clear student profile cache:",D)}return i(D=>({...s,currentStudentId:b,isLoading:!0})),y.loadProfile(b,!1)}const y={subscribe:t,init:m,loadProfile:f,forceRefresh:g,getCachedData:b=>c(b)};return y}const ln=du();function uu(s,t){d(t,!e(t))}function vu(s,t){d(t,!e(t))}function fu(s,t){d(t,!e(t))}function pu(s,t){ds.confirm("Change Password",`
			<div class="student-profile-password-form">
				<div class="student-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="student-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="student-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="student-profile-form-input"
						/>
						<button type="button" class="student-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var hu=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),mu=_('<div class="silent-refresh-indicator"><span class="refresh-spinner"></span></div>'),gu=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading student information...</p></div>'),_u=_('<div class="info-row row-five"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="info-content"><div class="info-label">Student ID</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person</span></div> <div class="info-content"><div class="info-label">Full Name</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">school</span></div> <div class="info-content"><div class="info-label">Year Level</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">group</span></div> <div class="info-content"><div class="info-label">Section</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="info-content"><div class="info-label">Total Subjects</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">email</span></div> <div class="info-content"><div class="info-label">Email</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">phone</span></div> <div class="info-content"><div class="info-label">Contact Number</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">family_restroom</span></div> <div class="info-content"><div class="info-label">Guardian</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-one"><div class="info-card address-card"><div class="info-icon"><span class="material-symbols-outlined">home</span></div> <div class="info-content"><div class="info-label">Address</div> <div class="info-value"> </div></div></div></div> <div class="info-row row-two"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">cake</span></div> <div class="info-content"><div class="info-label">Birth Date</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Age</div> <div class="info-value"> </div></div></div></div>',1),bu=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading academic performance...</p></div>'),yu=_('<div class="info-row row-three"><div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">person_outline</span></div> <div class="info-content"><div class="info-label">Adviser</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">grade</span></div> <div class="info-content"><div class="info-label">General Average</div> <div class="info-value"> </div></div></div> <div class="info-card"><div class="info-icon"><span class="material-symbols-outlined">leaderboard</span></div> <div class="info-content"><div class="info-label">Class Rank</div> <div class="info-value"> </div></div></div></div>'),wu=_('<div class="profile-loading-container"><span class="profile-loader"></span> <p class="profile-loading-text">Loading enrolled subjects...</p></div>'),xu=_('<div class="subject-card"><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p class="teacher-name"> </p></div></div>'),Su=_('<div class="subjects-grid"></div>'),ku=_('<div class="subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects enrolled yet</p></div>'),Du=_('<div class="profile-header"><div class="header-content"><h1 class="page-title">Student Profile</h1> <p class="page-subtitle">Personal Information & Academic Details</p></div> <div class="header-actions"><!> <button class="student-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="profile-info-section"><h2 class="section-title section-title-desktop">Student Information</h2> <button class="section-header-mobile" aria-label="Toggle student information"><h2 class="section-title">Student Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-academic-section"><h2 class="section-title section-title-desktop">Academic Performance</h2> <button class="section-header-mobile" aria-label="Toggle academic performance"><h2 class="section-title">Academic Performance</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-subjects-section"><h2 class="section-title section-title-desktop">Enrolled Subjects</h2> <button class="section-header-mobile" aria-label="Toggle enrolled subjects"><h2 class="section-title">Enrolled Subjects</h2> <span>expand_more</span></button> <div><!></div></div> <div class="profile-security-section"><h2 class="section-title section-title-desktop">Account Security</h2> <div class="section-content"><div class="info-row row-one"><div class="info-card security-card"><div class="info-content-container"><div class="info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="info-content"><div class="info-label">Password</div> <div class="info-value">Change your account password for security</div></div></div> <div class="security-actions"><button class="security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),Au=_('<div class="profile-container"><!></div>');function Cu(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ln,"$studentProfileStore",a);let l=kt(void 0);Xs(()=>ms.subscribe(L=>{d(l,L,!0)}));let c=Ra(r),u=Ra(()=>e(c).studentData),f=Ra(()=>e(c).studentProfileData),p=Ra(()=>e(c).isLoading),m=Ra(()=>e(c).isRefreshing),g=Ra(()=>e(c).error);function y(){e(l)?.userData?.id&&ln.forceRefresh(e(l).userData.id)}Xs(()=>{e(l)?.userData?.id&&(ln.init(e(l).userData.id)||ln.loadProfile(e(l).userData.id,!1))}),Wa(()=>{const V=setInterval(()=>{e(l)?.userData?.id&&ln.loadProfile(e(l).userData.id,!0)},3e5);return()=>clearInterval(V)});let b=Ra(()=>({id:e(u)?.number||e(l)?.userData?.accountNumber||"N/A",name:e(u)?.name||e(l)?.userData?.name||"Student Name",firstName:e(u)?.firstName||e(l)?.userData?.firstName||"",lastName:e(u)?.lastName||"",middleInitial:e(u)?.middleInitial||"",yearLevel:e(u)?.gradeLevel?`Grade ${e(u).gradeLevel}`:"Not assigned",section:e(f)?.section?.name||"Not assigned",email:e(u)?.email||"Not available",phone:e(u)?.contactNumber||"Not available",address:e(u)?.address||"Not available",birthDate:e(u)?.birthdate?new Date(e(u).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(u)?.age||"Not available",guardian:e(u)?.guardian||"Not available",gender:e(u)?.gender||e(l)?.userData?.gender||"male",academicSummary:{adviser:e(f)?.section?.adviser||"Not available",gpa:e(f)?.academicSummary?.generalAverage||"Not available",rank:e(f)?.academicSummary?.classRank||"Not available",totalStudents:e(f)?.academicSummary?.totalStudentsInSection||"Not available"},subjects:e(f)?.subjects||[]})),D=Ra(()=>e(b).subjects.length||"Not available"),S=kt(!0),k=kt(!1),A=kt(!0),E=kt(!1);function M(V){const L=document.getElementById(V),ne=L.nextElementSibling.querySelector(".password-eye-icon");L.type==="password"?(L.type="text",ne.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(L.type="password",ne.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=M);async function I(){const V=document.getElementById("current-password"),L=document.getElementById("new-password"),X=document.getElementById("confirm-password");if(!V||!L||!X){ns("Password form inputs not found");return}const ne=V.value,ce=L.value,Le=X.value;if(!ne){ns("Current password is required");return}if(!ce){ns("New password is required");return}if(ce!==Le){ns("New passwords do not match");return}if(ce.length<8){ns("Password must be at least 8 characters long");return}if(ne===ce){ns("New password must be different from current password");return}try{d(E,!0);const fe=await api.post("/api/change-password",{currentPassword:ne,newPassword:ce});fe.success?(V.value="",L.value="",X.value="",bi("Password changed successfully!"),ds.close()):ns(fe.error||"Failed to change password")}catch(fe){console.error("Password change error:",fe),ns(fe.message||"Failed to change password")}finally{d(E,!1)}}var F=Au(),z=o(F);{var R=V=>{var L=hu(),X=v(o(L),2),ne=o(X);n(X);var ce=v(X,2);ce.__click=y,n(L),$(()=>w(ne,`Failed to load profile data: ${e(g)??""}`)),h(V,L)},J=V=>{var L=Du(),X=ut(L),ne=v(o(X),2),ce=o(ne);{var Le=B=>{var N=mu();h(B,N)};C(ce,B=>{e(m)&&B(Le)})}var fe=v(ce,2);fe.__click=y,n(ne),n(X);var se=v(X,2),re=v(o(se),2);re.__click=[uu,S];var Se=v(o(re),2);let me;n(re);var ze=v(re,2);let Xe;var tt=o(ze);{var ve=B=>{var N=gu();h(B,N)},$e=B=>{var N=_u(),Z=ut(N),be=o(Z),Fe=v(o(be),2),he=v(o(Fe),2),te=o(he,!0);n(he),n(Fe),n(be);var j=v(be,2),K=v(o(j),2),ae=v(o(K),2),Oe=o(ae,!0);n(ae),n(K),n(j);var Be=v(j,2),Ke=v(o(Be),2),Ge=v(o(Ke),2),ot=o(Ge,!0);n(Ge),n(Ke),n(Be);var gt=v(Be,2),Yt=v(o(gt),2),ge=v(o(Yt),2),Qe=o(ge,!0);n(ge),n(Yt),n(gt);var Y=v(gt,2),le=v(o(Y),2),Ce=v(o(le),2),et=o(Ce,!0);n(Ce),n(le),n(Y),n(Z);var ft=v(Z,2),Dt=o(ft),vt=v(o(Dt),2),Qt=v(o(vt),2),He=o(Qt,!0);n(Qt),n(vt),n(Dt);var je=v(Dt,2),jt=v(o(je),2),aa=v(o(jt),2),St=o(aa,!0);n(aa),n(jt),n(je);var xt=v(je,2),Pt=v(o(xt),2),ye=v(o(Pt),2),H=o(ye,!0);n(ye),n(Pt),n(xt),n(ft);var qe=v(ft,2),Ct=o(qe),zt=v(o(Ct),2),ua=v(o(zt),2),xe=o(ua,!0);n(ua),n(zt),n(Ct),n(qe);var Te=v(qe,2),ue=o(Te),bt=v(o(ue),2),ht=v(o(bt),2),G=o(ht,!0);n(ht),n(bt),n(ue);var pe=v(ue,2),pt=v(o(pe),2),Rt=v(o(pt),2),ct=o(Rt,!0);n(Rt),n(pt),n(pe),n(Te),$(()=>{w(te,e(b).id),w(Oe,e(b).name),w(ot,e(b).yearLevel),w(Qe,e(b).section),w(et,e(D)),w(He,e(b).email||"Not provided"),w(St,e(b).phone||"Not provided"),w(H,e(b).guardian||"Not provided"),w(xe,e(b).address||"Not provided"),w(G,e(b).birthDate||"Not provided"),w(ct,e(b).age?`${e(b).age} years old`:"Not available")}),h(B,N)};C(tt,B=>{e(p)?B(ve):B($e,!1)})}n(ze),n(se);var Je=v(se,2),Re=v(o(Je),2);Re.__click=[vu,k];var Ze=v(o(Re),2);let st;n(Re);var We=v(Re,2);let nt;var ke=o(We);{var De=B=>{var N=bu();h(B,N)},Ie=B=>{var N=yu(),Z=o(N),be=v(o(Z),2),Fe=v(o(be),2),he=o(Fe,!0);n(Fe),n(be),n(Z);var te=v(Z,2),j=v(o(te),2),K=v(o(j),2),ae=o(K,!0);n(K),n(j),n(te);var Oe=v(te,2),Be=v(o(Oe),2),Ke=v(o(Be),2),Ge=o(Ke,!0);n(Ke),n(Be),n(Oe),n(N),$(()=>{w(he,e(b).academicSummary.adviser),w(ae,e(b).academicSummary.gpa!=="Not available"?`${e(b).academicSummary.gpa}`:"Not available"),w(Ge,e(b).academicSummary.rank!=="Not available"&&e(b).academicSummary.totalStudents!=="Not available"?`${e(b).academicSummary.rank} of ${e(b).academicSummary.totalStudents}`:"Not available")}),h(B,N)};C(ke,B=>{e(p)?B(De):B(Ie,!1)})}n(We),n(Je);var Ee=v(Je,2),ee=v(o(Ee),2);ee.__click=[fu,A];var Ue=v(o(ee),2);let rt;n(ee);var Ye=v(ee,2);let at;var lt=o(Ye);{var O=B=>{var N=wu();h(B,N)},T=B=>{var N=Et(),Z=ut(N);{var be=he=>{var te=Su();Tt(te,21,()=>e(b).subjects,j=>j.id,(j,K)=>{var ae=xu(),Oe=o(ae),Be=o(Oe);n(Oe);var Ke=v(Oe,2),Ge=o(Ke),ot=o(Ge,!0);n(Ge);var gt=v(Ge,2),Yt=o(gt,!0);n(gt),n(Ke),n(ae),$(()=>{as(ae,`border-color: ${e(K).color??""};`),as(Be,`background-color: ${e(K).color??""}20; color: ${e(K).color??""}`),w(ot,e(K).name),w(Yt,e(K).teacher)}),h(j,ae)}),n(te),h(he,te)},Fe=he=>{var te=ku();h(he,te)};C(Z,he=>{e(b).subjects.length>0?he(be):he(Fe,!1)},!0)}h(B,N)};C(lt,B=>{e(p)?B(O):B(T,!1)})}n(Ye),n(Ee);var U=v(Ee,2),de=v(o(U),2),Pe=o(de),Ve=o(Pe),Me=v(o(Ve),2),q=o(Me);q.__click=[pu,I],n(Me),n(Ve),n(Pe),n(de),n(U),$((B,N,Z,be,Fe,he)=>{fe.disabled=e(p),me=oe(Se,1,"material-symbols-outlined collapse-icon",null,me,B),Xe=oe(ze,1,"section-content",null,Xe,N),st=oe(Ze,1,"material-symbols-outlined collapse-icon",null,st,Z),nt=oe(We,1,"section-content",null,nt,be),rt=oe(Ue,1,"material-symbols-outlined collapse-icon",null,rt,Fe),at=oe(Ye,1,"section-content",null,at,he)},[()=>({rotated:e(S)}),()=>({collapsed:e(S)}),()=>({rotated:e(k)}),()=>({collapsed:e(k)}),()=>({rotated:e(A)}),()=>({collapsed:e(A)})]),h(V,L)};C(z,V=>{e(g)?V(R):V(J,!1)})}n(F),h(s,F),Ga(),i()}Is(["click"]);var ar=function(){return ar=Object.assign||function(s){for(var t,a=1,i=arguments.length;a<i;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=t[r]);return s},ar.apply(this,arguments)},Tu=(function(){function s(t,a,i){var r=this;this.endVal=a,this.options=i,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(l){r.startTime||(r.startTime=l);var c=l-r.startTime;r.remaining=r.duration-c,r.useEasing?r.countDown?r.frameVal=r.startVal-r.easingFn(c,0,r.startVal-r.endVal,r.duration):r.frameVal=r.easingFn(c,r.startVal,r.endVal-r.startVal,r.duration):r.frameVal=r.startVal+(r.endVal-r.startVal)*(c/r.duration);var u=r.countDown?r.frameVal<r.endVal:r.frameVal>r.endVal;r.frameVal=u?r.endVal:r.frameVal,r.frameVal=Number(r.frameVal.toFixed(r.options.decimalPlaces)),r.printValue(r.frameVal),c<r.duration?r.rAF=requestAnimationFrame(r.count):r.finalEndVal!==null?r.update(r.finalEndVal):r.options.onCompleteCallback&&r.options.onCompleteCallback()},this.formatNumber=function(l){var c,u,f,p,m=l<0?"-":"";c=Math.abs(l).toFixed(r.options.decimalPlaces);var g=(c+="").split(".");if(u=g[0],f=g.length>1?r.options.decimal+g[1]:"",r.options.useGrouping){p="";for(var y=3,b=0,D=0,S=u.length;D<S;++D)r.options.useIndianSeparators&&D===4&&(y=2,b=1),D!==0&&b%y==0&&(p=r.options.separator+p),b++,p=u[S-D-1]+p;u=p}return r.options.numerals&&r.options.numerals.length&&(u=u.replace(/[0-9]/g,(function(k){return r.options.numerals[+k]})),f=f.replace(/[0-9]/g,(function(k){return r.options.numerals[+k]}))),m+r.options.prefix+u+f+r.options.suffix},this.easeOutExpo=function(l,c,u,f){return u*(1-Math.pow(2,-10*l/f))*1024/1023+c},this.options=ar(ar({},this.defaults),i),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof t=="string"?document.getElementById(t):t,a=a??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(a),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,t):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return r.handleScroll(r)})),window.onscroll=function(){window.onScrollFns.forEach((function(l){return l()}))},this.handleScroll(this)))}return s.prototype.handleScroll=function(t){if(t&&window&&!t.once){var a=window.innerHeight+window.scrollY,i=t.el.getBoundingClientRect(),r=i.top+window.pageYOffset,l=i.top+i.height+window.pageYOffset;l<a&&l>window.scrollY&&t.paused?(t.paused=!1,setTimeout((function(){return t.start()}),t.options.scrollSpyDelay),t.options.scrollSpyOnce&&(t.once=!0)):(window.scrollY>l||r>a)&&!t.paused&&t.reset()}},s.prototype.determineDirectionAndSmartEasing=function(){var t=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>t;var a=t-this.startVal;if(Math.abs(a)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=t;var i=this.countDown?1:-1;this.endVal=t+i*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=t,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},s.prototype.start=function(t){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),t&&(this.options.onCompleteCallback=t),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},s.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},s.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},s.prototype.update=function(t){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(t),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},s.prototype.printValue=function(t){var a;if(this.el){var i=this.formattingFn(t);!((a=this.options.plugin)===null||a===void 0)&&a.render?this.options.plugin.render(this.el,i):this.el.tagName==="INPUT"?this.el.value=i:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=i:this.el.innerHTML=i}},s.prototype.ensureNumber=function(t){return typeof t=="number"&&!isNaN(t)},s.prototype.validateValue=function(t){var a=Number(t);return this.ensureNumber(a)?a:(this.error="[CountUp] invalid start or end value: ".concat(t),null)},s.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},s.prototype.parse=function(t){var a=function(c){return c.replace(/([.,' ])/g,"\\$1")},i=a(this.options.separator),r=a(this.options.decimal),l=t.replace(new RegExp(i,"g"),"").replace(new RegExp(r,"g"),".");return parseFloat(l)},s})(),Mu=_('<span class="countup-container svelte-3g4hm4"><!></span>');function qn(s,t){za(t,!1);let a=La(t,"value",8,0),i=La(t,"decimals",8,1),r=La(t,"duration",8,2),l=La(t,"useEasing",8,!0),c=La(t,"useGrouping",8,!0),u=La(t,"separator",8,","),f=La(t,"decimal",8,"."),p=La(t,"prefix",8,""),m=La(t,"suffix",8,""),g=La(t,"startVal",8,0),y=P(),b=P(),D=P(!1),S=P(!1);function k(I,F){return I.toFixed(F).replace(/\.0+$/,"")}Wa(()=>{e(y)&&(Ts(y,e(y).textContent=`${p()}${k(g(),i())}${m()}`),d(D,!0),a()!==g()&&a()>0&&A())});function A(){if(!(!e(y)||!e(D)||e(S)))try{d(b,new Tu(e(y),a(),{startVal:g(),decimalPlaces:i(),duration:r(),useEasing:l(),useGrouping:c(),separator:u(),decimal:f(),prefix:p(),suffix:m(),formattingFn:I=>I.toFixed(i()).replace(/\.0+$/,"")})),e(b).error?(console.error("CountUp error:",e(b).error),Ts(y,e(y).textContent=`${p()}${k(a(),i())}${m()}`)):(e(b).start(),d(S,!0))}catch(I){console.error("Failed to initialize CountUp:",I),Ts(y,e(y).textContent=`${p()}${k(a(),i())}${m()}`)}}Jt(()=>(e(D),xs(a()),xs(g()),e(S)),()=>{e(D)&&a()!==g()&&a()>0&&!e(S)&&A()}),Jt(()=>(e(b),e(S),xs(a()),xs(g()),xs(p()),xs(i()),xs(m())),()=>{if(e(b)&&Ul&&e(S)&&a()!==g())try{e(b).update(a())}catch(I){console.error("CountUp update error:",I),Ts(y,e(y).textContent=`${p()}${k(a(),i())}${m()}`)}}),Ss(),vs();var E=Mu(),M=o(E);C(M,I=>{}),n(E),Pi(E,I=>d(y,I),()=>e(y)),h(s,E),Ga()}var Pu=_("<button> </button>"),Eu=_('<div class="dropdown-menu-quarter"></div>'),Fu=_('<div class="error-container"><span class="material-symbols-outlined error-icon">error</span> <p> </p> <button class="retry-btn"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),Nu=_('<div class="performance-subtitle"> </div>'),Lu=_('<span class="material-symbols-outlined">expand_less</span>'),$u=_('<span class="material-symbols-outlined">expand_more</span>'),ju=_('<div class="analysis-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-analysis-btn">Try Again</button></div>'),Iu=_('<div class="analysis-text"><!></div>'),Ru=_('<div class="analysis-placeholder"><div class="system-loader"></div> Loading Analysis...</div>'),Ou=_('<div class="analysis-content"><!></div>'),qu=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your grades...</p></div>'),Vu=_('<div class="no-subjects"><span class="material-symbols-outlined">school</span> <p> </p> <small>Grades will appear here once they are verified by your teachers</small></div>'),Bu=_('<div class="progress-fill"></div>'),zu=_('<span class="unverified-indicator" title="Grade not yet verified">*</span>'),Gu=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Wu=_('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">edit</span> <span>Written Work</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Hu=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Yu=_('<div class="breakdown-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">assignment</span> <span>Performance Tasks</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Uu=_('<div class="score-item"><span class="score-label"> </span> <span class="score-value"> </span></div>'),Qu=_('<div class="breakdown-category quarterly-assessment-category"><div class="category-header"><div class="category-title"><span class="material-symbols-outlined">quiz</span> <span>Quarterly Assessment</span></div> <div class="category-average"> </div></div> <div class="scores-list"></div></div>'),Ju=_('<div class="grade-breakdown-section"><div class="breakdown-container"><!> <!> <!></div></div>'),Ku=_('<div class="subject-accordion"><div><div class="subject-icon-column"><div class="subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="subject-details-column"><h3 class="subject-name"> </h3> <p> </p> <div class="progress-bar"><!></div></div> <div class="grade-column"><div class="grade-large"><!> <!></div> <div> </div></div></div> <!></div>'),Xu=_('<div class="subjects-grid"></div>'),Zu=_('<div class="performance-card"><div class="performance-header"><div class="performance-title-section"><div class="performance-title-content"><h2 class="performance-title">Academic Performance</h2> <!></div></div></div> <div class="performance-stats"><div class="grade-stat-item primary"><div class="stat-icon"><span class="material-symbols-outlined">star</span></div> <div class="stat-content"><div class="grade-stat-value"><!></div> <div class="stat-label">Overall Average</div></div></div> <div class="grade-stat-item secondary"><div class="stat-icon"><span class="material-symbols-outlined">school</span></div> <div class="stat-content"><div class="grade-stat-value"><!></div> <div class="stat-label">Total Subjects</div></div></div> <div class="grade-stat-item tertiary"><div class="stat-icon"><span class="material-symbols-outlined">crown</span></div> <div class="stat-content"><div class="grade-stat-value">Rank <!></div> <div class="stat-label"> </div></div></div></div></div> <div class="ai-analysis-container"><div class="analysis-header"><h3 class="analysis-title">AI Performance Analysis</h3> <button class="ai-analysis-toggle-btn"><!></button></div> <!></div> <div class="subjects-section"><h2 class="section-title">Subject Performance</h2> <!></div>',1),ev=_('<div class="grades-container"><div class="grades-header"><div class="header-content"><h1 class="page-title">My Grades</h1> <p class="page-subtitle">Academic Performance Overview</p></div> <div class="quarter-selector"><div class="custom-dropdown"><button class="dropdown-button"><span class="material-symbols-outlined">calendar_today</span> <span class="dropdown-text"> </span> <span>expand_more</span></button> <!></div></div></div> <!></div>');function tv(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=P(!0),c=P(null),u=P("2nd Quarter"),f=2,p="2025-2026",m=["1st Quarter","2nd Quarter","3rd Quarter","4th Quarter"],g=P(!1),y=P([]),b=P(0),D=P(0),S=null,k=P(null),A=P(null),E=P(0),M=P(new Set),I=P(""),F=!1,z=P(null),R=P(!1);const J={"1st Quarter":1,"2nd Quarter":2,"3rd Quarter":3,"4th Quarter":4};function V(){d(g,!e(g))}async function L(O){d(u,O),d(g,!1),d(I,""),d(R,!1),d(z,null),await Re()}function X(O){e(g)&&!O.target.closest(".custom-dropdown")&&d(g,!1)}async function ne(){try{const O=await da.get(`/api/student-profile?studentId=${r().userData.id}`);if(O.success){const{section:T,academicSummary:U}=O.data;d(k,T),d(A,U.classRank),d(E,U.totalStudentsInSection)}}catch(O){console.error("Error fetching student profile:",O)}}function ce(O){return O===0||O===null||O===void 0?"var(--grade-no-grade)":O>=85?"var(--grade-excellent)":O>=80?"var(--grade-good)":O>=75?"var(--grade-satisfactory)":(O>=65,"var(--grade-needs-improvement)")}function Le(O,T,U,de){return!T||!U||!de?"N/A":O>0?fe(O):"N/A"}function fe(O){return O==null||O===0?"N/A":O%1===0?O.toString():O.toFixed(1)}function se(O,T,U,de){return!T||!U||!de||O===0?0:Math.min(O/100*100,100)}function re(O){const T=["blue","green","purple","yellow","orange"];return T[O%T.length]}function Se(O){const T=re(O);return{border:`var(--subject-card-${T}-border)`,text:`var(--subject-card-${T}-text)`,icon:`var(--subject-card-${T}-icon)`}}function me(O){return O>=85?"Excellent":O>=80?"Good":O>=75?"Satisfactory":O>=65?"Needs Improvement":"No Grade"}function ze(O){e(M).has(O)?e(M).delete(O):e(M).add(O),d(M,new Set(e(M)))}function Xe(O){return O.verified&&(O.writtenWorkScores&&O.writtenWorkScores.length>0||O.performanceTasksScores&&O.performanceTasksScores.length>0||O.quarterlyAssessmentScores&&O.quarterlyAssessmentScores.length>0)}async function tt(){if(!(F||!e(y).length||!r().userData?.id)){F=!0,d(z,null),d(I,""),d(R,!0);try{const O=J[e(u)],T=await fetch("/api/ai-grade-analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:r().userData.id,quarter:O,schoolYear:p})});if(!T.ok)throw new Error("Failed to get AI analysis");F=!1;const U=T.body.getReader(),de=new TextDecoder;for(;;){const{done:Pe,value:Ve}=await U.read();if(Pe)break;const Me=de.decode(Ve,{stream:!0});d(I,e(I)+Me),d(I,e(I))}}catch(O){console.error("AI Analysis Error:",O),d(z,O.message),F=!1}}}function ve(){!e(R)&&!e(I)?tt():d(R,!e(R))}function $e(O,T){return`${{written:"Quiz",performance:"Project",quarterly:"Exam"}[T]||"Task"} ${O+1}`}Wa(async()=>{r().userData?.id?(await Je(),Re(),ne()):(d(c,"Please log in to view your grades"),d(l,!1))});async function Je(){try{const T=await(await fetch("/api/current-quarter")).json();T.success&&T.data&&(f=T.data.currentQuarter,d(u,T.data.quarterName),p=T.data.currentSchoolYear)}catch(O){console.error("Error fetching current quarter/school year:",O)}}async function Re(){try{d(l,!0),d(c,null);const O=J[e(u)],T=await da.get(`/api/student-grades?student_id=${r().userData.id}&quarter=${O}&school_year=${p}`);if(T.success){const{grades:U,statistics:de}=T.data;d(y,U),d(D,de.overallAverage||0),d(b,de.totalSubjects||0),S={name:r().userData.full_name||"Student",id:r().userData.id}}else d(c,T.error||"Failed to fetch grades")}catch(O){console.error("Error fetching grades:",O),d(c,"Unable to load grades. Please try again.")}finally{d(l,!1)}}vs();var Ze=ev();Q("click",Ys,X);var st=o(Ze),We=v(o(st),2),nt=o(We),ke=o(nt),De=v(o(ke),2),Ie=o(De,!0);n(De);var Ee=v(De,2);let ee;n(ke);var Ue=v(ke,2);{var rt=O=>{var T=Eu();Tt(T,5,()=>m,Ka,(U,de)=>{var Pe=Pu();let Ve;var Me=o(Pe,!0);n(Pe),$(q=>{Ve=oe(Pe,1,"dropdown-item-quarter",null,Ve,q),w(Me,e(de))},[()=>({active:e(de)===e(u)})]),Q("click",Pe,()=>L(e(de))),h(U,Pe)}),n(T),h(O,T)};C(Ue,O=>{e(g)&&O(rt)})}n(nt),n(We),n(st);var Ye=v(st,2);{var at=O=>{var T=Fu(),U=v(o(T),2),de=o(U);n(U);var Pe=v(U,2);n(T),$(()=>w(de,`Error: ${e(c)??""}`)),Q("click",Pe,Re),h(O,T)},lt=O=>{var T=Zu(),U=ut(T),de=o(U),Pe=o(de),Ve=o(Pe),Me=v(o(Ve),2);{var q=He=>{var je=Nu(),jt=o(je);n(je),$(()=>w(jt,`Grade ${e(k).gradeLevel??""}  ${e(k).name??""}`)),h(He,je)};C(Me,He=>{e(k)&&He(q)})}n(Ve),n(Pe),n(de);var B=v(de,2),N=o(B),Z=v(o(N),2),be=o(Z),Fe=o(be);qn(Fe,{get value(){return e(D)},decimals:1,duration:2.5}),n(be),ia(2),n(Z),n(N);var he=v(N,2),te=v(o(he),2),j=o(te),K=o(j);qn(K,{get value(){return e(b)},decimals:0,duration:2}),n(j),ia(2),n(te),n(he);var ae=v(he,2),Oe=v(o(ae),2),Be=o(Oe),Ke=v(o(Be));qn(Ke,{get value(){return e(A)},decimals:0,duration:2}),n(Be);var Ge=v(Be,2),ot=o(Ge);n(Ge),n(Oe),n(ae),n(B),n(U);var gt=v(U,2),Yt=o(gt),ge=v(o(Yt),2),Qe=o(ge);{var Y=He=>{var je=Lu();h(He,je)},le=He=>{var je=$u();h(He,je)};C(Qe,He=>{e(R)?He(Y):He(le,!1)})}n(ge),n(Yt);var Ce=v(Yt,2);{var et=He=>{var je=Ou(),jt=o(je);{var aa=xt=>{var Pt=ju(),ye=v(o(Pt),2),H=o(ye);n(ye);var qe=v(ye,2);n(Pt),$(()=>w(H,`Failed to generate AI analysis: ${e(z)??""}`)),Q("click",qe,tt),h(xt,Pt)},St=xt=>{var Pt=Et(),ye=ut(Pt);{var H=Ct=>{var zt=Iu(),ua=o(zt);Zc(ua,()=>e(I).replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")),n(zt),h(Ct,zt)},qe=Ct=>{var zt=Ru();h(Ct,zt)};C(ye,Ct=>{e(I)?Ct(H):Ct(qe,!1)},!0)}h(xt,Pt)};C(jt,xt=>{e(z)?xt(aa):xt(St,!1)})}n(je),h(He,je)};C(Ce,He=>{e(R)&&He(et)})}n(gt);var ft=v(gt,2),Dt=v(o(ft),2);{var vt=He=>{var je=qu();h(He,je)},Qt=He=>{var je=Et(),jt=ut(je);{var aa=xt=>{var Pt=Vu(),ye=v(o(Pt),2),H=o(ye);n(ye),ia(2),n(Pt),$(()=>w(H,`No subjects found for ${e(u)??""}`)),h(xt,Pt)},St=xt=>{var Pt=Xu();Tt(Pt,7,()=>e(y),ye=>ye.subject_id||ye.id,(ye,H,qe)=>{const Ct=Ks(()=>Se(e(qe))),zt=Ks(()=>Xe(e(H)));var ua=Ku(),xe=o(ua);let Te;var ue=o(xe),bt=o(ue);n(ue);var ht=v(ue,2),G=o(ht),pe=o(G,!0);n(G);var pt=v(G,2);let Rt;var ct=o(pt,!0);n(pt);var Xt=v(pt,2),ga=o(Xt);{var ba=va=>{var ha=Bu();$((Ot,Pa)=>as(ha,`width: ${Ot??""}%; background-color: ${Pa??""}`),[()=>se(e(H).numericGrade,e(H).teacher!=="No teacher",e(H).numericGrade>0,e(H).verified),()=>ce(e(H).numericGrade)]),h(va,ha)};C(ga,va=>{se(e(H).numericGrade,e(H).teacher!=="No teacher",e(H).numericGrade>0,e(H).verified)>0&&va(ba)})}n(Xt),n(ht);var _a=v(ht,2),ya=o(_a),ta=o(ya);{var yt=va=>{qn(va,{get value(){return e(H).numericGrade},decimals:1,duration:2.5})},Gt=va=>{var ha=ka();$(Ot=>w(ha,Ot),[()=>Le(e(H).numericGrade,e(H).teacher!=="No teacher",e(H).numericGrade>0,e(H).verified)]),h(va,ha)};C(ta,va=>{e(H).numericGrade>0&&e(H).teacher!=="No teacher"&&e(H).verified?va(yt):va(Gt,!1)})}var Lt=v(ta,2);{var Aa=va=>{var ha=zu();h(va,ha)};C(Lt,va=>{e(H).numericGrade>0&&!e(H).verified&&va(Aa)})}n(ya);var Kt=v(ya,2),ca=o(Kt,!0);n(Kt),n(_a),n(xe);var ra=v(xe,2);{var Sa=va=>{var ha=Ju(),Ot=o(ha),Pa=o(Ot);{var Oa=qt=>{var Ut=Wu(),Bt=o(Ut),wt=v(o(Bt),2),fa=o(wt,!0);n(wt),n(Bt);var It=v(Bt,2);Tt(It,5,()=>e(H).writtenWorkScores,Ka,(Zt,ea,Ma)=>{var Ea=Gu(),wa=o(Ea),Da=o(wa,!0);n(wa);var xa=v(wa,2),ja=o(xa,!0);n(xa),n(Ea),$((Qa,W)=>{w(Da,Qa),as(xa,`color: ${W??""}`),w(ja,e(ea))},[()=>$e(Ma,"written"),()=>ce(e(ea))]),h(Zt,Ea)}),n(It),n(Ut),$((Zt,ea)=>{as(wt,`color: ${Zt??""}`),w(fa,ea)},[()=>ce(e(H).writtenWork),()=>fe(e(H).writtenWork)]),h(qt,Ut)};C(Pa,qt=>{e(H).writtenWorkScores&&e(H).writtenWorkScores.length>0&&qt(Oa)})}var Ba=v(Pa,2);{var ie=qt=>{var Ut=Yu(),Bt=o(Ut),wt=v(o(Bt),2),fa=o(wt,!0);n(wt),n(Bt);var It=v(Bt,2);Tt(It,5,()=>e(H).performanceTasksScores,Ka,(Zt,ea,Ma)=>{var Ea=Hu(),wa=o(Ea),Da=o(wa,!0);n(wa);var xa=v(wa,2),ja=o(xa,!0);n(xa),n(Ea),$((Qa,W)=>{w(Da,Qa),as(xa,`color: ${W??""}`),w(ja,e(ea))},[()=>$e(Ma,"performance"),()=>ce(e(ea))]),h(Zt,Ea)}),n(It),n(Ut),$((Zt,ea)=>{as(wt,`color: ${Zt??""}`),w(fa,ea)},[()=>ce(e(H).performanceTasks),()=>fe(e(H).performanceTasks)]),h(qt,Ut)};C(Ba,qt=>{e(H).performanceTasksScores&&e(H).performanceTasksScores.length>0&&qt(ie)})}var Ne=v(Ba,2);{var mt=qt=>{var Ut=Qu(),Bt=o(Ut),wt=v(o(Bt),2),fa=o(wt,!0);n(wt),n(Bt);var It=v(Bt,2);Tt(It,5,()=>e(H).quarterlyAssessmentScores,Ka,(Zt,ea,Ma)=>{var Ea=Uu(),wa=o(Ea),Da=o(wa,!0);n(wa);var xa=v(wa,2),ja=o(xa,!0);n(xa),n(Ea),$((Qa,W)=>{w(Da,Qa),as(xa,`color: ${W??""}`),w(ja,e(ea))},[()=>$e(Ma,"quarterly"),()=>ce(e(ea))]),h(Zt,Ea)}),n(It),n(Ut),$((Zt,ea)=>{as(wt,`color: ${Zt??""}`),w(fa,ea)},[()=>ce(e(H).quarterlyAssessment),()=>fe(e(H).quarterlyAssessment)]),h(qt,Ut)};C(Ne,qt=>{e(H).quarterlyAssessmentScores&&e(H).quarterlyAssessmentScores.length>0&&qt(mt)})}n(Ot),n(ha),h(va,ha)};C(ra,va=>{e(M).has(e(H).id)&&va(Sa)})}n(ua),$((va,ha,Ot,Pa,Oa)=>{Te=oe(xe,1,"subject-card",null,Te,va),as(xe,`border: 2px solid ${e(Ct).border??""};`),$t(xe,"role",e(zt)?"button":void 0),as(bt,`color: ${e(Ct).icon??""};`),as(G,`color: ${e(Ct).text??""};`),w(pe,e(H).name),Rt=oe(pt,1,"teacher-name",null,Rt,ha),w(ct,e(H).teacher),as(ya,`color: ${Ot??""}`),oe(Kt,1,`grade-indicator ${Pa??""}`),w(ca,Oa)},[()=>({clickable:e(zt)}),()=>({"no-teacher":e(H).teacher==="No teacher"}),()=>ce(e(H).numericGrade),()=>me(e(H).numericGrade).color,()=>me(e(H).numericGrade).text]),Q("click",xe,function(...va){(e(zt)?()=>ze(e(H).id):void 0)?.apply(this,va)}),Q("keydown",xe,function(...va){(e(zt)?ha=>ha.key==="Enter"&&ze(e(H).id):void 0)?.apply(this,va)}),h(ye,ua)}),n(Pt),h(xt,Pt)};C(jt,xt=>{e(y).length===0?xt(aa):xt(St,!1)},!0)}h(He,je)};C(Dt,He=>{e(l)?He(vt):He(Qt,!1)})}n(ft),$(He=>{as(be,`color: ${He??""}`),w(ot,`Out of ${e(E)??""} Students`),$t(ge,"title",e(R)?"Hide AI Analysis":"Get AI Analysis")},[()=>ce(e(D))]),Q("click",ge,ve),h(O,T)};C(Ye,O=>{e(c)?O(at):O(lt,!1)})}n(Ze),$(O=>{w(Ie,e(u)),ee=oe(Ee,1,"material-symbols-outlined dropdown-arrow",null,ee,O)},[()=>({rotated:e(g)})]),Q("click",ke,V),h(s,Ze),Ga(),i()}const av=300*1e3,sv="student_schedule_";function iv(){const s={scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,currentStudentId:null},{subscribe:t,set:a,update:i}=vi(s);function r(A){return`${sv}${A}`}function l(A){return!A||!A.timestamp?!1:Date.now()-A.timestamp<av}function c(A){try{const E=r(A),M=localStorage.getItem(E);if(M){const I=JSON.parse(M);if(l(I))return I.data}}catch(E){console.warn("Failed to retrieve cached student schedule data:",E)}return null}function u(A,E){try{const M=r(A),I={data:E,timestamp:Date.now()};localStorage.setItem(M,JSON.stringify(I))}catch(M){console.warn("Failed to cache student schedule data:",M)}}const f={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},p=["blue","green","purple","yellow","orange"];function m(A){return p[A%p.length]}function g(A){const[E,M]=A.split(":"),I=parseInt(E),F=I>=12?"PM":"AM";return`${(I===0?12:I>12?I-12:I).toString().padStart(2,"0")}:${M} ${F}`}function y(A){const E={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},M={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return A.forEach(I=>{const F=f[I.day_of_week.toLowerCase()];if(F){const z=g(I.start_time),R=g(I.end_time);let J,V;I.schedule_type==="subject"?(J=I.subject_name||"Unknown Subject",V=I.teacher_name||"No Teacher Assigned"):I.schedule_type==="activity"&&(J=I.activity_type_name||"Activity",V=I.teacher_name||"");const L={name:J,time:`${z} - ${R}`,room:I.room_name||"TBA",teacher:V,scheduleType:I.schedule_type,color:m(M[F])};E[F].push(L),M[F]++}}),E}async function b(A,E=!1){try{i(V=>({...V,isLoading:!E,isRefreshing:E,error:null,currentStudentId:A}));const F=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",R=await(await fetch(`/api/schedules?action=student-schedules&studentId=${A}&schoolYear=${F}`)).json();if(!R.success)throw new Error(R.error||"Failed to fetch schedule data");const J=y(R.data);i(V=>({...V,scheduleData:J,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:new Date().toISOString()})),u(A,{scheduleData:J,lastUpdated:new Date().toISOString()})}catch(M){console.error("Error loading student schedule:",M),i(I=>({...I,isLoading:!1,isRefreshing:!1,error:M.message,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}}))}}function D(A){const E=c(A);return E?(i(M=>({...M,...E,currentStudentId:A,isLoading:!1,isRefreshing:!1,error:null})),!0):(i(M=>({...M,currentStudentId:A,isLoading:!0,isRefreshing:!1,error:null})),!1)}function S(A){try{const E=r(A);localStorage.removeItem(E)}catch(E){console.warn("Failed to clear student schedule cache:",E)}return i(E=>({...s,currentStudentId:A,isLoading:!0})),k.loadSchedule(A,!1)}const k={subscribe:t,init:D,loadSchedule:b,forceRefresh:S,getCachedData:A=>c(A)};return k}const cn=iv();var nv=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),rv=_("<button> </button>"),ov=_('<div class="schedule-dropdown-menu"></div>'),lv=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),cv=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p>Error Loading Schedule</p> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),dv=_('<div class="class-teacher"><span class="material-symbols-outlined">person_book</span> <span> </span></div>'),uv=_('<div><div class="class-header"><h3 class="class-name"> </h3> <span class="class-time"> </span></div> <div class="class-details"><div class="class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!></div></div>'),vv=_('<div class="classes-list"></div>'),fv=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),pv=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-header"><div class="schedule-header-content"><div class="schedule-header-text"><h1 class="page-title">Schedule</h1> <p class="page-subtitle">Your weekly class schedule</p></div></div></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="day-selector"></div> <div class="schedule-mobile-dropdown"><button class="schedule-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function hv(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(cn,"$studentScheduleStore",a),l=()=>ps(ms,"$authStore",a),c=P(),u=P(),f=P(),p=P(),m=P(),g=P(),y=P(),b=new Date,D=["January","February","March","April","May","June","July","August","September","October","November","December"],S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k=D[b.getMonth()],A=b.getDate(),E=S[b.getDay()],M={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},I=b.getDay();let F=P(M[I]||"Mon");async function z(){const ee=l();ee.isAuthenticated&&ee.userData?.id&&await cn.forceRefresh(ee.userData.id)}Wa(()=>{const ee=l();if(ee.isAuthenticated&&ee.userData?.id){const Ue=cn.init(ee.userData.id);cn.loadSchedule(ee.userData.id,Ue);const rt=setInterval(()=>{const Ye=l();Ye.isAuthenticated&&Ye.userData?.id&&cn.loadSchedule(Ye.userData.id,!0)},300*1e3);return()=>{clearInterval(rt)}}});const R=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}],J={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"};let V=P(!1);function L(ee){ee.target.closest(".schedule-mobile-dropdown")||d(V,!1)}function X(){d(V,!e(V))}function ne(ee){d(F,ee),d(V,!1)}Jt(()=>(e(c),e(u),e(f),e(p),e(m),r()),()=>{(ee=>{d(c,ee.scheduleData),d(u,ee.isLoading),d(f,ee.isRefreshing),d(p,ee.error),d(m,ee.lastUpdated)})(r())}),Jt(()=>(e(c),e(F)),()=>{d(g,e(c)[e(F)]||[])}),Jt(()=>e(F),()=>{d(y,J[e(F)]||"Monday")}),Ss(),vs();var ce=pv(),Le=v(o(ce),2),fe=o(Le),se=o(fe),re=o(se);n(se),n(fe);var Se=v(fe,2);Tt(Se,5,()=>R,Ka,(ee,Ue)=>{let rt=()=>e(Ue).day;var Ye=nv(),at=o(Ye),lt=o(at,!0);n(at);var O=v(at,2),T=o(O,!0);n(O),n(Ye),$(()=>{oe(Ye,1,`day-btn ${rt()===e(F)?"active":""}`),w(lt,rt()),w(T,(rt(),x(()=>J[rt()])))}),Q("click",Ye,()=>ne(rt())),h(ee,Ye)}),n(Se);var me=v(Se,2),ze=o(me),Xe=o(ze),tt=o(Xe,!0);n(Xe);var ve=v(Xe,2);n(ze);var $e=v(ze,2);{var Je=ee=>{var Ue=ov();Tt(Ue,5,()=>R,Ka,(rt,Ye)=>{let at=()=>e(Ye).day;var lt=rv(),O=o(lt,!0);n(lt),$(()=>{oe(lt,1,`schedule-dropdown-item ${at()===e(F)?"selected":""}`),w(O,(at(),x(()=>J[at()])))}),Q("click",lt,()=>ne(at())),h(rt,lt)}),n(Ue),h(ee,Ue)};C($e,ee=>{e(V)&&ee(Je)})}n(me),n(Le);var Re=v(Le,2),Ze=o(Re),st=o(Ze),We=o(st);n(st);var nt=v(st,2),ke=o(nt);n(nt),n(Ze);var De=v(Ze,2);{var Ie=ee=>{var Ue=lv();h(ee,Ue)},Ee=ee=>{var Ue=Et(),rt=ut(Ue);{var Ye=lt=>{var O=cv(),T=v(o(O),4),U=o(T,!0);n(T);var de=v(T,2);n(O),$(()=>w(U,e(p))),Q("click",de,z),h(lt,O)},at=lt=>{var O=Et(),T=ut(O);{var U=Pe=>{var Ve=vv();Tt(Ve,5,()=>e(g),Ka,(Me,q)=>{var B=uv(),N=o(B),Z=o(N),be=o(Z,!0);n(Z);var Fe=v(Z,2),he=o(Fe,!0);n(Fe),n(N);var te=v(N,2),j=o(te),K=v(o(j),2),ae=o(K,!0);n(K),n(j);var Oe=v(j,2);{var Be=Ke=>{var Ge=dv(),ot=v(o(Ge),2),gt=o(ot,!0);n(ot),n(Ge),$(()=>w(gt,(e(q),x(()=>e(q).teacher)))),h(Ke,Ge)};C(Oe,Ke=>{e(q),x(()=>e(q).teacher)&&Ke(Be)})}n(te),n(B),$(()=>{oe(B,1,`class-card ${e(q),x(()=>e(q).color)??""}`),w(be,(e(q),x(()=>e(q).name))),w(he,(e(q),x(()=>e(q).time))),w(ae,(e(q),x(()=>e(q).scheduleType==="activity"?"No room":e(q).room)))}),h(Me,B)}),n(Ve),h(Pe,Ve)},de=Pe=>{var Ve=fv(),Me=v(o(Ve),4),q=o(Me);n(Me),n(Ve),$(()=>w(q,`You don't have any classes scheduled for ${e(y)??""}. Enjoy your free day!`)),h(Pe,Ve)};C(T,Pe=>{e(g),x(()=>e(g).length>0)?Pe(U):Pe(de,!1)},!0)}h(lt,O)};C(rt,lt=>{e(p)?lt(Ye):lt(at,!1)},!0)}h(ee,Ue)};C(De,ee=>{e(u)?ee(Ie):ee(Ee,!1)})}n(Re),n(ce),$(()=>{w(re,`${E??""}, ${k??""} ${A??""}`),w(tt,(e(F),x(()=>J[e(F)]||"Select Day"))),oe(ve,1,`material-symbols-outlined schedule-dropdown-icon ${e(V)?"open":""}`),w(We,`${e(y)??""} Classes`),ke.disabled=e(u)}),Q("click",ze,X),Q("click",ke,z),Q("click",ce,L),Q("keydown",ce,L),h(s,ce),Ga(),i()}var mv=_('<button><div class="doc-dropdown-item-content"><span class="doc-dropdown-item-name"> </span> <span class="doc-dropdown-item-desc"> </span></div></button>'),gv=_('<div class="dropdown-menu-document"></div>'),_v=_('<div class="request-form-section"><div class="form-container"><div class="form-header"><h2 class="form-title">New Document Request</h2> <p class="form-subtitle">Fill out the form below to request a document</p></div> <div class="form-content"><div class="form-group"><label class="form-label" for="document-type-dropdown"><span class="material-symbols-outlined form-icon">description</span> Document Type</label> <div class="custom-dropdown"><button id="document-type-dropdown" class="dropdown-toggle"><span><!></span> <span>expand_more</span></button> <!></div></div> <div class="form-group"><label class="form-label" for="description"><span class="material-symbols-outlined form-icon">edit_note</span> Purpose & Details</label> <textarea id="description" class="form-textarea enhanced" placeholder="Please describe the purpose of your request and any specific requirements..." rows="5"></textarea> <div class="form-help"><span class="material-symbols-outlined help-icon">info</span> Be specific about your needs to help us process your request efficiently</div></div> <div class="document-form-actions"><button class="document-cancel-button">Cancel</button> <button class="submit-button"><!></button></div></div></div></div>'),bv=_('<div class="loading-message"><div class="system-loader"></div> Loading your document requests...</div>'),yv=_('<div class="no-requests-message"><span class="material-symbols-outlined">description</span> <p>No document requests found</p> <p class="subtitle">Start by requesting your first document above</p></div>'),wv=_('<div class="request-footer completed-footer"><span class="footer-info"> </span></div>'),xv=_('<div class="request-footer processing-footer"><span class="footer-info"><!></span></div>'),Sv=_('<div class="request-footer pending-footer"><span class="footer-info">Awaiting review</span> <button class="cancel-request-button"><span class="material-symbols-outlined">close</span> Cancel</button></div>'),kv=_('<div class="request-footer cancelled-footer"><span class="footer-info"> </span></div>'),Dv=_('<div class="request-footer rejected-footer"><span class="footer-info"> </span></div>'),Av=_('<div><div class="request-main-content"><div class="request-status-icon"><span class="material-symbols-outlined"> </span></div> <div class="request-content"><div class="request-header"><div class="request-info"><h3 class="request-title"> </h3> <p class="request-date"> </p></div> <div> </div></div> <p class="request-description"> </p></div></div> <!></div>'),Cv=_('<div class="request-history-grid"></div>'),Tv=_('<div><div class="msg-author"> </div> <div class="msg-text"> </div> <div class="msg-time"> </div></div>'),Mv=_('<div class="no-chat">No messages yet</div>'),Pv=_('<div class="modal-overlay"><div class="details-modal"><header class="modal-header"><h2>Request Details</h2> <button class="modal-close" aria-label="Close"></button></header> <div class="modal-body"><div class="request-id"> </div> <div class="details-grid"><div class="info-box"><div class="info-title"><span class="material-symbols-outlined">description</span> Document Type</div> <div class="info-value"> </div></div> <div class="info-box status-clickable" role="button" tabindex="0"><div class="info-title"><span class="material-symbols-outlined">info</span> Status</div> <div class="info-value status-row"><span> </span></div></div> <div class="info-box"><div class="info-title"><span class="material-symbols-outlined">calendar_today</span> Tentative Date</div> <div class="info-value small-input"> </div></div> <div class="info-box"><div class="info-title"><span class="material-symbols-outlined">payments</span> Payment</div> <div class="payment-row"><div class="payment-amount"> </div> <div class="payment-status"><span> </span> <button class="pay-button"><!></button></div></div></div> <div class="info-box wide"><div class="info-title"><span class="material-symbols-outlined">person</span> Processed By</div> <div class="info-value"> </div></div></div> <div class="purpose-section"><label class="purpose-label">Purpose & Details</label> <textarea readonly="" class="purpose-text purpose-text-aligned"></textarea></div> <div class="chat-section"><h3>Chat</h3> <div class="messages"><!></div> <div class="chat-input-row"><button class="attach" title="Attach"></button> <input class="chat-input" placeholder="Type your message"/> <button class="send" aria-label="Send"></button></div></div></div></div></div>'),Ev=_('<div class="modal-overlay"><div class="process-flow-modal"><header class="modal-header"><h2>Process Status Flow</h2> <button class="modal-close" aria-label="Close"></button></header> <div class="modal-body"><ul class="process-flow-list"><li><span class="swatch yellow"></span><strong>On Hold</strong> - The document is on hold. Wait for the admin to take further action.</li> <li><span class="swatch blue"></span><strong>Verifying</strong> - The document request is currently being verified.</li> <li><span class="swatch orange"></span><strong>For Processing</strong> - The document is in the processing stage.</li> <li><span class="swatch cyan"></span><strong>For Pick Up</strong> - The document is ready and available for pick up.</li> <li><span class="swatch green"></span><strong>Released</strong> - The document has been released to the requester.</li> <li><span class="swatch red"></span><strong>Rejected</strong> - The document request has been rejected. Please check for any issues or contact the admin for more information.</li></ul></div></div></div>'),Fv=_('<div class="document-request-container" role="button" tabindex="0"><div class="document-header"><div class="header-content"><h1 class="page-title">Document Requests</h1> <p class="page-subtitle">Request new documents or check existing requests</p></div></div> <div class="quick-actions-section"><div class="quick-actions-header"><h2 class="section-title">Quick Actions</h2> <p class="section-subtitle">Request new documents or check existing requests</p></div> <button class="request-new-button"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="request-history-section"><h2 class="section-title">Request History</h2> <!></div></div> <!> <!>',1);function Nv(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=P(!1),c=P(""),u=P(""),f=P(!1),p=P(!1),m=P([]),g=P(!0),y=null,b=P(!1),D=P(null),S=P(!1),k=P(!1),A=P("");function E(Ee){Ee.target.closest(".custom-dropdown")||d(p,!1)}function M(){d(p,!e(p))}function I(Ee){d(c,Ee.id),d(p,!1)}const F=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}];async function z(){try{if(d(g,!0),y=null,!r().userData?.id){y="User not authenticated";return}const Ee=await da.get(`/api/document-requests?student_id=${r().userData.id}`);Ee.success?d(m,Ee.data.map(ee=>({...ee,type:ee.type||(F.find(Ue=>Ue.id===ee.document_type)?.name??"Unknown"),requestedDate:ee.requestedDate??ee.created_at??"",tentativeDate:ee.tentativeDate??ee.tentative_date??null,paymentAmount:ee.paymentAmount??ee.amount??120,paymentStatus:ee.paymentStatus??(ee.payment?"paid":"pending"),processedBy:ee.completedByAdmin??ee.adminName??null,purpose:ee.purpose??ee.description??"",messages:ee.messages??ee.chat??[],...ee}))):y=Ee.error||"Failed to fetch document requests"}catch(Ee){console.error("Error fetching document requests:",Ee),y="Failed to load document requests. Please try again."}finally{d(g,!1)}}Wa(()=>{r().userData?.id?z():(y="Please log in to view your document requests",d(g,!1))});async function R(Ee){try{const ee=await da.patch("/api/document-requests",{id:Ee,action:"cancel"});ee.success?d(m,e(m).map(Ue=>Ue.id===Ee?{...Ue,status:"cancelled",cancelledDate:ee.data.cancelledDate}:Ue)):console.error("Failed to cancel request:",ee.error)}catch(ee){console.error("Error cancelling request:",ee)}}function J(){d(l,!e(l)),e(l)?setTimeout(()=>{const Ee=document.querySelector(".request-form-section");Ee&&Ee.scrollIntoView({behavior:"smooth",block:"center"})},100):(d(c,""),d(u,""),d(p,!1))}async function V(){if(!(!e(c)||!e(u).trim())){d(f,!0);try{const Ee=await da.post("/api/document-requests",{student_id:r().userData.id,document_type:e(c),purpose:e(u)});Ee.success?(d(m,[Ee.data,...e(m)]),J()):y=Ee.error||"Failed to submit document request"}catch(Ee){console.error("Error submitting document request:",Ee),y="Failed to submit document request. Please try again."}finally{d(f,!1)}}}function L(Ee){switch(Ee){case"completed":return"check_circle";case"processing":return"sync";case"pending":return"hourglass_empty";case"rejected":return"cancel";case"cancelled":return"block";default:return"help"}}function X(Ee){d(D,{...Ee,paymentAmount:Ee.paymentAmount??120,paymentStatus:Ee.paymentStatus??"pending"}),d(b,!0),d(A,"")}function ne(){d(b,!1),d(D,null)}function ce(){d(k,!0)}function Le(){d(k,!1)}async function fe(Ee){if(Ee?.stopPropagation(),!!e(D)){d(S,!0);try{await new Promise(ee=>setTimeout(ee,900)),d(m,e(m).map(ee=>ee.id===e(D).id?{...ee,paymentStatus:"paid"}:ee)),d(D,{...e(D),paymentStatus:"paid"})}catch(ee){console.error("Payment error",ee)}finally{d(S,!1)}}}async function se(){if(!e(A).trim()||!e(D))return;const Ee={id:Date.now(),author:r().userData?.name??"You",text:e(A).trim(),created_at:new Date().toISOString()};d(D,{...e(D),messages:[...e(D).messages||[],Ee]}),d(m,e(m).map(ee=>ee.id===e(D).id?e(D):ee)),d(A,"")}vs();var re=Fv(),Se=ut(re),me=v(o(Se),2),ze=v(o(me),2),Xe=o(ze),tt=o(Xe,!0);n(Xe);var ve=v(Xe);n(ze),n(me);var $e=v(me,2);{var Je=Ee=>{var ee=_v(),Ue=o(ee),rt=v(o(Ue),2),Ye=o(rt),at=v(o(Ye),2),lt=o(at),O=o(lt),T=o(O);{var U=j=>{var K=ka();$(ae=>w(K,ae),[()=>F.find(ae=>ae.id===e(c))?.name||"Select Document Type"]),h(j,K)},de=j=>{var K=ka("Choose the document you need");h(j,K)};C(T,j=>{e(c)?j(U):j(de,!1)})}n(O);var Pe=v(O,2);n(lt);var Ve=v(lt,2);{var Me=j=>{var K=gv();Tt(K,5,()=>F,Ka,(ae,Oe)=>{var Be=mv(),Ke=o(Be),Ge=o(Ke),ot=o(Ge,!0);n(Ge);var gt=v(Ge,2),Yt=o(gt,!0);n(gt),n(Ke),n(Be),$(()=>{oe(Be,1,`doc-dropdown-item ${e(Oe).id===e(c)?"selected":""}`),w(ot,e(Oe).name),w(Yt,e(Oe).description)}),Q("click",Be,()=>I(e(Oe))),h(ae,Be)}),n(K),h(j,K)};C(Ve,j=>{e(p)&&j(Me)})}n(at),n(Ye);var q=v(Ye,2),B=v(o(q),2);Sn(B),ia(2),n(q);var N=v(q,2),Z=o(N),be=v(Z,2),Fe=o(be);{var he=j=>{var K=ka("Submitting...");h(j,K)},te=j=>{var K=ka("Submit Request");h(j,K)};C(Fe,j=>{e(f)?j(he):j(te,!1)})}n(be),n(N),n(rt),n(Ue),n(ee),$(j=>{oe(Pe,1,`material-symbols-outlined dropdown-icon ${e(p)?"open":""}`),Z.disabled=e(f),be.disabled=j},[()=>!e(c)||!e(u).trim()||e(f)]),Q("click",lt,M),la(B,()=>e(u),j=>d(u,j)),Q("click",Z,J),Q("click",be,V),h(Ee,ee)};C($e,Ee=>{e(l)&&Ee(Je)})}var Re=v($e,2),Ze=v(o(Re),2);{var st=Ee=>{var ee=bv();h(Ee,ee)},We=Ee=>{var ee=Et(),Ue=ut(ee);{var rt=at=>{var lt=yv();h(at,lt)},Ye=at=>{var lt=Cv();Tt(lt,7,()=>e(m),O=>O.id,(O,T,U)=>{var de=Av(),Pe=o(de),Ve=o(Pe),Me=o(Ve),q=o(Me,!0);n(Me),n(Ve);var B=v(Ve,2),N=o(B),Z=o(N),be=o(Z),Fe=o(be,!0);n(be);var he=v(be,2),te=o(he);n(he),n(Z);var j=v(Z,2),K=o(j,!0);n(j),n(N);var ae=v(N,2),Oe=o(ae,!0);n(ae),n(B),n(Pe);var Be=v(Pe,2);{var Ke=ot=>{var gt=wv(),Yt=o(gt),ge=o(Yt);n(Yt),n(gt),$(()=>w(ge,`Completed on ${e(T).completedDate??""}${e(T).completedByAdmin?` by ${e(T).completedByAdmin}`:""}`)),h(ot,gt)},Ge=ot=>{var gt=Et(),Yt=ut(gt);{var ge=Y=>{var le=xv(),Ce=o(le),et=o(Ce);{var ft=vt=>{var Qt=ka();$(()=>w(Qt,`Note${e(T).adminName?` by ${e(T).adminName}`:""}: ${e(T).adminNote??""}`)),h(vt,Qt)},Dt=vt=>{var Qt=ka();$(()=>w(Qt,e(T).adminName?`Being processed by ${e(T).adminName}`:"Processing your request")),h(vt,Qt)};C(et,vt=>{e(T).adminNote?vt(ft):vt(Dt,!1)})}n(Ce),n(le),h(Y,le)},Qe=Y=>{var le=Et(),Ce=ut(le);{var et=Dt=>{var vt=Sv(),Qt=v(o(vt),2);n(vt),Q("click",Qt,Ti(()=>R(e(T).id))),h(Dt,vt)},ft=Dt=>{var vt=Et(),Qt=ut(vt);{var He=jt=>{var aa=kv(),St=o(aa),xt=o(St);n(St),n(aa),$(()=>w(xt,`Cancelled on ${e(T).cancelledDate??""}`)),h(jt,aa)},je=jt=>{var aa=Et(),St=ut(aa);{var xt=Pt=>{var ye=Dv(),H=o(ye),qe=o(H);n(H),n(ye),$(()=>w(qe,`Reason${e(T).adminName?` by ${e(T).adminName}`:""}: ${e(T).rejectionReason??""}`)),h(Pt,ye)};C(St,Pt=>{e(T).status==="rejected"&&Pt(xt)},!0)}h(jt,aa)};C(Qt,jt=>{e(T).status==="cancelled"?jt(He):jt(je,!1)},!0)}h(Dt,vt)};C(Ce,Dt=>{e(T).status==="pending"?Dt(et):Dt(ft,!1)},!0)}h(Y,le)};C(Yt,Y=>{e(T).status==="processing"?Y(ge):Y(Qe,!1)},!0)}h(ot,gt)};C(Be,ot=>{e(T).status==="completed"?ot(Ke):ot(Ge,!1)})}n(de),$(ot=>{oe(de,1,`request-card ${e(T).status??""}`),as(de,`--card-index: ${e(U)+1};`),w(q,ot),w(Fe,e(T).type),w(te,`Requested on ${e(T).requestedDate??""}`),oe(j,1,`student-status-badge status-${e(T).status??""}`),w(K,e(T).status==="completed"?"Completed":e(T).status==="processing"?"Processing":e(T).status==="pending"?"Pending":e(T).status==="rejected"?"Rejected":e(T).status==="cancelled"?"Cancelled":"Unknown"),w(Oe,e(T).purpose)},[()=>L(e(T).status)]),Q("click",de,()=>X(e(T))),h(O,de)}),n(lt),h(at,lt)};C(Ue,at=>{e(m).length===0?at(rt):at(Ye,!1)},!0)}h(Ee,ee)};C(Ze,Ee=>{e(g)?Ee(st):Ee(We,!1)})}n(Re),n(Se);var nt=v(Se,2);{var ke=Ee=>{var ee=Pv(),Ue=o(ee),rt=o(Ue),Ye=v(o(rt),2);n(rt);var at=v(rt,2),lt=o(at),O=o(lt);n(lt);var T=v(lt,2),U=o(T),de=v(o(U),2),Pe=o(de,!0);n(de),n(U);var Ve=v(U,2),Me=v(o(Ve),2),q=o(Me),B=o(q,!0);n(q),n(Me),n(Ve);var N=v(Ve,2),Z=v(o(N),2),be=o(Z,!0);n(Z),n(N);var Fe=v(N,2),he=v(o(Fe),2),te=o(he),j=o(te);n(te);var K=v(te,2),ae=o(K),Oe=o(ae,!0);n(ae);var Be=v(ae,2),Ke=o(Be);{var Ge=je=>{var jt=ka("Processing...");h(je,jt)},ot=je=>{var jt=ka("Pay");h(je,jt)};C(Ke,je=>{e(S)?je(Ge):je(ot,!1)})}n(Be),n(K),n(he),n(Fe);var gt=v(Fe,2),Yt=v(o(gt),2),ge=o(Yt,!0);n(Yt),n(gt),n(T);var Qe=v(T,2),Y=v(o(Qe),2);Sn(Y),n(Qe);var le=v(Qe,2),Ce=v(o(le),2),et=o(Ce);{var ft=je=>{var jt=Et(),aa=ut(jt);Tt(aa,1,()=>e(D).messages,Ka,(St,xt)=>{var Pt=Tv(),ye=o(Pt),H=o(ye,!0);n(ye);var qe=v(ye,2),Ct=o(qe,!0);n(qe);var zt=v(qe,2),ua=o(zt,!0);n(zt),n(Pt),$(xe=>{oe(Pt,1,`chat-message ${e(xt).author===r().userData?.name?"mine":"other"}`),w(H,e(xt).author),w(Ct,e(xt).text),w(ua,xe)},[()=>new Date(e(xt).created_at).toLocaleString()]),h(St,Pt)}),h(je,jt)},Dt=je=>{var jt=Mv();h(je,jt)};C(et,je=>{e(D).messages&&e(D).messages.length?je(ft):je(Dt,!1)})}n(Ce);var vt=v(Ce,2),Qt=v(o(vt),2);sa(Qt);var He=v(Qt,2);n(vt),n(le),n(at),n(Ue),n(ee),$(()=>{w(O,`ID: ${e(D).id??""??""}`),w(Pe,e(D).type),oe(q,1,`status-badge status-${e(D).status??""}`),w(B,e(D).status==="completed"?"Released":e(D).status==="processing"?"Verifying":e(D).status==="pending"?"On Hold":e(D).status==="for_processing"?"For Processing":e(D).status==="for_pickup"?"For Pick Up":e(D).status==="rejected"?"Rejected":e(D).status==="cancelled"?"Cancelled":"Unknown"),w(be,e(D).tentativeDate??"N/A"),w(j,`${e(D).paymentAmount??120??""}`),oe(ae,1,`pill payment-pill ${e(D).paymentStatus==="paid"?"paid":"pending"}`),w(Oe,e(D).paymentStatus==="paid"?"Paid":"Pending"),Be.disabled=e(D).paymentStatus==="paid"||e(S),w(ge,e(D).processedBy?e(D).processedBy:""),Ui(Y,e(D).purpose)}),Q("click",Ye,ne),Q("click",Ve,ce),Q("click",Be,fe),la(Qt,()=>e(A),je=>d(A,je)),Q("keydown",Qt,je=>je.key==="Enter"&&se()),Q("click",He,se),Q("click",Ue,Ti(function(je){Mo.call(this,t,je)})),Q("click",ee,ne),h(Ee,ee)};C(nt,Ee=>{e(b)&&e(D)&&Ee(ke)})}var De=v(nt,2);{var Ie=Ee=>{var ee=Ev(),Ue=o(ee),rt=o(Ue),Ye=v(o(rt),2);n(rt),ia(2),n(Ue),n(ee),Q("click",Ye,Le),Q("click",Ue,Ti(function(at){Mo.call(this,t,at)})),Q("click",ee,Le),h(Ee,ee)};C(De,Ee=>{e(k)&&Ee(Ie)})}$(()=>{ze.disabled=e(g),w(tt,e(l)?"remove":"add"),w(ve,` ${e(l)?"Cancel Request":"Request New Document"}`)}),Q("click",ze,J),Q("click",Se,E),Q("keydown",Se,E),h(s,re),Ga(),i()}var Lv=_('<span class="count-badge"> </span>'),$v=_('<button><span class="material-symbols-outlined"> </span> <span> </span> <!></button>'),jv=_('<div class="filter-dropdown-menu"></div>'),Iv=_('<button class="notifications-action-btn mark-all-read" title="Mark All Read"><span class="material-symbols-outlined">done_all</span></button>'),Rv=_('<button class="notifications-action-btn clear-read" title="Clear Read"><span class="material-symbols-outlined">clear_all</span></button>'),Ov=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading notifications...</p></div>'),qv=_('<div class="error-state"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Notifications</h3> <p> </p> <button class="retry-btn">Reload</button></div>'),Vv=_('<div class="admin-note"><span class="material-symbols-outlined">note</span> <div class="note-content"><span class="note-label">Admin Note:</span> <span class="note-text"> </span></div></div>'),Bv=_('<div class="rejection-reason"><span class="material-symbols-outlined">error</span> <div class="reason-content"><span class="reason-label">Rejection Reason:</span> <span class="reason-text"> </span></div></div>'),zv=_("<!> <!>",1),Gv=_('<div><div class="notification-header-card"><h3 class="notification-title"> </h3> <span class="notification-time"> </span></div> <div class="notification-details"><div class="notification-content"><p class="notification-message"> </p> <!></div> <div class="notification-actions"><button class="action-btn-small read-toggle"><span class="material-symbols-outlined"> </span></button> <button class="action-btn-small delete-btn" title="Delete notification"><span class="material-symbols-outlined">delete</span></button></div></div></div>'),Wv=_('<div class="notifications-list"></div>'),Hv=_('<div class="no-notifications"><div class="no-notifications-icon"><span class="material-symbols-outlined"> </span></div> <h3> </h3> <p> </p></div>'),Yv=_('<div class="notification-container"><div class="notification-header"><div class="header-content"><h1 class="page-title">Notifications</h1> <p class="page-subtitle">Stay updated with your academic activities <span class="notification-badge"> </span></p></div></div> <div class="filter-actions-section"><div class="filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="actions-section"><!> <!></div></div> <div class="notifications-section"><!></div></div>');function Uv(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a),l=P();let c=P([]),u=P(!0),f=P(null),p=P(0),m=0;const g=[{value:"all",label:"All Notifications",icon:"notifications"},{value:"unread",label:"Unread Only",icon:"mark_email_unread"},{value:"todo",label:"To-Do Due Dates",icon:"assignment"},{value:"grade",label:"Grades",icon:"grade"},{value:"document",label:"Document Requests",icon:"description"}];let y=P("all"),b=P(!1);function D(){d(b,!e(b))}function S(O){d(y,O),d(b,!1),J()}function k(O){O.target.closest(".filter-dropdown")||d(b,!1)}function A(O){const T=e(c).find(U=>U.id===O);T?V(O,!T.isRead):console.warn("Notification not found for toggle:",O)}function E(O){L(O)}function M(){X()}function I(){ne()}function F(O){const T=new Date(O),U=new Date,de=Math.floor((U-T)/(1e3*60*60));if(de<1){const Pe=Math.floor((U-T)/6e4);return Pe<=1?"Just now":`${Pe} minutes ago`}else{if(de<24)return`${de} hour${de>1?"s":""} ago`;{const Pe=Math.floor(de/24);return Pe<7?`${Pe} day${Pe>1?"s":""} ago`:T.toLocaleDateString("en-US",{month:"short",day:"numeric",year:T.getFullYear()!==U.getFullYear()?"numeric":void 0})}}}function z(O){const T=g.find(U=>U.value===O);return T?T.label:"All Notifications"}function R(O){const T=g.find(U=>U.value===O);return T?T.icon:"notifications"}async function J(){try{d(u,!0),d(f,null);const O=r().userData;if(console.log("Auth store userData:",O),!O?.id)throw new Error("User not authenticated");const T=new URLSearchParams({student_id:O.id,...e(y)!=="all"&&e(y)!=="unread"&&{type:e(y)},...e(y)==="unread"&&{is_read:"false"}});console.log("Fetching notifications with params:",T.toString());const U=await bs(`/api/notifications?${T}`);if(!U.ok)throw new Error(`Failed to fetch notifications: ${U.status}`);const de=await U.json();console.log("API response data:",de);const Pe=de.data||de;d(c,Pe.notifications||[]),console.log("Transformed notifications:",e(c)),d(p,Pe.unreadCount||0),m=Pe.pagination?.total||e(c).length}catch(O){console.error("Error fetching notifications:",O),d(f,O.message),d(c,[])}finally{d(u,!1)}}async function V(O,T){try{if(!r().userData?.id)throw new Error("User not authenticated");const de=await bs("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O,action:T?"mark_read":"mark_unread"})});if(!de.ok)throw new Error(`Failed to update notification: ${de.status}`);d(c,e(c).map(Pe=>Pe.id===O?{...Pe,isRead:T}:Pe)),T?d(p,Math.max(0,e(p)-1)):d(p,e(p)+1)}catch(U){console.error("Error updating notification status:",U),d(f,U.message)}}async function L(O){try{if(!r().userData?.id)throw new Error("User not authenticated");const U=await bs("/api/notifications",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O})});if(!U.ok)throw new Error(`Failed to delete notification: ${U.status}`);const de=e(c).find(Pe=>Pe.id===O);d(c,e(c).filter(Pe=>Pe.id!==O)),de&&!de.isRead&&d(p,Math.max(0,e(p)-1)),m=Math.max(0,m-1)}catch(T){console.error("Error deleting notification:",T),d(f,T.message)}}async function X(){try{if(!r().userData?.id)throw new Error("User not authenticated");const T=await bs("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"mark_all_read"})});if(!T.ok)throw new Error(`Failed to mark all as read: ${T.status}`);d(c,e(c).map(U=>({...U,isRead:!0}))),d(p,0)}catch(O){console.error("Error marking all as read:",O),d(f,O.message)}}async function ne(){try{if(!r().userData?.id)throw new Error("User not authenticated");const T=await bs("/api/notifications",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"delete_read"})});if(!T.ok)throw new Error(`Failed to clear read notifications: ${T.status}`);const U=e(c).filter(de=>de.isRead).length;d(c,e(c).filter(de=>!de.isRead)),m=Math.max(0,m-U)}catch(O){console.error("Error clearing read notifications:",O),d(f,O.message)}}Wa(()=>{r().userData?.id&&J()}),Jt(()=>(e(c),e(y)),()=>{d(l,Array.isArray(e(c))?e(y)==="all"?e(c):e(y)==="unread"?e(c).filter(O=>!O.isRead):e(c).filter(O=>O.type===e(y)):[])}),Ss(),vs();var ce=Yv();Q("click",Ys,k);var Le=o(ce),fe=o(Le),se=v(o(fe),2),re=v(o(se)),Se=o(re);n(re),n(se),n(fe),n(Le);var me=v(Le,2),ze=o(me),Xe=o(ze),tt=o(Xe),ve=o(tt),$e=o(ve),Je=o($e,!0);n($e);var Re=v($e,2),Ze=o(Re,!0);n(Re),n(ve);var st=v(ve,2);let We;n(tt);var nt=v(tt,2);{var ke=O=>{var T=jv();Tt(T,5,()=>g,Ka,(U,de)=>{var Pe=$v();let Ve;var Me=o(Pe),q=o(Me,!0);n(Me);var B=v(Me,2),N=o(B,!0);n(B);var Z=v(B,2);{var be=Fe=>{var he=Lv(),te=o(he,!0);n(he),$(()=>w(te,e(p))),h(Fe,he)};C(Z,Fe=>{e(de),x(()=>e(de).value==="unread")&&Fe(be)})}n(Pe),$(Fe=>{Ve=oe(Pe,1,"filter-dropdown-item",null,Ve,Fe),w(q,(e(de),x(()=>e(de).icon))),w(N,(e(de),x(()=>e(de).label)))},[()=>({active:e(de).value===e(y)})]),Q("click",Pe,()=>S(e(de).value)),h(U,Pe)}),n(T),h(O,T)};C(nt,O=>{e(b)&&O(ke)})}n(Xe),n(ze);var De=v(ze,2),Ie=o(De);{var Ee=O=>{var T=Iv();Q("click",T,M),h(O,T)};C(Ie,O=>{e(p)>0&&O(Ee)})}var ee=v(Ie,2);{var Ue=O=>{var T=Rv();Q("click",T,I),h(O,T)};C(ee,O=>{e(c),x(()=>e(c).some(T=>T.isRead))&&O(Ue)})}n(De),n(me);var rt=v(me,2),Ye=o(rt);{var at=O=>{var T=Ov();h(O,T)},lt=O=>{var T=Et(),U=ut(T);{var de=Ve=>{var Me=qv(),q=v(o(Me),4),B=o(q,!0);n(q);var N=v(q,2);n(Me),$(()=>w(B,e(f))),Q("click",N,J),h(Ve,Me)},Pe=Ve=>{var Me=Et(),q=ut(Me);{var B=Z=>{var be=Wv();Tt(be,7,()=>e(l),Fe=>Fe.id,(Fe,he,te)=>{var j=Gv(),K=o(j),ae=o(K),Oe=o(ae,!0);n(ae);var Be=v(ae,2),Ke=o(Be,!0);n(Be),n(K);var Ge=v(K,2),ot=o(Ge),gt=o(ot),Yt=o(gt,!0);n(gt);var ge=v(gt,2);{var Qe=Dt=>{var vt=zv(),Qt=ut(vt);{var He=aa=>{var St=Vv(),xt=v(o(St),2),Pt=v(o(xt),2),ye=o(Pt,!0);n(Pt),n(xt),n(St),$(()=>w(ye,(e(he),x(()=>e(he).adminNote)))),h(aa,St)};C(Qt,aa=>{e(he),x(()=>e(he).adminNote)&&aa(He)})}var je=v(Qt,2);{var jt=aa=>{var St=Bv(),xt=v(o(St),2),Pt=v(o(xt),2),ye=o(Pt,!0);n(Pt),n(xt),n(St),$(()=>w(ye,(e(he),x(()=>e(he).rejectionReason)))),h(aa,St)};C(je,aa=>{e(he),x(()=>e(he).rejectionReason)&&aa(jt)})}h(Dt,vt)};C(ge,Dt=>{e(he),x(()=>e(he).type==="document_request")&&Dt(Qe)})}n(ot);var Y=v(ot,2),le=o(Y),Ce=o(le),et=o(Ce,!0);n(Ce),n(le);var ft=v(le,2);n(Y),n(Ge),n(j),$(Dt=>{oe(j,1,`notification-card ${e(he),x(()=>e(he).isRead?"read":"unread")??""}`),as(j,`--card-index: ${e(te)??""}`),w(Oe,(e(he),x(()=>e(he).title))),w(Ke,Dt),w(Yt,(e(he),x(()=>e(he).message))),$t(le,"title",(e(he),x(()=>e(he).isRead?"Mark as unread":"Mark as read"))),w(et,(e(he),x(()=>e(he).isRead?"mark_email_unread":"mark_email_read")))},[()=>(e(he),x(()=>F(e(he).timestamp)))]),Q("click",le,()=>A(e(he).id)),Q("click",ft,()=>E(e(he).id)),h(Fe,j)}),n(be),h(Z,be)},N=Z=>{var be=Hv(),Fe=o(be),he=o(Fe),te=o(he,!0);n(he),n(Fe);var j=v(Fe,2),K=o(j,!0);n(j);var ae=v(j,2),Oe=o(ae,!0);n(ae),n(be),$(Be=>{w(te,e(y)==="unread"?"mark_email_read":"notifications_off"),w(K,e(y)==="unread"?"All Caught Up!":"No Notifications"),w(Oe,Be)},[()=>(e(y),x(()=>e(y)==="unread"?"You have no unread notifications. Great job staying on top of things!":e(y)==="all"?"You don't have any notifications yet.":`No ${z(e(y)).toLowerCase()} notifications found.`))]),h(Z,be)};C(q,Z=>{e(l),x(()=>e(l).length>0)?Z(B):Z(N,!1)},!0)}h(Ve,Me)};C(U,Ve=>{e(f)?Ve(de):Ve(Pe,!1)},!0)}h(O,T)};C(Ye,O=>{e(u)?O(at):O(lt,!1)})}n(rt),n(ce),$((O,T,U)=>{w(Se,`${e(p)??""} unread`),w(Je,O),w(Ze,T),We=oe(st,1,"material-symbols-outlined dropdown-arrow",null,We,U)},[()=>(e(y),x(()=>R(e(y)))),()=>(e(y),x(()=>z(e(y)))),()=>({rotated:e(b)})]),Q("click",tt,D),h(s,ce),Ga(),i()}var Qv=_('<button type="button"><span class="material-symbols-outlined"> </span> <span> </span></button>'),Jv=_('<div class="dropdown-menu-category"></div>'),Kv=_('<button class="clear-date-btn" type="button" title="Clear date"><span class="material-symbols-outlined">close</span></button>'),Xv=_('<div class="day-header"> </div>'),Zv=_('<div class="empty-day"></div>'),ef=_('<button type="button"> </button>'),tf=_('<div class="date-picker-dropdown"><div class="date-picker-header"><button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_left</span></button> <div class="month-year-display"><span class="month-name"> </span> <span class="year-name"> </span></div> <button class="nav-btn" type="button"><span class="material-symbols-outlined">chevron_right</span></button></div> <div class="calendar-grid"><!> <!> <!></div></div>'),af=_('<div class="add-todo-section"><h2 class="section-title">Add New Task</h2> <div class="add-todo-form"><input type="text" placeholder="Enter task title..." class="todo-input"/> <textarea placeholder="Enter description (optional)..." class="todo-input todo-textarea" rows="3"></textarea> <div class="form-row"><div class="form-field"><label class="form-label" for="category-dropdown">Category</label> <div class="custom-dropdown"><button class="dropdown-toggle" id="category-dropdown" type="button"><div class="dropdown-toggle-content"><span class="material-symbols-outlined dropdown-icon-left"> </span> <span class="dropdown-label"> </span></div> <span>expand_more</span></button> <!></div></div> <div class="form-field"><label class="form-label" for="due-date-picker">Due Date (optional)</label> <div class="custom-date-picker"><div class="date-picker-toggle-wrapper"><button class="date-picker-toggle" id="due-date-picker" type="button"><div class="date-picker-toggle-content"><span class="material-symbols-outlined date-picker-icon-left">calendar_today</span> <span class="date-picker-label"> </span></div> <div class="date-picker-actions"><!> <span>expand_more</span></div></button></div> <!></div></div></div> <button class="add-todo-btn"> </button></div></div>'),sf=_('<button class="clear-search-btn"><span class="material-symbols-outlined">close</span></button>'),nf=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),rf=_('<div class="filter-dropdown-menu"></div>'),of=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),lf=_('<div class="filter-dropdown-menu"></div>'),cf=_('<div class="loading-state"><div class="system-loader"></div> <p>Loading todos...</p></div>'),df=_('<div class="error-state"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-btn">Retry</button></div>'),uf=_('<p class="todo-description"> </p>'),vf=_('<div><div class="todo-checkbox"><input type="checkbox"/> <label class="checkbox-label"></label></div> <div class="todo-content"><h3> </h3> <!> <div class="todo-meta"><span class="todo-category"> </span> <span class="todo-due-date"> </span></div></div> <div class="todo-actions"><button class="action-btn todo-delete-btn" title="Delete task"><span class="material-symbols-outlined">delete</span></button></div></div>'),ff=_('<div class="todos-list"></div>'),pf=_('<div class="no-filtered-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">search_off</span></div> <h3>No Matching Tasks</h3> <p>No tasks match your current search or filter criteria.</p> <button class="clear-filters-btn">Clear all filters</button></div>'),hf=_(`<div class="no-todos"><div class="no-todos-icon"><span class="material-symbols-outlined">check_circle</span></div> <h3>No Tasks</h3> <p>You don't have any tasks yet. Add one above to get started!</p></div>`),mf=_('<div class="todo-container"><div class="todo-header"><div class="header-content"><h1 class="page-title">Todo List</h1> <p class="page-subtitle">Keep track of your tasks and assignments <span class="progress-badge"> </span></p></div></div> <div class="add-todo-button-section"><button class="add-todo-toggle-btn"><span class="material-symbols-outlined"> </span> </button></div> <!> <div class="search-filter-section"><div class="search-filter-row"><div class="todo-search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="todo-search-input" placeholder="Search todos by title or description..."/> <!></div> <div class="todo-filter-section"><div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div> <div class="filter-dropdown"><button class="filter-toggle"><div class="filter-toggle-content"><span class="material-symbols-outlined filter-icon"> </span> <span class="filter-label"> </span></div> <span>expand_more</span></button> <!></div></div></div></div> <div class="todos-section"><!></div></div>');function gf(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a),l=P(),c=P(),u=P(),f=P(),p=P(),m=P();let g=P([]),y=P(!1),b=P(!1),D=P(null),S=P(""),k=P("all"),A=P("all"),E=P(!1),M=P(!1),I=P(""),F=P(""),z=P("personal"),R=P(""),J=P(!1);const V=[{value:"all",label:"All Categories",icon:"category"},{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}],L=[{value:"all",label:"All Status",icon:"list"},{value:"pending",label:"Pending",icon:"pending"},{value:"completed",label:"Completed",icon:"check_circle"}],X=[{value:"assignment",label:"Assignment",icon:"assignment"},{value:"study",label:"Study",icon:"book"},{value:"personal",label:"Personal",icon:"person"},{value:"project",label:"Project",icon:"folder"},{value:"exam",label:"Exam",icon:"quiz"}];let ne=P(!1),ce=P(!1);const Le=new Date;let fe=P(Le.getFullYear()),se=P(Le.getMonth());const re=["January","February","March","April","May","June","July","August","September","October","November","December"],Se=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];async function me(){try{d(b,!0),d(D,null);const G=r().userData;if(!G||!G.id)throw new Error("User not authenticated");const pe=await da.get(`/api/student-todos?studentId=${G.id}`);if(pe.success)d(g,pe.data||[]);else throw new Error(pe.error||"Failed to fetch todos")}catch(G){console.error("Error fetching todos:",G),d(D,G.message),Ae.error("Failed to load todos: "+G.message)}finally{d(b,!1)}}async function ze(){try{d(y,!0);const G=r().userData;if(!G||!G.id)throw new Error("User not authenticated");if(!e(I).trim()){Ae.error("Please enter a title for your todo");return}const pe={studentId:G.id,title:e(I).trim(),description:e(F).trim()||null,category:e(z),dueDate:e(R)||null},pt=await da.post("/api/student-todos",pe);if(pt.success)d(g,[pt.data,...e(g)]),Ae.success("Todo added successfully!"),d(I,""),d(F,""),d(z,"personal"),d(R,""),d(J,!1);else throw new Error(pt.error||"Failed to add todo")}catch(G){console.error("Error adding todo:",G),Ae.error("Failed to add todo: "+G.message)}finally{d(y,!1)}}async function Xe(G){try{const pe=r().userData;if(!pe||!pe.id)throw new Error("User not authenticated");const pt=await da.delete("/api/student-todos",{id:G,studentId:pe.id});if(pt.success)d(g,e(g).filter(Rt=>Rt.id!==G)),Ae.success("Todo deleted successfully!");else throw new Error(pt.error||"Failed to delete todo")}catch(pe){console.error("Error deleting todo:",pe),Ae.error("Failed to delete todo: "+pe.message)}}async function tt(G){try{const pe=r().userData;if(!pe||!pe.id)throw new Error("User not authenticated");const pt=await da.put("/api/student-todos",{id:G,studentId:pe.id,action:"toggle"});if(pt.success){d(g,e(g).map(Xt=>Xt.id===G?pt.data:Xt));const ct=pt.data.completed?"Todo marked as completed!":"Todo marked as pending!";Ae.success(ct)}else throw new Error(pt.error||"Failed to update todo")}catch(pe){console.error("Error toggling todo:",pe),Ae.error("Failed to update todo: "+pe.message)}}Wa(()=>{me()});function ve(G){ds.confirm("Delete Task",`Are you sure you want to delete "${G.title}"? This action cannot be undone.`,async()=>{await Xe(G.id)},()=>{})}function $e(){d(J,!e(J)),e(J)||(d(I,""),d(F,""),d(z,"personal"),d(R,""),d(ne,!1),d(ce,!1))}function Je(){d(E,!e(E))}function Re(){d(M,!e(M))}function Ze(G){d(k,G),d(E,!1)}function st(G){d(A,G),d(M,!1)}function We(G){const pe=V.find(pt=>pt.value===G);return pe?pe.label:"All Categories"}function nt(G){const pe=V.find(pt=>pt.value===G);return pe?pe.icon:"category"}function ke(G){const pe=L.find(pt=>pt.value===G);return pe?pe.label:"All Status"}function De(G){const pe=L.find(pt=>pt.value===G);return pe?pe.icon:"list"}function Ie(){d(ne,!e(ne))}function Ee(G){d(z,G),d(ne,!1)}function ee(G){G.target.closest(".custom-dropdown")||d(ne,!1),G.target.closest(".custom-date-picker")||d(ce,!1),G.target.closest(".filter-dropdown")||(d(E,!1),d(M,!1))}Wa(()=>(document.addEventListener("click",ee),r().userData?.id&&me(),()=>{document.removeEventListener("click",ee)}));function Ue(G){const pe=X.find(pt=>pt.value===G);return pe?pe.label:"Select Category"}function rt(G){const pe=X.find(pt=>pt.value===G);return pe?pe.icon:"category"}function Ye(){if(d(ce,!e(ce)),e(ce))if(e(R)){const G=new Date(e(R)+"T00:00:00");d(fe,G.getFullYear()),d(se,G.getMonth()),G.getDate()}else{const G=new Date;d(fe,G.getFullYear()),d(se,G.getMonth())}}function at(G){const pe=e(fe),pt=e(se)+1,Rt=G.toString().padStart(2,"0"),ct=pt.toString().padStart(2,"0");d(R,`${pe}-${ct}-${Rt}`),d(ce,!1)}function lt(){d(R,""),d(ce,!1)}function O(){e(se)===0?(d(se,11),On(fe,-1)):On(se,-1)}function T(){e(se)===11?(d(se,0),On(fe)):On(se)}function U(G,pe){return new Date(G,pe+1,0).getDate()}function de(G,pe){return new Date(G,pe,1).getDay()}function Pe(G){const pe=new Date;return G===pe.getDate()&&e(se)===pe.getMonth()&&e(fe)===pe.getFullYear()}function Ve(G){if(!e(R))return!1;const pe=new Date(e(R)+"T00:00:00");return G===pe.getDate()&&e(se)===pe.getMonth()&&e(fe)===pe.getFullYear()}function Me(G){if(!G||G==="No due date")return"No due date";if(G==="Today"||G==="Tomorrow"||G==="Next Week")return G;const pe=G.split("-");if(pe.length!==3)return G;const pt=parseInt(pe[0]),Rt=parseInt(pe[1])-1,ct=parseInt(pe[2]);if(isNaN(pt)||isNaN(Rt)||isNaN(ct))return G;const Xt=new Date,ga=Xt.getFullYear(),ba=Xt.getMonth(),_a=Xt.getDate();if(pt===ga&&Rt===ba&&ct===_a)return"Today";const ya=new Date(Xt);ya.setDate(ya.getDate()+1);const ta=ya.getFullYear(),yt=ya.getMonth(),Gt=ya.getDate();return pt===ta&&Rt===yt&&ct===Gt?"Tomorrow":new Date(pt,Rt,ct).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}).replace(/^(\w+),/,"$1:")}Jt(()=>(e(g),e(S),e(k),e(A)),()=>{d(l,(()=>{let G=e(g);if(e(S).trim()){const pe=e(S).toLowerCase().trim();G=G.filter(pt=>pt.title.toLowerCase().includes(pe)||pt.description&&pt.description.toLowerCase().includes(pe))}return e(k)!=="all"&&(G=G.filter(pe=>pe.category===e(k))),e(A)!=="all"&&(e(A)==="completed"?G=G.filter(pe=>pe.completed):e(A)==="pending"&&(G=G.filter(pe=>!pe.completed))),G})())}),Jt(()=>e(R),()=>{d(c,e(R)?new Date(e(R)+"T00:00:00").toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).replace(/^(\w+),/,"$1:"):"Select due date")}),Jt(()=>e(g),()=>{d(u,e(g).filter(G=>G.completed).length)}),Jt(()=>e(g),()=>{d(f,e(g).length)}),Jt(()=>e(l),()=>{d(p,e(l).filter(G=>G.completed).length)}),Jt(()=>e(l),()=>{d(m,e(l).length)}),Ss(),vs();var q=mf();Q("click",Ys,ee);var B=o(q),N=o(B),Z=v(o(N),2),be=v(o(Z)),Fe=o(be);n(be),n(Z),n(N),n(B);var he=v(B,2),te=o(he),j=o(te),K=o(j,!0);n(j);var ae=v(j);n(te),n(he);var Oe=v(he,2);{var Be=G=>{var pe=af(),pt=v(o(pe),2),Rt=o(pt);sa(Rt);var ct=v(Rt,2);Sn(ct);var Xt=v(ct,2),ga=o(Xt),ba=v(o(ga),2),_a=o(ba),ya=o(_a),ta=o(ya),yt=o(ta,!0);n(ta);var Gt=v(ta,2),Lt=o(Gt,!0);n(Gt),n(ya);var Aa=v(ya,2);n(_a);var Kt=v(_a,2);{var ca=fa=>{var It=Jv();Tt(It,5,()=>X,Ka,(Zt,ea)=>{var Ma=Qv(),Ea=o(Ma),wa=o(Ea,!0);n(Ea);var Da=v(Ea,2),xa=o(Da,!0);n(Da),n(Ma),$(()=>{oe(Ma,1,`dropdown-item ${e(ea),e(z),x(()=>e(ea).value===e(z)?"selected":"")??""}`),w(wa,(e(ea),x(()=>e(ea).icon))),w(xa,(e(ea),x(()=>e(ea).label)))}),Q("click",Ma,()=>Ee(e(ea).value)),h(Zt,Ma)}),n(It),h(fa,It)};C(Kt,fa=>{e(ne)&&fa(ca)})}n(ba),n(ga);var ra=v(ga,2),Sa=v(o(ra),2),va=o(Sa),ha=o(va),Ot=o(ha),Pa=v(o(Ot),2),Oa=o(Pa,!0);n(Pa),n(Ot);var Ba=v(Ot,2),ie=o(Ba);{var Ne=fa=>{var It=Kv();Q("click",It,Ti(lt)),h(fa,It)};C(ie,fa=>{e(R)&&fa(Ne)})}var mt=v(ie,2);n(Ba),n(ha),n(va);var qt=v(va,2);{var Ut=fa=>{var It=tf(),Zt=o(It),ea=o(Zt),Ma=v(ea,2),Ea=o(Ma),wa=o(Ea,!0);n(Ea);var Da=v(Ea,2),xa=o(Da,!0);n(Da),n(Ma);var ja=v(Ma,2);n(Zt);var Qa=v(Zt,2),W=o(Qa);Tt(W,1,()=>Se,Ka,(Nt,we)=>{var it=Xv(),Mt=o(it,!0);n(it),$(()=>w(Mt,e(we))),h(Nt,it)});var _e=v(W,2);Tt(_e,1,()=>(e(fe),e(se),x(()=>Array(de(e(fe),e(se))))),Ka,(Nt,we)=>{var it=Zv();h(Nt,it)});var dt=v(_e,2);Tt(dt,1,()=>(e(fe),e(se),x(()=>Array(U(e(fe),e(se))))),Ka,(Nt,we,it)=>{const Mt=Ks(()=>it+1);var At=ef(),_t=o(At,!0);n(At),$((Vt,Wt)=>{oe(At,1,`day-cell ${Vt??""} ${Wt??""}`),w(_t,e(Mt))},[()=>(xs(e(Mt)),x(()=>Pe(e(Mt))?"today":"")),()=>(xs(e(Mt)),x(()=>Ve(e(Mt))?"selected":""))]),Q("click",At,()=>at(e(Mt))),h(Nt,At)}),n(Qa),n(It),$(()=>{w(wa,(e(se),x(()=>re[e(se)]))),w(xa,e(fe))}),Q("click",ea,O),Q("click",ja,T),h(fa,It)};C(qt,fa=>{e(ce)&&fa(Ut)})}n(Sa),n(ra),n(Xt);var Bt=v(Xt,2),wt=o(Bt,!0);n(Bt),n(pt),n(pe),$((fa,It,Zt)=>{w(yt,fa),w(Lt,It),oe(Aa,1,`material-symbols-outlined dropdown-icon ${e(ne)?"open":""}`),w(Oa,e(c)),oe(mt,1,`material-symbols-outlined dropdown-icon ${e(ce)?"open":""}`),Bt.disabled=Zt,w(wt,e(y)?"Adding...":"Add Task")},[()=>(e(z),x(()=>rt(e(z)))),()=>(e(z),x(()=>Ue(e(z)))),()=>(e(I),e(y),x(()=>!e(I).trim()||e(y)))]),la(Rt,()=>e(I),fa=>d(I,fa)),Q("keydown",Rt,fa=>fa.key==="Enter"&&ze()),la(ct,()=>e(F),fa=>d(F,fa)),Q("click",_a,Ie),Q("click",ha,Ye),Q("click",Bt,ze),h(G,pe)};C(Oe,G=>{e(J)&&G(Be)})}var Ke=v(Oe,2),Ge=o(Ke),ot=o(Ge),gt=v(o(ot),2);sa(gt);var Yt=v(gt,2);{var ge=G=>{var pe=sf();Q("click",pe,()=>d(S,"")),h(G,pe)};C(Yt,G=>{e(S)&&G(ge)})}n(ot);var Qe=v(ot,2),Y=o(Qe),le=o(Y),Ce=o(le),et=o(Ce),ft=o(et,!0);n(et);var Dt=v(et,2),vt=o(Dt,!0);n(Dt),n(Ce);var Qt=v(Ce,2);let He;n(le);var je=v(le,2);{var jt=G=>{var pe=rf();Tt(pe,5,()=>V,Ka,(pt,Rt)=>{var ct=nf();let Xt;var ga=o(ct),ba=o(ga,!0);n(ga);var _a=v(ga,2),ya=o(_a,!0);n(_a),n(ct),$(ta=>{Xt=oe(ct,1,"filter-dropdown-item",null,Xt,ta),w(ba,(e(Rt),x(()=>e(Rt).icon))),w(ya,(e(Rt),x(()=>e(Rt).label)))},[()=>({active:e(Rt).value===e(k)})]),Q("click",ct,()=>Ze(e(Rt).value)),h(pt,ct)}),n(pe),h(G,pe)};C(je,G=>{e(E)&&G(jt)})}n(Y);var aa=v(Y,2),St=o(aa),xt=o(St),Pt=o(xt),ye=o(Pt,!0);n(Pt);var H=v(Pt,2),qe=o(H,!0);n(H),n(xt);var Ct=v(xt,2);let zt;n(St);var ua=v(St,2);{var xe=G=>{var pe=lf();Tt(pe,5,()=>L,Ka,(pt,Rt)=>{var ct=of();let Xt;var ga=o(ct),ba=o(ga,!0);n(ga);var _a=v(ga,2),ya=o(_a,!0);n(_a),n(ct),$(ta=>{Xt=oe(ct,1,"filter-dropdown-item",null,Xt,ta),w(ba,(e(Rt),x(()=>e(Rt).icon))),w(ya,(e(Rt),x(()=>e(Rt).label)))},[()=>({active:e(Rt).value===e(A)})]),Q("click",ct,()=>st(e(Rt).value)),h(pt,ct)}),n(pe),h(G,pe)};C(ua,G=>{e(M)&&G(xe)})}n(aa),n(Qe),n(Ge),n(Ke);var Te=v(Ke,2),ue=o(Te);{var bt=G=>{var pe=cf();h(G,pe)},ht=G=>{var pe=Et(),pt=ut(pe);{var Rt=Xt=>{var ga=df(),ba=v(o(ga),2),_a=o(ba,!0);n(ba);var ya=v(ba,2);n(ga),$(()=>w(_a,e(D))),Q("click",ya,me),h(Xt,ga)},ct=Xt=>{var ga=Et(),ba=ut(ga);{var _a=ta=>{var yt=ff();Tt(yt,7,()=>e(l),Gt=>Gt.id,(Gt,Lt,Aa)=>{var Kt=vf();let ca;var ra=o(Kt),Sa=o(ra);sa(Sa);var va=v(Sa,2);n(ra);var ha=v(ra,2),Ot=o(ha);let Pa;var Oa=o(Ot,!0);n(Ot);var Ba=v(Ot,2);{var ie=It=>{var Zt=uf(),ea=o(Zt,!0);n(Zt),$(()=>w(ea,(e(Lt),x(()=>e(Lt).description)))),h(It,Zt)};C(Ba,It=>{e(Lt),x(()=>e(Lt).description)&&It(ie)})}var Ne=v(Ba,2),mt=o(Ne),qt=o(mt,!0);n(mt);var Ut=v(mt,2),Bt=o(Ut,!0);n(Ut),n(Ne),n(ha);var wt=v(ha,2),fa=o(wt);n(wt),n(Kt),$((It,Zt,ea)=>{ca=oe(Kt,1,"todo-card",null,ca,It),as(Kt,`--card-index: ${e(Aa)+1};`),ed(Sa,(e(Lt),x(()=>e(Lt).completed))),$t(Sa,"id",`todo-${e(Lt),x(()=>e(Lt).id)??""}`),Sa.disabled=e(b),$t(va,"for",`todo-${e(Lt),x(()=>e(Lt).id)??""}`),Pa=oe(Ot,1,"todo-title",null,Pa,Zt),w(Oa,(e(Lt),x(()=>e(Lt).title))),w(qt,(e(Lt),x(()=>e(Lt).category))),w(Bt,ea),fa.disabled=e(b)},[()=>({completed:e(Lt).completed}),()=>({completed:e(Lt).completed}),()=>(e(Lt),x(()=>Me(e(Lt).dueDate)))]),Q("change",Sa,()=>tt(e(Lt).id)),Q("click",fa,()=>ve(e(Lt))),h(Gt,Kt)}),n(yt),h(ta,yt)},ya=ta=>{var yt=Et(),Gt=ut(yt);{var Lt=Kt=>{var ca=pf(),ra=v(o(ca),6);n(ca),Q("click",ra,()=>{d(S,""),d(k,"all"),d(A,"all")}),h(Kt,ca)},Aa=Kt=>{var ca=hf();h(Kt,ca)};C(Gt,Kt=>{e(g),x(()=>e(g).length>0)?Kt(Lt):Kt(Aa,!1)},!0)}h(ta,yt)};C(ba,ta=>{e(l),x(()=>e(l).length>0)?ta(_a):ta(ya,!1)},!0)}h(Xt,ga)};C(pt,Xt=>{e(D)?Xt(Rt):Xt(ct,!1)},!0)}h(G,pe)};C(ue,G=>{e(b)?G(bt):G(ht,!1)})}n(Te),n(q),$((G,pe,pt,Rt,ct,Xt)=>{w(Fe,`${e(u)??""}/${e(f)??""} completed`),w(K,e(J)?"remove":"add"),w(ae,` ${e(J)?"Cancel":"Add New Task"}`),w(ft,G),w(vt,pe),He=oe(Qt,1,"material-symbols-outlined dropdown-arrow",null,He,pt),w(ye,Rt),w(qe,ct),zt=oe(Ct,1,"material-symbols-outlined dropdown-arrow",null,zt,Xt)},[()=>(e(k),x(()=>nt(e(k)))),()=>(e(k),x(()=>We(e(k)))),()=>({rotated:e(E)}),()=>(e(A),x(()=>De(e(A)))),()=>(e(A),x(()=>ke(e(A)))),()=>({rotated:e(M)})]),Q("click",te,$e),la(gt,()=>e(S),G=>d(S,G)),Q("click",le,Je),Q("click",St,Re),h(s,q),Ga(),i()}function _f(s,t){d(t,!e(t))}function bf(s,t,a){d(t,!e(t)),a()}var yf=_('<img alt="Profile" class="avatar-image"/>'),wf=_('<div class="avatar-placeholder"> </div>'),xf=(s,t,a)=>{t(),a.onnavigate("profile")},Sf=async(s,t,a)=>{t(),await a.onlogout(),bi("Logged out successfully. See you next time!")},kf=_('<div class="teacher-navbar-dropdown-menu"><button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">person</span> Profile</button> <button class="teacher-navbar-dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Df=_('<nav class="teacher-navbar" role="navigation" aria-label="Teacher navigation"><div class="teacher-navbar-container"><div class="teacher-navbar-left"><button class="teacher-navbar-icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">person_book</span> <span class="app-title"> </span></div></div> <div class="teacher-navbar-right"><button class="teacher-navbar-icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="teacher-navbar-user-profile"><div class="teacher-navbar-user-info"><span class="teacher-navbar-user-name"> </span> <span class="user-id"> </span></div> <div class="teacher-navbar-user-avatar"><!></div></button> <!></div></div></div></nav>');function Af(s,t){za(t,!0);let a=La(t,"teacherName",3,"John Does"),i=La(t,"firstName",3,"John"),r=La(t,"gender",3,"male"),l=La(t,"accountNumber",3,"TCH-2025-0001"),c=La(t,"profileImage",3,null);function u(ve){return ve==="female"?"Ms.":"Mr."}let f=Ra(()=>`${u(r())} ${i()}`),p=kt(!0),m=kt(!1);function g(){d(m,!1)}function y(ve){e(m)&&!ve.target.closest(".user-profile-container")&&g()}Wa(()=>{const ve=localStorage.getItem("theme");return d(p,ve!=="light"),b(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}});function b(){e(p)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function D(ve){return ve.split(" ").map($e=>$e.charAt(0)).join("").toUpperCase().slice(0,2)}var S=Df(),k=o(S),A=o(k),E=o(A);E.__click=function(...ve){t.onToggleNavRail?.apply(this,ve)};var M=v(E,2),I=v(o(M),2),F=o(I);n(I),n(M),n(A);var z=v(A,2),R=o(z);R.__click=[bf,p,b];var J=o(R),V=o(J,!0);n(J),n(R);var L=v(R,2),X=o(L);X.__click=[_f,m];var ne=o(X),ce=o(ne),Le=o(ce,!0);n(ce);var fe=v(ce,2),se=o(fe);n(fe),n(ne);var re=v(ne,2),Se=o(re);{var me=ve=>{var $e=yf();$(()=>$t($e,"src",c())),h(ve,$e)},ze=ve=>{var $e=wf(),Je=o($e,!0);n($e),$(Re=>w(Je,Re),[()=>D(i())]),h(ve,$e)};C(Se,ve=>{c()?ve(me):ve(ze,!1)})}n(re),n(X);var Xe=v(X,2);{var tt=ve=>{var $e=kf(),Je=o($e);Je.__click=[xf,g,t];var Re=v(Je,2);Re.__click=[Sf,g,t],n($e),h(ve,$e)};C(Xe,ve=>{e(m)&&ve(tt)})}n(L),n(z),n(k),n(S),$(()=>{w(F,`Welcome, ${e(f)??""}`),w(V,e(p)?"light_mode":"dark_mode"),w(Le,a()),w(se,`Account: ${l()??""}`)}),h(s,S),Ga()}Is(["click"]);var Cf=(s,t,a)=>t(e(a).id),Tf=_('<button><div class="teacher-menu-rail-icon-container"><span class="material-symbols-outlined teacher-menu-rail-icon"> </span></div> <span class="teacher-menu-rail-label"> </span></button>'),Mf=(s,t,a)=>t(e(a).id),Pf=_('<button><div class="teacher-menu-nav-icon-container"><span class="material-symbols-outlined teacher-menu-nav-icon"> </span></div></button>'),Ef=_('<nav aria-label="Teacher portal navigation"><div class="teacher-menu-rail-container"></div></nav> <nav class="teacher-menu-bottom-navigation" aria-label="Teacher portal navigation"><div class="teacher-menu-nav-container"></div></nav>',1);function Ff(s,t){za(t,!0);let a=La(t,"teacherActiveSection",15,"schedule"),i=La(t,"teacherNavRailVisible",3,!0);const r=[{id:"schedule",label:"Schedule",icon:"schedule"},{id:"students",label:"Class Management",icon:"group"},{id:"advisory",label:"Advisory Class",icon:"supervisor_account"}];let l=kt(!1),c=kt(!1);Xs(()=>{t.teacherId&&!e(c)&&u()});async function u(){try{const k=await da.get(`/api/teacher-advisory?teacher_id=${t.teacherId}`);d(l,k.success&&k.data.advisoryData!==null,!0)}catch(k){console.error("Error checking advisory status:",k),d(l,!1)}finally{d(c,!0)}}let f=Ra(()=>r.filter(k=>k.id!=="advisory"||e(l)));function p(k){a(k),t.onnavigate&&t.onnavigate({detail:{section:k}})}var m=Ef(),g=ut(m);let y;var b=o(g);Tt(b,21,()=>e(f),k=>k.id,(k,A)=>{var E=Tf();let M;E.__click=[Cf,p,A];var I=o(E),F=o(I),z=o(F,!0);n(F),n(I);var R=v(I,2),J=o(R,!0);n(R),n(E),$(V=>{M=oe(E,1,"teacher-menu-rail-item",null,M,V),$t(E,"aria-label",e(A).label),$t(E,"aria-current",e(A).id===a()?"page":void 0),w(z,e(A).icon),w(J,e(A).label)},[()=>({active:e(A).id===a()})]),h(k,E)}),n(b),n(g);var D=v(g,2),S=o(D);Tt(S,21,()=>e(f),k=>k.id,(k,A)=>{var E=Pf();let M;E.__click=[Mf,p,A];var I=o(E),F=o(I),z=o(F,!0);n(F),n(I),n(E),$(R=>{M=oe(E,1,"teacher-menu-nav-item",null,M,R),$t(E,"aria-label",e(A).label),$t(E,"aria-current",e(A).id===a()?"page":void 0),w(z,e(A).icon)},[()=>({active:e(A).id===a()})]),h(k,E)}),n(S),n(D),$(k=>y=oe(g,1,"teacher-menu-navigation-rail",null,y,k),[()=>({collapsed:!i()})]),h(s,m),Ga()}Is(["click"]);const Yr="teacherProfileCache",Nf=300*1e3;function Lf(){const{subscribe:s,set:t,update:a}=vi({teacherData:null,teacherProfileData:null,teacherSections:[],isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),i={subscribe:s,init:r=>{const l=$f(r);return l?(a(c=>({...c,teacherData:l.teacherData,teacherProfileData:l.teacherProfileData,teacherSections:l.teacherSections,lastUpdated:l.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(r,l=!1)=>{a(c=>({...c,isLoading:r&&!c.isInitialized&&!l,isRefreshing:r&&l,error:r?null:c.error}))},setError:r=>{a(l=>({...l,isLoading:!1,isRefreshing:!1,error:r}))},updateProfileData:(r,l,c,u)=>{const f=Date.now();a(p=>({...p,teacherData:r,teacherProfileData:l,teacherSections:c,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),jf(r,l,c,u,f)},loadProfile:async(r,l=!1)=>{try{a(m=>({...m,isLoading:!l&&!m.isInitialized,isRefreshing:l,error:null}));const c=await da.get("/api/accounts?type=teacher&limit=1000");if(!c.success)throw new Error(c.message||"Failed to fetch teacher data");const u=c.accounts.find(m=>m.id===r||m.number===r);if(!u)throw new Error("Teacher data not found");let f=null;try{const m=await da.get(`/api/teacher-profile?teacherId=${r}`);m.success&&(f=m.data)}catch(m){console.warn("Failed to fetch teacher profile data:",m)}let p=[];try{const y=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",b=await fetch(`/api/teacher-sections?teacherId=${r}&schoolYear=${y}`);if(b.ok){const D=await b.json();D.success&&(p=D.data.classData||[])}}catch(m){console.warn("Failed to fetch teacher sections:",m)}i.updateProfileData(u,f,p,r)}catch(c){console.error("Error loading teacher profile:",c),a(u=>({...u,isLoading:!1,isRefreshing:!1,error:c.message}))}},clearCache:r=>{try{const l=`${Yr}_${r}`;localStorage.removeItem(l)}catch(l){console.warn("Failed to clear teacher profile cache:",l)}},forceRefresh:async r=>{i.clearCache(r),a(l=>({...l,isInitialized:!1,teacherData:null,teacherProfileData:null,teacherSections:[]})),await i.loadProfile(r,!1)}};return i}function $f(s){try{const t=`${Yr}_${s}`,a=localStorage.getItem(t);if(!a)return null;const i=JSON.parse(a);return Date.now()-i.timestamp>Nf?(localStorage.removeItem(t),null):{teacherData:i.teacherData,teacherProfileData:i.teacherProfileData,teacherSections:i.teacherSections,lastUpdated:i.timestamp}}catch(t){return console.warn("Failed to get cached teacher profile data:",t),null}}function jf(s,t,a,i,r){try{const l=`${Yr}_${i}`,c={teacherData:s,teacherProfileData:t,teacherSections:a,timestamp:r};localStorage.setItem(l,JSON.stringify(c))}catch(l){console.warn("Failed to cache teacher profile data:",l)}}const xi=Lf();function If(s,t){d(t,!e(t))}function Rf(s,t){d(t,!e(t))}function Of(s,t){d(t,!e(t))}function qf(s,t){ds.confirm("Change Password",`
			<div class="teacher-profile-password-form">
				<div class="teacher-profile-form-group">
					<label for="current-password">Current Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="new-password">New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="teacher-profile-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="teacher-profile-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="teacher-profile-form-input"
						/>
						<button type="button" class="teacher-profile-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{},{size:"medium"})}var Vf=_('<div class="teacher-error-container"><div class="teacher-error-icon"><span class="material-symbols-outlined">error</span></div> <p class="teacher-error-message"> </p> <button class="teacher-retry-btn"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Bf=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teacher information...</p></div>'),zf=_('<div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">badge</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Teacher ID</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">person</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Full Name</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">work</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Position</div> <div class="teacher-info-value"> </div></div></div></div> <div class="teacher-info-row teacher-row-three"><div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">email</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Email</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">menu_book</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Total Subjects</div> <div class="teacher-info-value"> </div></div></div> <div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">domain</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Department</div> <div class="teacher-info-value"> </div></div></div></div>',1),Gf=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching sections...</p></div>'),Wf=_('<div class="teacher-info-card"><div class="teacher-info-icon"><span class="material-symbols-outlined">groups</span></div> <div class="teacher-info-content"><div class="teacher-info-label"> </div> <div class="teacher-info-value"> </div></div></div>'),Hf=_('<div class="teacher-info-row teacher-row-three"></div>'),Yf=_('<div class="teacher-sections-empty"><span class="material-symbols-outlined">groups</span> <p>No teaching sections assigned yet</p></div>'),Uf=_('<div class="teacher-profile-loading-container"><span class="teacher-profile-loader"></span> <p class="teacher-profile-loading-text">Loading teaching assignments...</p></div>'),Qf=_('<div class="teacher-subject-card"><div class="teacher-subject-icon-column"><div class="teacher-subject-icon"><span class="material-symbols-outlined">book</span></div></div> <div class="teacher-subject-details-column"><h3 class="teacher-subject-name"> </h3> <p class="teacher-subject-classes"><!></p></div></div>'),Jf=_('<div class="teacher-subjects-grid"></div>'),Kf=_('<div class="teacher-subjects-empty"><span class="material-symbols-outlined">menu_book</span> <p>No subjects assigned yet</p></div>'),Xf=_('<div class="teacher-profile-header"><div class="teacher-header-content"><h1 class="teacher-page-title">Teacher Profile</h1> <p class="teacher-page-subtitle">Personal Information & Teaching Details</p></div> <div class="teacher-header-actions"><button class="teacher-refresh-btn" aria-label="Refresh profile data"><span class="material-symbols-outlined">refresh</span></button></div></div> <div class="teacher-profile-info-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teacher Information</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teacher information"><h2 class="teacher-section-title">Teacher Information</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-sections-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Sections</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching sections"><h2 class="teacher-section-title">Teaching Sections</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-subjects-section"><h2 class="teacher-section-title teacher-section-title-desktop">Teaching Assignments</h2> <button class="teacher-section-header-mobile" aria-label="Toggle teaching assignments"><h2 class="teacher-section-title">Teaching Assignments</h2> <span>expand_more</span></button> <div><!></div></div> <div class="teacher-profile-security-section"><h2 class="teacher-section-title teacher-section-title-desktop">Account Security</h2> <div class="teacher-section-content"><div class="teacher-info-row teacher-row-one"><div class="teacher-info-card teacher-security-card"><div class="teacher-info-content-container"><div class="teacher-info-icon"><span class="material-symbols-outlined">lock</span></div> <div class="teacher-info-content"><div class="teacher-info-label">Password</div> <div class="teacher-info-value">Change your account password for security</div></div></div> <div class="teacher-security-actions"><button class="teacher-security-action-button"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div>',1),Zf=_('<div class="teacher-profile-container"><!></div>');function ep(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(xi,"$teacherProfileStore",a),l=()=>ps(ms,"$authStore",a);let c=kt(void 0),u=Ra(()=>r().teacherData),f=Ra(()=>r().teacherProfileData),p=Ra(()=>r().teacherSections),m=Ra(()=>r().isLoading),g=Ra(()=>r().error);Xs(()=>ms.subscribe(L=>{d(c,L,!0)})),Wa(async()=>{if(!e(c)?.userData?.id){console.error("User not authenticated");return}const V=e(c).userData.id,L=xi.init(V);await xi.loadProfile(V,L);const X=setInterval(async()=>{await xi.loadProfile(V,!0)},300*1e3);return()=>{clearInterval(X)}});async function y(){const V=l();if(!V.isAuthenticated||!V.userData?.id){console.error("User not authenticated");return}const L=V.userData.id;await xi.forceRefresh(L)}Xs(()=>{if(e(c)?.userData?.id){const V=e(c).userData.id;xi.init(V)||xi.loadProfile(V,!1)}});let b=Ra(()=>({id:e(u)?.number||e(c)?.userData?.accountNumber||"N/A",name:e(u)?.name||e(c)?.userData?.name||"Teacher Name",firstName:e(u)?.firstName||e(c)?.userData?.firstName||"",lastName:e(u)?.lastName||"",middleInitial:e(u)?.middleInitial||"",department:e(u)?.department||"Not assigned",position:e(u)?.position||"Teacher",email:e(u)?.email||"Not available",phone:e(u)?.contactNumber||"Not available",address:e(u)?.address||"Not available",birthDate:e(u)?.birthdate?new Date(e(u).birthdate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",age:e(u)?.age||"Not available",gender:e(u)?.gender||e(c)?.userData?.gender||"male",employmentInfo:{hireDate:e(u)?.hireDate?new Date(e(u).hireDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not available",yearsOfService:e(u)?.yearsOfService||"Not available",employeeId:e(u)?.employeeId||"Not available"},subjects:e(f)?.subjects||[],classes:e(f)?.classes||[],sections:e(f)?.sections||[]})),D=Ra(()=>e(b).subjects.length||"Not available"),S=kt(!0),k=kt(!0),A=kt(!0),E=kt(!1);function M(V){const L=document.getElementById(V),ne=L.nextElementSibling.querySelector(".password-eye-icon");L.type==="password"?(L.type="text",ne.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(L.type="password",ne.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=M);async function I(){const V=document.getElementById("current-password"),L=document.getElementById("new-password"),X=document.getElementById("confirm-password");if(!V||!L||!X){ns("Password form inputs not found");return}const ne=V.value,ce=L.value,Le=X.value;if(!ne){ns("Current password is required");return}if(!ce){ns("New password is required");return}if(ce!==Le){ns("New passwords do not match");return}if(ce.length<8){ns("Password must be at least 8 characters long");return}if(ne===ce){ns("New password must be different from current password");return}try{d(E,!0);const fe=await da.post("/api/change-password",{currentPassword:ne,newPassword:ce});fe.success?(V.value="",L.value="",X.value="",bi("Password changed successfully!"),ds.close()):ns(fe.error||"Failed to change password")}catch(fe){ns(fe.message||"Failed to change password")}finally{d(E,!1)}}var F=Zf(),z=o(F);{var R=V=>{var L=Vf(),X=v(o(L),2),ne=o(X);n(X);var ce=v(X,2);ce.__click=y,n(L),$(()=>w(ne,`Failed to load profile data: ${e(g)??""}`)),h(V,L)},J=V=>{var L=Xf(),X=ut(L),ne=v(o(X),2),ce=o(ne);ce.__click=y,n(ne),n(X);var Le=v(X,2),fe=v(o(Le),2);fe.__click=[If,S];var se=v(o(fe),2);let re;n(fe);var Se=v(fe,2);let me;var ze=o(Se);{var Xe=Me=>{var q=Bf();h(Me,q)},tt=Me=>{var q=zf(),B=ut(q),N=o(B),Z=v(o(N),2),be=v(o(Z),2),Fe=o(be,!0);n(be),n(Z),n(N);var he=v(N,2),te=v(o(he),2),j=v(o(te),2),K=o(j,!0);n(j),n(te),n(he);var ae=v(he,2),Oe=v(o(ae),2),Be=v(o(Oe),2),Ke=o(Be,!0);n(Be),n(Oe),n(ae),n(B);var Ge=v(B,2),ot=o(Ge),gt=v(o(ot),2),Yt=v(o(gt),2),ge=o(Yt,!0);n(Yt),n(gt),n(ot);var Qe=v(ot,2),Y=v(o(Qe),2),le=v(o(Y),2),Ce=o(le,!0);n(le),n(Y),n(Qe);var et=v(Qe,2),ft=v(o(et),2),Dt=v(o(ft),2),vt=o(Dt,!0);n(Dt),n(ft),n(et),n(Ge),$(()=>{w(Fe,e(b).id),w(K,e(b).name),w(Ke,e(b).position),w(ge,e(b).email||"Not provided"),w(Ce,e(D)),w(vt,e(b).department)}),h(Me,q)};C(ze,Me=>{e(m)?Me(Xe):Me(tt,!1)})}n(Se),n(Le);var ve=v(Le,2),$e=v(o(ve),2);$e.__click=[Rf,k];var Je=v(o($e),2);let Re;n($e);var Ze=v($e,2);let st;var We=o(Ze);{var nt=Me=>{var q=Gf();h(Me,q)},ke=Me=>{var q=Et(),B=ut(q);{var N=be=>{var Fe=Hf();Tt(Fe,21,()=>e(p),Ka,(he,te)=>{var j=Et(),K=ut(j);Tt(K,17,()=>e(te).sections,Ka,(ae,Oe)=>{var Be=Wf(),Ke=v(o(Be),2),Ge=o(Ke),ot=o(Ge,!0);n(Ge);var gt=v(Ge,2),Yt=o(gt);n(gt),n(Ke),n(Be),$(()=>{w(ot,e(Oe).name),w(Yt,`${e(te).gradeName??""}  ${e(Oe).students??""} students`)}),h(ae,Be)}),h(he,j)}),n(Fe),h(be,Fe)},Z=be=>{var Fe=Yf();h(be,Fe)};C(B,be=>{e(p).length>0?be(N):be(Z,!1)},!0)}h(Me,q)};C(We,Me=>{e(m)?Me(nt):Me(ke,!1)})}n(Ze),n(ve);var De=v(ve,2),Ie=v(o(De),2);Ie.__click=[Of,A];var Ee=v(o(Ie),2);let ee;n(Ie);var Ue=v(Ie,2);let rt;var Ye=o(Ue);{var at=Me=>{var q=Uf();h(Me,q)},lt=Me=>{var q=Et(),B=ut(q);{var N=be=>{var Fe=Jf();Tt(Fe,21,()=>e(b).subjects,he=>he.id,(he,te)=>{var j=Qf(),K=o(j),ae=o(K);n(K);var Oe=v(K,2),Be=o(Oe),Ke=o(Be,!0);n(Be);var Ge=v(Be,2),ot=o(Ge);{var gt=ge=>{var Qe=ka();$(()=>w(Qe,`${e(te).section_count??""} ${e(te).section_count===1?"section":"sections"}`)),h(ge,Qe)},Yt=ge=>{var Qe=ka("No sections assigned");h(ge,Qe)};C(ot,ge=>{e(te).section_count?ge(gt):ge(Yt,!1)})}n(Ge),n(Oe),n(j),$(()=>{as(j,`border-color: ${e(te).color??""};`),as(ae,`background-color: ${e(te).color??""}20; color: ${e(te).color??""}`),w(Ke,e(te).name)}),h(he,j)}),n(Fe),h(be,Fe)},Z=be=>{var Fe=Kf();h(be,Fe)};C(B,be=>{e(b).subjects.length>0?be(N):be(Z,!1)},!0)}h(Me,q)};C(Ye,Me=>{e(m)?Me(at):Me(lt,!1)})}n(Ue),n(De);var O=v(De,2),T=v(o(O),2),U=o(T),de=o(U),Pe=v(o(de),2),Ve=o(Pe);Ve.__click=[qf,I],n(Pe),n(de),n(U),n(T),n(O),$((Me,q,B,N,Z,be)=>{ce.disabled=e(m),re=oe(se,1,"material-symbols-outlined teacher-collapse-icon",null,re,Me),me=oe(Se,1,"teacher-section-content",null,me,q),Re=oe(Je,1,"material-symbols-outlined teacher-collapse-icon",null,Re,B),st=oe(Ze,1,"teacher-section-content",null,st,N),ee=oe(Ee,1,"material-symbols-outlined teacher-collapse-icon",null,ee,Z),rt=oe(Ue,1,"teacher-section-content",null,rt,be)},[()=>({rotated:e(S)}),()=>({collapsed:e(S)}),()=>({rotated:e(k)}),()=>({collapsed:e(k)}),()=>({rotated:e(A)}),()=>({collapsed:e(A)})]),h(V,L)};C(z,V=>{e(g)?V(R):V(J,!1)})}n(F),h(s,F),Ga(),i()}Is(["click"]);const sr="teacherScheduleCache",tp=300*1e3;function ap(){const{subscribe:s,set:t,update:a}=vi({scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},isLoading:!1,isRefreshing:!1,error:null,lastUpdated:null,isInitialized:!1}),i={subscribe:s,init:(r,l)=>{const c=sp(r,l);return c?(a(u=>({...u,scheduleData:c.scheduleData,lastUpdated:c.lastUpdated,isInitialized:!0,isLoading:!1,error:null})),!0):!1},setLoading:(r,l=!1)=>{a(c=>({...c,isLoading:r&&!c.isInitialized&&!l,isRefreshing:r&&l,error:r?null:c.error}))},updateScheduleData:(r,l,c,u=!1)=>{const f=Date.now();a(p=>({...p,scheduleData:r,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:f,isInitialized:!0})),Eo(r,l,c,f)},setError:(r,l=!1)=>{a(c=>({...c,error:r,isLoading:!1,isRefreshing:!1}))},loadSchedule:async(r,l,c=!1)=>{try{a(g=>({...g,isLoading:!c&&!g.isInitialized,isRefreshing:c,error:null}));let u=l;u||(u=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026");const p=await(await fetch(`/api/schedules?action=teacher-schedules&teacherId=${r}&schoolYear=${u}`)).json();if(!p.success)throw new Error(p.error||"Failed to fetch schedule data");const m=ip(p.data);a(g=>({...g,scheduleData:m,isLoading:!1,isRefreshing:!1,error:null,lastUpdated:Date.now(),isInitialized:!0})),Eo(m,r,u,Date.now())}catch(u){console.error("Error loading teacher schedule:",u),a(f=>({...f,error:u.message,isLoading:!1,isRefreshing:!1}))}},clearCache:(r,l)=>{try{const c=`${sr}_${r}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear teacher schedule cache:",c)}},forceRefresh:async(r,l)=>{try{const c=`${sr}_${r}_${l}`;localStorage.removeItem(c)}catch(c){console.warn("Failed to clear cache during force refresh:",c)}a(c=>({...c,isInitialized:!1,scheduleData:{Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]}})),await i.loadSchedule(r,l,!1)}};return i}function sp(s,t){try{const a=`${sr}_${s}_${t}`,i=localStorage.getItem(a);if(!i)return null;const r=JSON.parse(i);return Date.now()-r.timestamp>tp?(localStorage.removeItem(a),null):{scheduleData:r.scheduleData,lastUpdated:r.timestamp}}catch(a){return console.warn("Failed to retrieve cached teacher schedule:",a),null}}function Eo(s,t,a,i){try{const r=`${sr}_${t}_${a}`,l={scheduleData:s,timestamp:i,teacherId:t,schoolYear:a};localStorage.setItem(r,JSON.stringify(l))}catch(r){console.warn("Failed to cache teacher schedule data:",r)}}function ip(s){const t={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[]},a={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri"},i=["blue","green","purple","yellow","orange"];function r(c){return i[c%i.length]}const l={Mon:0,Tue:0,Wed:0,Thu:0,Fri:0};return s.forEach(c=>{const u=a[c.day_of_week.toLowerCase()];if(u){const f=Fo(c.start_time),p=Fo(c.end_time);let m,g;c.schedule_type==="subject"?(m=c.section_name,g=c.subject_name||"Unknown Subject"):c.schedule_type==="activity"&&(m=c.activity_type_name||"Activity",g=c.activity_type_name||"Activity");const y={name:m,time:`${f} - ${p}`,room:c.room_name||"TBA",subject:g,gradeLevel:c.grade_level,scheduleType:c.schedule_type,color:r(l[u])};t[u].push(y),l[u]++}}),Object.keys(t).forEach(c=>{const u=t[c],f=np(u),p=[...u,...f].sort((m,g)=>{const y=Yi(m.time.split(" - ")[0]),b=Yi(g.time.split(" - ")[0]);return y-b});t[c]=p}),t}function Fo(s){const[t,a]=s.split(":"),i=parseInt(t),r=i>=12?"PM":"AM";return`${(i===0?12:i>12?i-12:i).toString().padStart(2,"0")}:${a} ${r}`}function Yi(s){const[t,a]=s.split(" "),[i,r]=t.split(":").map(Number);let l=r;return a==="PM"&&i!==12?l+=(i+12)*60:a==="AM"&&i===12?l+=0:l+=i*60,l}function No(s){const t=Math.floor(s/60),a=s%60,i=t>=12?"PM":"AM";return`${(t===0?12:t>12?t-12:t).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")} ${i}`}function np(s){if(s.length<=1)return[];const t=[...s].sort((i,r)=>{const l=Yi(i.time.split(" - ")[0]),c=Yi(r.time.split(" - ")[0]);return l-c}),a=[];for(let i=0;i<t.length-1;i++){const r=t[i],l=t[i+1],c=Yi(r.time.split(" - ")[1]),u=Yi(l.time.split(" - ")[0]);if(u>c){const f=No(c),p=No(u);a.push({name:"Vacant Time",time:`${f} - ${p}`,room:"Available",subject:"Free Period",color:"gray",isVacant:!0})}}return a}const dn=ap();var rp=_('<button><div class="day-name"> </div> <div class="day-name-full"> </div></button>'),op=_("<button> </button>"),lp=_('<div class="teacher-dropdown-menu"></div>'),cp=_('<div class="loading-message"><div class="system-loader"></div> <p>Loading Schedule...</p></div>'),dp=_('<div class="error-message"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <h3>Error Loading Schedule</h3> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Try Again</button></div>'),up=_('<div class="schedule-class-location"><span class="material-symbols-outlined">schedule</span> <span>Available Time</span></div>'),vp=_('<div class="schedule-class-teacher"><span class="material-symbols-outlined">book</span> <span> </span></div>'),fp=_('<div class="schedule-class-grade"><span class="material-symbols-outlined">school</span> <span> </span></div>'),pp=_('<div class="schedule-class-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <!>',1),hp=_('<div><div class="class-header"><h3 class="schedule-class-name"> </h3> <span class="schedule-class-time"> </span></div> <div class="class-details"><!></div></div>'),mp=_('<div class="schedule-classes-grid"></div>'),gp=_('<div class="no-classes-message"><div class="no-classes-icon"><span class="material-symbols-outlined">event_available</span></div> <h3>No Classes Scheduled</h3> <p> </p></div>'),_p=_('<div class="schedule-container" role="button" tabindex="0"><div class="schedule-schedule-header"><h1 class="schedule-page-title">Teaching Schedule</h1> <p class="schedule-page-subtitle">Your weekly teaching schedule</p></div> <div class="week-navigation"><div class="week-title"><span> </span></div> <div class="schedule-day-selector"></div> <div class="teacher-mobile-dropdown"><button class="teacher-dropdown-toggle-date"><span> </span> <span>expand_more</span></button> <!></div></div> <div class="classes-section"><div class="classes-header"><h2> </h2> <div class="refresh-controls"><button class="refresh-button"><span class="material-symbols-outlined">refresh</span></button></div></div> <!></div></div>');function bp(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(dn,"$teacherScheduleStore",a),l=()=>ps(ms,"$authStore",a),c=P(),u=P(),f=P(),p=P(),m=P(),g=P(),y=P(),b=new Date,D=["January","February","March","April","May","June","July","August","September","October","November","December"],S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],k=D[b.getMonth()],A=b.getDate(),E=S[b.getDay()],M={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri"},I=b.getDay();let F=P(M[I]||"Mon");Wa(async()=>{const ee=l();if(!ee.isAuthenticated||!ee.userData?.id){console.error("User not authenticated");return}const Ue=ee.userData.id,rt=dn.init(Ue,null);await dn.loadSchedule(Ue,null,rt);const Ye=setInterval(async()=>{await dn.loadSchedule(Ue,null,!0)},300*1e3);return()=>{clearInterval(Ye)}});async function z(){const ee=l();if(!ee.isAuthenticated||!ee.userData?.id){console.error("User not authenticated");return}const Ue=ee.userData.id;await dn.forceRefresh(Ue,null)}const R={Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday"},J=[{day:"Mon"},{day:"Tue"},{day:"Wed"},{day:"Thu"},{day:"Fri"}];let V=P(!1);function L(ee){ee.target.closest(".teacher-mobile-dropdown")||d(V,!1)}function X(){d(V,!e(V))}function ne(ee){d(F,ee),d(V,!1)}Jt(()=>(e(c),e(u),e(f),e(p),e(m),r()),()=>{(ee=>{d(c,ee.scheduleData),d(u,ee.isLoading),d(f,ee.isRefreshing),d(p,ee.error),d(m,ee.lastUpdated)})(r())}),Jt(()=>(e(c),e(F)),()=>{d(g,e(c)[e(F)]||[])}),Jt(()=>e(F),()=>{d(y,R[e(F)]||"Monday")}),Ss(),vs();var ce=_p(),Le=v(o(ce),2),fe=o(Le),se=o(fe),re=o(se);n(se),n(fe);var Se=v(fe,2);Tt(Se,5,()=>J,Ka,(ee,Ue)=>{let rt=()=>e(Ue).day;var Ye=rp(),at=o(Ye),lt=o(at,!0);n(at);var O=v(at,2),T=o(O,!0);n(O),n(Ye),$(()=>{oe(Ye,1,`schedule-day-btn ${rt()===e(F)?"active":""}`),w(lt,rt()),w(T,(rt(),x(()=>R[rt()])))}),Q("click",Ye,()=>ne(rt())),h(ee,Ye)}),n(Se);var me=v(Se,2),ze=o(me),Xe=o(ze),tt=o(Xe,!0);n(Xe);var ve=v(Xe,2);n(ze);var $e=v(ze,2);{var Je=ee=>{var Ue=lp();Tt(Ue,5,()=>J,Ka,(rt,Ye)=>{let at=()=>e(Ye).day;var lt=op(),O=o(lt,!0);n(lt),$(()=>{oe(lt,1,`teacher-dropdown-item ${at()===e(F)?"selected":""}`),w(O,(at(),x(()=>R[at()])))}),Q("click",lt,()=>ne(at())),h(rt,lt)}),n(Ue),h(ee,Ue)};C($e,ee=>{e(V)&&ee(Je)})}n(me),n(Le);var Re=v(Le,2),Ze=o(Re),st=o(Ze),We=o(st);n(st);var nt=v(st,2),ke=o(nt);n(nt),n(Ze);var De=v(Ze,2);{var Ie=ee=>{var Ue=cp();h(ee,Ue)},Ee=ee=>{var Ue=Et(),rt=ut(Ue);{var Ye=lt=>{var O=dp(),T=v(o(O),4),U=o(T,!0);n(T);var de=v(T,2);n(O),$(()=>w(U,e(p))),Q("click",de,z),h(lt,O)},at=lt=>{var O=Et(),T=ut(O);{var U=Pe=>{var Ve=mp();Tt(Ve,5,()=>e(g),Ka,(Me,q)=>{var B=hp(),N=o(B),Z=o(N),be=o(Z,!0);n(Z);var Fe=v(Z,2),he=o(Fe,!0);n(Fe),n(N);var te=v(N,2),j=o(te);{var K=Oe=>{var Be=up();h(Oe,Be)},ae=Oe=>{var Be=pp(),Ke=ut(Be),Ge=v(o(Ke),2),ot=o(Ge,!0);n(Ge),n(Ke);var gt=v(Ke,2);{var Yt=Y=>{var le=vp(),Ce=v(o(le),2),et=o(Ce,!0);n(Ce),n(le),$(()=>w(et,(e(q),x(()=>e(q).subject)))),h(Y,le)};C(gt,Y=>{e(q),x(()=>e(q).subject)&&Y(Yt)})}var ge=v(gt,2);{var Qe=Y=>{var le=fp(),Ce=v(o(le),2),et=o(Ce);n(Ce),n(le),$(()=>w(et,`Grade ${e(q),x(()=>e(q).gradeLevel)??""}`)),h(Y,le)};C(ge,Y=>{e(q),x(()=>e(q).gradeLevel&&e(q).scheduleType==="subject")&&Y(Qe)})}$(()=>w(ot,(e(q),x(()=>e(q).room)))),h(Oe,Be)};C(j,Oe=>{e(q),x(()=>e(q).scheduleType==="vacant")?Oe(K):Oe(ae,!1)})}n(te),n(B),$(()=>{oe(B,1,`schedule-class-card ${e(q),x(()=>e(q).color)??""}`),w(be,(e(q),x(()=>e(q).name))),w(he,(e(q),x(()=>e(q).time)))}),h(Me,B)}),n(Ve),h(Pe,Ve)},de=Pe=>{var Ve=gp(),Me=v(o(Ve),4),q=o(Me);n(Me),n(Ve),$(()=>w(q,`You don't have any classes scheduled for ${e(y)??""}. Enjoy your free day!`)),h(Pe,Ve)};C(T,Pe=>{e(g),x(()=>e(g).length>0)?Pe(U):Pe(de,!1)},!0)}h(lt,O)};C(rt,lt=>{e(p)?lt(Ye):lt(at,!1)},!0)}h(ee,Ue)};C(De,ee=>{e(u)?ee(Ie):ee(Ee,!1)})}n(Re),n(ce),$(()=>{w(re,`${E??""}, ${k??""} ${A??""}`),w(tt,(e(F),x(()=>R[e(F)]||"Select Day"))),oe(ve,1,`material-symbols-outlined teacher-dropdown-icon ${e(V)?"open":""}`),w(We,`${e(y)??""} Classes`),ke.disabled=e(u)}),Q("click",ze,X),Q("click",ke,z),Q("click",ce,L),Q("keydown",ce,L),h(s,ce),Ga(),i()}var yp=_('<div class="odometer-container svelte-1ve39fg"><!></div>');function Xl(s,t){za(t,!1);let a=La(t,"value",8,0),i=La(t,"format",8,"d"),r=La(t,"theme",8,"default"),l=La(t,"duration",8,2e3),c=La(t,"auto",8,!0);La(t,"selector",8,null);let u=La(t,"useCommaDecimal",8,!1),f=La(t,"animation",8,"ease"),p=P(),m=P();Wa(async()=>{try{const b=(await To(async()=>{const{default:D}=await import("../chunks/7634Yfgp.js").then(S=>S.o);return{default:D}},[],import.meta.url)).default;await To(()=>Promise.resolve({}),__vite__mapDeps([0]),import.meta.url),d(m,new b({el:e(p),format:i(),theme:r(),duration:l(),auto:c(),animation:f(),value:0})),u()&&new MutationObserver(()=>{const S=e(p).textContent;S&&S.includes(".")&&Ts(p,e(p).textContent=S.replace(".",","))}).observe(e(p),{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>{e(m)&&e(m).update(a())},100)}catch(b){console.error("Failed to load odometer:",b)}}),Jt(()=>(e(m),xs(a())),()=>{e(m)&&Ul&&e(m).update(a())}),Ss(),vs();var g=yp(),y=o(g);C(y,b=>{}),n(g),Pi(g,b=>d(p,b),()=>e(p)),h(s,g),Ga()}var wp=_('<div class="class-mgmt-stat-card"><div class="class-mgmt-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="class-mgmt-stat-value"><!></div> <div class="class-mgmt-stat-label"> </div></div></div>'),xp=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading your teaching assignments...</p></div>'),Sp=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),kp=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Teaching Assignments</h3> <p>You don't have any sections assigned for this school year.</p></div>`),Dp=(s,t,a,i)=>t(e(a).yearLevel,e(i).name,e(i).id),Ap=_('<span class="more-subjects"> </span>'),Cp=_('<div class="section-subjects"> <!></div>'),Tp=_('<button class="section-card"><div class="section-name"> </div> <!></button>'),Mp=_('<div class="year-level-container"><div class="year-level-header"><div class="year-level-info"><div class="year-level-icon"><span class="material-symbols-outlined">school</span></div> <div class="year-level-details"><h3 class="year-level-title"> </h3> <p class="year-level-summary"> </p></div></div></div> <div class="sections-grid"></div></div>'),Pp=_('<div class="year-levels-grid"></div>'),Ep=_('<div class="class-management-container"><div class="class-mgmt-page-header"><div class="header-content"><h1 class="class-mgmt-page-title">Class Management</h1> <p class="class-mgmt-page-subtitle">Overview of your teaching assignments and student distribution</p></div></div> <div class="class-mgmt-stats-section"><div class="class-mgmt-stats-grid"></div></div> <div class="classes-section-container"><h2 class="class-mgmt-section-title">Year Levels & Sections</h2> <!></div></div>');function Lo(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=kt(Gs({name:"Loading...",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0})),c=kt(Gs([])),u=kt(!0),f=kt(null);function p(M,I,F){t.onNavigateToClassList&&t.onNavigateToClassList({detail:{yearLevel:M,sectionName:I,sectionId:F}})}let m=[{id:"year-levels",label:"Year Levels",getValue:()=>e(l).yearLevels.length,icon:"school",color:"var(--school-primary)"},{id:"sections",label:"Total Sections",getValue:()=>e(l).totalSections,icon:"class",color:"var(--school-secondary)"},{id:"students",label:"Total Students",getValue:()=>e(l).totalStudents,icon:"people",color:"var(--success)"},{id:"average",label:"Average Per Section",getValue:()=>e(l).averagePerSection,icon:"analytics",color:"var(--school-accent)"}];async function g(){try{d(u,!0),d(f,null);const M=r();if(!M.isAuthenticated||!M.userData?.id)throw new Error("User not authenticated");const I=M.userData.id,R=(await(await fetch("/api/current-quarter")).json()).data?.currentSchoolYear||"2025-2026",V=await(await fetch(`/api/teacher-sections?teacherId=${I}&schoolYear=${R}`)).json();if(!V.success)throw new Error(V.error||"Failed to fetch teacher sections");d(c,V.data.classData,!0),d(l,{name:M.userData.name||"Teacher",yearLevels:V.data.stats.yearLevels,totalSections:V.data.stats.totalSections,totalStudents:V.data.stats.totalStudents,averagePerSection:V.data.stats.averagePerSection},!0)}catch(M){console.error("Error fetching teacher sections:",M),d(f,M.message,!0),d(c,[],!0),d(l,{name:"Teacher",yearLevels:[],totalSections:0,totalStudents:0,averagePerSection:0},!0)}finally{d(u,!1)}}Wa(()=>{g()});var y=Ep(),b=v(o(y),2),D=o(b);Tt(D,21,()=>m,M=>M.id,(M,I)=>{var F=wp(),z=o(F),R=o(z),J=o(R,!0);n(R),n(z);var V=v(z,2),L=o(V),X=o(L);{let Le=Ra(()=>e(I).getValue());Xl(X,{get value(){return e(Le)},format:"d",duration:2e3,animation:"ease-out"})}n(L);var ne=v(L,2),ce=o(ne,!0);n(ne),n(V),n(F),$(()=>{as(z,`background-color: ${e(I).color??""}20; color: ${e(I).color??""}`),w(J,e(I).icon),as(L,`color: ${e(I).color??""}`),w(ce,e(I).label)}),h(M,F)}),n(D),n(b);var S=v(b,2),k=v(o(S),2);{var A=M=>{var I=xp();h(M,I)},E=M=>{var I=Et(),F=ut(I);{var z=J=>{var V=Sp(),L=v(o(V),2),X=o(L);n(L);var ne=v(L,2);ne.__click=g,n(V),$(()=>w(X,`Error: ${e(f)??""}`)),h(J,V)},R=J=>{var V=Et(),L=ut(V);{var X=ce=>{var Le=kp();h(ce,Le)},ne=ce=>{var Le=Pp();Tt(Le,21,()=>e(c),fe=>fe.yearLevel,(fe,se)=>{var re=Mp(),Se=o(re),me=o(Se),ze=v(o(me),2),Xe=o(ze),tt=o(Xe,!0);n(Xe);var ve=v(Xe,2),$e=o(ve);n(ve),n(ze),n(me),n(Se);var Je=v(Se,2);Tt(Je,21,()=>e(se).sections,Re=>Re.name,(Re,Ze)=>{var st=Tp();st.__click=[Dp,p,se,Ze];var We=o(st),nt=o(We,!0);n(We);var ke=v(We,2);{var De=Ie=>{var Ee=Cp(),ee=o(Ee),Ue=v(ee);{var rt=Ye=>{var at=Ap(),lt=o(at);n(at),$(()=>w(lt,`+${e(Ze).subjects.length-2} more`)),h(Ye,at)};C(Ue,Ye=>{e(Ze).subjects.length>2&&Ye(rt)})}n(Ee),$(Ye=>w(ee,`${Ye??""} `),[()=>e(Ze).subjects.slice(0,2).join(", ")]),h(Ie,Ee)};C(ke,Ie=>{e(Ze).subjects&&e(Ze).subjects.length>0&&Ie(De)})}n(st),$(()=>{$t(st,"aria-label",`View class list for ${e(Ze).name??""}`),w(nt,e(Ze).name)}),h(Re,st)}),n(Je),n(re),$(Re=>{w(tt,e(se).gradeName),w($e,`${e(se).sections.length??""} section${e(se).sections.length!==1?"s":""}  ${Re??""} students`)},[()=>e(se).sections.reduce((Re,Ze)=>Re+Ze.students,0)]),h(fe,re)}),n(Le),h(ce,Le)};C(L,ce=>{e(c).length===0?ce(X):ce(ne,!1)},!0)}h(J,V)};C(F,J=>{e(f)?J(z):J(R,!1)},!0)}h(M,I)};C(k,M=>{e(u)?M(A):M(E,!1)})}n(S),n(y),h(s,y),Ga(),i()}Is(["click"]);async function Fp(s,t,a,i,r,l,c,u,f,p,m){if(!t.sectionId||!t.subjectId){Ae.error("Missing section or subject information");return}d(a,!0),d(i,""),d(r,!1);try{const g=l().filter(k=>!k.isVerified),y=l().length-g.length;if(g.length===0){Ae.warning("All student grades have already been verified by the adviser. No grades to send."),d(a,!1);return}const b=g.map(k=>{const A=c(k.writtenWork,u().writtenWork.totals,"writtenWork"),E=c(k.performanceTasks,u().performanceTasks.totals,"performanceTasks"),M=c(k.quarterlyAssessment,u().quarterlyAssessment.totals,"quarterlyAssessment"),I=f(k);return{student_id:k.accountNumber||k.account_number||k.id,written_work_average:A!==""?parseFloat(A):null,performance_tasks_average:E!==""?parseFloat(E):null,quarterly_assessment_average:M!==""?parseFloat(M):null,final_grade:I!==""?parseFloat(I):null,written_work_items:k.writtenWork||[],performance_tasks_items:k.performanceTasks||[],quarterly_assessment_items:k.quarterlyAssessment||[]}}),D=await bs("/api/grades",{method:"POST",body:JSON.stringify({action:"submit_final_grades",section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:p(),teacher_id:m().userData.id,final_grades:b})});if(!D.ok){const k=await D.json().catch(()=>({}));throw console.error("API error response:",k),new Error(k.error||`HTTP ${D.status}: ${D.statusText}`)}const S=await D.json();d(r,!0),y>0?Ae.success(`Final grades sent to adviser for ${g.length} students. ${y} verified students were skipped.`):Ae.success("Final grades have been sent to the adviser successfully!"),setTimeout(()=>{d(i,"")},3e3)}catch(g){console.error("Error saving final grades:",g),d(r,!1),d(i,g.message||"Failed to save final grades",!0),Ae.error(e(i)),setTimeout(()=>{d(i,"")},5e3)}finally{d(a,!1)}}async function Np(s,t,a,i,r,l,c,u,f,p){try{Ae.info("Refreshing grades from database...");const m=t(),g=m.isAuthenticated?m.userData?.id:null,y=new URLSearchParams({sectionId:a.sectionId.toString(),subjectId:a.subjectId.toString(),gradingPeriodId:i().toString()});g&&y.append("teacherId",g.toString());const b=await bs(`/api/class-students?${y}`);if(!b.ok)throw new Error(`HTTP ${b.status}: ${b.statusText}`);const D=await b.json();if(D.success&&D.data?.students)r(D.data.students.map(S=>({...S,writtenWork:S.grades?.written_work||[],performanceTasks:S.grades?.performance_tasks||[],quarterlyAssessment:S.grades?.quarterly_assessment||[],grades:S.grades,id:S.account_number||S.id,name:S.full_name||`${S.first_name} ${S.last_name}`,isVerified:S.grades?.verified||S.grades?.verification?.verified||!1}))),l(),d(c,!0),d(u,!1),d(f,p(),!0),Ae.success("Grades refreshed successfully");else throw new Error(D.error||"Failed to refresh grades")}catch(m){console.error("Error refreshing grades:",m),Ae.error("Failed to refresh grades. Please try again.")}}var Lp=_('<span class="material-symbols-outlined spinning">sync</span> <span>Saving...</span>',1),$p=_('<span class="material-symbols-outlined">check_circle</span> <span>Grades Saved</span>',1),jp=_('<span class="material-symbols-outlined">save</span> <span>Save Grades</span>',1),Ip=_('<span class="material-symbols-outlined spinning">sync</span> <span>Uploading...</span>',1),Rp=_('<span class="material-symbols-outlined">upload</span> <span>Send to Adviser</span>',1),Op=_('<div class="spreadsheet-loading-overlay"><div class="spreadsheet-loader"><div class="loader-spinner"></div> <p>Loading grading spreadsheet...</p></div></div>'),qp=_('<div class="header-overlay"><span class="header-icon material-symbols-outlined">settings</span></div>'),Vp=_('<th><span class="header-text"> </span> <!></th>'),Bp=_('<input type="text" class="cell-input"/>'),zp=_('<span class="cell-content verified-cell"> </span>'),Gp=_('<span class="cell-content"> </span>'),Wp=_("<td><!></td>"),Hp=_("<tr></tr>"),Yp=_('<div class="spreadsheet-container"><table class="spreadsheet-table"><thead><tr></tr></thead><tbody></tbody></table></div>'),Up=_('<div class="save-section"><div class="refresh-button-container"><button class="refresh-grades-button" title="Refresh grades from database"><span class="material-symbols-outlined">refresh</span> <span>Refresh</span></button></div> <div class="save-button-container"><button><!></button> <button class="final-grades-button" title="Upload final grades (averages and computed final grades) to database"><!></button></div></div> <div class="grading-spreadsheet"><!></div>',1);function Qp(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=La(t,"students",23,()=>[]),c=La(t,"gradingPeriodId",3,1),u=La(t,"gradingConfig",23,()=>({writtenWork:{count:3,weight:.3,totals:[]},performanceTasks:{count:3,weight:.5,totals:[]},quarterlyAssessment:{count:1,weight:.2,totals:[]}})),f=kt(!1),p=kt(!1),m=kt(""),g=kt(!1),y=kt(!1),b=kt(!0),D=kt(null),S,k=kt(null),A=kt(!1),E=kt(""),M=kt(!0),I=kt(!1),F=kt(Gs(new Set)),z=kt(Gs([]));Gs([]);function R(q){if(q==null||q==="")return"0";const B=parseFloat(q);return isNaN(B)?q:(B%1===0,B.toString())}function J(){return JSON.parse(JSON.stringify(l().map(q=>({id:q.id,writtenWork:Array.isArray(q.writtenWork)?[...q.writtenWork]:[],performanceTasks:Array.isArray(q.performanceTasks)?[...q.performanceTasks]:[],quarterlyAssessment:Array.isArray(q.quarterlyAssessment)?[...q.quarterlyAssessment]:[]}))))}function V(){if(!e(D))return!1;const q=J(),B=JSON.stringify(q)!==JSON.stringify(e(D));return d(y,B),d(b,!B),B}function L(){const q=["Student ID","Student Name"];for(let B=1;B<=u().writtenWork.count;B++)q.push(tt("writtenWork",B-1));q.push("WW Avg");for(let B=1;B<=u().performanceTasks.count;B++)q.push(tt("performanceTasks",B-1));q.push("PT Avg");for(let B=1;B<=u().quarterlyAssessment.count;B++)q.push(tt("quarterlyAssessment",B-1));q.push("QA Avg"),q.push("Final Grade"),d(z,[q],!0),l().forEach(B=>{if(!B||!B.id||!B.name){console.warn("Invalid student data:",B);return}const N=[B.id,B.name],Z=B.writtenWork||[];for(let he=0;he<u().writtenWork.count;he++)N.push(R(Z[he]));N.push(X(Z,u().writtenWork.totals,"writtenWork"));const be=B.performanceTasks||[];for(let he=0;he<u().performanceTasks.count;he++)N.push(R(be[he]));N.push(X(be,u().performanceTasks.totals,"performanceTasks"));const Fe=B.quarterlyAssessment||[];for(let he=0;he<u().quarterlyAssessment.count;he++)N.push(R(Fe[he]));N.push(X(Fe,u().quarterlyAssessment.totals,"quarterlyAssessment")),N.push(ne(B)),e(z).push(N)}),d(D,J(),!0),d(b,!1),d(y,!1),d(M,!1)}function X(q,B=null,N=null){if(!q||!Array.isArray(q))return"";const Z=q.filter(Fe=>Fe!=null&&Fe!=="");if(Z.length===0)return"";let be=0;if(B&&B.length>0){let Fe=0,he=0;const te=Math.min(q.length,B.length);for(let K=0;K<te;K++){const ae=q[K];if(ae!=null&&ae!==""){const Oe=parseFloat(ae),Be=B[K];if(Be&&Be>0){const Ke=Oe/Be*100;Fe+=Ke,he++}}}if(he===0)return"";const j=Math.round(Fe/he*10)/10;return R(j)}else{be=Z.reduce((he,te)=>he+parseFloat(te),0);const Fe=Math.round(be/Z.length*10)/10;return R(Fe)}}function ne(q){if(!q)return"";const B=X(q.writtenWork,u().writtenWork.totals,"writtenWork"),N=X(q.performanceTasks,u().performanceTasks.totals,"performanceTasks"),Z=X(q.quarterlyAssessment,u().quarterlyAssessment.totals,"quarterlyAssessment");if(B===""||N===""||Z==="")return"";const be=parseFloat(B)||0,Fe=parseFloat(N)||0,he=parseFloat(Z)||0,te=be*u().writtenWork.weight+Fe*u().performanceTasks.weight+he*u().quarterlyAssessment.weight,j=Math.round(te*10)/10;return R(j)}function ce(q,B,N){if(B<2)return;const Z=q-1,be=l()[Z];if(be&&be.isVerified){Ae.warning("This student's grades have been verified by the adviser and cannot be edited.");return}d(k,{row:q,col:B},!0),d(A,!1)}function Le(q){if(!e(k)||e(A))return;const{row:B,col:N}=e(k);if(q.key==="ArrowUp"||q.key==="ArrowDown"||q.key==="ArrowLeft"||q.key==="ArrowRight"){q.preventDefault(),fe(q.key);return}if(q.key==="Enter"){q.preventDefault(),fe("ArrowDown");return}if(q.key==="Tab"){q.preventDefault(),fe(q.shiftKey?"ArrowLeft":"ArrowRight");return}if(/^[0-9.]$/.test(q.key)&&!re(N)&&N>1){const Z=B-1,be=l()[Z];if(be&&be.isVerified){Ae.warning("This student's grades have been verified by the adviser and cannot be edited.");return}q.preventDefault(),d(A,!0),d(E,q.key,!0),d(I,!1)}else if(q.key.length===1&&!re(N)&&N>1){const Z=B-1,be=l()[Z];if(be&&be.isVerified){Ae.warning("This student's grades have been verified by the adviser and cannot be edited.");return}q.preventDefault(),d(A,!0),d(E,q.key,!0),d(I,!1)}}function fe(q){if(!e(k)||!e(z).length)return;const{row:B,col:N}=e(k),Z=e(z).length-1,be=e(z)[0].length-1;let Fe=B,he=N;switch(q){case"ArrowUp":Fe=Math.max(1,B-1);break;case"ArrowDown":Fe=Math.min(Z,B+1);break;case"ArrowLeft":he=Math.max(0,N-1);break;case"ArrowRight":he=Math.min(be,N+1);break}d(k,{row:Fe,col:he},!0),se(Fe,he)}function se(q,B){if(!S)return;const N=S.querySelector(`tbody tr:nth-child(${q}) td:nth-child(${B+1})`);N&&N.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}function re(q){const N=e(z)[0][q];return N?.includes("Avg")||N==="Final Grade"}function Se(q){return Xe(q)!==null}function me(q){const N=e(z)[0][q];return q<2?"student-info":N==="Final Grade"||N?.includes("Avg")?"calculated":N?.startsWith("WW")?"written-work":N?.startsWith("PT")?"performance-task":N?.startsWith("QA")?"quarterly-assessment":"default"}function ze(q,B){B.preventDefault(),B.stopPropagation(),Se(q)&&st(q)}function Xe(q){let B=2;for(let N=0;N<u().writtenWork.count;N++){if(B===q)return{assessmentType:"writtenWork",columnIndex:N};B++}B++;for(let N=0;N<u().performanceTasks.count;N++){if(B===q)return{assessmentType:"performanceTasks",columnIndex:N};B++}B++;for(let N=0;N<u().quarterlyAssessment.count;N++){if(B===q)return{assessmentType:"quarterlyAssessment",columnIndex:N};B++}return null}function tt(q,B){const N=ve(q,B),Z=u()[q].totals[B]||100;return`${N} - ${Z}`}function ve(q,B){if(u()[q].columnNames&&u()[q].columnNames[B])return u()[q].columnNames[B];const N=q==="writtenWork"?"WW":q==="performanceTasks"?"PT":"QA";return u()[q].columnPositions&&u()[q].columnPositions[B]!==void 0?`${N}${u()[q].columnPositions[B]}`:`${N}${B+1}`}function $e(){return l().some(q=>q.isVerified||q.verified)}function Je(){if(!e(k)||e(k).row===0)return;const{row:q,col:B}=e(k),N=q-1,Z=l()[N];if(!Z)return;const be=Xe(B);if(!be)return;const{assessmentType:Fe,columnIndex:he}=be;let te=e(E).trim(),j=null,K=!0,ae="";if(te!==""){if(j=parseFloat(te),isNaN(j)||j<0)j=0,K=!1,ae=isNaN(parseFloat(te))?"Invalid input. Only numbers are allowed.":"Negative scores are not allowed.";else{const Oe=u()[Fe].totals?.[he];Oe&&j>Oe&&(j=0,K=!1,ae=`Score cannot exceed the total score of ${Oe}.`)}K?e(F).delete(`${q}-${B}`):(Ae.error(ae),e(F).add(`${q}-${B}`),setTimeout(()=>{e(F).delete(`${q}-${B}`),d(F,new Set(e(F)),!0)},3e3))}else j=null,e(F).delete(`${q}-${B}`);Z[Fe][he]=j,l([...l()]),L(),V()}function Re(q,B,N){if(e(k)&&e(A)){if(q.key==="Enter"){q.preventDefault();const Z=e(k).row,be=e(k).col;Je(),d(A,!1),setTimeout(()=>{d(k,{row:Z,col:be},!0),fe("ArrowDown")},0);return}if(q.key==="Tab"){q.preventDefault();const Z=e(k).row,be=e(k).col;Je(),d(A,!1),setTimeout(()=>{d(k,{row:Z,col:be},!0),fe(q.shiftKey?"ArrowLeft":"ArrowRight")},0);return}if(q.key==="ArrowUp"||q.key==="ArrowDown"||q.key==="ArrowLeft"||q.key==="ArrowRight"){q.preventDefault();const Z=e(k).row,be=e(k).col;Je(),d(A,!1),setTimeout(()=>{d(k,{row:Z,col:be},!0),fe(q.key)},0);return}if(q.key==="Escape"){q.preventDefault(),d(A,!1),d(E,"");return}}}Wa(()=>{L()});async function Ze(){if(!t.sectionId||!t.subjectId){Ae.error("Missing section or subject information");return}d(f,!0),d(m,""),d(g,!1);try{const q=l().map(Z=>({student_id:Z.accountNumber||Z.account_number||Z.id,writtenWork:Z.writtenWork,performanceTasks:Z.performanceTasks,quarterlyAssessment:Z.quarterlyAssessment})),B=await bs("/api/grades/save",{method:"POST",body:JSON.stringify({section_id:t.sectionId,subject_id:t.subjectId,grading_period_id:c(),grading_config:u(),grades:q})});if(!B.ok){const Z=await B.json().catch(()=>({}));throw new Error(Z.error||`HTTP ${B.status}: ${B.statusText}`)}const N=await B.json();d(g,!0),Ae.success("Grades saved successfully"),d(D,J(),!0),d(y,!1),d(b,!0),setTimeout(()=>{d(m,"")},3e3)}catch(q){console.error("Error saving grades:",q),d(g,!1),d(m,q.message||"Failed to save grades",!0),Ae.error(e(m)),setTimeout(()=>{d(m,"")},5e3)}finally{d(f,!1)}}Xs(()=>{const q=l().length,B=u(),N=t.subjectId;x(()=>{(q>0||B||N)&&L()})}),Xs(()=>()=>{});function st(q){const B=Xe(q);if(!B){Ae.error("Cannot edit this column");return}const{assessmentType:N,columnIndex:Z}=B,be=ve(N,Z),Fe=u()[N].totals[Z]||100,he=u()[N].gradeItemIds?.[Z];if(!he){Ae.error("Cannot edit column: Grade item ID not found");return}const te=$e();ds.form("Edit Column","Edit the column name and total score for this assessment:",{label:"Column Name",type:"text",placeholder:"Enter column name",value:be},{label:"Total Score",type:"number",placeholder:"Enter total score",value:Fe,min:1,max:1e3},async(j,K)=>{if(!j||!j.trim()){Ae.error("Column name cannot be empty");return}const ae=parseInt(K);if(isNaN(ae)||ae<1||ae>1e3){Ae.error("Total score must be between 1 and 1000");return}try{const Oe=await bs("/api/grades/grade-items",{method:"PUT",body:JSON.stringify({grade_item_id:he,name:j.trim(),total_score:ae})});u()[N].columnNames||(u()[N].columnNames=[]),u()[N].columnNames[Z]=j.trim(),u()[N].totals[Z]=ae,u({...u()}),L(),Ae.success("Column updated successfully")}catch(Oe){console.error("Error updating column:",Oe),Ae.error("Failed to update column. Please try again.")}},()=>{},()=>{ds.confirm("Delete Column",`<p>Are you sure you want to permanently delete the column <strong>"${be}"</strong>?</p>
          <p class="grading-warning">This action will:</p>
          <ul class="grading-warning-list">
            <li>Permanently delete the column and all its grades</li>
            <li>Remove all student scores for this assessment</li>
            <li>This action cannot be undone</li>
          </ul>`,async()=>{try{const j=await bs("/api/grades/grade-items",{method:"DELETE",body:JSON.stringify({grade_item_id:he})});u()[N].count-=1,u()[N].columnNames&&u()[N].columnNames.splice(Z,1),u()[N].totals&&u()[N].totals.splice(Z,1),u()[N].columnPositions&&u()[N].columnPositions.splice(Z,1),u()[N].gradeItemIds&&u()[N].gradeItemIds.splice(Z,1),u({...u()}),l(l().map(K=>{const ae={...K};return N==="writtenWork"&&ae.writtenWork?ae.writtenWork.splice(Z,1):N==="performanceTasks"&&ae.performanceTasks?ae.performanceTasks.splice(Z,1):N==="quarterlyAssessment"&&ae.quarterlyAssessment&&ae.quarterlyAssessment.splice(Z,1),ae})),L(),Ae.success("Column deleted successfully")}catch(j){console.error("Error deleting column:",j),Ae.error("Failed to delete column. Please try again.")}},null,{size:"medium"})},{size:"small",deleteDisabled:te,deleteDisabledReason:te?"Cannot delete columns when grades are verified by adviser":""})}var We=Up();Q("keydown",Ys,Le);var nt=ut(We),ke=o(nt),De=o(ke);De.__click=[Np,r,t,c,l,L,b,y,D,J],n(ke);var Ie=v(ke,2),Ee=o(Ie);let ee;Ee.__click=Ze;var Ue=o(Ee);{var rt=q=>{var B=Lp();ia(2),h(q,B)},Ye=q=>{var B=Et(),N=ut(B);{var Z=Fe=>{var he=$p();ia(2),h(Fe,he)},be=Fe=>{var he=jp();ia(2),h(Fe,he)};C(N,Fe=>{e(b)&&!e(y)?Fe(Z):Fe(be,!1)},!0)}h(q,B)};C(Ue,q=>{e(f)?q(rt):q(Ye,!1)})}n(Ee);var at=v(Ee,2);at.__click=[Fp,t,p,m,g,l,X,u,ne,c,r];var lt=o(at);{var O=q=>{var B=Ip();ia(2),h(q,B)},T=q=>{var B=Rp();ia(2),h(q,B)};C(lt,q=>{e(p)?q(O):q(T,!1)})}n(at),n(Ie),n(nt);var U=v(nt,2),de=o(U);{var Pe=q=>{var B=Op();h(q,B)},Ve=q=>{var B=Yp(),N=o(B),Z=o(N),be=o(Z);Tt(be,21,()=>e(z)[0]||[],Ka,(he,te,j)=>{var K=Vp();let ae;K.__click=ot=>ze(j,ot);var Oe=o(K),Be=o(Oe,!0);n(Oe);var Ke=v(Oe,2);{var Ge=ot=>{var gt=qp();h(ot,gt)};C(Ke,ot=>{Se(j)&&ot(Ge)})}n(K),$((ot,gt)=>{ae=oe(K,1,"spreadsheet-header",null,ae,ot),$t(K,"title",gt),w(Be,e(te))},[()=>({"student-info":j<2,calculated:re(j),"final-grade":me(j)==="final-grade",clickable:Se(j)}),()=>Se(j)?"Click to set total scores":""]),h(he,K)}),n(be),n(Z);var Fe=v(Z);Tt(Fe,21,()=>e(z).slice(1),Ka,(he,te,j)=>{var K=Hp();let ae;Tt(K,21,()=>e(te),Ka,(Oe,Be,Ke)=>{var Ge=Wp();let ot;Ge.__click=Qe=>ce(j+1,Ke);var gt=o(Ge);{var Yt=Qe=>{var Y=Bp();sa(Y),Y.__keydown=le=>Re(le),Yc(Y),Q("blur",Y,()=>{Je(),d(A,!1)}),la(Y,()=>e(E),le=>d(E,le)),h(Qe,Y)},ge=Qe=>{var Y=Et(),le=ut(Y);{var Ce=ft=>{var Dt=zp(),vt=o(Dt,!0);n(Dt),$(()=>w(vt,e(Be))),h(ft,Dt)},et=ft=>{var Dt=Gp(),vt=o(Dt,!0);n(Dt),$(()=>w(vt,e(Be))),h(ft,Dt)};C(le,ft=>{e(A)&&e(k)?.row===j+1&&e(k)?.col===Ke&&l()[j]?.isVerified?ft(Ce):ft(et,!1)},!0)}h(Qe,Y)};C(gt,Qe=>{e(A)&&e(k)?.row===j+1&&e(k)?.col===Ke&&!l()[j]?.isVerified?Qe(Yt):Qe(ge,!1)})}n(Ge),$(Qe=>ot=oe(Ge,1,"spreadsheet-cell",null,ot,Qe),[()=>({selected:e(k)?.row===j+1&&e(k)?.col===Ke,editing:e(A)&&e(k)?.row===j+1&&e(k)?.col===Ke,"student-info":Ke<2,calculated:re(Ke),"final-grade":me(Ke)==="final-grade",editable:!re(Ke)&&Ke>1,invalid:e(F).has(`${j+1}-${Ke}`)})]),h(Oe,Ge)}),n(K),$(Oe=>ae=oe(K,1,"spreadsheet-row",null,ae,Oe),[()=>({verified:l()[j]?.isVerified})]),h(he,K)}),n(Fe),n(N),n(B),Pi(B,he=>S=he,()=>S),h(q,B)};C(de,q=>{e(M)?q(Pe):q(Ve,!1)})}n(U),Pi(U,q=>S=q,()=>S),$(q=>{ee=oe(Ee,1,"save-grades-button",null,ee,q),Ee.disabled=e(f)||e(b)&&!e(y),$t(Ee,"title",e(b)&&!e(y)?"All grades are saved":"Save all grades to database"),at.disabled=e(p)},[()=>({saved:e(b)&&!e(y)})]),h(s,We);var Me=Ga({saveGrades:Ze});return i(),Me}Is(["click","keydown"]);var Jp=(s,t)=>t.onBackToClassManagement&&t.onBackToClassManagement(),Kp=_('<button><span class="material-symbols-outlined">book</span> </button>'),Xp=_('<div class="subject-tab-navigation"></div>'),Zp=(s,t)=>t("writtenWork"),eh=(s,t)=>t("performanceTasks"),th=(s,t)=>t("quarterlyAssessment"),ah=_('<div class="loading-container"><div class="system-loader"></div> <p>Loading class data...</p></div>'),sh=_('<div class="error-container"><div class="error-icon"><span class="material-symbols-outlined">error</span></div> <p class="error-message"> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),ih=_(`<div class="empty-state"><div class="empty-icon"><span class="material-symbols-outlined">school</span></div> <h3>No Students Found</h3> <p>This section doesn't have any enrolled students yet.</p></div>`),nh=_('<div class="class-management-container"><div class="classlist-page-header"><div class="header-content"><div class="header-navigation"><button class="back-button"><span class="material-symbols-outlined">arrow_back</span> <span>Back to Class Management</span></button></div> <h1 class="classlist-page-title">Class Grading Sheet</h1> <p class="classlist-page-subtitle"> </p></div> <!></div> <div class="grading-config-section"><h2 class="config-title">Grading Configuration</h2> <div class="config-grid"><div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div> <div class="config-item"><label class="config-label"> </label> <div class="classlist-column-controls"><div class="classlist-column-count"><span class="classlist-column-text"><!></span></div> <div class="classlist-action-buttons"><button type="button" class="classlist-add-column-button"><span class="material-symbols-outlined">add</span></button></div></div></div></div> <!></div></div> <!>',1);function rh(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);let l=kt(!0),c=kt(null),u=kt(!1),f=kt(!1),p=kt(null),m=kt(1),g=kt("1st Quarter"),y=kt("2025-2026"),b=kt(0),D=kt(null),S=Ra(()=>e(p)?.subjects?.[e(b)]||null);async function k(ge){if(!(!e(p)?.subjects||ge<0||ge>=e(p).subjects.length)){if(e(D)&&typeof e(D).saveGrades=="function")try{await e(D).saveGrades()}catch{}d(b,ge,!0),d(R,{writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}},!0),setTimeout(async()=>{try{await I(),await z()}catch(Qe){console.error("Error fetching data for subject:",Qe)}},0)}}let A=Ra(()=>e(p)?{yearLevel:e(p).section.grade_level,sectionName:e(p).section.section_name,gradeName:`Grade ${e(p).section.grade_level}`,subject:e(S)?.name||"No Subject",section:`Grade ${e(p).section.grade_level} - ${e(p).section.section_name}`,quarter:e(g),totalStudents:e(p).students?.length||0,adviser:`${e(p).section.adviser_first_name||""} ${e(p).section.adviser_last_name||""}`.trim()||"No Adviser",room:e(p).section.room_name||"No Room"}:t.selectedClass?{yearLevel:t.selectedClass.yearLevel,sectionName:t.selectedClass.sectionName,gradeName:`Grade ${t.selectedClass.yearLevel}`,subject:"Loading...",section:`Grade ${t.selectedClass.yearLevel} - ${t.selectedClass.sectionName}`,quarter:e(g),totalStudents:0}:{yearLevel:7,sectionName:"Section A",gradeName:"Grade 7",subject:"Mathematics",section:"Grade 7 - Section A",quarter:e(g),totalStudents:0}),E=kt(Gs([]));async function M(){try{const Qe=await(await fetch("/api/current-quarter")).json();Qe.success&&Qe.data?(d(m,Qe.data.currentQuarter,!0),d(g,Qe.data.quarterName,!0),d(y,Qe.data.currentSchoolYear||"2025-2026",!0),console.log(`Current quarter set to: ${e(g)} (Quarter ${e(m)})`),console.log(`Current school year set to: ${e(y)}`)):(d(m,1),d(g,"1st Quarter"),d(y,"2025-2026"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter and 2025-2026"))}catch(ge){console.error("Error fetching current quarter:",ge),d(m,1),d(g,"1st Quarter"),d(y,"2025-2026")}}async function I(){if(!(!t.selectedClass||!e(S)))try{const ge=await fetch(`/api/grades/grade-items?section_id=${t.selectedClass.sectionId}&subject_id=${e(S).id}&grading_period_id=${e(m)}&teacher_id=${r().userData.id}`,{method:"GET",headers:{"Content-Type":"application/json","x-user-id":r().userData.id.toString(),"x-user-account-number":r().userData.accountNumber||"","x-user-name":encodeURIComponent(r().userData.name||"")}});if(!ge.ok)throw new Error(`HTTP error! status: ${ge.status}`);const Y=(await ge.json()).data||{},le={writtenWork:{count:Y.writtenWork?.length||0,weight:.3,label:"Written Work",totals:Y.writtenWork?.map(Ce=>Ce.totalScore)||[],columnNames:Y.writtenWork?.map(Ce=>Ce.name)||[],columnPositions:Y.writtenWork?.map((Ce,et)=>et+1)||[],gradeItemIds:Y.writtenWork?.map(Ce=>Ce.id)||[]},performanceTasks:{count:Y.performanceTasks?.length||0,weight:.5,label:"Performance Tasks",totals:Y.performanceTasks?.map(Ce=>Ce.totalScore)||[],columnNames:Y.performanceTasks?.map(Ce=>Ce.name)||[],columnPositions:Y.performanceTasks?.map((Ce,et)=>et+1)||[],gradeItemIds:Y.performanceTasks?.map(Ce=>Ce.id)||[]},quarterlyAssessment:{count:Y.quarterlyAssessment?.length||0,weight:.2,label:"Quarterly Assessment",totals:Y.quarterlyAssessment?.map(Ce=>Ce.totalScore)||[],columnNames:Y.quarterlyAssessment?.map(Ce=>Ce.name)||[],columnPositions:Y.quarterlyAssessment?.map((Ce,et)=>et+1)||[],gradeItemIds:Y.quarterlyAssessment?.map(Ce=>Ce.id)||[]}};d(R,le,!0)}catch(ge){console.error("Error fetching grading configuration:",ge),fe("Failed to load grading configuration","error")}}async function F(){if(!e(u))try{if(d(l,!0),d(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");const ge=r(),Qe=ge.isAuthenticated?ge.userData?.id:null,Y=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString()});Qe&&Y.append("teacherId",Qe.toString());const Ce=await(await fetch(`/api/class-students?${Y}`)).json();if(!Ce.success)throw new Error(Ce.error||"Failed to fetch section data");d(p,Ce.data,!0)}catch(ge){console.error("Error fetching section data:",ge),d(c,ge.message,!0)}finally{d(l,!1)}}async function z(){if(!e(u))try{if(d(l,!0),d(c,null),!t.selectedClass?.sectionId)throw new Error("No section selected");if(!e(S)?.id)return;const ge=r(),Qe=ge.isAuthenticated?ge.userData?.id:null,Y=new URLSearchParams({sectionId:t.selectedClass.sectionId.toString(),schoolYear:e(y)});Qe&&Y.append("teacherId",Qe.toString()),e(S)?.id&&Y.append("subjectId",e(S).id.toString()),e(m)&&Y.append("gradingPeriodId",e(m).toString());const Ce=await(await fetch(`/api/class-students?${Y}`)).json();if(!Ce.success)throw new Error(Ce.error||"Failed to fetch class students");d(p,Ce.data,!0),d(E,Ce.data.students.map(et=>({...et,writtenWork:et.grades?.written_work||[],performanceTasks:et.grades?.performance_tasks||[],quarterlyAssessment:et.grades?.quarterly_assessment||[],grades:et.grades,id:et.account_number||et.id,name:et.full_name||`${et.first_name} ${et.last_name}`,isVerified:et.grades?.verified||et.grades?.verification?.verified||!1})),!0)}catch(ge){console.error("Error fetching class students:",ge),d(c,ge.message,!0),d(p,null),d(E,[],!0)}finally{d(l,!1)}}let R=kt(Gs({writtenWork:{count:0,weight:.3,label:"Written Work",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},performanceTasks:{count:0,weight:.5,label:"Performance Tasks",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]},quarterlyAssessment:{count:0,weight:.2,label:"Quarterly Assessment",totals:[],columnNames:[],columnPositions:[],gradeItemIds:[]}})),J=kt(""),V=kt("error"),L=kt(!1);function X(ge){}function ne(){return e(E).some(ge=>ge.isVerified||ge.verified)}async function ce(ge){if(e(R)[ge].count<10&&!e(f)&&!e(u))try{if(d(f,!0),!{writtenWork:1,performanceTasks:2,quarterlyAssessment:3}[ge]){console.error("Invalid category:",ge);return}if(!r().isAuthenticated||!r().userData?.id){console.error("User not authenticated");return}const le={writtenWork:"WW",performanceTasks:"PT",quarterlyAssessment:"QA"},Ce=e(R)[ge].count,et=`${le[ge]} ${Ce+1}`,ft=await fetch("/api/grades/grade-items",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":r().userData.id.toString(),"x-user-account-number":r().userData.accountNumber||"","x-user-name":encodeURIComponent(r().userData.name||"")},body:JSON.stringify({action:"create_grade_item",section_id:t.selectedClass?.sectionId||e(p)?.section?.id,subject_id:e(S)?.id||t.selectedClass?.subjectId||e(p)?.subjects?.[0]?.id,grading_period_id:e(m),teacher_id:r().userData.id,category:ge,name:et,total_score:100})});if(!ft.ok){const He=await ft.json();console.error("Failed to add grade item:",He.error);return}const Dt=await ft.json();if(e(R)[ge].count+=1,e(R)[ge].gradeItemIds||(e(R)[ge].gradeItemIds=[]),e(R)[ge].gradeItemIds.push(Dt.data.id),e(R)[ge].columnNames||(e(R)[ge].columnNames=[]),e(R)[ge].columnNames.push(Dt.data.name),!e(R)[ge].columnPositions){e(R)[ge].columnPositions=[];for(let He=0;He<e(R)[ge].count-1;He++)e(R)[ge].columnPositions[He]=He+1}const vt=e(R)[ge].columnPositions||[];let Qt=1;for(;vt.includes(Qt);)Qt++;e(R)[ge].columnPositions.push(Qt),Le()}catch(Qe){console.error("Error adding column:",Qe)}finally{d(f,!1)}}function Le(){d(E,e(E).map(ge=>ge&&{...ge,writtenWork:Array(e(R).writtenWork.count).fill(0).map((Y,le)=>ge.writtenWork?.[le]||0),performanceTasks:Array(e(R).performanceTasks.count).fill(0).map((Y,le)=>ge.performanceTasks?.[le]||0),quarterlyAssessment:Array(e(R).quarterlyAssessment.count).fill(0).map((Y,le)=>ge.quarterlyAssessment?.[le]||0)}),!0)}function fe(ge,Qe="error"){d(L,!1),setTimeout(()=>{d(J,ge,!0),d(V,Qe,!0),d(L,!0)},50)}Wa(async()=>{e(u)||(await M(),await F(),await new Promise(ge=>setTimeout(ge,0)),e(p)?.subjects&&e(p).subjects.length>0?(e(b)>=e(p).subjects.length&&d(b,0),await z(),await I()):(d(c,"No subjects found for this section"),d(l,!1)))}),Hr(()=>{d(u,!0),d(l,!1)});var se=nh();Q("click",Ys,X);var re=ut(se),Se=o(re),me=o(Se),ze=o(me),Xe=o(ze);Xe.__click=[Jp,t],n(ze);var tt=v(ze,4),ve=o(tt);n(tt),n(me);var $e=v(me,2);{var Je=ge=>{var Qe=Xp();Tt(Qe,21,()=>e(p).subjects,Ka,(Y,le,Ce)=>{var et=Kp();let ft;et.__click=()=>k(Ce);var Dt=v(o(et));n(et),$(vt=>{ft=oe(et,1,"subject-tab-button",null,ft,vt),w(Dt,` ${e(le).name??""}`)},[()=>({active:e(b)===Ce})]),h(Y,et)}),n(Qe),h(ge,Qe)};C($e,ge=>{e(p)?.subjects&&e(p).subjects.length>1&&ge(Je)})}n(Se);var Re=v(Se,2),Ze=v(o(Re),2),st=o(Ze),We=o(st),nt=o(We);n(We);var ke=v(We,2),De=o(ke),Ie=o(De),Ee=o(Ie);{var ee=ge=>{var Qe=ka("Loading...");h(ge,Qe)},Ue=ge=>{var Qe=ka();$(()=>w(Qe,`${e(R).writtenWork.count??""} Column${e(R).writtenWork.count!==1?"s":""}`)),h(ge,Qe)};C(Ee,ge=>{e(l)?ge(ee):ge(Ue,!1)})}n(Ie),n(De);var rt=v(De,2),Ye=o(rt);Ye.__click=[Zp,ce],n(rt),n(ke),n(st);var at=v(st,2),lt=o(at),O=o(lt);n(lt);var T=v(lt,2),U=o(T),de=o(U),Pe=o(de);{var Ve=ge=>{var Qe=ka("Loading...");h(ge,Qe)},Me=ge=>{var Qe=ka();$(()=>w(Qe,`${e(R).performanceTasks.count??""} Column${e(R).performanceTasks.count!==1?"s":""}`)),h(ge,Qe)};C(Pe,ge=>{e(l)?ge(Ve):ge(Me,!1)})}n(de),n(U);var q=v(U,2),B=o(q);B.__click=[eh,ce],n(q),n(T),n(at);var N=v(at,2),Z=o(N),be=o(Z);n(Z);var Fe=v(Z,2),he=o(Fe),te=o(he),j=o(te);{var K=ge=>{var Qe=ka("Loading...");h(ge,Qe)},ae=ge=>{var Qe=ka();$(()=>w(Qe,`${e(R).quarterlyAssessment.count??""} Column${e(R).quarterlyAssessment.count!==1?"s":""}`)),h(ge,Qe)};C(j,ge=>{e(l)?ge(K):ge(ae,!1)})}n(te),n(he);var Oe=v(he,2),Be=o(Oe);Be.__click=[th,ce],n(Oe),n(Fe),n(N),n(Ze);var Ke=v(Ze,2);{var Ge=ge=>{var Qe=ah();h(ge,Qe)},ot=ge=>{var Qe=Et(),Y=ut(Qe);{var le=et=>{var ft=sh(),Dt=v(o(ft),2),vt=o(Dt);n(Dt);var Qt=v(Dt,2);Qt.__click=z,n(ft),$(()=>w(vt,`Error: ${e(c)??""}`)),h(et,ft)},Ce=et=>{var ft=Et(),Dt=ut(ft);{var vt=He=>{var je=ih();h(He,je)},Qt=He=>{{let je=Ra(()=>t.selectedClass?.sectionId),jt=Ra(()=>e(S)?.id);Pi(Qp(He,{get sectionId(){return e(je)},get subjectId(){return e(jt)},get gradingPeriodId(){return e(m)},get students(){return e(E)},set students(aa){d(E,aa,!0)},get gradingConfig(){return e(R)},set gradingConfig(aa){d(R,aa,!0)}}),aa=>d(D,aa,!0),()=>e(D))}};C(Dt,He=>{e(E).length===0?He(vt):He(Qt,!1)},!0)}h(et,ft)};C(Y,et=>{e(c)?et(le):et(Ce,!1)},!0)}h(ge,Qe)};C(Ke,ge=>{e(l)?ge(Ge):ge(ot,!1)})}n(Re),n(re);var gt=v(re,2);{var Yt=ge=>{td(ge,{get message(){return e(J)},get type(){return e(V)},onClose:()=>d(L,!1)})};C(gt,ge=>{e(L)&&ge(Yt)})}$((ge,Qe,Y,le,Ce,et,ft,Dt,vt)=>{w(ve,`${e(A).section??""}  ${e(A).subject??""}  ${e(A).quarter??""}`),w(nt,`Written Work (${ge??""}%)`),Ye.disabled=Qe,$t(Ye,"title",Y),w(O,`Performance Tasks (${le??""}%)`),B.disabled=Ce,$t(B,"title",et),w(be,`Quarterly Assessment (${ft??""}%)`),Be.disabled=Dt,$t(Be,"title",vt)},[()=>Math.round(e(R).writtenWork.weight*100),()=>e(R).writtenWork.count>=10||e(f)||ne(),()=>ne()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(R).performanceTasks.weight*100),()=>e(R).performanceTasks.count>=10||e(f)||ne(),()=>ne()?"Cannot add columns when grades are verified":"Add Column",()=>Math.round(e(R).quarterlyAssessment.weight*100),()=>e(R).quarterlyAssessment.count>=10||e(f)||ne(),()=>ne()?"Cannot add columns when grades are verified":"Add Column"]),h(s,se),Ga(),i()}Is(["click"]);var oh=_('<div class="advisory-stat-card"><div class="advisory-stat-icon"><span class="material-symbols-outlined"> </span></div> <div class="stat-content"><div class="advisory-stat-value"><!> <!></div> <div class="advisory-stat-label"> </div></div></div>'),lh=_('<div class="students-loading"><div class="dashboard-loader"></div> <p>Loading students and grades...</p></div>'),ch=_('<div class="students-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),dh=_('<div class="students-empty"><span class="material-symbols-outlined">school</span> <p>No students found in this advisory class</p></div>'),uh=_('<div class="loading-spinner"></div> <div class="overlay-text">Processing...</div>',1),vh=_('<span class="material-symbols-outlined">verified</span> <div class="overlay-text">Verify</div>',1),fh=_('<small class="submitted-date"> </small>'),ph=_('<small class="submitted-date not-submitted">Grades not submitted yet</small>'),hh=_('<div class="grade-score-display"> </div>'),mh=_('<div class="grade-score-display" style="color: #666;">N/A</div>'),gh=_('<button><div class="grade-overlay"><div class="overlay-content"><!></div></div> <div class="grade-item-header"><div class="grade-info"><div class="subject-name"> </div> <div class="subject-teacher"> </div> <!></div> <div class="grade-controls"><!></div></div></button>'),_h=_('<div class="student-grades"><div class="grades-header"><h4 class="grades-title"> </h4> <div class="student-verification-controls"><button class="verify-btn"><span class="material-symbols-outlined">verified</span> Verify All</button></div></div> <div class="grades-grid"></div></div>'),bh=_('<div><div class="student-header"><div class="student-header-content"><div class="student-title-section"><h3 class="student-title"> </h3></div> <div class="student-info-row"><div class="student-info-item"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="student-info-item"><span class="material-symbols-outlined">assignment</span> <span> </span></div></div></div> <div class="student-average"><div class="average-score"> </div></div> <div class="expand-icon"><span class="material-symbols-outlined"> </span></div></div> <!></div>'),yh=_('<div class="advisory-class-container"><div class="advisory-page-header"><div class="header-content"><h1 class="advisory-page-title">Advisory Class Dashboard</h1> <div class="advisory-class-info"><div class="class-detail"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">meeting_room</span> <span> </span></div> <div class="class-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div></div></div> <div class="advisory-stats-section"><div class="advisory-stats-grid"></div></div> <div class="students-section"><div class="section-header"><button class="refresh-btn"><span class="material-symbols-outlined">refresh</span> Refresh</button> <div class="bulk-controls"><button class="verify-all-btn"><span class="material-symbols-outlined">verified</span> Verify All Grades</button></div></div> <div class="advisory-students-grid"><!></div></div></div>');function wh(s,t){za(t,!0);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a);function l(ke){if(!ke)return null;const De=new Date(ke),Ie=String(De.getMonth()+1).padStart(2,"0"),Ee=String(De.getDate()).padStart(2,"0"),ee=De.getFullYear();return`${Ie}-${Ee}-${ee}`}let c=kt(!0),u=kt(null),f=kt(Gs({averageGrade:null})),p=kt(Gs([])),m=kt(Gs(new Set)),g=kt(2),y=kt("2nd Quarter");async function b(){try{d(c,!0),d(u,null);const ke=await da.get(`/api/teacher-advisory?teacher_id=${r().userData.id}&quarter=${e(g)}`);ke.success?(d(f,{...e(f),...ke.data.advisoryData},!0),ke.data.students&&d(p,ke.data.students.map(De=>({id:De.id.toString(),name:De.name,full_name:De.name,studentNumber:De.student_number,gradeLevel:De.grade_level,gradesVerified:De.grades_verified,finalGrades:De.subjects.map(Ie=>({id:`${De.id}_${Ie.subject_id}`,subjectName:Ie.subject_name,subjectCode:Ie.subject_code,teacherName:Ie.teacher_name,finalGrade:Ie.averages.final_grade,verified:Ie.verified,verifiedAt:Ie.verified_at,submittedToAdviser:Ie.submitted_to_adviser})),grades:De.subjects.map(Ie=>({subject:Ie.subject_name,teacher:Ie.teacher_name,grade:Ie.averages.final_grade,quarter:e(y),verified:Ie.verified,submittedDate:Ie.submitted_at?l(Ie.submitted_at):null,submittedToAdviser:Ie.submitted_to_adviser,gradeItems:[]}))})),!0)):d(u,ke.error||"Failed to fetch advisory data",!0)}catch(ke){console.error("Error fetching advisory data:",ke),d(u,"Failed to load advisory data. Please try again.")}finally{d(c,!1)}}async function D(){try{const De=await(await fetch("/api/current-quarter")).json();De.success&&De.data?(d(g,De.data.currentQuarter,!0),d(y,De.data.quarterName,!0),console.log(`Current quarter set to: ${e(y)} (Quarter ${e(g)})`)):(d(g,1),d(y,"1st Quarter"),console.warn("Failed to fetch current quarter, defaulting to 1st Quarter"))}catch(ke){console.error("Error fetching current quarter:",ke),d(g,1),d(y,"1st Quarter")}}Wa(async()=>{r().userData?.id&&(await D(),await b())});const S=Ra(()=>e(p).map(ke=>{if(!ke.finalGrades||ke.finalGrades.length===0)return{...ke,average:0,verifiedGradesCount:0,pendingGradesCount:ke.grades?.length||0};const Ie=ke.finalGrades.reduce((ee,Ue)=>ee+(Ue.finalGrade||0),0)/ke.finalGrades.length,Ee=ke.finalGrades?.filter(ee=>ee.verified)||[];return{...ke,average:Math.round(Ie*10)/10,verifiedGradesCount:Ee.length,pendingGradesCount:(ke.finalGrades?.length||0)-Ee.length}}));Xs(()=>{if(e(f)&&e(S).length>0){const ke=e(S).map(De=>De.average).filter(De=>De!==null&&De>0);ke.length>0?e(f).averageGrade=Math.round(ke.reduce((De,Ie)=>De+Ie,0)/ke.length*10)/10:e(f).averageGrade=null}else e(f)&&(e(f).averageGrade=null)});async function k(ke){if(!ke||e(m).has(ke))return;const[De,Ie]=ke.split("_"),Ee=e(p).find(Ye=>Ye.id===De),ee=Ee?.finalGrades?.find(Ye=>Ye.id===ke),Ue=ee?.subjectName||"Unknown Subject",rt=Ee?.full_name||"Unknown Student";if(ee?.finalGrade===null||ee?.finalGrade==="N/A"||ee?.finalGrade===""){Ae.error(`Cannot verify ${Ue} grade for ${rt} - grade is N/A`);return}ds.confirm("Verify Grade",`Are you sure you want to verify the ${Ue} grade for ${rt}?`,async()=>{e(m).add(ke),d(m,new Set(e(m)),!0);try{const Ye=await da.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:De,section_id:e(f).section_id,teacher_id:r().userData.id,quarter:e(g),verified:!0});Ye.success?(d(p,e(p).map(at=>{const lt={...at,finalGrades:at.finalGrades?.map(T=>T.id===ke?{...T,verified:!0}:T)||[]},O=lt.finalGrades?.every(T=>T.verified)||!1;return lt.gradesVerified=O,lt}),!0),Ae.success(`${Ue} grade verified for ${rt}`),e(m).delete(ke),d(m,new Set(e(m)),!0)):(console.error("Failed to verify grade:",Ye.error),Ae.error(Ye.error||"Failed to verify grade. Please try again."),e(m).delete(ke),d(m,new Set(e(m)),!0))}catch(Ye){console.error("Error verifying grade:",Ye),Ae.error("Failed to verify grade. Please try again."),e(m).delete(ke),d(m,new Set(e(m)),!0)}},()=>{})}async function A(ke){const De=e(p).find(ee=>ee.id===ke),Ie=De?.full_name||"Unknown Student";if(De?.finalGrades?.some(ee=>ee.finalGrade===null||ee.finalGrade==="N/A"||ee.finalGrade==="")){Ae.error(`Cannot verify all grades for ${Ie} - some grades are N/A`);return}ds.confirm("Verify All Grades",`Are you sure you want to verify all grades for ${Ie}?`,async()=>{try{const ee=await da.post("/api/teacher-advisory",{action:"verify_student_grades",student_id:ke,section_id:e(f).section_id,teacher_id:r().userData.id,quarter:e(g),verified:!0});ee.success?(d(p,e(p).map(Ue=>Ue.id===ke?{...Ue,gradesVerified:!0,finalGrades:Ue.finalGrades?.map(rt=>({...rt,verified:!0}))||[]}:Ue),!0),Ae.success(`All grades verified for ${Ie}`)):(console.error("Failed to verify student grades:",ee.error),Ae.error(ee.error||"Failed to verify student grades. Please try again."))}catch(ee){console.error("Error verifying student grades:",ee),Ae.error("Failed to verify student grades. Please try again.")}},()=>{})}async function E(){const ke=e(p).filter(De=>De.finalGrades?.some(Ie=>Ie.finalGrade===null||Ie.finalGrade==="N/A"||Ie.finalGrade===""));if(ke.length>0){const De=ke.map(Ie=>Ie.full_name).join(", ");Ae.error(`Cannot verify all grades - the following students have N/A grades: ${De}`);return}ds.confirm("Verify All Students","Are you sure you want to verify all grades for all students in this class?",async()=>{try{const De=await da.post("/api/teacher-advisory",{action:"verify_all_grades",section_id:e(f).section_id,teacher_id:r().userData.id,quarter:e(g),verified:!0});De.success?(d(p,e(p).map(Ie=>({...Ie,gradesVerified:!0,finalGrades:Ie.finalGrades?.map(Ee=>({...Ee,verified:!0}))||[],grades:Ie.grades.map(Ee=>({...Ee,verified:!0}))})),!0),Ae.success("All student grades verified successfully")):(console.error("Failed to verify all students:",De.error),Ae.error(De.error||"Failed to verify all students. Please try again."))}catch(De){console.error("Error verifying all students:",De),Ae.error("Failed to verify all students. Please try again.")}},()=>{})}let M=[{id:"students",label:"Total Students",getValue:()=>e(f)?.totalStudents||0,icon:"people",color:"var(--school-primary)"},{id:"subjects",label:"Subjects Tracked",getValue:()=>e(f)?.subjectsCount||0,icon:"book",color:"var(--school-secondary)"},{id:"average",label:"Class Average",getValue:()=>e(f)&&e(f).averageGrade!==null?`${e(f).averageGrade}`:"N/A",icon:"grade",color:"var(--school-accent)"}],I=kt(null);function F(ke){d(I,e(I)?.id===ke.id?null:ke,!0)}function z(ke){return ke>=90?"var(--success)":ke>=80?"var(--school-accent)":ke>=75?"var(--warning)":"var(--error)"}var R=yh(),J=o(R),V=o(J),L=v(o(V),2),X=o(L),ne=v(o(X),2),ce=o(ne,!0);n(ne),n(X);var Le=v(X,2),fe=v(o(Le),2),se=o(fe,!0);n(fe),n(Le);var re=v(Le,2),Se=v(o(re),2),me=o(Se,!0);n(Se),n(re),n(L),n(V),n(J);var ze=v(J,2),Xe=o(ze);Tt(Xe,21,()=>M,ke=>ke.id,(ke,De)=>{var Ie=oh(),Ee=o(Ie),ee=o(Ee),Ue=o(ee,!0);n(ee),n(Ee);var rt=v(Ee,2),Ye=o(rt),at=o(Ye);{let de=Ra(()=>e(De).getValue());Xl(at,{get value(){return e(de)},format:"d",duration:2e3,animation:"ease-out"})}var lt=v(at,2);{var O=de=>{};C(lt,de=>{e(De).id==="average"&&de(O)})}n(Ye);var T=v(Ye,2),U=o(T,!0);n(T),n(rt),n(Ie),$(()=>{as(Ee,`background-color: ${e(De).color??""}20; color: ${e(De).color??""}`),w(Ue,e(De).icon),as(Ye,`color: ${e(De).color??""}`),w(U,e(De).label)}),h(ke,Ie)}),n(Xe),n(ze);var tt=v(ze,2),ve=o(tt),$e=o(ve),Je=v($e,2),Re=o(Je);n(Je),n(ve);var Ze=v(ve,2),st=o(Ze);{var We=ke=>{var De=lh();h(ke,De)},nt=ke=>{var De=Et(),Ie=ut(De);{var Ee=Ue=>{var rt=ch(),Ye=v(o(rt),2),at=o(Ye);n(Ye),n(rt),$(()=>w(at,`Error loading students: ${e(u)??""}`)),h(Ue,rt)},ee=Ue=>{var rt=Et(),Ye=ut(rt);{var at=O=>{var T=dh();h(O,T)},lt=O=>{var T=Et(),U=ut(T);Tt(U,17,()=>e(S),de=>de.id,(de,Pe)=>{var Ve=bh();let Me;var q=o(Ve),B=o(q),N=o(B),Z=o(N),be=o(Z);n(Z),n(N);var Fe=v(N,2),he=o(Fe),te=v(o(he),2),j=o(te);n(te),n(he);var K=v(he,2),ae=o(K),Oe=o(ae,!0);n(ae);var Be=v(ae,2),Ke=o(Be,!0);n(Be),n(K);var Ge=v(K,2),ot=v(o(Ge),2),gt=o(ot);n(ot),n(Ge),n(Fe),n(B);var Yt=v(B,2),ge=o(Yt),Qe=o(ge,!0);n(ge),n(Yt);var Y=v(Yt,2),le=o(Y),Ce=o(le,!0);n(le),n(Y),n(q);var et=v(q,2);{var ft=Dt=>{var vt=_h(),Qt=o(vt),He=o(Qt),je=o(He);n(He);var jt=v(He,2),aa=o(jt);n(jt),n(Qt);var St=v(Qt,2);Tt(St,21,()=>e(Pe).grades,xt=>xt.subject,(xt,Pt)=>{const ye=Ra(()=>e(Pe).finalGrades?.find(ta=>ta.subjectName===e(Pt).subject));var H=gh();let qe;var Ct=o(H),zt=o(Ct),ua=o(zt);{var xe=ta=>{var yt=uh();ia(2),h(ta,yt)},Te=ta=>{var yt=vh();ia(2),h(ta,yt)};C(ua,ta=>{e(m).has(e(ye)?.id)?ta(xe):ta(Te,!1)})}n(zt),n(Ct);var ue=v(Ct,2),bt=o(ue),ht=o(bt),G=o(ht,!0);n(ht);var pe=v(ht,2),pt=o(pe);n(pe);var Rt=v(pe,2);{var ct=ta=>{var yt=fh(),Gt=o(yt);n(yt),$(()=>w(Gt,`Submitted: ${e(Pt).submittedDate||"N/A"}`)),h(ta,yt)},Xt=ta=>{var yt=ph();h(ta,yt)};C(Rt,ta=>{e(ye)&&e(ye).submittedToAdviser&&e(ye).finalGrade!==null?ta(ct):ta(Xt,!1)})}n(bt);var ga=v(bt,2),ba=o(ga);{var _a=ta=>{var yt=hh(),Gt=o(yt,!0);n(yt),$((Lt,Aa)=>{as(yt,`color: ${Lt??""}`),w(Gt,Aa)},[()=>z(e(ye).finalGrade),()=>Math.round(e(ye).finalGrade*10)/10]),h(ta,yt)},ya=ta=>{var yt=mh();h(ta,yt)};C(ba,ta=>{e(ye)&&e(ye).submittedToAdviser&&e(ye).finalGrade!==null?ta(_a):ta(ya,!1)})}n(ga),n(ue),n(H),$((ta,yt)=>{qe=oe(H,1,`grade-item ${e(ye)?.verified?"verified":"unverified"}`,null,qe,ta),H.disabled=yt,w(G,e(Pt).subject),w(pt,`by ${e(Pt).teacher??""}`)},[()=>({loading:e(m).has(e(ye)?.id)}),()=>e(m).has(e(ye)?.id)]),Q("click",H,()=>k(e(ye).id)),h(xt,H)}),n(St),n(vt),$(()=>w(je,`Subject Grades (${e(y)??""})`)),Q("click",aa,Ti(()=>A(e(Pe).id))),h(Dt,vt)};C(et,Dt=>{e(I)?.id===e(Pe).id&&Dt(ft)})}n(Ve),$((Dt,vt)=>{Me=oe(Ve,1,`advisory-student-card ${e(Pe).gradesVerified?"verified":"pending"}`,null,Me,Dt),w(be,`${e(Pe).name??""}  Grade ${e(Pe).gradeLevel||"7"}`),w(j,`Student #${e(Pe).studentNumber??""}`),w(Oe,e(Pe).gradesVerified?"verified":"pending"),w(Ke,e(Pe).gradesVerified?"Verified":"Pending"),w(gt,`${e(Pe).verifiedGradesCount??""} Verified, ${e(Pe).pendingGradesCount??""} Pending`),as(ge,`color: ${vt??""}`),w(Qe,e(Pe).average!==null?e(Pe).average:"N/A"),w(Ce,e(I)?.id===e(Pe).id?"expand_less":"expand_more")},[()=>({selected:e(I)?.id===e(Pe).id}),()=>e(Pe).average!==null?z(e(Pe).average):"#666"]),Q("click",q,()=>F(e(Pe))),h(de,Ve)}),h(O,T)};C(Ye,O=>{e(S).length===0?O(at):O(lt,!1)},!0)}h(Ue,rt)};C(Ie,Ue=>{e(u)?Ue(Ee):Ue(ee,!1)},!0)}h(ke,De)};C(st,ke=>{e(c)?ke(We):ke(nt,!1)})}n(Ze),n(tt),n(R),$(()=>{w(ce,e(f)?.sectionName||"Loading..."),w(se,e(f)?.roomName||"Loading..."),w(me,e(y))}),Q("click",$e,b),Q("click",Re,E),h(s,R),Ga(),i()}function xh(s,t){d(t,!e(t))}function Sh(s,t,a){d(t,!e(t)),a()}var kh=_('<img alt="Profile" class="avatar-image"/>'),Dh=_('<div class="avatar-placeholder"> </div>'),Ah=(s,t,a)=>{t(),a.onNavigateToSettings()},Ch=async(s,t,a)=>{t(),await a.onlogout(),bi("Logged out successfully. See you next time!")},Th=_('<div class="user-dropdown-menu"><button class="dropdown-item"><span class="material-symbols-outlined">settings</span> Settings</button> <button class="dropdown-item"><span class="material-symbols-outlined">logout</span> Logout</button></div>'),Mh=_('<nav class="admin-navbar"><div class="navbar-container"><div class="navbar-left"><button class="icon-button hamburger-menu" aria-label="Toggle navigation menu"><span class="material-symbols-outlined">menu</span></button> <div class="logo-section"><span class="material-symbols-outlined logo-icon">admin_panel_settings</span> <span class="app-title"> </span></div></div> <div class="navbar-right"><button class="icon-button dark-mode-toggle" aria-label="Toggle dark mode"><span class="material-symbols-outlined"> </span></button> <div class="user-profile-container"><button class="user-profile"><div class="user-info"><span class="user-name"> </span> <span class="user-id"> </span></div> <div class="user-avatar"><!></div></button> <!></div></div></div></nav>');function Ph(s,t){za(t,!0);let a=La(t,"adminName",3,"Admin User"),i=La(t,"firstName",3,"Admin"),r=La(t,"gender",3,"male"),l=La(t,"accountNumber",3,"ADM-2025-0001"),c=La(t,"profileImage",3,null);function u(ve){return ve==="female"?"Ms.":"Mr."}let f=Ra(()=>`${u(r())} ${i()}`),p=kt(!0),m=kt(!1);function g(){d(m,!1)}function y(ve){e(m)&&!ve.target.closest(".user-profile-container")&&g()}Wa(()=>{const ve=localStorage.getItem("theme");return d(p,ve!=="light"),b(),document.addEventListener("click",y),()=>{document.removeEventListener("click",y)}});function b(){e(p)?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}function D(ve){return ve.split(" ").map($e=>$e.charAt(0)).join("").toUpperCase().slice(0,2)}var S=Mh(),k=o(S),A=o(k),E=o(A);E.__click=function(...ve){t.onToggleNavRail?.apply(this,ve)};var M=v(E,2),I=v(o(M),2),F=o(I);n(I),n(M),n(A);var z=v(A,2),R=o(z);R.__click=[Sh,p,b];var J=o(R),V=o(J,!0);n(J),n(R);var L=v(R,2),X=o(L);X.__click=[xh,m];var ne=o(X),ce=o(ne),Le=o(ce,!0);n(ce);var fe=v(ce,2),se=o(fe);n(fe),n(ne);var re=v(ne,2),Se=o(re);{var me=ve=>{var $e=kh();$(()=>$t($e,"src",c())),h(ve,$e)},ze=ve=>{var $e=Dh(),Je=o($e,!0);n($e),$(Re=>w(Je,Re),[()=>D(i())]),h(ve,$e)};C(Se,ve=>{c()?ve(me):ve(ze,!1)})}n(re),n(X);var Xe=v(X,2);{var tt=ve=>{var $e=Th(),Je=o($e);Je.__click=[Ah,g,t];var Re=v(Je,2);Re.__click=[Ch,g,t],n($e),h(ve,$e)};C(Xe,ve=>{e(m)&&ve(tt)})}n(L),n(z),n(k),n(S),$(()=>{w(F,`Welcome, ${e(f)??""}`),w(V,e(p)?"light_mode":"dark_mode"),w(Le,a()),w(se,`Account: ${l()??""}`)}),h(s,S),Ga()}Is(["click"]);var Eh=(s,t,a)=>t(e(a).id),Fh=(s,t,a)=>t(e(a).id),Nh=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),Lh=_('<div class="admin-menu-folder-contents"></div>'),$h=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button> <!>',1),jh=(s,t,a)=>t(e(a).id),Ih=_('<button><div class="admin-menu-rail-icon-container"><span class="material-symbols-outlined admin-menu-rail-icon"> </span></div> <span class="admin-menu-rail-label"> </span></button>'),Rh=(s,t,a)=>t(e(a).id),Oh=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),qh=(s,t,a)=>t(e(a).id),Vh=_('<button><div class="admin-menu-nav-icon-container"><span class="material-symbols-outlined admin-menu-nav-icon"> </span></div></button>'),Bh=(s,t)=>t("management-folder"),zh=s=>s.stopPropagation(),Gh=(s,t)=>t("management-folder"),Wh=(s,t,a,i)=>{t(e(a).id),i("management-folder")},Hh=_('<button><span class="material-symbols-outlined"> </span> <span> </span></button>'),Yh=_('<div class="admin-menu-mobile-folder-overlay"><div class="admin-menu-mobile-folder-content"><div class="admin-menu-mobile-folder-header"><h3>Management</h3> <button class="admin-menu-close-folder"><span class="material-symbols-outlined">close</span></button></div> <div class="admin-menu-mobile-folder-items"></div></div></div>'),Uh=_('<nav role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-rail-container"></div></nav> <nav class="admin-menu-bottom-navigation" role="navigation" aria-label="Admin portal navigation"><div class="admin-menu-nav-container"><!> <!></div></nav>',1);function Qh(s,t){za(t,!0);let a=La(t,"adminActiveSection",15,"dashboard"),i=La(t,"adminNavRailVisible",3,!0),r=kt(!1);const l=[{id:"dashboard",label:"Dashboard",icon:"dashboard",type:"item"},{id:"management-folder",label:"Management",icon:"folder",type:"folder",expanded:e(r),items:[{id:"schedule-management",label:"Schedule",icon:"schedule"},{id:"department-management",label:"Department",icon:"corporate_fare"},{id:"subjects-and-activities",label:"Subjects & Activities",icon:"school"}]},{id:"account-creation",label:"Account Creation",icon:"person_add",type:"item"},{id:"document-requests",label:"Document Requests",icon:"description",type:"item"},{id:"student-masterlist",label:"Student Masterlist",icon:"groups",type:"item"},{id:"student-grades-list",label:"Student Grades List",icon:"grade",type:"item"},{id:"archived-students",label:"Archived Students",icon:"archive",type:"item"}];function c(E){a(E),t.onnavigate&&t.onnavigate({detail:{section:E}})}function u(E){E==="management-folder"&&d(r,!e(r))}function f(E){return E.items?.some(M=>M.id===a())||!1}var p=Uh(),m=ut(p);let g;var y=o(m);Tt(y,21,()=>l,E=>E.id,(E,M)=>{var I=Et(),F=ut(I);{var z=J=>{var V=$h(),L=ut(V);let X;L.__click=[Eh,u,M];var ne=o(L),ce=o(ne),Le=o(ce,!0);n(ce),n(ne);var fe=v(ne,2),se=o(fe,!0);n(fe),n(L);var re=v(L,2);{var Se=me=>{var ze=Lh();Tt(ze,21,()=>e(M).items,Xe=>Xe.id,(Xe,tt)=>{var ve=Nh();let $e;ve.__click=[Fh,c,tt];var Je=o(ve),Re=o(Je),Ze=o(Re,!0);n(Re),n(Je);var st=v(Je,2),We=o(st,!0);n(st),n(ve),$(nt=>{$e=oe(ve,1,"admin-menu-rail-item admin-menu-sub-item",null,$e,nt),$t(ve,"aria-label",e(tt).label),$t(ve,"aria-current",e(tt).id===a()?"page":void 0),w(Ze,e(tt).icon),w(We,e(tt).label)},[()=>({active:e(tt).id===a()})]),h(Xe,ve)}),n(ze),h(me,ze)};C(re,me=>{e(r)&&me(Se)})}$(me=>{X=oe(L,1,"admin-menu-rail-item admin-menu-folder",null,X,me),$t(L,"aria-label",e(M).label),$t(L,"aria-expanded",e(r)),w(Le,e(r)?"folder_open":"folder"),w(se,e(M).label)},[()=>({active:f(e(M)),expanded:e(r)})]),h(J,V)},R=J=>{var V=Ih();let L;V.__click=[jh,c,M];var X=o(V),ne=o(X),ce=o(ne,!0);n(ne),n(X);var Le=v(X,2),fe=o(Le,!0);n(Le),n(V),$(se=>{L=oe(V,1,"admin-menu-rail-item",null,L,se),$t(V,"aria-label",e(M).label),$t(V,"aria-current",e(M).id===a()?"page":void 0),w(ce,e(M).icon),w(fe,e(M).label)},[()=>({active:e(M).id===a()})]),h(J,V)};C(F,J=>{e(M).type==="folder"?J(z):J(R,!1)})}h(E,I)}),n(y),n(m);var b=v(m,2),D=o(b),S=o(D);Tt(S,17,()=>l,E=>E.id,(E,M)=>{var I=Et(),F=ut(I);{var z=J=>{var V=Oh();let L;V.__click=[Rh,u,M];var X=o(V),ne=o(X),ce=o(ne,!0);n(ne),n(X),n(V),$(Le=>{L=oe(V,1,"admin-menu-nav-item admin-menu-folder",null,L,Le),$t(V,"aria-label",e(M).label),$t(V,"aria-expanded",e(r)),w(ce,e(r)?"folder_open":"folder")},[()=>({active:f(e(M))})]),h(J,V)},R=J=>{var V=Vh();let L;V.__click=[qh,c,M];var X=o(V),ne=o(X),ce=o(ne,!0);n(ne),n(X),n(V),$(Le=>{L=oe(V,1,"admin-menu-nav-item",null,L,Le),$t(V,"aria-label",e(M).label),$t(V,"aria-current",e(M).id===a()?"page":void 0),w(ce,e(M).icon)},[()=>({active:e(M).id===a()})]),h(J,V)};C(F,J=>{e(M).type==="folder"?J(z):J(R,!1)})}h(E,I)});var k=v(S,2);{var A=E=>{var M=Yh();M.__click=[Bh,u];var I=o(M);I.__click=[zh];var F=o(I),z=v(o(F),2);z.__click=[Gh,u],n(F);var R=v(F,2);Tt(R,21,()=>l.find(J=>J.id==="management-folder")?.items||[],J=>J.id,(J,V)=>{var L=Hh();let X;L.__click=[Wh,c,V,u];var ne=o(L),ce=o(ne,!0);n(ne);var Le=v(ne,2),fe=o(Le,!0);n(Le),n(L),$(se=>{X=oe(L,1,"admin-menu-mobile-folder-item",null,X,se),w(ce,e(V).icon),w(fe,e(V).label)},[()=>({active:e(V).id===a()})]),h(J,L)}),n(R),n(I),n(M),h(E,M)};C(k,E=>{e(r)&&E(A)})}n(D),n(b),$(E=>g=oe(m,1,"admin-menu-navigation-rail",null,g,E),[()=>({collapsed:!i()})]),h(s,p),Ga()}Is(["click"]);function Jh(){const{subscribe:s,set:t,update:a}=vi({data:[{id:"students",label:"Total Students",value:0,icon:"school",color:"blue"},{id:"teachers",label:"Total Teachers",value:0,icon:"person",color:"green"},{id:"sections",label:"Total Sections",value:0,icon:"class",color:"orange"},{id:"rooms",label:"Total Rooms",value:0,icon:"meeting_room",color:"purple"}],isLoading:!1,error:null,lastUpdated:null,isInitialized:!1});return{subscribe:s,init:i=>{i&&a(r=>({...r,data:i,isInitialized:!0,isLoading:!1}))},setLoading:i=>{a(r=>({...r,isLoading:i&&!r.isInitialized}))},updateData:i=>{a(r=>({...r,data:i,isLoading:!1,error:null,lastUpdated:new Date,isInitialized:!0}));try{localStorage.setItem("dashboard-stats-cache",JSON.stringify({data:i,timestamp:Date.now()}))}catch(r){console.warn("Failed to cache dashboard data:",r)}},setError:i=>{a(r=>({...r,error:i,isLoading:!1}))},getCachedData:()=>{try{const i=localStorage.getItem("dashboard-stats-cache");if(i){const{data:r,timestamp:l}=JSON.parse(i);if(Date.now()-l<300*1e3)return r}}catch(i){console.warn("Failed to retrieve cached dashboard data:",i)}return null},clearCache:()=>{try{localStorage.removeItem("dashboard-stats-cache")}catch(i){console.warn("Failed to clear dashboard cache:",i)}}}}const zi=Jh();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Pn(s){return s+.5|0}const pi=(s,t,a)=>Math.max(Math.min(s,a),t);function gn(s){return pi(Pn(s*2.55),0,255)}function gi(s){return pi(Pn(s*255),0,255)}function di(s){return pi(Pn(s/2.55)/100,0,1)}function $o(s){return pi(Pn(s*100),0,100)}const Vs={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Vr=[..."0123456789ABCDEF"],Kh=s=>Vr[s&15],Xh=s=>Vr[(s&240)>>4]+Vr[s&15],Vn=s=>(s&240)>>4===(s&15),Zh=s=>Vn(s.r)&&Vn(s.g)&&Vn(s.b)&&Vn(s.a);function em(s){var t=s.length,a;return s[0]==="#"&&(t===4||t===5?a={r:255&Vs[s[1]]*17,g:255&Vs[s[2]]*17,b:255&Vs[s[3]]*17,a:t===5?Vs[s[4]]*17:255}:(t===7||t===9)&&(a={r:Vs[s[1]]<<4|Vs[s[2]],g:Vs[s[3]]<<4|Vs[s[4]],b:Vs[s[5]]<<4|Vs[s[6]],a:t===9?Vs[s[7]]<<4|Vs[s[8]]:255})),a}const tm=(s,t)=>s<255?t(s):"";function am(s){var t=Zh(s)?Kh:Xh;return s?"#"+t(s.r)+t(s.g)+t(s.b)+tm(s.a,t):void 0}const sm=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Zl(s,t,a){const i=t*Math.min(a,1-a),r=(l,c=(l+s/30)%12)=>a-i*Math.max(Math.min(c-3,9-c,1),-1);return[r(0),r(8),r(4)]}function im(s,t,a){const i=(r,l=(r+s/60)%6)=>a-a*t*Math.max(Math.min(l,4-l,1),0);return[i(5),i(3),i(1)]}function nm(s,t,a){const i=Zl(s,1,.5);let r;for(t+a>1&&(r=1/(t+a),t*=r,a*=r),r=0;r<3;r++)i[r]*=1-t-a,i[r]+=t;return i}function rm(s,t,a,i,r){return s===r?(t-a)/i+(t<a?6:0):t===r?(a-s)/i+2:(s-t)/i+4}function Ur(s){const a=s.r/255,i=s.g/255,r=s.b/255,l=Math.max(a,i,r),c=Math.min(a,i,r),u=(l+c)/2;let f,p,m;return l!==c&&(m=l-c,p=u>.5?m/(2-l-c):m/(l+c),f=rm(a,i,r,m,l),f=f*60+.5),[f|0,p||0,u]}function Qr(s,t,a,i){return(Array.isArray(t)?s(t[0],t[1],t[2]):s(t,a,i)).map(gi)}function Jr(s,t,a){return Qr(Zl,s,t,a)}function om(s,t,a){return Qr(nm,s,t,a)}function lm(s,t,a){return Qr(im,s,t,a)}function ec(s){return(s%360+360)%360}function cm(s){const t=sm.exec(s);let a=255,i;if(!t)return;t[5]!==i&&(a=t[6]?gn(+t[5]):gi(+t[5]));const r=ec(+t[2]),l=+t[3]/100,c=+t[4]/100;return t[1]==="hwb"?i=om(r,l,c):t[1]==="hsv"?i=lm(r,l,c):i=Jr(r,l,c),{r:i[0],g:i[1],b:i[2],a}}function dm(s,t){var a=Ur(s);a[0]=ec(a[0]+t),a=Jr(a),s.r=a[0],s.g=a[1],s.b=a[2]}function um(s){if(!s)return;const t=Ur(s),a=t[0],i=$o(t[1]),r=$o(t[2]);return s.a<255?`hsla(${a}, ${i}%, ${r}%, ${di(s.a)})`:`hsl(${a}, ${i}%, ${r}%)`}const jo={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Io={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function vm(){const s={},t=Object.keys(Io),a=Object.keys(jo);let i,r,l,c,u;for(i=0;i<t.length;i++){for(c=u=t[i],r=0;r<a.length;r++)l=a[r],u=u.replace(l,jo[l]);l=parseInt(Io[c],16),s[u]=[l>>16&255,l>>8&255,l&255]}return s}let Bn;function fm(s){Bn||(Bn=vm(),Bn.transparent=[0,0,0,0]);const t=Bn[s.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const pm=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function hm(s){const t=pm.exec(s);let a=255,i,r,l;if(t){if(t[7]!==i){const c=+t[7];a=t[8]?gn(c):pi(c*255,0,255)}return i=+t[1],r=+t[3],l=+t[5],i=255&(t[2]?gn(i):pi(i,0,255)),r=255&(t[4]?gn(r):pi(r,0,255)),l=255&(t[6]?gn(l):pi(l,0,255)),{r:i,g:r,b:l,a}}}function mm(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${di(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const Tr=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,Gi=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function gm(s,t,a){const i=Gi(di(s.r)),r=Gi(di(s.g)),l=Gi(di(s.b));return{r:gi(Tr(i+a*(Gi(di(t.r))-i))),g:gi(Tr(r+a*(Gi(di(t.g))-r))),b:gi(Tr(l+a*(Gi(di(t.b))-l))),a:s.a+a*(t.a-s.a)}}function zn(s,t,a){if(s){let i=Ur(s);i[t]=Math.max(0,Math.min(i[t]+i[t]*a,t===0?360:1)),i=Jr(i),s.r=i[0],s.g=i[1],s.b=i[2]}}function tc(s,t){return s&&Object.assign(t||{},s)}function Ro(s){var t={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(t={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(t.a=gi(s[3]))):(t=tc(s,{r:0,g:0,b:0,a:1}),t.a=gi(t.a)),t}function _m(s){return s.charAt(0)==="r"?hm(s):cm(s)}class kn{constructor(t){if(t instanceof kn)return t;const a=typeof t;let i;a==="object"?i=Ro(t):a==="string"&&(i=em(t)||fm(t)||_m(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=tc(this._rgb);return t&&(t.a=di(t.a)),t}set rgb(t){this._rgb=Ro(t)}rgbString(){return this._valid?mm(this._rgb):void 0}hexString(){return this._valid?am(this._rgb):void 0}hslString(){return this._valid?um(this._rgb):void 0}mix(t,a){if(t){const i=this.rgb,r=t.rgb;let l;const c=a===l?.5:a,u=2*c-1,f=i.a-r.a,p=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;l=1-p,i.r=255&p*i.r+l*r.r+.5,i.g=255&p*i.g+l*r.g+.5,i.b=255&p*i.b+l*r.b+.5,i.a=c*i.a+(1-c)*r.a,this.rgb=i}return this}interpolate(t,a){return t&&(this._rgb=gm(this._rgb,t._rgb,a)),this}clone(){return new kn(this.rgb)}alpha(t){return this._rgb.a=gi(t),this}clearer(t){const a=this._rgb;return a.a*=1-t,this}greyscale(){const t=this._rgb,a=Pn(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=a,this}opaquer(t){const a=this._rgb;return a.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return zn(this._rgb,2,t),this}darken(t){return zn(this._rgb,2,-t),this}saturate(t){return zn(this._rgb,1,t),this}desaturate(t){return zn(this._rgb,1,-t),this}rotate(t){return dm(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function oi(){}const bm=(()=>{let s=0;return()=>s++})();function is(s){return s==null}function ys(s){if(Array.isArray&&Array.isArray(s))return!0;const t=Object.prototype.toString.call(s);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ua(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function Ws(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function ti(s,t){return Ws(s)?s:t}function Ya(s,t){return typeof s>"u"?t:s}const ym=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/t,ac=(s,t)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*t:+s;function ls(s,t,a){if(s&&typeof s.call=="function")return s.apply(a,t)}function Za(s,t,a,i){let r,l,c;if(ys(s))for(l=s.length,r=0;r<l;r++)t.call(a,s[r],r);else if(Ua(s))for(c=Object.keys(s),l=c.length,r=0;r<l;r++)t.call(a,s[c[r]],c[r])}function ir(s,t){let a,i,r,l;if(!s||!t||s.length!==t.length)return!1;for(a=0,i=s.length;a<i;++a)if(r=s[a],l=t[a],r.datasetIndex!==l.datasetIndex||r.index!==l.index)return!1;return!0}function nr(s){if(ys(s))return s.map(nr);if(Ua(s)){const t=Object.create(null),a=Object.keys(s),i=a.length;let r=0;for(;r<i;++r)t[a[r]]=nr(s[a[r]]);return t}return s}function sc(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function wm(s,t,a,i){if(!sc(s))return;const r=t[s],l=a[s];Ua(r)&&Ua(l)?Dn(r,l,i):t[s]=nr(l)}function Dn(s,t,a){const i=ys(t)?t:[t],r=i.length;if(!Ua(s))return s;a=a||{};const l=a.merger||wm;let c;for(let u=0;u<r;++u){if(c=i[u],!Ua(c))continue;const f=Object.keys(c);for(let p=0,m=f.length;p<m;++p)l(f[p],s,c,a)}return s}function yn(s,t){return Dn(s,t,{merger:xm})}function xm(s,t,a){if(!sc(s))return;const i=t[s],r=a[s];Ua(i)&&Ua(r)?yn(i,r):Object.prototype.hasOwnProperty.call(t,s)||(t[s]=nr(r))}const Oo={"":s=>s,x:s=>s.x,y:s=>s.y};function Sm(s){const t=s.split("."),a=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(a.push(i),i="");return a}function km(s){const t=Sm(s);return a=>{for(const i of t){if(i==="")break;a=a&&a[i]}return a}}function Ei(s,t){return(Oo[t]||(Oo[t]=km(t)))(s)}function Kr(s){return s.charAt(0).toUpperCase()+s.slice(1)}const An=s=>typeof s<"u",yi=s=>typeof s=="function",qo=(s,t)=>{if(s.size!==t.size)return!1;for(const a of s)if(!t.has(a))return!1;return!0};function Dm(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const ss=Math.PI,hs=2*ss,rr=Number.POSITIVE_INFINITY,Am=ss/180,ws=ss/2,Si=ss/4,Vo=ss*2/3,ic=Math.log10,_i=Math.sign;function Zn(s,t,a){return Math.abs(s-t)<a}function Bo(s){const t=Math.round(s);s=Zn(s,t,s/1e3)?t:s;const a=Math.pow(10,Math.floor(ic(s))),i=s/a;return(i<=1?1:i<=2?2:i<=5?5:10)*a}function Cm(s){const t=[],a=Math.sqrt(s);let i;for(i=1;i<a;i++)s%i===0&&(t.push(i),t.push(s/i));return a===(a|0)&&t.push(a),t.sort((r,l)=>r-l).pop(),t}function Tm(s){return typeof s=="symbol"||typeof s=="object"&&s!==null&&!(Symbol.toPrimitive in s||"toString"in s||"valueOf"in s)}function or(s){return!Tm(s)&&!isNaN(parseFloat(s))&&isFinite(s)}function Mm(s,t){const a=Math.round(s);return a-t<=s&&a+t>=s}function Pm(s,t,a){let i,r,l;for(i=0,r=s.length;i<r;i++)l=s[i][a],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function ui(s){return s*(ss/180)}function Em(s){return s*(180/ss)}function zo(s){if(!Ws(s))return;let t=1,a=0;for(;Math.round(s*t)/t!==s;)t*=10,a++;return a}function nc(s,t){const a=t.x-s.x,i=t.y-s.y,r=Math.sqrt(a*a+i*i);let l=Math.atan2(i,a);return l<-.5*ss&&(l+=hs),{angle:l,distance:r}}function Fm(s,t){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function ni(s){return(s%hs+hs)%hs}function lr(s,t,a,i){const r=ni(s),l=ni(t),c=ni(a),u=ni(l-r),f=ni(c-r),p=ni(r-l),m=ni(r-c);return r===l||r===c||i&&l===c||u>f&&p<m}function js(s,t,a){return Math.max(t,Math.min(a,s))}function Nm(s){return js(s,-32768,32767)}function Ci(s,t,a,i=1e-6){return s>=Math.min(t,a)-i&&s<=Math.max(t,a)+i}function Xr(s,t,a){a=a||(c=>s[c]<t);let i=s.length-1,r=0,l;for(;i-r>1;)l=r+i>>1,a(l)?r=l:i=l;return{lo:r,hi:i}}const Br=(s,t,a,i)=>Xr(s,a,i?r=>{const l=s[r][t];return l<a||l===a&&s[r+1][t]===a}:r=>s[r][t]<a),Lm=(s,t,a)=>Xr(s,a,i=>s[i][t]>=a);function $m(s,t,a){let i=0,r=s.length;for(;i<r&&s[i]<t;)i++;for(;r>i&&s[r-1]>a;)r--;return i>0||r<s.length?s.slice(i,r):s}const rc=["push","pop","shift","splice","unshift"];function jm(s,t){if(s._chartjs){s._chartjs.listeners.push(t);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),rc.forEach(a=>{const i="_onData"+Kr(a),r=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!1,value(...l){const c=r.apply(this,l);return s._chartjs.listeners.forEach(u=>{typeof u[i]=="function"&&u[i](...l)}),c}})})}function Go(s,t){const a=s._chartjs;if(!a)return;const i=a.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(rc.forEach(l=>{delete s[l]}),delete s._chartjs)}function oc(s){const t=new Set(s);return t.size===s.length?s:Array.from(t)}const lc=(function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame})();function cc(s,t){let a=[],i=!1;return function(...r){a=r,i||(i=!0,lc.call(window,()=>{i=!1,s.apply(t,a)}))}}function Im(s,t){let a;return function(...i){return t?(clearTimeout(a),a=setTimeout(s,t,i)):s.apply(this,i),t}}const Zr=s=>s==="start"?"left":s==="end"?"right":"center",Ms=(s,t,a)=>s==="start"?t:s==="end"?a:(t+a)/2,Rm=(s,t,a,i)=>s===(i?"left":"right")?a:s==="center"?(t+a)/2:t,Gn=s=>s===0||s===1,Wo=(s,t,a)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-t)*hs/a)),Ho=(s,t,a)=>Math.pow(2,-10*s)*Math.sin((s-t)*hs/a)+1,wn={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*ws)+1,easeOutSine:s=>Math.sin(s*ws),easeInOutSine:s=>-.5*(Math.cos(ss*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>Gn(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>Gn(s)?s:Wo(s,.075,.3),easeOutElastic:s=>Gn(s)?s:Ho(s,.075,.3),easeInOutElastic(s){return Gn(s)?s:s<.5?.5*Wo(s*2,.1125,.45):.5+.5*Ho(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let t=1.70158;return(s/=.5)<1?.5*(s*s*(((t*=1.525)+1)*s-t)):.5*((s-=2)*s*(((t*=1.525)+1)*s+t)+2)},easeInBounce:s=>1-wn.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?wn.easeInBounce(s*2)*.5:wn.easeOutBounce(s*2-1)*.5+.5};function dc(s){if(s&&typeof s=="object"){const t=s.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Yo(s){return dc(s)?s:new kn(s)}function Mr(s){return dc(s)?s:new kn(s).saturate(.5).darken(.1).hexString()}const Om=["x","y","borderWidth","radius","tension"],qm=["color","borderColor","backgroundColor"];function Vm(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),s.set("animations",{colors:{type:"color",properties:qm},numbers:{type:"number",properties:Om}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Bm(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Uo=new Map;function zm(s,t){t=t||{};const a=s+JSON.stringify(t);let i=Uo.get(a);return i||(i=new Intl.NumberFormat(s,t),Uo.set(a,i)),i}function eo(s,t,a){return zm(t,a).format(s)}const Gm={values(s){return ys(s)?s:""+s},numeric(s,t,a){if(s===0)return"0";const i=this.chart.options.locale;let r,l=s;if(a.length>1){const p=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(p<1e-4||p>1e15)&&(r="scientific"),l=Wm(s,a)}const c=ic(Math.abs(l)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),eo(s,i,f)}};function Wm(s,t){let a=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(a)>=1&&s!==Math.floor(s)&&(a=s-Math.floor(s)),a}var uc={formatters:Gm};function Hm(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,a)=>a.lineWidth,tickColor:(t,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:uc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Fi=Object.create(null),zr=Object.create(null);function xn(s,t){if(!t)return s;const a=t.split(".");for(let i=0,r=a.length;i<r;++i){const l=a[i];s=s[l]||(s[l]=Object.create(null))}return s}function Pr(s,t,a){return typeof t=="string"?Dn(xn(s,t),a):Dn(xn(s,""),t)}class Ym{constructor(t,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>Mr(r.backgroundColor),this.hoverBorderColor=(i,r)=>Mr(r.borderColor),this.hoverColor=(i,r)=>Mr(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(a)}set(t,a){return Pr(this,t,a)}get(t){return xn(this,t)}describe(t,a){return Pr(zr,t,a)}override(t,a){return Pr(Fi,t,a)}route(t,a,i,r){const l=xn(this,t),c=xn(this,i),u="_"+a;Object.defineProperties(l,{[u]:{value:l[a],writable:!0},[a]:{enumerable:!0,get(){const f=this[u],p=c[r];return Ua(f)?Object.assign({},p,f):Ya(f,p)},set(f){this[u]=f}}})}apply(t){t.forEach(a=>a(this))}}var fs=new Ym({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Vm,Bm,Hm]);function Um(s){return!s||is(s.size)||is(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function Qo(s,t,a,i,r){let l=t[r];return l||(l=t[r]=s.measureText(r).width,a.push(r)),l>i&&(i=l),i}function ki(s,t,a){const i=s.currentDevicePixelRatio,r=a!==0?Math.max(a/2,.5):0;return Math.round((t-r)*i)/i+r}function Jo(s,t){!t&&!s||(t=t||s.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,s.width,s.height),t.restore())}function Ko(s,t,a,i){vc(s,t,a,i,null)}function vc(s,t,a,i,r){let l,c,u,f,p,m,g,y;const b=t.pointStyle,D=t.rotation,S=t.radius;let k=(D||0)*Am;if(b&&typeof b=="object"&&(l=b.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){s.save(),s.translate(a,i),s.rotate(k),s.drawImage(b,-b.width/2,-b.height/2,b.width,b.height),s.restore();return}if(!(isNaN(S)||S<=0)){switch(s.beginPath(),b){default:r?s.ellipse(a,i,r/2,S,0,0,hs):s.arc(a,i,S,0,hs),s.closePath();break;case"triangle":m=r?r/2:S,s.moveTo(a+Math.sin(k)*m,i-Math.cos(k)*S),k+=Vo,s.lineTo(a+Math.sin(k)*m,i-Math.cos(k)*S),k+=Vo,s.lineTo(a+Math.sin(k)*m,i-Math.cos(k)*S),s.closePath();break;case"rectRounded":p=S*.516,f=S-p,c=Math.cos(k+Si)*f,g=Math.cos(k+Si)*(r?r/2-p:f),u=Math.sin(k+Si)*f,y=Math.sin(k+Si)*(r?r/2-p:f),s.arc(a-g,i-u,p,k-ss,k-ws),s.arc(a+y,i-c,p,k-ws,k),s.arc(a+g,i+u,p,k,k+ws),s.arc(a-y,i+c,p,k+ws,k+ss),s.closePath();break;case"rect":if(!D){f=Math.SQRT1_2*S,m=r?r/2:f,s.rect(a-m,i-f,2*m,2*f);break}k+=Si;case"rectRot":g=Math.cos(k)*(r?r/2:S),c=Math.cos(k)*S,u=Math.sin(k)*S,y=Math.sin(k)*(r?r/2:S),s.moveTo(a-g,i-u),s.lineTo(a+y,i-c),s.lineTo(a+g,i+u),s.lineTo(a-y,i+c),s.closePath();break;case"crossRot":k+=Si;case"cross":g=Math.cos(k)*(r?r/2:S),c=Math.cos(k)*S,u=Math.sin(k)*S,y=Math.sin(k)*(r?r/2:S),s.moveTo(a-g,i-u),s.lineTo(a+g,i+u),s.moveTo(a+y,i-c),s.lineTo(a-y,i+c);break;case"star":g=Math.cos(k)*(r?r/2:S),c=Math.cos(k)*S,u=Math.sin(k)*S,y=Math.sin(k)*(r?r/2:S),s.moveTo(a-g,i-u),s.lineTo(a+g,i+u),s.moveTo(a+y,i-c),s.lineTo(a-y,i+c),k+=Si,g=Math.cos(k)*(r?r/2:S),c=Math.cos(k)*S,u=Math.sin(k)*S,y=Math.sin(k)*(r?r/2:S),s.moveTo(a-g,i-u),s.lineTo(a+g,i+u),s.moveTo(a+y,i-c),s.lineTo(a-y,i+c);break;case"line":c=r?r/2:Math.cos(k)*S,u=Math.sin(k)*S,s.moveTo(a-c,i-u),s.lineTo(a+c,i+u);break;case"dash":s.moveTo(a,i),s.lineTo(a+Math.cos(k)*(r?r/2:S),i+Math.sin(k)*S);break;case!1:s.closePath();break}s.fill(),t.borderWidth>0&&s.stroke()}}function fc(s,t,a){return a=a||.5,!t||s&&s.x>t.left-a&&s.x<t.right+a&&s.y>t.top-a&&s.y<t.bottom+a}function to(s,t){s.save(),s.beginPath(),s.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),s.clip()}function ao(s){s.restore()}function Qm(s,t){t.translation&&s.translate(t.translation[0],t.translation[1]),is(t.rotation)||s.rotate(t.rotation),t.color&&(s.fillStyle=t.color),t.textAlign&&(s.textAlign=t.textAlign),t.textBaseline&&(s.textBaseline=t.textBaseline)}function Jm(s,t,a,i,r){if(r.strikethrough||r.underline){const l=s.measureText(i),c=t-l.actualBoundingBoxLeft,u=t+l.actualBoundingBoxRight,f=a-l.actualBoundingBoxAscent,p=a+l.actualBoundingBoxDescent,m=r.strikethrough?(f+p)/2:p;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=r.decorationWidth||2,s.moveTo(c,m),s.lineTo(u,m),s.stroke()}}function Km(s,t){const a=s.fillStyle;s.fillStyle=t.color,s.fillRect(t.left,t.top,t.width,t.height),s.fillStyle=a}function Cn(s,t,a,i,r,l={}){const c=ys(t)?t:[t],u=l.strokeWidth>0&&l.strokeColor!=="";let f,p;for(s.save(),s.font=r.string,Qm(s,l),f=0;f<c.length;++f)p=c[f],l.backdrop&&Km(s,l.backdrop),u&&(l.strokeColor&&(s.strokeStyle=l.strokeColor),is(l.strokeWidth)||(s.lineWidth=l.strokeWidth),s.strokeText(p,a,i,l.maxWidth)),s.fillText(p,a,i,l.maxWidth),Jm(s,a,i,p,l),i+=Number(r.lineHeight);s.restore()}function cr(s,t){const{x:a,y:i,w:r,h:l,radius:c}=t;s.arc(a+c.topLeft,i+c.topLeft,c.topLeft,1.5*ss,ss,!0),s.lineTo(a,i+l-c.bottomLeft),s.arc(a+c.bottomLeft,i+l-c.bottomLeft,c.bottomLeft,ss,ws,!0),s.lineTo(a+r-c.bottomRight,i+l),s.arc(a+r-c.bottomRight,i+l-c.bottomRight,c.bottomRight,ws,0,!0),s.lineTo(a+r,i+c.topRight),s.arc(a+r-c.topRight,i+c.topRight,c.topRight,0,-ws,!0),s.lineTo(a+c.topLeft,i)}const Xm=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Zm=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function eg(s,t){const a=(""+s).match(Xm);if(!a||a[1]==="normal")return t*1.2;switch(s=+a[2],a[3]){case"px":return s;case"%":s/=100;break}return t*s}const tg=s=>+s||0;function so(s,t){const a={},i=Ua(t),r=i?Object.keys(t):t,l=Ua(s)?i?c=>Ya(s[c],s[t[c]]):c=>s[c]:()=>s;for(const c of r)a[c]=tg(l(c));return a}function pc(s){return so(s,{top:"y",right:"x",bottom:"y",left:"x"})}function Qi(s){return so(s,["topLeft","topRight","bottomLeft","bottomRight"])}function Hs(s){const t=pc(s);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Ps(s,t){s=s||{},t=t||fs.font;let a=Ya(s.size,t.size);typeof a=="string"&&(a=parseInt(a,10));let i=Ya(s.style,t.style);i&&!(""+i).match(Zm)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:Ya(s.family,t.family),lineHeight:eg(Ya(s.lineHeight,t.lineHeight),a),size:a,style:i,weight:Ya(s.weight,t.weight),string:""};return r.string=Um(r),r}function Wn(s,t,a,i){let r,l,c;for(r=0,l=s.length;r<l;++r)if(c=s[r],c!==void 0&&c!==void 0)return c}function ag(s,t,a){const{min:i,max:r}=s,l=ac(t,(r-i)/2),c=(u,f)=>a&&u===0?0:u+f;return{min:c(i,-Math.abs(l)),max:c(r,l)}}function Xi(s,t){return Object.assign(Object.create(s),t)}function io(s,t=[""],a,i,r=()=>s[0]){const l=a||s;typeof i>"u"&&(i=_c("_fallback",s));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:l,_fallback:i,_getTarget:r,override:u=>io([u,...s],t,l,i)};return new Proxy(c,{deleteProperty(u,f){return delete u[f],delete u._keys,delete s[0][f],!0},get(u,f){return mc(u,f,()=>dg(f,t,s,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(u,f){return Zo(u).includes(f)},ownKeys(u){return Zo(u)},set(u,f,p){const m=u._storage||(u._storage=r());return u[f]=m[f]=p,delete u._keys,!0}})}function Ki(s,t,a,i){const r={_cacheable:!1,_proxy:s,_context:t,_subProxy:a,_stack:new Set,_descriptors:hc(s,i),setContext:l=>Ki(s,l,a,i),override:l=>Ki(s.override(l),t,a,i)};return new Proxy(r,{deleteProperty(l,c){return delete l[c],delete s[c],!0},get(l,c,u){return mc(l,c,()=>ig(l,c,u))},getOwnPropertyDescriptor(l,c){return l._descriptors.allKeys?Reflect.has(s,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,c)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(l,c){return Reflect.has(s,c)},ownKeys(){return Reflect.ownKeys(s)},set(l,c,u){return s[c]=u,delete l[c],!0}})}function hc(s,t={scriptable:!0,indexable:!0}){const{_scriptable:a=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=s;return{allKeys:r,scriptable:a,indexable:i,isScriptable:yi(a)?a:()=>a,isIndexable:yi(i)?i:()=>i}}const sg=(s,t)=>s?s+Kr(t):t,no=(s,t)=>Ua(t)&&s!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function mc(s,t,a){if(Object.prototype.hasOwnProperty.call(s,t)||t==="constructor")return s[t];const i=a();return s[t]=i,i}function ig(s,t,a){const{_proxy:i,_context:r,_subProxy:l,_descriptors:c}=s;let u=i[t];return yi(u)&&c.isScriptable(t)&&(u=ng(t,u,s,a)),ys(u)&&u.length&&(u=rg(t,u,s,c.isIndexable)),no(t,u)&&(u=Ki(u,r,l&&l[t],c)),u}function ng(s,t,a,i){const{_proxy:r,_context:l,_subProxy:c,_stack:u}=a;if(u.has(s))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+s);u.add(s);let f=t(l,c||i);return u.delete(s),no(s,f)&&(f=ro(r._scopes,r,s,f)),f}function rg(s,t,a,i){const{_proxy:r,_context:l,_subProxy:c,_descriptors:u}=a;if(typeof l.index<"u"&&i(s))return t[l.index%t.length];if(Ua(t[0])){const f=t,p=r._scopes.filter(m=>m!==f);t=[];for(const m of f){const g=ro(p,r,s,m);t.push(Ki(g,l,c&&c[s],u))}}return t}function gc(s,t,a){return yi(s)?s(t,a):s}const og=(s,t)=>s===!0?t:typeof s=="string"?Ei(t,s):void 0;function lg(s,t,a,i,r){for(const l of t){const c=og(a,l);if(c){s.add(c);const u=gc(c._fallback,a,r);if(typeof u<"u"&&u!==a&&u!==i)return u}else if(c===!1&&typeof i<"u"&&a!==i)return null}return!1}function ro(s,t,a,i){const r=t._rootScopes,l=gc(t._fallback,a,i),c=[...s,...r],u=new Set;u.add(i);let f=Xo(u,c,a,l||a,i);return f===null||typeof l<"u"&&l!==a&&(f=Xo(u,c,l,f,i),f===null)?!1:io(Array.from(u),[""],r,l,()=>cg(t,a,i))}function Xo(s,t,a,i,r){for(;a;)a=lg(s,t,a,i,r);return a}function cg(s,t,a){const i=s._getTarget();t in i||(i[t]={});const r=i[t];return ys(r)&&Ua(a)?a:r||{}}function dg(s,t,a,i){let r;for(const l of t)if(r=_c(sg(l,s),a),typeof r<"u")return no(s,r)?ro(a,i,s,r):r}function _c(s,t){for(const a of t){if(!a)continue;const i=a[s];if(typeof i<"u")return i}}function Zo(s){let t=s._keys;return t||(t=s._keys=ug(s._scopes)),t}function ug(s){const t=new Set;for(const a of s)for(const i of Object.keys(a).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function oo(){return typeof window<"u"&&typeof document<"u"}function lo(s){let t=s.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function dr(s,t,a){let i;return typeof s=="string"?(i=parseInt(s,10),s.indexOf("%")!==-1&&(i=i/100*t.parentNode[a])):i=s,i}const fr=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function vg(s,t){return fr(s).getPropertyValue(t)}const fg=["top","right","bottom","left"];function Mi(s,t,a){const i={};a=a?"-"+a:"";for(let r=0;r<4;r++){const l=fg[r];i[l]=parseFloat(s[t+"-"+l+a])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const pg=(s,t,a)=>(s>0||t>0)&&(!a||!a.shadowRoot);function hg(s,t){const a=s.touches,i=a&&a.length?a[0]:s,{offsetX:r,offsetY:l}=i;let c=!1,u,f;if(pg(r,l,s.target))u=r,f=l;else{const p=t.getBoundingClientRect();u=i.clientX-p.left,f=i.clientY-p.top,c=!0}return{x:u,y:f,box:c}}function Ai(s,t){if("native"in s)return s;const{canvas:a,currentDevicePixelRatio:i}=t,r=fr(a),l=r.boxSizing==="border-box",c=Mi(r,"padding"),u=Mi(r,"border","width"),{x:f,y:p,box:m}=hg(s,a),g=c.left+(m&&u.left),y=c.top+(m&&u.top);let{width:b,height:D}=t;return l&&(b-=c.width+u.width,D-=c.height+u.height),{x:Math.round((f-g)/b*a.width/i),y:Math.round((p-y)/D*a.height/i)}}function mg(s,t,a){let i,r;if(t===void 0||a===void 0){const l=s&&lo(s);if(!l)t=s.clientWidth,a=s.clientHeight;else{const c=l.getBoundingClientRect(),u=fr(l),f=Mi(u,"border","width"),p=Mi(u,"padding");t=c.width-p.width-f.width,a=c.height-p.height-f.height,i=dr(u.maxWidth,l,"clientWidth"),r=dr(u.maxHeight,l,"clientHeight")}}return{width:t,height:a,maxWidth:i||rr,maxHeight:r||rr}}const hi=s=>Math.round(s*10)/10;function gg(s,t,a,i){const r=fr(s),l=Mi(r,"margin"),c=dr(r.maxWidth,s,"clientWidth")||rr,u=dr(r.maxHeight,s,"clientHeight")||rr,f=mg(s,t,a);let{width:p,height:m}=f;if(r.boxSizing==="content-box"){const y=Mi(r,"border","width"),b=Mi(r,"padding");p-=b.width+y.width,m-=b.height+y.height}return p=Math.max(0,p-l.width),m=Math.max(0,i?p/i:m-l.height),p=hi(Math.min(p,c,f.maxWidth)),m=hi(Math.min(m,u,f.maxHeight)),p&&!m&&(m=hi(p/2)),(t!==void 0||a!==void 0)&&i&&f.height&&m>f.height&&(m=f.height,p=hi(Math.floor(m*i))),{width:p,height:m}}function el(s,t,a){const i=t||1,r=hi(s.height*i),l=hi(s.width*i);s.height=hi(s.height),s.width=hi(s.width);const c=s.canvas;return c.style&&(a||!c.style.height&&!c.style.width)&&(c.style.height=`${s.height}px`,c.style.width=`${s.width}px`),s.currentDevicePixelRatio!==i||c.height!==r||c.width!==l?(s.currentDevicePixelRatio=i,c.height=r,c.width=l,s.ctx.setTransform(i,0,0,i,0,0),!0):!1}const _g=(function(){let s=!1;try{const t={get passive(){return s=!0,!1}};oo()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return s})();function tl(s,t){const a=vg(s,t),i=a&&a.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}const bg=function(s,t){return{x(a){return s+s+t-a},setWidth(a){t=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,i){return a-i},leftForLtr(a,i){return a-i}}},yg=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,t){return s+t},leftForLtr(s,t){return s}}};function Ji(s,t,a){return s?bg(t,a):yg()}function bc(s,t){let a,i;(t==="ltr"||t==="rtl")&&(a=s.canvas.style,i=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",t,"important"),s.prevTextDirection=i)}function yc(s,t){t!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",t[0],t[1]))}function Hn(s,t,a){return s.options.clip?s[a]:t[a]}function wg(s,t){const{xScale:a,yScale:i}=s;return a&&i?{left:Hn(a,t,"left"),right:Hn(a,t,"right"),top:Hn(i,t,"top"),bottom:Hn(i,t,"bottom")}:t}function xg(s,t){const a=t._clip;if(a.disabled)return!1;const i=wg(t,s.chartArea);return{left:a.left===!1?0:i.left-(a.left===!0?0:a.left),right:a.right===!1?s.width:i.right+(a.right===!0?0:a.right),top:a.top===!1?0:i.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?s.height:i.bottom+(a.bottom===!0?0:a.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Sg{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,a,i,r){const l=a.listeners[r],c=a.duration;l.forEach(u=>u({chart:t,initial:a.initial,numSteps:c,currentStep:Math.min(i-a.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=lc.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let a=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const l=i.items;let c=l.length-1,u=!1,f;for(;c>=0;--c)f=l[c],f._active?(f._total>i.duration&&(i.duration=f._total),f.tick(t),u=!0):(l[c]=l[l.length-1],l.pop());u&&(r.draw(),this._notify(r,i,t,"progress")),l.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),a+=l.length}),this._lastDate=t,a===0&&(this._running=!1)}_getAnims(t){const a=this._charts;let i=a.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(t,i)),i}listen(t,a,i){this._getAnims(t).listeners[a].push(i)}add(t,a){!a||!a.length||this._getAnims(t).items.push(...a)}has(t){return this._getAnims(t).items.length>0}start(t){const a=this._charts.get(t);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const a=this._charts.get(t);return!(!a||!a.running||!a.items.length)}stop(t){const a=this._charts.get(t);if(!a||!a.items.length)return;const i=a.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();a.items=[],this._notify(t,a,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var li=new Sg;const al="transparent",kg={boolean(s,t,a){return a>.5?t:s},color(s,t,a){const i=Yo(s||al),r=i.valid&&Yo(t||al);return r&&r.valid?r.mix(i,a).hexString():t},number(s,t,a){return s+(t-s)*a}};class Dg{constructor(t,a,i,r){const l=a[i];r=Wn([t.to,r,l,t.from]);const c=Wn([t.from,l,r]);this._active=!0,this._fn=t.fn||kg[t.type||typeof c],this._easing=wn[t.easing]||wn.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=a,this._prop=i,this._from=c,this._to=r,this._promises=void 0}active(){return this._active}update(t,a,i){if(this._active){this._notify(!1);const r=this._target[this._prop],l=i-this._start,c=this._duration-l;this._start=i,this._duration=Math.floor(Math.max(c,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=Wn([t.to,a,r,t.from]),this._from=Wn([t.from,r,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const a=t-this._start,i=this._duration,r=this._prop,l=this._from,c=this._loop,u=this._to;let f;if(this._active=l!==u&&(c||a<i),!this._active){this._target[r]=u,this._notify(!0);return}if(a<0){this._target[r]=l;return}f=a/i%2,f=c&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(l,u,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((a,i)=>{t.push({res:a,rej:i})})}_notify(t){const a=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][a]()}}class wc{constructor(t,a){this._chart=t,this._properties=new Map,this.configure(a)}configure(t){if(!Ua(t))return;const a=Object.keys(fs.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const l=t[r];if(!Ua(l))return;const c={};for(const u of a)c[u]=l[u];(ys(l.properties)&&l.properties||[r]).forEach(u=>{(u===r||!i.has(u))&&i.set(u,c)})})}_animateOptions(t,a){const i=a.options,r=Cg(t,i);if(!r)return[];const l=this._createAnimations(r,i);return i.$shared&&Ag(t.options.$animations,i).then(()=>{t.options=i},()=>{}),l}_createAnimations(t,a){const i=this._properties,r=[],l=t.$animations||(t.$animations={}),c=Object.keys(a),u=Date.now();let f;for(f=c.length-1;f>=0;--f){const p=c[f];if(p.charAt(0)==="$")continue;if(p==="options"){r.push(...this._animateOptions(t,a));continue}const m=a[p];let g=l[p];const y=i.get(p);if(g)if(y&&g.active()){g.update(y,m,u);continue}else g.cancel();if(!y||!y.duration){t[p]=m;continue}l[p]=g=new Dg(y,t,p,m),r.push(g)}return r}update(t,a){if(this._properties.size===0){Object.assign(t,a);return}const i=this._createAnimations(t,a);if(i.length)return li.add(this._chart,i),!0}}function Ag(s,t){const a=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const l=s[i[r]];l&&l.active()&&a.push(l.wait())}return Promise.all(a)}function Cg(s,t){if(!t)return;let a=s.options;if(!a){s.options=t;return}return a.$shared&&(s.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function sl(s,t){const a=s&&s.options||{},i=a.reverse,r=a.min===void 0?t:0,l=a.max===void 0?t:0;return{start:i?l:r,end:i?r:l}}function Tg(s,t,a){if(a===!1)return!1;const i=sl(s,a),r=sl(t,a);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function Mg(s){let t,a,i,r;return Ua(s)?(t=s.top,a=s.right,i=s.bottom,r=s.left):t=a=i=r=s,{top:t,right:a,bottom:i,left:r,disabled:s===!1}}function xc(s,t){const a=[],i=s._getSortedDatasetMetas(t);let r,l;for(r=0,l=i.length;r<l;++r)a.push(i[r].index);return a}function il(s,t,a,i={}){const r=s.keys,l=i.mode==="single";let c,u,f,p;if(t===null)return;let m=!1;for(c=0,u=r.length;c<u;++c){if(f=+r[c],f===a){if(m=!0,i.all)continue;break}p=s.values[f],Ws(p)&&(l||t===0||_i(t)===_i(p))&&(t+=p)}return!m&&!i.all?0:t}function Pg(s,t){const{iScale:a,vScale:i}=t,r=a.axis==="x"?"x":"y",l=i.axis==="x"?"x":"y",c=Object.keys(s),u=new Array(c.length);let f,p,m;for(f=0,p=c.length;f<p;++f)m=c[f],u[f]={[r]:m,[l]:s[m]};return u}function Er(s,t){const a=s&&s.options.stacked;return a||a===void 0&&t.stack!==void 0}function Eg(s,t,a){return`${s.id}.${t.id}.${a.stack||a.type}`}function Fg(s){const{min:t,max:a,minDefined:i,maxDefined:r}=s.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?a:Number.POSITIVE_INFINITY}}function Ng(s,t,a){const i=s[t]||(s[t]={});return i[a]||(i[a]={})}function nl(s,t,a,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const l=s[r.index];if(a&&l>0||!a&&l<0)return r.index}return null}function rl(s,t){const{chart:a,_cachedMeta:i}=s,r=a._stacks||(a._stacks={}),{iScale:l,vScale:c,index:u}=i,f=l.axis,p=c.axis,m=Eg(l,c,i),g=t.length;let y;for(let b=0;b<g;++b){const D=t[b],{[f]:S,[p]:k}=D,A=D._stacks||(D._stacks={});y=A[p]=Ng(r,m,S),y[u]=k,y._top=nl(y,c,!0,i.type),y._bottom=nl(y,c,!1,i.type);const E=y._visualValues||(y._visualValues={});E[u]=k}}function Fr(s,t){const a=s.scales;return Object.keys(a).filter(i=>a[i].axis===t).shift()}function Lg(s,t){return Xi(s,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function $g(s,t,a){return Xi(s,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:a,index:t,mode:"default",type:"data"})}function un(s,t){const a=s.controller.index,i=s.vScale&&s.vScale.axis;if(i){t=t||s._parsed;for(const r of t){const l=r._stacks;if(!l||l[i]===void 0||l[i][a]===void 0)return;delete l[i][a],l[i]._visualValues!==void 0&&l[i]._visualValues[a]!==void 0&&delete l[i]._visualValues[a]}}}const Nr=s=>s==="reset"||s==="none",ol=(s,t)=>t?s:Object.assign({},s),jg=(s,t,a)=>s&&!t.hidden&&t._stacked&&{keys:xc(a,!0),values:null};class co{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,a){this.chart=t,this._ctx=t.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Er(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&un(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,a=this._cachedMeta,i=this.getDataset(),r=(g,y,b,D)=>g==="x"?y:g==="r"?D:b,l=a.xAxisID=Ya(i.xAxisID,Fr(t,"x")),c=a.yAxisID=Ya(i.yAxisID,Fr(t,"y")),u=a.rAxisID=Ya(i.rAxisID,Fr(t,"r")),f=a.indexAxis,p=a.iAxisID=r(f,l,c,u),m=a.vAxisID=r(f,c,l,u);a.xScale=this.getScaleForId(l),a.yScale=this.getScaleForId(c),a.rScale=this.getScaleForId(u),a.iScale=this.getScaleForId(p),a.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const a=this._cachedMeta;return t===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Go(this._data,this),t._stacked&&un(t)}_dataCheck(){const t=this.getDataset(),a=t.data||(t.data=[]),i=this._data;if(Ua(a)){const r=this._cachedMeta;this._data=Pg(a,r)}else if(i!==a){if(i){Go(i,this);const r=this._cachedMeta;un(r),r._parsed=[]}a&&Object.isExtensible(a)&&jm(a,this),this._syncList=[],this._data=a}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const a=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const l=a._stacked;a._stacked=Er(a.vScale,a),a.stack!==i.stack&&(r=!0,un(a),a.stack=i.stack),this._resyncElements(t),(r||l!==a._stacked)&&(rl(this,a._parsed),a._stacked=Er(a.vScale,a))}configure(){const t=this.chart.config,a=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),a,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,a){const{_cachedMeta:i,_data:r}=this,{iScale:l,_stacked:c}=i,u=l.axis;let f=t===0&&a===r.length?!0:i._sorted,p=t>0&&i._parsed[t-1],m,g,y;if(this._parsing===!1)i._parsed=r,i._sorted=!0,y=r;else{ys(r[t])?y=this.parseArrayData(i,r,t,a):Ua(r[t])?y=this.parseObjectData(i,r,t,a):y=this.parsePrimitiveData(i,r,t,a);const b=()=>g[u]===null||p&&g[u]<p[u];for(m=0;m<a;++m)i._parsed[m+t]=g=y[m],f&&(b()&&(f=!1),p=g);i._sorted=f}c&&rl(this,y)}parsePrimitiveData(t,a,i,r){const{iScale:l,vScale:c}=t,u=l.axis,f=c.axis,p=l.getLabels(),m=l===c,g=new Array(r);let y,b,D;for(y=0,b=r;y<b;++y)D=y+i,g[y]={[u]:m||l.parse(p[D],D),[f]:c.parse(a[D],D)};return g}parseArrayData(t,a,i,r){const{xScale:l,yScale:c}=t,u=new Array(r);let f,p,m,g;for(f=0,p=r;f<p;++f)m=f+i,g=a[m],u[f]={x:l.parse(g[0],m),y:c.parse(g[1],m)};return u}parseObjectData(t,a,i,r){const{xScale:l,yScale:c}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,p=new Array(r);let m,g,y,b;for(m=0,g=r;m<g;++m)y=m+i,b=a[y],p[m]={x:l.parse(Ei(b,u),y),y:c.parse(Ei(b,f),y)};return p}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,a,i){const r=this.chart,l=this._cachedMeta,c=a[t.axis],u={keys:xc(r,!0),values:a._stacks[t.axis]._visualValues};return il(u,c,l.index,{mode:i})}updateRangeFromParsed(t,a,i,r){const l=i[a.axis];let c=l===null?NaN:l;const u=r&&i._stacks[a.axis];r&&u&&(r.values=u,c=il(r,l,this._cachedMeta.index)),t.min=Math.min(t.min,c),t.max=Math.max(t.max,c)}getMinMax(t,a){const i=this._cachedMeta,r=i._parsed,l=i._sorted&&t===i.iScale,c=r.length,u=this._getOtherScale(t),f=jg(a,i,this.chart),p={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:g}=Fg(u);let y,b;function D(){b=r[y];const S=b[u.axis];return!Ws(b[t.axis])||m>S||g<S}for(y=0;y<c&&!(!D()&&(this.updateRangeFromParsed(p,t,b,f),l));++y);if(l){for(y=c-1;y>=0;--y)if(!D()){this.updateRangeFromParsed(p,t,b,f);break}}return p}getAllParsedValues(t){const a=this._cachedMeta._parsed,i=[];let r,l,c;for(r=0,l=a.length;r<l;++r)c=a[r][t.axis],Ws(c)&&i.push(c);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const a=this._cachedMeta,i=a.iScale,r=a.vScale,l=this.getParsed(t);return{label:i?""+i.getLabelForValue(l[i.axis]):"",value:r?""+r.getLabelForValue(l[r.axis]):""}}_update(t){const a=this._cachedMeta;this.update(t||"default"),a._clip=Mg(Ya(this.options.clip,Tg(a.xScale,a.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,a=this.chart,i=this._cachedMeta,r=i.data||[],l=a.chartArea,c=[],u=this._drawStart||0,f=this._drawCount||r.length-u,p=this.options.drawActiveElementsOnTop;let m;for(i.dataset&&i.dataset.draw(t,l,u,f),m=u;m<u+f;++m){const g=r[m];g.hidden||(g.active&&p?c.push(g):g.draw(t,l))}for(m=0;m<c.length;++m)c[m].draw(t,l)}getStyle(t,a){const i=a?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,a,i){const r=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const c=this._cachedMeta.data[t];l=c.$context||(c.$context=$g(this.getContext(),t,c)),l.parsed=this.getParsed(t),l.raw=r.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=Lg(this.chart.getContext(),this.index)),l.dataset=r,l.index=l.datasetIndex=this.index;return l.active=!!a,l.mode=i,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,a){return this._resolveElementOptions(this.dataElementType.id,a,t)}_resolveElementOptions(t,a="default",i){const r=a==="active",l=this._cachedDataOpts,c=t+"-"+a,u=l[c],f=this.enableOptionSharing&&An(i);if(u)return ol(u,f);const p=this.chart.config,m=p.datasetElementScopeKeys(this._type,t),g=r?[`${t}Hover`,"hover",t,""]:[t,""],y=p.getOptionScopes(this.getDataset(),m),b=Object.keys(fs.elements[t]),D=()=>this.getContext(i,r,a),S=p.resolveNamedOptions(y,b,D,g);return S.$shared&&(S.$shared=f,l[c]=Object.freeze(ol(S,f))),S}_resolveAnimations(t,a,i){const r=this.chart,l=this._cachedDataOpts,c=`animation-${a}`,u=l[c];if(u)return u;let f;if(r.options.animation!==!1){const m=this.chart.config,g=m.datasetAnimationScopeKeys(this._type,a),y=m.getOptionScopes(this.getDataset(),g);f=m.createResolver(y,this.getContext(t,i,a))}const p=new wc(r,f&&f.animations);return f&&f._cacheable&&(l[c]=Object.freeze(p)),p}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,a){return!a||Nr(t)||this.chart._animationsDisabled}_getSharedOptions(t,a){const i=this.resolveDataElementOptions(t,a),r=this._sharedOptions,l=this.getSharedOptions(i),c=this.includeOptions(a,l)||l!==r;return this.updateSharedOptions(l,a,i),{sharedOptions:l,includeOptions:c}}updateElement(t,a,i,r){Nr(r)?Object.assign(t,i):this._resolveAnimations(a,r).update(t,i)}updateSharedOptions(t,a,i){t&&!Nr(a)&&this._resolveAnimations(void 0,a).update(t,i)}_setStyle(t,a,i,r){t.active=r;const l=this.getStyle(a,r);this._resolveAnimations(a,i,r).update(t,{options:!r&&this.getSharedOptions(l)||l})}removeHoverStyle(t,a,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,a,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const a=this._data,i=this._cachedMeta.data;for(const[u,f,p]of this._syncList)this[u](f,p);this._syncList=[];const r=i.length,l=a.length,c=Math.min(l,r);c&&this.parse(0,c),l>r?this._insertElements(r,l-r,t):l<r&&this._removeElements(l,r-l)}_insertElements(t,a,i=!0){const r=this._cachedMeta,l=r.data,c=t+a;let u;const f=p=>{for(p.length+=a,u=p.length-1;u>=c;u--)p[u]=p[u-a]};for(f(l),u=t;u<c;++u)l[u]=new this.dataElementType;this._parsing&&f(r._parsed),this.parse(t,a),i&&this.updateElements(l,t,a,"reset")}updateElements(t,a,i,r){}_removeElements(t,a){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(t,a);i._stacked&&un(i,r)}i.data.splice(t,a)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[a,i,r]=t;this[a](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,a){a&&this._sync(["_removeElements",t,a]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Ig(s,t){if(!s._cache.$bar){const a=s.getMatchingVisibleMetas(t);let i=[];for(let r=0,l=a.length;r<l;r++)i=i.concat(a[r].controller.getAllParsedValues(s));s._cache.$bar=oc(i.sort((r,l)=>r-l))}return s._cache.$bar}function Rg(s){const t=s.iScale,a=Ig(t,s.type);let i=t._length,r,l,c,u;const f=()=>{c===32767||c===-32768||(An(u)&&(i=Math.min(i,Math.abs(c-u)||i)),u=c)};for(r=0,l=a.length;r<l;++r)c=t.getPixelForValue(a[r]),f();for(u=void 0,r=0,l=t.ticks.length;r<l;++r)c=t.getPixelForTick(r),f();return i}function Og(s,t,a,i){const r=a.barThickness;let l,c;return is(r)?(l=t.min*a.categoryPercentage,c=a.barPercentage):(l=r*i,c=1),{chunk:l/i,ratio:c,start:t.pixels[s]-l/2}}function qg(s,t,a,i){const r=t.pixels,l=r[s];let c=s>0?r[s-1]:null,u=s<r.length-1?r[s+1]:null;const f=a.categoryPercentage;c===null&&(c=l-(u===null?t.end-t.start:u-l)),u===null&&(u=l+l-c);const p=l-(l-Math.min(c,u))/2*f;return{chunk:Math.abs(u-c)/2*f/i,ratio:a.barPercentage,start:p}}function Vg(s,t,a,i){const r=a.parse(s[0],i),l=a.parse(s[1],i),c=Math.min(r,l),u=Math.max(r,l);let f=c,p=u;Math.abs(c)>Math.abs(u)&&(f=u,p=c),t[a.axis]=p,t._custom={barStart:f,barEnd:p,start:r,end:l,min:c,max:u}}function Sc(s,t,a,i){return ys(s)?Vg(s,t,a,i):t[a.axis]=a.parse(s,i),t}function ll(s,t,a,i){const r=s.iScale,l=s.vScale,c=r.getLabels(),u=r===l,f=[];let p,m,g,y;for(p=a,m=a+i;p<m;++p)y=t[p],g={},g[r.axis]=u||r.parse(c[p],p),f.push(Sc(y,g,l,p));return f}function Lr(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function Bg(s,t,a){return s!==0?_i(s):(t.isHorizontal()?1:-1)*(t.min>=a?1:-1)}function zg(s){let t,a,i,r,l;return s.horizontal?(t=s.base>s.x,a="left",i="right"):(t=s.base<s.y,a="bottom",i="top"),t?(r="end",l="start"):(r="start",l="end"),{start:a,end:i,reverse:t,top:r,bottom:l}}function Gg(s,t,a,i){let r=t.borderSkipped;const l={};if(!r){s.borderSkipped=l;return}if(r===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:f,top:p,bottom:m}=zg(s);r==="middle"&&a&&(s.enableBorderRadius=!0,(a._top||0)===i?r=p:(a._bottom||0)===i?r=m:(l[cl(m,c,u,f)]=!0,r=p)),l[cl(r,c,u,f)]=!0,s.borderSkipped=l}function cl(s,t,a,i){return i?(s=Wg(s,t,a),s=dl(s,a,t)):s=dl(s,t,a),s}function Wg(s,t,a){return s===t?a:s===a?t:s}function dl(s,t,a){return s==="start"?t:s==="end"?a:s}function Hg(s,{inflateAmount:t},a){s.inflateAmount=t==="auto"?a===1?.33:0:t}class Yg extends co{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,a,i,r){return ll(t,a,i,r)}parseArrayData(t,a,i,r){return ll(t,a,i,r)}parseObjectData(t,a,i,r){const{iScale:l,vScale:c}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,p=l.axis==="x"?u:f,m=c.axis==="x"?u:f,g=[];let y,b,D,S;for(y=i,b=i+r;y<b;++y)S=a[y],D={},D[l.axis]=l.parse(Ei(S,p),y),g.push(Sc(Ei(S,m),D,c,y));return g}updateRangeFromParsed(t,a,i,r){super.updateRangeFromParsed(t,a,i,r);const l=i._custom;l&&a===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const a=this._cachedMeta,{iScale:i,vScale:r}=a,l=this.getParsed(t),c=l._custom,u=Lr(c)?"["+c.start+", "+c.end+"]":""+r.getLabelForValue(l[r.axis]);return{label:""+i.getLabelForValue(l[i.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,t)}updateElements(t,a,i,r){const l=r==="reset",{index:c,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),p=u.isHorizontal(),m=this._getRuler(),{sharedOptions:g,includeOptions:y}=this._getSharedOptions(a,r);for(let b=a;b<a+i;b++){const D=this.getParsed(b),S=l||is(D[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(b),k=this._calculateBarIndexPixels(b,m),A=(D._stacks||{})[u.axis],E={horizontal:p,base:S.base,enableBorderRadius:!A||Lr(D._custom)||c===A._top||c===A._bottom,x:p?S.head:k.center,y:p?k.center:S.head,height:p?k.size:Math.abs(S.size),width:p?Math.abs(S.size):k.size};y&&(E.options=g||this.resolveDataElementOptions(b,t[b].active?"active":r));const M=E.options||t[b].options;Gg(E,M,A,c),Hg(E,M,m.ratio),this.updateElement(t[b],b,E,r)}}_getStacks(t,a){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),l=i.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(a),f=u&&u[i.axis],p=m=>{const g=m._parsed.find(b=>b[i.axis]===f),y=g&&g[m.vScale.axis];if(is(y)||isNaN(y))return!0};for(const m of r)if(!(a!==void 0&&p(m))&&((l===!1||c.indexOf(m.stack)===-1||l===void 0&&m.stack===void 0)&&c.push(m.stack),m.index===t))break;return c.length||c.push(void 0),c}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===a).shift()}_getAxis(){const t={},a=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[Ya(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,a)]=!0;return Object.keys(t)}_getStackIndex(t,a,i){const r=this._getStacks(t,i),l=a!==void 0?r.indexOf(a):-1;return l===-1?r.length-1:l}_getRuler(){const t=this.options,a=this._cachedMeta,i=a.iScale,r=[];let l,c;for(l=0,c=a.data.length;l<c;++l)r.push(i.getPixelForValue(this.getParsed(l)[i.axis],l));const u=t.barThickness;return{min:u||Rg(a),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:u?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:a,_stacked:i,index:r},options:{base:l,minBarLength:c}}=this,u=l||0,f=this.getParsed(t),p=f._custom,m=Lr(p);let g=f[a.axis],y=0,b=i?this.applyStack(a,f,i):g,D,S;b!==g&&(y=b-g,b=g),m&&(g=p.barStart,b=p.barEnd-p.barStart,g!==0&&_i(g)!==_i(p.barEnd)&&(y=0),y+=g);const k=!is(l)&&!m?l:y;let A=a.getPixelForValue(k);if(this.chart.getDataVisibility(t)?D=a.getPixelForValue(y+b):D=A,S=D-A,Math.abs(S)<c){S=Bg(S,a,u)*c,g===u&&(A-=S/2);const E=a.getPixelForDecimal(0),M=a.getPixelForDecimal(1),I=Math.min(E,M),F=Math.max(E,M);A=Math.max(Math.min(A,F),I),D=A+S,i&&!m&&(f._stacks[a.axis]._visualValues[r]=a.getValueForPixel(D)-a.getValueForPixel(A))}if(A===a.getPixelForValue(u)){const E=_i(S)*a.getLineWidthForValue(u)/2;A+=E,S-=E}return{size:S,base:A,head:D,center:D+S/2}}_calculateBarIndexPixels(t,a){const i=a.scale,r=this.options,l=r.skipNull,c=Ya(r.maxBarThickness,1/0);let u,f;const p=this._getAxisCount();if(a.grouped){const m=l?this._getStackCount(t):a.stackCount,g=r.barThickness==="flex"?qg(t,a,r,m*p):Og(t,a,r,m*p),y=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,b=this._getAxis().indexOf(Ya(y,this.getFirstScaleIdForIndexAxis())),D=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0)+b;u=g.start+g.chunk*D+g.chunk/2,f=Math.min(c,g.chunk*g.ratio)}else u=i.getPixelForValue(this.getParsed(t)[i.axis],t),f=Math.min(c,a.min*a.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){const t=this._cachedMeta,a=t.vScale,i=t.data,r=i.length;let l=0;for(;l<r;++l)this.getParsed(l)[a.axis]!==null&&!i[l].hidden&&i[l].draw(this._ctx)}}function Ug(s,t,a){let i=1,r=1,l=0,c=0;if(t<hs){const u=s,f=u+t,p=Math.cos(u),m=Math.sin(u),g=Math.cos(f),y=Math.sin(f),b=(M,I,F)=>lr(M,u,f,!0)?1:Math.max(I,I*a,F,F*a),D=(M,I,F)=>lr(M,u,f,!0)?-1:Math.min(I,I*a,F,F*a),S=b(0,p,g),k=b(ws,m,y),A=D(ss,p,g),E=D(ss+ws,m,y);i=(S-A)/2,r=(k-E)/2,l=-(S+A)/2,c=-(k+E)/2}return{ratioX:i,ratioY:r,offsetX:l,offsetY:c}}class Qg extends co{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const a=t.data,{labels:{pointStyle:i,textAlign:r,color:l,useBorderRadius:c,borderRadius:u}}=t.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((f,p)=>{const g=t.getDatasetMeta(0).controller.getStyle(p);return{text:f,fillStyle:g.backgroundColor,fontColor:l,hidden:!t.getDataVisibility(p),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:r,pointStyle:i,borderRadius:c&&(u||g.borderRadius),index:p}}):[]}},onClick(t,a,i){i.chart.toggleDataVisibility(a.index),i.chart.update()}}}};constructor(t,a){super(t,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,a){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let l=f=>+i[f];if(Ua(i[t])){const{key:f="value"}=this._parsing;l=p=>+Ei(i[p],f)}let c,u;for(c=t,u=t+a;c<u;++c)r._parsed[c]=l(c)}}_getRotation(){return ui(this.options.rotation-90)}_getCircumference(){return ui(this.options.circumference)}_getRotationExtents(){let t=hs,a=-hs;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,l=r._getRotation(),c=r._getCircumference();t=Math.min(t,l),a=Math.max(a,l+c)}return{rotation:t,circumference:a-t}}update(t){const a=this.chart,{chartArea:i}=a,r=this._cachedMeta,l=r.data,c=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,u=Math.max((Math.min(i.width,i.height)-c)/2,0),f=Math.min(ym(this.options.cutout,u),1),p=this._getRingWeight(this.index),{circumference:m,rotation:g}=this._getRotationExtents(),{ratioX:y,ratioY:b,offsetX:D,offsetY:S}=Ug(g,m,f),k=(i.width-c)/y,A=(i.height-c)/b,E=Math.max(Math.min(k,A)/2,0),M=ac(this.options.radius,E),I=Math.max(M*f,0),F=(M-I)/this._getVisibleDatasetWeightTotal();this.offsetX=D*M,this.offsetY=S*M,r.total=this.calculateTotal(),this.outerRadius=M-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*p,0),this.updateElements(l,0,l.length,t)}_circumference(t,a){const i=this.options,r=this._cachedMeta,l=this._getCircumference();return a&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*l/hs)}updateElements(t,a,i,r){const l=r==="reset",c=this.chart,u=c.chartArea,p=c.options.animation,m=(u.left+u.right)/2,g=(u.top+u.bottom)/2,y=l&&p.animateScale,b=y?0:this.innerRadius,D=y?0:this.outerRadius,{sharedOptions:S,includeOptions:k}=this._getSharedOptions(a,r);let A=this._getRotation(),E;for(E=0;E<a;++E)A+=this._circumference(E,l);for(E=a;E<a+i;++E){const M=this._circumference(E,l),I=t[E],F={x:m+this.offsetX,y:g+this.offsetY,startAngle:A,endAngle:A+M,circumference:M,outerRadius:D,innerRadius:b};k&&(F.options=S||this.resolveDataElementOptions(E,I.active?"active":r)),A+=M,this.updateElement(I,E,F,r)}}calculateTotal(){const t=this._cachedMeta,a=t.data;let i=0,r;for(r=0;r<a.length;r++){const l=t._parsed[r];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(r)&&!a[r].hidden&&(i+=Math.abs(l))}return i}calculateCircumference(t){const a=this._cachedMeta.total;return a>0&&!isNaN(t)?hs*(Math.abs(t)/a):0}getLabelAndValue(t){const a=this._cachedMeta,i=this.chart,r=i.data.labels||[],l=eo(a._parsed[t],i.options.locale);return{label:r[t]||"",value:l}}getMaxBorderWidth(t){let a=0;const i=this.chart;let r,l,c,u,f;if(!t){for(r=0,l=i.data.datasets.length;r<l;++r)if(i.isDatasetVisible(r)){c=i.getDatasetMeta(r),t=c.data,u=c.controller;break}}if(!t)return 0;for(r=0,l=t.length;r<l;++r)f=u.resolveDataElementOptions(r),f.borderAlign!=="inner"&&(a=Math.max(a,f.borderWidth||0,f.hoverBorderWidth||0));return a}getMaxOffset(t){let a=0;for(let i=0,r=t.length;i<r;++i){const l=this.resolveDataElementOptions(i);a=Math.max(a,l.offset||0,l.hoverOffset||0)}return a}_getRingWeightOffset(t){let a=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(a+=this._getRingWeight(i));return a}_getRingWeight(t){return Math.max(Ya(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}function Di(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class uo{static override(t){Object.assign(uo.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Di()}parse(){return Di()}format(){return Di()}add(){return Di()}diff(){return Di()}startOf(){return Di()}endOf(){return Di()}}var Jg={_date:uo};function Kg(s,t,a,i){const{controller:r,data:l,_sorted:c}=s,u=r._cachedMeta.iScale,f=s.dataset&&s.dataset.options?s.dataset.options.spanGaps:null;if(u&&t===u.axis&&t!=="r"&&c&&l.length){const p=u._reversePixels?Lm:Br;if(i){if(r._sharedOptions){const m=l[0],g=typeof m.getRange=="function"&&m.getRange(t);if(g){const y=p(l,t,a-g),b=p(l,t,a+g);return{lo:y.lo,hi:b.hi}}}}else{const m=p(l,t,a);if(f){const{vScale:g}=r._cachedMeta,{_parsed:y}=s,b=y.slice(0,m.lo+1).reverse().findIndex(S=>!is(S[g.axis]));m.lo-=Math.max(0,b);const D=y.slice(m.hi).findIndex(S=>!is(S[g.axis]));m.hi+=Math.max(0,D)}return m}}return{lo:0,hi:l.length-1}}function pr(s,t,a,i,r){const l=s.getSortedVisibleDatasetMetas(),c=a[t];for(let u=0,f=l.length;u<f;++u){const{index:p,data:m}=l[u],{lo:g,hi:y}=Kg(l[u],t,c,r);for(let b=g;b<=y;++b){const D=m[b];D.skip||i(D,p,b)}}}function Xg(s){const t=s.indexOf("x")!==-1,a=s.indexOf("y")!==-1;return function(i,r){const l=t?Math.abs(i.x-r.x):0,c=a?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(c,2))}}function $r(s,t,a,i,r){const l=[];return!r&&!s.isPointInArea(t)||pr(s,a,t,function(u,f,p){!r&&!fc(u,s.chartArea,0)||u.inRange(t.x,t.y,i)&&l.push({element:u,datasetIndex:f,index:p})},!0),l}function Zg(s,t,a,i){let r=[];function l(c,u,f){const{startAngle:p,endAngle:m}=c.getProps(["startAngle","endAngle"],i),{angle:g}=nc(c,{x:t.x,y:t.y});lr(g,p,m)&&r.push({element:c,datasetIndex:u,index:f})}return pr(s,a,t,l),r}function e_(s,t,a,i,r,l){let c=[];const u=Xg(a);let f=Number.POSITIVE_INFINITY;function p(m,g,y){const b=m.inRange(t.x,t.y,r);if(i&&!b)return;const D=m.getCenterPoint(r);if(!(!!l||s.isPointInArea(D))&&!b)return;const k=u(t,D);k<f?(c=[{element:m,datasetIndex:g,index:y}],f=k):k===f&&c.push({element:m,datasetIndex:g,index:y})}return pr(s,a,t,p),c}function jr(s,t,a,i,r,l){return!l&&!s.isPointInArea(t)?[]:a==="r"&&!i?Zg(s,t,a,r):e_(s,t,a,i,r,l)}function ul(s,t,a,i,r){const l=[],c=a==="x"?"inXRange":"inYRange";let u=!1;return pr(s,a,t,(f,p,m)=>{f[c]&&f[c](t[a],r)&&(l.push({element:f,datasetIndex:p,index:m}),u=u||f.inRange(t.x,t.y,r))}),i&&!u?[]:l}var t_={modes:{index(s,t,a,i){const r=Ai(t,s),l=a.axis||"x",c=a.includeInvisible||!1,u=a.intersect?$r(s,r,l,i,c):jr(s,r,l,!1,i,c),f=[];return u.length?(s.getSortedVisibleDatasetMetas().forEach(p=>{const m=u[0].index,g=p.data[m];g&&!g.skip&&f.push({element:g,datasetIndex:p.index,index:m})}),f):[]},dataset(s,t,a,i){const r=Ai(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;let u=a.intersect?$r(s,r,l,i,c):jr(s,r,l,!1,i,c);if(u.length>0){const f=u[0].datasetIndex,p=s.getDatasetMeta(f).data;u=[];for(let m=0;m<p.length;++m)u.push({element:p[m],datasetIndex:f,index:m})}return u},point(s,t,a,i){const r=Ai(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return $r(s,r,l,i,c)},nearest(s,t,a,i){const r=Ai(t,s),l=a.axis||"xy",c=a.includeInvisible||!1;return jr(s,r,l,a.intersect,i,c)},x(s,t,a,i){const r=Ai(t,s);return ul(s,r,"x",a.intersect,i)},y(s,t,a,i){const r=Ai(t,s);return ul(s,r,"y",a.intersect,i)}}};const kc=["left","top","right","bottom"];function vn(s,t){return s.filter(a=>a.pos===t)}function vl(s,t){return s.filter(a=>kc.indexOf(a.pos)===-1&&a.box.axis===t)}function fn(s,t){return s.sort((a,i)=>{const r=t?i:a,l=t?a:i;return r.weight===l.weight?r.index-l.index:r.weight-l.weight})}function a_(s){const t=[];let a,i,r,l,c,u;for(a=0,i=(s||[]).length;a<i;++a)r=s[a],{position:l,options:{stack:c,stackWeight:u=1}}=r,t.push({index:a,box:r,pos:l,horizontal:r.isHorizontal(),weight:r.weight,stack:c&&l+c,stackWeight:u});return t}function s_(s){const t={};for(const a of s){const{stack:i,pos:r,stackWeight:l}=a;if(!i||!kc.includes(r))continue;const c=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=l}return t}function i_(s,t){const a=s_(s),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let l,c,u;for(l=0,c=s.length;l<c;++l){u=s[l];const{fullSize:f}=u.box,p=a[u.stack],m=p&&u.stackWeight/p.weight;u.horizontal?(u.width=m?m*i:f&&t.availableWidth,u.height=r):(u.width=i,u.height=m?m*r:f&&t.availableHeight)}return a}function n_(s){const t=a_(s),a=fn(t.filter(p=>p.box.fullSize),!0),i=fn(vn(t,"left"),!0),r=fn(vn(t,"right")),l=fn(vn(t,"top"),!0),c=fn(vn(t,"bottom")),u=vl(t,"x"),f=vl(t,"y");return{fullSize:a,leftAndTop:i.concat(l),rightAndBottom:r.concat(f).concat(c).concat(u),chartArea:vn(t,"chartArea"),vertical:i.concat(r).concat(f),horizontal:l.concat(c).concat(u)}}function fl(s,t,a,i){return Math.max(s[a],t[a])+Math.max(s[i],t[i])}function Dc(s,t){s.top=Math.max(s.top,t.top),s.left=Math.max(s.left,t.left),s.bottom=Math.max(s.bottom,t.bottom),s.right=Math.max(s.right,t.right)}function r_(s,t,a,i){const{pos:r,box:l}=a,c=s.maxPadding;if(!Ua(r)){a.size&&(s[r]-=a.size);const g=i[a.stack]||{size:0,count:1};g.size=Math.max(g.size,a.horizontal?l.height:l.width),a.size=g.size/g.count,s[r]+=a.size}l.getPadding&&Dc(c,l.getPadding());const u=Math.max(0,t.outerWidth-fl(c,s,"left","right")),f=Math.max(0,t.outerHeight-fl(c,s,"top","bottom")),p=u!==s.w,m=f!==s.h;return s.w=u,s.h=f,a.horizontal?{same:p,other:m}:{same:m,other:p}}function o_(s){const t=s.maxPadding;function a(i){const r=Math.max(t[i]-s[i],0);return s[i]+=r,r}s.y+=a("top"),s.x+=a("left"),a("right"),a("bottom")}function l_(s,t){const a=t.maxPadding;function i(r){const l={left:0,top:0,right:0,bottom:0};return r.forEach(c=>{l[c]=Math.max(t[c],a[c])}),l}return i(s?["left","right"]:["top","bottom"])}function _n(s,t,a,i){const r=[];let l,c,u,f,p,m;for(l=0,c=s.length,p=0;l<c;++l){u=s[l],f=u.box,f.update(u.width||t.w,u.height||t.h,l_(u.horizontal,t));const{same:g,other:y}=r_(t,a,u,i);p|=g&&r.length,m=m||y,f.fullSize||r.push(u)}return p&&_n(r,t,a,i)||m}function Yn(s,t,a,i,r){s.top=a,s.left=t,s.right=t+i,s.bottom=a+r,s.width=i,s.height=r}function pl(s,t,a,i){const r=a.padding;let{x:l,y:c}=t;for(const u of s){const f=u.box,p=i[u.stack]||{placed:0,weight:1},m=u.stackWeight/p.weight||1;if(u.horizontal){const g=t.w*m,y=p.size||f.height;An(p.start)&&(c=p.start),f.fullSize?Yn(f,r.left,c,a.outerWidth-r.right-r.left,y):Yn(f,t.left+p.placed,c,g,y),p.start=c,p.placed+=g,c=f.bottom}else{const g=t.h*m,y=p.size||f.width;An(p.start)&&(l=p.start),f.fullSize?Yn(f,l,r.top,y,a.outerHeight-r.bottom-r.top):Yn(f,l,t.top+p.placed,y,g),p.start=l,p.placed+=g,l=f.right}}t.x=l,t.y=c}var zs={addBox(s,t){s.boxes||(s.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(a){t.draw(a)}}]},s.boxes.push(t)},removeBox(s,t){const a=s.boxes?s.boxes.indexOf(t):-1;a!==-1&&s.boxes.splice(a,1)},configure(s,t,a){t.fullSize=a.fullSize,t.position=a.position,t.weight=a.weight},update(s,t,a,i){if(!s)return;const r=Hs(s.options.layout.padding),l=Math.max(t-r.width,0),c=Math.max(a-r.height,0),u=n_(s.boxes),f=u.vertical,p=u.horizontal;Za(s.boxes,S=>{typeof S.beforeLayout=="function"&&S.beforeLayout()});const m=f.reduce((S,k)=>k.box.options&&k.box.options.display===!1?S:S+1,0)||1,g=Object.freeze({outerWidth:t,outerHeight:a,padding:r,availableWidth:l,availableHeight:c,vBoxMaxWidth:l/2/m,hBoxMaxHeight:c/2}),y=Object.assign({},r);Dc(y,Hs(i));const b=Object.assign({maxPadding:y,w:l,h:c,x:r.left,y:r.top},r),D=i_(f.concat(p),g);_n(u.fullSize,b,g,D),_n(f,b,g,D),_n(p,b,g,D)&&_n(f,b,g,D),o_(b),pl(u.leftAndTop,b,g,D),b.x+=b.w,b.y+=b.h,pl(u.rightAndBottom,b,g,D),s.chartArea={left:b.left,top:b.top,right:b.left+b.w,bottom:b.top+b.h,height:b.h,width:b.w},Za(u.chartArea,S=>{const k=S.box;Object.assign(k,s.chartArea),k.update(b.w,b.h,{left:0,top:0,right:0,bottom:0})})}};class Ac{acquireContext(t,a){}releaseContext(t){return!1}addEventListener(t,a,i){}removeEventListener(t,a,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,a,i,r){return a=Math.max(0,a||t.width),i=i||t.height,{width:a,height:Math.max(0,r?Math.floor(a/r):i)}}isAttached(t){return!0}updateConfig(t){}}class c_ extends Ac{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const er="$chartjs",d_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},hl=s=>s===null||s==="";function u_(s,t){const a=s.style,i=s.getAttribute("height"),r=s.getAttribute("width");if(s[er]={initial:{height:i,width:r,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",hl(r)){const l=tl(s,"width");l!==void 0&&(s.width=l)}if(hl(i))if(s.style.height==="")s.height=s.width/(t||2);else{const l=tl(s,"height");l!==void 0&&(s.height=l)}return s}const Cc=_g?{passive:!0}:!1;function v_(s,t,a){s&&s.addEventListener(t,a,Cc)}function f_(s,t,a){s&&s.canvas&&s.canvas.removeEventListener(t,a,Cc)}function p_(s,t){const a=d_[s.type]||s.type,{x:i,y:r}=Ai(s,t);return{type:a,chart:t,native:s,x:i!==void 0?i:null,y:r!==void 0?r:null}}function ur(s,t){for(const a of s)if(a===t||a.contains(t))return!0}function h_(s,t,a){const i=s.canvas,r=new MutationObserver(l=>{let c=!1;for(const u of l)c=c||ur(u.addedNodes,i),c=c&&!ur(u.removedNodes,i);c&&a()});return r.observe(document,{childList:!0,subtree:!0}),r}function m_(s,t,a){const i=s.canvas,r=new MutationObserver(l=>{let c=!1;for(const u of l)c=c||ur(u.removedNodes,i),c=c&&!ur(u.addedNodes,i);c&&a()});return r.observe(document,{childList:!0,subtree:!0}),r}const Tn=new Map;let ml=0;function Tc(){const s=window.devicePixelRatio;s!==ml&&(ml=s,Tn.forEach((t,a)=>{a.currentDevicePixelRatio!==s&&t()}))}function g_(s,t){Tn.size||window.addEventListener("resize",Tc),Tn.set(s,t)}function __(s){Tn.delete(s),Tn.size||window.removeEventListener("resize",Tc)}function b_(s,t,a){const i=s.canvas,r=i&&lo(i);if(!r)return;const l=cc((u,f)=>{const p=r.clientWidth;a(u,f),p<r.clientWidth&&a()},window),c=new ResizeObserver(u=>{const f=u[0],p=f.contentRect.width,m=f.contentRect.height;p===0&&m===0||l(p,m)});return c.observe(r),g_(s,l),c}function Ir(s,t,a){a&&a.disconnect(),t==="resize"&&__(s)}function y_(s,t,a){const i=s.canvas,r=cc(l=>{s.ctx!==null&&a(p_(l,s))},s);return v_(i,t,r),r}class w_ extends Ac{acquireContext(t,a){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(u_(t,a),i):null}releaseContext(t){const a=t.canvas;if(!a[er])return!1;const i=a[er].initial;["height","width"].forEach(l=>{const c=i[l];is(c)?a.removeAttribute(l):a.setAttribute(l,c)});const r=i.style||{};return Object.keys(r).forEach(l=>{a.style[l]=r[l]}),a.width=a.width,delete a[er],!0}addEventListener(t,a,i){this.removeEventListener(t,a);const r=t.$proxies||(t.$proxies={}),c={attach:h_,detach:m_,resize:b_}[a]||y_;r[a]=c(t,a,i)}removeEventListener(t,a){const i=t.$proxies||(t.$proxies={}),r=i[a];if(!r)return;({attach:Ir,detach:Ir,resize:Ir}[a]||f_)(t,a,r),i[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,a,i,r){return gg(t,a,i,r)}isAttached(t){const a=t&&lo(t);return!!(a&&a.isConnected)}}function x_(s){return!oo()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?c_:w_}class Ni{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:a,y:i}=this.getProps(["x","y"],t);return{x:a,y:i}}hasValue(){return or(this.x)&&or(this.y)}getProps(t,a){const i=this.$animations;if(!a||!i)return this;const r={};return t.forEach(l=>{r[l]=i[l]&&i[l].active()?i[l]._to:this[l]}),r}}function S_(s,t){const a=s.options.ticks,i=k_(s),r=Math.min(a.maxTicksLimit||i,i),l=a.major.enabled?A_(t):[],c=l.length,u=l[0],f=l[c-1],p=[];if(c>r)return C_(t,p,l,c/r),p;const m=D_(l,t,r);if(c>0){let g,y;const b=c>1?Math.round((f-u)/(c-1)):null;for(Un(t,p,m,is(b)?0:u-b,u),g=0,y=c-1;g<y;g++)Un(t,p,m,l[g],l[g+1]);return Un(t,p,m,f,is(b)?t.length:f+b),p}return Un(t,p,m),p}function k_(s){const t=s.options.offset,a=s._tickSize(),i=s._length/a+(t?0:1),r=s._maxLength/a;return Math.floor(Math.min(i,r))}function D_(s,t,a){const i=T_(s),r=t.length/a;if(!i)return Math.max(r,1);const l=Cm(i);for(let c=0,u=l.length-1;c<u;c++){const f=l[c];if(f>r)return f}return Math.max(r,1)}function A_(s){const t=[];let a,i;for(a=0,i=s.length;a<i;a++)s[a].major&&t.push(a);return t}function C_(s,t,a,i){let r=0,l=a[0],c;for(i=Math.ceil(i),c=0;c<s.length;c++)c===l&&(t.push(s[c]),r++,l=a[r*i])}function Un(s,t,a,i,r){const l=Ya(i,0),c=Math.min(Ya(r,s.length),s.length);let u=0,f,p,m;for(a=Math.ceil(a),r&&(f=r-i,a=f/Math.floor(f/a)),m=l;m<0;)u++,m=Math.round(l+u*a);for(p=Math.max(l,0);p<c;p++)p===m&&(t.push(s[p]),u++,m=Math.round(l+u*a))}function T_(s){const t=s.length;let a,i;if(t<2)return!1;for(i=s[0],a=1;a<t;++a)if(s[a]-s[a-1]!==i)return!1;return i}const M_=s=>s==="left"?"right":s==="right"?"left":s,gl=(s,t,a)=>t==="top"||t==="left"?s[t]+a:s[t]-a,_l=(s,t)=>Math.min(t||s,s);function bl(s,t){const a=[],i=s.length/t,r=s.length;let l=0;for(;l<r;l+=i)a.push(s[Math.floor(l)]);return a}function P_(s,t,a){const i=s.ticks.length,r=Math.min(t,i-1),l=s._startPixel,c=s._endPixel,u=1e-6;let f=s.getPixelForTick(r),p;if(!(a&&(i===1?p=Math.max(f-l,c-f):t===0?p=(s.getPixelForTick(1)-f)/2:p=(f-s.getPixelForTick(r-1))/2,f+=r<t?p:-p,f<l-u||f>c+u)))return f}function E_(s,t){Za(s,a=>{const i=a.gc,r=i.length/2;let l;if(r>t){for(l=0;l<r;++l)delete a.data[i[l]];i.splice(0,r)}})}function pn(s){return s.drawTicks?s.tickLength:0}function yl(s,t){if(!s.display)return 0;const a=Ps(s.font,t),i=Hs(s.padding);return(ys(s.text)?s.text.length:1)*a.lineHeight+i.height}function F_(s,t){return Xi(s,{scale:t,type:"scale"})}function N_(s,t,a){return Xi(s,{tick:a,index:t,type:"tick"})}function L_(s,t,a){let i=Zr(s);return(a&&t!=="right"||!a&&t==="right")&&(i=M_(i)),i}function $_(s,t,a,i){const{top:r,left:l,bottom:c,right:u,chart:f}=s,{chartArea:p,scales:m}=f;let g=0,y,b,D;const S=c-r,k=u-l;if(s.isHorizontal()){if(b=Ms(i,l,u),Ua(a)){const A=Object.keys(a)[0],E=a[A];D=m[A].getPixelForValue(E)+S-t}else a==="center"?D=(p.bottom+p.top)/2+S-t:D=gl(s,a,t);y=u-l}else{if(Ua(a)){const A=Object.keys(a)[0],E=a[A];b=m[A].getPixelForValue(E)-k+t}else a==="center"?b=(p.left+p.right)/2-k+t:b=gl(s,a,t);D=Ms(i,c,r),g=a==="left"?-ws:ws}return{titleX:b,titleY:D,maxWidth:y,rotation:g}}class Zi extends Ni{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,a){return t}getUserBounds(){let{_userMin:t,_userMax:a,_suggestedMin:i,_suggestedMax:r}=this;return t=ti(t,Number.POSITIVE_INFINITY),a=ti(a,Number.NEGATIVE_INFINITY),i=ti(i,Number.POSITIVE_INFINITY),r=ti(r,Number.NEGATIVE_INFINITY),{min:ti(t,i),max:ti(a,r),minDefined:Ws(t),maxDefined:Ws(a)}}getMinMax(t){let{min:a,max:i,minDefined:r,maxDefined:l}=this.getUserBounds(),c;if(r&&l)return{min:a,max:i};const u=this.getMatchingVisibleMetas();for(let f=0,p=u.length;f<p;++f)c=u[f].controller.getMinMax(this,t),r||(a=Math.min(a,c.min)),l||(i=Math.max(i,c.max));return a=l&&a>i?i:a,i=r&&a>i?a:i,{min:ti(a,ti(i,a)),max:ti(i,ti(a,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ls(this.options.beforeUpdate,[this])}update(t,a,i){const{beginAtZero:r,grace:l,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=a,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=ag(this,l,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=u<this.ticks.length;this._convertTicksToLabels(f?bl(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=S_(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,a,i;this.isHorizontal()?(a=this.left,i=this.right):(a=this.top,i=this.bottom,t=!t),this._startPixel=a,this._endPixel=i,this._reversePixels=t,this._length=i-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ls(this.options.afterUpdate,[this])}beforeSetDimensions(){ls(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ls(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),ls(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ls(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const a=this.options.ticks;let i,r,l;for(i=0,r=t.length;i<r;i++)l=t[i],l.label=ls(a.callback,[l.value,i,t],this)}afterTickToLabelConversion(){ls(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ls(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,a=t.ticks,i=_l(this.ticks.length,t.ticks.maxTicksLimit),r=a.minRotation||0,l=a.maxRotation;let c=r,u,f,p;if(!this._isVisible()||!a.display||r>=l||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const m=this._getLabelSizes(),g=m.widest.width,y=m.highest.height,b=js(this.chart.width-g,0,this.maxWidth);u=t.offset?this.maxWidth/i:b/(i-1),g+6>u&&(u=b/(i-(t.offset?.5:1)),f=this.maxHeight-pn(t.grid)-a.padding-yl(t.title,this.chart.options.font),p=Math.sqrt(g*g+y*y),c=Em(Math.min(Math.asin(js((m.highest.height+6)/u,-1,1)),Math.asin(js(f/p,-1,1))-Math.asin(js(y/p,-1,1)))),c=Math.max(r,Math.min(l,c))),this.labelRotation=c}afterCalculateLabelRotation(){ls(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ls(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:a,options:{ticks:i,title:r,grid:l}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const f=yl(r,a.options.font);if(u?(t.width=this.maxWidth,t.height=pn(l)+f):(t.height=this.maxHeight,t.width=pn(l)+f),i.display&&this.ticks.length){const{first:p,last:m,widest:g,highest:y}=this._getLabelSizes(),b=i.padding*2,D=ui(this.labelRotation),S=Math.cos(D),k=Math.sin(D);if(u){const A=i.mirror?0:k*g.width+S*y.height;t.height=Math.min(this.maxHeight,t.height+A+b)}else{const A=i.mirror?0:S*g.width+k*y.height;t.width=Math.min(this.maxWidth,t.width+A+b)}this._calculatePadding(p,m,k,S)}}this._handleMargins(),u?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,a,i,r){const{ticks:{align:l,padding:c},position:u}=this.options,f=this.labelRotation!==0,p=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,b=0;f?p?(y=r*t.width,b=i*a.height):(y=i*t.height,b=r*a.width):l==="start"?b=a.width:l==="end"?y=t.width:l!=="inner"&&(y=t.width/2,b=a.width/2),this.paddingLeft=Math.max((y-m+c)*this.width/(this.width-m),0),this.paddingRight=Math.max((b-g+c)*this.width/(this.width-g),0)}else{let m=a.height/2,g=t.height/2;l==="start"?(m=0,g=t.height):l==="end"&&(m=a.height,g=0),this.paddingTop=m+c,this.paddingBottom=g+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ls(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:a}=this.options;return a==="top"||a==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let a,i;for(a=0,i=t.length;a<i;a++)is(t[a].label)&&(t.splice(a,1),i--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const a=this.options.ticks.sampleSize;let i=this.ticks;a<i.length&&(i=bl(i,a)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,a,i){const{ctx:r,_longestTextCache:l}=this,c=[],u=[],f=Math.floor(a/_l(a,i));let p=0,m=0,g,y,b,D,S,k,A,E,M,I,F;for(g=0;g<a;g+=f){if(D=t[g].label,S=this._resolveTickFontOptions(g),r.font=k=S.string,A=l[k]=l[k]||{data:{},gc:[]},E=S.lineHeight,M=I=0,!is(D)&&!ys(D))M=Qo(r,A.data,A.gc,M,D),I=E;else if(ys(D))for(y=0,b=D.length;y<b;++y)F=D[y],!is(F)&&!ys(F)&&(M=Qo(r,A.data,A.gc,M,F),I+=E);c.push(M),u.push(I),p=Math.max(M,p),m=Math.max(I,m)}E_(l,a);const z=c.indexOf(p),R=u.indexOf(m),J=V=>({width:c[V]||0,height:u[V]||0});return{first:J(0),last:J(a-1),widest:J(z),highest:J(R),widths:c,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,a){return NaN}getValueForPixel(t){}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const a=this._startPixel+t*this._length;return Nm(this._alignToPixels?ki(this.chart,a,0):a)}getDecimalForPixel(t){const a=(t-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:a}=this;return t<0&&a<0?a:t>0&&a>0?t:0}getContext(t){const a=this.ticks||[];if(t>=0&&t<a.length){const i=a[t];return i.$context||(i.$context=N_(this.getContext(),t,i))}return this.$context||(this.$context=F_(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,a=ui(this.labelRotation),i=Math.abs(Math.cos(a)),r=Math.abs(Math.sin(a)),l=this._getLabelSizes(),c=t.autoSkipPadding||0,u=l?l.widest.width+c:0,f=l?l.highest.height+c:0;return this.isHorizontal()?f*i>u*r?u/i:f/r:f*r<u*i?f/i:u/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const a=this.axis,i=this.chart,r=this.options,{grid:l,position:c,border:u}=r,f=l.offset,p=this.isHorizontal(),g=this.ticks.length+(f?1:0),y=pn(l),b=[],D=u.setContext(this.getContext()),S=D.display?D.width:0,k=S/2,A=function(se){return ki(i,se,S)};let E,M,I,F,z,R,J,V,L,X,ne,ce;if(c==="top")E=A(this.bottom),R=this.bottom-y,V=E-k,X=A(t.top)+k,ce=t.bottom;else if(c==="bottom")E=A(this.top),X=t.top,ce=A(t.bottom)-k,R=E+k,V=this.top+y;else if(c==="left")E=A(this.right),z=this.right-y,J=E-k,L=A(t.left)+k,ne=t.right;else if(c==="right")E=A(this.left),L=t.left,ne=A(t.right)-k,z=E+k,J=this.left+y;else if(a==="x"){if(c==="center")E=A((t.top+t.bottom)/2+.5);else if(Ua(c)){const se=Object.keys(c)[0],re=c[se];E=A(this.chart.scales[se].getPixelForValue(re))}X=t.top,ce=t.bottom,R=E+k,V=R+y}else if(a==="y"){if(c==="center")E=A((t.left+t.right)/2);else if(Ua(c)){const se=Object.keys(c)[0],re=c[se];E=A(this.chart.scales[se].getPixelForValue(re))}z=E-k,J=z-y,L=t.left,ne=t.right}const Le=Ya(r.ticks.maxTicksLimit,g),fe=Math.max(1,Math.ceil(g/Le));for(M=0;M<g;M+=fe){const se=this.getContext(M),re=l.setContext(se),Se=u.setContext(se),me=re.lineWidth,ze=re.color,Xe=Se.dash||[],tt=Se.dashOffset,ve=re.tickWidth,$e=re.tickColor,Je=re.tickBorderDash||[],Re=re.tickBorderDashOffset;I=P_(this,M,f),I!==void 0&&(F=ki(i,I,me),p?z=J=L=ne=F:R=V=X=ce=F,b.push({tx1:z,ty1:R,tx2:J,ty2:V,x1:L,y1:X,x2:ne,y2:ce,width:me,color:ze,borderDash:Xe,borderDashOffset:tt,tickWidth:ve,tickColor:$e,tickBorderDash:Je,tickBorderDashOffset:Re}))}return this._ticksLength=g,this._borderValue=E,b}_computeLabelItems(t){const a=this.axis,i=this.options,{position:r,ticks:l}=i,c=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:p,padding:m,mirror:g}=l,y=pn(i.grid),b=y+m,D=g?-m:b,S=-ui(this.labelRotation),k=[];let A,E,M,I,F,z,R,J,V,L,X,ne,ce="middle";if(r==="top")z=this.bottom-D,R=this._getXAxisLabelAlignment();else if(r==="bottom")z=this.top+D,R=this._getXAxisLabelAlignment();else if(r==="left"){const fe=this._getYAxisLabelAlignment(y);R=fe.textAlign,F=fe.x}else if(r==="right"){const fe=this._getYAxisLabelAlignment(y);R=fe.textAlign,F=fe.x}else if(a==="x"){if(r==="center")z=(t.top+t.bottom)/2+b;else if(Ua(r)){const fe=Object.keys(r)[0],se=r[fe];z=this.chart.scales[fe].getPixelForValue(se)+b}R=this._getXAxisLabelAlignment()}else if(a==="y"){if(r==="center")F=(t.left+t.right)/2-b;else if(Ua(r)){const fe=Object.keys(r)[0],se=r[fe];F=this.chart.scales[fe].getPixelForValue(se)}R=this._getYAxisLabelAlignment(y).textAlign}a==="y"&&(f==="start"?ce="top":f==="end"&&(ce="bottom"));const Le=this._getLabelSizes();for(A=0,E=u.length;A<E;++A){M=u[A],I=M.label;const fe=l.setContext(this.getContext(A));J=this.getPixelForTick(A)+l.labelOffset,V=this._resolveTickFontOptions(A),L=V.lineHeight,X=ys(I)?I.length:1;const se=X/2,re=fe.color,Se=fe.textStrokeColor,me=fe.textStrokeWidth;let ze=R;c?(F=J,R==="inner"&&(A===E-1?ze=this.options.reverse?"left":"right":A===0?ze=this.options.reverse?"right":"left":ze="center"),r==="top"?p==="near"||S!==0?ne=-X*L+L/2:p==="center"?ne=-Le.highest.height/2-se*L+L:ne=-Le.highest.height+L/2:p==="near"||S!==0?ne=L/2:p==="center"?ne=Le.highest.height/2-se*L:ne=Le.highest.height-X*L,g&&(ne*=-1),S!==0&&!fe.showLabelBackdrop&&(F+=L/2*Math.sin(S))):(z=J,ne=(1-X)*L/2);let Xe;if(fe.showLabelBackdrop){const tt=Hs(fe.backdropPadding),ve=Le.heights[A],$e=Le.widths[A];let Je=ne-tt.top,Re=0-tt.left;switch(ce){case"middle":Je-=ve/2;break;case"bottom":Je-=ve;break}switch(R){case"center":Re-=$e/2;break;case"right":Re-=$e;break;case"inner":A===E-1?Re-=$e:A>0&&(Re-=$e/2);break}Xe={left:Re,top:Je,width:$e+tt.width,height:ve+tt.height,color:fe.backdropColor}}k.push({label:I,font:V,textOffset:ne,options:{rotation:S,color:re,strokeColor:Se,strokeWidth:me,textAlign:ze,textBaseline:ce,translation:[F,z],backdrop:Xe}})}return k}_getXAxisLabelAlignment(){const{position:t,ticks:a}=this.options;if(-ui(this.labelRotation))return t==="top"?"left":"right";let r="center";return a.align==="start"?r="left":a.align==="end"?r="right":a.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:a,ticks:{crossAlign:i,mirror:r,padding:l}}=this.options,c=this._getLabelSizes(),u=t+l,f=c.widest.width;let p,m;return a==="left"?r?(m=this.right+l,i==="near"?p="left":i==="center"?(p="center",m+=f/2):(p="right",m+=f)):(m=this.right-u,i==="near"?p="right":i==="center"?(p="center",m-=f/2):(p="left",m=this.left)):a==="right"?r?(m=this.left+l,i==="near"?p="right":i==="center"?(p="center",m-=f/2):(p="left",m-=f)):(m=this.left+u,i==="near"?p="left":i==="center"?(p="center",m+=f/2):(p="right",m=this.right)):p="right",{textAlign:p,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:a},left:i,top:r,width:l,height:c}=this;a&&(t.save(),t.fillStyle=a,t.fillRect(i,r,l,c),t.restore())}getLineWidthForValue(t){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const r=this.ticks.findIndex(l=>l.value===t);return r>=0?a.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const a=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,c;const u=(f,p,m)=>{!m.width||!m.color||(i.save(),i.lineWidth=m.width,i.strokeStyle=m.color,i.setLineDash(m.borderDash||[]),i.lineDashOffset=m.borderDashOffset,i.beginPath(),i.moveTo(f.x,f.y),i.lineTo(p.x,p.y),i.stroke(),i.restore())};if(a.display)for(l=0,c=r.length;l<c;++l){const f=r[l];a.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),a.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:a,options:{border:i,grid:r}}=this,l=i.setContext(this.getContext()),c=i.display?l.width:0;if(!c)return;const u=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let p,m,g,y;this.isHorizontal()?(p=ki(t,this.left,c)-c/2,m=ki(t,this.right,u)+u/2,g=y=f):(g=ki(t,this.top,c)-c/2,y=ki(t,this.bottom,u)+u/2,p=m=f),a.save(),a.lineWidth=l.width,a.strokeStyle=l.color,a.beginPath(),a.moveTo(p,g),a.lineTo(m,y),a.stroke(),a.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&to(i,r);const l=this.getLabelItems(t);for(const c of l){const u=c.options,f=c.font,p=c.label,m=c.textOffset;Cn(i,p,0,m,f,u)}r&&ao(i)}drawTitle(){const{ctx:t,options:{position:a,title:i,reverse:r}}=this;if(!i.display)return;const l=Ps(i.font),c=Hs(i.padding),u=i.align;let f=l.lineHeight/2;a==="bottom"||a==="center"||Ua(a)?(f+=c.bottom,ys(i.text)&&(f+=l.lineHeight*(i.text.length-1))):f+=c.top;const{titleX:p,titleY:m,maxWidth:g,rotation:y}=$_(this,f,a,u);Cn(t,i.text,0,0,l,{color:i.color,maxWidth:g,rotation:y,textAlign:L_(u,a,r),textBaseline:"middle",translation:[p,m]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,a=t.ticks&&t.ticks.z||0,i=Ya(t.grid&&t.grid.z,-1),r=Ya(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Zi.prototype.draw?[{z:a,draw:l=>{this.draw(l)}}]:[{z:i,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:a,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const a=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let l,c;for(l=0,c=a.length;l<c;++l){const u=a[l];u[i]===this.id&&(!t||u.type===t)&&r.push(u)}return r}_resolveTickFontOptions(t){const a=this.options.ticks.setContext(this.getContext(t));return Ps(a.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Qn{constructor(t,a,i){this.type=t,this.scope=a,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const a=Object.getPrototypeOf(t);let i;R_(a)&&(i=this.register(a));const r=this.items,l=t.id,c=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in r||(r[l]=t,j_(t,c,i),this.override&&fs.override(t.id,t.overrides)),c}get(t){return this.items[t]}unregister(t){const a=this.items,i=t.id,r=this.scope;i in a&&delete a[i],r&&i in fs[r]&&(delete fs[r][i],this.override&&delete Fi[i])}}function j_(s,t,a){const i=Dn(Object.create(null),[a?fs.get(a):{},fs.get(t),s.defaults]);fs.set(t,i),s.defaultRoutes&&I_(t,s.defaultRoutes),s.descriptors&&fs.describe(t,s.descriptors)}function I_(s,t){Object.keys(t).forEach(a=>{const i=a.split("."),r=i.pop(),l=[s].concat(i).join("."),c=t[a].split("."),u=c.pop(),f=c.join(".");fs.route(l,r,f,u)})}function R_(s){return"id"in s&&"defaults"in s}class O_{constructor(){this.controllers=new Qn(co,"datasets",!0),this.elements=new Qn(Ni,"elements"),this.plugins=new Qn(Object,"plugins"),this.scales=new Qn(Zi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,a,i){[...a].forEach(r=>{const l=i||this._getRegistryForType(r);i||l.isForType(r)||l===this.plugins&&r.id?this._exec(t,l,r):Za(r,c=>{const u=i||this._getRegistryForType(c);this._exec(t,u,c)})})}_exec(t,a,i){const r=Kr(t);ls(i["before"+r],[],i),a[t](i),ls(i["after"+r],[],i)}_getRegistryForType(t){for(let a=0;a<this._typedRegistries.length;a++){const i=this._typedRegistries[a];if(i.isForType(t))return i}return this.plugins}_get(t,a,i){const r=a.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}}var ii=new O_;class q_{constructor(){this._init=void 0}notify(t,a,i,r){if(a==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const l=r?this._descriptors(t).filter(r):this._descriptors(t),c=this._notify(l,t,a,i);return a==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),c}_notify(t,a,i,r){r=r||{};for(const l of t){const c=l.plugin,u=c[i],f=[a,r,l.options];if(ls(u,f,c)===!1&&r.cancelable)return!1}return!0}invalidate(){is(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),a}_createDescriptors(t,a){const i=t&&t.config,r=Ya(i.options&&i.options.plugins,{}),l=V_(i);return r===!1&&!a?[]:z_(t,l,r,a)}_notifyStateChanges(t){const a=this._oldCache||[],i=this._cache,r=(l,c)=>l.filter(u=>!c.some(f=>u.plugin.id===f.plugin.id));this._notify(r(a,i),t,"stop"),this._notify(r(i,a),t,"start")}}function V_(s){const t={},a=[],i=Object.keys(ii.plugins.items);for(let l=0;l<i.length;l++)a.push(ii.getPlugin(i[l]));const r=s.plugins||[];for(let l=0;l<r.length;l++){const c=r[l];a.indexOf(c)===-1&&(a.push(c),t[c.id]=!0)}return{plugins:a,localIds:t}}function B_(s,t){return!t&&s===!1?null:s===!0?{}:s}function z_(s,{plugins:t,localIds:a},i,r){const l=[],c=s.getContext();for(const u of t){const f=u.id,p=B_(i[f],r);p!==null&&l.push({plugin:u,options:G_(s.config,{plugin:u,local:a[f]},p,c)})}return l}function G_(s,{plugin:t,local:a},i,r){const l=s.pluginScopeKeys(t),c=s.getOptionScopes(i,l);return a&&t.defaults&&c.push(t.defaults),s.createResolver(c,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Gr(s,t){const a=fs.datasets[s]||{};return((t.datasets||{})[s]||{}).indexAxis||t.indexAxis||a.indexAxis||"x"}function W_(s,t){let a=s;return s==="_index_"?a=t:s==="_value_"&&(a=t==="x"?"y":"x"),a}function H_(s,t){return s===t?"_index_":"_value_"}function wl(s){if(s==="x"||s==="y"||s==="r")return s}function Y_(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function Wr(s,...t){if(wl(s))return s;for(const a of t){const i=a.axis||Y_(a.position)||s.length>1&&wl(s[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function xl(s,t,a){if(a[t+"AxisID"]===s)return{axis:t}}function U_(s,t){if(t.data&&t.data.datasets){const a=t.data.datasets.filter(i=>i.xAxisID===s||i.yAxisID===s);if(a.length)return xl(s,"x",a[0])||xl(s,"y",a[0])}return{}}function Q_(s,t){const a=Fi[s.type]||{scales:{}},i=t.scales||{},r=Gr(s.type,t),l=Object.create(null);return Object.keys(i).forEach(c=>{const u=i[c];if(!Ua(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const f=Wr(c,u,U_(c,s),fs.scales[u.type]),p=H_(f,r),m=a.scales||{};l[c]=yn(Object.create(null),[{axis:f},u,m[f],m[p]])}),s.data.datasets.forEach(c=>{const u=c.type||s.type,f=c.indexAxis||Gr(u,t),m=(Fi[u]||{}).scales||{};Object.keys(m).forEach(g=>{const y=W_(g,f),b=c[y+"AxisID"]||y;l[b]=l[b]||Object.create(null),yn(l[b],[{axis:y},i[b],m[g]])})}),Object.keys(l).forEach(c=>{const u=l[c];yn(u,[fs.scales[u.type],fs.scale])}),l}function Mc(s){const t=s.options||(s.options={});t.plugins=Ya(t.plugins,{}),t.scales=Q_(s,t)}function Pc(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function J_(s){return s=s||{},s.data=Pc(s.data),Mc(s),s}const Sl=new Map,Ec=new Set;function Jn(s,t){let a=Sl.get(s);return a||(a=t(),Sl.set(s,a),Ec.add(a)),a}const hn=(s,t,a)=>{const i=Ei(t,a);i!==void 0&&s.add(i)};class K_{constructor(t){this._config=J_(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Pc(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Mc(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Jn(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,a){return Jn(`${t}.transition.${a}`,()=>[[`datasets.${t}.transitions.${a}`,`transitions.${a}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,a){return Jn(`${t}-${a}`,()=>[[`datasets.${t}.elements.${a}`,`datasets.${t}`,`elements.${a}`,""]])}pluginScopeKeys(t){const a=t.id,i=this.type;return Jn(`${i}-plugin-${a}`,()=>[[`plugins.${a}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,a){const i=this._scopeCache;let r=i.get(t);return(!r||a)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,a,i){const{options:r,type:l}=this,c=this._cachedScopes(t,i),u=c.get(a);if(u)return u;const f=new Set;a.forEach(m=>{t&&(f.add(t),m.forEach(g=>hn(f,t,g))),m.forEach(g=>hn(f,r,g)),m.forEach(g=>hn(f,Fi[l]||{},g)),m.forEach(g=>hn(f,fs,g)),m.forEach(g=>hn(f,zr,g))});const p=Array.from(f);return p.length===0&&p.push(Object.create(null)),Ec.has(a)&&c.set(a,p),p}chartOptionScopes(){const{options:t,type:a}=this;return[t,Fi[a]||{},fs.datasets[a]||{},{type:a},fs,zr]}resolveNamedOptions(t,a,i,r=[""]){const l={$shared:!0},{resolver:c,subPrefixes:u}=kl(this._resolverCache,t,r);let f=c;if(Z_(c,a)){l.$shared=!1,i=yi(i)?i():i;const p=this.createResolver(t,i,u);f=Ki(c,i,p)}for(const p of a)l[p]=f[p];return l}createResolver(t,a,i=[""],r){const{resolver:l}=kl(this._resolverCache,t,i);return Ua(a)?Ki(l,a,void 0,r):l}}function kl(s,t,a){let i=s.get(t);i||(i=new Map,s.set(t,i));const r=a.join();let l=i.get(r);return l||(l={resolver:io(t,a),subPrefixes:a.filter(u=>!u.toLowerCase().includes("hover"))},i.set(r,l)),l}const X_=s=>Ua(s)&&Object.getOwnPropertyNames(s).some(t=>yi(s[t]));function Z_(s,t){const{isScriptable:a,isIndexable:i}=hc(s);for(const r of t){const l=a(r),c=i(r),u=(c||l)&&s[r];if(l&&(yi(u)||X_(u))||c&&ys(u))return!0}return!1}var eb="4.5.1";const tb=["top","bottom","left","right","chartArea"];function Dl(s,t){return s==="top"||s==="bottom"||tb.indexOf(s)===-1&&t==="x"}function Al(s,t){return function(a,i){return a[s]===i[s]?a[t]-i[t]:a[s]-i[s]}}function Cl(s){const t=s.chart,a=t.options.animation;t.notifyPlugins("afterRender"),ls(a&&a.onComplete,[s],t)}function ab(s){const t=s.chart,a=t.options.animation;ls(a&&a.onProgress,[s],t)}function Fc(s){return oo()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const tr={},Tl=s=>{const t=Fc(s);return Object.values(tr).filter(a=>a.canvas===t).pop()};function sb(s,t,a){const i=Object.keys(s);for(const r of i){const l=+r;if(l>=t){const c=s[r];delete s[r],(a>0||l>t)&&(s[l+a]=c)}}}function ib(s,t,a,i){return!a||s.type==="mouseout"?null:i?t:s}class Mn{static defaults=fs;static instances=tr;static overrides=Fi;static registry=ii;static version=eb;static getChart=Tl;static register(...t){ii.add(...t),Ml()}static unregister(...t){ii.remove(...t),Ml()}constructor(t,a){const i=this.config=new K_(a),r=Fc(t),l=Tl(r);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const c=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||x_(r)),this.platform.updateConfig(i);const u=this.platform.acquireContext(r,c.aspectRatio),f=u&&u.canvas,p=f&&f.height,m=f&&f.width;if(this.id=bm(),this.ctx=u,this.canvas=f,this.width=m,this.height=p,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new q_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Im(g=>this.update(g),c.resizeDelay||0),this._dataChanges=[],tr[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}li.listen(this,"complete",Cl),li.listen(this,"progress",ab),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:a},width:i,height:r,_aspectRatio:l}=this;return is(t)?a&&l?l:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return ii}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():el(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Jo(this.canvas,this.ctx),this}stop(){return li.stop(this),this}resize(t,a){li.running(this)?this._resizeBeforeDraw={width:t,height:a}:this._resize(t,a)}_resize(t,a){const i=this.options,r=this.canvas,l=i.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(r,t,a,l),u=i.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,el(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),ls(i.onResize,[this,c],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};Za(a,(i,r)=>{i.id=r})}buildOrUpdateScales(){const t=this.options,a=t.scales,i=this.scales,r=Object.keys(i).reduce((c,u)=>(c[u]=!1,c),{});let l=[];a&&(l=l.concat(Object.keys(a).map(c=>{const u=a[c],f=Wr(c,u),p=f==="r",m=f==="x";return{options:u,dposition:p?"chartArea":m?"bottom":"left",dtype:p?"radialLinear":m?"category":"linear"}}))),Za(l,c=>{const u=c.options,f=u.id,p=Wr(f,u),m=Ya(u.type,c.dtype);(u.position===void 0||Dl(u.position,p)!==Dl(c.dposition))&&(u.position=c.dposition),r[f]=!0;let g=null;if(f in i&&i[f].type===m)g=i[f];else{const y=ii.getScale(m);g=new y({id:f,type:m,ctx:this.ctx,chart:this}),i[g.id]=g}g.init(u,t)}),Za(r,(c,u)=>{c||delete i[u]}),Za(i,c=>{zs.configure(this,c,c.options),zs.addBox(this,c)})}_updateMetasets(){const t=this._metasets,a=this.data.datasets.length,i=t.length;if(t.sort((r,l)=>r.index-l.index),i>a){for(let r=a;r<i;++r)this._destroyDatasetMeta(r);t.splice(a,i-a)}this._sortedMetasets=t.slice(0).sort(Al("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:a}}=this;t.length>a.length&&delete this._stacks,t.forEach((i,r)=>{a.filter(l=>l===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],a=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=a.length;i<r;i++){const l=a[i];let c=this.getDatasetMeta(i);const u=l.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(i),c=this.getDatasetMeta(i)),c.type=u,c.indexAxis=l.indexAxis||Gr(u,this.options),c.order=l.order||0,c.index=i,c.label=""+l.label,c.visible=this.isDatasetVisible(i),c.controller)c.controller.updateIndex(i),c.controller.linkScales();else{const f=ii.getController(u),{datasetElementType:p,dataElementType:m}=fs.datasets[u];Object.assign(f,{dataElementType:ii.getElement(m),datasetElementType:p&&ii.getElement(p)}),c.controller=new f(this,i),t.push(c.controller)}}return this._updateMetasets(),t}_resetElements(){Za(this.data.datasets,(t,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const a=this.config;a.update();const i=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let p=0,m=this.data.datasets.length;p<m;p++){const{controller:g}=this.getDatasetMeta(p),y=!r&&l.indexOf(g)===-1;g.buildOrUpdateElements(y),c=Math.max(+g.getMaxOverflow(),c)}c=this._minPadding=i.layout.autoPadding?c:0,this._updateLayout(c),r||Za(l,p=>{p.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Al("z","_idx"));const{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){Za(this.scales,t=>{zs.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,a=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!qo(a,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,a=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:l}of a){const c=i==="_removeElements"?-l:l;sb(t,r,c)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const a=this.data.datasets.length,i=l=>new Set(t.filter(c=>c[0]===l).map((c,u)=>u+","+c.splice(1).join(","))),r=i(0);for(let l=1;l<a;l++)if(!qo(r,i(l)))return;return Array.from(r).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;zs.update(this,this.width,this.height,t);const a=this.chartArea,i=a.width<=0||a.height<=0;this._layers=[],Za(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,l)=>{r._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let a=0,i=this.data.datasets.length;a<i;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,i=this.data.datasets.length;a<i;++a)this._updateDataset(a,yi(t)?t({datasetIndex:a}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,a){const i=this.getDatasetMeta(t),r={meta:i,index:t,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(a),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(li.has(this)?this.attached&&!li.running(this)&&li.start(this):(this.draw(),Cl({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(t=0;t<a.length&&a[t].z<=0;++t)a[t].draw(this.chartArea);for(this._drawDatasets();t<a.length;++t)a[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const a=this._sortedMetasets,i=[];let r,l;for(r=0,l=a.length;r<l;++r){const c=a[r];(!t||c.visible)&&i.push(c)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let a=t.length-1;a>=0;--a)this._drawDataset(t[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const a=this.ctx,i={meta:t,index:t.index,cancelable:!0},r=xg(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&to(a,r),t.controller.draw(),r&&ao(a),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return fc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,a,i,r){const l=t_.modes[a];return typeof l=="function"?l(this,t,i,r):[]}getDatasetMeta(t){const a=this.data.datasets[t],i=this._metasets;let r=i.filter(l=>l&&l._dataset===a).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:t,_dataset:a,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Xi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const a=this.data.datasets[t];if(!a)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!a.hidden}setDatasetVisibility(t,a){const i=this.getDatasetMeta(t);i.hidden=!a}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,a,i){const r=i?"show":"hide",l=this.getDatasetMeta(t),c=l.controller._resolveAnimations(void 0,r);An(a)?(l.data[a].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),c.update(l,{visible:i}),this.update(u=>u.datasetIndex===t?r:void 0))}hide(t,a){this._updateVisibility(t,a,!1)}show(t,a){this._updateVisibility(t,a,!0)}_destroyDatasetMeta(t){const a=this._metasets[t];a&&a.controller&&a.controller._destroy(),delete this._metasets[t]}_stop(){let t,a;for(this.stop(),li.remove(this),t=0,a=this.data.datasets.length;t<a;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:a}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Jo(t,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete tr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,a=this.platform,i=(l,c)=>{a.addEventListener(this,l,c),t[l]=c},r=(l,c,u)=>{l.offsetX=c,l.offsetY=u,this._eventHandler(l)};Za(this.options.events,l=>i(l,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,a=this.platform,i=(f,p)=>{a.addEventListener(this,f,p),t[f]=p},r=(f,p)=>{t[f]&&(a.removeEventListener(this,f,p),delete t[f])},l=(f,p)=>{this.canvas&&this.resize(f,p)};let c;const u=()=>{r("attach",u),this.attached=!0,this.resize(),i("resize",l),i("detach",c)};c=()=>{this.attached=!1,r("resize",l),this._stop(),this._resize(0,0),i("attach",u)},a.isAttached(this.canvas)?u():c()}unbindEvents(){Za(this._listeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._listeners={},Za(this._responsiveListeners,(t,a)=>{this.platform.removeEventListener(this,a,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,a,i){const r=i?"set":"remove";let l,c,u,f;for(a==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+r+"DatasetHoverStyle"]()),u=0,f=t.length;u<f;++u){c=t[u];const p=c&&this.getDatasetMeta(c.datasetIndex).controller;p&&p[r+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const a=this._active||[],i=t.map(({datasetIndex:l,index:c})=>{const u=this.getDatasetMeta(l);if(!u)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:u.data[c],index:c}});!ir(i,a)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,a))}notifyPlugins(t,a,i){return this._plugins.notify(this,t,a,i)}isPluginEnabled(t){return this._plugins._cache.filter(a=>a.plugin.id===t).length===1}_updateHoverStyles(t,a,i){const r=this.options.hover,l=(f,p)=>f.filter(m=>!p.some(g=>m.datasetIndex===g.datasetIndex&&m.index===g.index)),c=l(a,t),u=i?t:l(t,a);c.length&&this.updateHoverStyle(c,r.mode,!1),u.length&&r.mode&&this.updateHoverStyle(u,r.mode,!0)}_eventHandler(t,a){const i={event:t,replay:a,cancelable:!0,inChartArea:this.isPointInArea(t)},r=c=>(c.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const l=this._handleEvent(t,a,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(l||i.changed)&&this.render(),this}_handleEvent(t,a,i){const{_active:r=[],options:l}=this,c=a,u=this._getActiveElements(t,r,i,c),f=Dm(t),p=ib(t,this._lastEvent,i,f);i&&(this._lastEvent=null,ls(l.onHover,[t,u,this],this),f&&ls(l.onClick,[t,u,this],this));const m=!ir(u,r);return(m||a)&&(this._active=u,this._updateHoverStyles(u,r,a)),this._lastEvent=p,m}_getActiveElements(t,a,i,r){if(t.type==="mouseout")return[];if(!i)return a;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,r)}}function Ml(){return Za(Mn.instances,s=>s._plugins.invalidate())}function nb(s,t,a){const{startAngle:i,x:r,y:l,outerRadius:c,innerRadius:u,options:f}=t,{borderWidth:p,borderJoinStyle:m}=f,g=Math.min(p/c,ni(i-a));if(s.beginPath(),s.arc(r,l,c-p/2,i+g/2,a-g/2),u>0){const y=Math.min(p/u,ni(i-a));s.arc(r,l,u+p/2,a-y/2,i+y/2,!0)}else{const y=Math.min(p/2,c*ni(i-a));if(m==="round")s.arc(r,l,y,a-ss/2,i+ss/2,!0);else if(m==="bevel"){const b=2*y*y,D=-b*Math.cos(a+ss/2)+r,S=-b*Math.sin(a+ss/2)+l,k=b*Math.cos(i+ss/2)+r,A=b*Math.sin(i+ss/2)+l;s.lineTo(D,S),s.lineTo(k,A)}}s.closePath(),s.moveTo(0,0),s.rect(0,0,s.canvas.width,s.canvas.height),s.clip("evenodd")}function rb(s,t,a){const{startAngle:i,pixelMargin:r,x:l,y:c,outerRadius:u,innerRadius:f}=t;let p=r/u;s.beginPath(),s.arc(l,c,u,i-p,a+p),f>r?(p=r/f,s.arc(l,c,f,a+p,i-p,!0)):s.arc(l,c,r,a+ws,i-ws),s.closePath(),s.clip()}function ob(s){return so(s,["outerStart","outerEnd","innerStart","innerEnd"])}function lb(s,t,a,i){const r=ob(s.options.borderRadius),l=(a-t)/2,c=Math.min(l,i*t/2),u=f=>{const p=(a-Math.min(l,f))*i/2;return js(f,0,Math.min(l,p))};return{outerStart:u(r.outerStart),outerEnd:u(r.outerEnd),innerStart:js(r.innerStart,0,c),innerEnd:js(r.innerEnd,0,c)}}function Wi(s,t,a,i){return{x:a+s*Math.cos(t),y:i+s*Math.sin(t)}}function vr(s,t,a,i,r,l){const{x:c,y:u,startAngle:f,pixelMargin:p,innerRadius:m}=t,g=Math.max(t.outerRadius+i+a-p,0),y=m>0?m+i+a+p:0;let b=0;const D=r-f;if(i){const fe=m>0?m-i:0,se=g>0?g-i:0,re=(fe+se)/2,Se=re!==0?D*re/(re+i):D;b=(D-Se)/2}const S=Math.max(.001,D*g-a/ss)/g,k=(D-S)/2,A=f+k+b,E=r-k-b,{outerStart:M,outerEnd:I,innerStart:F,innerEnd:z}=lb(t,y,g,E-A),R=g-M,J=g-I,V=A+M/R,L=E-I/J,X=y+F,ne=y+z,ce=A+F/X,Le=E-z/ne;if(s.beginPath(),l){const fe=(V+L)/2;if(s.arc(c,u,g,V,fe),s.arc(c,u,g,fe,L),I>0){const me=Wi(J,L,c,u);s.arc(me.x,me.y,I,L,E+ws)}const se=Wi(ne,E,c,u);if(s.lineTo(se.x,se.y),z>0){const me=Wi(ne,Le,c,u);s.arc(me.x,me.y,z,E+ws,Le+Math.PI)}const re=(E-z/y+(A+F/y))/2;if(s.arc(c,u,y,E-z/y,re,!0),s.arc(c,u,y,re,A+F/y,!0),F>0){const me=Wi(X,ce,c,u);s.arc(me.x,me.y,F,ce+Math.PI,A-ws)}const Se=Wi(R,A,c,u);if(s.lineTo(Se.x,Se.y),M>0){const me=Wi(R,V,c,u);s.arc(me.x,me.y,M,A-ws,V)}}else{s.moveTo(c,u);const fe=Math.cos(V)*g+c,se=Math.sin(V)*g+u;s.lineTo(fe,se);const re=Math.cos(L)*g+c,Se=Math.sin(L)*g+u;s.lineTo(re,Se)}s.closePath()}function cb(s,t,a,i,r){const{fullCircles:l,startAngle:c,circumference:u}=t;let f=t.endAngle;if(l){vr(s,t,a,i,f,r);for(let p=0;p<l;++p)s.fill();isNaN(u)||(f=c+(u%hs||hs))}return vr(s,t,a,i,f,r),s.fill(),f}function db(s,t,a,i,r){const{fullCircles:l,startAngle:c,circumference:u,options:f}=t,{borderWidth:p,borderJoinStyle:m,borderDash:g,borderDashOffset:y,borderRadius:b}=f,D=f.borderAlign==="inner";if(!p)return;s.setLineDash(g||[]),s.lineDashOffset=y,D?(s.lineWidth=p*2,s.lineJoin=m||"round"):(s.lineWidth=p,s.lineJoin=m||"bevel");let S=t.endAngle;if(l){vr(s,t,a,i,S,r);for(let k=0;k<l;++k)s.stroke();isNaN(u)||(S=c+(u%hs||hs))}D&&rb(s,t,S),f.selfJoin&&S-c>=ss&&b===0&&m!=="miter"&&nb(s,t,S),l||(vr(s,t,a,i,S,r),s.stroke())}class ub extends Ni{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,a,i){const r=this.getProps(["x","y"],i),{angle:l,distance:c}=nc(r,{x:t,y:a}),{startAngle:u,endAngle:f,innerRadius:p,outerRadius:m,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),y=(this.options.spacing+this.options.borderWidth)/2,b=Ya(g,f-u),D=lr(l,u,f)&&u!==f,S=b>=hs||D,k=Ci(c,p+y,m+y);return S&&k}getCenterPoint(t){const{x:a,y:i,startAngle:r,endAngle:l,innerRadius:c,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:p}=this.options,m=(r+l)/2,g=(c+u+p+f)/2;return{x:a+Math.cos(m)*g,y:i+Math.sin(m)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:a,circumference:i}=this,r=(a.offset||0)/4,l=(a.spacing||0)/2,c=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=i>hs?Math.floor(i/hs):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const u=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(u)*r,Math.sin(u)*r);const f=1-Math.sin(Math.min(ss,i||0)),p=r*f;t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,cb(t,this,p,l,c),db(t,this,p,l,c),t.restore()}}function Nc(s,t){const{x:a,y:i,base:r,width:l,height:c}=s.getProps(["x","y","base","width","height"],t);let u,f,p,m,g;return s.horizontal?(g=c/2,u=Math.min(a,r),f=Math.max(a,r),p=i-g,m=i+g):(g=l/2,u=a-g,f=a+g,p=Math.min(i,r),m=Math.max(i,r)),{left:u,top:p,right:f,bottom:m}}function mi(s,t,a,i){return s?0:js(t,a,i)}function vb(s,t,a){const i=s.options.borderWidth,r=s.borderSkipped,l=pc(i);return{t:mi(r.top,l.top,0,a),r:mi(r.right,l.right,0,t),b:mi(r.bottom,l.bottom,0,a),l:mi(r.left,l.left,0,t)}}function fb(s,t,a){const{enableBorderRadius:i}=s.getProps(["enableBorderRadius"]),r=s.options.borderRadius,l=Qi(r),c=Math.min(t,a),u=s.borderSkipped,f=i||Ua(r);return{topLeft:mi(!f||u.top||u.left,l.topLeft,0,c),topRight:mi(!f||u.top||u.right,l.topRight,0,c),bottomLeft:mi(!f||u.bottom||u.left,l.bottomLeft,0,c),bottomRight:mi(!f||u.bottom||u.right,l.bottomRight,0,c)}}function pb(s){const t=Nc(s),a=t.right-t.left,i=t.bottom-t.top,r=vb(s,a/2,i/2),l=fb(s,a/2,i/2);return{outer:{x:t.left,y:t.top,w:a,h:i,radius:l},inner:{x:t.left+r.l,y:t.top+r.t,w:a-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,l.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(r.b,r.r))}}}}function Rr(s,t,a,i){const r=t===null,l=a===null,u=s&&!(r&&l)&&Nc(s,i);return u&&(r||Ci(t,u.left,u.right))&&(l||Ci(a,u.top,u.bottom))}function hb(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function mb(s,t){s.rect(t.x,t.y,t.w,t.h)}function Or(s,t,a={}){const i=s.x!==a.x?-t:0,r=s.y!==a.y?-t:0,l=(s.x+s.w!==a.x+a.w?t:0)-i,c=(s.y+s.h!==a.y+a.h?t:0)-r;return{x:s.x+i,y:s.y+r,w:s.w+l,h:s.h+c,radius:s.radius}}class gb extends Ni{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:a,options:{borderColor:i,backgroundColor:r}}=this,{inner:l,outer:c}=pb(this),u=hb(c.radius)?cr:mb;t.save(),(c.w!==l.w||c.h!==l.h)&&(t.beginPath(),u(t,Or(c,a,l)),t.clip(),u(t,Or(l,-a,c)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),u(t,Or(l,a)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,a,i){return Rr(this,t,a,i)}inXRange(t,a){return Rr(this,t,null,a)}inYRange(t,a){return Rr(this,null,t,a)}getCenterPoint(t){const{x:a,y:i,base:r,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(a+r)/2:a,y:l?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}const Pl=(s,t)=>{let{boxHeight:a=t,boxWidth:i=t}=s;return s.usePointStyle&&(a=Math.min(a,t),i=s.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:a,itemHeight:Math.max(t,a)}},_b=(s,t)=>s!==null&&t!==null&&s.datasetIndex===t.datasetIndex&&s.index===t.index;class El extends Ni{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a,i){this.maxWidth=t,this.maxHeight=a,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let a=ls(t.generateLabels,[this.chart],this)||[];t.filter&&(a=a.filter(i=>t.filter(i,this.chart.data))),t.sort&&(a=a.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:t,ctx:a}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,r=Ps(i.font),l=r.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Pl(i,l);let p,m;a.font=r.string,this.isHorizontal()?(p=this.maxWidth,m=this._fitRows(c,l,u,f)+10):(m=this.maxHeight,p=this._fitCols(c,r,u,f)+10),this.width=Math.min(p,t.maxWidth||this.maxWidth),this.height=Math.min(m,t.maxHeight||this.maxHeight)}_fitRows(t,a,i,r){const{ctx:l,maxWidth:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],p=this.lineWidths=[0],m=r+u;let g=t;l.textAlign="left",l.textBaseline="middle";let y=-1,b=-m;return this.legendItems.forEach((D,S)=>{const k=i+a/2+l.measureText(D.text).width;(S===0||p[p.length-1]+k+2*u>c)&&(g+=m,p[p.length-(S>0?0:1)]=0,b+=m,y++),f[S]={left:0,top:b,row:y,width:k,height:r},p[p.length-1]+=k+u}),g}_fitCols(t,a,i,r){const{ctx:l,maxHeight:c,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],p=this.columnSizes=[],m=c-t;let g=u,y=0,b=0,D=0,S=0;return this.legendItems.forEach((k,A)=>{const{itemWidth:E,itemHeight:M}=bb(i,a,l,k,r);A>0&&b+M+2*u>m&&(g+=y+u,p.push({width:y,height:b}),D+=y+u,S++,y=b=0),f[A]={left:D,top:b,col:S,width:E,height:M},y=Math.max(y,E),b+=M+u}),g+=y,p.push({width:y,height:b}),g}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:i,labels:{padding:r},rtl:l}}=this,c=Ji(l,this.left,this.width);if(this.isHorizontal()){let u=0,f=Ms(i,this.left+r,this.right-this.lineWidths[u]);for(const p of a)u!==p.row&&(u=p.row,f=Ms(i,this.left+r,this.right-this.lineWidths[u])),p.top+=this.top+t+r,p.left=c.leftForLtr(c.x(f),p.width),f+=p.width+r}else{let u=0,f=Ms(i,this.top+t+r,this.bottom-this.columnSizes[u].height);for(const p of a)p.col!==u&&(u=p.col,f=Ms(i,this.top+t+r,this.bottom-this.columnSizes[u].height)),p.top=f,p.left+=this.left+r,p.left=c.leftForLtr(c.x(p.left),p.width),f+=p.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;to(t,this),this._draw(),ao(t)}}_draw(){const{options:t,columnSizes:a,lineWidths:i,ctx:r}=this,{align:l,labels:c}=t,u=fs.color,f=Ji(t.rtl,this.left,this.width),p=Ps(c.font),{padding:m}=c,g=p.size,y=g/2;let b;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=p.string;const{boxWidth:D,boxHeight:S,itemHeight:k}=Pl(c,g),A=function(z,R,J){if(isNaN(D)||D<=0||isNaN(S)||S<0)return;r.save();const V=Ya(J.lineWidth,1);if(r.fillStyle=Ya(J.fillStyle,u),r.lineCap=Ya(J.lineCap,"butt"),r.lineDashOffset=Ya(J.lineDashOffset,0),r.lineJoin=Ya(J.lineJoin,"miter"),r.lineWidth=V,r.strokeStyle=Ya(J.strokeStyle,u),r.setLineDash(Ya(J.lineDash,[])),c.usePointStyle){const L={radius:S*Math.SQRT2/2,pointStyle:J.pointStyle,rotation:J.rotation,borderWidth:V},X=f.xPlus(z,D/2),ne=R+y;vc(r,L,X,ne,c.pointStyleWidth&&D)}else{const L=R+Math.max((g-S)/2,0),X=f.leftForLtr(z,D),ne=Qi(J.borderRadius);r.beginPath(),Object.values(ne).some(ce=>ce!==0)?cr(r,{x:X,y:L,w:D,h:S,radius:ne}):r.rect(X,L,D,S),r.fill(),V!==0&&r.stroke()}r.restore()},E=function(z,R,J){Cn(r,J.text,z,R+k/2,p,{strikethrough:J.hidden,textAlign:f.textAlign(J.textAlign)})},M=this.isHorizontal(),I=this._computeTitleHeight();M?b={x:Ms(l,this.left+m,this.right-i[0]),y:this.top+m+I,line:0}:b={x:this.left+m,y:Ms(l,this.top+I+m,this.bottom-a[0].height),line:0},bc(this.ctx,t.textDirection);const F=k+m;this.legendItems.forEach((z,R)=>{r.strokeStyle=z.fontColor,r.fillStyle=z.fontColor;const J=r.measureText(z.text).width,V=f.textAlign(z.textAlign||(z.textAlign=c.textAlign)),L=D+y+J;let X=b.x,ne=b.y;f.setWidth(this.width),M?R>0&&X+L+m>this.right&&(ne=b.y+=F,b.line++,X=b.x=Ms(l,this.left+m,this.right-i[b.line])):R>0&&ne+F>this.bottom&&(X=b.x=X+a[b.line].width+m,b.line++,ne=b.y=Ms(l,this.top+I+m,this.bottom-a[b.line].height));const ce=f.x(X);if(A(ce,ne,z),X=Rm(V,X+D+y,M?X+L:this.right,t.rtl),E(f.x(X),ne,z),M)b.x+=L+m;else if(typeof z.text!="string"){const Le=p.lineHeight;b.y+=Lc(z,Le)+m}else b.y+=F}),yc(this.ctx,t.textDirection)}drawTitle(){const t=this.options,a=t.title,i=Ps(a.font),r=Hs(a.padding);if(!a.display)return;const l=Ji(t.rtl,this.left,this.width),c=this.ctx,u=a.position,f=i.size/2,p=r.top+f;let m,g=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),m=this.top+p,g=Ms(t.align,g,this.right-y);else{const D=this.columnSizes.reduce((S,k)=>Math.max(S,k.height),0);m=p+Ms(t.align,this.top,this.bottom-D-t.labels.padding-this._computeTitleHeight())}const b=Ms(u,g,g+y);c.textAlign=l.textAlign(Zr(u)),c.textBaseline="middle",c.strokeStyle=a.color,c.fillStyle=a.color,c.font=i.string,Cn(c,a.text,b,m,i)}_computeTitleHeight(){const t=this.options.title,a=Ps(t.font),i=Hs(t.padding);return t.display?a.lineHeight+i.height:0}_getLegendItemAt(t,a){let i,r,l;if(Ci(t,this.left,this.right)&&Ci(a,this.top,this.bottom)){for(l=this.legendHitBoxes,i=0;i<l.length;++i)if(r=l[i],Ci(t,r.left,r.left+r.width)&&Ci(a,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){const a=this.options;if(!xb(t.type,a))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,l=_b(r,i);r&&!l&&ls(a.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!l&&ls(a.onHover,[t,i,this],this)}else i&&ls(a.onClick,[t,i,this],this)}}function bb(s,t,a,i,r){const l=yb(i,s,t,a),c=wb(r,i,t.lineHeight);return{itemWidth:l,itemHeight:c}}function yb(s,t,a,i){let r=s.text;return r&&typeof r!="string"&&(r=r.reduce((l,c)=>l.length>c.length?l:c)),t+a.size/2+i.measureText(r).width}function wb(s,t,a){let i=s;return typeof t.text!="string"&&(i=Lc(t,a)),i}function Lc(s,t){const a=s.text?s.text.length:0;return t*a}function xb(s,t){return!!((s==="mousemove"||s==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(s==="click"||s==="mouseup"))}var $c={id:"legend",_element:El,start(s,t,a){const i=s.legend=new El({ctx:s.ctx,options:a,chart:s});zs.configure(s,i,a),zs.addBox(s,i)},stop(s){zs.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,t,a){const i=s.legend;zs.configure(s,i,a),i.options=a},afterUpdate(s){const t=s.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(s,t){t.replay||s.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,t,a){const i=t.datasetIndex,r=a.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const t=s.data.datasets,{labels:{usePointStyle:a,pointStyle:i,textAlign:r,color:l,useBorderRadius:c,borderRadius:u}}=s.legend.options;return s._getSortedDatasetMetas().map(f=>{const p=f.controller.getStyle(a?0:void 0),m=Hs(p.borderWidth);return{text:t[f.index].label,fillStyle:p.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:p.borderCapStyle,lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:p.borderColor,pointStyle:i||p.pointStyle,rotation:p.rotation,textAlign:r||p.textAlign,borderRadius:c&&(u||p.borderRadius),datasetIndex:f.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class jc extends Ni{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,a){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=a;const r=ys(i.text)?i.text.length:1;this._padding=Hs(i.padding);const l=r*Ps(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:a,left:i,bottom:r,right:l,options:c}=this,u=c.align;let f=0,p,m,g;return this.isHorizontal()?(m=Ms(u,i,l),g=a+t,p=l-i):(c.position==="left"?(m=i+t,g=Ms(u,r,a),f=ss*-.5):(m=l-t,g=Ms(u,a,r),f=ss*.5),p=r-a),{titleX:m,titleY:g,maxWidth:p,rotation:f}}draw(){const t=this.ctx,a=this.options;if(!a.display)return;const i=Ps(a.font),l=i.lineHeight/2+this._padding.top,{titleX:c,titleY:u,maxWidth:f,rotation:p}=this._drawArgs(l);Cn(t,a.text,0,0,i,{color:a.color,maxWidth:f,rotation:p,textAlign:Zr(a.align),textBaseline:"middle",translation:[c,u]})}}function Sb(s,t){const a=new jc({ctx:s.ctx,options:t,chart:s});zs.configure(s,a,t),zs.addBox(s,a),s.titleBlock=a}var Ic={id:"title",_element:jc,start(s,t,a){Sb(s,a)},stop(s){const t=s.titleBlock;zs.removeBox(s,t),delete s.titleBlock},beforeUpdate(s,t,a){const i=s.titleBlock;zs.configure(s,i,a),i.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const bn={average(s){if(!s.length)return!1;let t,a,i=new Set,r=0,l=0;for(t=0,a=s.length;t<a;++t){const u=s[t].element;if(u&&u.hasValue()){const f=u.tooltipPosition();i.add(f.x),r+=f.y,++l}}return l===0||i.size===0?!1:{x:[...i].reduce((u,f)=>u+f)/i.size,y:r/l}},nearest(s,t){if(!s.length)return!1;let a=t.x,i=t.y,r=Number.POSITIVE_INFINITY,l,c,u;for(l=0,c=s.length;l<c;++l){const f=s[l].element;if(f&&f.hasValue()){const p=f.getCenterPoint(),m=Fm(t,p);m<r&&(r=m,u=f)}}if(u){const f=u.tooltipPosition();a=f.x,i=f.y}return{x:a,y:i}}};function si(s,t){return t&&(ys(t)?Array.prototype.push.apply(s,t):s.push(t)),s}function ci(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function kb(s,t){const{element:a,datasetIndex:i,index:r}=t,l=s.getDatasetMeta(i).controller,{label:c,value:u}=l.getLabelAndValue(r);return{chart:s,label:c,parsed:l.getParsed(r),raw:s.data.datasets[i].data[r],formattedValue:u,dataset:l.getDataset(),dataIndex:r,datasetIndex:i,element:a}}function Fl(s,t){const a=s.chart.ctx,{body:i,footer:r,title:l}=s,{boxWidth:c,boxHeight:u}=t,f=Ps(t.bodyFont),p=Ps(t.titleFont),m=Ps(t.footerFont),g=l.length,y=r.length,b=i.length,D=Hs(t.padding);let S=D.height,k=0,A=i.reduce((I,F)=>I+F.before.length+F.lines.length+F.after.length,0);if(A+=s.beforeBody.length+s.afterBody.length,g&&(S+=g*p.lineHeight+(g-1)*t.titleSpacing+t.titleMarginBottom),A){const I=t.displayColors?Math.max(u,f.lineHeight):f.lineHeight;S+=b*I+(A-b)*f.lineHeight+(A-1)*t.bodySpacing}y&&(S+=t.footerMarginTop+y*m.lineHeight+(y-1)*t.footerSpacing);let E=0;const M=function(I){k=Math.max(k,a.measureText(I).width+E)};return a.save(),a.font=p.string,Za(s.title,M),a.font=f.string,Za(s.beforeBody.concat(s.afterBody),M),E=t.displayColors?c+2+t.boxPadding:0,Za(i,I=>{Za(I.before,M),Za(I.lines,M),Za(I.after,M)}),E=0,a.font=m.string,Za(s.footer,M),a.restore(),k+=D.width,{width:k,height:S}}function Db(s,t){const{y:a,height:i}=t;return a<i/2?"top":a>s.height-i/2?"bottom":"center"}function Ab(s,t,a,i){const{x:r,width:l}=i,c=a.caretSize+a.caretPadding;if(s==="left"&&r+l+c>t.width||s==="right"&&r-l-c<0)return!0}function Cb(s,t,a,i){const{x:r,width:l}=a,{width:c,chartArea:{left:u,right:f}}=s;let p="center";return i==="center"?p=r<=(u+f)/2?"left":"right":r<=l/2?p="left":r>=c-l/2&&(p="right"),Ab(p,s,t,a)&&(p="center"),p}function Nl(s,t,a){const i=a.yAlign||t.yAlign||Db(s,a);return{xAlign:a.xAlign||t.xAlign||Cb(s,t,a,i),yAlign:i}}function Tb(s,t){let{x:a,width:i}=s;return t==="right"?a-=i:t==="center"&&(a-=i/2),a}function Mb(s,t,a){let{y:i,height:r}=s;return t==="top"?i+=a:t==="bottom"?i-=r+a:i-=r/2,i}function Ll(s,t,a,i){const{caretSize:r,caretPadding:l,cornerRadius:c}=s,{xAlign:u,yAlign:f}=a,p=r+l,{topLeft:m,topRight:g,bottomLeft:y,bottomRight:b}=Qi(c);let D=Tb(t,u);const S=Mb(t,f,p);return f==="center"?u==="left"?D+=p:u==="right"&&(D-=p):u==="left"?D-=Math.max(m,y)+r:u==="right"&&(D+=Math.max(g,b)+r),{x:js(D,0,i.width-t.width),y:js(S,0,i.height-t.height)}}function Kn(s,t,a){const i=Hs(a.padding);return t==="center"?s.x+s.width/2:t==="right"?s.x+s.width-i.right:s.x+i.left}function $l(s){return si([],ci(s))}function Pb(s,t,a){return Xi(s,{tooltip:t,tooltipItems:a,type:"tooltip"})}function jl(s,t){const a=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return a?s.override(a):s}const Rc={beforeTitle:oi,title(s){if(s.length>0){const t=s[0],a=t.chart.data.labels,i=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return a[t.dataIndex]}return""},afterTitle:oi,beforeBody:oi,beforeLabel:oi,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let t=s.dataset.label||"";t&&(t+=": ");const a=s.formattedValue;return is(a)||(t+=a),t},labelColor(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:oi,afterBody:oi,beforeFooter:oi,footer:oi,afterFooter:oi};function Ls(s,t,a,i){const r=s[t].call(a,i);return typeof r>"u"?Rc[t].call(a,i):r}class Il extends Ni{static positioners=bn;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const a=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&a.options.animation&&i.animations,l=new wc(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=Pb(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,a){const{callbacks:i}=a,r=Ls(i,"beforeTitle",this,t),l=Ls(i,"title",this,t),c=Ls(i,"afterTitle",this,t);let u=[];return u=si(u,ci(r)),u=si(u,ci(l)),u=si(u,ci(c)),u}getBeforeBody(t,a){return $l(Ls(a.callbacks,"beforeBody",this,t))}getBody(t,a){const{callbacks:i}=a,r=[];return Za(t,l=>{const c={before:[],lines:[],after:[]},u=jl(i,l);si(c.before,ci(Ls(u,"beforeLabel",this,l))),si(c.lines,Ls(u,"label",this,l)),si(c.after,ci(Ls(u,"afterLabel",this,l))),r.push(c)}),r}getAfterBody(t,a){return $l(Ls(a.callbacks,"afterBody",this,t))}getFooter(t,a){const{callbacks:i}=a,r=Ls(i,"beforeFooter",this,t),l=Ls(i,"footer",this,t),c=Ls(i,"afterFooter",this,t);let u=[];return u=si(u,ci(r)),u=si(u,ci(l)),u=si(u,ci(c)),u}_createItems(t){const a=this._active,i=this.chart.data,r=[],l=[],c=[];let u=[],f,p;for(f=0,p=a.length;f<p;++f)u.push(kb(this.chart,a[f]));return t.filter&&(u=u.filter((m,g,y)=>t.filter(m,g,y,i))),t.itemSort&&(u=u.sort((m,g)=>t.itemSort(m,g,i))),Za(u,m=>{const g=jl(t.callbacks,m);r.push(Ls(g,"labelColor",this,m)),l.push(Ls(g,"labelPointStyle",this,m)),c.push(Ls(g,"labelTextColor",this,m))}),this.labelColors=r,this.labelPointStyles=l,this.labelTextColors=c,this.dataPoints=u,u}update(t,a){const i=this.options.setContext(this.getContext()),r=this._active;let l,c=[];if(!r.length)this.opacity!==0&&(l={opacity:0});else{const u=bn[i.position].call(this,r,this._eventPosition);c=this._createItems(i),this.title=this.getTitle(c,i),this.beforeBody=this.getBeforeBody(c,i),this.body=this.getBody(c,i),this.afterBody=this.getAfterBody(c,i),this.footer=this.getFooter(c,i);const f=this._size=Fl(this,i),p=Object.assign({},u,f),m=Nl(this.chart,i,p),g=Ll(i,p,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,l={opacity:1,x:g.x,y:g.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(t,a,i,r){const l=this.getCaretPosition(t,i,r);a.lineTo(l.x1,l.y1),a.lineTo(l.x2,l.y2),a.lineTo(l.x3,l.y3)}getCaretPosition(t,a,i){const{xAlign:r,yAlign:l}=this,{caretSize:c,cornerRadius:u}=i,{topLeft:f,topRight:p,bottomLeft:m,bottomRight:g}=Qi(u),{x:y,y:b}=t,{width:D,height:S}=a;let k,A,E,M,I,F;return l==="center"?(I=b+S/2,r==="left"?(k=y,A=k-c,M=I+c,F=I-c):(k=y+D,A=k+c,M=I-c,F=I+c),E=k):(r==="left"?A=y+Math.max(f,m)+c:r==="right"?A=y+D-Math.max(p,g)-c:A=this.caretX,l==="top"?(M=b,I=M-c,k=A-c,E=A+c):(M=b+S,I=M+c,k=A+c,E=A-c),F=M),{x1:k,x2:A,x3:E,y1:M,y2:I,y3:F}}drawTitle(t,a,i){const r=this.title,l=r.length;let c,u,f;if(l){const p=Ji(i.rtl,this.x,this.width);for(t.x=Kn(this,i.titleAlign,i),a.textAlign=p.textAlign(i.titleAlign),a.textBaseline="middle",c=Ps(i.titleFont),u=i.titleSpacing,a.fillStyle=i.titleColor,a.font=c.string,f=0;f<l;++f)a.fillText(r[f],p.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+u,f+1===l&&(t.y+=i.titleMarginBottom-u)}}_drawColorBox(t,a,i,r,l){const c=this.labelColors[i],u=this.labelPointStyles[i],{boxHeight:f,boxWidth:p}=l,m=Ps(l.bodyFont),g=Kn(this,"left",l),y=r.x(g),b=f<m.lineHeight?(m.lineHeight-f)/2:0,D=a.y+b;if(l.usePointStyle){const S={radius:Math.min(p,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},k=r.leftForLtr(y,p)+p/2,A=D+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,Ko(t,S,k,A),t.strokeStyle=c.borderColor,t.fillStyle=c.backgroundColor,Ko(t,S,k,A)}else{t.lineWidth=Ua(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,t.strokeStyle=c.borderColor,t.setLineDash(c.borderDash||[]),t.lineDashOffset=c.borderDashOffset||0;const S=r.leftForLtr(y,p),k=r.leftForLtr(r.xPlus(y,1),p-2),A=Qi(c.borderRadius);Object.values(A).some(E=>E!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,cr(t,{x:S,y:D,w:p,h:f,radius:A}),t.fill(),t.stroke(),t.fillStyle=c.backgroundColor,t.beginPath(),cr(t,{x:k,y:D+1,w:p-2,h:f-2,radius:A}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(S,D,p,f),t.strokeRect(S,D,p,f),t.fillStyle=c.backgroundColor,t.fillRect(k,D+1,p-2,f-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,a,i){const{body:r}=this,{bodySpacing:l,bodyAlign:c,displayColors:u,boxHeight:f,boxWidth:p,boxPadding:m}=i,g=Ps(i.bodyFont);let y=g.lineHeight,b=0;const D=Ji(i.rtl,this.x,this.width),S=function(J){a.fillText(J,D.x(t.x+b),t.y+y/2),t.y+=y+l},k=D.textAlign(c);let A,E,M,I,F,z,R;for(a.textAlign=c,a.textBaseline="middle",a.font=g.string,t.x=Kn(this,k,i),a.fillStyle=i.bodyColor,Za(this.beforeBody,S),b=u&&k!=="right"?c==="center"?p/2+m:p+2+m:0,I=0,z=r.length;I<z;++I){for(A=r[I],E=this.labelTextColors[I],a.fillStyle=E,Za(A.before,S),M=A.lines,u&&M.length&&(this._drawColorBox(a,t,I,D,i),y=Math.max(g.lineHeight,f)),F=0,R=M.length;F<R;++F)S(M[F]),y=g.lineHeight;Za(A.after,S)}b=0,y=g.lineHeight,Za(this.afterBody,S),t.y-=l}drawFooter(t,a,i){const r=this.footer,l=r.length;let c,u;if(l){const f=Ji(i.rtl,this.x,this.width);for(t.x=Kn(this,i.footerAlign,i),t.y+=i.footerMarginTop,a.textAlign=f.textAlign(i.footerAlign),a.textBaseline="middle",c=Ps(i.footerFont),a.fillStyle=i.footerColor,a.font=c.string,u=0;u<l;++u)a.fillText(r[u],f.x(t.x),t.y+c.lineHeight/2),t.y+=c.lineHeight+i.footerSpacing}}drawBackground(t,a,i,r){const{xAlign:l,yAlign:c}=this,{x:u,y:f}=t,{width:p,height:m}=i,{topLeft:g,topRight:y,bottomLeft:b,bottomRight:D}=Qi(r.cornerRadius);a.fillStyle=r.backgroundColor,a.strokeStyle=r.borderColor,a.lineWidth=r.borderWidth,a.beginPath(),a.moveTo(u+g,f),c==="top"&&this.drawCaret(t,a,i,r),a.lineTo(u+p-y,f),a.quadraticCurveTo(u+p,f,u+p,f+y),c==="center"&&l==="right"&&this.drawCaret(t,a,i,r),a.lineTo(u+p,f+m-D),a.quadraticCurveTo(u+p,f+m,u+p-D,f+m),c==="bottom"&&this.drawCaret(t,a,i,r),a.lineTo(u+b,f+m),a.quadraticCurveTo(u,f+m,u,f+m-b),c==="center"&&l==="left"&&this.drawCaret(t,a,i,r),a.lineTo(u,f+g),a.quadraticCurveTo(u,f,u+g,f),a.closePath(),a.fill(),r.borderWidth>0&&a.stroke()}_updateAnimationTarget(t){const a=this.chart,i=this.$animations,r=i&&i.x,l=i&&i.y;if(r||l){const c=bn[t.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=Fl(this,t),f=Object.assign({},c,this._size),p=Nl(a,t,f),m=Ll(t,f,p,a);(r._to!==m.x||l._to!==m.y)&&(this.xAlign=p.xAlign,this.yAlign=p.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(t){const a=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(a);const r={width:this.width,height:this.height},l={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const c=Hs(a.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&u&&(t.save(),t.globalAlpha=i,this.drawBackground(l,t,r,a),bc(t,a.textDirection),l.y+=c.top,this.drawTitle(l,t,a),this.drawBody(l,t,a),this.drawFooter(l,t,a),yc(t,a.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,a){const i=this._active,r=t.map(({datasetIndex:u,index:f})=>{const p=this.chart.getDatasetMeta(u);if(!p)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:p.data[f],index:f}}),l=!ir(i,r),c=this._positionChanged(r,a);(l||c)&&(this._active=r,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,a,i=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,l=this._active||[],c=this._getActiveElements(t,l,a,i),u=this._positionChanged(c,t),f=a||!ir(c,l)||u;return f&&(this._active=c,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,a))),f}_getActiveElements(t,a,i,r){const l=this.options;if(t.type==="mouseout")return[];if(!r)return a.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(t,l.mode,l,i);return l.reverse&&c.reverse(),c}_positionChanged(t,a){const{caretX:i,caretY:r,options:l}=this,c=bn[l.position].call(this,t,a);return c!==!1&&(i!==c.x||r!==c.y)}}var Oc={id:"tooltip",_element:Il,positioners:bn,afterInit(s,t,a){a&&(s.tooltip=new Il({chart:s,options:a}))},beforeUpdate(s,t,a){s.tooltip&&s.tooltip.initialize(a)},reset(s,t,a){s.tooltip&&s.tooltip.initialize(a)},afterDraw(s){const t=s.tooltip;if(t&&t._willRender()){const a={tooltip:t};if(s.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;t.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",a)}},afterEvent(s,t){if(s.tooltip){const a=t.replay;s.tooltip.handleEvent(t.event,a,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,t)=>t.bodyFont.size,boxWidth:(s,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Rc},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Eb=(s,t,a,i)=>(typeof t=="string"?(a=s.push(t)-1,i.unshift({index:a,label:t})):isNaN(t)&&(a=null),a);function Fb(s,t,a,i){const r=s.indexOf(t);if(r===-1)return Eb(s,t,a,i);const l=s.lastIndexOf(t);return r!==l?a:r}const Nb=(s,t)=>s===null?null:js(Math.round(s),0,t);function Rl(s){const t=this.getLabels();return s>=0&&s<t.length?t[s]:s}class Lb extends Zi{static id="category";static defaults={ticks:{callback:Rl}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const a=this._addedLabels;if(a.length){const i=this.getLabels();for(const{index:r,label:l}of a)i[r]===l&&i.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,a){if(is(t))return null;const i=this.getLabels();return a=isFinite(a)&&i[a]===t?a:Fb(i,t,Ya(a,t),this._addedLabels),Nb(a,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:a}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),a||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const t=this.min,a=this.max,i=this.options.offset,r=[];let l=this.getLabels();l=t===0&&a===l.length-1?l:l.slice(t,a+1),this._valueRange=Math.max(l.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let c=t;c<=a;c++)r.push({value:c});return r}getLabelForValue(t){return Rl.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const a=this.ticks;return t<0||t>a.length-1?null:this.getPixelForValue(a[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function $b(s,t){const a=[],{bounds:r,step:l,min:c,max:u,precision:f,count:p,maxTicks:m,maxDigits:g,includeBounds:y}=s,b=l||1,D=m-1,{min:S,max:k}=t,A=!is(c),E=!is(u),M=!is(p),I=(k-S)/(g+1);let F=Bo((k-S)/D/b)*b,z,R,J,V;if(F<1e-14&&!A&&!E)return[{value:S},{value:k}];V=Math.ceil(k/F)-Math.floor(S/F),V>D&&(F=Bo(V*F/D/b)*b),is(f)||(z=Math.pow(10,f),F=Math.ceil(F*z)/z),r==="ticks"?(R=Math.floor(S/F)*F,J=Math.ceil(k/F)*F):(R=S,J=k),A&&E&&l&&Mm((u-c)/l,F/1e3)?(V=Math.round(Math.min((u-c)/F,m)),F=(u-c)/V,R=c,J=u):M?(R=A?c:R,J=E?u:J,V=p-1,F=(J-R)/V):(V=(J-R)/F,Zn(V,Math.round(V),F/1e3)?V=Math.round(V):V=Math.ceil(V));const L=Math.max(zo(F),zo(R));z=Math.pow(10,is(f)?L:f),R=Math.round(R*z)/z,J=Math.round(J*z)/z;let X=0;for(A&&(y&&R!==c?(a.push({value:c}),R<c&&X++,Zn(Math.round((R+X*F)*z)/z,c,Ol(c,I,s))&&X++):R<c&&X++);X<V;++X){const ne=Math.round((R+X*F)*z)/z;if(E&&ne>u)break;a.push({value:ne})}return E&&y&&J!==u?a.length&&Zn(a[a.length-1].value,u,Ol(u,I,s))?a[a.length-1].value=u:a.push({value:u}):(!E||J===u)&&a.push({value:J}),a}function Ol(s,t,{horizontal:a,minRotation:i}){const r=ui(i),l=(a?Math.sin(r):Math.cos(r))||.001,c=.75*t*(""+s).length;return Math.min(t/l,c)}class jb extends Zi{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,a){return is(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:a,maxDefined:i}=this.getUserBounds();let{min:r,max:l}=this;const c=f=>r=a?r:f,u=f=>l=i?l:f;if(t){const f=_i(r),p=_i(l);f<0&&p<0?u(0):f>0&&p>0&&c(0)}if(r===l){let f=l===0?1:Math.abs(l*.05);u(l+f),t||c(r-f)}this.min=r,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:a,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),a=a||11),a&&(r=Math.min(a,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,a=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},l=this._range||this,c=$b(r,l);return t.bounds==="ticks"&&Pm(c,this,"value"),t.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const t=this.ticks;let a=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const r=(i-a)/Math.max(t.length-1,1)/2;a-=r,i+=r}this._startValue=a,this._endValue=i,this._valueRange=i-a}getLabelForValue(t){return eo(t,this.chart.options.locale,this.options.ticks.format)}}class Ib extends jb{static id="linear";static defaults={ticks:{callback:uc.formatters.numeric}};determineDataLimits(){const{min:t,max:a}=this.getMinMax(!0);this.min=Ws(t)?t:0,this.max=Ws(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),a=t?this.width:this.height,i=ui(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,l.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const hr={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},$s=Object.keys(hr);function ql(s,t){return s-t}function Vl(s,t){if(is(t))return null;const a=s._adapter,{parser:i,round:r,isoWeekday:l}=s._parseOpts;let c=t;return typeof i=="function"&&(c=i(c)),Ws(c)||(c=typeof i=="string"?a.parse(c,i):a.parse(c)),c===null?null:(r&&(c=r==="week"&&(or(l)||l===!0)?a.startOf(c,"isoWeek",l):a.startOf(c,r)),+c)}function Bl(s,t,a,i){const r=$s.length;for(let l=$s.indexOf(s);l<r-1;++l){const c=hr[$s[l]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((a-t)/(u*c.size))<=i)return $s[l]}return $s[r-1]}function Rb(s,t,a,i,r){for(let l=$s.length-1;l>=$s.indexOf(a);l--){const c=$s[l];if(hr[c].common&&s._adapter.diff(r,i,c)>=t-1)return c}return $s[a?$s.indexOf(a):0]}function Ob(s){for(let t=$s.indexOf(s)+1,a=$s.length;t<a;++t)if(hr[$s[t]].common)return $s[t]}function zl(s,t,a){if(!a)s[t]=!0;else if(a.length){const{lo:i,hi:r}=Xr(a,t),l=a[i]>=t?a[i]:a[r];s[l]=!0}}function qb(s,t,a,i){const r=s._adapter,l=+r.startOf(t[0].value,i),c=t[t.length-1].value;let u,f;for(u=l;u<=c;u=+r.add(u,1,i))f=a[u],f>=0&&(t[f].major=!0);return t}function Gl(s,t,a){const i=[],r={},l=t.length;let c,u;for(c=0;c<l;++c)u=t[c],r[u]=c,i.push({value:u,major:!1});return l===0||!a?i:qb(s,i,r,a)}class Wl extends Zi{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,a={}){const i=t.time||(t.time={}),r=this._adapter=new Jg._date(t.adapters.date);r.init(a),yn(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=a.normalized}parse(t,a){return t===void 0?null:Vl(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,a=this._adapter,i=t.time.unit||"day";let{min:r,max:l,minDefined:c,maxDefined:u}=this.getUserBounds();function f(p){!c&&!isNaN(p.min)&&(r=Math.min(r,p.min)),!u&&!isNaN(p.max)&&(l=Math.max(l,p.max))}(!c||!u)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),r=Ws(r)&&!isNaN(r)?r:+a.startOf(Date.now(),i),l=Ws(l)&&!isNaN(l)?l:+a.endOf(Date.now(),i)+1,this.min=Math.min(r,l-1),this.max=Math.max(r+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(a=t[0],i=t[t.length-1]),{min:a,max:i}}buildTicks(){const t=this.options,a=t.time,i=t.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const l=this.min,c=this.max,u=$m(r,l,c);return this._unit=a.unit||(i.autoSkip?Bl(a.minUnit,this.min,this.max,this._getLabelCapacity(l)):Rb(this,u.length,a.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Ob(this._unit),this.initOffsets(r),t.reverse&&u.reverse(),Gl(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let a=0,i=0,r,l;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?a=1-r:a=(this.getDecimalForValue(t[1])-r)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?i=l:i=(l-this.getDecimalForValue(t[t.length-2]))/2);const c=t.length<3?.5:.25;a=js(a,0,c),i=js(i,0,c),this._offsets={start:a,end:i,factor:1/(a+1+i)}}_generate(){const t=this._adapter,a=this.min,i=this.max,r=this.options,l=r.time,c=l.unit||Bl(l.minUnit,a,i,this._getLabelCapacity(a)),u=Ya(r.ticks.stepSize,1),f=c==="week"?l.isoWeekday:!1,p=or(f)||f===!0,m={};let g=a,y,b;if(p&&(g=+t.startOf(g,"isoWeek",f)),g=+t.startOf(g,p?"day":c),t.diff(i,a,c)>1e5*u)throw new Error(a+" and "+i+" are too far apart with stepSize of "+u+" "+c);const D=r.ticks.source==="data"&&this.getDataTimestamps();for(y=g,b=0;y<i;y=+t.add(y,u,c),b++)zl(m,y,D);return(y===i||r.bounds==="ticks"||b===1)&&zl(m,y,D),Object.keys(m).sort(ql).map(S=>+S)}getLabelForValue(t){const a=this._adapter,i=this.options.time;return i.tooltipFormat?a.format(t,i.tooltipFormat):a.format(t,i.displayFormats.datetime)}format(t,a){const r=this.options.time.displayFormats,l=this._unit,c=a||r[l];return this._adapter.format(t,c)}_tickFormatFunction(t,a,i,r){const l=this.options,c=l.ticks.callback;if(c)return ls(c,[t,a,i],this);const u=l.time.displayFormats,f=this._unit,p=this._majorUnit,m=f&&u[f],g=p&&u[p],y=i[a],b=p&&g&&y&&y.major;return this._adapter.format(t,r||(b?g:m))}generateTickLabels(t){let a,i,r;for(a=0,i=t.length;a<i;++a)r=t[a],r.label=this._tickFormatFunction(r.value,a,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const a=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((a.start+i)*a.factor)}getValueForPixel(t){const a=this._offsets,i=this.getDecimalForPixel(t)/a.factor-a.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const a=this.options.ticks,i=this.ctx.measureText(t).width,r=ui(this.isHorizontal()?a.maxRotation:a.minRotation),l=Math.cos(r),c=Math.sin(r),u=this._resolveTickFontOptions(0).size;return{w:i*l+u*c,h:i*c+u*l}}_getLabelCapacity(t){const a=this.options.time,i=a.displayFormats,r=i[a.unit]||i.millisecond,l=this._tickFormatFunction(t,0,Gl(this,[t],this._majorUnit),r),c=this._getLabelSize(l),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let t=this._cache.data||[],a,i;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(a=0,i=r.length;a<i;++a)t=t.concat(r[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let a,i;if(t.length)return t;const r=this.getLabels();for(a=0,i=r.length;a<i;++a)t.push(Vl(this,r[a]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return oc(t.sort(ql))}}function Xn(s,t,a){let i=0,r=s.length-1,l,c,u,f;a?(t>=s[i].pos&&t<=s[r].pos&&({lo:i,hi:r}=Br(s,"pos",t)),{pos:l,time:u}=s[i],{pos:c,time:f}=s[r]):(t>=s[i].time&&t<=s[r].time&&({lo:i,hi:r}=Br(s,"time",t)),{time:l,pos:u}=s[i],{time:c,pos:f}=s[r]);const p=c-l;return p?u+(f-u)*(t-l)/p:u}class sS extends Wl{static id="timeseries";static defaults=Wl.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(t);this._minPos=Xn(a,this.min),this._tableRange=Xn(a,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:a,max:i}=this,r=[],l=[];let c,u,f,p,m;for(c=0,u=t.length;c<u;++c)p=t[c],p>=a&&p<=i&&r.push(p);if(r.length<2)return[{time:a,pos:0},{time:i,pos:1}];for(c=0,u=r.length;c<u;++c)m=r[c+1],f=r[c-1],p=r[c],Math.round((m+f)/2)!==p&&l.push({time:p,pos:c/(u-1)});return l}_generate(){const t=this.min,a=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(a)||i.length===1)&&i.push(a),i.sort((r,l)=>r-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const a=this.getDataTimestamps(),i=this.getLabelTimestamps();return a.length&&i.length?t=this.normalize(a.concat(i)):t=a.length?a:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Xn(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const a=this._offsets,i=this.getDecimalForPixel(t)/a.factor-a.end;return Xn(this._table,i*this._tableRange+this._minPos,!0)}}var Vb=_('<div class="chart-loading svelte-cvu4lr"><div class="chart-loader svelte-cvu4lr"></div> <p class="svelte-cvu4lr">Loading chart data...</p></div>'),Bb=_('<div class="chart-error svelte-cvu4lr"><span class="material-symbols-outlined svelte-cvu4lr">error</span> <p class="svelte-cvu4lr"> </p> <button class="retry-button svelte-cvu4lr"><span class="material-symbols-outlined svelte-cvu4lr">refresh</span> Retry</button></div>'),zb=_('<div class="legend-item svelte-cvu4lr"><div class="legend-circle svelte-cvu4lr"></div> <span class="legend-text svelte-cvu4lr"> </span></div>'),Gb=_('<canvas class="svelte-cvu4lr"></canvas> <div class="graph-label svelte-cvu4lr"></div>',1),Wb=_('<div class="chart-container svelte-cvu4lr"><!></div>');function Hb(s,t){za(t,!1),Mn.register(Qg,ub,Oc,$c,Ic);let a=P(),i,r=P(!0),l=P(null),c=null;const u=["7","8","9","10"],f=["rgb(0, 114, 178)","rgb(230, 159, 0)","rgb(86, 180, 233)","rgb(102, 102, 102)"];async function p(){try{d(r,!0),d(l,null);const k=await da.get("/api/dashboard/students-per-grade");if(k.success)c=k.data,d(r,!1),setTimeout(()=>{e(a)&&m(k.data)},0);else throw new Error(k.error||"Failed to fetch students data")}catch(k){console.error("Error fetching students per grade level:",k),d(l,k.message),d(r,!1)}}function m(k){if(!e(a)){console.warn("Canvas not yet available");return}i&&i.destroy();const A=u.map((M,I)=>{const F=k.find(z=>z.grade_level===M);return F?F.count:0}),E=e(a).getContext("2d");i=new Mn(E,{type:"doughnut",data:{labels:u.map(M=>`Grade ${M}`),datasets:[{label:"Students",data:A,backgroundColor:f,borderWidth:5,borderRadius:2,borderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim(),hoverBorderWidth:1,hoverBorderColor:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-surface-container").trim()}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"50%",plugins:{legend:{display:!1},title:{display:!0,text:"Students per Grade Level",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(M){const I=M.label||"",F=M.parsed||0,z=M.dataset.data.reduce((J,V)=>J+V,0),R=z>0?(F/z*100).toFixed(1):0;return`${I}: ${F} students (${R}%)`}}},centerText:{display:!0,text:M=>`${M.data.datasets[0].data.reduce((z,R)=>z+R,0)}
Total
Students`,color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:20,weight:"bold"}}}},plugins:[{id:"centerText",beforeDraw(M){const{ctx:I,chartArea:{width:F,height:z}}=M,R=M.config.options.plugins.centerText;if(!R?.display)return;const V=M.data.datasets[0].data.reduce((se,re)=>se+re,0),L=R.color,X=R.font.size*1.5,ne=R.font.size*.8,ce=45;I.save(),I.textAlign="center",I.textBaseline="middle",I.fillStyle=L;const Le=F/2,fe=z/2;I.font=`${R.font.weight} ${X}px sans-serif`,I.fillText(V,Le,fe-ne/1.5+ce),I.font=`400 ${ne}px sans-serif`,I.fillText("Total Students",Le,fe+X/1.8+ce),I.restore()}}]})}function g(){i&&c&&m(c)}Wa(()=>{p();const k=setInterval(()=>{p()},300*1e3),A=new MutationObserver(E=>{E.forEach(M=>{M.type==="attributes"&&M.attributeName==="data-theme"&&g()})});return A.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{clearInterval(k),A.disconnect()}}),Hr(()=>{i&&i.destroy()}),vs();var y=Wb(),b=o(y);{var D=k=>{var A=Vb();h(k,A)},S=k=>{var A=Et(),E=ut(A);{var M=F=>{var z=Bb(),R=v(o(z),2),J=o(R,!0);n(R);var V=v(R,2);n(z),$(()=>w(J,e(l))),Q("click",V,p),h(F,z)},I=F=>{var z=Gb(),R=ut(z);Pi(R,V=>d(a,V),()=>e(a));var J=v(R,2);Tt(J,5,()=>u,Ka,(V,L,X)=>{var ne=zb(),ce=o(ne),Le=v(ce,2),fe=o(Le);n(Le),n(ne),$(()=>{as(ce,`background-color: ${f[X]??""};`),w(fe,`Grade ${e(L)??""}`)}),h(V,ne)}),n(J),h(F,z)};C(E,F=>{e(l)?F(M):F(I,!1)},!0)}h(k,A)};C(b,k=>{e(r)?k(D):k(S,!1)})}n(y),h(s,y),Ga()}var Yb=_('<div class="chart-loading svelte-8jize4"><div class="chart-loader svelte-8jize4"></div> <p class="svelte-8jize4">Loading chart data...</p></div>'),Ub=_('<div class="chart-error svelte-8jize4"><span class="material-symbols-outlined svelte-8jize4">error</span> <p class="svelte-8jize4"> </p> <button class="retry-button svelte-8jize4"><span class="material-symbols-outlined svelte-8jize4">refresh</span> Retry</button></div>'),Qb=_('<canvas class="svelte-8jize4"></canvas>'),Jb=_('<div class="chart-container svelte-8jize4"><!></div>');function Kb(s,t){za(t,!1),Mn.register(Yg,gb,Lb,Ib,Oc,$c,Ic);let a=P(),i,r=P(!0),l=P(null),c=null;const u=["7","8","9","10"];async function f(){try{d(r,!0),d(l,null);const S=await da.get("/api/dashboard/sections-per-grade");if(S.success)c=S.data,d(r,!1),setTimeout(()=>{e(a)&&p(S.data)},0);else throw new Error(S.error||"Failed to fetch sections data")}catch(S){console.error("Error fetching sections data:",S),d(l,S.message),d(r,!1)}}function p(S){if(!e(a)){console.warn("Canvas not yet available");return}i&&i.destroy();const k=u.map(E=>{const M=S.find(I=>I.grade_level===E);return M?M.section_count:0}),A=e(a).getContext("2d");i=new Mn(A,{type:"bar",data:{labels:u.map(E=>`Grade ${E}`),datasets:[{label:"Number of Sections",data:k,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgb(54, 162, 235)",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,suggestedMax:Math.max(...k)+2,ticks:{stepSize:1,callback(E){return Math.floor(E)},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-outline-variant").trim()},title:{display:!0,text:"Number of Sections",color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),font:{size:12,weight:"bold"}}},x:{ticks:{color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface-variant").trim()},grid:{display:!1}}},plugins:{legend:{display:!1},title:{display:!0,text:"Sections per Grade Level",font:{size:16,weight:"bold"},color:getComputedStyle(document.documentElement).getPropertyValue("--md-sys-color-on-surface").trim(),padding:{top:10,bottom:20}},tooltip:{callbacks:{label(E){return`Sections: ${E.parsed.y||0}`}}}}}})}function m(){i&&c&&p(c)}Wa(()=>{f();const S=setInterval(()=>{f()},6e4),k=new MutationObserver(A=>{A.forEach(E=>{E.type==="attributes"&&E.attributeName==="data-theme"&&m()})});return k.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{clearInterval(S),k.disconnect()}}),Hr(()=>{i&&i.destroy()}),vs();var g=Jb(),y=o(g);{var b=S=>{var k=Yb();h(S,k)},D=S=>{var k=Et(),A=ut(k);{var E=I=>{var F=Ub(),z=v(o(F),2),R=o(z,!0);n(z);var J=v(z,2);n(F),$(()=>w(R,e(l))),Q("click",J,f),h(I,F)},M=I=>{var F=Qb();Pi(F,z=>d(a,z),()=>e(a)),h(I,F)};C(A,I=>{e(l)?I(E):I(M,!1)},!0)}h(S,k)};C(y,S=>{e(r)?S(b):S(D,!1)})}n(g),h(s,g),Ga()}var Xb=_('<div class="stats-error"><span class="material-symbols-outlined">error</span> <p> </p> <button class="retry-button"><span class="material-symbols-outlined">refresh</span> Retry</button></div>'),Zb=_('<div><div class="stat-card-header"><p class="stat-label"> </p> <div class="dashboard-stat-icon"><span class="material-symbols-outlined"> </span></div></div> <div class="stat-card-content"><h3 class="stat-card-value"><!></h3></div></div>'),ey=_('<div class="stats-grid"></div>'),ty=_('<div class="activities-loading"><div class="system-loader"></div> <p>Loading recent activities...</p></div>'),ay=_('<div class="activities-error"><span class="material-symbols-outlined error-icon">error</span> <p> </p></div>'),sy=_('<div class="activities-empty"><span class="material-symbols-outlined">inbox</span> <p>No recent activities found</p></div>'),iy=_('<p class="activity-user"> </p>'),ny=_('<div class="activity-item"><div class="activity-icon"><span class="material-symbols-outlined"> </span></div> <div class="activity-content"><p class="activity-message"> </p> <!></div> <span class="activity-timestamp"> </span></div>'),ry=_('<div class="dashboard-container"><div class="dashboard-header"><div class="header-content"><h1 class="page-title">Admin Dashboard</h1> <p class="page-subtitle">Overview of school management system statistics</p></div></div> <div class="stats-section"><!></div> <div class="graph-row"><div class="accounts-stats-container"><!></div> <div class="average-grades-stats-container"><!></div></div> <div class="activities-section"><div class="section-header"><h2 class="section-title">Activity Logs</h2> <button class="refresh-button" title="Refresh activity logs"><span class="material-symbols-outlined">refresh</span> Refresh</button></div> <div class="activities-list"><!></div></div></div>');function oy(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(zi,"$dashboardStore",a),l=P(),c=P(),u=P();let f=P([]),p=P(!1),m=P(null);const g=["border-blue","border-green","border-orange","border-purple"];function y(se){return g[se%g.length]}async function b(se=!1){try{se||zi.setLoading(!0);const re=await da.get("/api/dashboard");if(re.success){const Se=[{id:"students",label:"Total Students",value:re.data.students.toLocaleString(),icon:"school",color:"primary"},{id:"teachers",label:"Total Teachers",value:re.data.teachers.toLocaleString(),icon:"person",color:"primary"},{id:"sections",label:"Total Sections",value:re.data.sections.toLocaleString(),icon:"class",color:"primary"},{id:"rooms",label:"Total Rooms",value:re.data.rooms.toLocaleString(),icon:"meeting_room",color:"primary"}];zi.updateData(Se)}else throw new Error(re.error||"Failed to fetch dashboard statistics")}catch(re){console.error("Error fetching dashboard statistics:",re),zi.setError(re.message)}}async function D(se=!1){try{se||(d(p,!0),d(m,null));const re=await da.get("/api/activity-logs");if(re.success)d(f,re.activities);else throw new Error(re.error||"Failed to fetch activities")}catch(re){console.error("Error fetching activities:",re),d(m,re.message)}finally{d(p,!1)}}Wa(()=>{const se=zi.getCachedData();se&&zi.init(se),b(!!se),D(!1);const re=setInterval(()=>{b(!0),D(!0)},3e4);return()=>{clearInterval(re)}}),Jt(()=>(e(l),e(c),e(u),r()),()=>{(se=>{d(l,se.data),d(c,se.isLoading),d(u,se.error)})(r())}),Ss(),vs();var S=ry(),k=v(o(S),2),A=o(k);{var E=se=>{var re=Xb(),Se=v(o(re),2),me=o(Se);n(Se);var ze=v(Se,2);n(re),$(()=>w(me,`Error loading statistics: ${e(u)??""}`)),Q("click",ze,()=>b(!1)),h(se,re)},M=se=>{var re=ey();Tt(re,7,()=>e(l),Se=>Se.id,(Se,me,ze)=>{var Xe=Zb(),tt=o(Xe),ve=o(tt),$e=o(ve,!0);n(ve);var Je=v(ve,2),Re=o(Je),Ze=o(Re,!0);n(Re),n(Je),n(tt);var st=v(tt,2),We=o(st),nt=o(We);{var ke=Ie=>{var Ee=ka("Loading...");h(Ie,Ee)},De=Ie=>{var Ee=ka();$(()=>w(Ee,(e(me),x(()=>e(me).value)))),h(Ie,Ee)};C(nt,Ie=>{e(c)?Ie(ke):Ie(De,!1)})}n(We),n(st),n(Xe),$(Ie=>{oe(Xe,1,`stat-card ${Ie??""}`),w($e,(e(me),x(()=>e(me).label))),w(Ze,(e(me),x(()=>e(me).icon)))},[()=>(xs(e(ze)),x(()=>y(e(ze))))]),h(Se,Xe)}),n(re),h(se,re)};C(A,se=>{e(u)?se(E):se(M,!1)})}n(k);var I=v(k,2),F=o(I),z=o(F);Hb(z,{}),n(F);var R=v(F,2),J=o(R);Kb(J,{}),n(R),n(I);var V=v(I,2),L=o(V),X=v(o(L),2);n(L);var ne=v(L,2),ce=o(ne);{var Le=se=>{var re=ty();h(se,re)},fe=se=>{var re=Et(),Se=ut(re);{var me=Xe=>{var tt=ay(),ve=v(o(tt),2),$e=o(ve);n(ve),n(tt),$(()=>w($e,`Error loading activities: ${e(m)??""}`)),h(Xe,tt)},ze=Xe=>{var tt=Et(),ve=ut(tt);{var $e=Re=>{var Ze=sy();h(Re,Ze)},Je=Re=>{var Ze=Et(),st=ut(Ze);Tt(st,1,()=>e(f),We=>We.id,(We,nt)=>{var ke=ny(),De=o(ke),Ie=o(De),Ee=o(Ie,!0);n(Ie),n(De);var ee=v(De,2),Ue=o(ee),rt=o(Ue,!0);n(Ue);var Ye=v(Ue,2);{var at=T=>{var U=iy(),de=o(U,!0);n(U),$(()=>w(de,(e(nt),x(()=>e(nt).performed_by)))),h(T,U)};C(Ye,T=>{e(nt),x(()=>e(nt).performed_by&&e(nt).performed_by!=="System")&&T(at)})}n(ee);var lt=v(ee,2),O=o(lt,!0);n(lt),n(ke),$(()=>{w(Ee,(e(nt),x(()=>e(nt).icon))),w(rt,(e(nt),x(()=>e(nt).message))),w(O,(e(nt),x(()=>e(nt).timestamp)))}),h(We,ke)}),h(Re,Ze)};C(ve,Re=>{e(f),x(()=>e(f).length===0)?Re($e):Re(Je,!1)},!0)}h(Xe,tt)};C(Se,Xe=>{e(m)?Xe(me):Xe(ze,!1)},!0)}h(se,re)};C(ce,se=>{e(p)?se(Le):se(fe,!1)})}n(ne),n(V),n(S),$(()=>X.disabled=e(p)),Q("click",X,()=>D(!1)),h(s,S),Ga(),i()}var ly=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),cy=_('<span class="placeholder">Select account type</span>'),dy=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),uy=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),vy=_('<span class="placeholder">Select gender</span>'),fy=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),py=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),hy=_('<span class="placeholder">Select grade level</span>'),my=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),gy=_('<div class="form-group"><label class="form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div>'),_y=_('<span class="email-status checking"><span class="material-symbols-outlined spinning">progress_activity</span></span>'),by=_('<span class="email-status valid"><span class="material-symbols-outlined">check_circle</span></span>'),yy=_('<span class="email-status error"><span class="material-symbols-outlined">error</span></span>'),wy=_('<p class="form-error"> </p>'),xy=_('<p class="form-success">Email is available</p>'),Sy=_('<div class="form-group"><label class="form-label" for="email">Email Address *</label> <div class="email-input-wrapper"><input type="email" id="email" placeholder="Enter email address" required/> <!></div> <!></div>'),ky=_(`<div class="additional-info-section"><h3 class="section-subtitle">Additional Information</h3> <p class="section-description">Required information for student accounts</p> <div class="form-row"><div class="form-group"><label class="form-label" for="birthdate">Birthdate *</label> <input type="date" id="birthdate" class="form-input" required/></div> <div class="form-group"><label class="form-label" for="age">Age</label> <input type="number" id="age" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label" for="address">Address *</label> <textarea id="address" class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label" for="guardian">Guardian/Parent Name *</label> <input type="text" id="guardian" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label" for="contact-number">Guardian's Contact Number *</label> <input type="tel" id="contact-number" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`),Dy=_('<span class="auto-label">Loading preview...</span>'),Ay=_('<span class="auto-number"> </span> <span class="auto-label">(Preview - will use lowest available)</span>',1),Cy=_('<span class="auto-label">Will be auto-assigned (lowest available number)</span>'),Ty=_('<span class="placeholder-number">Select account type first</span>'),My=_('<span class="material-symbols-outlined">person_add</span> Create Account',1),Py=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Ey=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),Fy=_('<span class="placeholder">Filter by type</span>'),Ny=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),Ly=_('<div class="loading-container"><span class="account-loader"></span> <p class="loading-text">Loading accounts...</p></div>'),$y=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),jy=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),Iy=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),Ry=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),Oy=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),qy=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),Vy=_('<span class="placeholder">Select grade level</span>'),By=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),zy=_(`<div class="form-group"><label class="form-label">Grade Level</label> <div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="additional-info-section"><h4 class="section-subtitle">Additional Information</h4> <p class="section-description">Update student additional information</p> <div class="form-row"><div class="form-group"><label class="form-label">Birthdate *</label> <input type="date" class="form-input" required/></div> <div class="form-group"><label class="form-label">Age</label> <input type="number" class="form-input age-display" readonly="" placeholder="Auto-calculated"/></div></div> <div class="form-group"><label class="form-label">Address *</label> <textarea class="form-input form-textarea" placeholder="Enter complete address" rows="3" required></textarea></div> <div class="form-row"><div class="form-group"><label class="form-label">Guardian/Parent Name *</label> <input type="text" class="form-input" placeholder="Enter guardian/parent name" required/></div> <div class="form-group"><label class="form-label">Guardian's Contact Number *</label> <input type="tel" class="form-input" placeholder="09xxxxxxxxxx" maxlength="11" required/></div></div></div>`,1),Gy=_('<div class="edit-form-section"><div class="edit-form-container"><div class="edit-form-header"><h4 class="edit-form-title">Edit Account Information</h4> <p class="edit-form-subtitle">Update the name information for this account</p></div> <form class="edit-form-content"><div class="edit-name-fields-row"><div class="form-group"><label class="form-label">Last Name *</label> <input type="text" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label">First Name *</label> <input type="text" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label">M.I.</label> <input type="text" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <div class="edit-form-actions"><a><button type="button" class="account-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),Wy=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"> </h3></div> <div class="account-action-buttons"><a><button type="button" class="account-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="account-remove-button" title="Remove Account"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="account-details"><div class="account-detail-item"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <!> <!> <!> <!> <!> <div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="account-detail-item"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),Hy=_("<p>No accounts created yet.</p>"),Yy=_("<p>No accounts found matching your search or filter.</p>"),Uy=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon">group_off</span> <!></div>'),Qy=_(`<div class="account-creation-container"><div class="account-header"><div class="header-content"><h1 class="page-title">Account Creation</h1> <p class="page-subtitle">Create new student, teacher, and admin accounts for the system</p></div></div> <div class="creation-form-section"><div class="account-section-header"><h2 class="section-title">Create New Account</h2> <p class="section-subtitle">Fill in the details below to create a new account</p></div> <div class="form-container"><form><div class="account-type-gender-row"><div class="form-group"><label class="form-label" for="account-type">Account Type *</label> <div><button type="button" id="account-type"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="form-group"><label class="form-label" for="gender">Gender *</label> <div><button type="button" id="gender"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div> <div class="name-fields-row"><div class="form-group"><label class="form-label" for="last-name">Last Name *</label> <input type="text" id="last-name" class="form-input" placeholder="Enter last name" required/></div> <div class="form-group"><label class="form-label" for="first-name">First Name *</label> <input type="text" id="first-name" class="form-input" placeholder="Enter first name" required/></div> <div class="form-group"><label class="form-label" for="middle-initial">M.I.</label> <input type="text" id="middle-initial" class="form-input" placeholder="M" maxlength="1"/></div></div> <!> <!> <div class="form-group"><div class="form-label"> </div> <div class="number-display"><!></div> <p class="form-help">Account number will be automatically assigned using the lowest available number.
						Password will be set to the same as the account number.</p></div> <div class="form-actions"><button type="submit"><!></button></div></form></div></div> <div class="recent-accounts-section"><div class="account-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="section-title">All Account Creations</h2> <p class="section-subtitle">All accounts in the system</p></div> <div class="search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search accounts by name or number..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div></div></div> <div class="accounts-grid"><!></div></div></div>`);function Jy(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ms,"$authStore",a),l=P(),c=P(),u=P(),f=P(),p=P(),m=P(),g=P();let y=P(!1),b=P(""),D=P(""),S=P(""),k=P(""),A=P(""),E=P(""),M=P(""),I=P(""),F=P(!1),z=null;const R=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;let J=P(""),V=P(""),L=P(""),X=P(""),ne=P(0),ce=P(!1),Le=P(!1),fe=P(!1),se=P(!1),re=P("all"),Se=P(null),me=P(""),ze=P(""),Xe=P(""),tt=P(""),ve=P(!1),$e=P(!1),Je=P(""),Re=P(""),Ze=P(""),st=P(""),We=P(0);function nt(){const W=new Date;return W.setDate(W.getDate()-1),W.toISOString().split("T")[0]}function ke(W){return W&&W.split(" ").map(_e=>_e.charAt(0).toUpperCase()+_e.slice(1).toLowerCase()).join(" ")}function De(W,_e,dt=!1){const Nt=W.target.value,we=_e==="middleInitial"?Nt.toUpperCase():ke(Nt);dt?_e==="firstName"?d(me,we):_e==="lastName"?d(ze,we):_e==="middleInitial"&&d(Xe,we):_e==="firstName"?d(k,we):_e==="lastName"?d(A,we):_e==="middleInitial"&&d(E,we),W.target.value=we}function Ie(W){if(!W)return!1;const _e=W.replace(/\D/g,"");return _e.startsWith("09")&&_e.length===11}function Ee(W){return W.replace(/\D/g,"").slice(0,11)}function ee(W,_e=!1){const dt=Ee(W.target.value);_e?d(st,dt):d(X,dt),W.target.value=dt}async function Ue(W){if(d(I,""),!(!W||W.trim()==="")){if(!R.test(W)){d(I,"Invalid email format");return}d(F,!0);try{const _e=await da.get(`/api/accounts/check-email?email=${encodeURIComponent(W)}`);_e.valid?_e.exists?d(I,"This email is already registered"):d(I,""):d(I,_e.error||"Invalid email format")}catch(_e){console.error("Error checking email:",_e)}finally{d(F,!1)}}}function rt(W){const _e=W.target.value.trim().toLowerCase();d(M,_e),z&&clearTimeout(z),_e?z=setTimeout(()=>{Ue(_e)},500):d(I,"")}function Ye(W){if(!W||W.length<10)return!0;const _e=new Date(W),dt=_e.getFullYear(),Nt=new Date,we=Nt.getFullYear();if(isNaN(_e.getTime())||dt<1900||dt>we)return!1;const it=new Date(Nt.getFullYear(),Nt.getMonth(),Nt.getDate());return!(new Date(_e.getFullYear(),_e.getMonth(),_e.getDate())>=it)}let at=P("");const lt=[{id:"student",name:"Student Account",description:"Create a new student account",icon:"school"},{id:"teacher",name:"Teacher Account",description:"Create a new teacher account",icon:"person"},{id:"admin",name:"Admin Account",description:"Create a new admin account",icon:"admin_panel_settings"}],O=[{id:"all",name:"All Accounts",icon:"group"},{id:"student",name:"Students",icon:"school"},{id:"teacher",name:"Teachers",icon:"person"},{id:"admin",name:"Admins",icon:"admin_panel_settings"}],T=[{id:"male",name:"Male",icon:"male"},{id:"female",name:"Female",icon:"female"}],U=[{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let de=P([]),Pe=P(!1);function Ve(W){W.target.closest(".custom-dropdown")||(d(ce,!1),d(Le,!1),d(fe,!1),d(ve,!1),d(se,!1))}async function Me(W){const _e=r().userData;if(_e&&_e.accountNumber===W.number){Ae.error("You cannot delete your own account while logged in.");return}ds.confirm("Remove Account",`<p>Are you sure you want to remove the account for <strong>"${W.name}"</strong>?</p>`,async()=>{try{const dt=await da.delete("/api/accounts",{id:W.id});if(!dt.success)throw new Error(dt.message||"Failed to delete account");d(de,e(de).filter(Nt=>Nt.id!==W.id)),Ae.success(`Account for "${W.name}" has been removed successfully`)}catch(dt){console.error("Error deleting account:",dt),Ae.error(`Failed to delete account: ${dt.message}`)}},()=>{},{size:"small"})}function q(W){if(e(Se)===W.id)d(Se,null),d(me,""),d(ze,""),d(Xe,""),d(tt,""),d(Je,""),d(Re,""),d(Ze,""),d(st,""),d(We,0),d(ve,!1);else if(d(Se,W.id),W.firstName&&W.lastName){if(d(me,W.firstName),d(ze,W.lastName),d(Xe,W.middleInitial||""),d(tt,W.gradeLevel||""),W.birthdate){const _e=new Date(W.birthdate),dt=_e.getFullYear(),Nt=String(_e.getMonth()+1).padStart(2,"0"),we=String(_e.getDate()).padStart(2,"0");d(Je,`${dt}-${Nt}-${we}`)}else d(Je,"");d(Re,W.address||""),d(Ze,W.guardian||""),d(st,W.contactNumber||"")}else{const _e=W.name.split(", ");if(_e.length>=2){d(ze,_e[0]);const Nt=_e[1].split(" ");d(me,Nt[0]),Nt.length>1&&Nt[1].endsWith(".")?d(Xe,Nt[1].replace(".","")):d(Xe,"")}if(d(tt,W.gradeLevel||""),W.birthdate){const dt=new Date(W.birthdate),Nt=dt.getFullYear(),we=String(dt.getMonth()+1).padStart(2,"0"),it=String(dt.getDate()).padStart(2,"0");d(Je,`${Nt}-${we}-${it}`)}else d(Je,"");d(Re,W.address||""),d(Ze,W.guardian||""),d(st,W.contactNumber||"")}}async function B(){if(!e(me)||!e(ze)){Ae.error("Please fill in all required fields.");return}if(e(l)&&e(l).type.toLowerCase()==="student"){if(!e(Je)||!e(Re)||!e(Ze)||!e(st)){Ae.error("Please fill in all required student information fields.");return}if(!Ie(e(st))){Ae.error("Invalid contact number.");return}}d($e,!0);try{const W={id:e(Se),firstName:e(me).trim(),lastName:e(ze).trim(),middleInitial:e(Xe)?e(Xe).trim():null};e(l)&&e(l).type.toLowerCase()==="student"&&(W.gradeLevel=e(tt)||null,W.birthdate=e(Je)||null,W.address=e(Re)?e(Re).trim():null,W.guardian=e(Ze)?e(Ze).trim():null,W.contactNumber=e(st)?e(st).trim():null);const _e=await da.put("/api/accounts",W);_e.success?(d(de,e(de).map(dt=>dt.id===e(Se)?_e.account:dt)),Ae.success(_e.message),d(Se,null),d(me,""),d(ze,""),d(Xe,""),d(tt,""),d(Je,""),d(Re,""),d(Ze,""),d(st,""),d(We,0)):Ae.error(_e.error||"Failed to update account")}catch(W){console.error("Error updating account:",W),Ae.error("Failed to update account. Please try again.")}finally{d($e,!1)}}function N(){d(ce,!e(ce))}function Z(W){d(b,W.id),d(ce,!1),W.id!=="student"&&d(S,"")}function be(){d(Le,!e(Le))}function Fe(W){d(D,W.id),d(Le,!1)}function he(){d(fe,!e(fe))}function te(W){d(S,W.id),d(fe,!1)}function j(){d(ve,!e(ve))}function K(W){d(tt,W.id),d(ve,!1)}function ae(){d(se,!e(se))}function Oe(W){d(re,W.id),d(se,!1)}async function Be(){if(!e(b)||!e(D)||!e(k)||!e(A)){Ae.error("Please fill in all required fields.");return}if((e(b)==="student"||e(b)==="teacher")&&!e(M)){Ae.error("Please enter an email address.");return}if(e(I)){Ae.error(e(I));return}if(e(F)){Ae.error("Please wait while we verify the email address.");return}if(e(b)==="student"&&!e(S)){Ae.error("Please select a grade level for the student account.");return}if(e(b)==="student"){if(!e(J)||!e(V)||!e(L)||!e(X)){Ae.error("Please fill in all additional information fields for the student account.");return}if(!Ie(e(X))){Ae.error("Invalid contact number.");return}}const W=e(b)==="student"?"Student":e(b)==="teacher"?"Teacher":"Admin",_e=`${e(k)} ${e(E)?e(E)+". ":""}${e(A)}`;ds.confirm("Confirm Account Creation",`<p>Are you sure you want to create a <strong>${W}</strong> account for <strong>"${_e}"</strong>?</p>`,async()=>{await Ke()},()=>{},{size:"small"})}async function Ke(){d(y,!0);try{const W=r().userData,_e=await da.post("/api/accounts",{accountType:e(b),gender:e(D),gradeLevel:e(S),firstName:e(k),lastName:e(A),middleInitial:e(E),email:e(M),birthdate:e(b)==="student"?e(J):null,address:e(b)==="student"?e(V):null,guardian:e(b)==="student"?e(L):null,contactNumber:e(b)==="student"?e(X):null,createdBy:W?W.id:null});if(!_e.success)throw new Error(_e.message||"Failed to create account");d(de,[_e.account,...e(de)]);const dt=e(b)==="student"?"Student":e(b)==="teacher"?"Teacher":"Admin";Ae.success(`${dt} account created successfully for ${_e.account.name}! Password is the same as account number: ${_e.account.number}`),d(b,""),d(D,""),d(S,""),d(k,""),d(A,""),d(E,""),d(M,""),d(I,""),d(J,""),d(V,""),d(L,""),d(X,""),d(ne,0)}catch(W){console.error("Error creating account:",W),Ae.error(W.message||"Failed to create account. Please try again.")}finally{d(y,!1)}}let Ge=P(""),ot=P(!1);async function gt(W){if(!W){d(Ge,"");return}d(ot,!0);try{const _e=await da.get(`/api/accounts/next-number?type=${W}`);d(Ge,_e.accountNumber)}catch(_e){console.error("Error fetching next account number:",_e),d(Ge,"Error loading preview")}finally{d(ot,!1)}}async function Yt(){d(Pe,!0);try{const W=await da.get("/api/accounts");if(!W.success)throw new Error("Failed to load accounts");d(de,W.accounts)}catch(W){console.error("Error loading accounts:",W),Ae.error("Failed to load existing accounts")}finally{d(Pe,!1)}}Wa(()=>{Yt()}),Jt(()=>(e(Se),e(de)),()=>{d(l,e(Se)?e(de).find(W=>W.id===e(Se)):null)}),Jt(()=>e(b),()=>{d(c,lt.find(W=>W.id===e(b)))}),Jt(()=>e(D),()=>{d(u,T.find(W=>W.id===e(D)))}),Jt(()=>e(S),()=>{d(f,U.find(W=>W.id===e(S)))}),Jt(()=>e(re),()=>{d(p,O.find(W=>W.id===e(re)))}),Jt(()=>e(tt),()=>{d(m,U.find(W=>W.id===e(tt)))}),Jt(()=>e(J),()=>{if(e(J)){const W=new Date(e(J)),_e=new Date;let dt=_e.getFullYear()-W.getFullYear();const Nt=_e.getMonth()-W.getMonth();(Nt<0||Nt===0&&_e.getDate()<W.getDate())&&dt--,d(ne,dt>=0?dt:0)}else d(ne,0)}),Jt(()=>e(Je),()=>{if(e(Je)){const W=new Date(e(Je)),_e=new Date;let dt=_e.getFullYear()-W.getFullYear();const Nt=_e.getMonth()-W.getMonth();(Nt<0||Nt===0&&_e.getDate()<W.getDate())&&dt--,d(We,dt>=0?dt:0)}else d(We,0)}),Jt(()=>(e(de),e(re),e(at)),()=>{d(g,e(de).filter(W=>{const _e=W.type.toLowerCase(),dt=e(re)==="all"||_e===e(re);if(!e(at).trim())return dt;const Nt=e(at).toLowerCase().trim(),we=W.name.toLowerCase().includes(Nt),it=W.number.toString().includes(Nt);return dt&&(we||it)}))}),Jt(()=>e(b),()=>{e(b)&&gt(e(b))}),Ss(),vs();var ge=Qy();Q("click",Ys,Ve);var Qe=v(o(ge),2),Y=v(o(Qe),2),le=o(Y),Ce=o(le),et=o(Ce),ft=v(o(et),2);let Dt;var vt=o(ft);let Qt;var He=o(vt);{var je=W=>{var _e=ly(),dt=o(_e),Nt=o(dt,!0);n(dt);var we=v(dt,2),it=o(we),Mt=o(it,!0);n(it);var At=v(it,2),_t=o(At,!0);n(At),n(we),n(_e),$(()=>{w(Nt,(e(c),x(()=>e(c).icon))),w(Mt,(e(c),x(()=>e(c).name))),w(_t,(e(c),x(()=>e(c).description)))}),h(W,_e)},jt=W=>{var _e=cy();h(W,_e)};C(He,W=>{e(c)?W(je):W(jt,!1)})}ia(2),n(vt);var aa=v(vt,2);Tt(aa,5,()=>lt,W=>W.id,(W,_e)=>{var dt=dy();let Nt;var we=o(dt),it=o(we,!0);n(we);var Mt=v(we,2),At=o(Mt),_t=o(At,!0);n(At);var Vt=v(At,2),Wt=o(Vt,!0);n(Vt),n(Mt),n(dt),$(Ft=>{Nt=oe(dt,1,"dropdown-option",null,Nt,Ft),w(it,(e(_e),x(()=>e(_e).icon))),w(_t,(e(_e),x(()=>e(_e).name))),w(Wt,(e(_e),x(()=>e(_e).description)))},[()=>({selected:e(b)===e(_e).id})]),Q("click",dt,()=>Z(e(_e))),h(W,dt)}),n(aa),n(ft),n(et);var St=v(et,2),xt=v(o(St),2);let Pt;var ye=o(xt);let H;var qe=o(ye);{var Ct=W=>{var _e=uy(),dt=o(_e),Nt=o(dt,!0);n(dt);var we=v(dt,2),it=o(we),Mt=o(it,!0);n(it),n(we),n(_e),$(()=>{w(Nt,(e(u),x(()=>e(u).icon))),w(Mt,(e(u),x(()=>e(u).name)))}),h(W,_e)},zt=W=>{var _e=vy();h(W,_e)};C(qe,W=>{e(u)?W(Ct):W(zt,!1)})}ia(2),n(ye);var ua=v(ye,2);Tt(ua,5,()=>T,W=>W.id,(W,_e)=>{var dt=fy();let Nt;var we=o(dt),it=o(we,!0);n(we);var Mt=v(we,2),At=o(Mt),_t=o(At,!0);n(At),n(Mt),n(dt),$(Vt=>{Nt=oe(dt,1,"dropdown-option",null,Nt,Vt),w(it,(e(_e),x(()=>e(_e).icon))),w(_t,(e(_e),x(()=>e(_e).name)))},[()=>({selected:e(D)===e(_e).id})]),Q("click",dt,()=>Fe(e(_e))),h(W,dt)}),n(ua),n(xt),n(St);var xe=v(St,2);{var Te=W=>{var _e=gy(),dt=v(o(_e),2);let Nt;var we=o(dt);let it;var Mt=o(we);{var At=Wt=>{var Ft=py(),oa=o(Ft),Ca=o(oa,!0);n(oa);var Ta=v(oa,2),Ha=o(Ta),ma=o(Ha,!0);n(Ha),n(Ta),n(Ft),$(()=>{w(Ca,(e(f),x(()=>e(f).icon))),w(ma,(e(f),x(()=>e(f).name)))}),h(Wt,Ft)},_t=Wt=>{var Ft=hy();h(Wt,Ft)};C(Mt,Wt=>{e(f)?Wt(At):Wt(_t,!1)})}ia(2),n(we);var Vt=v(we,2);Tt(Vt,5,()=>U,Wt=>Wt.id,(Wt,Ft)=>{var oa=my();let Ca;var Ta=o(oa),Ha=o(Ta,!0);n(Ta);var ma=v(Ta,2),Fa=o(ma),Ht=o(Fa,!0);n(Fa),n(ma),n(oa),$(na=>{Ca=oe(oa,1,"dropdown-option",null,Ca,na),w(Ha,(e(Ft),x(()=>e(Ft).icon))),w(Ht,(e(Ft),x(()=>e(Ft).name)))},[()=>({selected:e(S)===e(Ft).id})]),Q("click",oa,()=>te(e(Ft))),h(Wt,oa)}),n(Vt),n(dt),n(_e),$((Wt,Ft)=>{Nt=oe(dt,1,"custom-dropdown",null,Nt,Wt),it=oe(we,1,"dropdown-trigger",null,it,Ft)},[()=>({open:e(fe)}),()=>({selected:e(S)})]),Q("click",we,he),h(W,_e)};C(xe,W=>{e(b)==="student"&&W(Te)})}n(Ce);var ue=v(Ce,2),bt=o(ue),ht=v(o(bt),2);sa(ht),n(bt);var G=v(bt,2),pe=v(o(G),2);sa(pe),n(G);var pt=v(G,2),Rt=v(o(pt),2);sa(Rt),n(pt),n(ue);var ct=v(ue,2);{var Xt=W=>{var _e=Sy(),dt=v(o(_e),2),Nt=o(dt);sa(Nt);let we;var it=v(Nt,2);{var Mt=Ft=>{var oa=_y();h(Ft,oa)},At=Ft=>{var oa=Et(),Ca=ut(oa);{var Ta=ma=>{var Fa=by();h(ma,Fa)},Ha=ma=>{var Fa=Et(),Ht=ut(Fa);{var na=pa=>{var Na=yy();h(pa,Na)};C(Ht,pa=>{e(I)&&pa(na)},!0)}h(ma,Fa)};C(Ca,ma=>{e(M)&&!e(I)?ma(Ta):ma(Ha,!1)},!0)}h(Ft,oa)};C(it,Ft=>{e(F)?Ft(Mt):Ft(At,!1)})}n(dt);var _t=v(dt,2);{var Vt=Ft=>{var oa=wy(),Ca=o(oa,!0);n(oa),$(()=>w(Ca,e(I))),h(Ft,oa)},Wt=Ft=>{var oa=Et(),Ca=ut(oa);{var Ta=Ha=>{var ma=xy();h(Ha,ma)};C(Ca,Ha=>{e(M)&&!e(F)&&Ha(Ta)},!0)}h(Ft,oa)};C(_t,Ft=>{e(I)?Ft(Vt):Ft(Wt,!1)})}n(_e),$(Ft=>we=oe(Nt,1,"form-input",null,we,Ft),[()=>({error:e(I),valid:e(M)&&!e(I)&&!e(F)})]),la(Nt,()=>e(M),Ft=>d(M,Ft)),Q("input",Nt,rt),h(W,_e)};C(ct,W=>{(e(b)==="student"||e(b)==="teacher")&&W(Xt)})}var ga=v(ct,2);{var ba=W=>{var _e=ky(),dt=v(o(_e),4),Nt=o(dt),we=v(o(Nt),2);sa(we),n(Nt);var it=v(Nt,2),Mt=v(o(it),2);sa(Mt),n(it),n(dt);var At=v(dt,2),_t=v(o(At),2);Sn(_t),n(At);var Vt=v(At,2),Wt=o(Vt),Ft=v(o(Wt),2);sa(Ft),n(Wt);var oa=v(Wt,2),Ca=v(o(oa),2);sa(Ca),n(oa),n(Vt),n(_e),$(Ta=>{$t(we,"max",Ta),Ui(Mt,e(ne))},[()=>x(nt)]),la(we,()=>e(J),Ta=>d(J,Ta)),Q("blur",we,Ta=>{e(J)&&!Ye(e(J))&&(Ae.error("Invalid date. Please enter a valid date."),d(J,""),Ta.target.value="")}),la(_t,()=>e(V),Ta=>d(V,Ta)),la(Ft,()=>e(L),Ta=>d(L,Ta)),la(Ca,()=>e(X),Ta=>d(X,Ta)),Q("input",Ca,Ta=>ee(Ta,!1)),h(W,_e)};C(ga,W=>{e(b)==="student"&&W(ba)})}var _a=v(ga,2),ya=o(_a),ta=o(ya,!0);n(ya);var yt=v(ya,2),Gt=o(yt);{var Lt=W=>{var _e=Et(),dt=ut(_e);{var Nt=it=>{var Mt=Dy();h(it,Mt)},we=it=>{var Mt=Et(),At=ut(Mt);{var _t=Wt=>{var Ft=Ay(),oa=ut(Ft),Ca=o(oa,!0);n(oa),ia(2),$(()=>w(Ca,e(Ge))),h(Wt,Ft)},Vt=Wt=>{var Ft=Cy();h(Wt,Ft)};C(At,Wt=>{e(Ge)?Wt(_t):Wt(Vt,!1)},!0)}h(it,Mt)};C(dt,it=>{e(ot)?it(Nt):it(we,!1)})}h(W,_e)},Aa=W=>{var _e=Ty();h(W,_e)};C(Gt,W=>{e(b)?W(Lt):W(Aa,!1)})}n(yt),ia(2),n(_a);var Kt=v(_a,2),ca=o(Kt);let ra;var Sa=o(ca);{var va=W=>{var _e=ka("Creating Account...");h(W,_e)},ha=W=>{var _e=My();ia(),h(W,_e)};C(Sa,W=>{e(y)?W(va):W(ha,!1)})}n(ca),n(Kt),n(le),n(Y),n(Qe);var Ot=v(Qe,2),Pa=o(Ot),Oa=o(Pa),Ba=v(o(Oa),2),ie=o(Ba),Ne=o(ie),mt=v(o(Ne),2);sa(mt);var qt=v(mt,2);{var Ut=W=>{var _e=Py();Q("click",_e,()=>d(at,"")),h(W,_e)};C(qt,W=>{e(at)&&W(Ut)})}n(Ne),n(ie);var Bt=v(ie,2),wt=o(Bt);let fa;var It=o(wt);let Zt;var ea=o(It);{var Ma=W=>{var _e=Ey(),dt=o(_e),Nt=o(dt,!0);n(dt);var we=v(dt,2),it=o(we),Mt=o(it,!0);n(it),n(we),n(_e),$(()=>{w(Nt,(e(p),x(()=>e(p).icon))),w(Mt,(e(p),x(()=>e(p).name)))}),h(W,_e)},Ea=W=>{var _e=Fy();h(W,_e)};C(ea,W=>{e(p)?W(Ma):W(Ea,!1)})}ia(2),n(It);var wa=v(It,2);Tt(wa,5,()=>O,W=>W.id,(W,_e)=>{var dt=Ny();let Nt;var we=o(dt),it=o(we,!0);n(we);var Mt=v(we,2),At=o(Mt),_t=o(At,!0);n(At),n(Mt),n(dt),$(Vt=>{Nt=oe(dt,1,"dropdown-option",null,Nt,Vt),w(it,(e(_e),x(()=>e(_e).icon))),w(_t,(e(_e),x(()=>e(_e).name)))},[()=>({selected:e(re)===e(_e).id})]),Q("click",dt,()=>Oe(e(_e))),h(W,dt)}),n(wa),n(wt),n(Bt),n(Ba),n(Oa),n(Pa);var Da=v(Pa,2),xa=o(Da);{var ja=W=>{var _e=Ly();h(W,_e)},Qa=W=>{var _e=Et(),dt=ut(_e);Tt(dt,1,()=>e(g),Nt=>Nt.id,(Nt,we)=>{var it=Wy(),Mt=o(it),At=o(Mt),_t=o(At),Vt=o(_t);n(_t),n(At);var Wt=v(At,2),Ft=o(Wt),oa=o(Ft),Ca=o(oa),Ta=o(Ca,!0);n(Ca),n(oa),n(Ft);var Ha=v(Ft,2);n(Wt),n(Mt);var ma=v(Mt,2),Fa=o(ma),Ht=o(Fa),na=o(Ht,!0);n(Ht);var pa=v(Ht,2),Na=o(pa,!0);n(pa),n(Fa);var qa=v(Fa,2),Ia=v(o(qa),2),Ja=o(Ia);n(Ia),n(qa);var ks=v(qa,2);{var gs=ts=>{var os=$y(),_s=v(o(os),2),Cs=o(_s,!0);n(_s),n(os),$(()=>w(Cs,(e(we),x(()=>e(we).advisorySection||"No advisory section assigned")))),h(ts,os)};C(ks,ts=>{e(we),x(()=>e(we).type==="Teacher")&&ts(gs)})}var rs=v(ks,2);{var es=ts=>{var os=jy(),_s=v(o(os),2),Cs=o(_s);n(_s),n(os),$(()=>w(Cs,`Grade ${e(we),x(()=>e(we).gradeLevel)??""}`)),h(ts,os)};C(rs,ts=>{e(we),x(()=>e(we).type==="Student"&&e(we).gradeLevel)&&ts(es)})}var As=v(rs,2);{var qs=ts=>{var os=Iy(),_s=v(o(os),2),Cs=o(_s);n(_s),n(os),$(()=>w(Cs,`Age: ${e(we),x(()=>e(we).age)??""}`)),h(ts,os)};C(As,ts=>{e(we),x(()=>e(we).type==="Student"&&e(we).age)&&ts(qs)})}var Rs=v(As,2);{var ri=ts=>{var os=Ry(),_s=v(o(os),2),Cs=o(_s);n(_s),n(os),$(()=>w(Cs,`Guardian: ${e(we),x(()=>e(we).guardian)??""}`)),h(ts,os)};C(Rs,ts=>{e(we),x(()=>e(we).type==="Student"&&e(we).guardian)&&ts(ri)})}var Us=v(Rs,2);{var en=ts=>{var os=Oy(),_s=v(o(os),2),Cs=o(_s);n(_s),n(os),$(()=>w(Cs,`Contact: ${e(we),x(()=>e(we).contactNumber)??""}`)),h(ts,os)};C(Us,ts=>{e(we),x(()=>e(we).type==="Student"&&e(we).contactNumber)&&ts(en)})}var Li=v(Us,2),tn=v(o(Li),2),mr=o(tn);n(tn),n(Li);var En=v(Li,2),$i=v(o(En),2),an=o($i);n($i),n(En),n(ma);var gr=v(ma,2);{var sn=ts=>{var os=Gy(),_s=o(os),Cs=v(o(_s),2),ji=o(Cs),nn=o(ji),Fn=o(nn),wi=v(Fn,2);sa(wi),n(nn);var Ii=v(nn,2),Ri=o(Ii),Oi=v(Ri,2);sa(Oi),n(Ii);var Nn=v(Ii,2),Ln=o(Nn),$a=v(Ln,2);sa($a),n(Nn),n(ji);var Va=v(ji,2);{var us=Xa=>{var ei=zy(),br=ut(ei),vo=o(br),yr=v(vo,2);let fo;var Vi=o(yr);let po;var qc=o(Vi);{var Vc=cs=>{var Ns=qy(),Js=o(Ns),jn=o(Js,!0);n(Js);var Bi=v(Js,2),In=o(Bi),Rn=o(In,!0);n(In),n(Bi),n(Ns),$(()=>{w(jn,(e(m),x(()=>e(m).icon))),w(Rn,(e(m),x(()=>e(m).name)))}),h(cs,Ns)},Bc=cs=>{var Ns=Vy();h(cs,Ns)};C(qc,cs=>{e(m)?cs(Vc):cs(Bc,!1)})}ia(2),n(Vi);var ho=v(Vi,2);Tt(ho,5,()=>U,cs=>cs.id,(cs,Ns)=>{var Js=By();let jn;var Bi=o(Js),In=o(Bi,!0);n(Bi);var Rn=v(Bi,2),Do=o(Rn),zc=o(Do,!0);n(Do),n(Rn),n(Js),$(Gc=>{jn=oe(Js,1,"dropdown-option",null,jn,Gc),w(In,(e(Ns),x(()=>e(Ns).icon))),w(zc,(e(Ns),x(()=>e(Ns).name)))},[()=>({selected:e(tt)===e(Ns).id})]),Q("click",Js,()=>K(e(Ns))),h(cs,Js)}),n(ho),n(yr),n(br);var mo=v(br,2),wr=v(o(mo),4),xr=o(wr),go=o(xr),on=v(go,2);sa(on),n(xr);var _o=v(xr,2),bo=o(_o),Sr=v(bo,2);sa(Sr),n(_o),n(wr);var kr=v(wr,2),yo=o(kr),Dr=v(yo,2);Sn(Dr),n(kr);var wo=v(kr,2),Ar=o(wo),xo=o(Ar),Cr=v(xo,2);sa(Cr),n(Ar);var So=v(Ar,2),ko=o(So),$n=v(ko,2);sa($n),n(So),n(wo),n(mo),$((cs,Ns,Js)=>{$t(vo,"for",`edit-grade-level-${e(we),x(()=>e(we).id)??""}`),fo=oe(yr,1,"custom-dropdown",null,fo,cs),po=oe(Vi,1,"dropdown-trigger",null,po,Ns),$t(Vi,"id",`edit-grade-level-${e(we),x(()=>e(we).id)??""}`),$t(go,"for",`edit-birthdate-${e(we),x(()=>e(we).id)??""}`),$t(on,"id",`edit-birthdate-${e(we),x(()=>e(we).id)??""}`),$t(on,"max",Js),$t(bo,"for",`edit-age-${e(we),x(()=>e(we).id)??""}`),$t(Sr,"id",`edit-age-${e(we),x(()=>e(we).id)??""}`),Ui(Sr,e(We)),$t(yo,"for",`edit-address-${e(we),x(()=>e(we).id)??""}`),$t(Dr,"id",`edit-address-${e(we),x(()=>e(we).id)??""}`),$t(xo,"for",`edit-guardian-${e(we),x(()=>e(we).id)??""}`),$t(Cr,"id",`edit-guardian-${e(we),x(()=>e(we).id)??""}`),$t(ko,"for",`edit-contact-number-${e(we),x(()=>e(we).id)??""}`),$t($n,"id",`edit-contact-number-${e(we),x(()=>e(we).id)??""}`)},[()=>({open:e(ve)}),()=>({selected:e(tt)}),()=>x(nt)]),Q("click",Vi,j),la(on,()=>e(Je),cs=>d(Je,cs)),Q("blur",on,cs=>{e(Je)&&!Ye(e(Je))&&(Ae.error("Invalid date. Please enter a valid date."),d(Je,""),cs.target.value="")}),la(Dr,()=>e(Re),cs=>d(Re,cs)),la(Cr,()=>e(Ze),cs=>d(Ze,cs)),la($n,()=>e(st),cs=>d(st,cs)),Q("input",$n,cs=>ee(cs,!0)),h(Xa,ei)};C(Va,Xa=>{e(we),x(()=>e(we).type.toLowerCase()==="student")&&Xa(us)})}var Fs=v(Va,2),Es=o(Fs),Qs=o(Es);n(Es);var Zs=v(Es,2);let fi;var rn=o(Zs);{var qi=Xa=>{var ei=ka("Updating...");h(Xa,ei)},_r=Xa=>{var ei=ka("Update Account");h(Xa,ei)};C(rn,Xa=>{e($e)?Xa(qi):Xa(_r,!1)})}n(Zs),n(Fs),n(Cs),n(_s),n(os),$((Xa,ei)=>{$t(Fn,"for",`edit-last-name-${e(we),x(()=>e(we).id)??""}`),$t(wi,"id",`edit-last-name-${e(we),x(()=>e(we).id)??""}`),$t(Ri,"for",`edit-first-name-${e(we),x(()=>e(we).id)??""}`),$t(Oi,"id",`edit-first-name-${e(we),x(()=>e(we).id)??""}`),$t(Ln,"for",`edit-middle-initial-${e(we),x(()=>e(we).id)??""}`),$t($a,"id",`edit-middle-initial-${e(we),x(()=>e(we).id)??""}`),$t(Es,"href",`#account-card-${e(we),x(()=>e(we).id)??""}`),fi=oe(Zs,1,"account-submit-button",null,fi,Xa),Zs.disabled=ei},[()=>({loading:e($e)}),()=>(e($e),e(me),e(ze),e(l),e(Je),e(Re),e(Ze),e(st),x(()=>e($e)||!e(me)||!e(ze)||e(l)&&e(l).type.toLowerCase()==="student"&&(!e(Je)||!e(Re)||!e(Ze)||!e(st))))]),la(wi,()=>e(ze),Xa=>d(ze,Xa)),Q("input",wi,Xa=>De(Xa,"lastName",!0)),la(Oi,()=>e(me),Xa=>d(me,Xa)),Q("input",Oi,Xa=>De(Xa,"firstName",!0)),la($a,()=>e(Xe),Xa=>d(Xe,Xa)),Q("input",$a,Xa=>De(Xa,"middleInitial",!0)),Q("click",Qs,()=>q(e(we))),Q("submit",Cs,Os(B)),h(ts,os)};C(gr,ts=>{e(Se),e(we),x(()=>e(Se)===e(we).id)&&ts(sn)})}n(it),$(()=>{$t(it,"id",`account-card-${e(we),x(()=>e(we).id)??""}`),w(Vt,`${e(we),x(()=>e(we).name)??""}  ${e(we),x(()=>e(we).type)??""}`),$t(Ft,"href",`#account-card-${e(we),x(()=>e(we).id)??""}`),$t(oa,"title",(e(Se),e(we),x(()=>e(Se)===e(we).id?"Cancel Edit":"Edit Account"))),w(Ta,(e(Se),e(we),x(()=>e(Se)===e(we).id?"close":"edit"))),w(na,(e(we),x(()=>e(we).type==="Student"?"school":e(we).type==="Teacher"?"person":"admin_panel_settings"))),w(Na,(e(we),x(()=>e(we).number))),w(Ja,`${e(we),x(()=>e(we).type)??""} Account`),w(mr,`Created: ${e(we),x(()=>e(we).createdDate)??""}`),w(an,`Updated: ${e(we),x(()=>e(we).updatedDate)??""}`)}),Q("click",oa,()=>q(e(we))),Q("click",Ha,()=>Me(e(we))),h(Nt,it)},Nt=>{var we=Uy(),it=v(o(we),2);{var Mt=_t=>{var Vt=Hy();h(_t,Vt)},At=_t=>{var Vt=Yy();h(_t,Vt)};C(it,_t=>{e(de),x(()=>e(de).length===0)?_t(Mt):_t(At,!1)})}n(we),h(Nt,we)}),h(W,_e)};C(xa,W=>{e(Pe)?W(ja):W(Qa,!1)})}n(Da),n(Ot),n(ge),$((W,_e,dt,Nt,we,it,Mt)=>{Dt=oe(ft,1,"custom-dropdown",null,Dt,W),Qt=oe(vt,1,"dropdown-trigger",null,Qt,_e),Pt=oe(xt,1,"custom-dropdown",null,Pt,dt),H=oe(ye,1,"dropdown-trigger",null,H,Nt),w(ta,e(b)==="student"?"Student Number":e(b)==="teacher"?"Teacher Number":e(b)==="admin"?"Admin Number":"Account Number"),ra=oe(ca,1,"account-create-button",null,ra,we),ca.disabled=e(y)||!e(b)||!e(D)||!e(k)||!e(A)||(e(b)==="student"||e(b)==="teacher")&&(!e(M)||e(I)||e(F))||e(b)==="student"&&(!e(J)||!e(V)||!e(L)||!e(X)),fa=oe(wt,1,"custom-dropdown",null,fa,it),Zt=oe(It,1,"dropdown-trigger filter-trigger",null,Zt,Mt)},[()=>({open:e(ce)}),()=>({selected:e(b)}),()=>({open:e(Le)}),()=>({selected:e(D)}),()=>({loading:e(y)}),()=>({open:e(se)}),()=>({selected:e(re)!=="all"})]),Q("click",vt,N),Q("click",ye,be),la(ht,()=>e(A),W=>d(A,W)),Q("input",ht,W=>De(W,"lastName")),la(pe,()=>e(k),W=>d(k,W)),Q("input",pe,W=>De(W,"firstName")),la(Rt,()=>e(E),W=>d(E,W)),Q("input",Rt,W=>De(W,"middleInitial")),Q("submit",le,Os(Be)),la(mt,()=>e(at),W=>d(at,W)),Q("click",It,ae),h(s,ge),Ga(),i()}var Ky=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Xy=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <span class="option-name"> </span></div>'),Zy=_('<span class="placeholder">All Grade Levels</span>'),e1=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),t1=_('<div class="selected-option"><span class="option-name"> </span></div>'),a1=_('<span class="placeholder">All Sections</span>'),s1=_('<button type="button"><div class="option-content"><span class="option-name"> </span></div></button>'),i1=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),n1=_('<div class="masterlist-loading-container"><span class="student-loader"></span> <p class="masterlist-loading-text">Loading students...</p></div>'),r1=_('<div class="account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),o1=_('<div class="account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),l1=_('<div class="account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),c1=_('<div class="account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),d1=_('<div class="account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),u1=_('<div class="account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),v1=_('<div class="account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),f1=_('<div class="account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),p1=_('<div class="account-card"><div class="account-card-header"><div class="account-title"><h3 class="account-name"><!> </h3></div> <div class="action-buttons"><button type="button" class="archive-button" title="Archive Student"><span class="material-symbols-outlined">archive</span></button></div></div> <div class="master-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),h1=_('<div class="students-grid"></div>'),m1=_('<div class="no-results"><span class="material-symbols-outlined no-results-icon"> </span> <p><!></p></div>'),g1=_('<div class="student-masterlist-container"><div class="admin-student-header"><div class="header-content"><h1 class="page-title">Student Masterlist</h1> <p class="page-subtitle">View and manage all student records in the system</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="dropdown-trigger filter-trigger"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div> <!></div></div></div> <div class="students-list-section"><!></div></div>');function _1(s,t){za(t,!1);const a=P(),i=P();let r=[],l=P([]),c=P(!0),u=P(""),f=P(""),p=P(""),m=P(!1),g=P(!1);const y=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let b=P([{id:"",name:"All Sections"}]);async function D(){d(c,!0);try{const O=await da.get("/api/accounts?type=student");if(!O.success)throw new Error("Failed to load students");r=O.accounts.map(T=>({id:T.id,name:T.name,number:T.number,email:T.email,gradeLevel:T.gradeLevel||"Not specified",section:T.section||"Not specified",birthdate:T.birthdate||"Not specified",address:T.address||"Not specified",guardian:T.guardian||"Not specified",contactNumber:T.contactNumber||"Not specified",status:T.status||"active"})),k()}catch(O){console.error("Error loading students:",O),Ae.error("Failed to load students. Please try again."),r=[]}finally{d(c,!1)}}async function S(){try{const O=await da.get("/api/sections");if(O.success&&O.data){const T=O.data.map(U=>({id:U.name,name:U.name}));d(b,[{id:"",name:"All Sections"},...T])}}catch(O){console.error("Error loading sections:",O)}}function k(){d(l,r.filter(O=>{const T=!e(u)||O.name.toLowerCase().includes(e(u).toLowerCase())||O.email.toLowerCase().includes(e(u).toLowerCase())||O.number&&O.number.toLowerCase().includes(e(u).toLowerCase()),U=!e(f)||O.gradeLevel===e(f),de=!e(p)||O.section===e(p);return T&&U&&de}))}function A(){d(m,!e(m)),d(g,!1)}function E(){d(g,!e(g)),d(m,!1)}function M(O){d(f,O.id),d(m,!1),k()}function I(O){d(p,O.id),d(g,!1),k()}function F(O){if(!O)return"N/A";const T=new Date,U=new Date(O);let de=T.getFullYear()-U.getFullYear();const Pe=T.getMonth()-U.getMonth();return(Pe<0||Pe===0&&T.getDate()<U.getDate())&&de--,de}function z(O){return O?new Date(O).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function R(){d(u,""),d(f,""),d(p,""),k()}function J(O){O.target.closest(".custom-dropdown")||(d(m,!1),d(g,!1))}async function V(O,T){ds.confirm("Archive Student",`Are you sure you want to archive ${T}? This action will move the student to the archived list.`,async()=>{try{const U=await da.patch("/api/accounts",{id:O,action:"archive"});U.success?(Ae.success(U.message),await D()):Ae.error(U.message||"Failed to archive student")}catch(U){console.error("Error archiving student:",U),Ae.error("Failed to archive student. Please try again.")}},()=>{})}Wa(()=>(S(),D(),document.addEventListener("click",J),()=>{document.removeEventListener("click",J)})),Jt(()=>e(f),()=>{d(a,y.find(O=>O.id===e(f)))}),Jt(()=>(e(b),e(p)),()=>{d(i,e(b).find(O=>O.id===e(p)))}),Jt(()=>e(u),()=>{e(u)!==void 0&&k()}),Ss(),vs();var L=g1(),X=v(o(L),2),ne=o(X),ce=o(ne),Le=o(ce),fe=v(o(Le),2);sa(fe);var se=v(fe,2);{var re=O=>{var T=Ky();Q("click",T,()=>d(u,"")),h(O,T)};C(se,O=>{e(u)&&O(re)})}n(Le),n(ce);var Se=v(ce,2),me=o(Se),ze=v(o(me),2);let Xe;var tt=o(ze),ve=o(tt);{var $e=O=>{var T=Xy(),U=o(T),de=o(U,!0);n(U);var Pe=v(U,2),Ve=o(Pe,!0);n(Pe),n(T),$(()=>{w(de,(e(a),x(()=>e(a).icon))),w(Ve,(e(a),x(()=>e(a).name)))}),h(O,T)},Je=O=>{var T=Zy();h(O,T)};C(ve,O=>{e(a)&&e(f)?O($e):O(Je,!1)})}ia(2),n(tt);var Re=v(tt,2);Tt(Re,5,()=>y,O=>O.id,(O,T)=>{var U=e1();let de;var Pe=o(U),Ve=o(Pe,!0);n(Pe);var Me=v(Pe,2),q=o(Me),B=o(q,!0);n(q),n(Me),n(U),$(N=>{de=oe(U,1,"dropdown-option",null,de,N),w(Ve,(e(T),x(()=>e(T).icon))),w(B,(e(T),x(()=>e(T).name)))},[()=>({selected:e(f)===e(T).id})]),Q("click",U,()=>M(e(T))),h(O,U)}),n(Re),n(ze),n(me);var Ze=v(me,2),st=v(o(Ze),2);let We;var nt=o(st),ke=o(nt);{var De=O=>{var T=t1(),U=o(T),de=o(U,!0);n(U),n(T),$(()=>w(de,(e(i),x(()=>e(i).name)))),h(O,T)},Ie=O=>{var T=a1();h(O,T)};C(ke,O=>{e(i)&&e(p)?O(De):O(Ie,!1)})}ia(2),n(nt);var Ee=v(nt,2);Tt(Ee,5,()=>e(b),O=>O.id,(O,T)=>{var U=s1();let de;var Pe=o(U),Ve=o(Pe),Me=o(Ve,!0);n(Ve),n(Pe),n(U),$(q=>{de=oe(U,1,"dropdown-option",null,de,q),w(Me,(e(T),x(()=>e(T).name)))},[()=>({selected:e(p)===e(T).id})]),Q("click",U,()=>I(e(T))),h(O,U)}),n(Ee),n(st),n(Ze);var ee=v(Ze,2);{var Ue=O=>{var T=i1();Q("click",T,R),h(O,T)};C(ee,O=>{(e(u)||e(f)||e(p))&&O(Ue)})}n(Se),n(ne),n(X);var rt=v(X,2),Ye=o(rt);{var at=O=>{var T=n1();h(O,T)},lt=O=>{var T=Et(),U=ut(T);{var de=Ve=>{var Me=h1();Tt(Me,5,()=>e(l),q=>q.id,(q,B)=>{var N=p1(),Z=o(N),be=o(Z),Fe=o(be),he=o(Fe);{var te=He=>{var je=ka();$(()=>w(je,(e(B),x(()=>e(B).number)))),h(He,je)};C(he,He=>{e(B),x(()=>e(B).number)&&He(te)})}var j=v(he);n(Fe),n(be);var K=v(be,2),ae=o(K);n(K),n(Z);var Oe=v(Z,2),Be=o(Oe);{var Ke=He=>{var je=r1(),jt=v(o(je),2),aa=o(jt,!0);n(jt),n(je),$(()=>w(aa,(e(B),x(()=>e(B).email)))),h(He,je)};C(Be,He=>{e(B),x(()=>e(B).email)&&He(Ke)})}var Ge=v(Be,2);{var ot=He=>{var je=o1(),jt=v(o(je),2),aa=o(jt,!0);n(jt),n(je),$(St=>w(aa,St),[()=>(e(B),x(()=>y.find(St=>St.id===e(B).gradeLevel)?.name||e(B).gradeLevel))]),h(He,je)};C(Ge,He=>{e(B),x(()=>e(B).gradeLevel&&e(B).gradeLevel!=="Not specified")&&He(ot)})}var gt=v(Ge,2);{var Yt=He=>{var je=l1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(St=>w(aa,`Section: ${St??""}`),[()=>(e(b),e(B),x(()=>e(b).find(St=>St.id===e(B).section)?.name||e(B).section))]),h(He,je)};C(gt,He=>{e(B),x(()=>e(B).section&&e(B).section!=="Not specified")&&He(Yt)})}var ge=v(gt,2);{var Qe=He=>{var je=c1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(St=>w(aa,`Age: ${St??""} years old`),[()=>(e(B),x(()=>F(e(B).birthdate)))]),h(He,je)};C(ge,He=>{e(B),x(()=>e(B).birthdate&&e(B).birthdate!=="Not specified")&&He(Qe)})}var Y=v(ge,2);{var le=He=>{var je=d1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(()=>w(aa,`Guardian: ${e(B),x(()=>e(B).guardian)??""}`)),h(He,je)};C(Y,He=>{e(B),x(()=>e(B).guardian&&e(B).guardian!=="Not specified")&&He(le)})}var Ce=v(Y,2);{var et=He=>{var je=u1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(()=>w(aa,`Contact: ${e(B),x(()=>e(B).contactNumber)??""}`)),h(He,je)};C(Ce,He=>{e(B),x(()=>e(B).contactNumber&&e(B).contactNumber!=="Not specified")&&He(et)})}var ft=v(Ce,2);{var Dt=He=>{var je=v1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(()=>w(aa,`Address: ${e(B),x(()=>e(B).address)??""}`)),h(He,je)};C(ft,He=>{e(B),x(()=>e(B).address&&e(B).address!=="Not specified")&&He(Dt)})}var vt=v(ft,2);{var Qt=He=>{var je=f1(),jt=v(o(je),2),aa=o(jt);n(jt),n(je),$(St=>w(aa,`Birthdate: ${St??""}`),[()=>(e(B),x(()=>z(e(B).birthdate)))]),h(He,je)};C(vt,He=>{e(B),x(()=>e(B).birthdate&&e(B).birthdate!=="Not specified")&&He(Qt)})}n(Oe),n(N),$(()=>w(j,`  ${e(B),x(()=>e(B).name)??""}`)),Q("click",ae,()=>V(e(B).id,e(B).name)),h(q,N)}),n(Me),h(Ve,Me)},Pe=Ve=>{var Me=m1(),q=o(Me),B=o(q,!0);n(q);var N=v(q,2),Z=o(N);{var be=he=>{var te=ka("No students found matching your search criteria.");h(he,te)},Fe=he=>{var te=ka("No students found in the system.");h(he,te)};C(Z,he=>{e(u)||e(f)||e(p)?he(be):he(Fe,!1)})}n(N),n(Me),$(()=>w(B,e(u)||e(f)||e(p)?"search_off":"school")),h(Ve,Me)};C(U,Ve=>{e(l),x(()=>e(l).length>0)?Ve(de):Ve(Pe,!1)},!0)}h(O,T)};C(Ye,O=>{e(c)?O(at):O(lt,!1)})}n(rt),n(L),$((O,T)=>{Xe=oe(ze,1,"custom-dropdown",null,Xe,O),We=oe(st,1,"custom-dropdown",null,We,T)},[()=>({open:e(m)}),()=>({open:e(g)})]),la(fe,()=>e(u),O=>d(u,O)),Q("click",tt,A),Q("click",nt,E),h(s,L),Ga()}var b1=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),y1=_('<div class="aas-selected-option"><span class="material-symbols-outlined aas-option-icon"> </span> <span class="aas-option-name"> </span></div>'),w1=_('<span class="aas-placeholder">All Grade Levels</span>'),x1=_('<button type="button"><span class="material-symbols-outlined aas-option-icon"> </span> <div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),S1=_('<div class="aas-selected-option"><span class="aas-option-name"> </span></div>'),k1=_('<span class="aas-placeholder">All Sections</span>'),D1=_('<button type="button"><div class="aas-option-content"><span class="aas-option-name"> </span></div></button>'),A1=_('<button type="button" class="clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),C1=_('<div class="aas-loading-container"><span class="aas-student-loader"></span> <p class="aas-loading-text">Loading archived students...</p></div>'),T1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">email</span> <span> </span></div>'),M1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div>'),P1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">class</span> <span> </span></div>'),E1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">cake</span> <span> </span></div>'),F1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">family_restroom</span> <span> </span></div>'),N1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">phone</span> <span> </span></div>'),L1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">home</span> <span> </span></div>'),$1=_('<div class="aas-account-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div>'),j1=_('<div class="aas-account-card"><div class="aas-account-card-header"><div class="aas-account-title"><h3 class="aas-account-name"><!> </h3> <div class="aas-archived-badge"><span class="material-symbols-outlined">archive</span> <span> </span></div></div> <div class="aas-action-buttons"><button type="button" class="aas-restore-button" title="Restore Student"><span class="material-symbols-outlined">unarchive</span></button></div></div> <div class="aas-account-details"><!> <!> <!> <!> <!> <!> <!> <!></div></div>'),I1=_('<div class="aas-students-grid"></div>'),R1=_('<button type="button" class="aas-clear-search-button-inline">Clear</button>'),O1=_('<div class="aas-no-results"><span class="material-symbols-outlined aas-no-results-icon"> </span> <p><!></p> <!></div>'),q1=_('<div class="aas-archived-students-container"><div class="aas-admin-student-header"><div class="aas-header-content"><h1 class="aas-page-title">Archived Students</h1> <p class="aas-page-subtitle">View and manage archived student records</p></div></div> <div class="filters-section"><div class="studmaster-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search archived students by name, email, or ID..."/> <!></div></div> <div class="studmaster-filter-container"><div class="filter-group"><label class="filter-label">Grade Level</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <div class="filter-group"><label class="filter-label">Section</label> <div><button type="button" class="aas-dropdown-trigger aas-filter-trigger"><!> <span class="material-symbols-outlined aas-dropdown-arrow">expand_more</span></button> <div class="aas-dropdown-menu"></div></div></div> <!></div></div></div> <div class="aas-students-list-section"><!></div></div>');function V1(s,t){za(t,!1);const a=P(),i=P();let r=[],l=P([]),c=P(!0),u=P(""),f=P(""),p=P(""),m=P(!1),g=P(!1);const y=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}];let b=P([{id:"",name:"All Sections"}]);async function D(){d(c,!0);try{const T=await da.get("/api/archived-students");if(!T.students)throw new Error("No students data received");r=T.students.map(U=>({id:U.id,name:U.name,number:U.number,email:U.email,gradeLevel:U.gradeLevel||"Not specified",section:U.section||"Not specified",birthdate:U.birthdate||"Not specified",address:U.address||"Not specified",guardian:U.guardian||"Not specified",contactNumber:U.contactNumber||"Not specified",archivedDate:U.archivedDate||"Not specified"})),k()}catch(T){console.error("Error loading archived students:",T),Ae.error("Failed to load archived students. Please try again."),r=[]}finally{d(c,!1)}}async function S(){try{const T=await da.get("/api/sections");if(T.success&&T.data){const U=T.data.map(de=>({id:de.name,name:de.name}));d(b,[{id:"",name:"All Sections"},...U])}}catch(T){console.error("Error loading sections:",T)}}function k(){d(l,r.filter(T=>{const U=!e(u)||T.name.toLowerCase().includes(e(u).toLowerCase())||T.email.toLowerCase().includes(e(u).toLowerCase())||T.number&&T.number.toLowerCase().includes(e(u).toLowerCase()),de=!e(f)||T.gradeLevel===e(f),Pe=!e(p)||T.section===e(p);return U&&de&&Pe}))}function A(){d(m,!e(m)),d(g,!1)}function E(){d(g,!e(g)),d(m,!1)}function M(T){d(f,T.id),d(m,!1),k()}function I(T){d(p,T.id),d(g,!1),k()}function F(T){if(!T)return"N/A";const U=new Date,de=new Date(T);let Pe=U.getFullYear()-de.getFullYear();const Ve=U.getMonth()-de.getMonth();return(Ve<0||Ve===0&&U.getDate()<de.getDate())&&Pe--,Pe}function z(T){return T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function R(T){return T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}async function J(T,U){ds.confirm("Restore Student",`Are you sure you want to restore ${U}? This action will move the student back to the active list.`,async()=>{try{const de=await da.put("/api/archived-students",{id:T});Ae.success(de.message||"Student restored successfully"),await D()}catch(de){console.error("Error restoring student:",de),Ae.error(de.message||"Failed to restore student. Please try again.")}},()=>{})}function V(){d(u,""),d(f,""),d(p,""),k()}function L(T){T.target.closest(".aas-custom-dropdown")||(d(m,!1),d(g,!1))}Wa(()=>(S(),D(),document.addEventListener("click",L),()=>{document.removeEventListener("click",L)})),Jt(()=>e(f),()=>{d(a,y.find(T=>T.id===e(f)))}),Jt(()=>(e(b),e(p)),()=>{d(i,e(b).find(T=>T.id===e(p)))}),Jt(()=>e(u),()=>{e(u)!==void 0&&k()}),Ss(),vs();var X=q1(),ne=v(o(X),2),ce=o(ne),Le=o(ce),fe=o(Le),se=v(o(fe),2);sa(se);var re=v(se,2);{var Se=T=>{var U=b1();Q("click",U,()=>d(u,"")),h(T,U)};C(re,T=>{e(u)&&T(Se)})}n(fe),n(Le);var me=v(Le,2),ze=o(me),Xe=v(o(ze),2);let tt;var ve=o(Xe),$e=o(ve);{var Je=T=>{var U=y1(),de=o(U),Pe=o(de,!0);n(de);var Ve=v(de,2),Me=o(Ve,!0);n(Ve),n(U),$(()=>{w(Pe,(e(a),x(()=>e(a).icon))),w(Me,(e(a),x(()=>e(a).name)))}),h(T,U)},Re=T=>{var U=w1();h(T,U)};C($e,T=>{e(a)&&e(f)?T(Je):T(Re,!1)})}ia(2),n(ve);var Ze=v(ve,2);Tt(Ze,5,()=>y,T=>T.id,(T,U)=>{var de=x1();let Pe;var Ve=o(de),Me=o(Ve,!0);n(Ve);var q=v(Ve,2),B=o(q),N=o(B,!0);n(B),n(q),n(de),$(Z=>{Pe=oe(de,1,"aas-dropdown-option",null,Pe,Z),w(Me,(e(U),x(()=>e(U).icon))),w(N,(e(U),x(()=>e(U).name)))},[()=>({selected:e(f)===e(U).id})]),Q("click",de,()=>M(e(U))),h(T,de)}),n(Ze),n(Xe),n(ze);var st=v(ze,2),We=v(o(st),2);let nt;var ke=o(We),De=o(ke);{var Ie=T=>{var U=S1(),de=o(U),Pe=o(de,!0);n(de),n(U),$(()=>w(Pe,(e(i),x(()=>e(i).name)))),h(T,U)},Ee=T=>{var U=k1();h(T,U)};C(De,T=>{e(i)&&e(p)?T(Ie):T(Ee,!1)})}ia(2),n(ke);var ee=v(ke,2);Tt(ee,5,()=>e(b),T=>T.id,(T,U)=>{var de=D1();let Pe;var Ve=o(de),Me=o(Ve),q=o(Me,!0);n(Me),n(Ve),n(de),$(B=>{Pe=oe(de,1,"aas-dropdown-option",null,Pe,B),w(q,(e(U),x(()=>e(U).name)))},[()=>({selected:e(p)===e(U).id})]),Q("click",de,()=>I(e(U))),h(T,de)}),n(ee),n(We),n(st);var Ue=v(st,2);{var rt=T=>{var U=A1();Q("click",U,V),h(T,U)};C(Ue,T=>{(e(u)||e(f)||e(p))&&T(rt)})}n(me),n(ce),n(ne);var Ye=v(ne,2),at=o(Ye);{var lt=T=>{var U=C1();h(T,U)},O=T=>{var U=Et(),de=ut(U);{var Pe=Me=>{var q=I1();Tt(q,5,()=>e(l),B=>B.id,(B,N)=>{var Z=j1(),be=o(Z),Fe=o(be),he=o(Fe),te=o(he);{var j=St=>{var xt=ka();$(()=>w(xt,(e(N),x(()=>e(N).number)))),h(St,xt)};C(te,St=>{e(N),x(()=>e(N).number)&&St(j)})}var K=v(te);n(he);var ae=v(he,2),Oe=v(o(ae),2),Be=o(Oe);n(Oe),n(ae),n(Fe);var Ke=v(Fe,2),Ge=o(Ke);n(Ke),n(be);var ot=v(be,2),gt=o(ot);{var Yt=St=>{var xt=T1(),Pt=v(o(xt),2),ye=o(Pt,!0);n(Pt),n(xt),$(()=>w(ye,(e(N),x(()=>e(N).email)))),h(St,xt)};C(gt,St=>{e(N),x(()=>e(N).email)&&St(Yt)})}var ge=v(gt,2);{var Qe=St=>{var xt=M1(),Pt=v(o(xt),2),ye=o(Pt,!0);n(Pt),n(xt),$(H=>w(ye,H),[()=>(e(N),x(()=>y.find(H=>H.id===e(N).gradeLevel)?.name||e(N).gradeLevel))]),h(St,xt)};C(ge,St=>{e(N),x(()=>e(N).gradeLevel&&e(N).gradeLevel!=="Not specified")&&St(Qe)})}var Y=v(ge,2);{var le=St=>{var xt=P1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(H=>w(ye,`Section: ${H??""}`),[()=>(e(b),e(N),x(()=>e(b).find(H=>H.id===e(N).section)?.name||e(N).section))]),h(St,xt)};C(Y,St=>{e(N),x(()=>e(N).section&&e(N).section!=="Not specified")&&St(le)})}var Ce=v(Y,2);{var et=St=>{var xt=E1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(H=>w(ye,`Age: ${H??""} years old`),[()=>(e(N),x(()=>F(e(N).birthdate)))]),h(St,xt)};C(Ce,St=>{e(N),x(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&St(et)})}var ft=v(Ce,2);{var Dt=St=>{var xt=F1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(()=>w(ye,`Guardian: ${e(N),x(()=>e(N).guardian)??""}`)),h(St,xt)};C(ft,St=>{e(N),x(()=>e(N).guardian&&e(N).guardian!=="Not specified")&&St(Dt)})}var vt=v(ft,2);{var Qt=St=>{var xt=N1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(()=>w(ye,`Contact: ${e(N),x(()=>e(N).contactNumber)??""}`)),h(St,xt)};C(vt,St=>{e(N),x(()=>e(N).contactNumber&&e(N).contactNumber!=="Not specified")&&St(Qt)})}var He=v(vt,2);{var je=St=>{var xt=L1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(()=>w(ye,`Address: ${e(N),x(()=>e(N).address)??""}`)),h(St,xt)};C(He,St=>{e(N),x(()=>e(N).address&&e(N).address!=="Not specified")&&St(je)})}var jt=v(He,2);{var aa=St=>{var xt=$1(),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt),$(H=>w(ye,`Birthdate: ${H??""}`),[()=>(e(N),x(()=>z(e(N).birthdate)))]),h(St,xt)};C(jt,St=>{e(N),x(()=>e(N).birthdate&&e(N).birthdate!=="Not specified")&&St(aa)})}n(ot),n(Z),$(St=>{w(K,`  ${e(N),x(()=>e(N).name)??""}`),w(Be,`Archived ${St??""}`)},[()=>(e(N),x(()=>R(e(N).archivedDate)))]),Q("click",Ge,()=>J(e(N).id,e(N).name)),h(B,Z)}),n(q),h(Me,q)},Ve=Me=>{var q=O1(),B=o(q),N=o(B,!0);n(B);var Z=v(B,2),be=o(Z);{var Fe=K=>{var ae=ka("No archived students found matching your search criteria.");h(K,ae)},he=K=>{var ae=ka("No archived students found in the system.");h(K,ae)};C(be,K=>{e(u)||e(f)||e(p)?K(Fe):K(he,!1)})}n(Z);var te=v(Z,2);{var j=K=>{var ae=R1();Q("click",ae,V),h(K,ae)};C(te,K=>{(e(u)||e(f)||e(p))&&K(j)})}n(q),$(()=>w(N,e(u)||e(f)||e(p)?"search_off":"archive")),h(Me,q)};C(de,Me=>{e(l),x(()=>e(l).length>0)?Me(Pe):Me(Ve,!1)},!0)}h(T,U)};C(at,T=>{e(c)?T(lt):T(O,!1)})}n(Ye),n(X),$((T,U)=>{tt=oe(Xe,1,"aas-custom-dropdown",null,tt,T),nt=oe(We,1,"aas-custom-dropdown",null,nt,U)},[()=>({open:e(m)}),()=>({open:e(g)})]),la(se,()=>e(u),T=>d(u,T)),Q("click",ve,A),Q("click",ke,E),h(s,X),Ga()}var B1=_('<button type="button" class="sgl-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),z1=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),G1=_('<span class="sgl-placeholder">Current Quarter</span>'),W1=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),H1=_('<div class="sgl-selected-option"><span class="material-symbols-outlined sgl-option-icon"> </span> <span class="sgl-option-name"> </span></div>'),Y1=_('<span class="sgl-placeholder">All Grade Levels</span>'),U1=_('<button type="button"><span class="material-symbols-outlined sgl-option-icon"> </span> <div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),Q1=_('<div class="sgl-selected-option"><span class="sgl-option-name"> </span></div>'),J1=_('<span class="sgl-placeholder">All Sections</span>'),K1=_('<button type="button"><div class="sgl-option-content"><span class="sgl-option-name"> </span></div></button>'),X1=_('<button type="button" class="sgl-clear-filters-button"><span class="material-symbols-outlined">filter_alt_off</span></button>'),Z1=_('<div class="sgl-masterlist-loading-container"><span class="sgl-student-loader"></span> <p class="sgl-masterlist-loading-text">Loading student grades...</p></div>'),e2=_('<div class="sgl-empty-state"><span class="material-symbols-outlined sgl-empty-icon">search_off</span> <h3 class="sgl-empty-title">No students found</h3> <p class="sgl-empty-description"><!></p></div>'),t2=_('<tr><td class="sgl-student-id"> </td><td class="sgl-student-name"> </td><td class="sgl-year-level"> </td><td class="sgl-section"> </td><td class="sgl-gwa"> </td></tr>'),a2=_('<div class="sgl-results-header"><p class="sgl-results-count"> </p></div> <div class="sgl-table-container"><table class="sgl-students-table"><thead><tr><th>Student ID</th><th>Name</th><th>Grade Level</th><th>Section</th><th>GWA</th></tr></thead><tbody></tbody></table></div>',1),s2=_('<div class="sgl-student-grades-container"><div class="sgl-admin-student-header"><div class="sgl-header-content"><h1 class="sgl-page-title">Student Grades List</h1> <p class="sgl-page-subtitle">View and manage student academic performance records</p></div></div> <div class="sgl-filters-section"><div class="sgl-search-filter-container"><div class="sgl-search-container"><div class="sgl-search-input-wrapper"><span class="material-symbols-outlined sgl-search-icon">search</span> <input type="text" class="sgl-search-input" placeholder="Search students by name, email, or ID..."/> <!></div></div> <div class="sgl-filter-container"><div class="sgl-filter-group"><label class="sgl-filter-label">Quarter</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label">Grade Level</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <div class="sgl-filter-group"><label class="sgl-filter-label">Section</label> <div><button type="button" class="sgl-dropdown-trigger sgl-filter-trigger"><!> <span class="material-symbols-outlined sgl-dropdown-arrow">expand_more</span></button> <div class="sgl-dropdown-menu"></div></div></div> <!></div></div></div> <div class="sgl-results-section"><!></div></div>');function i2(s,t){za(t,!1);const a=P(),i=P(),r=P();let l=P([]),c=P([]),u=[],f=P(!0),p=P(""),m=P(""),g=P(""),y=P(""),b=P(!1),D=P(!1),S=P(!1);const k=[{id:"",name:"All Grade Levels",icon:"school"},{id:"7",name:"Grade 7",icon:"looks_one"},{id:"8",name:"Grade 8",icon:"looks_two"},{id:"9",name:"Grade 9",icon:"looks_3"},{id:"10",name:"Grade 10",icon:"looks_4"}],A=[{id:"",name:"Current Quarter",icon:"event"},{id:"all",name:"Overall (All Quarters)",icon:"summarize"},{id:"1",name:"1st Quarter",icon:"filter_1"},{id:"2",name:"2nd Quarter",icon:"filter_2"},{id:"3",name:"3rd Quarter",icon:"filter_3"},{id:"4",name:"4th Quarter",icon:"filter_4"}];let E=P([{id:"",name:"All Sections"}]);async function M(){try{const te=await da.get("/api/sections");if(te.success){u=te.data||[];const j=u.filter(K=>K.status==="active");d(E,[{id:"",name:"All Sections"},...j.map(K=>({id:K.name,name:`Grade ${K.grade_level}  ${K.name}`}))])}}catch(te){console.error("Error loading sections:",te),Ae.error("Failed to load sections")}}async function I(){d(f,!0);try{const te=new URLSearchParams;e(y)&&te.append("quarter",e(y));const j=`/api/students-bulk${te.toString()?"?"+te.toString():""}`,K=await da.get(j);if(!K.success)throw new Error(K.error||"Failed to load students");d(l,K.students||[]),F()}catch(te){console.error("Error loading students:",te),Ae.error("Failed to load students. Please try again."),d(l,[])}finally{d(f,!1)}}function F(){d(c,e(l).filter(te=>{const j=!e(p)||te.name.toLowerCase().includes(e(p).toLowerCase())||te.id.toString().toLowerCase().includes(e(p).toLowerCase()),K=!e(m)||te.gradeLevel===e(m),ae=!e(g)||te.section===e(g);return j&&K&&ae}))}function z(){d(b,!e(b)),d(D,!1),d(S,!1)}function R(){d(D,!e(D)),d(b,!1),d(S,!1)}function J(){d(S,!e(S)),d(b,!1),d(D,!1)}function V(te){d(m,te.id),d(b,!1),F()}function L(te){d(g,te.id),d(D,!1),F()}function X(te){d(y,te.id),d(S,!1),I()}function ne(){F()}function ce(){d(p,""),d(m,""),d(g,""),d(y,""),I()}function Le(te){return{7:"Grade 7",8:"Grade 8",9:"Grade 9",10:"Grade 10"}[te]||te}function fe(te){te.target.closest(".sgl-custom-dropdown")||(d(b,!1),d(D,!1),d(S,!1))}Wa(async()=>(await M(),await I(),document.addEventListener("click",fe),()=>{document.removeEventListener("click",fe)})),Jt(()=>e(m),()=>{d(a,k.find(te=>te.id===e(m)))}),Jt(()=>(e(E),e(g)),()=>{d(i,e(E).find(te=>te.id===e(g)))}),Jt(()=>e(y),()=>{d(r,A.find(te=>te.id===e(y)))}),Jt(()=>e(p),()=>{e(p)!==void 0&&ne()}),Ss(),vs();var se=s2(),re=v(o(se),2),Se=o(re),me=o(Se),ze=o(me),Xe=v(o(ze),2);sa(Xe);var tt=v(Xe,2);{var ve=te=>{var j=B1();Q("click",j,()=>d(p,"")),h(te,j)};C(tt,te=>{e(p)&&te(ve)})}n(ze),n(me);var $e=v(me,2),Je=o($e),Re=v(o(Je),2);let Ze;var st=o(Re),We=o(st);{var nt=te=>{var j=z1(),K=o(j),ae=o(K,!0);n(K);var Oe=v(K,2),Be=o(Oe,!0);n(Oe),n(j),$(()=>{w(ae,(e(r),x(()=>e(r).icon))),w(Be,(e(r),x(()=>e(r).name)))}),h(te,j)},ke=te=>{var j=G1();h(te,j)};C(We,te=>{e(r)?te(nt):te(ke,!1)})}ia(2),n(st);var De=v(st,2);Tt(De,5,()=>A,te=>te.id,(te,j)=>{var K=W1();let ae;var Oe=o(K),Be=o(Oe,!0);n(Oe);var Ke=v(Oe,2),Ge=o(Ke),ot=o(Ge,!0);n(Ge),n(Ke),n(K),$(gt=>{ae=oe(K,1,"sgl-dropdown-option",null,ae,gt),w(Be,(e(j),x(()=>e(j).icon))),w(ot,(e(j),x(()=>e(j).name)))},[()=>({selected:e(y)===e(j).id})]),Q("click",K,()=>X(e(j))),h(te,K)}),n(De),n(Re),n(Je);var Ie=v(Je,2),Ee=v(o(Ie),2);let ee;var Ue=o(Ee),rt=o(Ue);{var Ye=te=>{var j=H1(),K=o(j),ae=o(K,!0);n(K);var Oe=v(K,2),Be=o(Oe,!0);n(Oe),n(j),$(()=>{w(ae,(e(a),x(()=>e(a).icon))),w(Be,(e(a),x(()=>e(a).name)))}),h(te,j)},at=te=>{var j=Y1();h(te,j)};C(rt,te=>{e(a)&&e(m)?te(Ye):te(at,!1)})}ia(2),n(Ue);var lt=v(Ue,2);Tt(lt,5,()=>k,te=>te.id,(te,j)=>{var K=U1();let ae;var Oe=o(K),Be=o(Oe,!0);n(Oe);var Ke=v(Oe,2),Ge=o(Ke),ot=o(Ge,!0);n(Ge),n(Ke),n(K),$(gt=>{ae=oe(K,1,"sgl-dropdown-option",null,ae,gt),w(Be,(e(j),x(()=>e(j).icon))),w(ot,(e(j),x(()=>e(j).name)))},[()=>({selected:e(m)===e(j).id})]),Q("click",K,()=>V(e(j))),h(te,K)}),n(lt),n(Ee),n(Ie);var O=v(Ie,2),T=v(o(O),2);let U;var de=o(T),Pe=o(de);{var Ve=te=>{var j=Q1(),K=o(j),ae=o(K,!0);n(K),n(j),$(()=>w(ae,(e(i),x(()=>e(i).name)))),h(te,j)},Me=te=>{var j=J1();h(te,j)};C(Pe,te=>{e(i)&&e(g)?te(Ve):te(Me,!1)})}ia(2),n(de);var q=v(de,2);Tt(q,5,()=>e(E),te=>te.id,(te,j)=>{var K=K1();let ae;var Oe=o(K),Be=o(Oe),Ke=o(Be,!0);n(Be),n(Oe),n(K),$(Ge=>{ae=oe(K,1,"sgl-dropdown-option",null,ae,Ge),w(Ke,(e(j),x(()=>e(j).name)))},[()=>({selected:e(g)===e(j).id})]),Q("click",K,()=>L(e(j))),h(te,K)}),n(q),n(T),n(O);var B=v(O,2);{var N=te=>{var j=X1();Q("click",j,ce),h(te,j)};C(B,te=>{(e(p)||e(m)||e(g)||e(y))&&te(N)})}n($e),n(Se),n(re);var Z=v(re,2),be=o(Z);{var Fe=te=>{var j=Z1();h(te,j)},he=te=>{var j=Et(),K=ut(j);{var ae=Be=>{var Ke=e2(),Ge=v(o(Ke),4),ot=o(Ge);{var gt=ge=>{var Qe=ka("Try adjusting your search criteria or filters.");h(ge,Qe)},Yt=ge=>{var Qe=ka("No student records are available at the moment.");h(ge,Qe)};C(ot,ge=>{e(p)||e(m)||e(g)?ge(gt):ge(Yt,!1)})}n(Ge),n(Ke),h(Be,Ke)},Oe=Be=>{var Ke=a2(),Ge=ut(Ke),ot=o(Ge),gt=o(ot);n(ot),n(Ge);var Yt=v(Ge,2),ge=o(Yt),Qe=v(o(ge));Tt(Qe,5,()=>e(c),Y=>Y.id,(Y,le)=>{var Ce=t2();let et;var ft=o(Ce),Dt=o(ft,!0);n(ft);var vt=v(ft),Qt=o(vt,!0);n(vt);var He=v(vt),je=o(He,!0);n(He);var jt=v(He),aa=o(jt,!0);n(jt);var St=v(jt),xt=o(St,!0);n(St),n(Ce),$((Pt,ye)=>{et=oe(Ce,1,"sgl-student-row",null,et,Pt),w(Dt,(e(le),x(()=>e(le).id))),w(Qt,(e(le),x(()=>e(le).name))),w(je,ye),w(aa,(e(le),x(()=>e(le).section))),w(xt,(e(le),x(()=>e(le).gwa)))},[()=>({"low-gwa":e(le).gwa<75}),()=>(e(le),x(()=>Le(e(le).gradeLevel)))]),h(Y,Ce)}),n(Qe),n(ge),n(Yt),$(()=>w(gt,`Showing ${e(c),x(()=>e(c).length)??""} of ${e(l),x(()=>e(l).length)??""} students`)),h(Be,Ke)};C(K,Be=>{e(c),x(()=>e(c).length===0)?Be(ae):Be(Oe,!1)},!0)}h(te,j)};C(be,te=>{e(f)?te(Fe):te(he,!1)})}n(Z),n(se),$((te,j,K)=>{Ze=oe(Re,1,"sgl-custom-dropdown",null,Ze,te),ee=oe(Ee,1,"sgl-custom-dropdown",null,ee,j),U=oe(T,1,"sgl-custom-dropdown",null,U,K)},[()=>({open:e(S)}),()=>({open:e(b)}),()=>({open:e(D)})]),la(Xe,()=>e(p),te=>d(p,te)),Q("click",st,J),Q("click",Ue,z),Q("click",de,R),h(s,se),Ga()}var n2=_('<label class="time-input-label svelte-rxn8x9"> </label>'),r2=_('<span class="time-display svelte-rxn8x9"> </span>'),o2=_('<span class="time-placeholder svelte-rxn8x9"> </span>'),l2=_('<button type="button"> </button>'),c2=_('<button type="button"> </button>'),d2=_('<button type="button"> </button>'),u2=_('<div class="time-dropdown-menu svelte-rxn8x9"><div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Hour</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Minute</div> <div class="time-options svelte-rxn8x9"></div></div> <div class="time-section svelte-rxn8x9"><div class="time-section-header svelte-rxn8x9">Period</div> <div class="time-options svelte-rxn8x9"></div></div></div>'),v2=_('<div class="time-input-container svelte-rxn8x9"><!> <button type="button"><!> <span class="material-symbols-outlined time-dropdown-arrow svelte-rxn8x9">expand_more</span></button> <!></div>');function Hl(s,t){za(t,!1);const a=P();let i=La(t,"value",8,""),r=La(t,"placeholder",8,"Select time"),l=La(t,"disabled",8,!1),c=La(t,"label",8,""),u=La(t,"isOpen",12,!1);const f=Uc();let p=P(""),m=P(""),g=P("AM");const y=Array.from({length:12},(re,Se)=>{const me=Se+1;return{value:me.toString().padStart(2,"0"),label:me.toString()}}),b=[{value:"00",label:"00"},{value:"15",label:"15"},{value:"30",label:"30"},{value:"45",label:"45"}],D=[{value:"AM",label:"AM"},{value:"PM",label:"PM"}];function S(re){if(!re){d(p,""),d(m,""),d(g,"AM");return}const Se=re.split(":");let me=parseInt(Se[0]);const ze=Se[1]||"00";me===0?(d(p,"12"),d(g,"AM")):me<12?(d(p,me.toString().padStart(2,"0")),d(g,"AM")):me===12?(d(p,"12"),d(g,"PM")):(d(p,(me-12).toString().padStart(2,"0")),d(g,"PM")),d(m,ze)}function k(){if(!e(p)||!e(m))return"";let re=parseInt(e(p));return e(g)==="AM"&&re===12?re=0:e(g)==="PM"&&re!==12&&(re+=12),`${re.toString().padStart(2,"0")}:${e(m)}`}function A(){const re=k();re!==i()&&f("change",{value:re})}function E(re){d(p,re),A()}function M(re){d(m,re),A()}function I(re){d(g,re),A()}function F(){l()||(u(!u()),u()&&f("open"))}function z(re){re.target.closest(".time-input-container")||u(!1)}Jt(()=>xs(i()),()=>{i()&&i()!==k()&&S(i())}),Jt(()=>(e(p),e(m),e(g)),()=>{d(a,e(p)&&e(m)?`${e(p)}:${e(m)} ${e(g)}`:"")}),Ss(),vs();var R=v2();Q("click",Ys,z);var J=o(R);{var V=re=>{var Se=n2(),me=o(Se,!0);n(Se),$(()=>w(me,c())),h(re,Se)};C(J,re=>{c()&&re(V)})}var L=v(J,2);let X;var ne=o(L);{var ce=re=>{var Se=r2(),me=o(Se,!0);n(Se),$(()=>w(me,e(a))),h(re,Se)},Le=re=>{var Se=o2(),me=o(Se,!0);n(Se),$(()=>w(me,r())),h(re,Se)};C(ne,re=>{e(a)?re(ce):re(Le,!1)})}ia(2),n(L);var fe=v(L,2);{var se=re=>{var Se=u2(),me=o(Se),ze=v(o(me),2);Tt(ze,5,()=>y,Ka,(Je,Re)=>{var Ze=l2();let st;var We=o(Ze,!0);n(Ze),$(nt=>{st=oe(Ze,1,"time-option svelte-rxn8x9",null,st,nt),w(We,(e(Re),x(()=>e(Re).label)))},[()=>({selected:e(p)===e(Re).value})]),Q("click",Ze,()=>E(e(Re).value)),h(Je,Ze)}),n(ze),n(me);var Xe=v(me,2),tt=v(o(Xe),2);Tt(tt,5,()=>b,Ka,(Je,Re)=>{var Ze=c2();let st;var We=o(Ze,!0);n(Ze),$(nt=>{st=oe(Ze,1,"time-option svelte-rxn8x9",null,st,nt),w(We,(e(Re),x(()=>e(Re).label)))},[()=>({selected:e(m)===e(Re).value})]),Q("click",Ze,()=>M(e(Re).value)),h(Je,Ze)}),n(tt),n(Xe);var ve=v(Xe,2),$e=v(o(ve),2);Tt($e,5,()=>D,Ka,(Je,Re)=>{var Ze=d2();let st;var We=o(Ze,!0);n(Ze),$(nt=>{st=oe(Ze,1,"time-option svelte-rxn8x9",null,st,nt),w(We,(e(Re),x(()=>e(Re).label)))},[()=>({selected:e(g)===e(Re).value})]),Q("click",Ze,()=>I(e(Re).value)),h(Je,Ze)}),n($e),n(ve),n(Se),h(re,Se)};C(fe,re=>{u()&&re(se)})}n(R),$(re=>{X=oe(L,1,"time-input-trigger svelte-rxn8x9",null,X,re),L.disabled=l()},[()=>({open:u(),selected:e(a),disabled:l()})]),Q("click",L,F),h(s,R),Ga()}var f2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span></div></div>'),p2=_('<span class="placeholder">Select year level</span>'),h2=_('<button type="button"><span class="material-symbols-outlined option-icon">school</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),m2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span></div></div>'),g2=_('<span class="placeholder"> </span>'),_2=_('<div class="admin-section-loading"><span class="section-loader"></span> <span>Loading sections...</span></div>'),b2=_('<button type="button"><span class="material-symbols-outlined option-icon">class</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),y2=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined empty-icon">inbox</span> <span class="empty-text">No sections available</span></div>'),w2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon"> </span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),x2=_('<span class="scheduleassign-placeholder">Select Schedule Type</span>'),S2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),k2=_('<span class="scheduleassign-placeholder">Select Subject</span>'),D2=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading subjects...</span></div>'),A2=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),C2=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No subjects available</span></div>'),T2=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Subject</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),M2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),P2=_('<span class="scheduleassign-placeholder">Select Activity Type</span>'),E2=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading activity types...</span></div>'),F2=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),N2=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No activity types available</span></div>'),L2=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Activity Type</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),$2=_('<div class="scheduleassign-selected-option"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></div>'),j2=_('<span class="scheduleassign-placeholder">Select Teacher</span>'),I2=_('<div class="scheduleassign-loading"><span class="scheduleassign-loader"></span> <span>Loading teachers...</span></div>'),R2=_('<button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">person</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name"> </span></div></button>'),O2=_('<div class="scheduleassign-empty-state"><span class="material-symbols-outlined scheduleassign-empty-icon">inbox</span> <span class="scheduleassign-empty-text">No teachers available</span></div>'),q2=_('<div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Teacher</label> <div class="scheduleassign-custom-dropdown"><button type="button"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><!></div></div></div>'),V2=_('<div class="scheduleassign-time-error"><span class="material-symbols-outlined">error</span> <span> </span></div>'),B2=_('<div class="scheduleassign-time-duration"><span class="material-symbols-outlined">schedule</span> <span> </span></div>'),z2=_('<label class="scheduleassign-day-checkbox"><input type="checkbox"/> <span class="scheduleassign-checkbox-label"> </span></label>'),G2=_('<div class="scheduleassign-add-form" id="addScheduleForm"><h4 class="scheduleassign-form-title">Add New Schedule</h4> <div class="scheduleassign-form-inputs"><div class="scheduleassign-type-subject-row"><div class="scheduleassign-input-group"><label class="scheduleassign-input-label">Schedule Type</label> <div class="scheduleassign-custom-dropdown"><button type="button" id="scheduleassign-schedule-type-dropdown"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div><button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">book</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Subject</span></div></button> <button type="button"><span class="material-symbols-outlined scheduleassign-option-icon">sports</span> <div class="scheduleassign-option-content"><span class="scheduleassign-option-name">Activity</span></div></button></div></div></div> <!> <!></div> <div class="scheduleassign-time-section"><div class="scheduleassign-time-row"><div class="scheduleassign-input-group"><!></div> <div class="scheduleassign-input-group"><!></div></div> <div class="scheduleassign-time-info-container"><!></div> <div class="scheduleassign-day-selection-section"><div class="scheduleassign-day-checkboxes"></div></div></div></div> <div class="scheduleassign-form-actions"><button type="button"><span class="material-symbols-outlined"> </span> <!></button></div></div>'),W2=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">person</span> <span class="scheduleassign-detail-text"> </span></div>'),H2=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">schedule</span> <span class="scheduleassign-detail-text"> </span></div>'),Y2=_('<span class="scheduleassign-room-details"> </span>'),U2=_('<div class="scheduleassign-detail-item"><span class="material-symbols-outlined scheduleassign-detail-icon">location_on</span> <span class="scheduleassign-detail-text"> <!></span></div>'),Q2=_('<div class="scheduleassign-assignment-card"><div class="scheduleassign-assignment-header"><div class="scheduleassign-assignment-info"><h4 class="scheduleassign-assignment-title"> </h4> <p class="scheduleassign-assignment-subtitle"> </p></div> <div class="scheduleassign-assignment-actions"><button type="button" class="scheduleassign-delete-button" title="Delete assignment"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="scheduleassign-assignment-details"><!> <!> <!></div></div>'),J2=_('<div class="scheduleassign-empty-day"><span class="material-symbols-outlined empty-icon">event_available</span> <span class="empty-text">No schedules</span></div>'),K2=_('<div class="scheduleassign-day-column"><div class="scheduleassign-day-header"><span class="day-name"> </span></div> <div class="scheduleassign-day-schedules"><!></div></div>'),X2=_('<div class="scheduleassign-schedule-grid"><div class="scheduleassign-schedule-actions"><a href="#addScheduleForm" class="scheduleassign-add-schedule-link"><button type="button"><span class="material-symbols-outlined"> </span> </button></a></div> <!> <div class="scheduleassign-days-grid"></div></div>'),Z2=_('<div class="scheduleassign-empty-state-main"><span class="material-symbols-outlined empty-icon">calendar_month</span> <h3>Select Year Level and Section</h3> <p>Choose a year level and section to view the weekly schedule.</p></div>'),ew=_('<div class="scheduleassign-form-section"><div class="scheduleassign-section-header"><h2 class="admin-section-title">Schedule Management</h2> <p class="scheduleassign-form-instruction">Select year level and section to view all schedule assignments.</p></div> <form><div class="scheduleassign-hierarchical-form"><div class="scheduleassign-selection-row"><div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-year">Year Level *</label> <div><button type="button" id="form-year"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"></div></div></div> <div class="scheduleassign-form-group"><label class="scheduleassign-form-label" for="form-section">Section *</label> <div><button type="button" id="form-section"><!> <span class="material-symbols-outlined scheduleassign-dropdown-arrow">expand_more</span></button> <div class="scheduleassign-dropdown-menu"><div class="scheduleassign-search-container"><input type="text" class="scheduleassign-search-input" placeholder="Search sections..."/> <span class="material-icons scheduleassign-search-icon">search</span></div> <!></div></div></div></div> <!></div></form></div>');function tw(s,t){za(t,!1);const a=P(),i=P(),r=P(),l=P(),c=P(),u=P(),f=P(),p=[];let m=P(""),g=P(""),y=P(!1),b=P(!1),D=P(""),S=P(!1);const k=[{id:"grade-7",name:"Grade 7",description:"Junior High School - First Year"},{id:"grade-8",name:"Grade 8",description:"Junior High School - Second Year"},{id:"grade-9",name:"Grade 9",description:"Junior High School - Third Year"},{id:"grade-10",name:"Grade 10",description:"Junior High School - Fourth Year"}],A=[{id:"monday",name:"Monday"},{id:"tuesday",name:"Tuesday"},{id:"wednesday",name:"Wednesday"},{id:"thursday",name:"Thursday"},{id:"friday",name:"Friday"}];let E=P([]),M="2024-2025";async function I(){try{const Te=await(await fetch("/api/current-quarter")).json();Te.success&&Te.data?(M=Te.data.currentSchoolYear,console.log(`School year set to: ${M}`)):console.warn("Failed to fetch current school year, using default: 2024-2025")}catch(xe){console.error("Error fetching current school year:",xe)}}async function F(){d(S,!0);try{const Te=await(await fetch("/api/sections?action=available-sections")).json();Te.success&&d(E,Te.data.map(ue=>({id:ue._id,name:ue.name,grade:`Grade ${ue.grade_level}`,year:`grade-${ue.grade_level}`,grade_level:ue.grade_level,school_year:ue.school_year,status:ue.status})))}catch(xe){console.error("Error loading sections:",xe)}finally{d(S,!1)}}let z=P([]),R=P(!1),J=P(!1),V=P([]),L=P({startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""}),X=P([]),ne=P([]),ce=P([]),Le=P(!1),fe=P(!1),se=P(!1),re=P(!1),Se=P(!1),me=P(!1),ze=P(!1),Xe=P(!1),tt=P(!1),ve=P(""),$e=P(""),Je=P(""),Re=P(!1),Ze=P([]);function st(){const xe=e(L).startTime,Te=e(L).endTime;if(!xe||!Te){d(ve,""),d($e,"");return}const ue=We(xe),bt=We(Te);if(bt<=ue)d(ve,"End time must be after start time"),d($e,"");else{d(ve,"");const ht=bt-ue,G=Math.floor(ht/60),pe=ht%60;G>0&&pe>0?d($e,`${G} hour${G>1?"s":""} and ${pe} minute${pe>1?"s":""}`):G>0?d($e,`${G} hour${G>1?"s":""}`):d($e,`${pe} minute${pe>1?"s":""}`)}}function We(xe){const[Te,ue]=xe.split(":").map(Number);return Te*60+ue}let nt;function ke(xe,Te){clearTimeout(nt),nt=setTimeout(xe,Te)}async function De(){ke(async()=>{if(!(!e(g)||!e(L).startTime||!e(L).endTime||e(V).length===0)){d(Re,!1),d(Ze,[]),d(Je,"");try{const xe=e(V).map(async ht=>{const G=A.find(ct=>ct.id===ht)?.name.toLowerCase(),pe=new URLSearchParams({action:"check-conflicts",sectionId:e(g),dayOfWeek:G,startTime:e(L).startTime,endTime:e(L).endTime,schoolYear:M});e(L).teacherId&&e(L).scheduleType==="subject"&&pe.append("teacherId",e(L).teacherId);const Rt=await(await fetch(`/api/schedules?${pe}`)).json();return{day:G,dayDisplay:A.find(ct=>ct.id===ht)?.name,...Rt}}),Te=await Promise.all(xe),ue=[],bt=[];if(Te.forEach(ht=>{ht.hasConflicts&&(bt.push(ht.dayDisplay),ht.conflicts.forEach(G=>{ue.push({...G,day:ht.dayDisplay})}))}),ue.length>0){d(Re,!0),d(Ze,ue);const ht=ue.filter(pt=>pt.type==="teacher_conflict"),G=ue.filter(pt=>pt.type==="section_conflict");if(ht.length===1)Ae.error(ht[0].message,6e3);else if(ht.length>1){const pt=[...new Set(ht.map(ct=>ct.day))],Rt=ht[0].details?.teacher_name||"Selected teacher";Ae.error(`${Rt} has schedule conflicts on ${pt.join(", ")}. Please choose different times or another teacher.`,8e3)}if(G.length===1)Ae.error(G[0].message,6e3);else if(G.length>1){const pt=[...new Set(G.map(Rt=>Rt.day))];Ae.error(`Time conflicts detected for this section on ${pt.join(", ")}. Please choose different time slots.`,6e3)}let pe=[];ht.length>0&&pe.push(`Teacher conflicts detected on ${[...new Set(ht.map(pt=>pt.day))].join(", ")}`),G.length>0&&pe.push(`Section time conflicts detected on ${[...new Set(G.map(pt=>pt.day))].join(", ")}`),d(Je,pe.join(". "))}else d(Re,!1),d(Je,"")}catch(xe){console.error("Error checking conflicts:",xe),Ae.error("Error checking for conflicts. Please try again."),d(Re,!1)}finally{}}},500)}function Ie(xe){if(!xe)return 0;const[Te,ue]=xe.split(" "),[bt,ht]=Te.split(":").map(Number);let G=ht;return ue==="PM"&&bt!==12?G+=(bt+12)*60:ue==="AM"&&bt===12?G+=0:G+=bt*60,G}function Ee(xe){xe.target.closest(".scheduleassign-custom-dropdown")||(d(y,!1),d(b,!1),d(re,!1),d(Se,!1),d(me,!1),d(ze,!1)),xe.target.closest(".time-input-container")||(d(Xe,!1),d(tt,!1))}function ee(){d(y,!e(y))}function Ue(){e(m)&&d(b,!e(b))}function rt(xe){d(m,xe?xe.id:""),d(g,""),d(y,!1)}function Ye(xe){d(g,xe?xe.id:""),d(b,!1),d(X,[]),Ts(L,e(L).subjectId="")}function at(xe){if(!xe)return"";const Te=xe.split(":");let ue=parseInt(Te[0]);const bt=Te[1],ht=ue>=12?"PM":"AM";ue=ue%12,ue=ue||12;const G=bt.startsWith("0")&&bt!=="00"?bt.substring(1):bt;return G==="00"?`${ue}:00 ${ht}`:`${ue}:${G} ${ht}`}async function lt(){try{const Te=await(await fetch("/api/schedules")).json();Te.success?d(z,Te.data.map(ue=>({id:ue.id,year:`grade-${ue.grade_level}`,grade:`Grade ${ue.grade_level}`,section:ue.section_name,day:ue.day_of_week.charAt(0).toUpperCase()+ue.day_of_week.slice(1),time:`${at(ue.start_time)} - ${at(ue.end_time)}`,subject:ue.subject_name||ue.activity_type_name,teacher:ue.teacher_name,type:ue.schedule_type,startTime:at(ue.start_time),endTime:at(ue.end_time),subjectId:ue.subject_id,activityTypeId:ue.activity_type_id,teacherId:ue.teacher_id,sectionId:ue.section_id,schoolYear:ue.school_year,roomId:ue.room_id,roomName:ue.room_name,roomBuilding:ue.room_building,roomFloor:ue.room_floor}))):console.error("Failed to load schedules:",Te.error)}catch(xe){console.error("Error loading schedules:",xe)}}async function O(xe){ds.confirm("Delete Assignment","<p>Are you sure you want to delete this schedule assignment?</p>",async()=>{try{const Te=await da.delete(`/api/schedules?id=${xe.id}`);Te.success?(d(z,e(z).filter(ue=>ue.id!==xe.id)),d(z,[...e(z)]),setTimeout(()=>ae(),0),Ae.success(`Assignment for ${xe.subject} has been deleted successfully`)):Ae.error(Te.error||"Failed to delete assignment")}catch(Te){console.error("Error deleting assignment:",Te),Ae.error("Failed to delete assignment. Please try again.")}},()=>{})}function T(){d(R,!e(R)),e(R)||U()}function U(){d(V,[]),d(L,{startTime:"",endTime:"",scheduleType:"subject",subjectId:"",activityTypeId:"",teacherId:""})}function de(){d(re,!e(re))}function Pe(){d(Se,!e(Se))}function Ve(){d(me,!e(me))}function Me(){d(ze,!e(ze))}function q(){d(Xe,!0),d(tt,!1)}function B(){d(tt,!0),d(Xe,!1)}function N(xe){Ts(L,e(L).subjectId=xe.id),d(re,!1)}function Z(xe){Ts(L,e(L).activityTypeId=xe.id),d(Se,!1)}function be(xe){Ts(L,e(L).teacherId=xe.id),d(me,!1)}function Fe(xe){Ts(L,e(L).scheduleType=xe),d(ze,!1),xe==="subject"?Ts(L,e(L).activityTypeId=null):Ts(L,e(L).subjectId=null)}async function he(){if(!(e(X).length>0)){d(Le,!0);try{const xe=e(E).find(G=>G.id===e(g)),Te=xe?xe.grade_level:"",ue=Te?`/api/subjects?action=available-subjects&grade_level=${Te}`:"/api/subjects?action=available-subjects",ht=await(await fetch(ue)).json();ht.success&&d(X,ht.data)}catch(xe){console.error("Error loading subjects:",xe)}finally{d(Le,!1)}}}async function te(){if(!(e(ne).length>0)){d(fe,!0);try{const Te=await(await fetch("/api/activity-types?action=available-activity-types")).json();Te.success&&d(ne,Te.data)}catch(xe){console.error("Error loading activity types:",xe)}finally{d(fe,!1)}}}async function j(){if(!(e(ce).length>0)){d(se,!0);try{const Te=await(await fetch("/api/users?action=teachers")).json();Te.success&&d(ce,Te.data)}catch(xe){console.error("Error loading teachers:",xe)}finally{d(se,!1)}}}async function K(){if(!e(g)||e(V).length===0){Ae.error("Please select a section and at least one day");return}if(!e(L).startTime||!e(L).endTime){Ae.error("Please enter start and end times");return}if(e(L).scheduleType==="subject"&&!e(L).subjectId){Ae.error("Please select a subject");return}if(e(L).scheduleType==="activity"&&!e(L).activityTypeId){Ae.error("Please select an activity type");return}d(J,!0);try{const xe=e(V).map(async ht=>{const G=A.find(pe=>pe.id===ht)?.name.toLowerCase();try{return await da.post("/api/schedules",{sectionId:e(g),dayOfWeek:G,startTime:e(L).startTime,endTime:e(L).endTime,scheduleType:e(L).scheduleType,subjectId:e(L).scheduleType==="subject"?e(L).subjectId:null,activityTypeId:e(L).scheduleType==="activity"?e(L).activityTypeId:null,teacherId:e(L).teacherId||null,schoolYear:M})}catch(pe){return console.error("API Error:",pe),{success:!1,error:pe.message||"Failed to create schedule"}}}),Te=await Promise.all(xe),ue=Te.filter(ht=>!ht.success),bt=Te.filter(ht=>ht.success);if(bt.length>0&&await lt(),ue.length===0)Ae.success(`Schedule added successfully for ${e(V).length} day(s)`),U(),d(R,!1);else{bt.length>0&&Ae.success(`Schedule added successfully for ${bt.length} day(s)`);const ht=ue.filter(pe=>pe.conflictType==="teacher_conflict"),G=ue.filter(pe=>pe.conflictType!=="teacher_conflict");ht.length>0&&ht.forEach(pe=>{Ae.error(pe.error,8e3)}),G.length>0&&Ae.error(`Failed to add schedule for ${G.length} day(s) due to time conflicts`),ue.length>ht.length+G.length&&Ae.error(`Failed to add schedule for ${ue.length-ht.length-G.length} day(s)`)}}catch(xe){console.error("Error submitting schedule:",xe),Ae.error("Failed to add schedule. Please try again.")}finally{d(J,!1)}}Wa(async()=>{await I(),F(),lt()}),Qc(()=>{ae()});function ae(){if(!e(m)||!e(g))return;const xe=document.querySelectorAll(".scheduleassign-day-column");if(xe.length===0)return;let Te=0;xe.forEach(ue=>{const bt=ue.querySelector(".scheduleassign-day-schedules");if(bt){const ht=bt.scrollHeight;Te=Math.max(Te,ht)}}),xe.forEach(ue=>{const bt=ue.querySelector(".scheduleassign-empty-day"),ht=ue.querySelector(".scheduleassign-day-schedules");bt&&ht&&(ht.children.length>1||ht.children.length===1&&!ht.querySelector(".scheduleassign-empty-day")||(bt.style.minHeight=`${Te}px`))})}Jt(()=>e(L),()=>{e(L).startTime&&e(L).endTime?st():(d(ve,""),d($e,""))}),Jt(()=>(e(g),e(L),e(V)),()=>{e(g)&&e(L).startTime&&e(L).endTime&&e(V).length>0?De():(d(Je,""),d(Re,!1),d(Ze,[]))}),Jt(()=>(e(m),e(E)),()=>{d(a,e(m)?e(E).filter(xe=>xe.year===e(m)):[])}),Jt(()=>(e(a),e(D)),()=>{d(i,e(a).filter(xe=>xe.name.toLowerCase().includes(e(D).toLowerCase())||xe.grade.toLowerCase().includes(e(D).toLowerCase())))}),Jt(()=>e(m),()=>{d(r,k.find(xe=>xe.id===e(m)))}),Jt(()=>(e(E),e(g)),()=>{d(l,e(E).find(xe=>xe.id===e(g)))}),Jt(()=>(e(z),e(m),e(g),e(l)),()=>{d(c,A.reduce((xe,Te)=>(xe[Te.id]=e(z).filter(ue=>{if(!e(m)||!e(g))return!1;const bt=ue.year===e(m),ht=ue.section===e(l)?.name,G=ue.day===Te.name;return bt&&ht&&G}).sort((ue,bt)=>{const ht=Ie(ue.startTime),G=Ie(bt.startTime);return ht-G}),xe),{}))}),Jt(()=>e(m),()=>{d(u,!!e(m))}),Jt(()=>e(g),()=>{d(f,!!e(g))}),Jt(()=>e(R),()=>{e(R)&&(he(),te(),j())}),Ss(),vs();var Oe=ew();Q("click",Ys,Ee);var Be=v(o(Oe),2),Ke=o(Be),Ge=o(Ke),ot=o(Ge),gt=v(o(ot),2);let Yt;var ge=o(gt);let Qe;var Y=o(ge);{var le=xe=>{var Te=f2(),ue=v(o(Te),2),bt=o(ue),ht=o(bt,!0);n(bt),n(ue),n(Te),$(()=>w(ht,(e(r),x(()=>e(r).name)))),h(xe,Te)},Ce=xe=>{var Te=p2();h(xe,Te)};C(Y,xe=>{e(r)?xe(le):xe(Ce,!1)})}ia(2),n(ge);var et=v(ge,2);Tt(et,5,()=>k,xe=>xe.id,(xe,Te)=>{var ue=h2();let bt;var ht=v(o(ue),2),G=o(ht),pe=o(G,!0);n(G);var pt=v(G,2),Rt=o(pt,!0);n(pt),n(ht),n(ue),$(ct=>{bt=oe(ue,1,"scheduleassign-dropdown-item",null,bt,ct),w(pe,(e(Te),x(()=>e(Te).name))),w(Rt,(e(Te),x(()=>e(Te).description)))},[()=>({selected:e(m)===e(Te).id})]),Q("click",ue,()=>rt(e(Te))),h(xe,ue)}),n(et),n(gt),n(ot);var ft=v(ot,2),Dt=v(o(ft),2);let vt;var Qt=o(Dt);let He;var je=o(Qt);{var jt=xe=>{var Te=m2(),ue=v(o(Te),2),bt=o(ue),ht=o(bt);n(bt),n(ue),n(Te),$(()=>w(ht,`${e(l),x(()=>e(l).grade)??""}  ${e(l),x(()=>e(l).name)??""}`)),h(xe,Te)},aa=xe=>{var Te=g2(),ue=o(Te,!0);n(Te),$(()=>w(ue,e(m)?"Select section":"Select year level first")),h(xe,Te)};C(je,xe=>{e(l)?xe(jt):xe(aa,!1)})}ia(2),n(Qt);var St=v(Qt,2),xt=o(St),Pt=o(xt);sa(Pt),ia(2),n(xt);var ye=v(xt,2);{var H=xe=>{var Te=_2();h(xe,Te)},qe=xe=>{var Te=Et(),ue=ut(Te);{var bt=G=>{var pe=Et(),pt=ut(pe);Tt(pt,1,()=>e(i),Rt=>Rt.id,(Rt,ct)=>{var Xt=b2();let ga;var ba=v(o(Xt),2),_a=o(ba),ya=o(_a);n(_a);var ta=v(_a,2),yt=o(ta);n(ta),n(ba),n(Xt),$(Gt=>{ga=oe(Xt,1,"scheduleassign-dropdown-item",null,ga,Gt),w(ya,`${e(ct),x(()=>e(ct).grade)??""}  ${e(ct),x(()=>e(ct).name)??""}`),w(yt,`${e(ct),x(()=>e(ct).grade)??""} Section`)},[()=>({selected:e(g)===e(ct).id})]),Q("click",Xt,()=>Ye(e(ct))),h(Rt,Xt)}),h(G,pe)},ht=G=>{var pe=y2();h(G,pe)};C(ue,G=>{e(i),x(()=>e(i).length>0)?G(bt):G(ht,!1)},!0)}h(xe,Te)};C(ye,xe=>{e(S)?xe(H):xe(qe,!1)})}n(St),n(Dt),n(ft),n(Ge);var Ct=v(Ge,2);{var zt=xe=>{var Te=X2(),ue=o(Te),bt=o(ue),ht=o(bt);let G;var pe=o(ht),pt=o(pe,!0);n(pe);var Rt=v(pe);n(ht),n(bt),n(ue);var ct=v(ue,2);{var Xt=ba=>{var _a=G2(),ya=v(o(_a),2),ta=o(ya),yt=o(ta),Gt=v(o(yt),2),Lt=o(Gt);let Aa;var Kt=o(Lt);{var ca=it=>{var Mt=w2(),At=o(Mt),_t=o(At,!0);n(At);var Vt=v(At,2),Wt=o(Vt),Ft=o(Wt,!0);n(Wt),n(Vt),n(Mt),$(()=>{w(_t,(e(L),x(()=>e(L).scheduleType==="subject"?"book":"sports"))),w(Ft,(e(L),x(()=>e(L).scheduleType==="subject"?"Subject":"Activity")))}),h(it,Mt)},ra=it=>{var Mt=x2();h(it,Mt)};C(Kt,it=>{e(L),x(()=>e(L).scheduleType)?it(ca):it(ra,!1)})}ia(2),n(Lt);var Sa=v(Lt,2);let va;var ha=o(Sa);let Ot;var Pa=v(ha,2);let Oa;n(Sa),n(Gt),n(yt);var Ba=v(yt,2);{var ie=it=>{var Mt=T2(),At=v(o(Mt),2),_t=o(At);let Vt;var Wt=o(_t);{var Ft=Ht=>{const na=Ks(()=>(e(X),e(L),x(()=>e(X).find(Ja=>Ja.id===e(L).subjectId))));var pa=S2(),Na=v(o(pa),2),qa=o(Na),Ia=o(qa,!0);n(qa),n(Na),n(pa),$(()=>w(Ia,(xs(e(na)),x(()=>e(na)?.name)))),h(Ht,pa)},oa=Ht=>{var na=k2();h(Ht,na)};C(Wt,Ht=>{e(L),x(()=>e(L).subjectId)?Ht(Ft):Ht(oa,!1)})}ia(2),n(_t);var Ca=v(_t,2);let Ta;var Ha=o(Ca);{var ma=Ht=>{var na=D2();h(Ht,na)},Fa=Ht=>{var na=Et(),pa=ut(na);{var Na=Ia=>{var Ja=Et(),ks=ut(Ja);Tt(ks,1,()=>e(X),gs=>gs.id,(gs,rs)=>{var es=A2();let As;var qs=v(o(es),2),Rs=o(qs),ri=o(Rs,!0);n(Rs),n(qs),n(es),$(Us=>{As=oe(es,1,"scheduleassign-dropdown-option",null,As,Us),w(ri,(e(rs),x(()=>e(rs).name)))},[()=>({selected:e(L).subjectId===e(rs).id})]),Q("click",es,()=>N(e(rs))),h(gs,es)}),h(Ia,Ja)},qa=Ia=>{var Ja=C2();h(Ia,Ja)};C(pa,Ia=>{e(X),x(()=>e(X).length>0)?Ia(Na):Ia(qa,!1)},!0)}h(Ht,na)};C(Ha,Ht=>{e(Le)?Ht(ma):Ht(Fa,!1)})}n(Ca),n(At),n(Mt),$((Ht,na)=>{Vt=oe(_t,1,"scheduleassign-dropdown-trigger",null,Vt,Ht),_t.disabled=e(Le),Ta=oe(Ca,1,"scheduleassign-dropdown-menu",null,Ta,na)},[()=>({open:e(re),selected:e(L).subjectId}),()=>({open:e(re)})]),Q("click",_t,de),h(it,Mt)},Ne=it=>{var Mt=L2(),At=v(o(Mt),2),_t=o(At);let Vt;var Wt=o(_t);{var Ft=Ht=>{const na=Ks(()=>(e(ne),e(L),x(()=>e(ne).find(Ja=>Ja.id===e(L).activityTypeId))));var pa=M2(),Na=v(o(pa),2),qa=o(Na),Ia=o(qa,!0);n(qa),n(Na),n(pa),$(()=>w(Ia,(xs(e(na)),x(()=>e(na)?.name)))),h(Ht,pa)},oa=Ht=>{var na=P2();h(Ht,na)};C(Wt,Ht=>{e(L),x(()=>e(L).activityTypeId)?Ht(Ft):Ht(oa,!1)})}ia(2),n(_t);var Ca=v(_t,2);let Ta;var Ha=o(Ca);{var ma=Ht=>{var na=E2();h(Ht,na)},Fa=Ht=>{var na=Et(),pa=ut(na);{var Na=Ia=>{var Ja=Et(),ks=ut(Ja);Tt(ks,1,()=>e(ne),gs=>gs.id,(gs,rs)=>{var es=F2();let As;var qs=v(o(es),2),Rs=o(qs),ri=o(Rs,!0);n(Rs),n(qs),n(es),$(Us=>{As=oe(es,1,"scheduleassign-dropdown-option",null,As,Us),w(ri,(e(rs),x(()=>e(rs).name)))},[()=>({selected:e(L).activityTypeId===e(rs).id})]),Q("click",es,()=>Z(e(rs))),h(gs,es)}),h(Ia,Ja)},qa=Ia=>{var Ja=N2();h(Ia,Ja)};C(pa,Ia=>{e(ne),x(()=>e(ne).length>0)?Ia(Na):Ia(qa,!1)},!0)}h(Ht,na)};C(Ha,Ht=>{e(fe)?Ht(ma):Ht(Fa,!1)})}n(Ca),n(At),n(Mt),$((Ht,na)=>{Vt=oe(_t,1,"scheduleassign-dropdown-trigger",null,Vt,Ht),_t.disabled=e(fe),Ta=oe(Ca,1,"scheduleassign-dropdown-menu",null,Ta,na)},[()=>({open:e(Se),selected:e(L).activityTypeId}),()=>({open:e(Se)})]),Q("click",_t,Pe),h(it,Mt)};C(Ba,it=>{e(L),x(()=>e(L).scheduleType==="subject")?it(ie):it(Ne,!1)})}var mt=v(Ba,2);{var qt=it=>{var Mt=q2(),At=v(o(Mt),2),_t=o(At);let Vt;var Wt=o(_t);{var Ft=Ht=>{const na=Ks(()=>(e(ce),e(L),x(()=>e(ce).find(Ja=>Ja.id===e(L).teacherId))));var pa=$2(),Na=v(o(pa),2),qa=o(Na),Ia=o(qa);n(qa),n(Na),n(pa),$(()=>w(Ia,`${xs(e(na)),x(()=>e(na)?.first_name)??""} ${xs(e(na)),x(()=>e(na)?.last_name)??""}`)),h(Ht,pa)},oa=Ht=>{var na=j2();h(Ht,na)};C(Wt,Ht=>{e(L),x(()=>e(L).teacherId)?Ht(Ft):Ht(oa,!1)})}ia(2),n(_t);var Ca=v(_t,2);let Ta;var Ha=o(Ca);{var ma=Ht=>{var na=I2();h(Ht,na)},Fa=Ht=>{var na=Et(),pa=ut(na);{var Na=Ia=>{var Ja=Et(),ks=ut(Ja);Tt(ks,1,()=>e(ce),gs=>gs.id,(gs,rs)=>{var es=R2();let As;var qs=v(o(es),2),Rs=o(qs),ri=o(Rs);n(Rs),n(qs),n(es),$(Us=>{As=oe(es,1,"scheduleassign-dropdown-option",null,As,Us),w(ri,`${e(rs),x(()=>e(rs).first_name)??""} ${e(rs),x(()=>e(rs).last_name)??""}`)},[()=>({selected:e(L).teacherId===e(rs).id})]),Q("click",es,()=>be(e(rs))),h(gs,es)}),h(Ia,Ja)},qa=Ia=>{var Ja=O2();h(Ia,Ja)};C(pa,Ia=>{e(ce),x(()=>e(ce).length>0)?Ia(Na):Ia(qa,!1)},!0)}h(Ht,na)};C(Ha,Ht=>{e(se)?Ht(ma):Ht(Fa,!1)})}n(Ca),n(At),n(Mt),$((Ht,na)=>{Vt=oe(_t,1,"scheduleassign-dropdown-trigger",null,Vt,Ht),_t.disabled=e(se),Ta=oe(Ca,1,"scheduleassign-dropdown-menu",null,Ta,na)},[()=>({open:e(me),selected:e(L).teacherId}),()=>({open:e(me)})]),Q("click",_t,Ve),h(it,Mt)};C(mt,it=>{e(L),x(()=>e(L).scheduleType==="subject")&&it(qt)})}n(ta);var Ut=v(ta,2),Bt=o(Ut),wt=o(Bt),fa=o(wt);Hl(fa,{label:"Start Time",placeholder:"Select start time",get value(){return e(L).startTime},set value(it){Ts(L,e(L).startTime=it)},get isOpen(){return e(Xe)},set isOpen(it){d(Xe,it)},$$events:{change:it=>Ts(L,e(L).startTime=it.detail.value),open:q},$$legacy:!0}),n(wt);var It=v(wt,2),Zt=o(It);Hl(Zt,{label:"End Time",placeholder:"Select end time",get value(){return e(L).endTime},set value(it){Ts(L,e(L).endTime=it)},get isOpen(){return e(tt)},set isOpen(it){d(tt,it)},$$events:{change:it=>Ts(L,e(L).endTime=it.detail.value),open:B},$$legacy:!0}),n(It),n(Bt);var ea=v(Bt,2),Ma=o(ea);{var Ea=it=>{var Mt=Et(),At=ut(Mt);{var _t=Wt=>{var Ft=V2(),oa=v(o(Ft),2),Ca=o(oa,!0);n(oa),n(Ft),$(()=>w(Ca,e(ve))),h(Wt,Ft)},Vt=Wt=>{var Ft=Et(),oa=ut(Ft);{var Ca=Ta=>{var Ha=B2(),ma=v(o(Ha),2),Fa=o(ma);n(ma),n(Ha),$(()=>w(Fa,`Duration: ${e($e)??""}`)),h(Ta,Ha)};C(oa,Ta=>{e($e)&&Ta(Ca)},!0)}h(Wt,Ft)};C(At,Wt=>{e(ve)?Wt(_t):Wt(Vt,!1)})}h(it,Mt)};C(Ma,it=>{e(L),x(()=>e(L).startTime&&e(L).endTime)&&it(Ea)})}n(ea);var wa=v(ea,2),Da=o(wa);Tt(Da,5,()=>A,Ka,(it,Mt)=>{var At=z2(),_t=o(At);sa(_t);var Vt,Wt=v(_t,2),Ft=o(Wt,!0);n(Wt),n(At),$(()=>{Vt!==(Vt=(e(Mt),x(()=>e(Mt).id)))&&(_t.value=(_t.__value=(e(Mt),x(()=>e(Mt).id)))??""),w(Ft,(e(Mt),x(()=>e(Mt).name)))}),ad(p,[],_t,()=>(e(Mt),x(()=>e(Mt).id),e(V)),oa=>d(V,oa)),h(it,At)}),n(Da),n(wa),n(Ut),n(ya);var xa=v(ya,2),ja=o(xa);let Qa;var W=o(ja),_e=o(W,!0);n(W);var dt=v(W,2);{var Nt=it=>{var Mt=ka("Cannot Save - Conflicts Detected");h(it,Mt)},we=it=>{var Mt=Et(),At=ut(Mt);{var _t=Wt=>{var Ft=ka("Saving...");h(Wt,Ft)},Vt=Wt=>{var Ft=ka("Save Schedule");h(Wt,Ft)};C(At,Wt=>{e(J)?Wt(_t):Wt(Vt,!1)},!0)}h(it,Mt)};C(dt,it=>{e(Re)?it(Nt):it(we,!1)})}n(ja),n(xa),n(_a),$((it,Mt,At,_t,Vt)=>{Aa=oe(Lt,1,"scheduleassign-dropdown-trigger",null,Aa,it),va=oe(Sa,1,"scheduleassign-dropdown-menu",null,va,Mt),Ot=oe(ha,1,"scheduleassign-dropdown-option",null,Ot,At),Oa=oe(Pa,1,"scheduleassign-dropdown-option",null,Oa,_t),Qa=oe(ja,1,"scheduleassign-save-schedule-btn",null,Qa,Vt),ja.disabled=(e(J),e(V),e(Re),e(ve),x(()=>e(J)||e(V).length===0||e(Re)||e(ve))),w(_e,e(Re)?"block":"save")},[()=>({open:e(ze),selected:e(L).scheduleType}),()=>({open:e(ze)}),()=>({selected:e(L).scheduleType==="subject"}),()=>({selected:e(L).scheduleType==="activity"}),()=>({"has-conflicts":e(Re)})]),Q("click",Lt,Me),Q("click",ha,()=>Fe("subject")),Q("click",Pa,()=>Fe("activity")),Q("click",ja,K),h(ba,_a)};C(ct,ba=>{e(R)&&ba(Xt)})}var ga=v(ct,2);Tt(ga,5,()=>A,ba=>ba.id,(ba,_a)=>{var ya=K2(),ta=o(ya),yt=o(ta),Gt=o(yt,!0);n(yt),n(ta);var Lt=v(ta,2),Aa=o(Lt);{var Kt=ra=>{var Sa=Et(),va=ut(Sa);Tt(va,1,()=>(e(c),e(_a),x(()=>e(c)[e(_a).id])),ha=>ha.id,(ha,Ot)=>{var Pa=Q2(),Oa=o(Pa),Ba=o(Oa),ie=o(Ba),Ne=o(ie,!0);n(ie);var mt=v(ie,2),qt=o(mt);n(mt),n(Ba);var Ut=v(Ba,2),Bt=o(Ut);n(Ut),n(Oa);var wt=v(Oa,2),fa=o(wt);{var It=wa=>{var Da=W2(),xa=v(o(Da),2),ja=o(xa,!0);n(xa),n(Da),$(()=>w(ja,(e(Ot),x(()=>e(Ot).teacher)))),h(wa,Da)};C(fa,wa=>{e(Ot),x(()=>e(Ot).teacher)&&wa(It)})}var Zt=v(fa,2);{var ea=wa=>{var Da=H2(),xa=v(o(Da),2),ja=o(xa);n(xa),n(Da),$(()=>w(ja,`${e(Ot),x(()=>e(Ot).startTime)??""} - ${e(Ot),x(()=>e(Ot).endTime)??""}`)),h(wa,Da)};C(Zt,wa=>{e(Ot),x(()=>e(Ot).startTime&&e(Ot).endTime)&&wa(ea)})}var Ma=v(Zt,2);{var Ea=wa=>{var Da=U2(),xa=v(o(Da),2),ja=o(xa),Qa=v(ja);{var W=_e=>{var dt=Y2(),Nt=o(dt);n(dt),$(()=>w(Nt,`(${e(Ot),x(()=>e(Ot).roomBuilding)??""}${e(Ot),x(()=>e(Ot).roomFloor?`, Floor ${e(Ot).roomFloor}`:"")??""})`)),h(_e,dt)};C(Qa,_e=>{e(Ot),x(()=>e(Ot).roomBuilding||e(Ot).roomFloor)&&_e(W)})}n(xa),n(Da),$(()=>w(ja,`${e(Ot),x(()=>e(Ot).roomName)??""} `)),h(wa,Da)};C(Ma,wa=>{e(Ot),x(()=>e(Ot).type==="subject"&&e(Ot).roomName)&&wa(Ea)})}n(wt),n(Pa),$(()=>{w(Ne,(e(Ot),x(()=>e(Ot).subject))),w(qt,`${e(Ot),x(()=>e(Ot).grade)??""} - ${e(Ot),x(()=>e(Ot).section)??""}`)}),Q("click",Bt,()=>O(e(Ot))),h(ha,Pa)}),h(ra,Sa)},ca=ra=>{var Sa=J2();h(ra,Sa)};C(Aa,ra=>{e(c),e(_a),x(()=>e(c)[e(_a).id]&&e(c)[e(_a).id].length>0)?ra(Kt):ra(ca,!1)})}n(Lt),n(ya),$(()=>w(Gt,(e(_a),x(()=>e(_a).name)))),h(ba,ya)}),n(ga),n(Te),$(ba=>{G=oe(ht,1,"scheduleassign-add-schedule-card",null,G,ba),w(pt,e(R)?"close":"add"),w(Rt,` ${e(R)?"Cancel Schedule":"Add Schedule"}`)},[()=>({"cancel-mode":e(R)})]),Q("click",ht,T),h(xe,Te)},ua=xe=>{var Te=Z2();h(xe,Te)};C(Ct,xe=>{e(m)&&e(g)?xe(zt):xe(ua,!1)})}n(Ke),n(Be),n(Oe),$((xe,Te,ue,bt)=>{Yt=oe(gt,1,"scheduleassign-custom-dropdown",null,Yt,xe),Qe=oe(ge,1,"scheduleassign-dropdown-button",null,Qe,Te),vt=oe(Dt,1,"scheduleassign-custom-dropdown",null,vt,ue),He=oe(Qt,1,"scheduleassign-dropdown-button",null,He,bt),Qt.disabled=!e(m)},[()=>({open:e(y)}),()=>({selected:e(m)}),()=>({open:e(b),disabled:!e(m)}),()=>({selected:e(g),disabled:!e(m)})]),Q("click",ge,ee),Q("click",Qt,Ue),la(Pt,()=>e(D),xe=>d(D,xe)),h(s,Oe),Ga()}const Hi="roomManagementData",qr="availableSectionsData",Yl=300*1e3;function aw(){const{subscribe:s,set:t,update:a}=vi({rooms:[],availableSections:[],isLoading:!1,error:null,lastUpdated:null});return{subscribe:s,init:i=>{i&&i.rooms&&t({rooms:i.rooms,availableSections:i.availableSections||[],isLoading:!1,error:null,lastUpdated:i.lastUpdated})},setLoading:i=>{a(r=>({...r,isLoading:i,error:i?null:r.error}))},updateRooms:i=>{const r=Date.now(),l={rooms:i,lastUpdated:r,isLoading:!1,error:null};a(c=>({...c,...l}));try{localStorage.setItem(Hi,JSON.stringify({rooms:i,lastUpdated:r}))}catch(c){console.warn("Failed to cache rooms data:",c)}},updateSections:i=>{const r=Date.now();a(l=>({...l,availableSections:i,lastUpdated:r}));try{localStorage.setItem(qr,JSON.stringify({sections:i,lastUpdated:r}))}catch(l){console.warn("Failed to cache sections data:",l)}},setError:i=>{a(r=>({...r,error:i,isLoading:!1}))},getCachedData:()=>{try{const i=localStorage.getItem(Hi),r=localStorage.getItem(qr);if(!i)return null;const l=JSON.parse(i),c=r?JSON.parse(r):{sections:[]},u=Date.now(),f=u-(l.lastUpdated||0),p=u-(c.lastUpdated||0);return f<Yl?{rooms:l.rooms||[],availableSections:p<Yl?c.sections||[]:[],lastUpdated:l.lastUpdated}:null}catch(i){return console.warn("Failed to retrieve cached room data:",i),null}},clearCache:()=>{try{localStorage.removeItem(Hi),localStorage.removeItem(qr)}catch(i){console.warn("Failed to clear room cache:",i)}},addRoom:i=>{a(r=>{const l=[i,...r.rooms];try{localStorage.setItem(Hi,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after adding room:",c)}return{...r,rooms:l}})},removeRoom:i=>{a(r=>{const l=r.rooms.filter(c=>c.id!==i);try{localStorage.setItem(Hi,JSON.stringify({rooms:l,lastUpdated:Date.now()}))}catch(c){console.warn("Failed to update cache after removing room:",c)}return{...r,rooms:l}})},updateRoom:(i,r)=>{a(l=>{const c=l.rooms.map(u=>u.id===i?{...u,...r}:u);try{localStorage.setItem(Hi,JSON.stringify({rooms:c,lastUpdated:Date.now()}))}catch(u){console.warn("Failed to update cache after updating room:",u)}return{...l,rooms:c}})}}}const ai=aw();var sw=_('<span class="material-symbols-outlined">add_ad</span> Create Room',1),iw=_('<button type="button" class="adminroom-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),nw=_('<div class="admin-room-loading"><span class="room-loader"></span> <p>Loading rooms...</p></div>'),rw=_("<p>No rooms found. Create your first room using the form above.</p>"),ow=_("<p>No rooms found matching your search.</p>"),lw=_('<div class="admin-room-empty-state"><span class="material-symbols-outlined">meeting_room</span> <!></div>'),cw=_('<button type="button" class="admin-room-unassign-button" title="Unassign Room"><span class="material-symbols-outlined">remove_circle</span></button>'),dw=_('<a><button type="button" class="admin-room-assign-button"><span class="material-symbols-outlined"> </span></button></a>'),uw=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">group</span> <span> </span></div>'),vw=_('<div class="admin-room-room-assignment"><span class="material-symbols-outlined">check_circle</span> <span>Available</span></div>'),fw=_('<div class="admin-room-room-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),pw=_('<div class="admin-room-edit-form-section"><div class="admin-room-edit-form-container"><div class="admin-room-edit-form-header"><h2 class="admin-room-edit-form-title">Edit Room</h2> <p class="admin-room-edit-form-subtitle">Update room information</p></div> <form class="admin-room-edit-form-content"><div class="admin-room-edit-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-room-name">Room Name *</label> <input type="text" id="edit-room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-building">Building *</label> <input type="text" id="edit-building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="edit-floor">Floor *</label> <input type="text" id="edit-floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-edit-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-update-button"><!></button></div></form></div></div>'),hw=_('<div class="selected-option"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></div>'),mw=_('<span class="placeholder">Select a section</span>'),gw=_('<button type="button"><span class="material-symbols-outlined option-icon">group</span> <div class="option-content"><span class="option-name"> </span> <span class="option-description"> </span></div></button>'),_w=_('<div class="admin-room-assign-form-section"><div class="admin-room-assign-form-container"><div class="admin-room-assign-form-header"><h2 class="admin-room-assign-form-title">Assign Room</h2> <p class="admin-room-assign-form-subtitle">Select a section to assign this room to</p></div> <form class="admin-room-assign-form-content"><div class="admin-room-assign-info-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="assign-section-select">Select Section *</label> <div><button type="button" id="assign-section-select"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div> <div class="admin-room-assign-form-actions"><button type="button" class="admin-room-cancel-button">Cancel</button> <button type="submit" class="admin-room-assign-submit-button"><!></button></div></form></div></div>'),bw=_('<div><div class="admin-room-room-header"><div class="admin-room-room-title"><h3 class="admin-room-room-name"> </h3></div> <div class="admin-room-action-buttons"><!> <a><button type="button" class="admin-room-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="admin-room-remove-button" title="Remove Room"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="admin-room-room-details"><div class="admin-room-room-location"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <!> <div class="admin-room-room-created"><span class="material-symbols-outlined">schedule</span> <span> </span></div> <!></div> <!> <!></div>'),yw=_('<div class="admin-room-rooms-grid"></div>'),ww=_('<div class="admin-room-creation-form-container"><div class="admin-room-creation-form-section"><div class="admin-room-section-header"><h2 class="admin-room-section-title">Create New Room</h2> <p class="admin-room-section-subtitle">Fill in the details below to create a new room</p></div> <div class="admin-room-form-container"><form><div class="admin-room-form-row"><div class="admin-room-form-group"><label class="admin-room-form-label" for="room-name">Room Name *</label> <input type="text" id="room-name" class="admin-room-form-input" placeholder="Enter room name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="building">Building *</label> <input type="text" id="building" class="admin-room-form-input" placeholder="Enter building name" required/></div> <div class="admin-room-form-group"><label class="admin-room-form-label" for="floor">Floor *</label> <input type="text" id="floor" class="admin-room-form-input" placeholder="e.g., 1st Floor" required/></div></div> <div class="admin-room-form-actions"><button type="submit" class="admin-room-create-button"><!></button></div></form></div></div> <div class="admin-room-rooms-list-section"><div class="admin-room-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-room-section-title">All Rooms</h2> <p class="admin-room-section-subtitle">All rooms in the system</p></div> <div class="adminroom-filters-container"><div class="adminroom-search-container"><div class="adminroom-search-input-wrapper"><span class="material-symbols-outlined adminroom-search-icon">search</span> <input type="text" placeholder="Search by room name, building, or floor..." class="adminroom-search-input"/> <!></div></div></div></div></div> <!></div></div>');function xw(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(ai,"$roomManagementStore",a),l=P(),c=P(),u=P(),f=P(),p=P();let m=P(!1),g=P(""),y=P(""),b=P(""),D=P(""),S=P(null),k=P(""),A=P(""),E=P(""),M=P(!1),I=P(null),F=P(""),z=P(!1),R=P(!1);async function J(N=!1){try{N||ai.setLoading(!0);const Z=await da.get("/api/rooms");if(Z.success)ai.updateRooms(Z.data||[]);else throw new Error(Z.message||"Failed to load rooms")}catch(Z){console.error("Error loading rooms:",Z),ai.setError("Failed to load rooms. Please try again."),Ae.error("Failed to load rooms. Please try again.")}}async function V(N=!1){try{const Z=await da.get("/api/sections?action=available-sections");if(Z.success)ai.updateSections(Z.data||[]);else throw new Error(Z.message||"Failed to load sections")}catch(Z){console.error("Error loading sections:",Z),N||Ae.error("Failed to load sections. Please try again.")}}const L=N=>{ds.confirm("Remove Room",`Are you sure you want to remove room ${N.name}? This action cannot be undone.`,async()=>{try{const Z=await da.delete("/api/rooms",{id:N.id});if(Z.success)ai.removeRoom(N.id),Ae.success(Z.message);else throw new Error(Z.message||"Failed to remove room")}catch(Z){console.error("Error removing room:",Z),Ae.error("Failed to remove room. Please try again.")}},()=>{})};async function X(){if(!e(y)||!e(b)||!e(D)){Ae.warning("Please fill in all required fields.");return}d(m,!0);try{const N=await da.post("/api/rooms",{name:e(y),building:e(b),floor:e(D)});if(N.success)ai.addRoom(N.data),Ae.success(N.message),Le();else throw new Error(N.message||"Failed to create room")}catch(N){console.error("Error creating room:",N),Ae.error("Failed to create room. Please try again.")}finally{d(m,!1)}}async function ne(N){const Z=e(l).find(be=>be.id===N);Z&&ds.confirm("Unassign Room",`Are you sure you want to unassign room "${Z.name}"? This will remove all section assignments from this room.`,async()=>{await ce(N)},()=>{})}async function ce(N){try{if(!e(l).find(Fe=>Fe.id===N))return;const be=await da.patch("/api/rooms",{roomId:N,action:"unassign"});if(be.success)await J(),await V(),Ae.success(be.message);else throw new Error(be.message||"Failed to unassign room")}catch(Z){console.error("Error unassigning room:",Z),Ae.error("Failed to unassign room. Please try again.")}}function Le(){d(y,""),d(b,""),d(D,"")}function fe(N){N.target.closest(".custom-dropdown")||d(R,!1)}function se(N){e(S)===N.id?(d(S,null),d(k,""),d(A,""),d(E,"")):(e(I)===N.id&&(d(I,null),d(F,""),d(R,!1)),d(S,N.id),d(k,N.name),d(A,N.building),d(E,N.floor))}async function re(){if(!e(k)||!e(A)||!e(E)){Ae.warning("Please fill in all required fields.");return}d(M,!0);try{const N=e(l).find(be=>be.id===e(S)),Z=await da.put("/api/rooms",{id:e(S),name:e(k),building:e(A),floor:e(E),status:N.status,assignedTo:N.assignedTo});if(Z.success)ai.updateRoom(e(S),Z.data),Ae.success(Z.message),d(S,null),d(k,""),d(A,""),d(E,"");else throw new Error(Z.message||"Failed to update room")}catch(N){console.error("Error updating room:",N),Ae.error("Failed to update room. Please try again.")}finally{d(M,!1)}}function Se(N){e(I)===N.id?(d(I,null),d(F,""),d(R,!1)):(e(S)===N.id&&(d(S,null),d(k,""),d(A,""),d(E,"")),d(I,N.id),d(F,""),d(R,!1))}function me(){d(R,!e(R))}function ze(N){d(F,N.id||N._id?.toString()),d(R,!1)}async function Xe(){if(!e(F)){Ae.warning("Please select a section.");return}d(z,!0);try{const N=await da.patch("/api/rooms",{roomId:e(I),sectionIds:[e(F)],action:"assign"});if(N.success)await J(),await V(),Ae.success(N.message),d(I,null),d(F,"");else throw new Error(N.message||"Failed to assign room")}catch(N){console.error("Error assigning room:",N),Ae.error("Failed to assign room. Please try again.")}finally{d(z,!1)}}Wa(()=>{const N=ai.getCachedData();N&&ai.init(N),J(!!N),V(!!N);const Z=setInterval(()=>{J(!0),V(!0)},3e4);return()=>{clearInterval(Z)}}),Jt(()=>(e(l),e(c),e(u),e(f),r()),()=>{(N=>{d(l,N.rooms),d(c,N.availableSections),d(u,N.isLoading),d(f,N.error)})(r())}),Jt(()=>(e(l),e(g)),()=>{d(p,e(l).filter(N=>N.name.toLowerCase().includes(e(g).toLowerCase())||N.building.toLowerCase().includes(e(g).toLowerCase())||N.floor.toLowerCase().includes(e(g).toLowerCase())))}),Ss(),vs();var tt=ww();Q("click",Ys,fe);var ve=o(tt),$e=v(o(ve),2),Je=o($e),Re=o(Je),Ze=o(Re),st=v(o(Ze),2);sa(st),n(Ze);var We=v(Ze,2),nt=v(o(We),2);sa(nt),n(We);var ke=v(We,2),De=v(o(ke),2);sa(De),n(ke),n(Re);var Ie=v(Re,2),Ee=o(Ie),ee=o(Ee);{var Ue=N=>{var Z=ka("Creating...");h(N,Z)},rt=N=>{var Z=sw();ia(),h(N,Z)};C(ee,N=>{e(m)?N(Ue):N(rt,!1)})}n(Ee),n(Ie),n(Je),n($e),n(ve);var Ye=v(ve,2),at=o(Ye),lt=o(at),O=v(o(lt),2),T=o(O),U=o(T),de=v(o(U),2);sa(de);var Pe=v(de,2);{var Ve=N=>{var Z=iw();Q("click",Z,()=>d(g,"")),h(N,Z)};C(Pe,N=>{e(g)&&N(Ve)})}n(U),n(T),n(O),n(lt),n(at);var Me=v(at,2);{var q=N=>{var Z=nw();h(N,Z)},B=N=>{var Z=Et(),be=ut(Z);{var Fe=te=>{var j=lw(),K=v(o(j),2);{var ae=Be=>{var Ke=rw();h(Be,Ke)},Oe=Be=>{var Ke=ow();h(Be,Ke)};C(K,Be=>{e(l),x(()=>e(l).length===0)?Be(ae):Be(Oe,!1)})}n(j),h(te,j)},he=te=>{var j=yw();Tt(j,5,()=>e(p),K=>K.id,(K,ae)=>{var Oe=bw();let Be;var Ke=o(Oe),Ge=o(Ke),ot=o(Ge),gt=o(ot,!0);n(ot),n(Ge);var Yt=v(Ge,2),ge=o(Yt);{var Qe=Te=>{var ue=cw();Q("click",ue,()=>ne(e(ae).id)),h(Te,ue)},Y=Te=>{var ue=dw(),bt=o(ue),ht=o(bt),G=o(ht,!0);n(ht),n(bt),n(ue),$(()=>{$t(ue,"href",`#admin-room-room-card-${e(ae),x(()=>e(ae).id)??""}`),$t(bt,"title",(e(I),e(ae),x(()=>e(I)===e(ae).id?"Cancel Assign":"Assign Room"))),w(G,(e(I),e(ae),x(()=>e(I)===e(ae).id?"close":"add_circle")))}),Q("click",bt,()=>Se(e(ae))),h(Te,ue)};C(ge,Te=>{e(ae),x(()=>e(ae).assignedSections&&e(ae).assignedSections.length>0)?Te(Qe):Te(Y,!1)})}var le=v(ge,2),Ce=o(le),et=o(Ce),ft=o(et,!0);n(et),n(Ce),n(le);var Dt=v(le,2);n(Yt),n(Ke);var vt=v(Ke,2),Qt=o(vt),He=v(o(Qt),2),je=o(He);n(He),n(Qt);var jt=v(Qt,2);{var aa=Te=>{var ue=uw(),bt=v(o(ue),2),ht=o(bt);n(bt),n(ue),$(G=>w(ht,`Assigned to: ${G??""}`),[()=>(e(ae),x(()=>e(ae).assignedSections.map(G=>G.name).join(", ")))]),h(Te,ue)},St=Te=>{var ue=vw();h(Te,ue)};C(jt,Te=>{e(ae),x(()=>e(ae).assignedSections&&e(ae).assignedSections.length>0)?Te(aa):Te(St,!1)})}var xt=v(jt,2),Pt=v(o(xt),2),ye=o(Pt);n(Pt),n(xt);var H=v(xt,2);{var qe=Te=>{var ue=fw(),bt=v(o(ue),2),ht=o(bt);n(bt),n(ue),$(()=>w(ht,`Updated: ${e(ae),x(()=>e(ae).updatedDate)??""}`)),h(Te,ue)};C(H,Te=>{e(ae),x(()=>e(ae).updatedDate&&e(ae).updatedDate!==e(ae).createdDate)&&Te(qe)})}n(vt);var Ct=v(vt,2);{var zt=Te=>{var ue=pw(),bt=o(ue),ht=v(o(bt),2),G=o(ht),pe=o(G),pt=v(o(pe),2);sa(pt),n(pe);var Rt=v(pe,2),ct=v(o(Rt),2);sa(ct),n(Rt);var Xt=v(Rt,2),ga=v(o(Xt),2);sa(ga),n(Xt),n(G);var ba=v(G,2),_a=o(ba),ya=v(_a,2),ta=o(ya);{var yt=Lt=>{var Aa=ka("Updating...");h(Lt,Aa)},Gt=Lt=>{var Aa=ka("Update");h(Lt,Aa)};C(ta,Lt=>{e(M)?Lt(yt):Lt(Gt,!1)})}n(ya),n(ba),n(ht),n(bt),n(ue),$(()=>ya.disabled=e(M)||!e(k)||!e(A)||!e(E)),la(pt,()=>e(k),Lt=>d(k,Lt)),la(ct,()=>e(A),Lt=>d(A,Lt)),la(ga,()=>e(E),Lt=>d(E,Lt)),Q("click",_a,()=>se(e(ae))),Q("submit",ht,Os(re)),h(Te,ue)};C(Ct,Te=>{e(S),e(ae),x(()=>e(S)===e(ae).id)&&Te(zt)})}var ua=v(Ct,2);{var xe=Te=>{var ue=_w(),bt=o(ue),ht=v(o(bt),2),G=o(ht),pe=o(G),pt=v(o(pe),2);let Rt;var ct=o(pt);let Xt;var ga=o(ct);{var ba=ca=>{const ra=Ks(()=>(e(c),e(F),x(()=>e(c).find(Ot=>(Ot.id||Ot._id?.toString())===e(F)))));var Sa=Et(),va=ut(Sa);{var ha=Ot=>{var Pa=hw(),Oa=v(o(Pa),2),Ba=o(Oa),ie=o(Ba,!0);n(Ba);var Ne=v(Ba,2),mt=o(Ne);n(Ne),n(Oa),n(Pa),$(()=>{w(ie,(xs(e(ra)),x(()=>e(ra).name))),w(mt,`Grade ${xs(e(ra)),x(()=>e(ra).grade_level)??""} Section`)}),h(Ot,Pa)};C(va,Ot=>{e(ra)&&Ot(ha)})}h(ca,Sa)},_a=ca=>{var ra=mw();h(ca,ra)};C(ga,ca=>{e(F)?ca(ba):ca(_a,!1)})}ia(2),n(ct);var ya=v(ct,2);Tt(ya,5,()=>e(c),ca=>ca.id||ca._id,(ca,ra)=>{var Sa=gw();let va;var ha=v(o(Sa),2),Ot=o(ha),Pa=o(Ot,!0);n(Ot);var Oa=v(Ot,2),Ba=o(Oa);n(Oa),n(ha),n(Sa),$(ie=>{va=oe(Sa,1,"dropdown-option",null,va,ie),w(Pa,(e(ra),x(()=>e(ra).name))),w(Ba,`Grade ${e(ra),x(()=>e(ra).grade_level)??""} Section`)},[()=>({selected:e(F)===(e(ra).id||e(ra)._id?.toString())})]),Q("click",Sa,Ti(()=>ze(e(ra)))),h(ca,Sa)}),n(ya),n(pt),n(pe),n(G);var ta=v(G,2),yt=o(ta),Gt=v(yt,2),Lt=o(Gt);{var Aa=ca=>{var ra=ka("Assigning");h(ca,ra)},Kt=ca=>{var ra=ka("Assign");h(ca,ra)};C(Lt,ca=>{e(z)?ca(Aa):ca(Kt,!1)})}n(Gt),n(ta),n(ht),n(bt),n(ue),$((ca,ra)=>{Rt=oe(pt,1,"custom-dropdown",null,Rt,ca),Xt=oe(ct,1,"dropdown-trigger",null,Xt,ra),Gt.disabled=e(z)||!e(F)},[()=>({open:e(R)}),()=>({selected:e(F)})]),Q("click",ct,Ti(me)),Q("click",yt,()=>Se(e(ae))),Q("submit",ht,Os(Xe)),h(Te,ue)};C(ua,Te=>{e(I),e(ae),x(()=>e(I)===e(ae).id)&&Te(xe)})}n(Oe),$(Te=>{Be=oe(Oe,1,"admin-room-room-card",null,Be,Te),$t(Oe,"id",`admin-room-room-card-${e(ae),x(()=>e(ae).id)??""}`),w(gt,(e(ae),x(()=>e(ae).name))),$t(le,"href",`#admin-room-room-card-${e(ae),x(()=>e(ae).id)??""}`),$t(Ce,"title",(e(S),e(ae),x(()=>e(S)===e(ae).id?"Cancel Edit":"Edit Room"))),w(ft,(e(S),e(ae),x(()=>e(S)===e(ae).id?"close":"edit"))),w(je,`${e(ae),x(()=>e(ae).building)??""}, ${e(ae),x(()=>e(ae).floor)??""}`),w(ye,`Created: ${e(ae),x(()=>e(ae).createdDate)??""}`)},[()=>({editing:e(S)===e(ae).id,assigning:e(I)===e(ae).id})]),Q("click",Ce,()=>se(e(ae))),Q("click",Dt,()=>L(e(ae))),h(K,Oe)}),n(j),h(te,j)};C(be,te=>{e(p),x(()=>e(p).length===0)?te(Fe):te(he,!1)},!0)}h(N,Z)};C(Me,N=>{e(u)?N(q):N(B,!1)})}n(Ye),n(tt),$(()=>Ee.disabled=e(m)||!e(y)||!e(b)||!e(D)),la(st,()=>e(y),N=>d(y,N)),la(nt,()=>e(b),N=>d(b,N)),la(De,()=>e(D),N=>d(D,N)),Q("submit",Je,Os(X)),la(de,()=>e(g),N=>d(g,N)),h(s,tt),Ga(),i()}const mn="sectionsCache",Sw=180*1e3,Bs=(()=>{const s=vi([]),t=vi(!1),a=vi(null),i=()=>{try{const D=localStorage.getItem(mn);if(!D)return null;const S=JSON.parse(D);return Date.now()-S.timestamp>Sw?(localStorage.removeItem(mn),null):S.sections}catch(D){return console.error("Error reading sections cache:",D),localStorage.removeItem(mn),null}},r=D=>{try{const S={sections:D,timestamp:Date.now()};localStorage.setItem(mn,JSON.stringify(S))}catch(S){console.error("Error setting sections cache:",S)}},l=()=>{try{localStorage.removeItem(mn)}catch(D){console.error("Error clearing sections cache:",D)}},c=()=>{const D=i();return D?(s.set(D),!0):!1},u=(D,S=!1)=>{s.set(D),a.set(null),S||t.set(!1),r(D)},f=(D,S=!1)=>{S||t.set(D)},p=D=>{a.set(D),t.set(!1)},m=async(D=!1,S="")=>{try{f(!0,D);let k="/api/sections";S&&S.trim()&&(k+=`?search=${encodeURIComponent(S.trim())}`);const A=await fetch(k);if(!A.ok)throw new Error(`HTTP error! status: ${A.status}`);const E=await A.json();if(!E.success||!E.data)throw new Error("Invalid API response structure");const M=E.data.map(I=>({...I,students:I.students||[],adviser:I.adviser||null}));u(M,D)}catch(k){console.error("Error loading sections:",k),p(k.message)}finally{f(!1,!1)}},g=D=>{s.update(S=>{const k=[...S,D];return r(k),k})},y=(D,S)=>{s.update(k=>{const A=k.map(E=>E.id===D?{...E,...S}:E);return r(A),A})},b=D=>{s.update(S=>{const k=S.filter(A=>A.id!==D);return r(k),k})};return{sections:{subscribe:s.subscribe},isLoadingSections:{subscribe:t.subscribe},sectionsError:{subscribe:a.subscribe},initSections:c,loadSections:m,updateSections:u,setLoadingSections:f,setSectionsError:p,addSection:g,updateSection:y,removeSection:b,clearSectionsCache:l}})();var kw=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Dw=_('<span class="sectionmgmt-placeholder">Select grade level</span>'),Aw=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Cw=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Tw=_('<span class="sectionmgmt-placeholder">Select advisory teacher</span>'),Mw=_('<span class="sectionmgmt-placeholder">Select grade level first</span>'),Pw=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading teachers...</p></div>'),Ew=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available teachers found</span></div>'),Fw=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Nw=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),Lw=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading students...</p></div>'),$w=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found for this grade level</span></div>'),jw=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <div class="sectionmgmt-student-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),Iw=_('<div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="students"/> <!></div> <div class="sectionmgmt-student-list"><!></div>',1),Rw=_('<div class="sectionmgmt-placeholder-message"><span class="material-symbols-outlined">info</span> <span>Please select a grade level first to view available students.</span></div>'),Ow=_('<span class="material-symbols-outlined">groups</span> Create Section',1),qw=_('<button type="button" class="adminform-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),Vw=_('<div class="adminform-selected-option"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></div>'),Bw=_('<span class="adminform-placeholder">Filter by grade</span>'),zw=_('<button type="button"><span class="material-symbols-outlined adminform-option-icon"> </span> <div class="adminform-option-content"><span class="adminform-option-name"> </span></div></button>'),Gw=_('<div class="admin-section-loading"><span class="section-loader"></span> <p>Loading sections...</p></div>'),Ww=_('<div class="sectionmgmt-section-updated"><span class="material-symbols-outlined">update</span> <span> </span></div>'),Hw=_('<div class="sectionmgmt-selected-option"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span></div></div>'),Yw=_('<span class="sectionmgmt-placeholder">Select section adviser</span>'),Uw=_('<button type="button"><span class="material-symbols-outlined sectionmgmt-option-icon">person</span> <div class="sectionmgmt-option-content"><span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div></button>'),Qw=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available advisers found</span></div>'),Jw=_('<button type="button" class="sectionmgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),Kw=_('<button type="button"><div class="sectionmgmt-option-content"><span class="material-symbols-outlined sectionmgmt-option-icon">school</span> <span class="sectionmgmt-option-name"> </span> <span class="sectionmgmt-option-description"> </span></div> <span class="material-symbols-outlined sectionmgmt-option-icon"> </span></button>'),Xw=_('<div class="sectionmgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No available students found</span></div>'),Zw=_('<div class="sectionmgmt-edit-form-section"><div class="sectionmgmt-edit-form-container" id="section-edit-form-container"><div class="sectionmgmt-edit-form-header"><h2 class="sectionmgmt-edit-form-title">Edit Section</h2> <p class="sectionmgmt-edit-form-subtitle">Update section information and manage students</p></div> <form class="sectionmgmt-edit-form-content"><div class="sectionmgmt-edit-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-name">Section Name</label> <input type="text" id="edit-section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-section-adviser">Section Adviser</label> <div><button type="button" id="edit-section-adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search advisers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!> <!></div></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="edit-students"> </label> <div class="sectionmgmt-student-controls"><input type="text" class="sectionmgmt-form-input" placeholder="Search students by name or ID..." id="edit-students"/> <!></div> <div class="sectionmgmt-student-list"><!> <!></div></div> <div class="sectionmgmt-edit-form-actions"><button type="button" class="sectionmgmt-cancel-button">Cancel</button> <button type="submit" class="sectionmgmt-submit-button"><!></button></div></form></div></div>'),e0=_('<div><div class="sectionmgmt-section-header-card"><div class="sectionmgmt-section-title"><h3 class="sectionmgmt-section-name"> </h3></div> <div class="sectionmgmt-action-buttons"><a><button type="button" class="sectionmgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="sectionmgmt-remove-button" title="Remove Section"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="sectionmgmt-section-details"><div class="sectionmgmt-section-adviser"><span class="material-symbols-outlined">person_book</span> <span> </span></div> <div class="sectionmgmt-section-students"><span class="material-symbols-outlined">group</span> <span> </span></div> <div class="sectionmgmt-section-room"><span class="material-symbols-outlined">location_on</span> <span> </span></div> <div class="sectionmgmt-section-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <!></div> <!></div>'),t0=_("<p>No sections found</p>"),a0=_("<p>No sections found matching your search.</p>"),s0=_('<div class="sectionmgmt-sections-empty"><span class="material-symbols-outlined">school</span> <!></div>'),i0=_("<!> <!>",1),n0=_(`<div class="sectionmgmt-form-container"><div class="sectionmgmt-creation-form-section"><div class="sectionmgmt-section-header"><h2 class="sectionmgmt-section-title">Create New Section</h2> <p class="sectionmgmt-section-subtitle">Fill in the details below to create a new class section</p></div> <div class="sectionmgmt-form-container"><form><div class="sectionmgmt-basic-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="section-name">Section Name *</label> <input type="text" id="section-name" class="sectionmgmt-form-input" placeholder="Enter section name (e.g., Mabini, Rizal, Bonifacio)" required/></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="school-year">School Year</label> <input type="text" id="school-year" class="sectionmgmt-form-input" readonly=""/></div></div> <div class="sectionmgmt-create-info-row"><div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"></div></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="adviser">Advisory Teacher (Optional)</label> <div><button type="button" id="adviser"><!> <span class="material-symbols-outlined sectionmgmt-dropdown-arrow">expand_more</span></button> <div class="sectionmgmt-dropdown-menu"><div class="sectionmgmt-search-container"><input type="text" class="sectionmgmt-search-input" placeholder="Search teachers..."/> <span class="material-symbols-outlined sectionmgmt-search-icon">search</span></div> <!></div></div> <p class="sectionmgmt-form-help">Only teachers without assigned sections are shown. Each teacher can only advise one
							section.</p></div></div> <div class="sectionmgmt-form-group"><label class="sectionmgmt-form-label" for="students">Students (Optional)</label> <!></div> <div class="sectionmgmt-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="sectionmgmt-recent-sections-section"><div class="sectionmgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="sectionmgmt-section-title">All Sections</h2> <p class="sectionmgmt-section-subtitle">All sections in the system</p></div> <div class="adminform-search-filter-container"><div class="adminform-search-container"><div class="adminform-search-input-wrapper"><span class="material-symbols-outlined adminform-search-icon">search</span> <input type="text" placeholder="Search by section name, grade level, student account number, or student name..." class="adminform-search-input"/> <!></div></div> <div class="adminform-filter-container"><div><button type="button"><!> <span class="material-symbols-outlined adminform-dropdown-arrow">expand_more</span></button> <div class="adminform-dropdown-menu"></div></div></div></div></div></div> <div class="sectionmgmt-sections-grid"><!></div></div></div>`);function r0(s,t){za(t,!1);const[a,i]=Ds(),r=()=>ps(e(u),"$isLoadingSections",a),l=()=>ps(e(c),"$sections",a),c=P(),u=P(),f=P(),p=P(),m=P(),g=P(),y=P(),b=P(),D=P(),S=P(),k=P(),A=P();let E=P(!1),M=P(""),I=P(""),F=P(""),z=P(null),R=P([]),J=P(!1),V=P(!1),L=P(!1),X=P(""),ne=P(""),ce=P(""),Le,fe=P("all"),se=P(null),re=P(""),Se=P(null),me=P([]),ze=P(!1),Xe=P(!1),tt=P(""),ve=P(""),$e=P([]),Je=P([]),Re=P(!1),Ze=P(!1);async function st(){try{const Ne=await(await fetch("/api/current-quarter")).json();Ne.success&&Ne.data?.currentSchoolYear&&d(F,Ne.data.currentSchoolYear)}catch(ie){console.error("Error fetching current school year:",ie)}}Wa(async()=>{await st();const ie=Bs.initSections();await Bs.loadSections(ie),await We()});async function We(ie=null){try{d(Re,!0);const Ne=ie?`&teacherGradeLevel=${ie}`:"",mt=await da.get(`/api/sections?action=available-teachers&schoolYear=${e(F)}${Ne}`);if(mt.success&&(d($e,mt.data.map(qt=>{const Ut=e(m)&&e(m).length>0?e(m).some(Bt=>Bt.adviser_id===qt.id):!1;return{id:qt.id,name:qt.full_name,employeeId:qt.account_number,subject:qt.subject_code||"No Subject",subject_grade_level:qt.subject_grade_level,hasSection:Ut}})),e(m)&&e(m).length>0))for(const qt of e(m))qt.adviser_id&&!e($e).find(Ut=>Ut.id===qt.adviser_id)&&e($e).push({id:qt.adviser_id,name:qt.adviser_name,employeeId:qt.adviser_account_number||"N/A",subject:qt.adviser_subject||"No Subject",subject_grade_level:qt.grade_level,hasSection:!0})}catch(Ne){console.error("Error loading teachers:",Ne),Ae.error("Failed to load available teachers")}finally{d(Re,!1)}}async function nt(ie){try{d(Ze,!0);const Ne=await da.get(`/api/sections?action=available-students&gradeLevel=${ie}&schoolYear=${e(F)}`);Ne.success&&d(Je,Ne.data.map(mt=>({id:mt.id,name:mt.full_name,studentId:mt.account_number,grade:mt.grade_level,hasSection:!1})))}catch(Ne){console.error("Error loading students:",Ne),Ae.error("Failed to load available students")}finally{d(Ze,!1)}}async function ke(ie){try{const Ne=await da.get(`/api/sections?action=section-students&sectionId=${ie}`);return Ne.success?Ne.data.map(mt=>({id:mt.id,name:mt.full_name,studentId:mt.account_number,grade:mt.grade_level})):[]}catch(Ne){return console.error("Error loading section students:",Ne),[]}}function De(ie){e(me).findIndex(mt=>mt.id===ie.id)>-1?d(me,e(me).filter(mt=>mt.id!==ie.id)):d(me,[...e(me),ie])}function Ie(){if(e(me).length===e(A).length&&e(A).every(ie=>e(me).some(Ne=>Ne.id===ie.id)))d(me,e(me).filter(ie=>!e(A).some(Ne=>Ne.id===ie.id)));else{const ie=e(A).filter(Ne=>!e(me).some(mt=>mt.id===Ne.id));d(me,[...e(me),...ie])}}const Ee=[{id:"7",name:"Grade 7",description:"First Year Junior High School"},{id:"8",name:"Grade 8",description:"Second Year Junior High School"},{id:"9",name:"Grade 9",description:"Third Year Junior High School"},{id:"10",name:"Grade 10",description:"Fourth Year Junior High School"}],ee=[{id:"all",name:"All Sections",icon:"group"},{id:"7",name:"Grade 7",icon:"school"},{id:"8",name:"Grade 8",icon:"school"},{id:"9",name:"Grade 9",icon:"school"},{id:"10",name:"Grade 10",icon:"school"}];function Ue(){d(J,!e(J)),d(V,!1)}function rt(){d(V,!e(V)),d(J,!1)}function Ye(){d(L,!e(L))}function at(ie){d(I,ie.id),d(J,!1),d(R,[]),nt(ie.id),We(ie.id)}function lt(ie){d(z,ie),d(V,!1),d(X,"")}function O(ie){d(fe,ie.id),d(L,!1)}function T(ie){e(R).findIndex(mt=>mt.id===ie.id)>-1?d(R,e(R).filter(mt=>mt.id!==ie.id)):d(R,[...e(R),ie])}function U(){if(e(R).length===e(D).length&&e(D).every(ie=>e(R).some(Ne=>Ne.id===ie.id)))d(R,e(R).filter(ie=>!e(D).some(Ne=>Ne.id===ie.id)));else{const ie=e(D).filter(Ne=>!e(R).some(mt=>mt.id===Ne.id));d(R,[...e(R),...ie])}}function de(){clearTimeout(Le),Le=setTimeout(async()=>{await Bs.loadSections(!1,e(ce))},500)}function Pe(){d(ce,""),Bs.loadSections(!1,"")}async function Ve(){if(!e(M)||!e(I)){Ae.error("Please fill in section name and grade level.");return}d(E,!0);try{const ie=await da.post("/api/sections",{sectionName:e(M),gradeLevel:parseInt(e(I)),schoolYear:e(F),adviserId:e(z)?.id||null,studentIds:e(R).map(Ne=>Ne.id),roomId:null});ie.success?(Ae.success(ie.message),d(M,""),d(I,""),d(z,null),d(R,[]),d(X,""),d(ne,""),d(Je,[]),Bs.addSection(ie.data),await We()):Ae.error(ie.error||"Failed to create section")}catch(ie){console.error("Error creating section:",ie),Ae.error("Failed to create section. Please try again.")}finally{d(E,!1)}}async function Me(ie){e(se)===ie.id?(d(se,null),d(re,""),d(Se,null),d(me,[]),d(tt,""),d(ve,""),d(Xe,!1)):(d(se,ie.id),d(re,ie.name),d(Se,e($e).find(Ne=>Ne.id===ie.adviser_id)),!e(Se)&&ie.adviser_id&&(d(Se,{id:ie.adviser_id,name:"Loading...",employeeId:"",subject:"",hasSection:!0}),await We(ie.grade_level),d(Se,e($e).find(Ne=>Ne.id===ie.adviser_id)||e(Se))),d(me,await ke(ie.id)),d(Fe,[...e(me)]),d(ve,""),await nt(ie.grade_level))}async function q(){if(!e(re)){Ae.error("Please fill in section name.");return}d(ze,!0);try{const ie={sectionId:e(se),sectionName:e(re),adviserId:e(Se)?.id||null,studentIds:e(me).map(mt=>mt.id||mt._id),roomId:null},Ne=await da.put("/api/sections",ie);Ne.success?(Ae.success(Ne.message),d(se,null),d(re,""),d(Se,null),d(me,[]),d(tt,""),d(ve,""),d(Xe,!1),Bs.updateSection(e(se),Ne.data),await Bs.loadSections(!0),await We()):Ae.error(Ne.error||"Failed to update section")}catch(ie){console.error("Error updating section:",ie),Ae.error("Failed to update section. Please try again.")}finally{d(ze,!1)}}function B(){d(Xe,!e(Xe))}async function N(ie){const Ne=ie.id;d(Se,ie),d(Xe,!1),d(tt,""),await We(),d(Se,e($e).find(mt=>mt.id===Ne)||ie)}function Z(ie){ds.confirm("Delete Section",`<p>Are you sure you want to permanently delete section <strong>"${ie.name}"</strong> (Grade ${ie.grade_level})?</p>
			<p class="sectionmgmt-warning">This action will:</p>
			<ul class="sectionmgmt-warning-list">
				<li>Permanently delete the section and all its data</li>
				<li>Remove all students from this section</li>
				<li>Free up the advisory teacher for other sections</li>
				<li>This action cannot be undone</li>
			</ul>`,()=>be(ie),null,{size:"medium"})}async function be(ie){try{const Ne=await da.delete(`/api/sections?sectionId=${ie._id}`);Ne.success?(Ae.success("Section deleted successfully"),Bs.removeSection(ie._id)):Ae.error(Ne.error||"Failed to delete section")}catch(Ne){console.error("Error deleting section:",Ne),Ae.error("An error occurred while deleting the section")}}let Fe=P([]);Jt(()=>(e(c),e(u),e(f),Bs),()=>{Co(d(c,Bs.sections),"$sections",a),Co(d(u,Bs.isLoadingSections),"$isLoadingSections",a),d(f,Bs.sectionsError)}),Jt(()=>r(),()=>{d(p,r())}),Jt(()=>l(),()=>{d(m,l())}),Jt(()=>e(ce),()=>{e(ce)!==void 0&&de()}),Jt(()=>e(I),()=>{d(g,Ee.find(ie=>ie.id===e(I)))}),Jt(()=>e(fe),()=>{d(y,ee.find(ie=>ie.id===e(fe)))}),Jt(()=>(e($e),e(X)),()=>{d(b,e($e).filter(ie=>!ie.hasSection&&ie.name.toLowerCase().includes(e(X).toLowerCase())))}),Jt(()=>(e(I),e(R),e(z)),()=>{e(I)&&(d(R,e(R).filter(ie=>ie.grade===e(I))),e(z)&&e(z).subject_grade_level&&e(z).subject_grade_level!==parseInt(e(I))&&d(z,null))}),Jt(()=>(e(Je),e(I),e(ne),e(R)),()=>{d(D,e(Je).filter(ie=>{const Ne=ie.grade===e(I),mt=ie.name.toLowerCase().includes(e(ne).toLowerCase()),qt=!ie.hasSection,Ut=!e(R).some(Bt=>Bt.id===ie.id);return Ne&&mt&&(qt||!Ut)}).sort((ie,Ne)=>{const mt=e(R).some(Ut=>Ut.id===ie.id),qt=e(R).some(Ut=>Ut.id===Ne.id);return mt&&!qt?-1:!mt&&qt?1:ie.name.localeCompare(Ne.name)}))}),Jt(()=>e(m),()=>{d(S,e(m))}),Jt(()=>(e($e),e(se),e(m),e(tt)),()=>{d(k,e($e).filter(ie=>{const Ne=e(se)&&e(m).find(wt=>wt.id===e(se))?.adviser_id,mt=!ie.hasSection||ie.id===Ne,Ut=(e(se)&&e(m).find(wt=>wt.id===e(se)))?.grade_level,Bt=!Ut||!ie.subject_grade_level||ie.subject_grade_level===Ut;return mt&&Bt&&ie.name.toLowerCase().includes(e(tt).toLowerCase())}))}),Jt(()=>(e(m),e(se),e(Je),e(Fe),e(ve),e(me)),()=>{d(A,(()=>{e(m).find(Ne=>Ne.id===e(se));const ie=[...e(Je)];return e(Fe).forEach(Ne=>{ie.some(mt=>mt.id===Ne.id)||ie.push({...Ne,hasSection:!0})}),ie.filter(Ne=>{const mt=Ne.name.toLowerCase().includes(e(ve).toLowerCase()),qt=e(me).some(wt=>wt.id===Ne.id),Ut=e(Fe).some(wt=>wt.id===Ne.id),Bt=!Ne.hasSection||qt||Ut;return mt&&Bt}).sort((Ne,mt)=>{const qt=e(me).some(Bt=>Bt.id===Ne.id),Ut=e(me).some(Bt=>Bt.id===mt.id);return qt&&!Ut?-1:!qt&&Ut?1:Ne.name.localeCompare(mt.name)})})())}),Ss(),vs();var he=n0(),te=o(he),j=v(o(te),2),K=o(j),ae=o(K),Oe=o(ae),Be=v(o(Oe),2);sa(Be),n(Oe);var Ke=v(Oe,2),Ge=v(o(Ke),2);sa(Ge),n(Ke),n(ae);var ot=v(ae,2),gt=o(ot),Yt=v(o(gt),2);let ge;var Qe=o(Yt);let Y;var le=o(Qe);{var Ce=ie=>{var Ne=kw(),mt=v(o(Ne),2),qt=o(mt),Ut=o(qt,!0);n(qt),n(mt),n(Ne),$(()=>w(Ut,(e(g),x(()=>e(g).name)))),h(ie,Ne)},et=ie=>{var Ne=Dw();h(ie,Ne)};C(le,ie=>{e(g)?ie(Ce):ie(et,!1)})}ia(2),n(Qe);var ft=v(Qe,2);Tt(ft,5,()=>Ee,ie=>ie.id,(ie,Ne)=>{var mt=Aw();let qt;var Ut=v(o(mt),2),Bt=o(Ut),wt=o(Bt,!0);n(Bt);var fa=v(Bt,2),It=o(fa,!0);n(fa),n(Ut),n(mt),$(Zt=>{qt=oe(mt,1,"sectionmgmt-dropdown-option",null,qt,Zt),w(wt,(e(Ne),x(()=>e(Ne).name))),w(It,(e(Ne),x(()=>e(Ne).description)))},[()=>({selected:e(I)===e(Ne).id})]),Q("click",mt,()=>at(e(Ne))),h(ie,mt)}),n(ft),n(Yt),n(gt);var Dt=v(gt,2),vt=v(o(Dt),2);let Qt;var He=o(vt);let je;var jt=o(He);{var aa=ie=>{var Ne=Cw(),mt=v(o(Ne),2),qt=o(mt),Ut=o(qt,!0);n(qt),n(mt),n(Ne),$(()=>w(Ut,(e(z),x(()=>e(z).name)))),h(ie,Ne)},St=ie=>{var Ne=Et(),mt=ut(Ne);{var qt=Bt=>{var wt=Tw();h(Bt,wt)},Ut=Bt=>{var wt=Mw();h(Bt,wt)};C(mt,Bt=>{e(I)?Bt(qt):Bt(Ut,!1)},!0)}h(ie,Ne)};C(jt,ie=>{e(z)?ie(aa):ie(St,!1)})}ia(2),n(He);var xt=v(He,2),Pt=o(xt),ye=o(Pt);sa(ye),ia(2),n(Pt);var H=v(Pt,2);{var qe=ie=>{var Ne=Pw();h(ie,Ne)},Ct=ie=>{var Ne=Et(),mt=ut(Ne);{var qt=Bt=>{var wt=Ew();h(Bt,wt)},Ut=Bt=>{var wt=Et(),fa=ut(wt);Tt(fa,1,()=>e(b),It=>It.id,(It,Zt)=>{var ea=Fw();let Ma;var Ea=v(o(ea),2),wa=o(Ea),Da=o(wa,!0);n(wa);var xa=v(wa,2),ja=o(xa,!0);n(xa),n(Ea),n(ea),$(Qa=>{Ma=oe(ea,1,"sectionmgmt-dropdown-option",null,Ma,Qa),w(Da,(e(Zt),x(()=>e(Zt).name))),w(ja,(e(Zt),x(()=>e(Zt).employeeId)))},[()=>({selected:e(z)?.id===e(Zt).id})]),Q("click",ea,()=>lt(e(Zt))),h(It,ea)}),h(Bt,wt)};C(mt,Bt=>{e(b),x(()=>e(b).length===0)?Bt(qt):Bt(Ut,!1)},!0)}h(ie,Ne)};C(H,ie=>{e(Re)?ie(qe):ie(Ct,!1)})}n(xt),n(vt),ia(2),n(Dt),n(ot);var zt=v(ot,2),ua=v(o(zt),2);{var xe=ie=>{var Ne=Iw(),mt=ut(Ne),qt=o(mt);sa(qt);var Ut=v(qt,2);{var Bt=ea=>{const Ma=Ks(()=>(e(D),e(R),x(()=>e(D).every(xa=>e(R).some(ja=>ja.id===xa.id)))));var Ea=Nw(),wa=o(Ea),Da=o(wa,!0);n(wa),n(Ea),$(()=>{$t(Ea,"title",`${e(Ma)?"Deselect All":"Select All"} (${e(D),x(()=>e(D).length)??""})`),w(Da,e(Ma)?"deselect":"select_all")}),Q("click",Ea,U),h(ea,Ea)};C(Ut,ea=>{e(D),x(()=>e(D).length>0)&&ea(Bt)})}n(mt);var wt=v(mt,2),fa=o(wt);{var It=ea=>{var Ma=Lw();h(ea,Ma)},Zt=ea=>{var Ma=Et(),Ea=ut(Ma);{var wa=xa=>{var ja=$w();h(xa,ja)},Da=xa=>{var ja=Et(),Qa=ut(ja);Tt(Qa,1,()=>e(D),W=>W.id,(W,_e)=>{var dt=jw();let Nt;var we=o(dt),it=v(o(we),2),Mt=o(it);n(it);var At=v(it,2),_t=o(At);n(At),n(we);var Vt=v(we,2),Wt=o(Vt),Ft=o(Wt,!0);n(Wt),n(Vt),n(dt),$((oa,Ca)=>{Nt=oe(dt,1,"sectionmgmt-student-item",null,Nt,oa),w(Mt,`Grade ${e(_e),x(()=>e(_e).grade)??""} |`),w(_t,`${e(_e),x(()=>e(_e).name)??""}  ${e(_e),x(()=>e(_e).studentId)??""}`),w(Ft,Ca)},[()=>({selected:e(R).some(oa=>oa.id===e(_e).id)}),()=>(e(R),e(_e),x(()=>e(R).some(oa=>oa.id===e(_e).id)?"check_box":"check_box_outline_blank"))]),Q("click",dt,()=>T(e(_e))),h(W,dt)}),h(xa,ja)};C(Ea,xa=>{e(D),x(()=>e(D).length===0)?xa(wa):xa(Da,!1)},!0)}h(ea,Ma)};C(fa,ea=>{e(Ze)?ea(It):ea(Zt,!1)})}n(wt),la(qt,()=>e(ne),ea=>d(ne,ea)),h(ie,Ne)},Te=ie=>{var Ne=Rw();h(ie,Ne)};C(ua,ie=>{e(I)?ie(xe):ie(Te,!1)})}n(zt);var ue=v(zt,2),bt=o(ue);let ht;var G=o(bt);{var pe=ie=>{var Ne=ka("Creating...");h(ie,Ne)},pt=ie=>{var Ne=Ow();ia(),h(ie,Ne)};C(G,ie=>{e(E)?ie(pe):ie(pt,!1)})}n(bt),n(ue),n(K),n(j),n(te);var Rt=v(te,2),ct=o(Rt),Xt=o(ct),ga=v(o(Xt),2),ba=o(ga),_a=o(ba),ya=v(o(_a),2);sa(ya);var ta=v(ya,2);{var yt=ie=>{var Ne=qw();Q("click",Ne,Pe),h(ie,Ne)};C(ta,ie=>{e(ce)&&ie(yt)})}n(_a),n(ba);var Gt=v(ba,2),Lt=o(Gt);let Aa;var Kt=o(Lt);let ca;var ra=o(Kt);{var Sa=ie=>{var Ne=Vw(),mt=o(Ne),qt=o(mt,!0);n(mt);var Ut=v(mt,2),Bt=o(Ut),wt=o(Bt,!0);n(Bt),n(Ut),n(Ne),$(()=>{w(qt,(e(y),x(()=>e(y).icon))),w(wt,(e(y),x(()=>e(y).name)))}),h(ie,Ne)},va=ie=>{var Ne=Bw();h(ie,Ne)};C(ra,ie=>{e(y)?ie(Sa):ie(va,!1)})}ia(2),n(Kt);var ha=v(Kt,2);Tt(ha,5,()=>ee,ie=>ie.id,(ie,Ne)=>{var mt=zw();let qt;var Ut=o(mt),Bt=o(Ut,!0);n(Ut);var wt=v(Ut,2),fa=o(wt),It=o(fa,!0);n(fa),n(wt),n(mt),$(Zt=>{qt=oe(mt,1,"adminform-dropdown-option",null,qt,Zt),w(Bt,(e(Ne),x(()=>e(Ne).icon))),w(It,(e(Ne),x(()=>e(Ne).name)))},[()=>({selected:e(fe)===e(Ne).id})]),Q("click",mt,()=>O(e(Ne))),h(ie,mt)}),n(ha),n(Lt),n(Gt),n(ga),n(Xt),n(ct);var Ot=v(ct,2),Pa=o(Ot);{var Oa=ie=>{var Ne=Gw();h(ie,Ne)},Ba=ie=>{var Ne=i0(),mt=ut(Ne);Tt(mt,1,()=>e(S),Bt=>Bt.id,(Bt,wt)=>{var fa=e0();let It;var Zt=o(fa),ea=o(Zt),Ma=o(ea),Ea=o(Ma);n(Ma),n(ea);var wa=v(ea,2),Da=o(wa),xa=o(Da),ja=o(xa),Qa=o(ja,!0);n(ja),n(xa),n(Da);var W=v(Da,2);n(wa),n(Zt);var _e=v(Zt,2),dt=o(_e),Nt=v(o(dt),2),we=o(Nt,!0);n(Nt),n(dt);var it=v(dt,2),Mt=v(o(it),2),At=o(Mt);n(Mt),n(it);var _t=v(it,2),Vt=v(o(_t),2),Wt=o(Vt,!0);n(Vt),n(_t);var Ft=v(_t,2),oa=v(o(Ft),2),Ca=o(oa);n(oa),n(Ft);var Ta=v(Ft,2);{var Ha=Ht=>{var na=Ww(),pa=v(o(na),2),Na=o(pa);n(pa),n(na),$(qa=>w(Na,`Updated: ${qa??""}`),[()=>(e(wt),x(()=>new Date(e(wt).updated_at).toLocaleDateString()))]),h(Ht,na)};C(Ta,Ht=>{e(wt),x(()=>e(wt).updated_at&&e(wt).updated_at!==e(wt).created_at)&&Ht(Ha)})}n(_e);var ma=v(_e,2);{var Fa=Ht=>{var na=Zw(),pa=o(na),Na=v(o(pa),2),qa=o(Na),Ia=o(qa),Ja=v(o(Ia),2);sa(Ja),n(Ia);var ks=v(Ia,2),gs=v(o(ks),2);let rs;var es=o(gs);let As;var qs=o(es);{var Rs=$a=>{var Va=Hw(),us=v(o(Va),2),Fs=o(us),Es=o(Fs,!0);n(Fs),n(us),n(Va),$(()=>w(Es,(e(Se),x(()=>e(Se).name)))),h($a,Va)},ri=$a=>{var Va=Yw();h($a,Va)};C(qs,$a=>{e(Se)?$a(Rs):$a(ri,!1)})}ia(2),n(es);var Us=v(es,2),en=o(Us),Li=o(en);sa(Li),ia(2),n(en);var tn=v(en,2);Tt(tn,1,()=>e(k),$a=>$a.id,($a,Va)=>{var us=Uw();let Fs;var Es=v(o(us),2),Qs=o(Es),Zs=o(Qs,!0);n(Qs);var fi=v(Qs,2),rn=o(fi,!0);n(fi),n(Es),n(us),$(qi=>{Fs=oe(us,1,"sectionmgmt-dropdown-option",null,Fs,qi),w(Zs,(e(Va),x(()=>e(Va).name))),w(rn,(e(Va),x(()=>e(Va).employeeId)))},[()=>({selected:e(Se)?.id===e(Va).id})]),Q("click",us,()=>N(e(Va))),h($a,us)});var mr=v(tn,2);{var En=$a=>{var Va=Qw();h($a,Va)};C(mr,$a=>{e(k),x(()=>e(k).length===0)&&$a(En)})}n(Us),n(gs),n(ks),n(qa);var $i=v(qa,2),an=o($i),gr=o(an);n(an);var sn=v(an,2),ts=o(sn);sa(ts);var os=v(ts,2);{var _s=$a=>{const Va=Ks(()=>(e(A),e(me),x(()=>e(A).every(Qs=>e(me).some(Zs=>Zs.id===Qs.id)))));var us=Jw(),Fs=o(us),Es=o(Fs,!0);n(Fs),n(us),$(()=>{$t(us,"title",`${e(Va)?"Deselect All":"Select All"} (${e(A),x(()=>e(A).length)??""})`),w(Es,e(Va)?"deselect":"select_all")}),Q("click",us,Ie),h($a,us)};C(os,$a=>{e(A),x(()=>e(A).length>0)&&$a(_s)})}n(sn);var Cs=v(sn,2),ji=o(Cs);Tt(ji,1,()=>e(A),$a=>$a.id,($a,Va)=>{var us=Kw();let Fs;var Es=o(us),Qs=v(o(Es),2),Zs=o(Qs,!0);n(Qs);var fi=v(Qs,2),rn=o(fi);n(fi),n(Es);var qi=v(Es,2),_r=o(qi,!0);n(qi),n(us),$((Xa,ei)=>{Fs=oe(us,1,"sectionmgmt-student-item",null,Fs,Xa),w(Zs,(e(Va),x(()=>e(Va).name))),w(rn,`${e(Va),x(()=>e(Va).studentId)??""}  Grade ${e(Va),x(()=>e(Va).grade)??""}`),w(_r,ei)},[()=>({selected:e(me).some(Xa=>Xa.id===e(Va).id)}),()=>(e(me),e(Va),x(()=>e(me).some(Xa=>Xa.id===e(Va).id)?"check_box":"check_box_outline_blank"))]),Q("click",us,()=>De(e(Va))),h($a,us)});var nn=v(ji,2);{var Fn=$a=>{var Va=Xw();h($a,Va)};C(nn,$a=>{e(A),x(()=>e(A).length===0)&&$a(Fn)})}n(Cs),n($i);var wi=v($i,2),Ii=o(wi),Ri=v(Ii,2),Oi=o(Ri);{var Nn=$a=>{var Va=ka("Updating...");h($a,Va)},Ln=$a=>{var Va=ka("Update");h($a,Va)};C(Oi,$a=>{e(ze)?$a(Nn):$a(Ln,!1)})}n(Ri),n(wi),n(Na),n(pa),n(na),$(($a,Va)=>{rs=oe(gs,1,"sectionmgmt-custom-dropdown",null,rs,$a),As=oe(es,1,"sectionmgmt-dropdown-trigger",null,As,Va),w(gr,`Students (${e(me),x(()=>e(me).length)??""} selected)`),Ri.disabled=e(ze)||!e(re)},[()=>({open:e(Xe)}),()=>({selected:e(Se)})]),la(Ja,()=>e(re),$a=>d(re,$a)),Q("click",es,B),la(Li,()=>e(tt),$a=>d(tt,$a)),la(ts,()=>e(ve),$a=>d(ve,$a)),Q("click",Ii,()=>Me(e(wt))),Q("submit",Na,Os(q)),h(Ht,na)};C(ma,Ht=>{e(se),e(wt),x(()=>e(se)===e(wt).id)&&Ht(Fa)})}n(fa),$((Ht,na)=>{It=oe(fa,1,"sectionmgmt-section-card",null,It,Ht),$t(fa,"id",`sectionmgmt-section-card-${e(wt),x(()=>e(wt).id)??""}`),w(Ea,`${e(wt),x(()=>e(wt).name)??""}  Grade ${e(wt),x(()=>e(wt).grade_level)??""}`),$t(Da,"href",`#sectionmgmt-section-card-${e(wt),x(()=>e(wt).id)??""}`),$t(xa,"title",(e(se),e(wt),x(()=>e(se)===e(wt).id?"Cancel Edit":"Edit Section"))),w(Qa,(e(se),e(wt),x(()=>e(se)===e(wt).id?"close":"edit"))),w(we,(e(wt),x(()=>e(wt).adviser_name||"No adviser"))),w(At,`${e(wt),x(()=>e(wt).student_count)??""} students`),w(Wt,(e(wt),x(()=>e(wt).room_name?`${e(wt).room_name} (${e(wt).room_building}, ${e(wt).room_floor})`:"No room assigned"))),w(Ca,`Created: ${na??""}`)},[()=>({editing:e(se)===e(wt).id}),()=>(e(wt),x(()=>new Date(e(wt).created_at).toLocaleDateString()))]),Q("click",xa,()=>Me(e(wt))),Q("click",W,()=>Z(e(wt))),h(Bt,fa)});var qt=v(mt,2);{var Ut=Bt=>{var wt=s0(),fa=v(o(wt),2);{var It=ea=>{var Ma=t0();h(ea,Ma)},Zt=ea=>{var Ma=a0();h(ea,Ma)};C(fa,ea=>{e(m),x(()=>e(m).length===0)?ea(It):ea(Zt,!1)})}n(wt),h(Bt,wt)};C(qt,Bt=>{e(S),x(()=>e(S).length===0)&&Bt(Ut)})}h(ie,Ne)};C(Pa,ie=>{e(p)?ie(Oa):ie(Ba,!1)})}n(Ot),n(Rt),n(he),$((ie,Ne,mt,qt,Ut,Bt,wt)=>{ge=oe(Yt,1,"sectionmgmt-custom-dropdown",null,ge,ie),Y=oe(Qe,1,"sectionmgmt-dropdown-trigger",null,Y,Ne),Qt=oe(vt,1,"sectionmgmt-custom-dropdown",null,Qt,mt),je=oe(He,1,"sectionmgmt-dropdown-trigger",null,je,qt),He.disabled=!e(I),ht=oe(bt,1,"sectionmgmt-create-button",null,ht,Ut),bt.disabled=e(E)||!e(M)||!e(I),Aa=oe(Lt,1,"adminform-custom-dropdown",null,Aa,Bt),ca=oe(Kt,1,"adminform-dropdown-trigger adminform-filter-trigger",null,ca,wt)},[()=>({open:e(J)}),()=>({selected:e(I)}),()=>({open:e(V)}),()=>({selected:e(z)}),()=>({loading:e(E)}),()=>({open:e(L)}),()=>({selected:e(fe)!=="all"})]),la(Be,()=>e(M),ie=>d(M,ie)),la(Ge,()=>e(F),ie=>d(F,ie)),Q("click",Qe,Ue),Q("click",He,rt),la(ye,()=>e(X),ie=>d(X,ie)),Q("submit",K,Os(Ve)),la(ya,()=>e(ce),ie=>d(ce,ie)),Q("click",Kt,Ye),h(s,he),Ga(),i()}var o0=_('<div class="scheduleassign-container"><div class="scheduleassign-header"><div class="scheduleassign-header-content"><h1 class="scheduleassign-page-title">Schedule Management</h1> <p class="scheduleassign-page-subtitle">Assign subjects and teachers to sections with specific time periods</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">schedule</span> Schedule</button> <button><span class="material-icons">groups</span> Section</button> <button><span class="material-icons">meeting_room</span> Room</button></div></div> <div class="schedule-content-container"><!> <!> <!></div></div>');function l0(s){let t=P("schedule");function a(M){d(t,M)}var i=o0(),r=o(i),l=v(o(r),2),c=o(l);let u;var f=v(c,2);let p;var m=v(f,2);let g;n(l),n(r);var y=v(r,2),b=o(y);{var D=M=>{tw(M,{})};C(b,M=>{e(t)==="schedule"&&M(D)})}var S=v(b,2);{var k=M=>{r0(M,{})};C(S,M=>{e(t)==="section"&&M(k)})}var A=v(S,2);{var E=M=>{xw(M,{})};C(A,M=>{e(t)==="room"&&M(E)})}n(y),n(i),$((M,I,F)=>{u=oe(c,1,"admin-tab-button",null,u,M),p=oe(f,1,"admin-tab-button",null,p,I),g=oe(m,1,"admin-tab-button",null,g,F)},[()=>({active:e(t)==="schedule"}),()=>({active:e(t)==="section"}),()=>({active:e(t)==="room"})]),Q("click",c,()=>a("schedule")),Q("click",f,()=>a("section")),Q("click",m,()=>a("room")),h(s,i)}var c0=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),d0=_('<span class="adminsubject-placeholder">Select grade level</span>'),u0=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),v0=_('<span class="material-symbols-outlined">add_circle</span> Create Subject',1),f0=_('<button type="button" class="adminsubject-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),p0=_('<div class="adminsubject-level-category-selected"><span class="material-symbols-outlined adminsubject-level-category-icon">school</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name"> </span></div></div>'),h0=_('<span class="adminsubject-level-category-placeholder">All Grade Levels</span>'),m0=_('<button type="button"><span class="material-symbols-outlined adminsubject-level-category-icon">school</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name"> </span> <span class="adminsubject-level-category-description"> </span></div></button>'),g0=_('<div class="adminsubject-loading-container"><span class="subject-loader"></span> <p class="adminsubject-loading-text">Loading subjects...</p></div>'),_0=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),b0=_('<span class="adminsubject-placeholder">Select grade level</span>'),y0=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon">school</span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span> <span class="adminsubject-option-description"> </span></div></button>'),w0=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container" id="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Subject</h2> <p class="adminsubject-edit-form-subtitle">Update subject information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-grade-level">Grade Level *</label> <div><button type="button" id="edit-grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectName" class="adminsubject-form-label">Subject Name *</label> <input id="editSubjectName" type="text" class="adminsubject-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label for="editSubjectCode" class="adminsubject-form-label">Subject Code *</label> <input id="editSubjectCode" type="text" class="adminsubject-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="adminsubject-edit-form-actions"><button type="button" class="adminsubject-cancel-button">Cancel</button> <button type="submit" class="adminsubject-submit-button"><!></button></div></form></div></div>'),x0=_('<div class="adminsubject-subject-card"><div class="adminsubject-subject-header"><div class="adminsubject-subject-title"><h3 class="adminsubject-subject-name"> </h3></div> <div class="adminsubject-action-buttons"><a><button type="button" class="adminsubject-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminsubject-remove-button" title="Remove Subject"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminsubject-subject-details"><div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="adminsubject-subject-item-detail"><span class="material-symbols-outlined">update</span> <span> </span></div></div> <!></div>'),S0=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">search_off</span> <p>No subjects found matching your search.</p></div>'),k0=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Subject</h2> <p class="admin-section-subtitle">Fill in the details below to create a new subject</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="grade-level">Grade Level *</label> <div><button type="button" id="grade-level"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div> <div class="admin-form-group admin-form-group-third"><label for="subjectName" class="admin-form-label">Subject Name *</label> <input id="subjectName" type="text" class="admin-form-input" placeholder="e.g., Mathematics, English" required/></div> <div class="admin-form-group admin-form-group-third"><label for="subjectCode" class="admin-form-label">Subject Code *</label> <input id="subjectCode" type="text" class="admin-form-input" placeholder="e.g., MATH-7, ENG-8" required/></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Subjects</h2> <p class="admin-section-subtitle">All subjects in the system</p></div> <div class="adminsubject-filters-container"><div class="adminsubject-search-container"><div class="adminsubject-search-input-wrapper"><span class="material-symbols-outlined adminsubject-search-icon">search</span> <input type="text" placeholder="Search by subject name or code" class="adminsubject-search-input"/> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined adminsubject-level-category-arrow">expand_more</span></button> <div class="adminsubject-level-category-menu"><button type="button"><span class="material-symbols-outlined adminsubject-level-category-icon">clear_all</span> <div class="adminsubject-level-category-content"><span class="adminsubject-level-category-name">All Grade Levels</span></div></button> <!></div></div></div></div></div> <div class="adminsubject-subjects-grid"><!></div></div></div>'),D0=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),A0=_('<span class="adminsubject-placeholder">Select icon</span>'),C0=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),T0=_('<span class="material-symbols-outlined">add_circle</span> Create Activity Type',1),M0=_('<button type="button" class="adminactivity-clear-search-button"><span class="material-symbols-outlined">close</span></button>'),P0=_('<div class="adminsubject-selected-option"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></div>'),E0=_('<span class="adminsubject-placeholder">Select icon</span>'),F0=_('<button type="button"><span class="material-symbols-outlined adminsubject-option-icon"> </span> <div class="adminsubject-option-content"><span class="adminsubject-option-name"> </span></div></button>'),N0=_('<div class="adminsubject-edit-form-section"><div class="adminsubject-edit-form-container"><div class="adminsubject-edit-form-header"><h2 class="adminsubject-edit-form-title">Edit Activity Type</h2> <p class="adminsubject-edit-form-subtitle">Update activity type information</p></div> <form class="adminsubject-edit-form-content"><div class="adminsubject-edit-form-row"><div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-name">Activity Name *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-name" placeholder="e.g., Flag Ceremony" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-code">Activity Code *</label> <input type="text" class="adminsubject-form-input" id="edit-activity-code" placeholder="e.g., FLAG" required/></div> <div class="adminsubject-form-group adminsubject-form-group-third"><label class="adminsubject-form-label" for="edit-activity-icon">Icon</label> <div><button type="button" id="edit-activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="adminsubject-edit-form-actions"><a><button type="button" class="adminsubject-cancel-button">Cancel</button></a> <button type="submit"><!></button></div></form></div></div>'),L0=_('<div class="adminactivity-activity-card"><div class="adminactivity-activity-header"><div class="adminactivity-activity-title"><h3 class="adminactivity-activity-name"> </h3></div> <div class="adminactivity-action-buttons"><a><button type="button" class="adminactivity-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="adminactivity-remove-button" title="Remove Activity Type"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="adminactivity-activity-details"><div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">qr_code_2</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined"> </span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">palette</span> <span> </span></div> <div class="adminactivity-activity-item-detail"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!></div>'),$0=_("<p>No activity types created yet.</p>"),j0=_("<p>No activity types found matching your search.</p>"),I0=_('<div class="adminsubject-no-results"><span class="material-symbols-outlined adminsubject-no-results-icon">event_note</span> <!></div>'),R0=_('<div class="admin-creation-layout"><div class="admin-creation-form-section"><div class="admin-section-header"><h2 class="admin-section-title">Create New Activity Type</h2> <p class="admin-section-subtitle">Fill in the details below to create a new activity type</p></div> <div class="admin-form-container"><form><div class="admin-form-row"><div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-name">Activity Name *</label> <input id="activity-name" type="text" class="admin-form-input" placeholder="e.g., Flag Ceremony, Break Time" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-code">Activity Code *</label> <input id="activity-code" type="text" class="admin-form-input" placeholder="e.g., FLAG, BREAK" required/></div> <div class="admin-form-group admin-form-group-third"><label class="admin-form-label" for="activity-icon">Icon</label> <div><button type="button" id="activity-icon"><!> <span class="material-symbols-outlined adminsubject-dropdown-arrow">expand_more</span></button> <div class="adminsubject-dropdown-menu"></div></div></div></div> <div class="admin-form-actions"><button type="submit"><!></button></div></form></div></div> <div class="admin-recent-subjects-section"><div class="admin-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="admin-section-title">All Activities</h2> <p class="admin-section-subtitle">All activity types in the system</p></div> <div class="adminactivity-filters-container"><div class="adminactivity-search-container"><div class="adminactivity-search-input-wrapper"><span class="material-symbols-outlined adminactivity-search-icon">search</span> <input type="text" placeholder="Search by activity name or code" class="adminactivity-search-input"/> <!></div></div></div></div></div> <div class="adminactivity-activities-grid"><!></div></div></div>'),O0=_('<div class="admin-subject-creation-container"><div class="admin-subject-header"><div class="admin-header-content"><h1 class="admin-page-title">Subjects & Activities</h1> <p class="admin-page-subtitle">Manage subjects and activity types for the curriculum</p></div> <div class="admin-tab-navigation"><button><span class="material-icons">subject</span> Subjects</button> <button><span class="material-icons">event</span> Activity Types</button></div></div> <!> <!></div>');function q0(s,t){za(t,!1);const a=P(),i=P(),r=P(),l=P(),c=P();let u=P(!1),f=P(""),p=P(""),m=P(""),g=P(!1),y=P(!1),b=P(""),D=P(""),S=P(""),k=P(null),A=P(""),E=P(""),M=P(""),I=P(!1),F=P(!1),z=P("subjects"),R=P([]),J=P(!1),V=P(""),L=P(""),X=P("event"),ne=P(!1),ce=P(null),Le=P(""),fe=P(""),se=P("event"),re=P(!1),Se=P(!1),me=P(!1),ze=P([]);const Xe=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],tt=[{value:"event",name:"Event"},{value:"flag",name:"Flag"},{value:"coffee",name:"Coffee"},{value:"restaurant",name:"Restaurant"},{value:"groups",name:"Groups"},{value:"home",name:"Home"},{value:"book",name:"Book"},{value:"group_work",name:"Group Work"},{value:"schedule",name:"Schedule"}];async function ve(){d(me,!0);try{const j=await da.get("/api/subjects");j.success?d(ze,j.data):Ae.error("Failed to load subjects: "+j.message)}catch(j){console.error("Error loading subjects:",j),Ae.error("Failed to load subjects. Please try again.")}finally{d(me,!1)}}async function $e(){try{const j=await da.get("/api/activity-types");j.success?d(R,j.data):Ae.error("Failed to load activity types: "+j.message)}catch(j){console.error("Error loading activity types:",j),Ae.error("Failed to load activity types. Please try again.")}}Wa(()=>{ve(),$e()});async function Je(){if(!e(f)||!e(p).trim()||!e(m).trim()){Ae.error("Please fill in all required fields");return}d(u,!0);try{const j=await da.post("/api/subjects",{name:e(p).trim(),code:e(m).trim(),gradeLevel:e(f)});j.success?(d(ze,[j.data,...e(ze)]),d(f,""),d(p,""),d(m,""),Ae.success(j.message)):Ae.error(j.message)}catch(j){console.error("Error creating subject:",j),Ae.error("Failed to create subject. Please try again.")}finally{d(u,!1)}}async function Re(j){ds.confirm("Remove Subject",`<p>Are you sure you want to remove the subject <strong>"${j.name}"</strong>?</p>`,async()=>{try{const K=await da.delete("/api/subjects",{id:j.id});K.success?(d(ze,e(ze).filter(ae=>ae.id!==j.id)),Ae.success(K.message)):Ae.error(K.message)}catch(K){console.error("Error removing subject:",K),Ae.error("Failed to remove subject. Please try again.")}},null,{size:"small"})}function Ze(){d(F,!e(F))}function st(j){d(M,j.value),d(F,!1)}function We(){d(g,!e(g))}function nt(j){d(f,j.value),d(g,!1)}function ke(){d(y,!e(y))}function De(j){j?d(D,j.value):d(D,""),d(y,!1)}function Ie(j){j.target.closest(".adminsubject-custom-dropdown")||(d(g,!1),d(F,!1),d(ne,!1),d(Se,!1)),j.target.closest(".adminsubject-level-category-filter")||d(y,!1)}function Ee(){d(ne,!e(ne))}function ee(j){d(X,j),d(ne,!1)}function Ue(j){const K=tt.find(ae=>ae.value===j);return K?K.name:j}function rt(j){e(k)===j.id?(d(k,null),d(A,""),d(E,""),d(M,""),d(F,!1)):(d(k,j.id),d(A,j.name),d(E,j.code),d(M,parseInt(j.gradeLevel.replace("Grade ",""))))}async function Ye(){if(!e(A).trim()||!e(E).trim()||!e(M)){Ae.error("Please fill in all required fields");return}d(I,!0);try{const j=await da.put("/api/subjects",{id:e(k),name:e(A).trim(),code:e(E).trim(),gradeLevel:e(M)});j.success?(d(ze,e(ze).map(K=>K.id===e(k)?j.data:K)),Ae.success(j.message),d(k,null),d(A,""),d(E,""),d(M,""),d(F,!1)):Ae.error(j.message)}catch(j){console.error("Error updating subject:",j),Ae.error("Failed to update subject. Please try again.")}finally{d(I,!1)}}function at(j){e(ce)===j.id?(d(ce,null),d(Le,""),d(fe,""),d(se,"event"),d(Se,!1)):(d(ce,j.id),d(Le,j.name),d(fe,j.code),d(se,j.icon))}async function lt(){if(!e(Le).trim()||!e(fe).trim()){Ae.error("Please fill in all required fields");return}d(re,!0);try{const j=await da.put("/api/activity-types",{id:e(ce),name:e(Le).trim(),code:e(fe).trim(),icon:e(se)});j.success?(recentActivityTypes=recentActivityTypes.map(K=>K.id===e(ce)?j.data:K),Ae.success(j.message),d(ce,null),d(Le,""),d(fe,""),d(se,"event"),d(Se,!1)):Ae.error(j.message)}catch(j){console.error("Error updating activity type:",j),Ae.error("Failed to update activity type. Please try again.")}finally{d(re,!1)}}function O(){d(Se,!e(Se))}function T(j){d(se,j),d(Se,!1)}async function U(){if(!e(V).trim()||!e(L).trim()){Ae.error("Please fill in all required fields");return}d(J,!0);try{const j=await da.post("/api/activity-types",{name:e(V).trim(),code:e(L).trim(),icon:e(X)});j.success?(d(R,[j.data,...e(R)]),d(V,""),d(L,""),d(X,"event"),Ae.success("Activity type created successfully")):Ae.error(j.message)}catch(j){console.error("Error creating activity type:",j),Ae.error("Failed to create activity type. Please try again.")}finally{d(J,!1)}}async function de(j){ds.confirm("Remove Activity Type",`<p>Are you sure you want to remove the activity type <strong>"${j.name}"</strong>?</p>`,async()=>{try{const K=await da.delete("/api/activity-types",{id:j.id});K.success?(d(R,e(R).filter(ae=>ae.id!==j.id)),Ae.success(K.message)):Ae.error(K.message)}catch(K){console.error("Error removing activity type:",K),Ae.error("Failed to remove activity type. Please try again.")}},null,{size:"small"})}Jt(()=>e(f),()=>{d(a,Xe.find(j=>j.value===e(f)))}),Jt(()=>e(D),()=>{d(i,Xe.find(j=>j.value===e(D)))}),Jt(()=>(e(ze),e(b),e(D)),()=>{d(r,e(ze).filter(j=>{const K=j.name.toLowerCase().includes(e(b).toLowerCase())||j.code.toLowerCase().includes(e(b).toLowerCase()),ae=e(D)?j.gradeLevel===`Grade ${e(D)}`:!0;return K&&ae}))}),Jt(()=>(e(R),e(S)),()=>{d(l,e(R).filter(j=>j.name.toLowerCase().includes(e(S).toLowerCase())||j.code.toLowerCase().includes(e(S).toLowerCase())))}),Jt(()=>e(M),()=>{d(c,Xe.find(j=>j.value===e(M)))}),Ss(),vs();var Pe=O0();Q("click",Ys,Ie);var Ve=o(Pe),Me=v(o(Ve),2),q=o(Me);let B;var N=v(q,2);let Z;n(Me),n(Ve);var be=v(Ve,2);{var Fe=j=>{var K=k0(),ae=o(K),Oe=v(o(ae),2),Be=o(Oe),Ke=o(Be),Ge=o(Ke),ot=v(o(Ge),2);let gt;var Yt=o(ot);let ge;var Qe=o(Yt);{var Y=yt=>{var Gt=c0(),Lt=v(o(Gt),2),Aa=o(Lt),Kt=o(Aa,!0);n(Aa),n(Lt),n(Gt),$(()=>w(Kt,(e(a),x(()=>e(a).label)))),h(yt,Gt)},le=yt=>{var Gt=d0();h(yt,Gt)};C(Qe,yt=>{e(a)?yt(Y):yt(le,!1)})}ia(2),n(Yt);var Ce=v(Yt,2);Tt(Ce,5,()=>Xe,yt=>yt.value,(yt,Gt)=>{var Lt=u0();let Aa;var Kt=v(o(Lt),2),ca=o(Kt),ra=o(ca,!0);n(ca);var Sa=v(ca,2),va=o(Sa,!0);n(Sa),n(Kt),n(Lt),$(ha=>{Aa=oe(Lt,1,"adminsubject-dropdown-option",null,Aa,ha),w(ra,(e(Gt),x(()=>e(Gt).label))),w(va,(e(Gt),x(()=>e(Gt).description)))},[()=>({selected:e(f)===e(Gt).value})]),Q("click",Lt,()=>nt(e(Gt))),h(yt,Lt)}),n(Ce),n(ot),n(Ge);var et=v(Ge,2),ft=v(o(et),2);sa(ft),n(et);var Dt=v(et,2),vt=v(o(Dt),2);sa(vt),n(Dt),n(Ke);var Qt=v(Ke,2),He=o(Qt);let je;var jt=o(He);{var aa=yt=>{var Gt=ka("Creating...");h(yt,Gt)},St=yt=>{var Gt=v0();ia(),h(yt,Gt)};C(jt,yt=>{e(u)?yt(aa):yt(St,!1)})}n(He),n(Qt),n(Be),n(Oe),n(ae);var xt=v(ae,2),Pt=o(xt),ye=o(Pt),H=v(o(ye),2),qe=o(H),Ct=o(qe),zt=v(o(Ct),2);sa(zt);var ua=v(zt,2);{var xe=yt=>{var Gt=f0();Q("click",Gt,()=>d(b,"")),h(yt,Gt)};C(ua,yt=>{e(b)&&yt(xe)})}n(Ct),n(qe);var Te=v(qe,2);let ue;var bt=o(Te);let ht;var G=o(bt);{var pe=yt=>{var Gt=p0(),Lt=v(o(Gt),2),Aa=o(Lt),Kt=o(Aa,!0);n(Aa),n(Lt),n(Gt),$(()=>w(Kt,(e(i),x(()=>e(i).label)))),h(yt,Gt)},pt=yt=>{var Gt=h0();h(yt,Gt)};C(G,yt=>{e(i)?yt(pe):yt(pt,!1)})}ia(2),n(bt);var Rt=v(bt,2),ct=o(Rt);let Xt;var ga=v(ct,2);Tt(ga,1,()=>Xe,yt=>yt.value,(yt,Gt)=>{var Lt=m0();let Aa;var Kt=v(o(Lt),2),ca=o(Kt),ra=o(ca,!0);n(ca);var Sa=v(ca,2),va=o(Sa,!0);n(Sa),n(Kt),n(Lt),$(ha=>{Aa=oe(Lt,1,"adminsubject-level-category-option",null,Aa,ha),w(ra,(e(Gt),x(()=>e(Gt).label))),w(va,(e(Gt),x(()=>e(Gt).description)))},[()=>({selected:e(D)===e(Gt).value})]),Q("click",Lt,()=>De(e(Gt))),h(yt,Lt)}),n(Rt),n(Te),n(H),n(ye),n(Pt);var ba=v(Pt,2),_a=o(ba);{var ya=yt=>{var Gt=g0();h(yt,Gt)},ta=yt=>{var Gt=Et(),Lt=ut(Gt);Tt(Lt,1,()=>e(r),Aa=>Aa.id,(Aa,Kt)=>{var ca=x0(),ra=o(ca),Sa=o(ra),va=o(Sa),ha=o(va);n(va),n(Sa);var Ot=v(Sa,2),Pa=o(Ot),Oa=o(Pa),Ba=o(Oa),ie=o(Ba,!0);n(Ba),n(Oa),n(Pa);var Ne=v(Pa,2);n(Ot),n(ra);var mt=v(ra,2),qt=o(mt),Ut=v(o(qt),2),Bt=o(Ut,!0);n(Ut),n(qt);var wt=v(qt,2),fa=v(o(wt),2),It=o(fa);n(fa),n(wt);var Zt=v(wt,2),ea=v(o(Zt),2),Ma=o(ea);n(ea),n(Zt),n(mt);var Ea=v(mt,2);{var wa=Da=>{var xa=w0(),ja=o(xa),Qa=v(o(ja),2),W=o(Qa),_e=o(W),dt=v(o(_e),2);let Nt;var we=o(dt);let it;var Mt=o(we);{var At=pa=>{var Na=_0(),qa=v(o(Na),2),Ia=o(qa),Ja=o(Ia,!0);n(Ia),n(qa),n(Na),$(()=>w(Ja,(e(c),x(()=>e(c).label)))),h(pa,Na)},_t=pa=>{var Na=b0();h(pa,Na)};C(Mt,pa=>{e(c)?pa(At):pa(_t,!1)})}ia(2),n(we);var Vt=v(we,2);Tt(Vt,5,()=>Xe,pa=>pa.value,(pa,Na)=>{var qa=y0();let Ia;var Ja=v(o(qa),2),ks=o(Ja),gs=o(ks,!0);n(ks);var rs=v(ks,2),es=o(rs,!0);n(rs),n(Ja),n(qa),$(As=>{Ia=oe(qa,1,"adminsubject-dropdown-option",null,Ia,As),w(gs,(e(Na),x(()=>e(Na).label))),w(es,(e(Na),x(()=>e(Na).description)))},[()=>({selected:e(M)===e(Na).value})]),Q("click",qa,()=>st(e(Na))),h(pa,qa)}),n(Vt),n(dt),n(_e);var Wt=v(_e,2),Ft=v(o(Wt),2);sa(Ft),n(Wt);var oa=v(Wt,2),Ca=v(o(oa),2);sa(Ca),n(oa),n(W);var Ta=v(W,2),Ha=o(Ta),ma=v(Ha,2),Fa=o(ma);{var Ht=pa=>{var Na=ka("Updating...");h(pa,Na)},na=pa=>{var Na=ka("Update Subject");h(pa,Na)};C(Fa,pa=>{e(I)?pa(Ht):pa(na,!1)})}n(ma),n(Ta),n(Qa),n(ja),n(xa),$((pa,Na,qa)=>{Nt=oe(dt,1,"adminsubject-custom-dropdown",null,Nt,pa),it=oe(we,1,"adminsubject-dropdown-trigger",null,it,Na),ma.disabled=qa},[()=>({open:e(F)}),()=>({selected:e(M)}),()=>(e(I),e(A),e(E),e(M),x(()=>e(I)||!e(A).trim()||!e(E).trim()||!e(M)))]),Q("click",we,Ze),la(Ft,()=>e(A),pa=>d(A,pa)),la(Ca,()=>e(E),pa=>d(E,pa)),Q("click",Ha,()=>rt(e(Kt))),Q("submit",Qa,Os(Ye)),h(Da,xa)};C(Ea,Da=>{e(k),e(Kt),x(()=>e(k)===e(Kt).id)&&Da(wa)})}n(ca),$(()=>{$t(ca,"id",`adminsubject-subject-card-${e(Kt),x(()=>e(Kt).id)??""}`),w(ha,`${e(Kt),x(()=>e(Kt).name)??""}  ${e(Kt),x(()=>e(Kt).gradeLevel)??""}`),$t(Pa,"href",`#adminsubject-subject-card-${e(Kt),x(()=>e(Kt).id)??""}`),$t(Oa,"title",(e(k),e(Kt),x(()=>e(k)===e(Kt).id?"Cancel Edit":"Edit Subject"))),w(ie,(e(k),e(Kt),x(()=>e(k)===e(Kt).id?"close":"edit"))),w(Bt,(e(Kt),x(()=>e(Kt).code))),w(It,`Created: ${e(Kt),x(()=>e(Kt).createdDate)??""}`),w(Ma,`Updated: ${e(Kt),x(()=>e(Kt).updatedDate)??""}`)}),Q("click",Oa,()=>rt(e(Kt))),Q("click",Ne,()=>Re(e(Kt))),h(Aa,ca)},Aa=>{var Kt=S0();h(Aa,Kt)}),h(yt,Gt)};C(_a,yt=>{e(me)?yt(ya):yt(ta,!1)})}n(ba),n(xt),n(K),$((yt,Gt,Lt,Aa,Kt,ca,ra)=>{gt=oe(ot,1,"adminsubject-custom-dropdown",null,gt,yt),ge=oe(Yt,1,"adminsubject-dropdown-trigger",null,ge,Gt),ft.disabled=!e(f),je=oe(He,1,"admin-create-button",null,je,Lt),He.disabled=Aa,ue=oe(Te,1,"adminsubject-level-category-filter adminsubject-level-category-dropdown",null,ue,Kt),ht=oe(bt,1,"adminsubject-level-category-trigger",null,ht,ca),Xt=oe(ct,1,"adminsubject-level-category-option",null,Xt,ra)},[()=>({open:e(g)}),()=>({selected:e(f)}),()=>({loading:e(u)}),()=>(e(u),e(f),e(p),x(()=>e(u)||!e(f)||!e(p).trim())),()=>({open:e(y)}),()=>({selected:e(D)}),()=>({selected:e(D)===""})]),Q("click",Yt,We),la(ft,()=>e(p),yt=>d(p,yt)),la(vt,()=>e(m),yt=>d(m,yt)),Q("submit",Be,Os(Je)),la(zt,()=>e(b),yt=>d(b,yt)),Q("click",bt,ke),Q("click",ct,()=>De(null)),h(j,K)};C(be,j=>{e(z)==="subjects"&&j(Fe)})}var he=v(be,2);{var te=j=>{var K=R0(),ae=o(K),Oe=v(o(ae),2),Be=o(Oe),Ke=o(Be),Ge=o(Ke),ot=v(o(Ge),2);sa(ot),n(Ge);var gt=v(Ge,2),Yt=v(o(gt),2);sa(Yt),n(gt);var ge=v(gt,2),Qe=v(o(ge),2);let Y;var le=o(Qe);let Ce;var et=o(le);{var ft=G=>{var pe=D0(),pt=o(pe),Rt=o(pt,!0);n(pt);var ct=v(pt,2),Xt=o(ct),ga=o(Xt,!0);n(Xt),n(ct),n(pe),$(ba=>{w(Rt,e(X)),w(ga,ba)},[()=>(e(X),x(()=>Ue(e(X))))]),h(G,pe)},Dt=G=>{var pe=A0();h(G,pe)};C(et,G=>{e(X)?G(ft):G(Dt,!1)})}ia(2),n(le);var vt=v(le,2);Tt(vt,5,()=>tt,G=>G.value,(G,pe)=>{var pt=C0();let Rt;var ct=o(pt),Xt=o(ct,!0);n(ct);var ga=v(ct,2),ba=o(ga),_a=o(ba,!0);n(ba),n(ga),n(pt),$(ya=>{Rt=oe(pt,1,"adminsubject-dropdown-option",null,Rt,ya),w(Xt,(e(pe),x(()=>e(pe).value))),w(_a,(e(pe),x(()=>e(pe).name)))},[()=>({selected:e(X)===e(pe).value})]),Q("click",pt,()=>ee(e(pe).value)),h(G,pt)}),n(vt),n(Qe),n(ge),n(Ke);var Qt=v(Ke,2),He=o(Qt);let je;var jt=o(He);{var aa=G=>{var pe=ka("Creating...");h(G,pe)},St=G=>{var pe=T0();ia(),h(G,pe)};C(jt,G=>{e(J)?G(aa):G(St,!1)})}n(He),n(Qt),n(Be),n(Oe),n(ae);var xt=v(ae,2),Pt=o(xt),ye=o(Pt),H=v(o(ye),2),qe=o(H),Ct=o(qe),zt=v(o(Ct),2);sa(zt);var ua=v(zt,2);{var xe=G=>{var pe=M0();Q("click",pe,()=>d(S,"")),h(G,pe)};C(ua,G=>{e(S)&&G(xe)})}n(Ct),n(qe),n(H),n(ye),n(Pt);var Te=v(Pt,2),ue=o(Te);{var bt=G=>{var pe=Et(),pt=ut(pe);Tt(pt,1,()=>e(l),Rt=>Rt.id,(Rt,ct)=>{var Xt=L0(),ga=o(Xt),ba=o(ga),_a=o(ba),ya=o(_a,!0);n(_a),n(ba);var ta=v(ba,2),yt=o(ta),Gt=o(yt),Lt=o(Gt),Aa=o(Lt,!0);n(Lt),n(Gt),n(yt);var Kt=v(yt,2);n(ta),n(ga);var ca=v(ga,2),ra=o(ca),Sa=v(o(ra),2),va=o(Sa,!0);n(Sa),n(ra);var ha=v(ra,2),Ot=o(ha),Pa=o(Ot,!0);n(Ot);var Oa=v(Ot,2),Ba=o(Oa);n(Oa),n(ha);var ie=v(ha,2),Ne=v(o(ie),2),mt=o(Ne);n(Ne),n(ie);var qt=v(ie,2),Ut=v(o(qt),2),Bt=o(Ut);n(Ut),n(qt),n(ca);var wt=v(ca,2);{var fa=It=>{var Zt=N0(),ea=o(Zt),Ma=v(o(ea),2),Ea=o(Ma),wa=o(Ea),Da=v(o(wa),2);sa(Da),n(wa);var xa=v(wa,2),ja=v(o(xa),2);sa(ja),n(xa);var Qa=v(xa,2),W=v(o(Qa),2);let _e;var dt=o(W);let Nt;var we=o(dt);{var it=ma=>{var Fa=P0(),Ht=o(Fa),na=o(Ht,!0);n(Ht);var pa=v(Ht,2),Na=o(pa),qa=o(Na,!0);n(Na),n(pa),n(Fa),$(Ia=>{w(na,e(se)),w(qa,Ia)},[()=>(e(se),x(()=>Ue(e(se))))]),h(ma,Fa)},Mt=ma=>{var Fa=E0();h(ma,Fa)};C(we,ma=>{e(se)?ma(it):ma(Mt,!1)})}ia(2),n(dt);var At=v(dt,2);Tt(At,5,()=>tt,ma=>ma.value,(ma,Fa)=>{var Ht=F0();let na;var pa=o(Ht),Na=o(pa,!0);n(pa);var qa=v(pa,2),Ia=o(qa),Ja=o(Ia,!0);n(Ia),n(qa),n(Ht),$(ks=>{na=oe(Ht,1,"adminsubject-dropdown-option",null,na,ks),w(Na,(e(Fa),x(()=>e(Fa).value))),w(Ja,(e(Fa),x(()=>e(Fa).name)))},[()=>({selected:e(se)===e(Fa).value})]),Q("click",Ht,()=>T(e(Fa).value)),h(ma,Ht)}),n(At),n(W),n(Qa),n(Ea);var _t=v(Ea,2),Vt=o(_t),Wt=o(Vt);n(Vt);var Ft=v(Vt,2);let oa;var Ca=o(Ft);{var Ta=ma=>{var Fa=ka("Updating...");h(ma,Fa)},Ha=ma=>{var Fa=ka("Update Activity Type");h(ma,Fa)};C(Ca,ma=>{e(re)?ma(Ta):ma(Ha,!1)})}n(Ft),n(_t),n(Ma),n(ea),n(Zt),$((ma,Fa,Ht,na)=>{_e=oe(W,1,"adminsubject-custom-dropdown",null,_e,ma),Nt=oe(dt,1,"adminsubject-dropdown-trigger",null,Nt,Fa),$t(Vt,"href",`#adminactivity-activity-card-${e(ct),x(()=>e(ct).id)??""}`),oa=oe(Ft,1,"adminsubject-submit-button",null,oa,Ht),Ft.disabled=na},[()=>({open:e(Se)}),()=>({selected:e(se)}),()=>({loading:e(re)}),()=>(e(re),e(Le),e(fe),x(()=>e(re)||!e(Le).trim()||!e(fe).trim()))]),la(Da,()=>e(Le),ma=>d(Le,ma)),la(ja,()=>e(fe),ma=>d(fe,ma)),Q("click",dt,O),Q("click",Wt,()=>at(e(ct))),Q("submit",Ma,Os(lt)),h(It,Zt)};C(wt,It=>{e(ce),e(ct),x(()=>e(ce)===e(ct).id)&&It(fa)})}n(Xt),$(It=>{$t(Xt,"id",`adminactivity-activity-card-${e(ct),x(()=>e(ct).id)??""}`),w(ya,(e(ct),x(()=>e(ct).name))),$t(yt,"href",`#adminactivity-activity-card-${e(ct),x(()=>e(ct).id)??""}`),$t(Gt,"title",(e(ce),e(ct),x(()=>e(ce)===e(ct).id?"Cancel Edit":"Edit Activity Type"))),w(Aa,(e(ce),e(ct),x(()=>e(ce)===e(ct).id?"close":"edit"))),w(va,(e(ct),x(()=>e(ct).code))),as(Ot,`color: var(--${e(ct),x(()=>e(ct).color)??""}-500)`),w(Pa,(e(ct),x(()=>e(ct).icon))),w(Ba,`Icon: ${e(ct),x(()=>e(ct).icon)??""}`),w(mt,`Color: ${e(ct),x(()=>e(ct).color)??""}`),w(Bt,`Created: ${It??""}`)},[()=>x(()=>new Date().toLocaleDateString())]),Q("click",Gt,()=>at(e(ct))),Q("click",Kt,()=>de(e(ct))),h(Rt,Xt)}),h(G,pe)},ht=G=>{var pe=I0(),pt=v(o(pe),2);{var Rt=Xt=>{var ga=$0();h(Xt,ga)},ct=Xt=>{var ga=j0();h(Xt,ga)};C(pt,Xt=>{e(R),x(()=>e(R).length===0)?Xt(Rt):Xt(ct,!1)})}n(pe),h(G,pe)};C(ue,G=>{e(l),x(()=>e(l).length>0)?G(bt):G(ht,!1)})}n(Te),n(xt),n(K),$((G,pe,pt,Rt)=>{Y=oe(Qe,1,"adminsubject-custom-dropdown",null,Y,G),Ce=oe(le,1,"adminsubject-dropdown-trigger",null,Ce,pe),je=oe(He,1,"admin-create-button",null,je,pt),He.disabled=Rt},[()=>({open:e(ne)}),()=>({selected:e(X)}),()=>({loading:e(J)}),()=>(e(J),e(V),e(L),x(()=>e(J)||!e(V).trim()||!e(L).trim()))]),la(ot,()=>e(V),G=>d(V,G)),la(Yt,()=>e(L),G=>d(L,G)),Q("click",le,Ee),Q("submit",Be,Os(U)),la(zt,()=>e(S),G=>d(S,G)),h(j,K)};C(he,j=>{e(z)==="activities"&&j(te)})}n(Pe),$((j,K)=>{B=oe(q,1,"admin-tab-button",null,B,j),Z=oe(N,1,"admin-tab-button",null,Z,K)},[()=>({active:e(z)==="subjects"}),()=>({active:e(z)==="activities"})]),Q("click",q,()=>d(z,"subjects")),Q("click",N,()=>d(z,"activities")),h(s,Pe),Ga()}var V0=_('<span class="material-symbols-outlined">add_ad</span> Create Department',1),B0=_('<button type="button" class="clear-search-button"><span class="material-symbols-outlined">close</span></button>'),z0=_('<div class="selected-option"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></div>'),G0=_('<span class="placeholder">Filter by type</span>'),W0=_('<button type="button"><span class="material-symbols-outlined option-icon"> </span> <div class="option-content"><span class="option-name"> </span></div></button>'),H0=_('<div class="dept-mgmt-loading"><span class="dept-loader"></span> <p>Loading departments...</p></div>'),Y0=_('<div class="dept-mgmt-empty-state"><span class="material-symbols-outlined dept-mgmt-empty-icon">corporate_fare</span> <h3 class="dept-mgmt-empty-title"> </h3> <p class="dept-mgmt-empty-description"> </p></div>'),U0=_('<div class="dept-mgmt-edit-form-section"><div class="dept-mgmt-edit-form-container" id="admin-department-edit-form-container"><div class="dept-mgmt-edit-form-header"><h2 class="dept-mgmt-edit-form-title">Edit Department</h2> <p class="dept-mgmt-edit-form-subtitle">Update department information</p></div> <form class="dept-mgmt-edit-form-content"><div class="dept-mgmt-edit-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-name">Department Name *</label> <input type="text" id="edit-department-name" class="dept-mgmt-form-input" placeholder="Enter department name" required/></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="edit-department-code">Department Code *</label> <input type="text" id="edit-department-code" class="dept-mgmt-form-input" placeholder="Enter department code" required/></div></div> <div class="dept-mgmt-edit-form-actions"><a><button type="button" class="dept-mgmt-cancel-button">Cancel</button></a> <button type="submit" class="dept-mgmt-update-button"><!></button></div></form></div></div>'),Q0=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),J0=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">subject</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-subject-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),K0=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">subject</span> <span>No subjects found</span></div>'),X0=_('<button type="button" class="dept-mgmt-select-all-button"><span class="material-symbols-outlined"> </span></button>'),Z0=_('<button type="button"><div class="dept-mgmt-option-content"><span class="material-symbols-outlined dept-mgmt-option-icon">person</span> <span class="dept-mgmt-option-name"> </span> <span class="dept-mgmt-option-description"> </span></div> <div class="dept-mgmt-teacher-checkbox"><span class="material-symbols-outlined"> </span></div></button>'),ex=_('<div class="dept-mgmt-no-results"><span class="material-symbols-outlined">person_off</span> <span>No teachers found</span></div>'),tx=_('<div class="dept-mgmt-assign-form-section"><div class="dept-mgmt-assign-form-container"><div class="dept-mgmt-assign-form-header"><h2 class="dept-mgmt-assign-form-title">Assign Subjects & Teachers</h2> <p class="dept-mgmt-assign-form-subtitle">Select subjects and teachers for this department</p></div> <form class="dept-mgmt-assign-form-content"><div class="dept-mgmt-assign-info-row"><div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="subjects"> </label> <div class="dept-mgmt-subject-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search subjects by name or code..." id="subjects"/> <!></div> <div class="dept-mgmt-subject-list"><!> <!></div> <p class="dept-mgmt-form-help">Select subjects that will be managed by this department.</p></div> <div class="dept-mgmt-form-group"><label class="dept-mgmt-form-label" for="teachers"> </label> <div class="dept-mgmt-teacher-controls"><input type="text" class="dept-mgmt-form-input" placeholder="Search teachers by name or account number..." id="teachers"/> <!></div> <div class="dept-mgmt-teacher-list"><!> <!></div> <p class="dept-mgmt-form-help">Select teachers who will be part of this department.</p></div></div> <div class="dept-mgmt-assign-actions"><button type="button" class="dept-mgmt-cancel-button">Cancel</button> <button type="submit" class="dept-mgmt-assign-submit-button"><!></button></div></form></div></div>'),ax=_('<div><div class="dept-mgmt-department-header"><div class="dept-mgmt-department-title"><h3 class="dept-mgmt-department-name"> </h3></div> <div class="dept-mgmt-action-buttons"><a><button type="button" class="dept-mgmt-assign-button"><span class="material-symbols-outlined"> </span></button></a> <a><button type="button" class="dept-mgmt-edit-button"><span class="material-symbols-outlined"> </span></button></a> <button type="button" class="dept-mgmt-remove-button" title="Remove Department"><span class="material-symbols-outlined">delete</span></button></div></div> <div class="dept-mgmt-department-details"><div class="dept-mgmt-department-code"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="dept-mgmt-department-subjects"><span class="material-symbols-outlined">subject</span> <span> </span></div> <div class="dept-mgmt-department-teachers"><span class="material-symbols-outlined">person</span> <span> </span></div> <div class="dept-mgmt-department-created"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div></div> <!> <!></div>'),sx=_('<div class="dept-mgmt-container"><div class="dept-mgmt-header"><div class="dept-mgmt-header-content"><h1 class="dept-mgmt-page-title">Department Management</h1> <p class="dept-mgmt-page-subtitle">Create and manage academic departments, assign subjects and teachers</p></div></div> <div class="dept-mgmt-create-section"><h2 class="dept-mgmt-section-title">Create New Department</h2> <p class="dept-mgmt-section-subtitle">Add a new academic department to organize subjects and teachers</p> <div class="dept-mgmt-create-form"><div class="dept-mgmt-form-row"><div class="dept-mgmt-form-group"><label for="departmentName" class="dept-mgmt-form-label">Department Name *</label> <input id="departmentName" type="text" placeholder="e.g., Mathematics Department" class="dept-mgmt-form-input"/></div> <div class="dept-mgmt-form-group"><label for="departmentCode" class="dept-mgmt-form-label">Department Code *</label> <input id="departmentCode" type="text" placeholder="e.g., MATH-DEPT" class="dept-mgmt-form-input"/></div></div> <div class="dept-mgmt-form-actions"><button type="submit" class="dept-mgmt-btn-primary"><!></button></div></div></div> <div class="dept-mgmt-departments-section"><div class="dept-mgmt-section-header"><div class="section-header-content"><div class="section-title-group"><h2 class="dept-mgmt-section-title">All Departments</h2> <p class="dept-mgmt-section-subtitle">Manage existing departments, assign subjects and teachers</p></div> <div class="dept-mgmt-search-filter-container"><div class="search-container"><div class="search-input-wrapper"><span class="material-symbols-outlined search-icon">search</span> <input type="text" class="search-input" placeholder="Search departments by name or code..."/> <!></div></div> <div class="filter-container"><div><button type="button"><!> <span class="material-symbols-outlined dropdown-arrow">expand_more</span></button> <div class="dropdown-menu"></div></div></div></div></div></div> <div class="dept-mgmt-departments-grid"><!></div></div></div>');function ix(s,t){za(t,!1);const a=P(),i=P(),r=P(),l=P(),c=P();let u=P(!1),f=P([]),p=P([]),m=P(""),g=P(""),y=P(""),b=P([]),D=P([]),S=P("all"),k=P(!1),A=P(null),E=P(""),M=P(""),I=P(!1),F=P(null),z=P(!1),R=P([]),J=P([]),V=P(""),L=P(""),X=P(!1);const ne=[{id:"all",name:"All Departments",icon:"corporate_fare"},{id:"with_subjects",name:"With Subjects",icon:"book"},{id:"with_teachers",name:"With Teachers",icon:"person"},{id:"empty",name:"Empty Departments",icon:"folder_open"}];async function ce(){d(X,!0);try{const Y=await da.get("/api/departments?action=departments");Y.success?d(b,Y.data.map(le=>({id:le.id,name:le.name,code:le.code,subjects:le.subjects||[],teachers:le.teachers||[],createdAt:le.created_at?le.created_at.split("T")[0]:new Date().toISOString().split("T")[0]}))):Ae.error("Failed to load departments")}catch(Y){console.error("Error fetching departments:",Y),Ae.error("Failed to load departments")}finally{d(X,!1)}}async function Le(){try{const Y=await da.get("/api/departments?action=subjects");Y.success?d(R,Y.data.map(le=>({id:le.id,name:le.name,code:le.code,gradeLevel:`Grade ${le.grade_level}`}))):Ae.error("Failed to load subjects")}catch(Y){console.error("Error fetching subjects:",Y),Ae.error("Failed to load subjects")}finally{}}async function fe(){try{const Y=await da.get("/api/departments?action=teachers");Y.success?d(J,Y.data.map(le=>({id:le.id,name:le.full_name||`${le.first_name} ${le.last_name}`,accountNumber:le.account_number}))):Ae.error("Failed to load teachers")}catch(Y){console.error("Error fetching teachers:",Y),Ae.error("Failed to load teachers")}finally{}}Wa(async()=>{await Promise.all([ce(),Le(),fe()]),se()});function se(Y=e(b),le=e(S),Ce=e(m)){let et=[...Y];le==="with_subjects"?et=et.filter(ft=>ft.subjects.length>0):le==="with_teachers"?et=et.filter(ft=>ft.teachers.length>0):le==="empty"&&(et=et.filter(ft=>ft.subjects.length===0&&ft.teachers.length===0)),Ce.trim()!==""&&(et=et.filter(ft=>ft.name.toLowerCase().includes(Ce.toLowerCase())||ft.code.toLowerCase().includes(Ce.toLowerCase()))),d(D,et)}function re(){d(k,!e(k))}function Se(Y){d(S,Y.id),d(k,!1)}async function me(){if(!e(g).trim()||!e(y).trim()){Ae.error("Please fill in all required fields");return}if(e(b).some(Y=>Y.code.toLowerCase()===e(y).toLowerCase())){Ae.error("Department code already exists");return}d(u,!0);try{const Y=await da.post("/api/departments",{name:e(g).trim(),code:e(y).trim().toUpperCase()});Y.success?(await ce(),d(g,""),d(y,""),Ae.success("Department created successfully")):Ae.error(Y.error||"Failed to create department")}catch(Y){console.error("Error creating department:",Y);const le=Y.message||"Failed to create department. Please try again.";Ae.error(le)}finally{d(u,!1)}}async function ze(Y){if(Y.preventDefault(),!e(I)){d(I,!0);try{if(!e(E).trim()||!e(M).trim()){Ae.error("Department name and code are required");return}if(e(M).trim().length>20){Ae.error("Department code cannot exceed 20 characters");return}if(e(b).find(vt=>vt.code.toLowerCase()===e(M).trim().toLowerCase()&&vt.id!==e(A))){Ae.error("Department code already exists");return}const Ce=e(b).find(vt=>vt.id===e(A));if(!Ce)throw new Error("Department not found");const et=Ce.teachers?Ce.teachers.map(vt=>vt.id):[],ft=Ce.subjects?Ce.subjects.map(vt=>vt.id):[],Dt=await da.put("/api/departments",{id:e(A),name:e(E).trim(),code:e(M).trim().toUpperCase(),teachers:et,subjects:ft});Dt.success?(await ce(),d(A,null),d(E,""),d(M,""),Ae.success("Department updated successfully")):Ae.error(Dt.error||"Failed to update department")}catch(le){console.error("Error updating department:",le);const Ce=le.message||"Failed to update department. Please try again.";Ae.error(Ce)}finally{d(I,!1)}}}function Xe(Y){e(A)===Y.id?(d(A,null),d(E,""),d(M,"")):(e(F)===Y.id&&(d(F,null),d(f,[]),d(p,[]),d(V,""),d(L,"")),d(A,Y.id),d(E,Y.name),d(M,Y.code))}function tt(Y){ds.confirm("Remove Department",`<p>Are you sure you want to remove the department <strong>"${Y.name}"</strong>?</p>
			 <p class="warning-text">This action will also remove all subject and teacher assignments.</p>`,async()=>{try{const le=await da.delete("/api/departments",{id:Y.id,name:Y.name});le.success?(await ce(),Ae.success("Department removed successfully")):Ae.error(le.error||"Failed to remove department")}catch(le){console.error("Error removing department:",le),Ae.error("Failed to remove department. Please try again.")}},()=>{},{size:"small"})}function ve(Y){e(F)===Y.id?(d(F,null),d(f,[]),d(p,[]),d(V,""),d(L,"")):(e(A)===Y.id&&(d(A,null),d(E,""),d(M,"")),d(F,Y.id),d(f,Y.subjects?Y.subjects.map(le=>le.id):[]),d(p,Y.teachers?Y.teachers.map(le=>le.id):[]),d(V,""),d(L,""))}function $e(Y){e(f).findIndex(Ce=>Ce===Y.id)>-1?d(f,e(f).filter(Ce=>Ce!==Y.id)):d(f,[...e(f),Y.id])}function Je(Y){e(p).findIndex(Ce=>Ce===Y.id)>-1?d(p,e(p).filter(Ce=>Ce!==Y.id)):d(p,[...e(p),Y.id])}function Re(){if(e(l).every(le=>e(f).some(Ce=>Ce===le.id)))d(f,e(f).filter(le=>!e(l).some(Ce=>Ce.id===le)));else{const le=e(l).filter(Ce=>!e(f).some(et=>et===Ce.id)).map(Ce=>Ce.id);d(f,[...e(f),...le])}}function Ze(){if(e(c).every(le=>e(p).some(Ce=>Ce===le.id)))d(p,e(p).filter(le=>!e(c).some(Ce=>Ce.id===le)));else{const le=e(c).filter(Ce=>!e(p).some(et=>et===Ce.id)).map(Ce=>Ce.id);d(p,[...e(p),...le])}}async function st(){d(z,!0);try{const Y=e(b).find(et=>et.id===e(F));if(!Y)throw new Error("Department not found");const le={id:e(F),name:Y.name,code:Y.code,teachers:e(p),subjects:e(f)},Ce=await da.put("/api/departments",le);if(!Ce.success)throw new Error(Ce.error||"Failed to update assignments");d(b,e(b).map(et=>{if(et.id===e(F)){const ft=e(R).filter(vt=>e(f).includes(vt.id)),Dt=e(J).filter(vt=>e(p).includes(vt.id));return{...et,subjects:ft,teachers:Dt}}return et})),Ae.success("Department assignments updated successfully"),d(F,null),d(f,[]),d(p,[])}catch(Y){console.error("Error assigning department:",Y),Ae.error("Failed to update assignments. Please try again.")}finally{d(z,!1)}}function We(Y){return Y.subjects||[]}function nt(Y){return Y.teachers||[]}function ke(Y){}function De(Y){if(!Y)return"";const le=Y.split("-");return le.length===3?`${le[1]}-${le[2]}-${le[0]}`:Y}Jt(()=>e(S),()=>{d(a,ne.find(Y=>Y.id===e(S)))}),Jt(()=>(e(b),e(S),e(m)),()=>{e(b)&&se(e(b),e(S),e(m))}),Jt(()=>(e(R),e(V)),()=>{d(i,e(R).filter(Y=>Y.name.toLowerCase().includes(e(V).toLowerCase())||Y.code.toLowerCase().includes(e(V).toLowerCase())))}),Jt(()=>(e(J),e(L)),()=>{d(r,e(J).filter(Y=>Y.name.toLowerCase().includes(e(L).toLowerCase())||Y.accountNumber.toLowerCase().includes(e(L).toLowerCase())))}),Jt(()=>(e(i),e(f)),()=>{d(l,e(i).sort((Y,le)=>{const Ce=e(f).some(ft=>ft===Y.id),et=e(f).some(ft=>ft===le.id);return Ce&&!et?-1:!Ce&&et?1:Y.name.localeCompare(le.name)}))}),Jt(()=>(e(r),e(p)),()=>{d(c,e(r).sort((Y,le)=>{const Ce=e(p).some(ft=>ft===Y.id),et=e(p).some(ft=>ft===le.id);return Ce&&!et?-1:!Ce&&et?1:Y.name.localeCompare(le.name)}))}),Ss(),vs();var Ie=sx();Q("click",Ys,ke);var Ee=v(o(Ie),2),ee=v(o(Ee),4),Ue=o(ee),rt=o(Ue),Ye=v(o(rt),2);sa(Ye),n(rt);var at=v(rt,2),lt=v(o(at),2);sa(lt),n(at),n(Ue);var O=v(Ue,2),T=o(O),U=o(T);{var de=Y=>{var le=ka("Creating...");h(Y,le)},Pe=Y=>{var le=V0();ia(),h(Y,le)};C(U,Y=>{e(u)?Y(de):Y(Pe,!1)})}n(T),n(O),n(ee),n(Ee);var Ve=v(Ee,2),Me=o(Ve),q=o(Me),B=v(o(q),2),N=o(B),Z=o(N),be=v(o(Z),2);sa(be);var Fe=v(be,2);{var he=Y=>{var le=B0();Q("click",le,()=>d(m,"")),h(Y,le)};C(Fe,Y=>{e(m)&&Y(he)})}n(Z),n(N);var te=v(N,2),j=o(te);let K;var ae=o(j);let Oe;var Be=o(ae);{var Ke=Y=>{var le=z0(),Ce=o(le),et=o(Ce,!0);n(Ce);var ft=v(Ce,2),Dt=o(ft),vt=o(Dt,!0);n(Dt),n(ft),n(le),$(()=>{w(et,(e(a),x(()=>e(a).icon))),w(vt,(e(a),x(()=>e(a).name)))}),h(Y,le)},Ge=Y=>{var le=G0();h(Y,le)};C(Be,Y=>{e(a)?Y(Ke):Y(Ge,!1)})}ia(2),n(ae);var ot=v(ae,2);Tt(ot,5,()=>ne,Y=>Y.id,(Y,le)=>{var Ce=W0();let et;var ft=o(Ce),Dt=o(ft,!0);n(ft);var vt=v(ft,2),Qt=o(vt),He=o(Qt,!0);n(Qt),n(vt),n(Ce),$(je=>{et=oe(Ce,1,"dropdown-option",null,et,je),w(Dt,(e(le),x(()=>e(le).icon))),w(He,(e(le),x(()=>e(le).name)))},[()=>({selected:e(S)===e(le).id})]),Q("click",Ce,()=>Se(e(le))),h(Y,Ce)}),n(ot),n(j),n(te),n(B),n(q),n(Me);var gt=v(Me,2),Yt=o(gt);{var ge=Y=>{var le=H0();h(Y,le)},Qe=Y=>{var le=Et(),Ce=ut(le);{var et=Dt=>{var vt=Y0(),Qt=v(o(vt),2),He=o(Qt,!0);n(Qt);var je=v(Qt,2),jt=o(je,!0);n(je),n(vt),$(()=>{w(He,e(m)?"No departments found":"No departments created yet"),w(jt,e(m)?"Try adjusting your search terms":"Create your first department to get started")}),h(Dt,vt)},ft=Dt=>{var vt=Et(),Qt=ut(vt);Tt(Qt,1,()=>e(D),He=>He.id,(He,je)=>{var jt=ax();let aa;var St=o(jt),xt=o(St),Pt=o(xt),ye=o(Pt,!0);n(Pt),n(xt);var H=v(xt,2),qe=o(H),Ct=o(qe),zt=o(Ct),ua=o(zt,!0);n(zt),n(Ct),n(qe);var xe=v(qe,2),Te=o(xe),ue=o(Te),bt=o(ue,!0);n(ue),n(Te),n(xe);var ht=v(xe,2);n(H),n(St);var G=v(St,2),pe=o(G),pt=v(o(pe),2),Rt=o(pt,!0);n(pt),n(pe);var ct=v(pe,2),Xt=v(o(ct),2),ga=o(Xt);n(Xt),n(ct);var ba=v(ct,2),_a=v(o(ba),2),ya=o(_a);n(_a),n(ba);var ta=v(ba,2),yt=v(o(ta),2),Gt=o(yt);n(yt),n(ta),n(G);var Lt=v(G,2);{var Aa=ra=>{var Sa=U0(),va=o(Sa),ha=v(o(va),2),Ot=o(ha),Pa=o(Ot),Oa=v(o(Pa),2);sa(Oa),n(Pa);var Ba=v(Pa,2),ie=v(o(Ba),2);sa(ie),n(Ba),n(Ot);var Ne=v(Ot,2),mt=o(Ne),qt=o(mt);n(mt);var Ut=v(mt,2),Bt=o(Ut);{var wt=It=>{var Zt=ka("Updating...");h(It,Zt)},fa=It=>{var Zt=ka("Update Department");h(It,Zt)};C(Bt,It=>{e(I)?It(wt):It(fa,!1)})}n(Ut),n(Ne),n(ha),n(va),n(Sa),$(()=>{$t(mt,"href",`#department-card-${e(je),x(()=>e(je).id)??""}`),Ut.disabled=e(I)||!e(E)||!e(M)}),la(Oa,()=>e(E),It=>d(E,It)),la(ie,()=>e(M),It=>d(M,It)),Q("click",qt,()=>Xe(e(je))),Q("submit",ha,Os(ze)),h(ra,Sa)};C(Lt,ra=>{e(A),e(je),x(()=>e(A)===e(je).id)&&ra(Aa)})}var Kt=v(Lt,2);{var ca=ra=>{var Sa=tx(),va=o(Sa),ha=v(o(va),2),Ot=o(ha),Pa=o(Ot),Oa=o(Pa),Ba=o(Oa);n(Oa);var ie=v(Oa,2),Ne=o(ie);sa(Ne);var mt=v(Ne,2);{var qt=At=>{const _t=Ks(()=>(e(l),e(f),x(()=>e(l).every(oa=>e(f).some(Ca=>Ca===oa.id)))));var Vt=Q0(),Wt=o(Vt),Ft=o(Wt,!0);n(Wt),n(Vt),$(()=>{$t(Vt,"title",`${e(_t)?"Deselect All":"Select All"} (${e(l),x(()=>e(l).length)??""})`),w(Ft,e(_t)?"deselect":"select_all")}),Q("click",Vt,Re),h(At,Vt)};C(mt,At=>{e(l),x(()=>e(l).length>0)&&At(qt)})}n(ie);var Ut=v(ie,2),Bt=o(Ut);Tt(Bt,1,()=>e(l),At=>At.id,(At,_t)=>{var Vt=J0();let Wt;var Ft=o(Vt),oa=v(o(Ft),2),Ca=o(oa,!0);n(oa);var Ta=v(oa,2),Ha=o(Ta);n(Ta),n(Ft);var ma=v(Ft,2),Fa=o(ma),Ht=o(Fa,!0);n(Fa),n(ma),n(Vt),$((na,pa)=>{Wt=oe(Vt,1,"dept-mgmt-subject-item",null,Wt,na),w(Ca,(e(_t),x(()=>e(_t).name))),w(Ha,`${e(_t),x(()=>e(_t).code)??""}  ${e(_t),x(()=>e(_t).gradeLevel)??""}`),w(Ht,pa)},[()=>({selected:e(f).some(na=>na===e(_t).id)}),()=>(e(f),e(_t),x(()=>e(f).some(na=>na===e(_t).id)?"check_box":"check_box_outline_blank"))]),Q("click",Vt,()=>$e(e(_t))),h(At,Vt)});var wt=v(Bt,2);{var fa=At=>{var _t=K0();h(At,_t)};C(wt,At=>{e(l),x(()=>e(l).length===0)&&At(fa)})}n(Ut),ia(2),n(Pa);var It=v(Pa,2),Zt=o(It),ea=o(Zt);n(Zt);var Ma=v(Zt,2),Ea=o(Ma);sa(Ea);var wa=v(Ea,2);{var Da=At=>{const _t=Ks(()=>(e(c),e(p),x(()=>e(c).every(oa=>e(p).some(Ca=>Ca===oa.id)))));var Vt=X0(),Wt=o(Vt),Ft=o(Wt,!0);n(Wt),n(Vt),$(()=>{$t(Vt,"title",`${e(_t)?"Deselect All":"Select All"} (${e(c),x(()=>e(c).length)??""})`),w(Ft,e(_t)?"deselect":"select_all")}),Q("click",Vt,Ze),h(At,Vt)};C(wa,At=>{e(c),x(()=>e(c).length>0)&&At(Da)})}n(Ma);var xa=v(Ma,2),ja=o(xa);Tt(ja,1,()=>e(c),At=>At.id,(At,_t)=>{var Vt=Z0();let Wt;var Ft=o(Vt),oa=v(o(Ft),2),Ca=o(oa,!0);n(oa);var Ta=v(oa,2),Ha=o(Ta,!0);n(Ta),n(Ft);var ma=v(Ft,2),Fa=o(ma),Ht=o(Fa,!0);n(Fa),n(ma),n(Vt),$((na,pa)=>{Wt=oe(Vt,1,"dept-mgmt-teacher-item",null,Wt,na),w(Ca,(e(_t),x(()=>e(_t).name))),w(Ha,(e(_t),x(()=>e(_t).accountNumber))),w(Ht,pa)},[()=>({selected:e(p).some(na=>na===e(_t).id)}),()=>(e(p),e(_t),x(()=>e(p).some(na=>na===e(_t).id)?"check_box":"check_box_outline_blank"))]),Q("click",Vt,()=>Je(e(_t))),h(At,Vt)});var Qa=v(ja,2);{var W=At=>{var _t=ex();h(At,_t)};C(Qa,At=>{e(c),x(()=>e(c).length===0)&&At(W)})}n(xa),ia(2),n(It),n(Ot);var _e=v(Ot,2),dt=o(_e),Nt=v(dt,2),we=o(Nt);{var it=At=>{var _t=ka("Assigning...");h(At,_t)},Mt=At=>{var _t=ka("Update");h(At,_t)};C(we,At=>{e(z)?At(it):At(Mt,!1)})}n(Nt),n(_e),n(ha),n(va),n(Sa),$(()=>{w(Ba,`Select Subjects (${e(f),x(()=>e(f).length)??""} selected)`),w(ea,`Select Teachers (${e(p),x(()=>e(p).length)??""} selected)`),Nt.disabled=e(z)}),la(Ne,()=>e(V),At=>d(V,At)),la(Ea,()=>e(L),At=>d(L,At)),Q("click",dt,()=>ve(e(je))),Q("submit",ha,Os(st)),h(ra,Sa)};C(Kt,ra=>{e(F),e(je),x(()=>e(F)===e(je).id)&&ra(ca)})}n(jt),$((ra,Sa,va,ha)=>{aa=oe(jt,1,"dept-mgmt-department-card",null,aa,ra),$t(jt,"id",`department-card-${e(je),x(()=>e(je).id)??""}`),w(ye,(e(je),x(()=>e(je).name))),$t(qe,"href",`#department-card-${e(je),x(()=>e(je).id)??""}`),$t(Ct,"title",(e(F),e(je),x(()=>e(F)===e(je).id?"Cancel Assign":"Assign"))),w(ua,(e(F),e(je),x(()=>e(F)===e(je).id?"close":"add_circle"))),$t(xe,"href",`#department-card-${e(je),x(()=>e(je).id)??""}`),$t(Te,"title",(e(A),e(je),x(()=>e(A)===e(je).id?"Cancel Edit":"Edit Department"))),w(bt,(e(A),e(je),x(()=>e(A)===e(je).id?"close":"edit"))),w(Rt,(e(je),x(()=>e(je).code))),w(ga,`${Sa??""} Subjects`),w(ya,`${va??""} Teachers`),w(Gt,`Created: ${ha??""}`)},[()=>({editing:e(A)===e(je).id,assigning:e(F)===e(je).id}),()=>(e(je),x(()=>We(e(je)).length)),()=>(e(je),x(()=>nt(e(je)).length)),()=>(e(je),x(()=>De(e(je).createdAt)))]),Q("click",Ct,()=>ve(e(je))),Q("click",Te,()=>Xe(e(je))),Q("click",ht,()=>tt(e(je))),h(He,jt)}),h(Dt,vt)};C(Ce,Dt=>{e(D),x(()=>e(D).length===0)?Dt(et):Dt(ft,!1)},!0)}h(Y,le)};C(Yt,Y=>{e(X)?Y(ge):Y(Qe,!1)})}n(gt),n(Ve),n(Ie),$((Y,le)=>{Ye.disabled=e(u),lt.disabled=e(u),T.disabled=e(u)||!e(g)||!e(y),K=oe(j,1,"custom-dropdown",null,K,Y),Oe=oe(ae,1,"dropdown-trigger filter-trigger",null,Oe,le)},[()=>({open:e(k)}),()=>({selected:e(S)!=="all"})]),la(Ye,()=>e(g),Y=>d(g,Y)),la(lt,()=>e(y),Y=>d(y,Y)),Q("click",T,me),la(be,()=>e(m),Y=>d(m,Y)),Q("click",ae,re),h(s,Ie),Ga()}function nx(s,t,a,i){d(t,!e(t)),d(a,!1),d(i,!1)}function rx(s,t,a,i){d(t,!e(t)),d(a,!1),d(i,!1)}function ox(s,t,a,i){d(t,!e(t)),d(a,!1),d(i,!1)}var lx=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),cx=_('<span class="admindocreq-placeholder">All Statuses</span>'),dx=(s,t)=>t(null),ux=(s,t,a)=>t(e(a)),vx=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">filter_list</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),fx=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),px=_('<span class="admindocreq-placeholder">All Document Types</span>'),hx=(s,t)=>t(null),mx=(s,t,a)=>t(e(a)),gx=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">description</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),_x=_('<div class="admindocreq-selected-option"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span></div></div>'),bx=_('<span class="admindocreq-placeholder">All Grades</span>'),yx=(s,t)=>t(null),wx=(s,t,a)=>t(e(a)),xx=_('<button type="button"><span class="material-symbols-outlined admindocreq-option-icon">school</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name"> </span> <span class="admindocreq-option-description"> </span></div></button>'),Sx=_('<div style="padding: 20px; background: #fee; border-radius: 8px; color: #c33; margin: 20px 0;"><strong>Error:</strong> </div>'),kx=_('<div style="padding: 40px; text-align: center; color: #666;"><span class="material-symbols-outlined" style="font-size: 48px; animation: spin 1s linear infinite;">sync</span> <p>Loading document requests...</p></div>'),Dx=_('<div style="padding: 40px; text-align: center; color: #999;"><span class="material-symbols-outlined" style="font-size: 48px;">description</span> <p>No document requests found</p></div>'),Ax=(s,t,a)=>t(e(a)),Cx=(s,t,a)=>{(s.key==="Enter"||s.key===" ")&&t(e(a))},Tx=_('<span class="material-symbols-outlined">pause_circle</span> <span>On Hold</span>',1),Mx=_('<span class="material-symbols-outlined">fact_check</span> <span>Verifying</span>',1),Px=_('<span class="material-symbols-outlined">sync</span> <span>For Processing</span>',1),Ex=_('<span class="material-symbols-outlined">hand_package</span> <span>For Pick up</span>',1),Fx=_('<span class="material-symbols-outlined">check_circle</span> <span>Released</span>',1),Nx=_('<div role="button" tabindex="0"><div class="docreq-request-header"><div class="docreq-request-info"><div class="docreq-student-info"><h3 class="docreq-student-name"> </h3></div></div> <div class="docreq-action-buttons"><div><!></div></div></div> <div class="docreq-request-details"><div class="docreq-detail-item"><span class="material-symbols-outlined">badge</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">school</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">description</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">tag</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">calendar_today</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">payments</span> <span> </span></div> <div class="docreq-detail-item"><span class="material-symbols-outlined">event</span> <span>Tentative Date: <!></span></div></div></div>'),Lx=_('<div class="docreq-requests-grid"></div>'),$x=_('<div class="admin-document-requests-container"><div class="admin-docreq-header"><div class="admin-header-content"><h1 class="admin-page-title">Document Requests</h1> <p class="admin-page-subtitle">Manage and process student document requests</p></div></div> <div class="docreq-status-cards-section"><div class="docreq-status-cards-grid"><div class="docreq-status-card docreq-status-onhold"><div class="docreq-status-icon"><span class="material-symbols-outlined">pause_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">On Hold</p></div></div> <div class="docreq-status-card docreq-status-verifying"><div class="docreq-status-icon"><span class="material-symbols-outlined">fact_check</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Verifying</p></div></div> <div class="docreq-status-card docreq-status-processing"><div class="docreq-status-icon"><span class="material-symbols-outlined">sync</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Processing</p></div></div> <div class="docreq-status-card docreq-status-pickup"><div class="docreq-status-icon"><span class="material-symbols-outlined">hand_package</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">For Pickup</p></div></div> <div class="docreq-status-card docreq-status-released"><div class="docreq-status-icon"><span class="material-symbols-outlined">check_circle</span></div> <div class="docreq-status-content"><h3 class="docreq-status-value"> </h3> <p class="docreq-status-label">Released</p></div></div></div></div> <div class="admin-docreq-filters-section"><div class="admin-section-header"><h2 class="admin-section-title">Filter Requests</h2> <p class="admin-section-subtitle">Search and filter document requests</p></div> <div class="admindocreq-filters-container"><div class="admindocreq-search-container"><input type="text" placeholder="Search by student name, ID, or document type..." class="admindocreq-search-input"/> <span class="material-symbols-outlined admindocreq-search-icon">search</span></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Statuses</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Document Types</span></div></button> <!></div></div> <div><button type="button"><!> <span class="material-symbols-outlined admindocreq-dropdown-arrow">expand_more</span></button> <div class="admindocreq-dropdown-menu"><button type="button"><span class="material-symbols-outlined admindocreq-option-icon">clear_all</span> <div class="admindocreq-option-content"><span class="admindocreq-option-name">All Grades</span></div></button> <!></div></div></div></div> <div class="admin-docreq-requests-section"><div class="docreq-section-header"><div class="docreq-section-header-content"><div class="docreq-section-title-group"><h2 class="docreq-section-title">Document Requests</h2> <p class="docreq-section-subtitle">Manage and review all student document requests</p></div></div></div> <!> <!></div></div>');function jx(s,t){za(t,!1);const a=P(),i=P(),r=P();let l=P([]),c=P(!0),u=P(null),f=P(""),p=P(""),m=P(""),g=P(""),y=P(!1),b=P(!1),D=P(!1);const S=[{value:7,label:"Grade 7",description:"Junior High School - First Year"},{value:8,label:"Grade 8",description:"Junior High School - Second Year"},{value:9,label:"Grade 9",description:"Junior High School - Third Year"},{value:10,label:"Grade 10",description:"Junior High School - Fourth Year"}],k=[{id:"transcript",name:"Transcript",description:"Official academic record"},{id:"enrollment",name:"Enrollment Certificate",description:"Proof of enrollment"},{id:"grade-report",name:"Grade Report",description:"Semester grade report"},{id:"diploma",name:"Diploma",description:"Official graduation certificate"},{id:"certificate",name:"Certificate",description:"Academic achievement certificate"}],A=[{id:"pending",name:"Pending",description:"Awaiting review"},{id:"on_hold",name:"On Hold",description:"Temporarily suspended"},{id:"verifying",name:"Verifying",description:"Under verification"},{id:"processing",name:"For Processing",description:"Currently being processed"},{id:"for_pickup",name:"For Pick Up",description:"Ready for pickup"},{id:"released",name:"Released",description:"Successfully released"},{id:"completed",name:"Completed",description:"Ready for pickup/download"},{id:"rejected",name:"Rejected",description:"Request denied"},{id:"cancelled",name:"Cancelled",description:"Cancelled by student"}],E=[{id:"on_hold",name:"On Hold"},{id:"verifying",name:"Verifying"},{id:"processing",name:"For Processing"},{id:"for_pickup",name:"For Pick Up"},{id:"released",name:"Released"}];function M(ye){ye?d(p,ye.id):d(p,""),d(y,!1)}function I(ye){ye?d(m,ye.id):d(m,""),d(b,!1)}function F(ye){ye?d(g,ye.value):d(g,""),d(D,!1)}function z(ye){ye.target.closest(".admindocreq-status-filter")||d(y,!1),ye.target.closest(".admindocreq-doctype-filter")||d(b,!1),ye.target.closest(".admindocreq-grade-filter")||d(D,!1)}function R(ye){ds.open("DocumentRequestModal",{title:"Request Details",request:{...ye},requestStatuses:A,modalStatuses:E,onUpdate:V,onReject:L},{size:"large",closable:!0,backdrop:!0})}async function J(){try{d(c,!0),d(u,null);const ye=new URLSearchParams({action:"all"});if(e(f)&&ye.append("search",e(f)),e(p)&&ye.append("status",e(p)),e(m)){const Ct=k.find(zt=>zt.id===e(m));Ct&&ye.append("documentType",Ct.name)}e(g)&&ye.append("gradeLevel",e(g));const qe=await(await bs(`/api/document-requests?${ye.toString()}`)).json();qe.success?d(l,qe.data):d(u,qe.error||"Failed to fetch document requests")}catch(ye){console.error("Error fetching document requests:",ye),d(u,"Failed to load document requests")}finally{d(c,!1)}}async function V(ye,H){try{const Ct=await(await bs("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update",requestId:ye,...H})})).json();return Ct.success?(await J(),!0):(d(u,Ct.error||"Failed to update request"),!1)}catch(qe){return console.error("Error updating request:",qe),d(u,"Failed to update request"),!1}}async function L(ye){try{const qe=await(await bs("/api/document-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject",requestId:ye})})).json();return qe.success?(await J(),!0):(d(u,qe.error||"Failed to reject request"),!1)}catch(H){return console.error("Error rejecting request:",H),d(u,"Failed to reject request"),!1}}let X=P(!1);Wa(()=>{J(),d(X,!0)});let ne=P(),ce=P(""),Le=P(""),fe=P(""),se=P("");Jt(()=>e(p),()=>{d(a,A.find(ye=>ye.id===e(p)))}),Jt(()=>e(m),()=>{d(i,k.find(ye=>ye.id===e(m)))}),Jt(()=>e(g),()=>{d(r,S.find(ye=>ye.value===e(g)))}),Jt(()=>(e(X),e(f),e(ce),e(ne)),()=>{e(X)&&e(f)!==e(ce)&&(d(ce,e(f)),clearTimeout(e(ne)),d(ne,setTimeout(()=>{J()},300)))}),Jt(()=>(e(X),e(p),e(Le),e(m),e(fe),e(g),e(se)),()=>{e(X)&&(e(p)!==e(Le)||e(m)!==e(fe)||e(g)!==e(se))&&(d(Le,e(p)),d(fe,e(m)),d(se,e(g)),J())}),Ss(),vs();var re=$x();Q("click",Ys,z);var Se=v(o(re),2),me=o(Se),ze=o(me),Xe=v(o(ze),2),tt=o(Xe),ve=o(tt,!0);n(tt),ia(2),n(Xe),n(ze);var $e=v(ze,2),Je=v(o($e),2),Re=o(Je),Ze=o(Re,!0);n(Re),ia(2),n(Je),n($e);var st=v($e,2),We=v(o(st),2),nt=o(We),ke=o(nt,!0);n(nt),ia(2),n(We),n(st);var De=v(st,2),Ie=v(o(De),2),Ee=o(Ie),ee=o(Ee,!0);n(Ee),ia(2),n(Ie),n(De);var Ue=v(De,2),rt=v(o(Ue),2),Ye=o(rt),at=o(Ye,!0);n(Ye),ia(2),n(rt),n(Ue),n(me),n(Se);var lt=v(Se,2),O=v(o(lt),2),T=o(O),U=o(T);sa(U),ia(2),n(T);var de=v(T,2);let Pe;var Ve=o(de);let Me;Ve.__click=[nx,y,b,D];var q=o(Ve);{var B=ye=>{var H=lx(),qe=v(o(H),2),Ct=o(qe),zt=o(Ct,!0);n(Ct),n(qe),n(H),$(()=>w(zt,(e(a),x(()=>e(a).name)))),h(ye,H)},N=ye=>{var H=cx();h(ye,H)};C(q,ye=>{e(a)?ye(B):ye(N,!1)})}ia(2),n(Ve);var Z=v(Ve,2),be=o(Z);let Fe;be.__click=[dx,M];var he=v(be,2);Tt(he,1,()=>A,ye=>ye.id,(ye,H)=>{var qe=vx();let Ct;qe.__click=[ux,M,H];var zt=v(o(qe),2),ua=o(zt),xe=o(ua,!0);n(ua);var Te=v(ua,2),ue=o(Te,!0);n(Te),n(zt),n(qe),$(bt=>{Ct=oe(qe,1,"admindocreq-dropdown-option",null,Ct,bt),w(xe,(e(H),x(()=>e(H).name))),w(ue,(e(H),x(()=>e(H).description)))},[()=>({selected:e(p)===e(H).id})]),h(ye,qe)}),n(Z),n(de);var te=v(de,2);let j;var K=o(te);let ae;K.__click=[rx,b,y,D];var Oe=o(K);{var Be=ye=>{var H=fx(),qe=v(o(H),2),Ct=o(qe),zt=o(Ct,!0);n(Ct),n(qe),n(H),$(()=>w(zt,(e(i),x(()=>e(i).name)))),h(ye,H)},Ke=ye=>{var H=px();h(ye,H)};C(Oe,ye=>{e(i)?ye(Be):ye(Ke,!1)})}ia(2),n(K);var Ge=v(K,2),ot=o(Ge);let gt;ot.__click=[hx,I];var Yt=v(ot,2);Tt(Yt,1,()=>k,ye=>ye.id,(ye,H)=>{var qe=gx();let Ct;qe.__click=[mx,I,H];var zt=v(o(qe),2),ua=o(zt),xe=o(ua,!0);n(ua);var Te=v(ua,2),ue=o(Te,!0);n(Te),n(zt),n(qe),$(bt=>{Ct=oe(qe,1,"admindocreq-dropdown-option",null,Ct,bt),w(xe,(e(H),x(()=>e(H).name))),w(ue,(e(H),x(()=>e(H).description)))},[()=>({selected:e(m)===e(H).id})]),h(ye,qe)}),n(Ge),n(te);var ge=v(te,2);let Qe;var Y=o(ge);let le;Y.__click=[ox,D,y,b];var Ce=o(Y);{var et=ye=>{var H=_x(),qe=v(o(H),2),Ct=o(qe),zt=o(Ct,!0);n(Ct),n(qe),n(H),$(()=>w(zt,(e(r),x(()=>e(r).label)))),h(ye,H)},ft=ye=>{var H=bx();h(ye,H)};C(Ce,ye=>{e(r)?ye(et):ye(ft,!1)})}ia(2),n(Y);var Dt=v(Y,2),vt=o(Dt);let Qt;vt.__click=[yx,F];var He=v(vt,2);Tt(He,1,()=>S,ye=>ye.value,(ye,H)=>{var qe=xx();let Ct;qe.__click=[wx,F,H];var zt=v(o(qe),2),ua=o(zt),xe=o(ua,!0);n(ua);var Te=v(ua,2),ue=o(Te,!0);n(Te),n(zt),n(qe),$(bt=>{Ct=oe(qe,1,"admindocreq-dropdown-option",null,Ct,bt),w(xe,(e(H),x(()=>e(H).label))),w(ue,(e(H),x(()=>e(H).description)))},[()=>({selected:e(g)===e(H).value})]),h(ye,qe)}),n(Dt),n(ge),n(O),n(lt);var je=v(lt,2),jt=v(o(je),2);{var aa=ye=>{var H=Sx(),qe=v(o(H));n(H),$(()=>w(qe,` ${e(u)??""}`)),h(ye,H)};C(jt,ye=>{e(u)&&ye(aa)})}var St=v(jt,2);{var xt=ye=>{var H=kx();h(ye,H)},Pt=ye=>{var H=Et(),qe=ut(H);{var Ct=ua=>{var xe=Dx();h(ua,xe)},zt=ua=>{var xe=Lx();Tt(xe,5,()=>e(l),Te=>Te.id,(Te,ue)=>{var bt=Nx();bt.__click=[Ax,R,ue],bt.__keydown=[Cx,R,ue];var ht=o(bt),G=o(ht),pe=o(G),pt=o(pe),Rt=o(pt,!0);n(pt),n(pe),n(G);var ct=v(G,2),Xt=o(ct),ga=o(Xt);{var ba=It=>{var Zt=Tx();ia(2),h(It,Zt)},_a=It=>{var Zt=Et(),ea=ut(Zt);{var Ma=wa=>{var Da=Mx();ia(2),h(wa,Da)},Ea=wa=>{var Da=Et(),xa=ut(Da);{var ja=W=>{var _e=Px();ia(2),h(W,_e)},Qa=W=>{var _e=Et(),dt=ut(_e);{var Nt=it=>{var Mt=Ex();ia(2),h(it,Mt)},we=it=>{var Mt=Et(),At=ut(Mt);{var _t=Vt=>{var Wt=Fx();ia(2),h(Vt,Wt)};C(At,Vt=>{e(ue),x(()=>e(ue).status==="released")&&Vt(_t)},!0)}h(it,Mt)};C(dt,it=>{e(ue),x(()=>e(ue).status==="for_pickup")?it(Nt):it(we,!1)},!0)}h(W,_e)};C(xa,W=>{e(ue),x(()=>e(ue).status==="processing")?W(ja):W(Qa,!1)},!0)}h(wa,Da)};C(ea,wa=>{e(ue),x(()=>e(ue).status==="verifying")?wa(Ma):wa(Ea,!1)},!0)}h(It,Zt)};C(ga,It=>{e(ue),x(()=>e(ue).status==="on_hold")?It(ba):It(_a,!1)})}n(Xt),n(ct),n(ht);var ya=v(ht,2),ta=o(ya),yt=v(o(ta),2),Gt=o(yt,!0);n(yt),n(ta);var Lt=v(ta,2),Aa=v(o(Lt),2),Kt=o(Aa,!0);n(Aa),n(Lt);var ca=v(Lt,2),ra=v(o(ca),2),Sa=o(ra,!0);n(ra),n(ca);var va=v(ca,2),ha=v(o(va),2),Ot=o(ha);n(ha),n(va);var Pa=v(va,2),Oa=v(o(Pa),2),Ba=o(Oa);n(Oa),n(Pa);var ie=v(Pa,2),Ne=v(o(ie),2),mt=o(Ne,!0);n(Ne),n(ie);var qt=v(ie,2),Ut=v(o(qt),2),Bt=v(o(Ut));{var wt=It=>{var Zt=ka();$(()=>w(Zt,(e(ue),x(()=>e(ue).tentativeDate||"--/--/----")))),h(It,Zt)},fa=It=>{var Zt=ka("N/A");h(It,Zt)};C(Bt,It=>{e(ue),x(()=>e(ue).status==="processing")?It(wt):It(fa,!1)})}n(Ut),n(qt),n(ya),n(bt),$(()=>{oe(bt,1,`docreq-request-card status-${e(ue),x(()=>e(ue).status)??""}-border`),w(Rt,(e(ue),x(()=>e(ue).studentName))),oe(Xt,1,`docreq-status-badge docreq-status-${e(ue),x(()=>e(ue).status)??""}`),w(Gt,(e(ue),x(()=>e(ue).studentId))),w(Kt,(e(ue),x(()=>e(ue).gradeLevel))),w(Sa,(e(ue),x(()=>e(ue).documentType))),w(Ot,`ID: ${e(ue),x(()=>e(ue).requestId)??""}`),w(Ba,`Requested: ${e(ue),x(()=>e(ue).submittedDate)??""}`),w(mt,(e(ue),x(()=>e(ue).payment)))}),h(Te,bt)}),n(xe),h(ua,xe)};C(qe,ua=>{e(l),x(()=>e(l).length===0)?ua(Ct):ua(zt,!1)},!0)}h(ye,H)};C(St,ye=>{e(c)?ye(xt):ye(Pt,!1)})}n(je),n(re),$((ye,H,qe,Ct,zt,ua,xe,Te,ue,bt,ht,G,pe,pt)=>{w(ve,ye),w(Ze,H),w(ke,qe),w(ee,Ct),w(at,zt),Pe=oe(de,1,"admindocreq-status-filter admindocreq-custom-dropdown",null,Pe,ua),Me=oe(Ve,1,"admindocreq-dropdown-trigger",null,Me,xe),Fe=oe(be,1,"admindocreq-dropdown-option",null,Fe,Te),j=oe(te,1,"admindocreq-doctype-filter admindocreq-custom-dropdown",null,j,ue),ae=oe(K,1,"admindocreq-dropdown-trigger",null,ae,bt),gt=oe(ot,1,"admindocreq-dropdown-option",null,gt,ht),Qe=oe(ge,1,"admindocreq-grade-filter admindocreq-custom-dropdown",null,Qe,G),le=oe(Y,1,"admindocreq-dropdown-trigger",null,le,pe),Qt=oe(vt,1,"admindocreq-dropdown-option",null,Qt,pt)},[()=>(e(l),x(()=>e(l).filter(ye=>ye.status==="on_hold").length)),()=>(e(l),x(()=>e(l).filter(ye=>ye.status==="verifying").length)),()=>(e(l),x(()=>e(l).filter(ye=>ye.status==="processing").length)),()=>(e(l),x(()=>e(l).filter(ye=>ye.status==="for_pickup").length)),()=>(e(l),x(()=>e(l).filter(ye=>ye.status==="released").length)),()=>({open:e(y)}),()=>({selected:e(p)}),()=>({selected:e(p)===""}),()=>({open:e(b)}),()=>({selected:e(m)}),()=>({selected:e(m)===""}),()=>({open:e(D)}),()=>({selected:e(g)}),()=>({selected:e(g)===""})]),la(U,()=>e(f),ye=>d(f,ye)),h(s,re),Ga()}Is(["click","keydown"]);function Ix(s,t,a,i,r){ds.confirm("Change Password",`
			<div class="admin-settings-password-form">
				<div class="admin-settings-form-group">
					<label for="current-password">Current Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="current-password"
							type="password" 
							placeholder="Enter current password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('current-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="new-password">New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="new-password"
							type="password" 
							placeholder="Enter new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('new-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
				
				<div class="admin-settings-form-group">
					<label for="confirm-password">Confirm New Password</label>
					<div class="admin-settings-password-input-wrapper">
						<input 
							id="confirm-password"
							type="password" 
							placeholder="Confirm new password"
							class="admin-settings-form-input"
						/>
						<button type="button" class="admin-settings-password-toggle" onclick="togglePasswordVisibility('confirm-password')">
							<svg class="password-eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
								<line x1="1" y1="1" x2="23" y2="23"/>
							</svg>
						</button>
					</div>
				</div>
			</div>
		`,t,()=>{d(a,""),d(i,""),d(r,"")},{size:"medium"})}var Rx=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),Ox=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),qx=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),Vx=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),Bx=_('<div class="admin-settings-date-error"><span class="material-symbols-outlined">error</span> </div>'),zx=_('<span class="material-symbols-outlined">check</span> Apply Date Changes',1),Gx=_('<div class="admin-settings-container"><div class="admin-settings-header"><div class="admin-settings-header-content"><h1 class="admin-settings-page-title">Admin Settings</h1> <p class="admin-settings-page-subtitle">Manage system settings and configurations</p></div></div> <div class="admin-settings-section"><div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Current School Year</h3> <p class="admin-settings-item-description">The active academic year for the system</p></div> <div class="admin-settings-item-value"><span class="admin-settings-current-year"> </span></div></div></div></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">School Year Dates</h3> <p class="admin-settings-item-description">Set the start and end dates for classes</p></div></div> <div class="admin-settings-dates-section"><div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="start-date" class="admin-settings-date-label">Start of Classes</label> <input id="start-date" type="date"/></div> <div class="admin-settings-date-item"><label for="end-date" class="admin-settings-date-label">End of Classes</label> <input id="end-date" type="date"/></div></div> <div class="admin-settings-quarters-section svelte-jysw9o"><h4 class="admin-settings-quarters-title svelte-jysw9o">Quarter Schedules</h4> <div class="admin-settings-quarters-row svelte-jysw9o"><div class="admin-settings-quarter-group quarter-1 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">1st Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q1-start" class="admin-settings-date-label">Start</label> <input id="q1-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q1-end" class="admin-settings-date-label">End</label> <input id="q1-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-2 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">2nd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q2-start" class="admin-settings-date-label">Start</label> <input id="q2-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q2-end" class="admin-settings-date-label">End</label> <input id="q2-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-3 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">3rd Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q3-start" class="admin-settings-date-label">Start</label> <input id="q3-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q3-end" class="admin-settings-date-label">End</label> <input id="q3-end" type="date"/></div></div> <!></div> <div class="admin-settings-quarter-group quarter-4 svelte-jysw9o"><div class="admin-settings-quarter-header svelte-jysw9o"><span class="admin-settings-quarter-label svelte-jysw9o">4th Quarter</span></div> <div class="admin-settings-date-group"><div class="admin-settings-date-item"><label for="q4-start" class="admin-settings-date-label">Start</label> <input id="q4-start" type="date"/></div> <div class="admin-settings-date-item"><label for="q4-end" class="admin-settings-date-label">End</label> <input id="q4-end" type="date"/></div></div> <!></div></div></div> <!></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><!></button></div></div></div></div> <div class="admin-settings-section"><div class="admin-settings-section-header"><h2 class="admin-settings-section-title">Account Security</h2> <p class="admin-settings-section-subtitle">Manage your account password and security settings</p></div> <div class="admin-settings-card"><div class="admin-settings-card-content"><div class="admin-settings-item"><div class="admin-settings-item-info"><h3 class="admin-settings-item-label">Password</h3> <p class="admin-settings-item-description">Change your account password for security</p></div> <div class="admin-settings-actions"><button class="admin-settings-action-button admin-settings-primary"><span class="material-symbols-outlined">lock</span> Change Password</button></div></div></div></div></div></div>');function Wx(s,t){za(t,!0);let a=kt(!1),i=kt(!1),r=kt("2024-2025"),l=kt(""),c=kt("");function u(H,qe){if(!H||!qe)return"2024-2025";const Ct=new Date(H),zt=new Date(qe),ua=Ct.getFullYear(),xe=zt.getFullYear();return xe>ua?`${ua}-${xe}`:`${ua}-${ua}`}let f=kt(""),p=kt(""),m=kt(""),g=kt(""),y=kt(""),b=kt(""),D=kt(""),S=kt("");async function k(){try{d(a,!0);const H=await da.get("/api/admin-settings");if(H.success){let Ct=function(zt){if(!zt)return zt;const[ua,xe,Te]=zt.split("-");return`${Te}-${ua}-${xe}`};const qe=H.data;d(l,Ct(qe.school_year_start_date)||"",!0),d(c,Ct(qe.school_year_end_date)||"",!0),d(r,u(e(l),e(c)),!0),d(f,Ct(qe.quarter_1_start_date)||"",!0),d(p,Ct(qe.quarter_1_end_date)||"",!0),d(m,Ct(qe.quarter_2_start_date)||"",!0),d(g,Ct(qe.quarter_2_end_date)||"",!0),d(y,Ct(qe.quarter_3_start_date)||"",!0),d(b,Ct(qe.quarter_3_end_date)||"",!0),d(D,Ct(qe.quarter_4_start_date)||"",!0),d(S,Ct(qe.quarter_4_end_date)||"",!0)}}catch(H){console.error("Error loading admin settings:",H),ns("Failed to load admin settings")}finally{d(a,!1)}}async function A(){try{let H=function(zt){if(!zt)return zt;const[ua,xe,Te]=zt.split("-");return`${xe}-${Te}-${ua}`};d(i,!0);const qe={current_school_year:e(r),school_year_start_date:H(e(l)),school_year_end_date:H(e(c)),quarter_1_start_date:H(e(f)),quarter_1_end_date:H(e(p)),quarter_2_start_date:H(e(m)),quarter_2_end_date:H(e(g)),quarter_3_start_date:H(e(y)),quarter_3_end_date:H(e(b)),quarter_4_start_date:H(e(D)),quarter_4_end_date:H(e(S))},Ct=await da.put("/api/admin-settings",{settings:qe});if(Ct.success)bi("Admin settings saved successfully");else throw new Error(Ct.error||"Failed to save settings")}catch(H){console.error("Error saving admin settings:",H),ns("Failed to save admin settings")}finally{d(i,!1)}}let E=kt("");Xs(()=>{if(e(l)&&e(c)){const H=new Date(e(l)),qe=new Date(e(c));H>=qe?d(E,"Start date must be before end date"):(d(E,""),d(r,u(e(l),e(c)),!0))}else d(E,"")});let M={quarter1:"",quarter2:"",quarter3:"",quarter4:""};Xs(()=>{if(e(f)&&e(p)){const H=new Date(e(f)),qe=new Date(e(p));H>=qe?M.quarter1="1st Quarter start date must be before end date":M.quarter1=""}else M.quarter1="";if(e(m)&&e(g)){const H=new Date(e(m)),qe=new Date(e(g));H>=qe?M.quarter2="2nd Quarter start date must be before end date":M.quarter2=""}else M.quarter2="";if(e(y)&&e(b)){const H=new Date(e(y)),qe=new Date(e(b));H>=qe?M.quarter3="3rd Quarter start date must be before end date":M.quarter3=""}else M.quarter3="";if(e(D)&&e(S)){const H=new Date(e(D)),qe=new Date(e(S));H>=qe?M.quarter4="4th Quarter start date must be before end date":M.quarter4=""}else M.quarter4=""});async function I(){if(e(E)){console.error("Cannot apply changes: Date validation error");return}if(Object.values(M).some(qe=>qe!=="")){console.error("Cannot apply changes: Quarter validation errors");return}await A()}let F=kt(""),z=kt(""),R=kt(""),J=kt(!1);function V(H){const qe=document.getElementById(H),zt=qe.nextElementSibling.querySelector(".password-eye-icon");qe.type==="password"?(qe.type="text",zt.innerHTML='<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>'):(qe.type="password",zt.innerHTML='<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>')}typeof window<"u"&&(window.togglePasswordVisibility=V);async function L(){const H=document.getElementById("current-password"),qe=document.getElementById("new-password"),Ct=document.getElementById("confirm-password");if(!H||!qe||!Ct){ns("Password form inputs not found");return}const zt=H.value,ua=qe.value,xe=Ct.value;if(!zt){ns("Current password is required");return}if(!ua){ns("New password is required");return}if(ua!==xe){ns("New passwords do not match");return}if(ua.length<8){ns("Password must be at least 8 characters long");return}if(zt===ua){ns("New password must be different from current password");return}try{d(J,!0);const Te=await da.post("/api/change-password",{currentPassword:zt,newPassword:ua});Te.success?(H.value="",qe.value="",Ct.value="",bi("Password changed successfully!"),ds.close()):ns(Te.error||"Failed to change password")}catch(Te){console.error("Password change error:",Te),ns(Te.message||"Failed to change password")}finally{d(J,!1)}}Wa(()=>{k()});var X=Gx(),ne=v(o(X),2),ce=o(ne),Le=o(ce),fe=o(Le),se=v(o(fe),2),re=o(se),Se=o(re,!0);n(re),n(se),n(fe),n(Le),n(ce);var me=v(ce,2),ze=o(me),Xe=v(o(ze),2),tt=o(Xe),ve=o(tt),$e=v(o(ve),2);sa($e);let Je;n(ve);var Re=v(ve,2),Ze=v(o(Re),2);sa(Ze);let st;n(Re),n(tt);var We=v(tt,2),nt=v(o(We),2),ke=o(nt),De=v(o(ke),2),Ie=o(De),Ee=v(o(Ie),2);sa(Ee);let ee;n(Ie);var Ue=v(Ie,2),rt=v(o(Ue),2);sa(rt);let Ye;n(Ue),n(De);var at=v(De,2);{var lt=H=>{var qe=Rx(),Ct=v(o(qe));n(qe),$(()=>w(Ct,` ${M.quarter1??""}`)),h(H,qe)};C(at,H=>{M.quarter1&&H(lt)})}n(ke);var O=v(ke,2),T=v(o(O),2),U=o(T),de=v(o(U),2);sa(de);let Pe;n(U);var Ve=v(U,2),Me=v(o(Ve),2);sa(Me);let q;n(Ve),n(T);var B=v(T,2);{var N=H=>{var qe=Ox(),Ct=v(o(qe));n(qe),$(()=>w(Ct,` ${M.quarter2??""}`)),h(H,qe)};C(B,H=>{M.quarter2&&H(N)})}n(O);var Z=v(O,2),be=v(o(Z),2),Fe=o(be),he=v(o(Fe),2);sa(he);let te;n(Fe);var j=v(Fe,2),K=v(o(j),2);sa(K);let ae;n(j),n(be);var Oe=v(be,2);{var Be=H=>{var qe=qx(),Ct=v(o(qe));n(qe),$(()=>w(Ct,` ${M.quarter3??""}`)),h(H,qe)};C(Oe,H=>{M.quarter3&&H(Be)})}n(Z);var Ke=v(Z,2),Ge=v(o(Ke),2),ot=o(Ge),gt=v(o(ot),2);sa(gt);let Yt;n(ot);var ge=v(ot,2),Qe=v(o(ge),2);sa(Qe);let Y;n(ge),n(Ge);var le=v(Ge,2);{var Ce=H=>{var qe=Vx(),Ct=v(o(qe));n(qe),$(()=>w(Ct,` ${M.quarter4??""}`)),h(H,qe)};C(le,H=>{M.quarter4&&H(Ce)})}n(Ke),n(nt),n(We);var et=v(We,2);{var ft=H=>{var qe=Bx(),Ct=v(o(qe));n(qe),$(()=>w(Ct,` ${e(E)??""}`)),h(H,qe)};C(et,H=>{e(E)&&H(ft)})}n(Xe);var Dt=v(Xe,2),vt=o(Dt);vt.__click=I;var Qt=o(vt);{var He=H=>{var qe=ka("Saving...");h(H,qe)},je=H=>{var qe=zx();ia(),h(H,qe)};C(Qt,H=>{e(i)?H(He):H(je,!1)})}n(vt),n(Dt),n(ze),n(me),n(ne);var jt=v(ne,2),aa=v(o(jt),2),St=o(aa),xt=o(St),Pt=v(o(xt),2),ye=o(Pt);ye.__click=[Ix,L,F,z,R],n(Pt),n(xt),n(St),n(aa),n(jt),n(X),$((H,qe,Ct,zt,ua,xe,Te,ue,bt,ht)=>{w(Se,e(r)),Je=oe($e,1,"admin-settings-date-input",null,Je,H),st=oe(Ze,1,"admin-settings-date-input",null,st,qe),ee=oe(Ee,1,"admin-settings-date-input quarter-1-input",null,ee,Ct),Ye=oe(rt,1,"admin-settings-date-input quarter-1-input",null,Ye,zt),Pe=oe(de,1,"admin-settings-date-input quarter-2-input",null,Pe,ua),q=oe(Me,1,"admin-settings-date-input quarter-2-input",null,q,xe),te=oe(he,1,"admin-settings-date-input quarter-3-input",null,te,Te),ae=oe(K,1,"admin-settings-date-input quarter-3-input",null,ae,ue),Yt=oe(gt,1,"admin-settings-date-input quarter-4-input",null,Yt,bt),Y=oe(Qe,1,"admin-settings-date-input quarter-4-input",null,Y,ht),vt.disabled=e(i)||e(a)||!!e(E)||M.quarter1||M.quarter2||M.quarter3||M.quarter4||!e(l)||!e(c)},[()=>({error:e(E)}),()=>({error:e(E)}),()=>({error:M.quarter1}),()=>({error:M.quarter1}),()=>({error:M.quarter2}),()=>({error:M.quarter2}),()=>({error:M.quarter3}),()=>({error:M.quarter3}),()=>({error:M.quarter4}),()=>({error:M.quarter4})]),la($e,()=>e(l),H=>d(l,H)),la(Ze,()=>e(c),H=>d(c,H)),la(Ee,()=>e(f),H=>d(f,H)),la(rt,()=>e(p),H=>d(p,H)),la(de,()=>e(m),H=>d(m,H)),la(Me,()=>e(g),H=>d(g,H)),la(he,()=>e(y),H=>d(y,H)),la(K,()=>e(b),H=>d(b,H)),la(gt,()=>e(D),H=>d(D,H)),la(Qe,()=>e(S),H=>d(S,H)),h(s,X),Ga()}Is(["click"]);var Hx=_('<meta name="description" content="High School Student Information System"/>'),Yx=_('<div><!> <main class="content-area"><!></main> <!></div>'),Ux=_('<div><!> <main class="content-area"><!></main> <!></div>'),Qx=_('<div><!> <main class="content-area"><!></main> <!></div>'),Jx=_('<div class="app-container"><!></div>');function iS(s,t){za(t,!0);let a=kt(void 0);Xs(()=>ms.subscribe(L=>{d(a,L,!0)}));let i=kt("grades"),r=kt("schedule"),l=kt("dashboard"),c=kt(!1),u=kt(!1),f=kt(!1);function p(V){typeof V=="string"?d(i,V,!0):d(i,V.detail.section,!0)}function m(V){typeof V=="string"?d(r,V,!0):d(r,V.detail.section,!0),(typeof V=="string"?V:V.detail.section)!=="class-list"&&d(b,null)}function g(V){const{yearLevel:L,sectionName:X,sectionId:ne}=V.detail;d(b,{yearLevel:L,sectionName:X,sectionId:ne},!0),d(r,"class-list")}function y(){d(b,null),d(r,"students")}let b=kt(null);function D(V){d(l,V.detail.section,!0)}function S(){d(l,"settings")}function k(){d(c,!e(c))}function A(){d(u,!e(u))}function E(){d(f,!e(f))}async function M(){await ms.logout(),d(i,"grades"),d(r,"schedule"),d(l,"dashboard")}let I=Ra(()=>e(a)?.isAuthenticated?e(a).userType==="student"?"Student Portal - High School":e(a).userType==="teacher"?"Teacher Portal - High School":e(a).userType==="admin"?"Admin Portal - High School":"High School Student Information System":"Login - High School Student Information System");var F=Jx();Jc(V=>{var L=Hx();$(()=>Kc.title=e(I)),h(V,L)});var z=o(F);{var R=V=>{qd(V,{})},J=V=>{var L=Et(),X=ut(L);{var ne=Le=>{var fe=Yx();let se;var re=o(fe);{let ve=Ra(()=>e(a).userData?.name||"Student"),$e=Ra(()=>e(a).userData?.firstName||"Student"),Je=Ra(()=>e(a).userData?.gender||"male"),Re=Ra(()=>e(a).userData?.accountNumber||"N/A"),Ze=Ra(()=>e(a).userData?.profileImage);Qd(re,{get studentName(){return e(ve)},get firstName(){return e($e)},get gender(){return e(Je)},get accountNumber(){return e(Re)},get profileImage(){return e(Ze)},onlogout:M,onToggleNavRail:k,onnavigate:p})}var Se=v(re,2),me=o(Se);{var ze=ve=>{Cu(ve,{})},Xe=ve=>{var $e=Et(),Je=ut($e);{var Re=st=>{tv(st,{})},Ze=st=>{var We=Et(),nt=ut(We);{var ke=Ie=>{hv(Ie,{})},De=Ie=>{var Ee=Et(),ee=ut(Ee);{var Ue=Ye=>{Nv(Ye,{})},rt=Ye=>{var at=Et(),lt=ut(at);{var O=U=>{Uv(U,{})},T=U=>{var de=Et(),Pe=ut(de);{var Ve=Me=>{gf(Me,{})};C(Pe,Me=>{e(i)==="todo"&&Me(Ve)},!0)}h(U,de)};C(lt,U=>{e(i)==="notifications"?U(O):U(T,!1)},!0)}h(Ye,at)};C(ee,Ye=>{e(i)==="documents"?Ye(Ue):Ye(rt,!1)},!0)}h(Ie,Ee)};C(nt,Ie=>{e(i)==="schedule"?Ie(ke):Ie(De,!1)},!0)}h(st,We)};C(Je,st=>{e(i)==="grades"?st(Re):st(Ze,!1)},!0)}h(ve,$e)};C(me,ve=>{e(i)==="profile"?ve(ze):ve(Xe,!1)})}n(Se);var tt=v(Se,2);ou(tt,{get activeSection(){return e(i)},get isNavRailVisible(){return e(c)},onnavigate:p}),n(fe),$(ve=>se=oe(fe,1,"student-portal",null,se,ve),[()=>({"nav-rail-collapsed":!e(c)})]),h(Le,fe)},ce=Le=>{var fe=Et(),se=ut(fe);{var re=me=>{var ze=Ux();let Xe;var tt=o(ze);{let st=Ra(()=>e(a).userData?.name||"Teacher"),We=Ra(()=>e(a).userData?.firstName||"Teacher"),nt=Ra(()=>e(a).userData?.gender||"male"),ke=Ra(()=>e(a).userData?.accountNumber||"N/A"),De=Ra(()=>e(a).userData?.profileImage);Af(tt,{get teacherName(){return e(st)},get firstName(){return e(We)},get gender(){return e(nt)},get accountNumber(){return e(ke)},get profileImage(){return e(De)},onlogout:M,onToggleNavRail:A,onnavigate:m})}var ve=v(tt,2),$e=o(ve);{var Je=st=>{ep(st,{})},Re=st=>{var We=Et(),nt=ut(We);{var ke=Ie=>{bp(Ie,{})},De=Ie=>{var Ee=Et(),ee=ut(Ee);{var Ue=Ye=>{Lo(Ye,{onNavigateToClassList:g})},rt=Ye=>{var at=Et(),lt=ut(at);{var O=U=>{rh(U,{get selectedClass(){return e(b)},onBackToClassManagement:y})},T=U=>{var de=Et(),Pe=ut(de);{var Ve=q=>{wh(q,{})},Me=q=>{Lo(q,{onNavigateToClassList:g})};C(Pe,q=>{e(r)==="advisory"?q(Ve):q(Me,!1)},!0)}h(U,de)};C(lt,U=>{e(r)==="class-list"&&e(b)?U(O):U(T,!1)},!0)}h(Ye,at)};C(ee,Ye=>{e(r)==="students"?Ye(Ue):Ye(rt,!1)},!0)}h(Ie,Ee)};C(nt,Ie=>{e(r)==="schedule"?Ie(ke):Ie(De,!1)},!0)}h(st,We)};C($e,st=>{e(r)==="profile"?st(Je):st(Re,!1)})}n(ve);var Ze=v(ve,2);{let st=Ra(()=>e(a).userData?.id);Ff(Ze,{get teacherActiveSection(){return e(r)},get teacherNavRailVisible(){return e(u)},onnavigate:m,get teacherId(){return e(st)}})}n(ze),$(st=>Xe=oe(ze,1,"teacher-portal",null,Xe,st),[()=>({"nav-rail-collapsed":!e(u)})]),h(me,ze)},Se=me=>{var ze=Et(),Xe=ut(ze);{var tt=ve=>{var $e=Qx();let Je;var Re=o($e);{let De=Ra(()=>e(a).userData?.name||"Admin"),Ie=Ra(()=>e(a).userData?.firstName||"Admin"),Ee=Ra(()=>e(a).userData?.gender||"male"),ee=Ra(()=>e(a).userData?.accountNumber||"N/A"),Ue=Ra(()=>e(a).userData?.profileImage);Ph(Re,{get adminName(){return e(De)},get firstName(){return e(Ie)},get gender(){return e(Ee)},get accountNumber(){return e(ee)},get profileImage(){return e(Ue)},onlogout:M,onToggleNavRail:E,onNavigateToSettings:S})}var Ze=v(Re,2),st=o(Ze);{var We=De=>{oy(De,{})},nt=De=>{var Ie=Et(),Ee=ut(Ie);{var ee=rt=>{Jy(rt,{})},Ue=rt=>{var Ye=Et(),at=ut(Ye);{var lt=T=>{_1(T,{})},O=T=>{var U=Et(),de=ut(U);{var Pe=Me=>{V1(Me,{})},Ve=Me=>{var q=Et(),B=ut(q);{var N=be=>{i2(be,{})},Z=be=>{var Fe=Et(),he=ut(Fe);{var te=K=>{l0(K)},j=K=>{var ae=Et(),Oe=ut(ae);{var Be=Ge=>{ix(Ge,{})},Ke=Ge=>{var ot=Et(),gt=ut(ot);{var Yt=Qe=>{q0(Qe,{})},ge=Qe=>{var Y=Et(),le=ut(Y);{var Ce=ft=>{jx(ft,{})},et=ft=>{var Dt=Et(),vt=ut(Dt);{var Qt=He=>{Wx(He,{})};C(vt,He=>{e(l)==="settings"&&He(Qt)},!0)}h(ft,Dt)};C(le,ft=>{e(l)==="document-requests"?ft(Ce):ft(et,!1)},!0)}h(Qe,Y)};C(gt,Qe=>{e(l)==="subjects-and-activities"?Qe(Yt):Qe(ge,!1)},!0)}h(Ge,ot)};C(Oe,Ge=>{e(l)==="department-management"?Ge(Be):Ge(Ke,!1)},!0)}h(K,ae)};C(he,K=>{e(l)==="schedule-management"?K(te):K(j,!1)},!0)}h(be,Fe)};C(B,be=>{e(l)==="student-grades-list"?be(N):be(Z,!1)},!0)}h(Me,q)};C(de,Me=>{e(l)==="archived-students"?Me(Pe):Me(Ve,!1)},!0)}h(T,U)};C(at,T=>{e(l)==="student-masterlist"?T(lt):T(O,!1)},!0)}h(rt,Ye)};C(Ee,rt=>{e(l)==="account-creation"?rt(ee):rt(Ue,!1)},!0)}h(De,Ie)};C(st,De=>{e(l)==="dashboard"?De(We):De(nt,!1)})}n(Ze);var ke=v(Ze,2);Qh(ke,{get adminActiveSection(){return e(l)},get adminNavRailVisible(){return e(f)},onnavigate:D}),n($e),$(De=>Je=oe($e,1,"admin-portal",null,Je,De),[()=>({"nav-rail-collapsed":!e(f)})]),h(ve,$e)};C(Xe,ve=>{e(a).userType==="admin"&&ve(tt)},!0)}h(me,ze)};C(se,me=>{e(a).userType==="teacher"?me(re):me(Se,!1)},!0)}h(Le,fe)};C(X,Le=>{e(a).userType==="student"?Le(ne):Le(ce,!1)},!0)}h(V,L)};C(z,V=>{e(a)?.isAuthenticated?V(J,!1):V(R)})}n(F),h(s,F),Ga()}export{iS as component};
