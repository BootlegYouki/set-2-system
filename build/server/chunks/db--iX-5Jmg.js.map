{"version":3,"file":"db--iX-5Jmg.js","sources":["../../../.svelte-kit/adapter-node/chunks/db.js"],"sourcesContent":["import { Pool } from \"pg\";\nimport dotenv from \"dotenv\";\ndotenv.config();\nconst dbConfig = {\n  host: process.env.DB_HOST || \"localhost\",\n  port: parseInt(process.env.DB_PORT) || 5432,\n  database: process.env.DB_NAME,\n  user: process.env.DB_USER,\n  password: process.env.DB_PASSWORD,\n  max: parseInt(process.env.DB_MAX_CONNECTIONS) || 20,\n  idleTimeoutMillis: parseInt(process.env.DB_IDLE_TIMEOUT) || 3e4,\n  connectionTimeoutMillis: parseInt(process.env.DB_CONNECTION_TIMEOUT) || 1e4,\n  acquireTimeoutMillis: 6e4,\n  createTimeoutMillis: 3e4,\n  destroyTimeoutMillis: 5e3,\n  reapIntervalMillis: 1e3,\n  createRetryIntervalMillis: 200,\n  // SSL configuration for production (Heroku requires SSL)\n  ssl: process.env.NODE_ENV === \"production\" || process.env.DB_SSL === \"true\" ? { rejectUnauthorized: false } : false\n};\nconst pool = new Pool(dbConfig);\npool.on(\"error\", (err) => {\n  console.error(\"Unexpected error on idle client\", err);\n  console.error(\"Database config:\", {\n    host: dbConfig.host,\n    port: dbConfig.port,\n    database: dbConfig.database,\n    user: dbConfig.user,\n    ssl: dbConfig.ssl\n  });\n  process.exit(-1);\n});\nconst query = async (text, params) => {\n  try {\n    const res = await pool.query(text, params);\n    return res;\n  } catch (err) {\n    console.error(\"Query error:\", err);\n    console.error(\"Database connection details:\", {\n      host: dbConfig.host,\n      database: dbConfig.database,\n      ssl: dbConfig.ssl,\n      nodeEnv: process.env.NODE_ENV\n    });\n    throw err;\n  }\n};\nconst getClient = async () => {\n  return await pool.connect();\n};\nexport {\n  getClient as g,\n  query as q\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,CAAC,MAAM,EAAE;AACf,MAAM,QAAQ,GAAG;AACjB,EAAE,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,WAAW;AAC1C,EAAE,IAAI,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI;AAC7C,EAAE,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO;AAC/B,EAAE,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO;AAC3B,EAAE,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW;AACnC,EAAE,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,IAAI,EAAE;AACrD,EAAE,iBAAiB,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,GAAG;AACjE,EAAE,uBAAuB,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC,IAAI,GAAG;AAC7E,EAAE,oBAAoB,EAAE,GAAG;AAC3B,EAAE,mBAAmB,EAAE,GAAG;AAC1B,EAAE,oBAAoB,EAAE,GAAG;AAC3B,EAAE,kBAAkB,EAAE,GAAG;AACzB,EAAE,yBAAyB,EAAE,GAAG;AAChC;AACA,EAAE,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,KAAK,MAAM,GAAG,EAAE,kBAAkB,EAAE,KAAK,EAAE,GAAG;AAChH,CAAC;AACD,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC;AAC/B,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,GAAG,KAAK;AAC1B,EAAE,OAAO,CAAC,KAAK,CAAC,iCAAiC,EAAE,GAAG,CAAC;AACvD,EAAE,OAAO,CAAC,KAAK,CAAC,kBAAkB,EAAE;AACpC,IAAI,IAAI,EAAE,QAAQ,CAAC,IAAI;AACvB,IAAI,IAAI,EAAE,QAAQ,CAAC,IAAI;AACvB,IAAI,QAAQ,EAAE,QAAQ,CAAC,QAAQ;AAC/B,IAAI,IAAI,EAAE,QAAQ,CAAC,IAAI;AACvB,IAAI,GAAG,EAAE,QAAQ,CAAC;AAClB,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC;AAClB,CAAC,CAAC;AACG,MAAC,KAAK,GAAG,OAAO,IAAI,EAAE,MAAM,KAAK;AACtC,EAAE,IAAI;AACN,IAAI,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC;AAC9C,IAAI,OAAO,GAAG;AACd,EAAE,CAAC,CAAC,OAAO,GAAG,EAAE;AAChB,IAAI,OAAO,CAAC,KAAK,CAAC,cAAc,EAAE,GAAG,CAAC;AACtC,IAAI,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE;AAClD,MAAM,IAAI,EAAE,QAAQ,CAAC,IAAI;AACzB,MAAM,QAAQ,EAAE,QAAQ,CAAC,QAAQ;AACjC,MAAM,GAAG,EAAE,QAAQ,CAAC,GAAG;AACvB,MAAM,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC;AAC3B,KAAK,CAAC;AACN,IAAI,MAAM,GAAG;AACb,EAAE;AACF;AACK,MAAC,SAAS,GAAG,YAAY;AAC9B,EAAE,OAAO,MAAM,IAAI,CAAC,OAAO,EAAE;AAC7B;;;;"}