{"version":3,"file":"auth-Cnb4WhwS.js","sources":["../../../.svelte-kit/adapter-node/chunks/auth.js"],"sourcesContent":["import { w as writable, g as get } from \"./index.js\";\nfunction createToastStore() {\n  const { subscribe, update } = writable([]);\n  return {\n    subscribe,\n    // Add a new toast\n    add: (message, type = \"success\", duration = 3e3) => {\n      const id = Date.now() + Math.random();\n      const toast = {\n        id,\n        message,\n        type,\n        duration\n      };\n      let shouldAdd = true;\n      update((toasts) => {\n        const duplicateExists = toasts.some((t) => t.message === message && t.type === type);\n        if (duplicateExists) {\n          shouldAdd = false;\n          return toasts;\n        }\n        return [...toasts, toast];\n      });\n      if (!shouldAdd) {\n        return null;\n      }\n      if (duration > 0) {\n        setTimeout(() => {\n          setTimeout(() => {\n            update((toasts) => toasts.filter((t) => t.id !== id));\n          }, 300);\n        }, duration);\n      }\n      return id;\n    },\n    // Remove a specific toast\n    remove: (id) => {\n      update((toasts) => toasts.filter((t) => t.id !== id));\n    },\n    // Clear all toasts\n    clear: () => {\n      update(() => []);\n    },\n    // Convenience methods\n    success: (message, duration = 3e3) => {\n      return toastStore.add(message, \"success\", duration);\n    },\n    error: (message, duration = 4e3) => {\n      return toastStore.add(message, \"error\", duration);\n    },\n    warning: (message, duration = 3500) => {\n      return toastStore.add(message, \"warning\", duration);\n    },\n    info: (message, duration = 3e3) => {\n      return toastStore.add(message, \"info\", duration);\n    }\n  };\n}\nconst toastStore = createToastStore();\ntoastStore.add;\nfunction createModalStore() {\n  const { subscribe, update } = writable([]);\n  return {\n    subscribe,\n    // Open a new modal\n    open: (component, props = {}, options = {}) => {\n      const id = Date.now() + Math.random();\n      const modal = {\n        id,\n        component,\n        props,\n        options: {\n          closable: true,\n          backdrop: true,\n          size: \"medium\",\n          ...options\n        }\n      };\n      update((modals) => [...modals, modal]);\n      return id;\n    },\n    // Close a specific modal\n    close: (id) => {\n      update((modals) => modals.filter((m) => m.id !== id));\n    },\n    // Close the topmost modal\n    closeTop: () => {\n      update((modals) => {\n        if (modals.length > 0) {\n          return modals.slice(0, -1);\n        }\n        return modals;\n      });\n    },\n    // Close all modals\n    closeAll: () => {\n      update(() => []);\n    },\n    // Convenience methods for different modal types\n    confirm: (title, message, onConfirm, onCancel, options = {}) => {\n      return modalStore.open(\"ConfirmModal\", {\n        title,\n        message,\n        onConfirm,\n        onCancel,\n        onDelete: options.onDelete,\n        deleteText: options.deleteText\n      }, {\n        size: options.size || \"small\",\n        closable: options.closable !== false\n      });\n    },\n    // Large confirm modal for complex content\n    confirmLarge: (title, message, onConfirm, onCancel) => {\n      return modalStore.open(\"ConfirmModal\", {\n        title,\n        message,\n        onConfirm,\n        onCancel\n      }, {\n        size: \"large\",\n        closable: false\n      });\n    },\n    alert: (title, message, onClose) => {\n      return modalStore.open(\"AlertModal\", {\n        title,\n        message,\n        onClose\n      }, {\n        size: \"small\"\n      });\n    },\n    prompt: (title, message, placeholder = \"\", onSubmit, onCancel) => {\n      return modalStore.open(\"PromptModal\", {\n        title,\n        message,\n        placeholder,\n        defaultValue: \"\",\n        inputValue: \"\",\n        onSubmit,\n        onCancel\n      }, {\n        size: \"medium\"\n      });\n    },\n    // Form modal with two input fields\n    form: (title, message, field1Config, field2Config, onSubmit, onCancel, onDelete, options = {}) => {\n      return modalStore.open(\"FormModal\", {\n        title,\n        message,\n        field1Label: field1Config.label || \"Field 1\",\n        field1Type: field1Config.type || \"text\",\n        field1Placeholder: field1Config.placeholder || \"Enter value...\",\n        field1Value: field1Config.value || \"\",\n        field1Min: field1Config.min,\n        field1Max: field1Config.max,\n        field2Label: field2Config.label || \"Field 2\",\n        field2Type: field2Config.type || \"text\",\n        field2Placeholder: field2Config.placeholder || \"Enter value...\",\n        field2Value: field2Config.value || \"\",\n        field2Min: field2Config.min,\n        field2Max: field2Config.max,\n        onSubmit,\n        onCancel,\n        onDelete\n      }, {\n        size: options.size || \"medium\",\n        closable: options.closable !== false\n      });\n    }\n  };\n}\nconst modalStore = createModalStore();\nfunction getInitialState() {\n  return {\n    isAuthenticated: false,\n    userType: null,\n    // 'student', 'teacher', 'admin'\n    userData: null\n  };\n}\nfunction createAuthStore() {\n  const initialState = getInitialState();\n  const { subscribe, set, update } = writable(initialState);\n  return {\n    subscribe,\n    // Login function\n    login: (userType, userData) => {\n      const newState = {\n        isAuthenticated: true,\n        userType,\n        userData\n      };\n      set(newState);\n    },\n    // Logout function\n    logout: async () => {\n      const currentState = get(authStore);\n      if (currentState.isAuthenticated && currentState.userData) {\n        try {\n          await fetch(\"/api/activity-logs\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              activity_type: \"user_logout\",\n              user_id: currentState.userData.id,\n              user_account_number: currentState.userData.accountNumber,\n              activity_data: {\n                full_name: currentState.userData.name,\n                account_type: currentState.userType\n              }\n            })\n          });\n        } catch (error) {\n          console.error(\"Failed to log logout activity:\", error);\n        }\n      }\n      const newState = {\n        isAuthenticated: false,\n        userType: null,\n        userData: null\n      };\n      set(newState);\n    },\n    // Update user data\n    updateUserData: (userData) => {\n      update((state) => {\n        const newState = {\n          ...state,\n          userData\n        };\n        return newState;\n      });\n    },\n    // Initialize from storage (called on app start)\n    initialize: () => {\n      const storedState = getInitialState();\n      set(storedState);\n    }\n  };\n}\nconst authStore = createAuthStore();\nexport {\n  authStore as a,\n  modalStore as m,\n  toastStore as t\n};\n"],"names":[],"mappings":"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"}